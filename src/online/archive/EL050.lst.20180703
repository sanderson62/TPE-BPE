* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57******************************************************************
    58 ENVIRONMENT DIVISION.
    59
    60 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page   3
* EL050.cbl
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64
    65 77  FILLER   PIC X(32) VALUE '********************************'.
    66 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    67 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    68
    69 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    70 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    71                                   USAGE POINTER.
    72 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    73 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    78                                   USAGE IS POINTER.
    79 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    81                                   USAGE IS POINTER.
    82
    83 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87*    COPY ELC50WS.
    88*****************************************************************
    89*                                                               *
    90*                            ELC50WS.                           *
    91*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    92*                            VMOD=2.061.                        *
    93*                                                               *
    94*   THIS IS THE WORKING STORAGE FOR EL050                       *
    95*                                   EL517                       *
    96*****************************************************************
    97******************************************************************
    98*                   C H A N G E   L O G
    99*
   100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   101*-----------------------------------------------------------------
   102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   103* EFFECTIVE    NUMBER
   104*-----------------------------------------------------------------
   105* 123102                   PEMA  ADD DCC PROCESSING
   106* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   107* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   108* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   109* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   110* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   111* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   112* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   113* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   114* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   115* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   116* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   117* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   118* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   119* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page   4
* EL050.cbl
   120* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   121* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   122* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   123* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   124* 030309  CR2009021700001  PEMA  ADD ER-2883
   125* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   126* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   127* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   128* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   129* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   130* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   131* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   132* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   133* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   134* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   135* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   136* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   137* 061412  CR2011022800001  AJRA  NAPERSOFT
   138* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   139* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   140* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   141* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   142* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   143* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   144* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   145* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   146* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   147* 091114  IR2014091000001  TANA  ADD ERROR 2898
   148* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   149* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   150* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   151* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   152* 100617  CR2017062000003  PEMA  Inforce state comm cap
   153* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   154* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   155* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   156*-----------------------------------------------------------------
   157
   158 01  WORK-AREAS.
   159
   160*****************************************************************
   161*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   162*****************************************************************
   163
   164     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   165     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   166     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   167     12  WS-NAME-EDIT-WORK-AREA.
   168         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   169         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   170             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   171         16  WS-WORK-NAME.
   172             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   173             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   174             20  FILLER           PIC X(10)     VALUE SPACES.
   175         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   176             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   177
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page   5
* EL050.cbl
   178*****************************************************************
   179*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   180*****************************************************************
   181
   182     12  WS-ERRESC-KEY.
   183         16 WS-ERRESC-SEARCH-KEY.
   184             20  WS-ERRESC-COMPANY-CD PIC  X.
   185             20  WS-ERRESC-CARRIER    PIC  X.
   186             20  WS-ERRESC-GROUP      PIC X(6).
   187             20  WS-ERRESC-STATE      PIC XX.
   188             20  WS-ERRESC-ACCOUNT    PIC X(10).
   189         16 WS-ERRESC-RESIDUAL-KEY.
   190             20  WS-ERRESC-AGENT      PIC X(10).
   191             20  WS-ERRESC-RES-STATE  PIC XX.
   192             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   193*                                          YYYYMMDD
   194     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   195     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   196
   197*RESIDENT STATE TAX MASTER(ERRESS)
   198*
   199     12  WS-ERRESS-KEY.
   200         16  WS-ERRESS-COMPANY-CD      PIC  X.
   201         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   202         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   203         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   204*                                          YYYYMMDD
   205
   206     12  WS-CONTRACT-DATE              PIC 9(8).
   207*                                          YYYYMMDD
   208     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   209     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   210         16 WS-YEAR-YY                 PIC   9999.
   211         16 FILLER                     PIC 9(4).
   212*                                          YYYYMMDD
   213     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   214     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   215     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   216     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   217
   218     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   219         88  DPRB-1ST-TIME                      VALUE ' '.
   220
   221*****************************************************************
   222*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   223*****************************************************************
   224
   225     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   226     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   227     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   228     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   229     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   230     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   231     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   232     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   233     12  ws-st-agent-sig-edit    pic x          value spaces.
   234     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   235     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page   6
* EL050.cbl
   236     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   238         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   239         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   240     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   241         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   242         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   243     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   244
   245     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   246     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   247
   248     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   249     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   254     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   255     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   259     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   260     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   261     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   262     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   263     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   279     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   280     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   281     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   282     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   283     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   284     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   285     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   286     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   287     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   288     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   289     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   290     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   291     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   292     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   293     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page   7
* EL050.cbl
   294     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   295     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   296     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   297     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   298     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   299     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   300     12  WS-2671-SW               PIC X         VALUE SPACE.
   301     12  WS-2672-SW               PIC X         VALUE SPACE.
   302     12  ws-9813-sw               pic x         value spaces.
   303     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   304         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   305     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   306         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   307     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   308
   309     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   310         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   311         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   312         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   313         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   314
   315     12  WS-CREDIT-EDIT-CONTROLS.
   316         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   317         16  WS-MIN-AGE           PIC 99                VALUE  0.
   318         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   319         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   320         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   321         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   322
   323     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   324     12  WS-AGE-FIELDS.
   325         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   326         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   327         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   328         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   329
   330     12  WS-SAVE-ALLOWABLE-BENEFIT.
   331         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   332         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   333         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   334         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   335         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   336         16  FILLER                      PIC XX.
   337
   338     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   339     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   340     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   341     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   342     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   343     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   344     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   345     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   346     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   347     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   348
   349     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   350     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   351     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page   8
* EL050.cbl
   352     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   353     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   354     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   355     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   356     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   357         88  WS-REDUCING              VALUE 'R'.
   358         88  WS-LEVEL                 VALUE 'L' 'P'.
   359     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   360
   361     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   362     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   363     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   364     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   365     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   366     12  ws-ah-max-bens           pic 99        value zeros.
   367     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   368     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   369     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   370     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   371
   372     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   373     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   374     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   375     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   376     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   377     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   378     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   379     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   380     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   381     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   382     12  WS-ACCT-SIG-SW.
   383         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   384         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   385     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   386     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   387     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   388     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   389     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   390     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   391     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   392     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   393     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   394     12  WS-INITIALS.
   395         16  WS-INIT-1            PIC X         VALUE SPACES.
   396         16  WS-INIT-2            PIC X         VALUE SPACES.
   397
   398     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   399     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   400     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   401     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   402     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   403*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   404     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   405     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   406     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   407     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   408     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   409     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page   9
* EL050.cbl
   410     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   411     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   412     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   413     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   414     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   415     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   416     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   417     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   418     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   419     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   420     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   421     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   422     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   423     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   424     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   425     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   426******** FLA
   427     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   428     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   429     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   430     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   431     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   432********
   433     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   434     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   435     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   436     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   437     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   438     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   439     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   440     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   441     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   442     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   443
   444     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   445         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   446                                         '0' THRU '9'.
   447
   448     12  NUMBER-OF-MONTHS.
   449         16  SK-MO OCCURS 12 TIMES PIC X.
   450
   451     12  WS-WORK-DATE.
   452         16  WS-YEAR            PIC 99    VALUE 00.
   453         16  WS-MONTH           PIC 99    VALUE 00.
   454         16  WS-DAY             PIC 99    VALUE 00.
   455
   456     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   457     12  WS-WORK-CRIT-DEV       REDEFINES
   458         WS-WORK-LF-CRIT-PER    PIC X(03).
   459
   460     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   461     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   462
   463     12  WS-WORK-DATE-FROM.
   464         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   465         16  FILLER             PIC X  VALUE SPACE.
   466         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   467         16  FILLER             PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  10
* EL050.cbl
   468         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   469
   470     12  WS-WORK-DATE-THRU.
   471         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   472         16  FILLER             PIC X         VALUE SPACE.
   473         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   474         16  FILLER             PIC X         VALUE SPACE.
   475         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   476
   477     12  WS-LF-INPUT-CD.
   478         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   479         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   480
   481     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   482     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   483         16  WS-AH-INPUT-CD-1   PIC X.
   484         16  WS-AH-INPUT-CD-2-3 PIC XX.
   485
   486     12  WS-SWITCHES.
   487         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   488         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   489             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   490         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   491             88  BANK-ACCT-FOUND          VALUE 'Y'.
   492         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   493             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   494         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   495             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   496         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   497             88  COMP-MASTER-FOUND        VALUE 'Y'.
   498         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   499             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   500         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   501             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   502         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   503             88  STAT-MASTER-FOUND        VALUE 'Y'.
   504         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   505             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   506         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   507             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   508         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   509             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   510         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   511             88  FORM-MASTER-FOUND        VALUE 'Y'.
   512         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   513             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   514         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   515             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   516         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   517             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   518         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   519             88  NO-BENEFIT-FOUND         VALUE 'N'.
   520         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   521             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   522         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   523             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   524         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   525             88  AH-BENEFIT-FOUND         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  11
* EL050.cbl
   526             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   527         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   528             88  LF-BENEFIT-FOUND         VALUE ' '.
   529             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   530         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   531             88  NO-STATE-RECORD          VALUE '1'.
   532         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   533             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   534         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   535             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   536         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   537             88  CERT-WAS-FOUND           VALUE ' '.
   538             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   539         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   540             88  BROWSE-STARTED           VALUE 'Y'.
   541         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   542             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   543         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   544             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   545         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   546             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   547         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   548             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   549         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   550             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   551         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   552             88  APP-CERT-USED            VALUE 'Y' 'A'.
   553         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   554             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   555             88  FIRST-TIME-THROUGH       VALUE '1'.
   556             88  CTBL-NOT-FOUND           VALUE '2'.
   557
   558         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   559             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   560
   561         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   562             88  DLO-ERROR-FOUND          VALUE 'Y'.
   563
   564********FLA
   565     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   566     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   567********
   568     12  RC-SW-1                  PIC X           VALUE '0'.
   569     12  RC-SW-2                  PIC X           VALUE '0'.
   570     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   571     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   572     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   573     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   574     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   575     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   576     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   577     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   578     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   579     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   580     12  LIT-SPACES               PIC X           VALUE SPACES.
   581     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   582     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   583     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  12
* EL050.cbl
   584     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   585     12  erpndm-unlock-sw         pic x           value spaces.
   586         88  need-to-unlock-erpndm  value 'Y'.
   587     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   588     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   589     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   590         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   591         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   592     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   593         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   594
   595 01  WS-EXTRA-PERIODS-BY-STATE.
   596     12  WS-INT-PERIODS          PIC 9.
   597     12  WS-EXTRA-PMTS           PIC 9.
   598 01  ws-net-only-state           pic x value 'N'.
   599 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   600     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   601     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   602 01  WS-CRI-SSN-WORK-AREA.
   603     05  WS-CRI-SOC-SEC-NO.
   604         10  WS-SS-REPT-CD       PIC X(5).
   605         10  WS-SS-LAST-NAME     PIC X(5).
   606         10  WS-SS-INITIAL       PIC X.
   607
   608     05  WS-CRI-REPORT-CODE.
   609         10  FILLER              PIC X(5).
   610         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   611
   612     05  WS-CRI-LAST-NAME.
   613         10  WS-CRI-NAME-MOVE    PIC X(5).
   614         10  FILLER              PIC X(10).
   615
   616 01  ws-state-commission-caps.
   617     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   618     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   619     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   620     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   621     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   622     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   623     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   624     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   625     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   626     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   627     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   628     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   629     05  ws-st-cap-limit-to      pic x.
   630     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   631     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   632     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   633     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   634     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   635     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   636     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   637     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   638     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   639     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   640     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   641     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  13
* EL050.cbl
   642 01  WS-NUM-TABLE                PIC X(26)  VALUE
   643     '12345678012345070923456789'.
   644 01  FILLER REDEFINES WS-NUM-TABLE.
   645     05  WS-NUM OCCURS 26        PIC 9.
   646 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   647 01  V1                          PIC S999 COMP-3.
   648 01  V2                          PIC S999 COMP-3.
   649 01  V3                          PIC S999 COMP-3.
   650 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   651 01  FILLER REDEFINES WS-WORK-VIN.
   652     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   653 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   654 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   655 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   656 01  WS-HEX-WORK.
   657     05  FILLER                  PIC X  VALUE LOW-VALUES.
   658     05  WS-HEX-BYTE             PIC X.
   659 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   660 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   661 01  WS-WORK-HIN-ROW-B.
   662     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   663
   664 01  ws-benefit-cd-chg-sw      pic x value spaces.
   665     88  benefit-code-chg           value 'Y'.
   666 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   667 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   668     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   669 01  WS-ROW-D-TABLE.
   670     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   671
   672 01  WS-HIN-TABLE-B.
   673     05  F                       PIC XX VALUE 'A2'.
   674     05  F                       PIC XX VALUE 'B3'.
   675     05  F                       PIC XX VALUE 'C4'.
   676     05  F                       PIC XX VALUE 'D5'.
   677     05  F                       PIC XX VALUE 'E6'.
   678     05  F                       PIC XX VALUE 'F7'.
   679     05  F                       PIC XX VALUE 'G8'.
   680     05  F                       PIC XX VALUE 'H9'.
   681     05  F                       PIC XX VALUE 'I1'.
   682     05  F                       PIC XX VALUE 'J2'.
   683     05  F                       PIC XX VALUE 'K3'.
   684     05  F                       PIC XX VALUE 'L4'.
   685     05  F                       PIC XX VALUE 'M5'.
   686     05  F                       PIC XX VALUE 'N6'.
   687     05  F                       PIC XX VALUE 'O0'.
   688     05  F                       PIC XX VALUE 'P7'.
   689     05  F                       PIC XX VALUE 'Q0'.
   690     05  F                       PIC XX VALUE 'R8'.
   691     05  F                       PIC XX VALUE 'S9'.
   692     05  F                       PIC XX VALUE 'T2'.
   693     05  F                       PIC XX VALUE 'U3'.
   694     05  F                       PIC XX VALUE 'V4'.
   695     05  F                       PIC XX VALUE 'W5'.
   696     05  F                       PIC XX VALUE 'X6'.
   697     05  F                       PIC XX VALUE 'Y7'.
   698     05  F                       PIC XX VALUE 'Z8'.
   699 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  14
* EL050.cbl
   700     05  WS-VAL-IN               PIC X.
   701     05  WS-VAL-OUT              PIC 9.
   702 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   703 01  WS-COMPARE-BINARY-DATES.
   704     05  WS-971231                PIC XX VALUE X'92FF'.
   705     05  WS-931231                PIC XX VALUE X'8CFF'.
   706     05  WS-791231                PIC XX VALUE X'77FF'.
   707     05  WS-771001                PIC XX VALUE X'74A1'.
   708     05  WS-820301                PIC XX VALUE X'7B41'.
   709     05  WS-831031                PIC XX VALUE X'7DBF'.
   710     05  WS-831231                PIC XX VALUE X'7DFF'.
   711     05  WS-810831                PIC XX VALUE X'7A7F'.
   712     05  WS-830901                PIC XX VALUE X'7D81'.
   713
   714 01  FILE-ACCESS-IDS.
   715     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   716     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   717     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   718     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   719     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   720     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   721     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   722     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   723     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   724     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   725     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   726     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   727     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   728     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   729     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   730     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   731     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   732 01  DD-IU-SW                    PIC X   VALUE ' '.
   733     88  DD-IU-PRESENT                 VALUE 'Y'.
   734
   735 01  ACCESS-KEYS.
   736     12  ELMSTR-KEY.
   737         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   738         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   739     12  W-CLAIM-KEY.
   740         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   741         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   742
   743     12  ELCNTL-KEY.
   744         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   745         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   746         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   747         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   748
   749     12  ELCERT-KEY.
   750         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   751         16  CERT-CARRIER         PIC X       VALUE SPACE.
   752         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   753         16  CERT-STATE           PIC XX      VALUE SPACES.
   754         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   755         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   756         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   757
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  15
* EL050.cbl
   758     12  ELCERT2-KEY.
   759         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   760         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   761
   762     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   763
   764     12  ELCERT-SAVE.
   765         16  FILLER                      PIC XX    VALUE SPACES.
   766
   767         16  WCS-CONTROL-PRIMARY.
   768             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   769             20  WCS-CARRIER             PIC X     VALUE SPACE.
   770             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   771             20  WCS-STATE               PIC XX    VALUE SPACES.
   772             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   773             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   774             20  WCS-CERT-NO.
   775                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   776                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   777
   778         16  CS-CONTROL-BY-NAME.
   779             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   780             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   781             20  CS-INSURED-INITIALS.
   782                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   783                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   784
   785         16  CS-CONTROL-BY-SSN.
   786             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   787             20  CS-SOC-SEC-NO.
   788                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   789                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   790                 24  CS-SSN-LN3.
   791                     28 CS-INSURED-INITIALS-A2   PIC XX
   792                                     VALUE SPACES.
   793                     28 CS-PART-LAST-NAME-A2     PIC X
   794                                     VALUE SPACE.
   795
   796         16  CS-CONTROL-BY-CERT-NO.
   797             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   798             20  CS-CERT-NO-A4           PIC X(11)
   799                                     VALUE SPACES.
   800
   801         16  CS-CONTROL-BY-MEMB.
   802             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   803             20  CS-MEMBER-NO.
   804                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   805                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   806                 24  CS-MEMB-LN4.
   807                     28 CS-INSURED-INITIALS-A5   PIC XX
   808                                      VALUE SPACES.
   809                     28 CS-PART-LAST-NAME-A5     PIC XX
   810                                      VALUE SPACES.
   811
   812         16  FILLER              PIC X(360) VALUE SPACES.
   813
   814     12  ERACCT-KEY.
   815         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  16
* EL050.cbl
   816         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   817         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   818         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   819         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   820         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   821
   822     12  ERCOMP-KEY.
   823         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   824         16  COMP-CARRIER         PIC X     VALUE SPACES.
   825         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   826         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   827         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   828         16  COMP-TYPE            PIC X     VALUE SPACES.
   829
   830     12  ERLOFC-KEY.
   831         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   832         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   833         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   834         16  LOFC-STATE           PIC XX    VALUE SPACES.
   835         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   836         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   837
   838     12  WS-ELCRTT-KEY.
   839         16  WS-ELCRTT-PRIMARY       PIC X(33).
   840         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   841
   842     12  ERBXRF-KEY.
   843         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   844         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   845         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   846         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   847
   848     12  ERAGTC-KEY.
   849         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   850         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   851         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   852         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   853         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   854         16  AGTC-TYPE            PIC X     VALUE SPACES.
   855
   856     12  ERPLAN-KEY.
   857         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   858         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   859         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   860         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   861         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   862         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   863         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   864         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   865
   866     12  ERFORM-KEY.
   867         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   868         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   869         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   870         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   871
   872     12  ERREIN-KEY.
   873         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  17
* EL050.cbl
   874         16  REIN-TYPE            PIC X     VALUE SPACES.
   875         16  REIN-TABLE-CO.
   876             20  REIN-CODE-1      PIC X     VALUE SPACE.
   877             20  REIN-CODE-2      PIC X     VALUE SPACE.
   878             20  REIN-CODE-3      PIC X     VALUE SPACE.
   879         16  FILLER               PIC X(3)  VALUE SPACES.
   880
   881     12  ERCTBL-KEY.
   882         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   883         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   884         16  CTBL-CNTRL-2.
   885             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   886             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   887
   888     12  ELCRTO-KEY.
   889         16  ELCRTO-COMPANY-CD       PIC X.
   890         16  ELCRTO-CARRIER          PIC X.
   891         16  ELCRTO-GROUPING         PIC X(6).
   892         16  ELCRTO-STATE            PIC XX.
   893         16  ELCRTO-ACCOUNT          PIC X(10).
   894         16  ELCRTO-CERT-EFF-DT      PIC XX.
   895         16  ELCRTO-CERT-NO.
   896             20  ELCRTO-CERT-PRIME   PIC X(10).
   897             20  ELCRTO-CERT-SFX     PIC X.
   898         16  ELCRTO-RECORD-TYPE      PIC X.
   899         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   900
   901
   902     12  WS-ACCESS.
   903         16  FILLER               PIC XX    VALUE SPACES.
   904         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   905
   906     12  WS-CARR-ACCESS.
   907         16  FILLER               PIC X(3)  VALUE SPACES.
   908         16  WS-CARR              PIC X     VALUE SPACE.
   909*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   910*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   911     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   912         88  WS-DMD-LF-RATING   VALUE 'Y'.
   913         88  WS-DMD-AH-RATING   VALUE 'Y'.
   914         88  WS-DMD-NO-RATING   VALUE 'N'.
   915
   916     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   917         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   918                                         'NJ' 'NL'
   919                                         'PJ' 'PL'
   920                                         'SJ' 'SL'.
   921     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   922         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   923                                         'NI' 'NJ' 'NL' 'NU'
   924                                         'PJ' 'PL' 'PI' 'PU'
   925                                         'SI' 'SJ' 'SL' 'SU'
   926                                         'MX' 'MY' 'MZ'.
   927 01  ERPDEF-KEY-SAVE             PIC X(18).
   928 01  ERPDEF-KEY.
   929     12  ERPDEF-COMPANY-CD       PIC X.
   930     12  ERPDEF-STATE            PIC XX.
   931     12  ERPDEF-PROD-CD          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  18
* EL050.cbl
   932     12  F                       PIC X(7).
   933     12  ERPDEF-BEN-TYPE         PIC X.
   934     12  ERPDEF-BEN-CODE         PIC XX.
   935     12  ERPDEF-EXP-DT           PIC XX.
   936
   937 01  ELSTAT-KEY-SAVE             PIC X(20).
   938 01  ELSTAT-KEY.
   939     12  ELSTAT-COMPANY-ID       PIC XXX.
   940     12  ELSTAT-CARRIER          PIC X.
   941     12  ELSTAT-GROUP            PIC X(6).
   942     12  ELSTAT-STATE            PIC XX.
   943     12  ELSTAT-EXP-DT           PIC 9(8).
   944 01  WS-ERROR-VALUES.
   945     12  ER-1570                     PIC S9(4)   VALUE +1570.
   946     12  ER-1571                     PIC S9(4)   VALUE +1571.
   947     12  er-1572                     pic s9(4)   value +1572.
   948     12  er-1573                     pic s9(4)   value +1573.
   949     12  er-1574                     pic s9(4)   value +1574.
   950     12  ER-1575                     PIC S9(4)   VALUE +1575.
   951     12  er-1576                     pic s9(4)   value +1576.
   952     12  er-1583                     pic s9(4)   value +1583.
   953     12  er-1743                     pic s9(4)   value +1743.
   954     12  er-1744                     pic s9(4)   value +1744.
   955     12  er-1745                     pic s9(4)   value +1745.
   956     12  er-1746                     pic s9(4)   value +1746.
   957     12  er-1747                     pic s9(4)   value +1747.
   958     12  er-1748                     pic s9(4)   value +1748.
   959     12  ER-1891                     PIC S9(4)   VALUE +1891.
   960     12  ER-1892                     PIC S9(4)   VALUE +1892.
   961     12  ER-1893                     PIC S9(4)   VALUE +1893.
   962     12  ER-1894                     PIC S9(4)   VALUE +1894.
   963     12  ER-1895                     PIC S9(4)   VALUE +1895.
   964     12  ER-1896                     PIC S9(4)   VALUE +1896.
   965     12  ER-1897                     PIC S9(4)   VALUE +1897.
   966     12  ER-1898                     PIC S9(4)   VALUE +1898.
   967     12  ER-1899                     PIC S9(4)   VALUE +1899.
   968     12  ER-1900                     PIC S9(4)   VALUE +1900.
   969     12  ER-1901                     PIC S9(4)   VALUE +1901.
   970     12  ER-1902                     PIC S9(4)   VALUE +1902.
   971     12  ER-1903                     PIC S9(4)   VALUE +1903.
   972     12  ER-1904                     PIC S9(4)   VALUE +1904.
   973     12  ER-1905                     PIC S9(4)   VALUE +1905.
   974     12  ER-1906                     PIC S9(4)   VALUE +1906.
   975     12  ER-1907                     PIC S9(4)   VALUE +1907.
   976     12  ER-1909                     PIC S9(4)   VALUE +1909.
   977     12  ER-1910                     PIC S9(4)   VALUE +1910.
   978     12  ER-1911                     PIC S9(4)   VALUE +1911.
   979     12  ER-1912                     PIC S9(4)   VALUE +1912.
   980     12  ER-1913                     PIC S9(4)   VALUE +1913.
   981     12  ER-1914                     PIC S9(4)   VALUE +1914.
   982     12  ER-1915                     PIC S9(4)   VALUE +1915.
   983     12  ER-1916                     PIC S9(4)   VALUE +1916.
   984     12  ER-1917                     PIC S9(4)   VALUE +1917.
   985     12  ER-1918                     PIC S9(4)   VALUE +1918.
   986     12  ER-1919                     PIC S9(4)   VALUE +1919.
   987     12  ER-1920                     PIC S9(4)   VALUE +1920.
   988     12  ER-1921                     PIC S9(4)   VALUE +1921.
   989     12  ER-1922                     PIC S9(4)   VALUE +1922.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  19
* EL050.cbl
   990     12  ER-1923                     PIC S9(4)   VALUE +1923.
   991     12  ER-1924                     PIC S9(4)   VALUE +1924.
   992     12  ER-1925                     PIC S9(4)   VALUE +1925.
   993     12  ER-1926                     PIC S9(4)   VALUE +1926.
   994     12  ER-1927                     PIC S9(4)   VALUE +1927.
   995     12  ER-1955                     PIC s9(4)   VALUE +1955.
   996     12  ER-1956                     PIC s9(4)   VALUE +1956.
   997     12  ER-1957                     PIC s9(4)   VALUE +1957.
   998     12  ER-1958                     PIC s9(4)   VALUE +1958.
   999     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1000     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1001     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1002     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1003     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1004     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1005     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1006     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1007     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1008     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1009     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1010     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1011     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1012     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1013     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1014     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1015     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1016     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1017     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1018     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1019     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1020     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1021     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1022     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1023     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1024     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1025     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1026     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1027     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1028     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1029     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1030     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1031     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1032     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1033     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1034     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1035     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1036     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1037     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1038     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1039     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1040     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1041     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1042     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1043     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1044     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1045     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1046     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1047     12  ER-2642                     PIC S9(4)   VALUE +2642.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  20
* EL050.cbl
  1048     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1049     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1050     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1051     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1052     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1053     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1054     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1055     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1056     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1057     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1058     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1059     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1060     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1061     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1062     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1063     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1064     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1065     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1066     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1067     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1068     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1069     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1070     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1071     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1072     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1073     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1074     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1075     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1076     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1077     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1078     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1079     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1080     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1081     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1082     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1083     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1084     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1085     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1086     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1087     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1088     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1089     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1090     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1091     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1092     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1093     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1094     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1095     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1096     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1097     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1098     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1099     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1100     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1101     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1102     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1103     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1104     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1105     12  ER-2700                     PIC S9(4)   VALUE +2700.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  21
* EL050.cbl
  1106     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1107     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1108     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1109     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1110     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1111     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1112     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1113     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1114     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1115     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1116     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1117     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1118     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1119     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1120     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1121     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1122     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1123     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1124     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1125     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1126     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1127     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1128     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1129     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1130     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1131     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1132     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1133     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1134     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1135     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1136     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1137     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1138     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1139     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1140     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1141     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1142     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1143     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1144     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1145     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1146     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1147     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1148     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1149     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1150     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1151     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1152     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1153     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1154     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1155     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1156     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1157     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1158     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1159     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1160     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1161     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1162     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1163     12  ER-2768                     PIC S9(4)   VALUE +2768.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  22
* EL050.cbl
  1164     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1165     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1166     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1167     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1168     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1169     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1170     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1171     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1172     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1173     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1174     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1175     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1176     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1177     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1178     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1179     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1180     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1181     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1182     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1183     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1184     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1185     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1186     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1187     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1188     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1189     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1190     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1191     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1192     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1193     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1194     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1195     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1196     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1197     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1198     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1199     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1200     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1201     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1202     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1203     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1204     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1205     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1206     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1207     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1208     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1209     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1210     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1211     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1212     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1213     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1214     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1215     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1216     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1217     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1218     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1219     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1220     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1221     12  ER-3062                     PIC S9(4)   VALUE +3062.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  23
* EL050.cbl
  1222     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1223     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1224     12  er-3270                     pic s9(4)   value +3270.
  1225     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1226     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1227     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1228     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1229     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1230     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1231     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1232     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1233     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1234     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1235     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1236     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1237     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1238     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1239     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1240     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1241     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1242     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1243     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1244     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1245     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1246     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1247     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1248     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1249     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1250     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1251     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1252     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1253     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1254     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1255     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1256     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1257     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1258     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1259     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1260     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1261     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1262     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1263     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1264     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1265     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1266     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1267     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1268     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1269     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1270     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1271     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1272     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1273     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1274     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1275     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1276     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1277     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1278     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1279     12  ER-8088                     PIC S9(4)   VALUE +8088.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  24
* EL050.cbl
  1280     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1281     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1282     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1283     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1284     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1285     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1286     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1287     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1288     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1289     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1290     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1291     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1292     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1293     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1294     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1295     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1296     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1297     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1298     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1299     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1300     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1301     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1302     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1303     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1304     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1305     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1306     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1307     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1308     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1309     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1310     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1311     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1312     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1313     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1314     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1315     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1316     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1317     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1318     12  er-9823                     pic s9(4)   value +9823.
  1319     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1320******************************************************************
  1321***************   END OF ELC50WS     ****************************
  1322******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  25
* EL050.cbl
  1325 01  WORKING-STORAGE-WORK-AREAS.
  1326     12  WS-RESPONSE             PIC S9(8)  COMP.
  1327         88  WS-RESP-NORMAL           VALUE +00.
  1328         88  WS-RESP-ERROR            VALUE +01.
  1329         88  WS-RESP-NOTFND           VALUE +13.
  1330         88  WS-RESP-DUPREC           VALUE +14.
  1331         88  WS-RESP-ENDFILE          VALUE +20.
  1332     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1333     12  WORK-AREAS.
  1334         16  WK-CONV-GREG.
  1335             24  WCG-CENT             PIC XX.
  1336             24  WCG-REST             PIC X(4).
  1337         16  WORK-GREGORIAN-DATE.
  1338             24  WK-GREG-CENT         PIC XX.
  1339             24  WK-GREG-DATE-YYMMDD.
  1340                 28  WK-GREG-YYMM     PIC X(4).
  1341                 28  WK-GREG-DD       PIC XX.
  1342
  1343         16  WORK-SELECT-DATE.
  1344             24  WK-SELECT-CENT            PIC XX.
  1345             24  WK-SELECT-DATE-YYMMDD.
  1346                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1347                 28  FILLER                PIC XX.
  1348
  1349         16  WK-FORM-NO.
  1350             24  WK-FORM-BANK-ID       PIC X(5).
  1351             24  WK-FORM-UNDRWRTR      PIC X(1).
  1352             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1353
  1354         16  WK-MEMBER-NO.
  1355             24  WK-MEMBER-1-6        PIC X(6).
  1356             24  WK-MEMBER-7-12       PIC X(6).
  1357
  1358         16  WK-FULL-CERT-NO.
  1359             24  WK-CERT-POS-1-2      PIC X(2).
  1360             24  WK-CERT-POS-3        PIC X(1).
  1361             24  WK-CERT-POS-4        PIC X(1).
  1362             24  WK-CERT-POS-5-6      PIC X(2).
  1363             24  WK-CERT-POS-7        PIC X(1).
  1364             24  WK-CERT-POS-8-11     PIC X(4).
  1365
  1366         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1367             88  VALID-RATE-CODE        VALUE 'Y'.
  1368             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1369
  1370         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1371         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1372         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1373         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1374         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1375         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1376         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1377         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1378         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1379         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1380
  1381* DLO001
  1382 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  26
* EL050.cbl
  1383     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1384     12  DMPF-RETURN-CODE          PIC XX.
  1385         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1386         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1387         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1388         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1389         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1390         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1391
  1392* DLO002
  1393 01  WS-DLO-INTERNAL-POLICY-FORM.
  1394     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1395     12  DIPF-RETURN-CODE          PIC XX.
  1396         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1397         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1398         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1399         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1400         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1401         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1402
  1403* DLO003
  1404 01  WS-DLO-VALID-BANK-ID.
  1405     12  DVBI-BANK-ID              PIC X(5).
  1406     12  DVBI-BANK-ID-TYPE         PIC X.
  1407         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1408         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1409         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1410         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1411         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1412     12  DVBI-RETURN-CODE          PIC XX.
  1413         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1414         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1415         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1416         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1417         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1418         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1419         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1420         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1421         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1422
  1423* DLO007
  1424 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1425     12  DCUA-RES-STATE            PIC XX.
  1426     12  DCUA-BEN-TYPE             PIC XX.
  1427     12  DCUA-SYS-IDENT            PIC X.
  1428         88  DCUA-CLAIM                        VALUE 'C'.
  1429         88  DCUA-PREMIUM                      VALUE 'P'.
  1430     12  DCUA-COVERAGE-RULE        PIC X.
  1431     12  DCUA-CLIENT-ID            PIC X(10).
  1432     12  DCUA-EFF-DATE             PIC X(8).
  1433     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1434     12  DCUA-RETURN-CODE          PIC XX.
  1435         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1436     12  DCUA-CERT-NUMBER          PIC X(11).
  1437     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1438     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1439
  1440* DLO011
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  27
* EL050.cbl
  1441 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1442     12  DPRB-RATE-CODE            PIC X(4).
  1443     12  DPRB-COVERAGE-CATEG       PIC X.
  1444     12  DPRB-RETURN-CODE          PIC XX.
  1445         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1446         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1447         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1448         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1449         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1450         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1451         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1452         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1453         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1454     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1455     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1456     12  DPRB-BEN-TYPE             PIC XX.
  1457
  1458* DLO017
  1459 01  WS-DLO-VALID-RATE-CODE.
  1460     12  DVRC-RATE-CODE            PIC X(4).
  1461     12  DVRC-RETURN-CODE          PIC XX.
  1462         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1463         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1464         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1465         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1466         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1467         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1468
  1469* DLO019
  1470 01  WS-DLO-ORIG-COV-CAT.
  1471     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1472     12  DOCC-RETURN-CODE          PIC XX.
  1473     12  DOCC-ORIG-COV-CAT         PIC X.
  1474     12  DOCC-UNDERWITER           PIC XX.
  1475     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1476     12  DOCC-FILLER               PIC X(6).
  1477
  1478* DLO021
  1479 01  WS-DLO-VALID-LOAN-OFFICER.
  1480     12  DVLO-LOAN-OFFICER.
  1481         16  DVLO-BILL-TYPE        PIC X.
  1482         16  DVLO-BILL-SOURCE      PIC X.
  1483         16  DVLO-BATCH-TYPE       PIC X.
  1484     12  DVLO-RETURN-CODE          PIC XX.
  1485         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1486         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1487         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1488         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1489         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1490         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1491
  1492* DLO022
  1493 01  WS-DLO-VALID-STATE-CODE.
  1494     12  DVSC-STATE-CODE           PIC XX.
  1495     12  DVSC-RETURN-CODE          PIC XX.
  1496         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1497
  1498* DLO023
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  28
* EL050.cbl
  1499 01  WS-DLO-VALID-CODE-VALUES.
  1500     12  DVCV-SYSTEM-ID            PIC XX.
  1501         88  DVCV-CLAIMS                       VALUE 'CL'.
  1502         88  DVCV-CREDIT                       VALUE 'CR'.
  1503     12  DVCV-RECORD-TYPE          PIC XX.
  1504         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1505         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1506         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1507         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1508         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1509         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1510         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1511         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1512     12  DVCV-RECORD-KEY           PIC X(6).
  1513     12  DVCV-RETURN-CODE          PIC XX.
  1514         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1515         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1516         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1517         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1518         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1519         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1520         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1521     12  DVCV-CODE-DESC            PIC X(60).
  1522     12  DVCV-GEN-DESC-1           PIC X(20).
  1523     12  DVCV-GEN-DESC-2           PIC X(20).
  1524     12  DVCV-GEN-DESC-3           PIC X(20).
  1525
  1526 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1527 01  hldi-pass-area.
  1528     03  PA-VIN                  PIC X(17).
  1529     03  PA-ErrorCode            PIC X(10).
  1530     03  PA-ErrorDesc            PIC X(30).
  1531     03  PA-ModelYear            PIC 9(7).
  1532     03  PA-MakeName             PIC X(50).
  1533     03  PA-ModelName            PIC X(50).
  1534     03  PA-SeriesName           PIC X(50).
  1535 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1536 01  zipcd-pass-area.
  1537     03  PA-zip                  PIC X(5).
  1538     03  PA-ErrorCode-zip        PIC X(10).
  1539     03  PA-city                 PIC x(50).
  1540     03  PA-state                PIC Xx.
  1541****  this is for aggregate report.
  1542****  Length is erpndb + 100 of passed-key-area
  1543 01  ws-passed-key-length        pic s9(4) comp value +587.
  1544 01  ws-pass-to-pemaggo.
  1545     05  ws-passed-erpndb        pic x(585).
  1546     05  ws-exceed-limit-yn      pic x.
  1547     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  29
* EL050.cbl
  1549*    COPY ERCBXRF.
  1550******************************************************************
  1551*                                                                *
  1552*                                                                *
  1553*                            ERCBXRF                             *
  1554*                                                                *
  1555*   ONLINE CREDIT SYSTEM                                         *
  1556*                                                                *
  1557*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1558*                                                                *
  1559*   FILE TYPE = VSAM,KSDS                                        *
  1560*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1561*                                                                *
  1562*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1563*       ALTERNATE PATH = NONE                                    *
  1564*                                                                *
  1565*   LOG = NO                                                     *
  1566*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1567*                                                                *
  1568******************************************************************
  1569
  1570 01  BANK-CROSS-REFERENCE.
  1571     12  BK-RECORD-ID                PIC XX.
  1572         88  VALID-BK-ID             VALUE 'BK'.
  1573
  1574     12  BK-CONTROL-PRIMARY.
  1575         16  BK-COMPANY-CD           PIC X.
  1576         16  BK-CARRIER              PIC X.
  1577         16  BK-GROUPING             PIC X(6).
  1578         16  BK-BANK-NO              PIC X(10).
  1579
  1580     12  BK-MAINT-INFORMATION.
  1581         16  BK-LAST-MAINT-DT        PIC XX.
  1582         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1583         16  BK-LAST-MAINT-USER      PIC X(4).
  1584         16  FILLER                  PIC X(9).
  1585
  1586     12  FILLER                      PIC X(37).
  1587
  1588     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1589
  1590     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1591                            DEPENDING ON BK-BANK-POINTER-CNT.
  1592         16  BK-AM-ACCOUNT           PIC X(10).
  1593         16  BK-AM-EXP-DT            PIC XX.
  1594         16  BK-AM-EFF-DT            PIC XX.
  1595         16  BK-AM-STATE             PIC XX.
  1596         16  FILLER                  PIC X(20).
  1597
  1598******************************************************************
  1599
  1600*    COPY ERCCOMP.
  1601******************************************************************
  1602*                                                                *
  1603*                                                                *
  1604*                            ERCCOMP                             *
  1605*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1606*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  30
* EL050.cbl
  1607*                                                                *
  1608*   ONLINE CREDIT SYSTEM                                         *
  1609*                                                                *
  1610*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1611*                                                                *
  1612*   FILE TYPE = VSAM,KSDS                                        *
  1613*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1614*                                                                *
  1615*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1616*       ALTERNATE PATH = NONE                                    *
  1617*                                                                *
  1618*   LOG = NO                                                     *
  1619*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1620*                                                                *
  1621******************************************************************
  1622*                   C H A N G E   L O G
  1623*
  1624* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1625*-----------------------------------------------------------------
  1626*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1627* EFFECTIVE    NUMBER
  1628*-----------------------------------------------------------------
  1629* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1630* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1631* 092205    2005050300006  PEMA  ADD LEASE FEE
  1632* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1633* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1634* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1635* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1636* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1637* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1638******************************************************************
  1639
  1640 01  COMPENSATION-MASTER.
  1641     12  CO-RECORD-ID                          PIC XX.
  1642         88  VALID-CO-ID                          VALUE 'CO'.
  1643
  1644     12  CO-CONTROL-PRIMARY.
  1645         16  CO-COMPANY-CD                     PIC X.
  1646         16  CO-CONTROL.
  1647             20  CO-CTL-1.
  1648                 24  CO-CARR-GROUP.
  1649                     28  CO-CARRIER            PIC X.
  1650                     28  CO-GROUPING.
  1651                         32  CO-GROUP-PREFIX   PIC XXX.
  1652                         32  CO-GROUP-PRIME    PIC XXX.
  1653                 24  CO-RESP-NO.
  1654                     28  CO-RESP-PREFIX        PIC X(4).
  1655                     28  CO-RESP-PRIME         PIC X(6).
  1656             20  CO-CTL-2.
  1657                 24  CO-ACCOUNT.
  1658                     28  CO-ACCT-PREFIX        PIC X(4).
  1659                     28  CO-ACCT-PRIME         PIC X(6).
  1660         16  CO-TYPE                           PIC X.
  1661             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1662             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1663             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1664
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  31
* EL050.cbl
  1665     12  CO-MAINT-INFORMATION.
  1666         16  CO-LAST-MAINT-DT                  PIC XX.
  1667         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1668         16  CO-LAST-MAINT-USER                PIC X(4).
  1669     12  FILLER                                PIC XX.
  1670     12  CO-STMT-TYPE                          PIC XXX.
  1671     12  CO-COMP-TYPE                          PIC X.
  1672         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1673     12  CO-STMT-OWNER                         PIC X(4).
  1674     12  CO-BALANCE-CONTROL                    PIC X.
  1675         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1676         88  CO-NO-BALANCE                        VALUE 'N'.
  1677
  1678     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1679         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1680         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1681         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1682
  1683     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1684         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1685         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1686
  1687     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1688     12  CO-GA-DIRECT-DEP                      PIC X.
  1689     12  CO-FUTURE-SPACE                       PIC X.
  1690         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1691
  1692     12  CO-ACCT-NAME                          PIC X(30).
  1693     12  CO-MAIL-NAME                          PIC X(30).
  1694     12  CO-ADDR-1                             PIC X(30).
  1695     12  CO-ADDR-2                             PIC X(30).
  1696     12  CO-ADDR-3.
  1697         16  CO-ADDR-CITY                      PIC X(27).
  1698         16  CO-ADDR-STATE                     PIC XX.
  1699     12  CO-CSO-1099                           PIC X.
  1700     12  CO-ZIP.
  1701         16  CO-ZIP-PRIME.
  1702             20  CO-ZIP-PRI-1ST                PIC X.
  1703                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1704             20  FILLER                        PIC X(4).
  1705         16  CO-ZIP-PLUS4                      PIC X(4).
  1706     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1707         16  CO-CAN-POSTAL-1                   PIC XXX.
  1708         16  CO-CAN-POSTAL-2                   PIC XXX.
  1709         16  FILLER                            PIC XXX.
  1710     12  CO-SOC-SEC                            PIC X(13).
  1711     12  CO-TELEPHONE.
  1712         16  CO-AREA-CODE                      PIC XXX.
  1713         16  CO-PREFIX                         PIC XXX.
  1714         16  CO-PHONE                          PIC X(4).
  1715
  1716     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1717
  1718     12  CO-AR-BAL-LEVEL                       PIC X.
  1719         88  CO-AR-REF-LVL                        VALUE '1'.
  1720         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1721         88  CO-AR-BILL-LVL                       VALUE '2'.
  1722         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  32
* EL050.cbl
  1723         88  CO-AR-FR-LVL                         VALUE '4'.
  1724
  1725     12  CO-AR-NORMAL-PRINT                    PIC X.
  1726         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1727         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1728
  1729     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1730
  1731     12  CO-AR-REPORTING                       PIC X.
  1732         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1733         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1734
  1735     12  CO-AR-PULL-CHECK                      PIC X.
  1736         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1737         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1738
  1739     12  CO-AR-BALANCE-PRINT                   PIC X.
  1740         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1741
  1742     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1743         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1744         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1745         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1746
  1747     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1748
  1749     12  CO-USER-CODE                          PIC X.
  1750     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1751
  1752******************************************************************
  1753*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1754*    THE LAST MONTH END RUN.
  1755******************************************************************
  1756
  1757     12  CO-LAST-ACTIVITY-DATE.
  1758         16  CO-ACT-YEAR                       PIC 99.
  1759         16  CO-ACT-MONTH                      PIC 99.
  1760         16  CO-ACT-DAY                        PIC 99.
  1761
  1762     12  CO-LAST-STMT-DT.
  1763         16  CO-LAST-STMT-YEAR                 PIC 99.
  1764         16  CO-LAST-STMT-MONTH                PIC 99.
  1765         16  CO-LAST-STMT-DAY                  PIC 99.
  1766
  1767     12  CO-MO-END-TOTALS.
  1768         16  CO-MONTHLY-TOTALS.
  1769             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1770             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1771             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1772             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1773             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1774
  1775         16  CO-AGING-TOTALS.
  1776             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1777             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1778             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1779             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1780
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  33
* EL050.cbl
  1781         16  CO-YTD-TOTALS.
  1782             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1783             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1784
  1785         16  CO-OVER-UNDER-TOTALS.
  1786             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1787             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1788
  1789     12  CO-MISCELLANEOUS-TOTALS.
  1790         16  CO-FICA-TOTALS.
  1791             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1792             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1793
  1794         16  CO-CLAIM-TOTALS.
  1795             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1796             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1797
  1798******************************************************************
  1799*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1800*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1801******************************************************************
  1802
  1803     12  CO-CURRENT-TOTALS.
  1804         16  CO-CURRENT-LAST-STMT-DT.
  1805             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1806             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1807             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1808
  1809         16  CO-CURRENT-MONTHLY-TOTALS.
  1810             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1811             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1812             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1813             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1814             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1815
  1816         16  CO-CURRENT-AGING-TOTALS.
  1817             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1818             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1819             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1820             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1821
  1822         16  CO-CURRENT-YTD-TOTALS.
  1823             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1824             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1825
  1826     12  CO-PAID-COMM-TOTALS.
  1827         16  CO-YTD-PAID-COMMS.
  1828             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1829             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1830
  1831     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1832         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1833         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1834
  1835     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1836         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1837         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1838         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  34
* EL050.cbl
  1839         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1840         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1841         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1842         88  CO-FINAL-LETTER                  VALUE 'F'.
  1843         88  CO-RECONCILING                   VALUE 'R'.
  1844         88  CO-PHONE-CALL                    VALUE 'P'.
  1845         88  CO-LEGAL                         VALUE 'L'.
  1846         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1847         88  CO-WRITE-OFF                     VALUE 'W'.
  1848         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1849
  1850     12  CO-CSR-CODE                       PIC X(4).
  1851
  1852     12  CO-GA-STATUS-INFO.
  1853         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1854         16  CO-GA-TERMINATION-DT          PIC XX.
  1855         16  CO-GA-STATUS-CODE             PIC X.
  1856             88  CO-GA-ACTIVE                 VALUE 'A'.
  1857             88  CO-GA-INACTIVE               VALUE 'I'.
  1858             88  CO-GA-PENDING                VALUE 'P'.
  1859         16  CO-GA-COMMENTS.
  1860             20  CO-GA-COMMENT-1           PIC X(40).
  1861             20  CO-GA-COMMENT-2           PIC X(40).
  1862             20  CO-GA-COMMENT-3           PIC X(40).
  1863             20  CO-GA-COMMENT-4           PIC X(40).
  1864
  1865     12  CO-RPTCD2                         PIC X(10).
  1866     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1867         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1868         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1869
  1870     12  CO-TYPE-AGENT                     PIC X(01).
  1871         88  CO-CORPORATION                   VALUE 'C'.
  1872         88  CO-PARTNERSHIP                   VALUE 'P'.
  1873         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1874         88  CO-TRUST                         VALUE 'T'.
  1875         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1876
  1877     12  CO-FAXNO.
  1878         16  CO-FAX-AREA-CODE                  PIC XXX.
  1879         16  CO-FAX-PREFIX                     PIC XXX.
  1880         16  CO-FAX-PHONE                      PIC X(4).
  1881
  1882     12  CO-BANK-INFORMATION.
  1883         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1884         16  CO-BANK-TRANSIT-NON REDEFINES
  1885             CO-BANK-TRANSIT-NO                PIC 9(8).
  1886
  1887         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1888     12  CO-MISC-DEDUCT-INFO REDEFINES
  1889                  CO-BANK-INFORMATION.
  1890         16  CO-MD-GL-ACCT                     PIC X(10).
  1891         16  CO-MD-DIV                         PIC XX.
  1892         16  CO-MD-CENTER                      PIC X(4).
  1893         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1894         16  CO-CREATE-AP-CHECK                PIC X.
  1895         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1896         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  35
* EL050.cbl
  1897     12  CO-ACH-STATUS                         PIC X.
  1898         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1899         88  CO-ACH-PENDING                        VALUE 'P'.
  1900
  1901     12  CO-BILL-SW                            PIC X.
  1902     12  CO-CONTROL-NAME                       PIC X(30).
  1903     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1904     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1905     12  CO-CLP-STATE                          PIC XX.
  1906     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1907     12  CO-SPP-REFUND-EDIT                    PIC X.
  1908
  1909******************************************************************
  1910
  1911*    COPY ERCAGTC.
  1912******************************************************************
  1913*                                                                *
  1914*                                                                *
  1915*                            ERCAGTC                             *
  1916*                            VMOD=2.001                          *
  1917*                                                                *
  1918*   ONLINE CREDIT SYSTEM                                         *
  1919*                                                                *
  1920*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1921*                                                                *
  1922*   FILE TYPE = VSAM,KSDS                                        *
  1923*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1924*                                                                *
  1925*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1926*       ALTERNATE PATH = NONE                                    *
  1927*                                                                *
  1928*   LOG = NO                                                     *
  1929*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1930*                                                                *
  1931******************************************************************
  1932*                   C H A N G E   L O G
  1933*
  1934* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1935*-----------------------------------------------------------------
  1936*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1937* EFFECTIVE    NUMBER
  1938*-----------------------------------------------------------------
  1939* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1940* 111004                         NEW FILE AND COPYBOOK
  1941* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1942******************************************************************
  1943 01  AGENT-COMMISSIONS.
  1944     12  AG-RECORD-ID                          PIC XX.
  1945         88  VALID-CO-ID                          VALUE 'AG'.
  1946     12  AG-CONTROL-PRIMARY.
  1947         16  AG-COMPANY-CD                     PIC X.
  1948         16  AG-CONTROL.
  1949             20  AG-CTL-1.
  1950                 24  AG-CARR-GROUP.
  1951                     28  AG-CARRIER            PIC X.
  1952                     28  AG-GROUPING           PIC X(6).
  1953                 24  AG-BANK                   PIC X(10).
  1954             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  36
* EL050.cbl
  1955                 24  AG-EXP-DT                 PIC XX.
  1956         16  AG-TYPE                           PIC X.
  1957             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1958             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1959     12  AG-MAINT-INFORMATION.
  1960         16  AG-LAST-MAINT-DT                  PIC XX.
  1961         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1962         16  AG-LAST-MAINT-USER                PIC X(4).
  1963         16  FILLER                            PIC X(10).
  1964     12  AG-EFF-DT                             PIC XX.
  1965     12  AG-COMM-STRUCTURE.
  1966         16  AG-AGT-COMMS OCCURS 10.
  1967             20  AG-AGT                PIC X(10).
  1968             20  AG-COM-TYP            PIC X.
  1969             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1970             20  AG-RECALC-LV-INDIC    PIC X.
  1971             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1972             20  AG-LRCALC-LV-INDIC    PIC X.
  1973             20  FILLER                PIC X(05).
  1974     12  FILLER                  PIC X(145).
  1975******************************************************************
  1976*    COPY ERCRESS.
  1977******************************************************************
  1978*                                                                *
  1979*                            ERCRESS                             *
  1980*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1981*                            VMOD=2.002                          *
  1982*                                                                *
  1983*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1984*                                                                *
  1985*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1986*   VSAM RESIDENT STATE TAX MASTER                              *
  1987*                                                                *
  1988*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1989*                                                                *
  1990*   FILE TYPE = VSAM,KSDS                                        *
  1991*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1992*                                                                *
  1993*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1994*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1995*                                                                *
  1996*   LOG = NO                                                     *
  1997*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1998*                                                                *
  1999*                                                                *
  2000******************************************************************
  2001
  2002 01  RESIDENT-STATE-TAX-MASTER.
  2003
  2004     10  ERRESS-PRIMARY-KEY.
  2005         15  RES-COMPANY-CD        PIC X.
  2006         15  RES-RESIDENT-STATE    PIC XX.
  2007         15  RES-COVERAGE-CATEGORY PIC X.
  2008         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2009*                                      YYYYMMDD
  2010*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2011
  2012     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  37
* EL050.cbl
  2013
  2014         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2015         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2016         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2017         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2018
  2019     10 RES-RECALC-SW              PIC   X.
  2020         88 RECALC                VALUE 'Y'.
  2021         88 NO-RECALC             VALUE 'N'.
  2022     10  RES-MAINT-BY              PIC X(4).
  2023     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2024     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2025*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  38
* EL050.cbl
  2027*    COPY ERCRESC.
  2028******************************************************************
  2029*                                                                *
  2030*                            ERCRESC                             *
  2031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2032*                            VMOD=2.003                          *
  2033*                                                                *
  2034*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2035*                                                                *
  2036*   FILE TYPE = VSAM,KSDS                                        *
  2037*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2038*                                                                *
  2039*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2040*       ALTERNATE PATH1 = NONE                                   *
  2041*                                                                *
  2042*   LOG = NO                                                     *
  2043*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2044*                                                                *
  2045******************************************************************
  2046
  2047 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2048
  2049     10  ERRESC-RECORD-KEY.
  2050         15  RESC-COMPANY-CD           PIC   X.
  2051         15  RESC-CARRIER              PIC   X.
  2052         15  RESC-GROUP                PIC   X(6).
  2053         15  RESC-STATE                PIC   XX.
  2054         15  RESC-ACCOUNT              PIC   X(10).
  2055         15  RESC-AGENT                PIC   X(10).
  2056         15  RESC-RESIDENT-STATE       PIC   XX.
  2057         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2058*                                           YYYYMMDD
  2059     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2060
  2061     10  RESC-COMM-RECORD-DATA.
  2062         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2063             20 RESC-COVERAGE-CAT      PIC    X.
  2064             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2065             20 RESC-COMMISSION-TAB REDEFINES
  2066                RESC-COMMISSION-PER    PIC  XXX.
  2067
  2068     10  RESC-MAINT-BY                 PIC X(4).
  2069     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2070     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2071*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  39
* EL050.cbl
  2073*    COPY ERCPLAN.
  2074******************************************************************
  2075*                                                                *
  2076*                                                                *
  2077*                            ERCPLAN                             *
  2078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2079*                            VMOD=2.003                          *
  2080*                                                                *
  2081*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2082*                                                                *
  2083*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2084*   PLAN MASTER                                                  *
  2085*                                                                *
  2086*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2087*                                                                *
  2088*   FILE TYPE = VSAM,KSDS                                        *
  2089*   RECORD SIZE = 420   RECFORM = FIX                            *
  2090*                                                                *
  2091*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2092*       ALTERNATE PATH1 = N/A                                    *
  2093*                                                                *
  2094*   LOG = NO                                                     *
  2095*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2096*                                                                *
  2097*                                                                *
  2098******************************************************************
  2099
  2100 01  PLAN-MASTER.
  2101     12  PL-RECORD-ID                      PIC XX.
  2102         88  VALID-PL-ID                      VALUE 'PL'.
  2103
  2104     12  PL-CONTROL-PRIMARY.
  2105         16  PL-COMPANY-CD                 PIC X.
  2106         16  PL-MSTR-CNTRL.
  2107             20  PL-CONTROL-A.
  2108                 24  PL-CARRIER            PIC X.
  2109                 24  PL-GROUPING           PIC X(6).
  2110                 24  PL-STATE              PIC XX.
  2111                 24  PL-ACCOUNT            PIC X(10).
  2112             20  PL-BENEFIT-TYPE           PIC X.
  2113             20  PL-BENEFIT-CODE           PIC XX.
  2114             20  PL-REVISION-NO            PIC X(3).
  2115
  2116     12  PL-CONTROL-BY-VAR-GRP.
  2117         16  PL-COMPANY-CD-A1              PIC X.
  2118         16  PL-VG-CARRIER                 PIC X.
  2119         16  PL-VG-GROUPING                PIC X(6).
  2120         16  PL-VG-STATE                   PIC XX.
  2121         16  PL-VG-ACCOUNT                 PIC X(10).
  2122         16  PL-BENEFIT-TYPE-A1            PIC X.
  2123         16  PL-BENEFIT-CODE-A1            PIC XX.
  2124         16  PL-REVISION-NO-A1             PIC 999.
  2125
  2126     12  PL-MAINT-INFORMATION.
  2127         16  PL-LAST-MAINT-DT              PIC XX.
  2128         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2129         16  PL-LAST-MAINT-USER            PIC X(4).
  2130         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  40
* EL050.cbl
  2131
  2132     12  PL-LIABILITY-LIMITS.
  2133         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2134         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2135             20  PL-LM-AGE                 PIC S99        COMP-3.
  2136             20  PL-LM-DUR                 PIC S999       COMP-3.
  2137             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2138             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2139
  2140     12  FILLER                            PIC X(30).
  2141
  2142     12  PL-GL-ACCOUNT-NOS.
  2143         16  PL-PREMIUM-GL                 PIC X(8).
  2144         16  PL-COMM-GL                    PIC X(8).
  2145         16  PL-CLAIM-GL                   PIC X(8).
  2146     12  FILLER                            PIC X(24).
  2147     12  PL-TOLERANCES.
  2148         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2149         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2150         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2151         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2152         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2153         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2154     12  PL-OVER-SHORT.
  2155         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2156         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2157     12  FILLER                            PIC X(24).
  2158     12  PLAN-MISC.
  2159         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2160         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2161         16  PL-IG                         PIC X.
  2162         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2163         16  PL-POLICY-FORM                PIC X(12).
  2164         16  PL-EDIT-FOR-FORM              PIC X(01).
  2165         16  PL-DEV-CODE                   PIC XXX.
  2166         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2167         16  PL-CALC-METHOD                PIC X.
  2168         16  PL-BENEFIT-GROUP              PIC X(05).
  2169         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2170
  2171         16  FILLER                        PIC X(99).
  2172******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  41
* EL050.cbl
  2174*    COPY ELCCERT.
  2175******************************************************************
  2176*                                                                *
  2177*                            ELCCERT.                            *
  2178*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2179*                            VMOD=2.013                          *
  2180*                                                                *
  2181*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2182*                                                                *
  2183*   FILE TYPE = VSAM,KSDS                                        *
  2184*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2185*                                                                *
  2186*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2187*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2188*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2189*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2190*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2191*                                                                *
  2192*   LOG = YES                                                    *
  2193*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2194******************************************************************
  2195*                   C H A N G E   L O G
  2196*
  2197* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2198*-----------------------------------------------------------------
  2199*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2200* EFFECTIVE    NUMBER
  2201*-----------------------------------------------------------------
  2202* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2203* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2204* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2205* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2206* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2207* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2208* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2209* 032612  CR2011110200001  PEMA  AHL CHANGES
  2210* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2211* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2212* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2213******************************************************************
  2214
  2215 01  CERTIFICATE-MASTER.
  2216     12  CM-RECORD-ID                      PIC XX.
  2217         88  VALID-CM-ID                      VALUE 'CM'.
  2218
  2219     12  CM-CONTROL-PRIMARY.
  2220         16  CM-COMPANY-CD                 PIC X.
  2221         16  CM-CARRIER                    PIC X.
  2222         16  CM-GROUPING.
  2223             20  CM-GROUPING-PREFIX        PIC X(3).
  2224             20  CM-GROUPING-PRIME         PIC X(3).
  2225         16  CM-STATE                      PIC XX.
  2226         16  CM-ACCOUNT.
  2227             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2228             20  CM-ACCOUNT-PRIME          PIC X(6).
  2229         16  CM-CERT-EFF-DT                PIC XX.
  2230         16  CM-CERT-NO.
  2231             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  42
* EL050.cbl
  2232             20  CM-CERT-SFX               PIC X.
  2233
  2234     12  CM-CONTROL-BY-NAME.
  2235         16  CM-COMPANY-CD-A1              PIC X.
  2236         16  CM-INSURED-LAST-NAME          PIC X(15).
  2237         16  CM-INSURED-INITIALS.
  2238             20  CM-INSURED-INITIAL1       PIC X.
  2239             20  CM-INSURED-INITIAL2       PIC X.
  2240
  2241     12  CM-CONTROL-BY-SSN.
  2242         16  CM-COMPANY-CD-A2              PIC X.
  2243         16  CM-SOC-SEC-NO.
  2244             20  CM-SSN-STATE              PIC XX.
  2245             20  CM-SSN-ACCOUNT            PIC X(6).
  2246             20  CM-SSN-LN3.
  2247                 25  CM-INSURED-INITIALS-A2.
  2248                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2249                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2250                 25 CM-PART-LAST-NAME-A2         PIC X.
  2251
  2252     12  CM-CONTROL-BY-CERT-NO.
  2253         16  CM-COMPANY-CD-A4              PIC X.
  2254         16  CM-CERT-NO-A4                 PIC X(11).
  2255
  2256     12  CM-CONTROL-BY-MEMB.
  2257         16  CM-COMPANY-CD-A5              PIC X.
  2258         16  CM-MEMBER-NO.
  2259             20  CM-MEMB-STATE             PIC XX.
  2260             20  CM-MEMB-ACCOUNT           PIC X(6).
  2261             20  CM-MEMB-LN4.
  2262                 25  CM-INSURED-INITIALS-A5.
  2263                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2264                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2265                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2266
  2267     12  CM-INSURED-PROFILE-DATA.
  2268         16  CM-INSURED-FIRST-NAME.
  2269             20  CM-INSURED-1ST-INIT       PIC X.
  2270             20  FILLER                    PIC X(9).
  2271         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2272         16  CM-INSURED-SEX                PIC X.
  2273             88  CM-SEX-MALE                  VALUE 'M'.
  2274             88  CM-SEX-FEMAL                 VALUE 'F'.
  2275         16  CM-INSURED-JOINT-AGE          PIC 99.
  2276         16  CM-JOINT-INSURED-NAME.
  2277             20  CM-JT-LAST-NAME           PIC X(15).
  2278             20  CM-JT-FIRST-NAME.
  2279                 24  CM-JT-1ST-INIT        PIC X.
  2280                 24  FILLER                PIC X(9).
  2281             20  CM-JT-INITIAL             PIC X.
  2282
  2283     12  CM-LIFE-DATA.
  2284         16  CM-LF-BENEFIT-CD              PIC XX.
  2285         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2286         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2287         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2288         16  CM-LF-DEV-CODE                PIC XXX.
  2289         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  43
* EL050.cbl
  2290         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2291         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2292         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2293         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2294         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2295         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2296         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2297         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2298         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2299         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2300         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2301         16  cm-temp-epiq                  pic xx.
  2302             88  EPIQ-CLASS                  value 'EQ'.
  2303*        16  FILLER                        PIC XX.
  2304
  2305     12  CM-AH-DATA.
  2306         16  CM-AH-BENEFIT-CD              PIC XX.
  2307         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2308         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2309         16  CM-AH-DEV-CODE                PIC XXX.
  2310         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2311         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2312         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2313         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2314         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2315         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2316         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2317         16  CM-AH-PAID-THRU-DT            PIC XX.
  2318             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2319         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2320         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2321         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2322         16  FILLER                        PIC X.
  2323
  2324     12  CM-LOAN-INFORMATION.
  2325         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2326         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2327                                           PIC S9(5)V99  COMP-3.
  2328         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2329         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2330         16  CM-PAY-FREQUENCY              PIC S99.
  2331         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2332         16  CM-RATE-CLASS                 PIC XX.
  2333         16  CM-BENEFICIARY                PIC X(25).
  2334         16  CM-POLICY-FORM-NO             PIC X(12).
  2335         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2336         16  CM-LAST-ADD-ON-DT             PIC XX.
  2337         16  CM-DEDUCTIBLE-AMOUNTS.
  2338             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2339             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2340         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2341             20  CM-RESIDENT-STATE         PIC XX.
  2342             20  CM-RATE-CODE              PIC X(4).
  2343             20  FILLER                    PIC XX.
  2344         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2345             20  CM-LOAN-OFFICER           PIC X(5).
  2346             20  FILLER                    PIC XXX.
  2347         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  44
* EL050.cbl
  2348         16  CM-UNDERWRITING-CODE          PIC X.
  2349             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2350         16  CM-POST-CARD-IND              PIC X.
  2351         16  CM-REF-INTERFACE-SW           PIC X.
  2352         16  CM-PREMIUM-TYPE               PIC X.
  2353             88  CM-SING-PRM                  VALUE '1'.
  2354             88  CM-O-B-COVERAGE              VALUE '2'.
  2355             88  CM-OPEN-END                  VALUE '3'.
  2356         16  CM-IND-GRP-TYPE               PIC X.
  2357             88  CM-INDIVIDUAL                VALUE 'I'.
  2358             88  CM-GROUP                     VALUE 'G'.
  2359         16  CM-SKIP-CODE                  PIC X.
  2360             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2361             88  SKIP-JULY                    VALUE '1'.
  2362             88  SKIP-AUGUST                  VALUE '2'.
  2363             88  SKIP-SEPTEMBER               VALUE '3'.
  2364             88  SKIP-JULY-AUG                VALUE '4'.
  2365             88  SKIP-AUG-SEPT                VALUE '5'.
  2366             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2367             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2368             88  SKIP-JUNE                    VALUE '8'.
  2369             88  SKIP-JUNE-JULY               VALUE '9'.
  2370             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2371             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2372         16  CM-PAYMENT-MODE               PIC X.
  2373             88  PAY-MONTHLY                  VALUE SPACE.
  2374             88  PAY-WEEKLY                   VALUE '1'.
  2375             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2376             88  PAY-BI-WEEKLY                VALUE '3'.
  2377             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2378         16  CM-LOAN-NUMBER                PIC X(8).
  2379         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2380         16  CM-OLD-LOF                    PIC XXX.
  2381*        16  CM-LOAN-OFFICER               PIC XXX.
  2382         16  CM-REIN-TABLE                 PIC XXX.
  2383         16  CM-SPECIAL-REIN-CODE          PIC X.
  2384         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2385         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2386         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2387
  2388     12  CM-STATUS-DATA.
  2389         16  CM-ENTRY-STATUS               PIC X.
  2390         16  CM-ENTRY-DT                   PIC XX.
  2391
  2392         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2393         16  CM-LF-CANCEL-DT               PIC XX.
  2394         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2395
  2396         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2397         16  CM-LF-DEATH-DT                PIC XX.
  2398         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2399
  2400         16  CM-LF-CURRENT-STATUS          PIC X.
  2401             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2402                                                'M' '4' '5' '9'.
  2403             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2404             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2405             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  45
* EL050.cbl
  2406             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2407             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2408             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2409             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2410             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2411             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2412             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2413             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2414             88  CM-LF-DECLINED               VALUE 'D'.
  2415             88  CM-LF-VOIDED                 VALUE 'V'.
  2416
  2417         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2418         16  CM-AH-CANCEL-DT               PIC XX.
  2419         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2420
  2421         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2422         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2423         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2424
  2425         16  CM-AH-CURRENT-STATUS          PIC X.
  2426             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2427                                                'M' '4' '5' '9'.
  2428             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2429             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2430             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2431             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2432             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2433             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2434             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2435             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2436             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2437             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2438             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2439             88  CM-AH-DECLINED               VALUE 'D'.
  2440             88  CM-AH-VOIDED                 VALUE 'V'.
  2441
  2442         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2443             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2444             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2445             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2446         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2447
  2448         16  CM-ENTRY-BATCH                PIC X(6).
  2449         16  CM-LF-EXIT-BATCH              PIC X(6).
  2450         16  CM-AH-EXIT-BATCH              PIC X(6).
  2451         16  CM-LAST-MONTH-END             PIC XX.
  2452
  2453     12  CM-NOTE-SW                        PIC X.
  2454         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2455         88  CERT-NOTES-PRESENT               VALUE '1'.
  2456         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2457         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2458         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2459         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2460         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2461         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2462     12  CM-COMP-EXCP-SW                   PIC X.
  2463         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  46
* EL050.cbl
  2464         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2465     12  CM-INSURED-ADDRESS-SW             PIC X.
  2466         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2467         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2468
  2469*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2470     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2471     12  FILLER                            PIC X.
  2472
  2473*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2474     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2475     12  FILLER                            PIC X.
  2476*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2477     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2478
  2479     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2480         88  CERT-ADDED-BATCH                 VALUE ' '.
  2481         88  CERT-ADDED-ONLINE                VALUE '1'.
  2482         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2483         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2484         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2485     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2486         88  CERT-AS-LOADED                   VALUE ' '.
  2487         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2488         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2489         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2490         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2491         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2492         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2493         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2494
  2495     12  CM-ACCOUNT-COMM-PCTS.
  2496         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2497         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2498
  2499     12  CM-USER-FIELD                     PIC X.
  2500     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2501     12  CM-CLP-STATE                      PIC XX.
  2502     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2503     12  CM-USER-RESERVED                  PIC XXX.
  2504     12  FILLER REDEFINES CM-USER-RESERVED.
  2505         16  CM-AH-CLASS-CD                PIC XX.
  2506         16  F                             PIC X.
  2507******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  47
* EL050.cbl
  2509*    COPY ERCMAIL.
  2510******************************************************************
  2511*                                                                *
  2512*                                                                *
  2513*                            ERCMAIL                             *
  2514*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2515*                            VMOD=2.003                          *
  2516*                                                                *
  2517*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2518*                                                                *
  2519*   FILE TYPE = VSAM,KSDS                                        *
  2520*   RECORD SIZE = 374   RECFORM = FIX                            *
  2521*                                                                *
  2522*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2523*   ALTERNATE PATH    = NOT USED                                 *
  2524*                                                                *
  2525*   LOG = YES                                                    *
  2526*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2527******************************************************************
  2528*                   C H A N G E   L O G
  2529*
  2530* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2531*-----------------------------------------------------------------
  2532*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2533* EFFECTIVE    NUMBER
  2534*-----------------------------------------------------------------
  2535* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2536* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2537* 111108                   PEMA  ADD CRED BENE ADDR2
  2538******************************************************************
  2539
  2540 01  MAILING-DATA.
  2541     12  MA-RECORD-ID                      PIC XX.
  2542         88  VALID-MA-ID                       VALUE 'MA'.
  2543
  2544     12  MA-CONTROL-PRIMARY.
  2545         16  MA-COMPANY-CD                 PIC X.
  2546         16  MA-CARRIER                    PIC X.
  2547         16  MA-GROUPING.
  2548             20  MA-GROUPING-PREFIX        PIC XXX.
  2549             20  MA-GROUPING-PRIME         PIC XXX.
  2550         16  MA-STATE                      PIC XX.
  2551         16  MA-ACCOUNT.
  2552             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2553             20  MA-ACCOUNT-PRIME          PIC X(6).
  2554         16  MA-CERT-EFF-DT                PIC XX.
  2555         16  MA-CERT-NO.
  2556             20  MA-CERT-PRIME             PIC X(10).
  2557             20  MA-CERT-SFX               PIC X.
  2558
  2559     12  FILLER                            PIC XX.
  2560
  2561     12  MA-ACCESS-CONTROL.
  2562         16  MA-SOURCE-SYSTEM              PIC XX.
  2563             88  MA-FROM-CREDIT                VALUE 'CR'.
  2564             88  MA-FROM-VSI                   VALUE 'VS'.
  2565             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2566             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  48
* EL050.cbl
  2567         16  MA-RECORD-ADD-DT              PIC XX.
  2568         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2569         16  MA-LAST-MAINT-DT              PIC XX.
  2570         16  MA-LAST-MAINT-BY              PIC XXXX.
  2571         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2572
  2573     12  MA-PROFILE-INFO.
  2574         16  MA-QUALIFY-CODE-1             PIC XX.
  2575         16  MA-QUALIFY-CODE-2             PIC XX.
  2576         16  MA-QUALIFY-CODE-3             PIC XX.
  2577         16  MA-QUALIFY-CODE-4             PIC XX.
  2578         16  MA-QUALIFY-CODE-5             PIC XX.
  2579
  2580         16  MA-INSURED-LAST-NAME          PIC X(15).
  2581         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2582         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2583         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2584         16  MA-INSURED-BIRTH-DT           PIC XX.
  2585         16  MA-INSURED-SEX                PIC X.
  2586             88  MA-SEX-MALE                   VALUE 'M'.
  2587             88  MA-SEX-FEMALE                 VALUE 'F'.
  2588         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2589
  2590         16  MA-ADDRESS-CORRECTED          PIC X.
  2591         16  MA-JOINT-BIRTH-DT             PIC XX.
  2592*        16  FILLER                        PIC X(12).
  2593
  2594         16  MA-ADDRESS-LINE-1             PIC X(30).
  2595         16  MA-ADDRESS-LINE-2             PIC X(30).
  2596         16  MA-CITY-STATE.
  2597             20  MA-CITY                   PIC X(28).
  2598             20  MA-ADDR-STATE             PIC XX.
  2599         16  MA-ZIP.
  2600             20  MA-ZIP-CODE.
  2601                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2602                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2603                 24  FILLER                PIC X(4).
  2604             20  MA-ZIP-PLUS4              PIC X(4).
  2605         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2606             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2607             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2608             20  FILLER                    PIC X(3).
  2609
  2610         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2611
  2612         16  FILLER                        PIC XXX.
  2613*        16  FILLER                        PIC X(10).
  2614
  2615     12  MA-CRED-BENE-INFO.
  2616         16  MA-CRED-BENE-NAME                 PIC X(25).
  2617         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2618         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2619         16  MA-CRED-BENE-CTYST.
  2620             20  MA-CRED-BENE-CITY             PIC X(28).
  2621             20  MA-CRED-BENE-STATE            PIC XX.
  2622         16  MA-CRED-BENE-ZIP.
  2623             20  MA-CB-ZIP-CODE.
  2624                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  49
* EL050.cbl
  2625                     88  MA-CB-CANADIAN-POST-CODE
  2626                                           VALUE 'A' THRU 'Z'.
  2627                 24  FILLER                    PIC X(4).
  2628             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2629         16  MA-CB-CANADIAN-POSTAL-CODE
  2630                            REDEFINES MA-CRED-BENE-ZIP.
  2631             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2632             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2633             20  FILLER                        PIC X(3).
  2634     12  MA-POST-CARD-MAIL-DATA.
  2635         16  MA-MAIL-DATA OCCURS 7.
  2636             20  MA-MAIL-TYPE              PIC X.
  2637                 88  MA-12MO-MAILING           VALUE '1'.
  2638                 88  MA-EXP-MAILING            VALUE '2'.
  2639             20  MA-MAIL-STATUS            PIC X.
  2640                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2641                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2642                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2643             20  MA-MAIL-DATE              PIC XX.
  2644     12  FILLER                            PIC XX.
  2645     12  FILLER                            PIC XX.
  2646*    12  FILLER                            PIC X(30).
  2647******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  50
* EL050.cbl
  2649*    COPY ERCPNDM.
  2650******************************************************************
  2651*                                                                *
  2652*                                                                *
  2653*                            ERCPNDM                             *
  2654*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2655*                            VMOD=2.003                          *
  2656*                                                                *
  2657*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2658*                                                                *
  2659*   FILE TYPE = VSAM,KSDS                                        *
  2660*   RECORD SIZE = 374   RECFORM = FIX                            *
  2661*                                                                *
  2662*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2663*   ALTERNATE PATH    = NOT USED                                 *
  2664*                                                                *
  2665*   LOG = YES                                                    *
  2666*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2667******************************************************************
  2668*                   C H A N G E   L O G
  2669*
  2670* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2671*-----------------------------------------------------------------
  2672*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2673* EFFECTIVE    NUMBER
  2674*-----------------------------------------------------------------
  2675* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2676* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2677* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2678* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2679******************************************************************
  2680
  2681 01  PENDING-MAILING-DATA.
  2682     12  PM-RECORD-ID                      PIC XX.
  2683         88  VALID-MA-ID                       VALUE 'PM'.
  2684
  2685     12  PM-CONTROL-PRIMARY.
  2686         16  PM-COMPANY-CD                 PIC X.
  2687         16  PM-ENTRY-BATCH                PIC X(6).
  2688         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2689         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2690
  2691     12  FILLER                            PIC X(14).
  2692
  2693     12  PM-ACCESS-CONTROL.
  2694         16  PM-SOURCE-SYSTEM              PIC XX.
  2695             88  PM-FROM-CREDIT                VALUE 'CR'.
  2696             88  PM-FROM-VSI                   VALUE 'VS'.
  2697             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2698             88  PM-FROM-OTHER                 VALUE 'OT'.
  2699         16  PM-RECORD-ADD-DT              PIC XX.
  2700         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2701         16  PM-LAST-MAINT-DT              PIC XX.
  2702         16  PM-LAST-MAINT-BY              PIC XXXX.
  2703         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2704
  2705     12  PM-PROFILE-INFO.
  2706         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  51
* EL050.cbl
  2707         16  PM-QUALIFY-CODE-2             PIC XX.
  2708         16  PM-QUALIFY-CODE-3             PIC XX.
  2709         16  PM-QUALIFY-CODE-4             PIC XX.
  2710         16  PM-QUALIFY-CODE-5             PIC XX.
  2711
  2712         16  PM-INSURED-LAST-NAME          PIC X(15).
  2713         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2714         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2715         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2716         16  PM-INSURED-BIRTH-DT           PIC XX.
  2717         16  PM-INSURED-SEX                PIC X.
  2718             88  PM-SEX-MALE                   VALUE 'M'.
  2719             88  PM-SEX-FEMALE                 VALUE 'F'.
  2720         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2721
  2722         16  PM-ADDRESS-CORRECTED          PIC X.
  2723         16  PM-JOINT-BIRTH-DT             PIC XX.
  2724*        16  FILLER                        PIC X(12).
  2725
  2726         16  PM-ADDRESS-LINE-1             PIC X(30).
  2727         16  PM-ADDRESS-LINE-2             PIC X(30).
  2728         16  PM-CITY-STATE.
  2729             20  PM-CITY                   PIC X(28).
  2730             20  PM-STATE                  PIC XX.
  2731         16  PM-ZIP.
  2732             20  PM-ZIP-CODE.
  2733                 24  PM-ZIP-1              PIC X.
  2734                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2735                 24  FILLER                PIC X(4).
  2736             20  PM-ZIP-PLUS4              PIC X(4).
  2737         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2738             20  PM-CAN-POST1              PIC XXX.
  2739             20  PM-CAN-POST2              PIC XXX.
  2740             20  FILLER                    PIC XXX.
  2741
  2742         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2743         16  pm-city-st-zip-verified       pic x.
  2744         16  FILLER                        PIC XX.
  2745
  2746     12  PM-CRED-BENE-INFO.
  2747         16  PM-CRED-BENE-NAME             PIC X(25).
  2748         16  PM-CRED-BENE-ADDR             PIC X(30).
  2749         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2750         16  PM-CRED-BENE-CTYST.
  2751             20  PM-CRED-BENE-CITY         PIC X(28).
  2752             20  PM-CRED-BENE-STATE        PIC XX.
  2753         16  PM-CRED-BENE-ZIP.
  2754             20  PM-CB-ZIP-CODE.
  2755                 24  PM-CB-ZIP-1           PIC X.
  2756                     88  PM-CB-CANADIAN-POST-CODE
  2757                                  VALUE 'A' THRU 'Z'.
  2758                 24  FILLER                PIC X(4).
  2759             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2760         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2761             20  PM-CB-CAN-POST1           PIC XXX.
  2762             20  PM-CB-CAN-POST2           PIC XXX.
  2763             20  FILLER                    PIC XXX.
  2764     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  52
* EL050.cbl
  2765         16  PM-MAIL-DATA OCCURS 7.
  2766             20  PM-MAIL-TYPE              PIC X.
  2767                 88  PM-12MO-MAILING           VALUE '1'.
  2768                 88  PM-EXP-MAILING            VALUE '2'.
  2769             20  PM-MAIL-STATUS            PIC X.
  2770                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2771                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2772                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2773             20  PM-MAIL-DATE              PIC XX.
  2774     12  FILLER                            PIC XX.
  2775     12  FILLER                            PIC X(12).
  2776*    12  FILLER                            PIC X(30).
  2777
  2778******************************************************************
  2779*                                COPY ERCLOFC.
  2780******************************************************************
  2781*                                                                *
  2782*                                                                *
  2783*                            ERCLOFC                             *
  2784*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2785*                            VMOD=2.003                          *
  2786*                                                                *
  2787*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2788*                                                                *
  2789*   FILE TYPE = VSAM,KSDS                                        *
  2790*   RECORD SIZE = 670   RECFORM = FIX                            *
  2791*                                                                *
  2792*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2793*                                                                *
  2794*   LOG = YES                                                    *
  2795*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2796*                                                                *
  2797******************************************************************
  2798
  2799 01  LOAN-OFFICER-MASTER.
  2800     12  LO-RECORD-ID                PIC XX.
  2801         88  VALID-LO-ID                VALUE 'LO'.
  2802
  2803     12  LO-CONTROL-PRIMARY.
  2804         16  LO-COMPANY-CD           PIC X.
  2805         16  LO-CARRIER              PIC X.
  2806         16  LO-GROUPING.
  2807             20  LO-GROUPING-PREFIX  PIC XXX.
  2808             20  LO-GROUPING-PRIME   PIC XXX.
  2809         16  LO-STATE                PIC XX.
  2810         16  LO-ACCOUNT.
  2811             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2812             20  LO-ACCOUNT-PRIME    PIC X(6).
  2813         16  LO-OFFICER-CODE         PIC X(5).
  2814
  2815     12  LO-OFFICER-NAME             PIC X(30).
  2816
  2817     12  LO-LAST-MAINT-DT            PIC XX.
  2818     12  LO-LAST-USER                PIC X(4).
  2819     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2820
  2821     12  LO-COMP-CONTROL             PIC X.
  2822             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  53
* EL050.cbl
  2823             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2824     12  LO-DETAIL-CONTROL           PIC X.
  2825             88  LO-PRINT-DETAIL        VALUE 'D'.
  2826             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2827
  2828     12  LO-SV-CARRIER               PIC X.
  2829     12  LO-SV-GROUPING              PIC X(6).
  2830     12  LO-SV-STATE                 PIC XX.
  2831
  2832     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2833     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2834
  2835     12  LO-OFFICER-INFO.
  2836         16  FILLER OCCURS 12 TIMES.
  2837             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2838             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2839             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2840             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2841             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2842             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2843             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2844             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2845     12  FILLER                      PIC X(198).
  2846******************************************************************
  2847*                                COPY ERCPDEF.
  2848******************************************************************
  2849*                                                                *
  2850*                                                                *
  2851*                            ERCPDEF.                            *
  2852*                                                                *
  2853*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2854*                                                                *
  2855*    FILE TYPE = VSAM,KSDS                                       *
  2856*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2857*                                                                *
  2858*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2859*                                                                *
  2860*    LOG = YES                                                   *
  2861*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2862******************************************************************
  2863*                   C H A N G E   L O G
  2864*
  2865* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2866*-----------------------------------------------------------------
  2867*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2868* EFFECTIVE    NUMBER
  2869*-----------------------------------------------------------------
  2870* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2871* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2872* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2873******************************************************************
  2874 01  PRODUCT-MASTER.
  2875    12  PD-RECORD-ID                 PIC X(02).
  2876        88  VALID-PD-ID                  VALUE 'PD'.
  2877    12  PD-CONTROL-PRIMARY.
  2878        16  PD-COMPANY-CD            PIC X.
  2879        16  PD-STATE                 PIC XX.
  2880        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  54
* EL050.cbl
  2881        16  PD-FILLER                PIC X(7).
  2882        16  PD-BEN-TYPE              PIC X.
  2883        16  PD-BEN-CODE              PIC XX.
  2884        16  PD-PROD-EXP-DT           PIC XX.
  2885    12  FILLER                       PIC X(50).
  2886    12  PD-PRODUCT-DATA OCCURS 8.
  2887        16  PD-PROD-CODE             PIC X.
  2888            88  PD-PROD-LIFE           VALUE 'L'.
  2889            88  PD-PROD-PROP           VALUE 'P'.
  2890            88  PD-PROD-AH             VALUE 'A'.
  2891            88  PD-PROD-IU             VALUE 'I'.
  2892            88  PD-PROD-GAP            VALUE 'G'.
  2893            88  PD-PROD-FAML           VALUE 'F'.
  2894        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2895        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2896        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2897        16  PD-MAX-TERM              PIC S999        COMP-3.
  2898        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2899        16  FILLER                   PIC X.
  2900        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2901        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2902        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2903        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2904        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2905        16  PD-REC-CRIT-PERIOD       PIC 99.
  2906        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2907            20  PD-RECURRING-YN      PIC X.
  2908            20  FILLER               PIC X.
  2909        16  PD-RTW-MOS               PIC 99.
  2910        16  PD-MAX-EXTENSION         PIC 99.
  2911        16  pd-ben-pct               pic sv999 comp-3.
  2912*       16  FILLER                   PIC XX.
  2913    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2914    12  PD-TERM-LIMITS OCCURS 15.
  2915        16  PD-LOW-TERM              PIC S999        COMP-3.
  2916        16  PD-HI-TERM               PIC S999        COMP-3.
  2917*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2918    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2919        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2920        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2921    12  PD-EARN-FACTORS.
  2922        16  FILLER OCCURS 15.
  2923            20  FILLER OCCURS 15.
  2924                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2925    12  PD-PRODUCT-DESC              PIC X(80).
  2926    12  PD-TRUNCATED                 PIC X.
  2927    12  FILLER                       PIC X(59).
  2928    12  PD-MAINT-INFORMATION.
  2929        16  PD-LAST-MAINT-DT         PIC X(02).
  2930        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2931        16  PD-LAST-MAINT-BY         PIC X(04).
  2932*                                COPY ELCSTATE.
  2933******************************************************************
  2934*                                                                *
  2935*                                                                *
  2936*                            ELCSTATE.                           *
  2937*                                                                *
  2938*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  55
* EL050.cbl
  2939*                                                                *
  2940*   FILE TYPE = VSAM,KSDS                                        *
  2941*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2942*                                                                *
  2943*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2944*       ALTERNATE INDEX = NONE                                   *
  2945*                                                                *
  2946*   LOG = YES                                                    *
  2947*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2948******************************************************************
  2949*                   C H A N G E   L O G
  2950*
  2951* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2952*-----------------------------------------------------------------
  2953*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2954* EFFECTIVE    NUMBER
  2955*-----------------------------------------------------------------
  2956* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2957******************************************************************
  2958*
  2959 01  STATE-FILE.
  2960     12  SF-RECORD-ID                       PIC XX.
  2961         88  VALID-CF-ID                        VALUE 'SF'.
  2962     12  SF-CONTROL-PRIMARY.
  2963         16  SF-COMPANY-ID                  PIC XXX.
  2964         16  SF-CARRIER-CODE                PIC X.
  2965         16  SF-GROUPING                    PIC X(6).
  2966         16  SF-STATE-CODE                  PIC XX.
  2967         16  SF-EXPIRE-DATE                 PIC 9(8).
  2968****************************************************************
  2969*             STATE CONTROLS
  2970****************************************************************
  2971     12  SF-LAST-MAINT-DT                   PIC XX.
  2972     12  SF-LAST-MAINT-BY                   PIC X(4).
  2973     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2974     12  SF-STATE-RT-CONTROLS.
  2975         16  SF-ST-RT-CALC                  PIC X.
  2976     12  SF-ST-TAX-CONTROLS.
  2977         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2978         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2979         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2980     12  SF-ST-REFUND-OPTIONS.
  2981         16  SF-ST-RF-LR-CALC               PIC X.
  2982         16  SF-ST-RF-LL-CALC               PIC X.
  2983         16  SF-ST-RF-LN-CALC               PIC X.
  2984         16  SF-ST-RF-AH-CALC               PIC X.
  2985         16  SF-ST-RF-CP-CALC               PIC X.
  2986     12  SF-ST-UNEARN-PREM-OPTIONS.
  2987         16  SF-ST-LUEP-R78                 PIC X.
  2988         16  SF-ST-LUEP-PRO                 PIC X.
  2989         16  SF-ST-LUEP-ST                  PIC X.
  2990         16  SF-ST-LUEP-DOM                 PIC X.
  2991         16  SF-ST-AUEP-R78                 PIC X.
  2992         16  SF-ST-AUEP-PRO                 PIC X.
  2993         16  SF-ST-AUEP-ST                  PIC X.
  2994         16  SF-ST-AUEP-DOM                 PIC X.
  2995         16  SF-ST-CUEP-R78                 PIC X.
  2996         16  SF-ST-CUEP-PRO                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  56
* EL050.cbl
  2997         16  SF-ST-CUEP-ST                  PIC X.
  2998         16  SF-ST-CUEP-DOM                 PIC X.
  2999     12  SF-ST-EARN-PREM-OPTIONS.
  3000         16  SF-ST-LEP-R78                  PIC X.
  3001         16  SF-ST-LEP-PRO                  PIC X.
  3002         16  SF-ST-LEP-ST                   PIC X.
  3003         16  SF-ST-LEP-DOM                  PIC X.
  3004         16  SF-ST-AEP-R78                  PIC X.
  3005         16  SF-ST-AEP-PRO                  PIC X.
  3006         16  SF-ST-AEP-ST                   PIC X.
  3007         16  SF-ST-AEP-DOM                  PIC X.
  3008         16  SF-ST-CEP-R78                  PIC X.
  3009         16  SF-ST-CEP-PRO                  PIC X.
  3010         16  SF-ST-CEP-ST                   PIC X.
  3011         16  SF-ST-CEP-DOM                  PIC X.
  3012     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  57
* EL050.cbl
  3014*    COPY ELCCRTT.
  3015******************************************************************
  3016*                                                                *
  3017*                            ELCCRTT.                            *
  3018*                                                                *
  3019*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3020*                                                                *
  3021*   FILE TYPE = VSAM,KSDS                                        *
  3022*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3023*                                                                *
  3024*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3025*                                                                *
  3026*   LOG = YES                                                    *
  3027*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3028******************************************************************
  3029*                   C H A N G E   L O G
  3030*
  3031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3032*-----------------------------------------------------------------
  3033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3034* EFFECTIVE    NUMBER
  3035*-----------------------------------------------------------------
  3036* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3037* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3038* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3039* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3040* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3041* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3042* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3043* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3044* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3045******************************************************************
  3046
  3047 01  CERTIFICATE-TRAILERS.
  3048     12  CS-RECORD-ID                      PIC XX.
  3049         88  VALID-CS-ID                      VALUE 'CS'.
  3050
  3051     12  CS-CONTROL-PRIMARY.
  3052         16  CS-COMPANY-CD                 PIC X.
  3053         16  CS-CARRIER                    PIC X.
  3054         16  CS-GROUPING                   PIC X(6).
  3055         16  CS-STATE                      PIC XX.
  3056         16  CS-ACCOUNT                    PIC X(10).
  3057         16  CS-CERT-EFF-DT                PIC XX.
  3058         16  CS-CERT-NO.
  3059             20  CS-CERT-PRIME             PIC X(10).
  3060             20  CS-CERT-SFX               PIC X.
  3061         16  CS-TRAILER-TYPE               PIC X.
  3062             88  COMM-TRLR           VALUE 'A'.
  3063             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3064             88  CERT-DATA-TRLR      VALUE 'C'.
  3065
  3066     12  CS-DATA-AREA                      PIC X(516).
  3067
  3068     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3069         16  CS-BANK-COMMISSION-AREA.
  3070             20  CS-BANK-COMMS       OCCURS 10.
  3071                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  58
* EL050.cbl
  3072                 24  CS-COM-TYP            PIC X.
  3073                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3074                 24  CS-RECALC-LV-INDIC    PIC X.
  3075                 24  FILLER                PIC X(10).
  3076         16  FILLER                        PIC X(256).
  3077
  3078     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3079****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3080         16  CS-MB-CLAIM-DATA OCCURS 24.
  3081             20  CS-CLAIM-NO               PIC X(7).
  3082             20  CS-CLAIM-TYPE             PIC X.
  3083                 88  CS-AH-CLM               VALUE 'A'.
  3084                 88  CS-IU-CLM               VALUE 'I'.
  3085                 88  CS-GP-CLM               VALUE 'G'.
  3086                 88  CS-LF-CLM               VALUE 'L'.
  3087                 88  CS-PR-CLM               VALUE 'P'.
  3088                 88  CS-FL-CLM               VALUE 'F'.
  3089             20  CS-INSURED-TYPE           PIC X.
  3090                 88  CS-PRIM-INSURED          VALUE 'P'.
  3091                 88  CS-CO-BORROWER           VALUE 'C'.
  3092             20  CS-BENEFIT-PERIOD         PIC 99.
  3093             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3094             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3095             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3096         16  FILLER                        PIC X(12).
  3097     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3098         16  CS-VIN-NUMBER                 PIC X(17).
  3099         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3100         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3101         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3102         16  cs-agent-name.
  3103             20  cs-agent-fname            pic x(20).
  3104             20  cs-agent-mi               pic x.
  3105             20  cs-agent-lname            pic x(25).
  3106         16  cs-license-no                 pic x(15).
  3107         16  cs-npn-number                 pic x(10).
  3108         16  cs-agent-edit-status          pic x.
  3109             88  cs-ae-refer-to-manager      value 'M'.
  3110             88  cs-ae-cover-sheet           value 'C'.
  3111             88  cs-ae-sig-form              value 'S'.
  3112             88  cs-ae-verified              value 'V'.
  3113             88  cs-unidentified-signature   value 'U'.
  3114             88  cs-cert-returned            value 'R'.
  3115             88  cs-accept-no-commission     value 'N'.
  3116         16  cs-year                       pic 9999.
  3117         16  cs-make                       pic x(20).
  3118         16  cs-model                      pic x(20).
  3119         16  cs-future                     pic x(20).
  3120         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3121         16  FILLER                        PIC X(356). *> was 420
  3122*        16  FILLER                        PIC X(496).
  3123*    COPY ELCCRTO.
  3124******************************************************************
  3125*                                                                *
  3126*                            ELCCRTO.                            *
  3127*                                                                *
  3128*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3129*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  59
* EL050.cbl
  3130*   FILE TYPE = VSAM,KSDS                                        *
  3131*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3132*                                                                *
  3133*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3134*                                                                *
  3135*   LOG = YES                                                    *
  3136*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3137******************************************************************
  3138*                   C H A N G E   L O G
  3139*
  3140* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3141*-----------------------------------------------------------------
  3142*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3143* EFFECTIVE    NUMBER
  3144*-----------------------------------------------------------------
  3145* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3146* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3147* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3148* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3149* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3150******************************************************************
  3151 01  ORIGINAL-CERTIFICATE.
  3152     12  OC-RECORD-ID                      PIC XX.
  3153         88  VALID-OC-ID                      VALUE 'OC'.
  3154     12  OC-CONTROL-PRIMARY.
  3155         16  OC-COMPANY-CD                 PIC X.
  3156         16  OC-CARRIER                    PIC X.
  3157         16  OC-GROUPING                   PIC X(6).
  3158         16  OC-STATE                      PIC XX.
  3159         16  OC-ACCOUNT                    PIC X(10).
  3160         16  OC-CERT-EFF-DT                PIC XX.
  3161         16  OC-CERT-NO.
  3162             20  OC-CERT-PRIME             PIC X(10).
  3163             20  OC-CERT-SFX               PIC X.
  3164         16  OC-RECORD-TYPE                PIC X.
  3165         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3166     12  OC-LAST-MAINT-DT                  PIC XX.
  3167     12  OC-LAST-MAINT-BY                  PIC X(4).
  3168     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3169     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3170     12  FILLER                            PIC X(49).
  3171     12  OC-ORIG-REC.
  3172         16  OC-INS-LAST-NAME              PIC X(15).
  3173         16  OC-INS-FIRST-NAME             PIC X(10).
  3174         16  OC-INS-MIDDLE-INIT            PIC X.
  3175         16  OC-INS-AGE                    PIC S999     COMP-3.
  3176         16  OC-JNT-LAST-NAME              PIC X(15).
  3177         16  OC-JNT-FIRST-NAME             PIC X(10).
  3178         16  OC-JNT-MIDDLE-INIT            PIC X.
  3179         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3180         16  OC-LF-BENCD                   PIC XX.
  3181         16  OC-LF-TERM                    PIC S999      COMP-3.
  3182         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3183         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3184         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3185         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3186         16  OC-LF-EXP-DT                  PIC XX.
  3187         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  60
* EL050.cbl
  3188         16  OC-LF-CANCEL-DT               PIC XX.
  3189         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3190         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3191         16  OC-AH-BENCD                   PIC XX.
  3192         16  OC-AH-TERM                    PIC S999      COMP-3.
  3193         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3194         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3195         16  OC-AH-EXP-DT                  PIC XX.
  3196         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3197         16  OC-AH-CP                      PIC 99.
  3198         16  OC-AH-CANCEL-DT               PIC XX.
  3199         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3200         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3201         16  OC-CRED-BENE-NAME             PIC X(25).
  3202         16  OC-1ST-PMT-DT                 PIC XX.
  3203         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3204         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3205         16  OC-ISSUE-TRAN-IND             PIC X.
  3206         16  OC-CANCEL-TRAN-IND            PIC X.
  3207         16  FILLER                        PIC X(211).
  3208
  3209     12  FILLER                            PIC X(50).
  3210******************************************************************
  3211
  3212*    COPY ELCDATE.
  3213******************************************************************
  3214*                                                                *
  3215*                                                                *
  3216*                            ELCDATE.                            *
  3217*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3218*                            VMOD=2.003
  3219*                                                                *
  3220*                                                                *
  3221*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3222*                 LENGTH = 200                                   *
  3223******************************************************************
  3224
  3225 01  DATE-CONVERSION-DATA.
  3226     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3227     12  DC-OPTION-CODE                PIC X.
  3228         88  BIN-TO-GREG                VALUE ' '.
  3229         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3230         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3231         88  YMD-GREG-TO-BIN            VALUE '3'.
  3232         88  MDY-GREG-TO-BIN            VALUE '4'.
  3233         88  JULIAN-TO-BIN              VALUE '5'.
  3234         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3235         88  FIND-CENTURY               VALUE '7'.
  3236         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3237         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3238         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3239         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3240         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3241         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3242         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3243         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3244         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3245         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  61
* EL050.cbl
  3246         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3247         88  BIN-3-TO-GREG              VALUE 'I'.
  3248         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3249         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3250         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3251         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3252         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3253         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3254         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3255         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3256         88  THREE-CHARACTER-BIN
  3257                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3258         88  GREGORIAN-TO-BIN
  3259                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3260         88  BIN-TO-GREGORIAN
  3261                  VALUES ' ' '1' 'I' '8' 'G'.
  3262         88  JULIAN-TO-BINARY
  3263                  VALUES '5' 'C' 'E' 'F'.
  3264     12  DC-ERROR-CODE                 PIC X.
  3265         88  NO-CONVERSION-ERROR        VALUE ' '.
  3266         88  DATE-CONVERSION-ERROR
  3267                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3268         88  DATE-IS-ZERO               VALUE '1'.
  3269         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3270         88  DATE-IS-INVALID            VALUE '3'.
  3271         88  DATE1-GREATER-DATE2        VALUE '4'.
  3272         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3273         88  DATE-INVALID-OPTION        VALUE '9'.
  3274         88  INVALID-CENTURY            VALUE 'A'.
  3275         88  ONLY-CENTURY               VALUE 'B'.
  3276         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3277         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3278     12  DC-END-OF-MONTH               PIC X.
  3279         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3280     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3281         88  USE-NORMAL-PROCESS         VALUE ' '.
  3282         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3283         88  ADJUST-UP-100-YRS          VALUE '2'.
  3284     12  FILLER                        PIC X.
  3285     12  DC-CONVERSION-DATES.
  3286         16  DC-BIN-DATE-1             PIC XX.
  3287         16  DC-BIN-DATE-2             PIC XX.
  3288         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3289         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3290                       DC-GREG-DATE-1-EDIT.
  3291             20  DC-EDIT1-MONTH        PIC 99.
  3292             20  SLASH1-1              PIC X.
  3293             20  DC-EDIT1-DAY          PIC 99.
  3294             20  SLASH1-2              PIC X.
  3295             20  DC-EDIT1-YEAR         PIC 99.
  3296         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3297         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3298                     DC-GREG-DATE-2-EDIT.
  3299             20  DC-EDIT2-MONTH        PIC 99.
  3300             20  SLASH2-1              PIC X.
  3301             20  DC-EDIT2-DAY          PIC 99.
  3302             20  SLASH2-2              PIC X.
  3303             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  62
* EL050.cbl
  3304         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3305         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3306                     DC-GREG-DATE-1-YMD.
  3307             20  DC-YMD-YEAR           PIC 99.
  3308             20  DC-YMD-MONTH          PIC 99.
  3309             20  DC-YMD-DAY            PIC 99.
  3310         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3311         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3312                      DC-GREG-DATE-1-MDY.
  3313             20  DC-MDY-MONTH          PIC 99.
  3314             20  DC-MDY-DAY            PIC 99.
  3315             20  DC-MDY-YEAR           PIC 99.
  3316         16  DC-GREG-DATE-1-ALPHA.
  3317             20  DC-ALPHA-MONTH        PIC X(10).
  3318             20  DC-ALPHA-DAY          PIC 99.
  3319             20  FILLER                PIC XX.
  3320             20  DC-ALPHA-CENTURY.
  3321                 24 DC-ALPHA-CEN-N     PIC 99.
  3322             20  DC-ALPHA-YEAR         PIC 99.
  3323         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3324         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3325         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3326         16  DC-JULIAN-DATE            PIC 9(05).
  3327         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3328                                       PIC 9(05).
  3329         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3330             20  DC-JULIAN-YEAR        PIC 99.
  3331             20  DC-JULIAN-DAYS        PIC 999.
  3332         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3333         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3334         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3335     12  DATE-CONVERSION-VARIBLES.
  3336         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3337         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3338             20  FILLER                PIC 9(3).
  3339             20  HOLD-CEN-1-CCYY.
  3340                 24  HOLD-CEN-1-CC     PIC 99.
  3341                 24  HOLD-CEN-1-YY     PIC 99.
  3342             20  HOLD-CEN-1-MO         PIC 99.
  3343             20  HOLD-CEN-1-DA         PIC 99.
  3344         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3345             20  HOLD-CEN-1-R-MO       PIC 99.
  3346             20  HOLD-CEN-1-R-DA       PIC 99.
  3347             20  HOLD-CEN-1-R-CCYY.
  3348                 24  HOLD-CEN-1-R-CC   PIC 99.
  3349                 24  HOLD-CEN-1-R-YY   PIC 99.
  3350             20  FILLER                PIC 9(3).
  3351         16  HOLD-CENTURY-1-X.
  3352             20  FILLER                PIC X(3)  VALUE SPACES.
  3353             20  HOLD-CEN-1-X-CCYY.
  3354                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3355                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3356             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3357             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3358         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3359             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3360             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3361             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  63
* EL050.cbl
  3362                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3363                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3364             20  FILLER                PIC XXX.
  3365         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3366         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3367         16  DC-JULIAN-DATE-1          PIC 9(07).
  3368         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3369             20  DC-JULIAN-1-CCYY.
  3370                 24  DC-JULIAN-1-CC    PIC 99.
  3371                 24  DC-JULIAN-1-YR    PIC 99.
  3372             20  DC-JULIAN-DA-1        PIC 999.
  3373         16  DC-JULIAN-DATE-2          PIC 9(07).
  3374         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3375             20  DC-JULIAN-2-CCYY.
  3376                 24  DC-JULIAN-2-CC    PIC 99.
  3377                 24  DC-JULIAN-2-YR    PIC 99.
  3378             20  DC-JULIAN-DA-2        PIC 999.
  3379         16  DC-GREG-DATE-A-EDIT.
  3380             20  DC-EDITA-MONTH        PIC 99.
  3381             20  SLASHA-1              PIC X VALUE '/'.
  3382             20  DC-EDITA-DAY          PIC 99.
  3383             20  SLASHA-2              PIC X VALUE '/'.
  3384             20  DC-EDITA-CCYY.
  3385                 24  DC-EDITA-CENT     PIC 99.
  3386                 24  DC-EDITA-YEAR     PIC 99.
  3387         16  DC-GREG-DATE-B-EDIT.
  3388             20  DC-EDITB-MONTH        PIC 99.
  3389             20  SLASHB-1              PIC X VALUE '/'.
  3390             20  DC-EDITB-DAY          PIC 99.
  3391             20  SLASHB-2              PIC X VALUE '/'.
  3392             20  DC-EDITB-CCYY.
  3393                 24  DC-EDITB-CENT     PIC 99.
  3394                 24  DC-EDITB-YEAR     PIC 99.
  3395         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3396         16  DC-GREG-DATE-CYMD-R REDEFINES
  3397                              DC-GREG-DATE-CYMD.
  3398             20  DC-CYMD-CEN           PIC 99.
  3399             20  DC-CYMD-YEAR          PIC 99.
  3400             20  DC-CYMD-MONTH         PIC 99.
  3401             20  DC-CYMD-DAY           PIC 99.
  3402         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3403         16  DC-GREG-DATE-MDCY-R REDEFINES
  3404                              DC-GREG-DATE-MDCY.
  3405             20  DC-MDCY-MONTH         PIC 99.
  3406             20  DC-MDCY-DAY           PIC 99.
  3407             20  DC-MDCY-CEN           PIC 99.
  3408             20  DC-MDCY-YEAR          PIC 99.
  3409    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3410        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3411    12  DC-EL310-DATE                  PIC X(21).
  3412    12  FILLER                         PIC X(28).
  3413
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  64
* EL050.cbl
  3415*    COPY ELCCALC.
  3416******************************************************************
  3417*                                                                *
  3418*                           ELCCALC.                            *
  3419*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3420*                            VMOD=2.025                          *
  3421*                                                                *
  3422*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3423*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3424*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3425*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3426*                                                                *
  3427*  PASSED TO ELRTRM                                              *
  3428*  -----------------                                             *
  3429*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3430*  ORIGINAL TERM                                                 *
  3431*  BEGINNING DATE                                                *
  3432*  ENDING DATE                                                   *
  3433*  COMPANY I.D.                                                  *
  3434*  ACCOUNT MASTER USER FIELD                                     *
  3435*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3436*  FREE LOOK DAYS                                                *
  3437*                                                                *
  3438*  RETURNED FROM ELRTRM                                          *
  3439*  ---------------------                                         *
  3440*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3441*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3442*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3443*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3444*----------------------------------------------------------------*
  3445*  PASSED TO ELRAMT                                              *
  3446*  ----------------                                              *
  3447*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3448*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3449*  ORIGINAL AMOUNT                                               *
  3450*  ALTERNATE BENEFIT (BALLON)                                    *
  3451*  A.P.R. - NET PAY ONLY                                         *
  3452*  METHOD
  3453*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3454*  COMPANY I.D.                                                  *
  3455*  BENEFIT TYPE                                                  *
  3456*                                                                *
  3457*  RETURNED FROM ELRAMT                                          *
  3458*  --------------------                                          *
  3459*  REMAINING AMOUNT 1 - CURRENT                                  *
  3460*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3461*  REMAINING AMOUNT FACTOR
  3462*----------------------------------------------------------------*
  3463*  PASSED TO ELRESV                                              *
  3464*  -----------------                                             *
  3465*  CERTIFICATE EFFECTIVE DATE                                    *
  3466*  VALUATION DATE                                                *
  3467*  PAID THRU DATE                                                *
  3468*  BENEFIT                                                       *
  3469*  INCURRED DATE                                                 *
  3470*  REPORTED DATE                                                 *
  3471*  ISSUE AGE                                                     *
  3472*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  65
* EL050.cbl
  3473*  CDT PERCENT                                                   *
  3474*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3475* *CLAIM TYPE (LIFE, A/H)                                        *
  3476* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3477* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3478*                                                                *
  3479*  RETURNED FROM ELRESV                                          *
  3480*  --------------------                                          *
  3481*  CDT TABLE USED                                                *
  3482*  CDT FACTOR USED                                               *
  3483*  PAY TO CURRENT RESERVE                                        *
  3484*  I.B.N.R. - A/H ONLY                                           *
  3485*  FUTURE (ACCRUED) AH ONLY                                      *
  3486*----------------------------------------------------------------*
  3487*  PASSED TO ELRATE                                              *
  3488*  ----------------                                              *
  3489*  CERT ISSUE DATE                                               *
  3490*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3491*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3492*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3493*  STATE CODE (CLIENT DEFINED)                                   *
  3494*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3495*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3496*  DEVIATION CODE                                                *
  3497*  ISSUE AGE                                                     *
  3498*  ORIGINAL BENEFIT AMOUNT                                       *
  3499*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3500*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3501*  BENEFIT KIND (LIFE OR A/H)                                    *
  3502*  A.P.R.                                                        *
  3503*  METHOD
  3504*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3505*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3506*  COMPANY I.D. (3 CHARACTER)                                    *
  3507*  BENEFIT CODE                                                  *
  3508*  BENEFIT OVERRIDE CODE                                         *
  3509*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3510*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3511*  JOINT INDICATOR (CSL ONLY)                                    *
  3512*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3513*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3514*                                                                *
  3515*  RETURNED FROM ELRATE                                          *
  3516*  --------------------                                          *
  3517*  CALCULATED PREMIUM                                            *
  3518*  PREMIUM RATE                                                  *
  3519*  MORTALITY CODE                                                *
  3520*  MAX ATTAINED AGE                                              *
  3521*  MAX AGE                                                       *
  3522*  MAX TERM                                                      *
  3523*  MAX MONTHLY BENEFIT                                           *
  3524*  MAX TOTAL BENIFIT                                             *
  3525*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3526*----------------------------------------------------------------*
  3527*  PASSED TO ELRFND                                              *
  3528*  ----------------                                              *
  3529*  CERT ISSUE DATE                                               *
  3530*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  66
* EL050.cbl
  3531*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3532*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3533*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3534*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3535*  STATE CODE (CLIENT DEFINED)                                   *
  3536*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3537*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3538*  DEVIATION CODE                                                *
  3539*  ISSUE AGE                                                     *
  3540*  ORIGINAL BENEFIT AMOUNT                                       *
  3541*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3542*  PROCESS TYPE (CANCEL)                                         *
  3543*  BENEFIT KIND (LIFE OR A/H)                                    *
  3544*  A.P.R.                                                        *
  3545*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3546*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3547*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3548*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3549*  COMPANY I.D. (3 CHARACTER)                                    *
  3550*  BENEFIT CODE                                                  *
  3551*  BENEFIT OVERRIDE CODE                                         *
  3552*                                                                *
  3553*  RETURNED FROM ELRFND                                          *
  3554*  --------------------                                          *
  3555*  CALCULATED REFUND                                             *
  3556*----------------------------------------------------------------*
  3557*  PASSED TO ELEARN                                              *
  3558*  ----------------                                              *
  3559*  CERT ISSUE DATE                                               *
  3560*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3561*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3562*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3563*  STATE CODE (CLIENT DEFINED)                                   *
  3564*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3565*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3566*  DEVIATION CODE                                                *
  3567*  ISSUE AGE                                                     *
  3568*  ORIGINAL BENEFIT AMOUNT                                       *
  3569*  BENEFIT KIND (LIFE OR A/H)                                    *
  3570*  A.P.R.                                                        *
  3571*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3572*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3573*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3574*  COMPANY I.D. (3 CHARACTER)                                    *
  3575*  BENEFIT CODE                                                  *
  3576*  BENEFIT OVERRIDE CODE                                         *
  3577*                                                                *
  3578*  RETURNED FROM ELEARN                                          *
  3579*  --------------------                                          *
  3580*  INDICATED  EARNINGS                                           *
  3581*----------------------------------------------------------------*
  3582*                 LENGTH = 450                                   *
  3583*                                                                *
  3584******************************************************************
  3585******************************************************************
  3586*                   C H A N G E   L O G
  3587*
  3588* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  67
* EL050.cbl
  3589*-----------------------------------------------------------------
  3590*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3591* EFFECTIVE    NUMBER
  3592*-----------------------------------------------------------------
  3593* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3594* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3595* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3596* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3597* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3598* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3599* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3600* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3601* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3602* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3603* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3604******************************************************************
  3605
  3606 01  CALCULATION-PASS-AREA.
  3607     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3608                                     COMP.
  3609
  3610     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3611       88  NO-CP-ERROR                             VALUE ZERO.
  3612       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3613                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3614       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3615       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3616       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3617       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3618       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3619       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3620       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3621       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3622       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3623       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3624       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3625       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3626       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3627       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3628       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3629       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3630       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3631
  3632     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3633       88  NO-CP-ERROR-2                           VALUE ZERO.
  3634***********************  INPUT AREAS ****************************
  3635
  3636     12  CP-CALCULATION-AREA.
  3637         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3638         16  CP-CERT-EFF-DT        PIC XX.
  3639         16  CP-VALUATION-DT       PIC XX.
  3640         16  CP-PAID-THRU-DT       PIC XX.
  3641         16  CP-BENEFIT-TYPE       PIC X.
  3642           88  CP-AH                               VALUE 'A' 'D'
  3643                                                   'I' 'U'.
  3644           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3645           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3646         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  68
* EL050.cbl
  3647         16  CP-REPORTED-DT        PIC XX.
  3648         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3649         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3650         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3651                                     COMP-3.
  3652         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3653                                     COMP-3.
  3654         16  CP-CDT-METHOD         PIC X.
  3655           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3656           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3657           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3658         16  CP-CLAIM-TYPE         PIC X.
  3659           88  CP-AH-CLAIM                         VALUE 'A'.
  3660           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3661         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3662                                     COMP-3.
  3663         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3664                                     COMP-3.
  3665         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3668                                     COMP-3.
  3669         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3670                                     COMP-3.
  3671         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3672                                     COMP-3.
  3673         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3674                                     COMP-3.
  3675         16  CP-REM-TERM-METHOD    PIC X.
  3676           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3677           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3678           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3679           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3680           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3681           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3682           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3683         16  CP-EARNING-METHOD     PIC X.
  3684           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3685           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3686           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3687           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3688           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3689           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3690           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3691           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3692           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3693           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3694           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3695           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3696           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3697           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3698         16  CP-PROCESS-TYPE       PIC X.
  3699           88  CP-CLAIM                            VALUE '1'.
  3700           88  CP-CANCEL                           VALUE '2'.
  3701           88  CP-ISSUE                            VALUE '3'.
  3702         16  CP-SPECIAL-CALC-CD    PIC X.
  3703           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3704           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  69
* EL050.cbl
  3705           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3706           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3707           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3708           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3709           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3710           88  CP-FARM-PLAN                    VALUE 'F'.
  3711           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3712           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3713           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3714           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3715           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3716           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3717           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3718           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3719           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3720           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3721                                                     'W' 'X'.
  3722           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3723           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3724           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3725           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3726           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3727           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3728           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3729           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3730           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3731           88  CP-CSL-METH-1                   VALUE '5'.
  3732           88  CP-CSL-METH-2                   VALUE '6'.
  3733           88  CP-CSL-METH-3                   VALUE '7'.
  3734           88  CP-CSL-METH-4                   VALUE '8'.
  3735
  3736         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3737                                     COMP-3.
  3738         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3739         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3740         16  CP-STATE              PIC XX          VALUE SPACE.
  3741         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3742         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3743           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3744               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3745         16  CP-R78-OPTION         PIC X.
  3746           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3747           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3748
  3749         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3750         16  CP-IBNR-RESERVE-SW    PIC X.
  3751         16  CP-CLAIM-STATUS       PIC X.
  3752         16  CP-RATE-FILE          PIC X.
  3753         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3754                                     COMP-3.
  3755
  3756         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3757         16  CP-AH-OVERRIDE-CODE   PIC X.
  3758
  3759         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3760                                     COMP-3.
  3761         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3762                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  70
* EL050.cbl
  3763         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3764                                     COMP-3.
  3765         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3768                                     COMP-3.
  3769         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3770                                  PIC S9(7)V99 COMP-3.
  3771
  3772         16  CP-PAID-FROM-DATE     PIC X(02).
  3773         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3774         16  CP-EXT-DAYS-CALC      PIC X.
  3775           88  CP-EXT-NO-CHG                   VALUE ' '.
  3776           88  CP-EXT-CHG-LF                   VALUE '1'.
  3777           88  CP-EXT-CHG-AH                   VALUE '2'.
  3778           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3779         16  CP-DOMICILE-STATE     PIC XX.
  3780         16  CP-CARRIER            PIC X.
  3781         16  CP-REIN-FLAG          PIC X.
  3782         16  CP-REM-TRM-CALC-OPTION PIC X.
  3783           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3784                      '2' '3' '4' '5'.
  3785           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3786           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3787           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3788           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3789           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3790           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3791           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3792           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3793         16  CP-SIG-SWITCH         PIC X.
  3794         16  CP-RATING-METHOD      PIC X.
  3795           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3796           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3797           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3798           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3799           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3800           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3801           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3802           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3803           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3804         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3805                                     COMP-3.
  3806         16  CP-BEN-CATEGORY       PIC X.
  3807         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3808         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3809                                   PIC S99V9(5) COMP-3.
  3810         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3811         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3812                                   PIC S99V9(5) COMP-3.
  3813         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3814         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3815         16  CP-EXPIRE-DT          PIC XX.
  3816         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3817         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3818         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3819         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3820         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  71
* EL050.cbl
  3821             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3822             88  CP-CALC-CLP              VALUE 'C'.
  3823         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3824         16  CP-CANCEL-REASON      PIC X.
  3825         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3826         16  CP-PMT-MODE           PIC X.
  3827         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3828         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3829         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3830         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3831         16  FILLER                PIC X.
  3832
  3833***************    OUTPUT FROM ELRESV   ************************
  3834
  3835         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3836
  3837         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3838                                     COMP-3.
  3839         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3840                                     COMP-3.
  3841         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3842                                     COMP-3.
  3843         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3844                                     COMP-3.
  3845         16  FILLER                PIC X(09).
  3846***************    OUTPUT FROM ELRTRM   *************************
  3847
  3848         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3849                                     COMP-3.
  3850         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3851                                     COMP-3.
  3852         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3853                                     COMP-3.
  3854         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3855                                     COMP-3.
  3856         16  FILLER                PIC X(12).
  3857
  3858***************    OUTPUT FROM ELRAMT   *************************
  3859
  3860         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3861                                     COMP-3.
  3862         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3863                                     COMP-3.
  3864         16  FILLER                PIC X(12).
  3865
  3866***************    OUTPUT FROM ELRATE   *************************
  3867
  3868         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3869                                     COMP-3.
  3870         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3871                                     COMP-3.
  3872         16  CP-MORTALITY-CODE     PIC X(4).
  3873         16  CP-RATE-EDIT-FLAG     PIC X.
  3874             88  CP-RATES-NEED-APR                  VALUE '1'.
  3875         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3876                                     COMP-3.
  3877         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3878         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  72
* EL050.cbl
  3879         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3880                                   PIC S9(7)V99 COMP-3.
  3881         16  FILLER                PIC X(07).
  3882
  3883***************    OUTPUT FROM ELRFND   *************************
  3884
  3885         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3886                                     COMP-3.
  3887         16  CP-REFUND-TYPE-USED   PIC X.
  3888           88  CP-R-AS-R78                         VALUE '1'.
  3889           88  CP-R-AS-PRORATA                     VALUE '2'.
  3890           88  CP-R-AS-CALIF                       VALUE '3'.
  3891           88  CP-R-AS-TEXAS                       VALUE '4'.
  3892           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3893           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3894           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3895           88  CP-R-AS-MEAN                        VALUE '8'.
  3896           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3897           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3898           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3899           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3900           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3901           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3902         16  FILLER                PIC X(12).
  3903
  3904***************    OUTPUT FROM ELEARN   *************************
  3905
  3906         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3907                                     COMP-3.
  3908         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3909                                     COMP-3.
  3910         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3911                                     COMP-3.
  3912         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3913                                     COMP-3.
  3914         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3915                                     COMP-3.
  3916         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3917                                     COMP-3.
  3918         16  CP-EARNING-TYPE-USED  PIC X.
  3919           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3920           88  CP-E-AS-R78                         VALUE '1'.
  3921           88  CP-E-AS-PRORATA                     VALUE '2'.
  3922           88  CP-E-AS-TEXAS                       VALUE '4'.
  3923           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3924           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3925           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3926           88  CP-E-AS-MEAN                        VALUE '8'.
  3927           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3928         16  FILLER                PIC X(12).
  3929
  3930***************    OUTPUT FROM ELPMNT   *************************
  3931
  3932         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3933                                     COMP-3.
  3934         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3935                                     COMP-3.
  3936         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  73
* EL050.cbl
  3937
  3938***************   MISC WORK AREAS    *****************************
  3939         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3940                                     COMP-3.
  3941         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3942                                     COMP-3.
  3943         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3944                                     COMP-3.
  3945         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3946                                     COMP-3.
  3947         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3948                                     COMP-3.
  3949         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3950                                     COMP-3.
  3951         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3952             88  OPEN-RATE-FILE                   VALUE 'O'.
  3953             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3954             88  IO-ERROR                         VALUE 'E'.
  3955
  3956         16  CP-FIRST-PAY-DATE     PIC XX.
  3957
  3958         16  CP-JOINT-INDICATOR    PIC X.
  3959
  3960         16  CP-RESERVE-REMAINING-TERM
  3961                                   PIC S9(4)V9    VALUE ZERO
  3962                                     COMP-3.
  3963
  3964         16  CP-INSURED-BIRTH-DT   PIC XX.
  3965
  3966         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3967                                     COMP-3.
  3968
  3969         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3970                                     COMP-3.
  3971
  3972         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3973                                     COMP-3.
  3974
  3975         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3976                                     COMP-3.
  3977
  3978         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3979                                     COMP-3.
  3980
  3981         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3982                                     COMP-3.
  3983
  3984         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3985                                     COMP-3.
  3986
  3987         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3988             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3989
  3990         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3991                                     COMP-3.
  3992         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3993                                     COMP-3.
  3994         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  74
* EL050.cbl
  3995         16  cp-extra-periods      pic 9 value zeros.
  3996         16  cp-net-only-state     pic x value spaces.
  3997         16  FILLER                PIC X(13).
  3998******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  75
* EL050.cbl
  4000******************************************************************
  4001*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4002*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4003*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4004*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4005*** MODIFICATION.                                              ***
  4006*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4007*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4008******************************************************************
  4009*    COPY ERCPNDB.
  4010******************************************************************
  4011*                                                                *
  4012*                                                                *
  4013*                            ERCPNDB.                            *
  4014*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4015*                            VMOD=2.025                          *
  4016*                                                                *
  4017*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4018*                                                                *
  4019******************************************************************
  4020*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4021*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4022******************************************************************
  4023*                                                                *
  4024*                                                                *
  4025*   FILE TYPE = VSAM,KSDS                                        *
  4026*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4027*                                                                *
  4028*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4029*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4030*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4031*                                                 RKP=13,LEN=36  *
  4032*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4033*                                      AND CHG-SEQ.)             *
  4034*                                                RKP=49,LEN=11   *
  4035*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4036*                                      AND CHG-SEQ.)             *
  4037*                                                RKP=60,LEN=15   *
  4038*                                                                *
  4039*   LOG = NO                                                     *
  4040*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4041******************************************************************
  4042******************************************************************
  4043*                   C H A N G E   L O G
  4044*
  4045* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4046*-----------------------------------------------------------------
  4047*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4048* EFFECTIVE    NUMBER
  4049*-----------------------------------------------------------------
  4050* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4051* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4052* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4053* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4054* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4055* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4056* 032306                   PEMA  ADD BOW LOAN NUMBER
  4057* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  76
* EL050.cbl
  4058* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4059* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4060* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4061* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4062* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4063* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4064* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4065* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4066* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4067* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4068* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4069******************************************************************
  4070
  4071 01  PENDING-BUSINESS.
  4072     12  PB-RECORD-ID                     PIC XX.
  4073         88  VALID-PB-ID                        VALUE 'PB'.
  4074
  4075     12  PB-CONTROL-PRIMARY.
  4076         16  PB-COMPANY-CD                PIC X.
  4077         16  PB-ENTRY-BATCH               PIC X(6).
  4078         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4079         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4080
  4081     12  PB-CONTROL-BY-ACCOUNT.
  4082         16  PB-COMPANY-CD-A1             PIC X.
  4083         16  PB-CARRIER                   PIC X.
  4084         16  PB-GROUPING.
  4085             20  PB-GROUPING-PREFIX       PIC XXX.
  4086             20  PB-GROUPING-PRIME        PIC XXX.
  4087         16  PB-STATE                     PIC XX.
  4088         16  PB-ACCOUNT.
  4089             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4090             20  PB-ACCOUNT-PRIME         PIC X(6).
  4091         16  PB-CERT-EFF-DT               PIC XX.
  4092         16  PB-CERT-NO.
  4093             20  PB-CERT-PRIME            PIC X(10).
  4094             20  PB-CERT-SFX              PIC X.
  4095         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4096
  4097         16  PB-RECORD-TYPE               PIC X.
  4098             88  PB-MAILING-DATA                VALUE '0'.
  4099             88  PB-ISSUE                       VALUE '1'.
  4100             88  PB-CANCELLATION                VALUE '2'.
  4101             88  PB-BATCH-TRAILER               VALUE '9'.
  4102
  4103     12  PB-CONTROL-BY-ORIG-BATCH.
  4104         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4105         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4106         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4107         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4108
  4109     12  PB-CONTROL-BY-CSR.
  4110         16  PB-CSR-COMPANY-CD            PIC X.
  4111         16  PB-CSR-ID                    PIC X(4).
  4112         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4113         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4114         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4115******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  77
* EL050.cbl
  4116*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4117******************************************************************
  4118
  4119     12  PB-LAST-MAINT-DT                 PIC XX.
  4120     12  PB-LAST-MAINT-BY                 PIC X(4).
  4121     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4122
  4123     12  PB-RECORD-BODY                   PIC X(375).
  4124
  4125     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4126         16  PB-CERT-ORIGIN               PIC X.
  4127             88  CLASIC-CREATED-CERT         VALUE '1'.
  4128         16  PB-I-NAME.
  4129             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4130             20  PB-I-INSURED-FIRST-NAME.
  4131                 24  PB-I-INSURED-1ST-INIT PIC X.
  4132                 24  FILLER                PIC X(9).
  4133             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4134         16  PB-I-AGE                     PIC S99   COMP-3.
  4135         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4136         16  PB-I-BIRTHDAY                PIC XX.
  4137         16  PB-I-INSURED-SEX             PIC X.
  4138             88  PB-SEX-MALE     VALUE 'M'.
  4139             88  PB-SEX-FEMALE   VALUE 'F'.
  4140
  4141         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4142         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4143         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4144         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4145         16  PB-I-SKIP-CODE               PIC X.
  4146             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4147             88  PB-SKIP-JULY              VALUE '1'.
  4148             88  PB-SKIP-AUGUST            VALUE '2'.
  4149             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4150             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4151             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4152             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4153             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4154             88  PB-SKIP-JUNE              VALUE '8'.
  4155             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4156             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4157             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4158         16  PB-I-TERM-TYPE               PIC X.
  4159             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4160             88  PB-PAID-WEEKLY            VALUE 'W'.
  4161             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4162             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4163             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4164         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4165         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4166         16  PB-I-DATA-ENTRY-SW           PIC X.
  4167             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4168             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4169             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4170             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4171         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4172         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4173*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  78
* EL050.cbl
  4174         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4175         16  FILLER                       PIC X.
  4176
  4177         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4178             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4179             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4180                                                   '90' THRU '99'.
  4181         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4182                                          PIC XX.
  4183         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4184         16  PB-I-AMOUNT-FINANCED REDEFINES
  4185                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4186         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4187         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4188                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4189         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4190         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4191         16  PB-I-CLP-AMOUNT REDEFINES
  4192                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4193         16  PB-I-LF-CALC-FLAG            PIC X.
  4194             88 PB-COMP-LF-PREM               VALUE '?'.
  4195         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4196         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4197         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4198         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4199         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4200         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4201         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4202         16  PB-I-LF-ABBR                 PIC XXX.
  4203         16  PB-I-LF-INPUT-CD             PIC XX.
  4204
  4205         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4206             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4207             88  PB-INVALID-AH               VALUE '  ' '00'
  4208                                                   '90' THRU '99'.
  4209         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4210         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4211         16  PB-I-AH-CALC-FLAG            PIC X.
  4212             88 PB-COMP-AH-PREM                  VALUE '?'.
  4213         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4214         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4215         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4216         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4217         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4218         16  PB-I-AH-ABBR                 PIC XXX.
  4219         16  PB-I-AH-INPUT-CD             PIC XXX.
  4220
  4221         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4222         16  PB-I-REIN-TABLE              PIC XXX.
  4223         16  PB-I-BUSINESS-TYPE           PIC 99.
  4224         16  PB-I-INDV-GRP-CD             PIC X.
  4225         16  PB-I-MORT-CODE.
  4226             20  PB-I-TABLE               PIC X.
  4227             20  PB-I-INTEREST            PIC XX.
  4228             20  PB-I-MORT-TYP            PIC X.
  4229         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4230         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4231         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  79
* EL050.cbl
  4232         16  PB-I-INDV-GRP-OVRD           PIC X.
  4233         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4234         16  PB-I-SIG-SW                  PIC X.
  4235             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4236         16  PB-I-RATE-CLASS              PIC XX.
  4237         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4238         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4239         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4240         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4241         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4242         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4243         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4244         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4245         16  PB-I-OB-FLAG                 PIC X.
  4246             88  PB-I-OB                      VALUE 'B'.
  4247             88  PB-I-SUMMARY                 VALUE 'Z'.
  4248         16  PB-I-ENTRY-STATUS            PIC X.
  4249             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4250                                              'M' '5' '9' '2'.
  4251             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4252             88  PB-I-POLICY-PENDING          VALUE '2'.
  4253             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4254             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4255             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4256             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4257             88  PB-I-REIN-ONLY               VALUE '9'.
  4258             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4259             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4260             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4261             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4262         16  PB-I-INT-CODE                PIC X.
  4263             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4264             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4265         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4266         16  PB-I-SOC-SEC-NO              PIC X(11).
  4267         16  PB-I-MEMBER-NO               PIC X(12).
  4268         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4269*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4270         16  PB-I-OLD-LOF                 PIC XXX.
  4271         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4272         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4273         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4274         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4275         16  PB-I-LIFE-INDICATOR          PIC X.
  4276             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4277         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4278         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4279                                          PIC S9(5)V99    COMP-3.
  4280         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4281             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4282             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4283         16  PB-I-1ST-PMT-DT              PIC XX.
  4284         16  PB-I-JOINT-INSURED.
  4285             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4286             20 PB-I-JOINT-FIRST-NAME.
  4287                24  PB-I-JOINT-FIRST-INIT PIC X.
  4288                24  FILLER                PIC X(9).
  4289             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  80
* EL050.cbl
  4290*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4291         16  PB-I-BENEFICIARY-NAME.
  4292             20  PB-I-BANK-NUMBER         PIC X(10).
  4293             20  FILLER                   PIC X(15).
  4294         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4295         16  PB-I-REFERENCE               PIC X(12).
  4296         16  FILLER REDEFINES PB-I-REFERENCE.
  4297             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4298             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4299             20  PB-I-CLP-STATE           PIC XX.
  4300         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4301             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4302             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4303             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4304         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4305         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4306         16  PB-I-RESIDENT-STATE          PIC XX.
  4307         16  PB-I-RATE-CODE               PIC X(4).
  4308         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4309         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4310         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4311         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4312         16  PB-I-BANK-NOCHRGB            PIC 99.
  4313         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4314         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4315
  4316     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4317         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4318             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4319         16  PB-C-CANCEL-ORIGIN           PIC X.
  4320             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4321         16  PB-C-LF-CANCEL-DT            PIC XX.
  4322         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4323         16  PB-C-LF-CALC-REQ             PIC X.
  4324             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4325         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4326         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4327         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4328             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4329         16  PB-C-AH-CANCEL-DT            PIC XX.
  4330         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4331         16  PB-C-AH-CALC-REQ             PIC X.
  4332             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4333         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4334         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4335         16  PB-C-LAST-NAME               PIC X(15).
  4336         16  PB-C-REFUND-SW               PIC X.
  4337             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4338             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4339         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4340         16  PB-C-PAYEE-CODE              PIC X(6).
  4341         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4342         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4343         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4344         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4345         16  PB-C-REFERENCE               PIC X(12).
  4346         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4347         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  81
* EL050.cbl
  4348         16  PB-C-POST-CARD-IND           PIC X.
  4349         16  PB-C-CANCEL-REASON           PIC X.
  4350         16  PB-C-REF-INTERFACE-SW        PIC X.
  4351         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4352         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4353         16  FILLER                       PIC X(01).
  4354*        16  FILLER                       PIC X(18).
  4355         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4356*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4357         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4358         16  PB-CANCELED-CERT-DATA.
  4359             20  PB-CI-INSURED-NAME.
  4360                 24  PB-CI-LAST-NAME      PIC X(15).
  4361                 24  PB-CI-INITIALS       PIC XX.
  4362             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4363             20  PB-CI-INSURED-SEX        PIC X.
  4364             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4365             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4366             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4367             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4368             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4369             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4370             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4371             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4372             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4373             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4374             20  PB-CI-RATE-CLASS         PIC XX.
  4375             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4376             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4377             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4378             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4379             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4380             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4381             20  PB-CI-LF-ABBR            PIC X(3).
  4382             20  PB-CI-AH-ABBR            PIC X(3).
  4383             20  PB-CI-OB-FLAG            PIC X.
  4384                 88  PB-CI-OB                VALUE 'B'.
  4385             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4386                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4387                                           'M' '4' '5' '9' '2'.
  4388                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4389                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4390                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4391                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4392                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4393                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4394                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4395                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4396                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4397                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4398                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4399                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4400                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4401             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4402                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4403                                           'M' '4' '5' '9' '2'.
  4404                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4405                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  82
* EL050.cbl
  4406                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4407                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4408                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4409                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4410                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4411                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4412                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4413                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4414                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4415                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4416                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4417             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4418             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4419             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4420             20  PB-CI-MEMBER-NO          PIC X(12).
  4421             20  PB-CI-INT-CODE           PIC X.
  4422                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4423                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4424             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4425             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4426             20  PB-CI-COMP-EXCP-SW       PIC X.
  4427                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4428                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4429             20  PB-CI-ENTRY-STATUS       PIC X.
  4430             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4431             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4432             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4433             20  PB-CI-DEATH-DT           PIC XX.
  4434             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4435             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4436             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4437             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4438             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4439             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4440             20  PB-CI-ENTRY-DT              PIC XX.
  4441             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4442             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4443             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4444             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4445             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4446             20  PB-CI-OLD-LOF               PIC XXX.
  4447*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4448             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4449             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4450             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4451             20  PB-CI-INDV-GRP-CD           PIC X.
  4452             20  PB-CI-BENEFICIARY-NAME.
  4453                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4454                 24  FILLER                  PIC X(15).
  4455             20  PB-CI-NOTE-SW               PIC X.
  4456             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4457             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4458             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4459             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4460             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4461             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4462             20  PB-CI-FIRST-NAME            PIC X(10).
  4463             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  83
* EL050.cbl
  4464
  4465         16  FILLER                       PIC X(13).
  4466*032306  16  FILLER                       PIC X(27).
  4467*        16  FILLER                       PIC X(46).
  4468
  4469     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4470         16  FILLER                       PIC X(10).
  4471         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4472         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4473         16  PB-M-INSURED-MID-INIT        PIC X.
  4474         16  PB-M-INSURED-AGE             PIC 99.
  4475         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4476         16  PB-M-INSURED-SEX             PIC X.
  4477         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4478         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4479         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4480         16  PB-M-INSURED-CITY-STATE.
  4481             20  PB-M-INSURED-CITY        PIC X(28).
  4482             20  PB-M-INSURED-STATE       PIC XX.
  4483         16  PB-M-INSURED-ZIP-CODE.
  4484             20  PB-M-INSURED-ZIP-PRIME.
  4485                 24  PB-M-INSURED-ZIP-1   PIC X.
  4486                     88  PB-M-CANADIAN-POST-CODE
  4487                                             VALUE 'A' THRU 'Z'.
  4488                 24  FILLER               PIC X(4).
  4489             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4490         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4491                                        PB-M-INSURED-ZIP-CODE.
  4492             20  PM-M-INS-CAN-POST1       PIC XXX.
  4493             20  PM-M-INS-CAN-POST2       PIC XXX.
  4494             20  FILLER                   PIC XXX.
  4495         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4496         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4497         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4498         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4499         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4500         16  PB-M-CRED-BENE-CITYST.
  4501             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4502             20  PB-M-CRED-BENE-STATE     PIC XX.
  4503         16  FILLER                       PIC X(92).
  4504
  4505     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4506         16  FILLER                       PIC X(10).
  4507         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4508         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4509         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4510         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4511         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4512         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4513         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4514         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4515         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4516         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4517         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4518         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4519         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4520         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4521         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  84
* EL050.cbl
  4522         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4523         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4524         16  PB-ACCOUNT-NAME              PIC X(30).
  4525         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4526         16  PB-REFERENCE                 PIC X(12).
  4527         16  PB-B-RECEIVED-DT             PIC XX.
  4528         16  FILLER                       PIC X(234).
  4529
  4530     12  PB-RECORD-STATUS.
  4531         16  PB-CREDIT-SELECT-DT          PIC XX.
  4532         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4533         16  PB-BILLED-DT                 PIC XX.
  4534         16  PB-BILLING-STATUS            PIC X.
  4535             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4536             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4537             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4538         16  PB-RECORD-BILL               PIC X.
  4539             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4540             88  PB-RECORD-RETURNED           VALUE 'R'.
  4541             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4542             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4543             88  PB-OVERRIDE-AH               VALUE 'A'.
  4544             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4545         16  PB-BATCH-ENTRY               PIC X.
  4546             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4547             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4548             88  PB-REISSUED-CERT             VALUE 'E'.
  4549             88  PB-CASH-CERT                 VALUE 'C'.
  4550             88  PB-MONTHLY-CERT              VALUE 'M'.
  4551             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4552             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4553             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4554         16  PB-FORCE-CODE                PIC X.
  4555             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4556             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4557             88  PB-CANCEL-FORCE              VALUE '8'.
  4558             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4559             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4560             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4561             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4562             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4563             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4564             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4565             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4566         16  PB-FATAL-FLAG                PIC X.
  4567             88  PB-FATAL-ERRORS              VALUE 'X'.
  4568         16  PB-FORCE-ER-CD               PIC X.
  4569             88  PB-FORCE-ERRORS              VALUE 'F'.
  4570             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4571         16  PB-WARN-ER-CD                PIC X.
  4572             88  PB-WARNING-ERRORS            VALUE 'W'.
  4573         16  FILLER                       PIC X.
  4574         16  PB-OUT-BAL-CD                PIC X.
  4575             88  PB-OUT-OF-BAL                VALUE 'O'.
  4576         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4577         16  PB-AH-OVERRIDE-L1            PIC X.
  4578         16  PB-INPUT-DT                  PIC XX.
  4579         16  PB-INPUT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  85
* EL050.cbl
  4580         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4581         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4582         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4583         16  PB-LF-EARNING-METHOD         PIC X.
  4584         16  PB-AH-EARNING-METHOD         PIC X.
  4585         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4586         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4587         16  PB-REIN-CD                   PIC XXX.
  4588         16  PB-LF-REFUND-TYPE            PIC X.
  4589         16  PB-AH-REFUND-TYPE            PIC X.
  4590         16  PB-ACCT-EFF-DT               PIC XX.
  4591         16  PB-ACCT-EXP-DT               PIC XX.
  4592         16  PB-COMPANY-ID                PIC X(3).
  4593         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4594         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4595         16  PB-SV-CARRIER                PIC X.
  4596         16  PB-SV-GROUPING               PIC X(6).
  4597         16  PB-SV-STATE                  PIC XX.
  4598         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4599         16  PB-GA-BILLING-INFO.
  4600             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4601                                          PIC XX.
  4602         16  PB-SV-REMIT-TO  REDEFINES
  4603             PB-GA-BILLING-INFO           PIC X(10).
  4604         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4605         16  PB-I-LOAN-OFFICER            PIC X(5).
  4606         16  PB-I-VIN                     PIC X(17).
  4607
  4608         16  FILLER                       PIC X(04).
  4609         16  IMNET-BYPASS-SW              PIC X.
  4610
  4611******************************************************************
  4612*                COMMON EDIT ERRORS                              *
  4613******************************************************************
  4614
  4615     12  PB-COMMON-ERRORS.
  4616         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4617                                           PIC S9(4)     COMP.
  4618
  4619******************************************************************
  4620
  4621* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4622*    COPY ELC50W1.
  4623******************************************************************
  4624*                                                                *
  4625*                                                                *
  4626*                             ELC50W1                            *
  4627*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4628*                            VMOD=2.004                          *
  4629*                                                                *
  4630*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4631*                                                                *
  4632*                                                                *
  4633******************************************************************
  4634
  4635     12  WK-WORK-AREA.
  4636         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4637         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  86
* EL050.cbl
  4638         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4639         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4640         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4641         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4642         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4643         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4644         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4645         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4646         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4647         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4648         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4649         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4650         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4651         16  WK-CREDIT-EDIT-CONTROLS.
  4652             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4653             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4654             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4655             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4656             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4657             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4658         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4659         16  WK-SAVE-REIN-DATA.
  4660             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4661             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4662             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4663         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4664             88  ENTRY-FROM-EL6311       VALUE '6'.
  4665         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4666         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4667     12  WK-RECORD-ADDRESSES.
  4668         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4669         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4670         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4671         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4672         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4673         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4674         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4675         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4676     12  WK-OVER-SHORT-AREA.
  4677         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4678         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4679         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4680             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4681         16  FILLER                   PIC X(5) VALUE SPACES.
  4682
  4683*    COPY ELCEDITC.
  4684******************************************************************
  4685*                                                                *
  4686*                                                                *
  4687*                            ELCEDITC                            *
  4688*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4689*                            VMOD=2.012                          *
  4690*                                                                *
  4691*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4692*                     EL6313, EL050 AND EL517.                   *
  4693*                                                                *
  4694******************************************************************
  4695******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  87
* EL050.cbl
  4696*                   C H A N G E   L O G
  4697*
  4698* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4699*-----------------------------------------------------------------
  4700*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4701* EFFECTIVE    NUMBER
  4702*-----------------------------------------------------------------
  4703* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4704******************************************************************
  4705
  4706     12  EDIT-CRITERIA-DATA.
  4707         16  EC-CO-MONTH-END-DT       PIC XX.
  4708         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4709         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4710         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4711         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4712         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4713         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4714         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4715         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4716         16  EC-CO-REM-TERM-CALC      PIC X.
  4717               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4718               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4719               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4720               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4721
  4722         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4723               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4724               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4725               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4726               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4727               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4728               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4729               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4730               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4731               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4732               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4733
  4734         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4735               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4736               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4737               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4738               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4739               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4740               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4741               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4742               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4743
  4744         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4745                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4746                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4747
  4748         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4749                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4750                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4751                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4752                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4753                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  88
* EL050.cbl
  4754                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4755                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4756                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4757
  4758         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4759               88  EC-BR-REDUCING                   VALUE 'R'.
  4760               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4761
  4762         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4763         16  EC-BR-LF-DESC             PIC X(10).
  4764         16  EC-BR-AH-DESC             PIC X(10).
  4765         16  EC-BR-LF-COMMENT          PIC X(10).
  4766         16  EC-BR-AH-COMMENT          PIC X(10).
  4767
  4768         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4769               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4770               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4771               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4772               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4773
  4774         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4775               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4776               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4777               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4778               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4779
  4780         16  EC-BR-LF-REFUND-CALC      PIC X.
  4781                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4782                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4783                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4784                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4785                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4786                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4787                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4788
  4789         16  EC-BR-AH-REFUND-CALC      PIC X.
  4790                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4791                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4792                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4793                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4794                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4795                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4796                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4797                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4798
  4799         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4800                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4801                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4802                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4803
  4804         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4805                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4806                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4807                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4808
  4809         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4810         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4811         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  89
* EL050.cbl
  4812         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4813
  4814         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4815         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4816                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4817                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4818                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4819                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4820
  4821         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4822               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4823               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4824               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4825               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4826               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4827
  4828         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4829               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4830               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4831               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4832               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4833               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4834
  4835         16  EC-ST-LF-REFUND-CALC      PIC X.
  4836                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4837                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4838                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4839                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4840                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4841                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4842                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4843                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4844
  4845         16  EC-ST-AH-REFUND-CALC      PIC X.
  4846                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4847                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4848                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4849                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4850                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4851                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4852                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4853                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4854
  4855         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4856         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4857         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4858         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4859         16  EC-AM-EXPIRATION-DT       PIC XX.
  4860         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4861         16  EC-AM-CLASS-CD            PIC XX.
  4862         16  EC-AM-LF-DEVIATION        PIC XXX.
  4863         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4864         16  EC-AM-AH-DEVIATION        PIC XXX.
  4865         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4866         16  EC-AM-PHONE-NO            PIC X(10).
  4867
  4868         16  EC-AM-LF-REFUND-CALC      PIC X.
  4869                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  90
* EL050.cbl
  4870                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4871                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4872                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4873                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4874                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4875                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4876
  4877         16  EC-AM-AH-REFUND-CALC      PIC X.
  4878                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4879                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4880                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4881                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4882                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4883                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4884                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4885
  4886         16  EC-AM-BEN-I-G-CD          PIC X.
  4887                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4888                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4889                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4890
  4891         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4892         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4893         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4894         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4895         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4896         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4897         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4898         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4899         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4900
  4901         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4902         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4903         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4904         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4905         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4906         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4907         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4908         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4909         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4910         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4911         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4912         16  EC-RT-LF-NSP-ST           PIC XX.
  4913         16  EC-RT-AH-NSP-ST           PIC XX.
  4914         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4915         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4916
  4917         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4918             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4919                                             'M' '5' '9' '2'.
  4920             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4921             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4922             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4923             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4924             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4925             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4926             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4927             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  91
* EL050.cbl
  4928             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4929             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4930
  4931         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4932             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4933                                             'M' '5' '9' '2'.
  4934             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4935             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4936             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4937             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4938             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4939             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4940             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4941             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4942             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4943             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4944
  4945         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4946         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4947         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4948         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4949         16  EC-CM-DEATH-DT            PIC XX.
  4950
  4951*DMD CUSTOM CODING FIELDS BELOW
  4952*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4953         16  EC-BR-DMD-RATING-SW       PIC X.
  4954                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4955                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4956                 88  NO-DMD-RATING               VALUE 'N'.
  4957
  4958         16  EC-NEW-CERT               PIC X(11).
  4959         16  EC-NEW-STATE              PIC XX.
  4960         16  FILLER                    PIC X.
  4961*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4962         16  OVER-SHORT-EDIT-FIELDS.
  4963             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4964             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4965             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4966             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4967             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4968             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4969             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4970             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4971             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4972         16  FILLER                    PIC X(71).
  4973******************************************************************
  4974
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  92
* EL050.cbl
  4976*    COPY ELCDIFRD.
  4977******************************************************************
  4978*                                                                *
  4979*                                                                *
  4980*                            ELCDIFRD.                           *
  4981*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4982*                            VMOD=2.004                          *
  4983*                                                                *
  4984*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4985*                                                                *
  4986******************************************************************
  4987*
  4988  01  WS-DIFFERENCE-CALCULATION.
  4989        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4990        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4991        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4992        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4993        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4994        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4995        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4996        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4997        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4998        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4999        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5000
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  93
* EL050.cbl
  5002****************************************************************
  5003*
  5004* Copyright (c) 2007-2013 Dell Inc.
  5005* All rights reserved.
  5006*
  5007****************************************************************
  5008 01  DFHEIV.
  5009   02  DFHEIV0               PIC X(35).
  5010   02  DFHEIV1               PIC X(08).
  5011   02  DFHEIV2               PIC X(08).
  5012   02  DFHEIV3               PIC X(08).
  5013   02  DFHEIV4               PIC X(06).
  5014   02  DFHEIV5               PIC X(04).
  5015   02  DFHEIV6               PIC X(04).
  5016   02  DFHEIV7               PIC X(02).
  5017   02  DFHEIV8               PIC X(02).
  5018   02  DFHEIV9               PIC X(01).
  5019   02  DFHEIV10              PIC S9(7) COMP-3.
  5020   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5021   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5022   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5023   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5024   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5025   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5026   02  DFHEIV17              PIC X(04).
  5027   02  DFHEIV18              PIC X(04).
  5028   02  DFHEIV19              PIC X(04).
  5029   02  DFHEIV20              USAGE IS POINTER.
  5030   02  DFHEIV21              USAGE IS POINTER.
  5031   02  DFHEIV22              USAGE IS POINTER.
  5032   02  DFHEIV23              USAGE IS POINTER.
  5033   02  DFHEIV24              USAGE IS POINTER.
  5034   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5035   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5036   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5037   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5038   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5039   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5040   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5041   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5042   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5043   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5044   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5045   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5046   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5047   02  FILLER                PIC X(02).
  5048   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5049   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5050   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5051   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5052   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5053   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5054   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5055 LINKAGE  SECTION.
  5056*****************************************************************
  5057*                                                               *
  5058* Copyright (c) 2007-2013 Dell Inc.                             *
  5059* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  94
* EL050.cbl
  5060*                                                               *
  5061*****************************************************************
  5062 01  dfheiblk.
  5063     02  eibtime          pic s9(7) comp-3.
  5064     02  eibdate          pic s9(7) comp-3.
  5065     02  eibtrnid         pic x(4).
  5066     02  eibtaskn         pic s9(7) comp-3.
  5067     02  eibtrmid         pic x(4).
  5068     02  dfheigdi         pic s9(4) comp.
  5069     02  eibcposn         pic s9(4) comp.
  5070     02  eibcalen         pic s9(4) comp.
  5071     02  eibaid           pic x(1).
  5072     02  eibfiller1       pic x(1).
  5073     02  eibfn            pic x(2).
  5074     02  eibfiller2       pic x(2).
  5075     02  eibrcode         pic x(6).
  5076     02  eibfiller3       pic x(2).
  5077     02  eibds            pic x(8).
  5078     02  eibreqid         pic x(8).
  5079     02  eibrsrce         pic x(8).
  5080     02  eibsync          pic x(1).
  5081     02  eibfree          pic x(1).
  5082     02  eibrecv          pic x(1).
  5083     02  eibsend          pic x(1).
  5084     02  eibatt           pic x(1).
  5085     02  eibeoc           pic x(1).
  5086     02  eibfmh           pic x(1).
  5087     02  eibcompl         pic x(1).
  5088     02  eibsig           pic x(1).
  5089     02  eibconf          pic x(1).
  5090     02  eiberr           pic x(1).
  5091     02  eibrldbk         pic x(1).
  5092     02  eiberrcd         pic x(4).
  5093     02  eibsynrb         pic x(1).
  5094     02  eibnodat         pic x(1).
  5095     02  eibfiller5       pic x(2).
  5096     02  eibresp          pic s9(8) comp.
  5097     02  eibresp2         pic s9(8) comp.
  5098     02  dfheigdj         pic s9(4) comp.
  5099     02  dfheigdk         pic s9(4) comp.
  5100
  5101 01  DFHCOMMAREA                   PIC X(1036).
  5102
  5103*01 PARMLIST .
  5104*    02  FILLER                    PIC S9(8)   COMP.
  5105*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5106*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5107*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5108*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5109*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5110*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5111*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5112
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  95
* EL050.cbl
  5114*    COPY ELCCNTL.
  5115******************************************************************
  5116*                                                                *
  5117*                                                                *
  5118*                            ELCCNTL.                            *
  5119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5120*                            VMOD=2.059                          *
  5121*                                                                *
  5122*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5123*                                                                *
  5124*   FILE TYPE = VSAM,KSDS                                        *
  5125*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5126*                                                                *
  5127*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5128*       ALTERNATE INDEX = NONE                                   *
  5129*                                                                *
  5130*   LOG = YES                                                    *
  5131*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5132******************************************************************
  5133*                   C H A N G E   L O G
  5134*
  5135* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5136*-----------------------------------------------------------------
  5137*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5138* EFFECTIVE    NUMBER
  5139*-----------------------------------------------------------------
  5140* 082503                   PEMA  ADD BENEFIT GROUP
  5141* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5142* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5143* 092705    2005050300006  PEMA  ADD SPP LEASES
  5144* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5145* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5146* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5147* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5148* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5149* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5150* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5151* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5152* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5153* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5154* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5155******************************************************************
  5156*
  5157 01  CONTROL-FILE.
  5158     12  CF-RECORD-ID                       PIC XX.
  5159         88  VALID-CF-ID                        VALUE 'CF'.
  5160
  5161     12  CF-CONTROL-PRIMARY.
  5162         16  CF-COMPANY-ID                  PIC XXX.
  5163         16  CF-RECORD-TYPE                 PIC X.
  5164             88  CF-COMPANY-MASTER              VALUE '1'.
  5165             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5166             88  CF-STATE-MASTER                VALUE '3'.
  5167             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5168             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5169             88  CF-CARRIER-MASTER              VALUE '6'.
  5170             88  CF-MORTALITY-MASTER            VALUE '7'.
  5171             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  96
* EL050.cbl
  5172             88  CF-TERMINAL-MASTER             VALUE '9'.
  5173             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5174             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5175             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5176             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5177             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5178             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5179             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5180             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5181             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5182         16  CF-ACCESS-CD-GENL              PIC X(4).
  5183         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5184             20  CF-PROCESSOR               PIC X(4).
  5185         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5186             20  CF-STATE-CODE              PIC XX.
  5187             20  FILLER                     PIC XX.
  5188         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5189             20  FILLER                     PIC XX.
  5190             20  CF-HI-BEN-IN-REC           PIC XX.
  5191         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5192             20  FILLER                     PIC XXX.
  5193             20  CF-CARRIER-CNTL            PIC X.
  5194         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5195             20  FILLER                     PIC XX.
  5196             20  CF-HI-TYPE-IN-REC          PIC 99.
  5197         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5198             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5199                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5200             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5201             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5202         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5203             20  FILLER                     PIC X.
  5204             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5205         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5206             20  FILLER                     PIC XX.
  5207             20  CF-MORTGAGE-PLAN           PIC XX.
  5208         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5209
  5210     12  CF-LAST-MAINT-DT                   PIC XX.
  5211     12  CF-LAST-MAINT-BY                   PIC X(4).
  5212     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5213
  5214     12  CF-RECORD-BODY                     PIC X(728).
  5215
  5216
  5217****************************************************************
  5218*             COMPANY MASTER RECORD                            *
  5219****************************************************************
  5220
  5221     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5222         16  CF-COMPANY-ADDRESS.
  5223             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5224             20  CF-CL-IN-CARE-OF           PIC X(30).
  5225             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5226             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5227             20  CF-CL-CITY-STATE           PIC X(30).
  5228             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5229             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  97
* EL050.cbl
  5230         16  CF-COMPANY-CD                  PIC X.
  5231         16  CF-COMPANY-PASSWORD            PIC X(8).
  5232         16  CF-SECURITY-OPTION             PIC X.
  5233             88  ALL-SECURITY                   VALUE '1'.
  5234             88  COMPANY-VERIFY                 VALUE '2'.
  5235             88  PROCESSOR-VERIFY               VALUE '3'.
  5236             88  NO-SECURITY                    VALUE '4'.
  5237             88  ALL-BUT-TERM                   VALUE '5'.
  5238         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5239             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5240         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5241             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5242         16  CF-INFORCE-LOCATION            PIC X.
  5243             88  CERTS-ARE-ONLINE               VALUE '1'.
  5244             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5245             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5246         16  CF-LOWER-CASE-LETTERS          PIC X.
  5247         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5248             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5249             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5250             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5251             88  CF-ACCNT-CNTL                  VALUE '3'.
  5252             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5253
  5254         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5255         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5256
  5257         16  CF-LGX-CREDIT-USER             PIC X.
  5258             88  CO-IS-NOT-USER                 VALUE 'N'.
  5259             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5260
  5261         16 CF-CREDIT-CALC-CODES.
  5262             20  CF-CR-REM-TERM-CALC PIC X.
  5263               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5264               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5265               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5266               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5267               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5268               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5269               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5270             20  CF-CR-R78-METHOD           PIC X.
  5271               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5272               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5273
  5274         16  CF-CLAIM-CONTROL-COUNTS.
  5275             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5276                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5277
  5278             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5279                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5280
  5281             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5282                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5283
  5284             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5285                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5286
  5287         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  98
* EL050.cbl
  5288
  5289         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5290             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5291             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5292             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5293             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5294                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5295                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5296             20  CF-CO-PREM-REJECT-SW       PIC X.
  5297                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5298                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5299             20  CF-CO-REF-REJECT-SW        PIC X.
  5300                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5301                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5302
  5303         16  CF-CO-REPORTING-DT             PIC XX.
  5304         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5305         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5306           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5307           88  CF-CO-MONTH-END                  VALUE '1'.
  5308
  5309         16  CF-LGX-CLAIM-USER              PIC X.
  5310             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5311             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5312
  5313         16  CF-CREDIT-EDIT-CONTROLS.
  5314             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5315             20  CF-MIN-AGE                 PIC 99.
  5316             20  CF-DEFAULT-AGE             PIC 99.
  5317             20  CF-MIN-TERM                PIC S999      COMP-3.
  5318             20  CF-MAX-TERM                PIC S999      COMP-3.
  5319             20  CF-DEFAULT-SEX             PIC X.
  5320             20  CF-JOINT-AGE-INPUT         PIC X.
  5321                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5322             20  CF-BIRTH-DATE-INPUT        PIC X.
  5323                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5324             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5325                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5326                 88  CF-ZERO-CARRIER            VALUE '1'.
  5327                 88  CF-ZERO-GROUPING           VALUE '2'.
  5328                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5329             20  CF-EDIT-SW                 PIC X.
  5330                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5331             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5332             20  CF-CR-PR-METHOD            PIC X.
  5333               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5334               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5335             20  FILLER                     PIC X.
  5336
  5337         16  CF-CREDIT-MISC-CONTROLS.
  5338             20  CF-REIN-TABLE-SW           PIC X.
  5339                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5340             20  CF-COMP-TABLE-SW           PIC X.
  5341                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5342             20  CF-EXPERIENCE-RETENTION-AGE
  5343                                            PIC S9        COMP-3.
  5344             20  CF-CONVERSION-DT           PIC XX.
  5345             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page  99
* EL050.cbl
  5346             20  CF-RUN-FREQUENCY-SW        PIC X.
  5347                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5348                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5349
  5350             20  CF-CR-CHECK-NO-CONTROL.
  5351                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5352                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5353                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5354                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5355                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5356                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5357
  5358                 24  CF-CR-CHECK-COUNT       REDEFINES
  5359                     CF-CR-CHECK-COUNTER      PIC X(4).
  5360
  5361                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5362                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5363
  5364                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5365                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5366                 24  CF-MAIL-PROCESSING       PIC X.
  5367                     88  MAIL-PROCESSING          VALUE 'Y'.
  5368
  5369         16  CF-MISC-SYSTEM-CONTROL.
  5370             20  CF-SYSTEM-C                 PIC X.
  5371                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5372             20  CF-SYSTEM-D                 PIC X.
  5373                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5374             20  CF-SOC-SEC-NO-SW            PIC X.
  5375                 88  SOC-SEC-NO-USED             VALUE '1'.
  5376             20  CF-MEMBER-NO-SW             PIC X.
  5377                 88  MEMBER-NO-USED              VALUE '1'.
  5378             20  CF-TAX-ID-NUMBER            PIC X(11).
  5379             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5380             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5381                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5382                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5383                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5384                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5385             20  CF-SYSTEM-E                 PIC X.
  5386                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5387
  5388         16  CF-LGX-LIFE-USER               PIC X.
  5389             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5390             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5391
  5392         16  CF-CR-MONTH-END-DT             PIC XX.
  5393
  5394         16  CF-FILE-MAINT-DATES.
  5395             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5396                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5397             20  CF-LAST-BATCH       REDEFINES
  5398                 CF-LAST-BATCH-NO               PIC X(4).
  5399             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5400             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5401             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5402             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5403             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 100
* EL050.cbl
  5404             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5405             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5406             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5407             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5408             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5409
  5410         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5411         16  FILLER                         PIC X.
  5412
  5413         16  CF-ALT-MORT-CODE               PIC X(4).
  5414         16  CF-MEMBER-CAPTION              PIC X(10).
  5415
  5416         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5417             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5418             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5419             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5420             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5421             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5422
  5423         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5424
  5425         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5426         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5427         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5428         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5429
  5430         16  CF-AH-OVERRIDE-L1              PIC X.
  5431         16  CF-AH-OVERRIDE-L2              PIC XX.
  5432         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5433         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5434
  5435         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5436         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5437
  5438         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5439         16  CF-AR-LAST-EL860-DT            PIC XX.
  5440         16  CF-MP-MONTH-END-DT             PIC XX.
  5441
  5442         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5443         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5444             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5445
  5446         16  CF-AR-MONTH-END-DT             PIC XX.
  5447
  5448         16  CF-CRDTCRD-USER                PIC X.
  5449             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5450             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5451
  5452         16  CF-CC-MONTH-END-DT             PIC XX.
  5453
  5454         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5455
  5456         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5457             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5458             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5459             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5460         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5461         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 101
* EL050.cbl
  5462         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5463         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5464             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5465             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5466         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5467         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5468         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5469             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5470         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5471
  5472         16  CF-CL-ZIP-CODE.
  5473             20  CF-CL-ZIP-PRIME.
  5474                 24  CF-CL-ZIP-1ST          PIC X.
  5475                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5476                 24  FILLER                 PIC X(4).
  5477             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5478         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5479             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5480             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5481             20  FILLER                     PIC XXX.
  5482
  5483         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5484         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5485         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5486         16  CF-CO-OPTION-START-DATE        PIC XX.
  5487         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5488           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5489                                                      '3' '4'.
  5490           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5491           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5492           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5493           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5494           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5495           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5496
  5497         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5498
  5499         16  CF-PAYMENT-APPROVAL-LEVELS.
  5500             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5501             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5502             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5503             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5504             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5505             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5506
  5507         16  CF-END-USER-REPORTING-USER     PIC X.
  5508             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5509             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5510
  5511         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5512             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5513             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5514
  5515         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5516
  5517         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5518         16  FILLER                         PIC X.
  5519
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 102
* EL050.cbl
  5520         16  CF-CREDIT-ARCHIVE-CNTL.
  5521             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5522             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5523             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5524
  5525         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5526
  5527         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5528             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5529             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5530
  5531         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5532             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5533             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5534
  5535         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5536
  5537         16  CF-CO-ACH-ID-CODE              PIC  X.
  5538             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5539             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5540             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5541         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5542         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5543         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5544         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5545         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5546         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5547         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5548         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5549         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5550                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5551         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5552                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5553
  5554         16  CF-CO-OVER-SHORT.
  5555             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5556             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5557
  5558*         16  FILLER                         PIC X(102).
  5559         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5560             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5561             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5562
  5563         16  CF-AH-APPROVAL-DAYS.
  5564             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5565             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5566             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5567             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5568
  5569         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5570
  5571         16  CF-APPROV-LEV-5.
  5572             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5573             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5574             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5575
  5576         16  FILLER                         PIC X(68).
  5577****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 103
* EL050.cbl
  5578*             PROCESSOR/USER RECORD                            *
  5579****************************************************************
  5580
  5581     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5582         16  CF-PROCESSOR-NAME              PIC X(30).
  5583         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5584         16  CF-PROCESSOR-TITLE             PIC X(26).
  5585         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5586                 88  MESSAGE-YES                VALUE 'Y'.
  5587                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5588
  5589*****************************************************
  5590****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5591****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5592****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5593****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5594*****************************************************
  5595
  5596         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5597             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5598             20  CF-APPLICATION-FORCE       PIC X.
  5599             20  CF-INDIVIDUAL-APP.
  5600                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5601                     28  CF-BROWSE-APP      PIC X.
  5602                     28  CF-UPDATE-APP      PIC X.
  5603
  5604         16  CF-CURRENT-TERM-ON             PIC X(4).
  5605         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5606             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5607             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5608             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5609             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5610             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5611             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5612             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5613         16  CF-PROCESSOR-CARRIER           PIC X.
  5614             88  NO-CARRIER-SECURITY            VALUE ' '.
  5615         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5616             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5617         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5618             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5619         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5620             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5621
  5622         16  CF-PROC-SYS-ACCESS-SW.
  5623             20  CF-PROC-CREDIT-CLAIMS-SW.
  5624                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5625                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5626                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5627                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5628             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5629                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5630                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5631             20  CF-PROC-LIFE-GNRLDGR-SW.
  5632                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5633                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5634                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5635                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 104
* EL050.cbl
  5636             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5637                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5638                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5639         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5640             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5641             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5642         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5643
  5644         16  CF-APPROVAL-LEVEL                  PIC X.
  5645             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5646             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5647             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5648             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5649             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5650
  5651         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5652
  5653         16  CF-LANGUAGE-TYPE                   PIC X.
  5654             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5655             88  CF-LANG-IS-FR                      VALUE 'F'.
  5656
  5657         16  CF-CSR-IND                         PIC X.
  5658         16  FILLER                             PIC X(239).
  5659
  5660****************************************************************
  5661*             PROCESSOR/REMINDERS RECORD                       *
  5662****************************************************************
  5663
  5664     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5665         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5666             20  CF-START-REMIND-DT         PIC XX.
  5667             20  CF-END-REMIND-DT           PIC XX.
  5668             20  CF-REMINDER-TEXT           PIC X(50).
  5669         16  FILLER                         PIC X(296).
  5670
  5671
  5672****************************************************************
  5673*             STATE MASTER RECORD                              *
  5674****************************************************************
  5675
  5676     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5677         16  CF-STATE-ABBREVIATION          PIC XX.
  5678         16  CF-STATE-NAME                  PIC X(25).
  5679         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5680         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5681             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5682             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5683             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5684             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5685                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5686                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5687             20  CF-ST-PREM-REJECT-SW       PIC X.
  5688                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5689                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5690             20  CF-ST-REF-REJECT-SW        PIC X.
  5691                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5692                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5693         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 105
* EL050.cbl
  5694         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5695         16  CF-ST-REFUND-RULES.
  5696             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5697             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5698             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5699         16  CF-ST-FST-PMT-EXTENSION.
  5700             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5701             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5702                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5703                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5704                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5705                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5706         16  CF-ST-STATE-CALL.
  5707             20  CF-ST-CALL-UNEARNED        PIC X.
  5708             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5709             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5710         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5711             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5712             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5713         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5714         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5715         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5716         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5717         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5718         16  FILLER                         PIC X.
  5719         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5720             20  CF-ST-BENEFIT-CD           PIC XX.
  5721             20  CF-ST-BENEFIT-KIND         PIC X.
  5722                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5723                 88  CF-ST-AH-KIND              VALUE 'A'.
  5724             20  CF-ST-REM-TERM-CALC        PIC X.
  5725                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5726                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5727                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5728                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5729                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5730                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5731                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5732                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5733
  5734             20  CF-ST-REFUND-CALC          PIC X.
  5735                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5736                 88  ST-REFD-BY-R78             VALUE '1'.
  5737                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5738                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5739                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5740                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5741                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5742                 88  ST-REFD-UTAH               VALUE '7'.
  5743                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5744                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5745                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5746
  5747             20  CF-ST-EARNING-CALC         PIC X.
  5748                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5749                 88  ST-EARN-BY-R78             VALUE '1'.
  5750                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5751                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 106
* EL050.cbl
  5752                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5753                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5754                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5755                 88  ST-EARN-MEAN               VALUE '8'.
  5756                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5757
  5758             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5759                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5760                 88  ST-OVRD-BY-R78             VALUE '1'.
  5761                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5762                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5763                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5764                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5765                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5766                 88  ST-OVRD-MEAN               VALUE '8'.
  5767                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5768             20  cf-st-extra-periods        pic 9.
  5769*            20  FILLER                     PIC X.
  5770
  5771         16  CF-ST-COMMISSION-CAPS.
  5772             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5773             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5774             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5775             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5776         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5777                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5778                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5779                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5780
  5781         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5782
  5783         16  CF-ST-STATUTORY-INTEREST.
  5784             20  CF-ST-STAT-DATE-FROM       PIC X.
  5785                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5786                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5787             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5788             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5789             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5790             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5791             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5792
  5793         16  CF-ST-OVER-SHORT.
  5794             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5795             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5796
  5797         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5798
  5799         16  CF-ST-RT-CALC                  PIC X.
  5800
  5801         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5802         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5803         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5804         16  CF-ST-RF-LR-CALC               PIC X.
  5805         16  CF-ST-RF-LL-CALC               PIC X.
  5806         16  CF-ST-RF-LN-CALC               PIC X.
  5807         16  CF-ST-RF-AH-CALC               PIC X.
  5808         16  CF-ST-RF-CP-CALC               PIC X.
  5809*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 107
* EL050.cbl
  5810*CIDMOD         16  FILLER                         PIC X(192).
  5811         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5812             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5813         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5814         16  CF-ST-VFY-2ND-BENE             PIC X.
  5815         16  CF-ST-CAUSAL-STATE             PIC X.
  5816         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5817         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5818         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5819             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5820         16  CF-ST-NET-ONLY-STATE           PIC X.
  5821             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5822         16  cf-commission-cap-required     pic x.
  5823         16  CF-ST-GA-COMMISSION-CAPS.
  5824             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5825             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5826             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5827             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5828         16  CF-ST-TOT-COMMISSION-CAPS.
  5829             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5830             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5831             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5832             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5833         16  FILLER                         PIC X(156).
  5834
  5835****************************************************************
  5836*             BENEFIT MASTER RECORD                            *
  5837****************************************************************
  5838
  5839     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5840         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5841             20  CF-BENEFIT-CODE            PIC XX.
  5842             20  CF-BENEFIT-NUMERIC  REDEFINES
  5843                 CF-BENEFIT-CODE            PIC XX.
  5844             20  CF-BENEFIT-ALPHA           PIC XXX.
  5845             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5846             20  CF-BENEFIT-COMMENT         PIC X(10).
  5847
  5848             20  CF-LF-COVERAGE-TYPE        PIC X.
  5849                 88  CF-REDUCING                VALUE 'R'.
  5850                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5851
  5852             20  CF-SPECIAL-CALC-CD         PIC X.
  5853                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5854                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5855                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5856                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5857                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5858                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5859                 88  CF-FARM-PLAN               VALUE 'F'.
  5860                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5861                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5862                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5863                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5864                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5865                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5866                 88  CF-PRUDENTIAL              VALUE 'P'.
  5867                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 108
* EL050.cbl
  5868                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5869                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5870                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5871                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5872                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5873
  5874             20  CF-JOINT-INDICATOR         PIC X.
  5875                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5876
  5877*            20  FILLER                     PIC X(12).
  5878             20  cf-maximum-benefits        pic s999 comp-3.
  5879             20  FILLER                     PIC X(09).
  5880             20  CF-BENEFIT-CATEGORY        PIC X.
  5881             20  CF-LOAN-TYPE               PIC X(8).
  5882
  5883             20  CF-CO-REM-TERM-CALC        PIC X.
  5884                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5885                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5886                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5887                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5888                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5889
  5890             20  CF-CO-EARNINGS-CALC        PIC X.
  5891                 88  CO-EARN-BY-R78             VALUE '1'.
  5892                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5893                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5894                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5895                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5896                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5897                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5898                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5899
  5900             20  CF-CO-REFUND-CALC          PIC X.
  5901                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5902                 88  CO-REFD-BY-R78             VALUE '1'.
  5903                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5904                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5905                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5906                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5907                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5908                 88  CO-REFD-MEAN               VALUE '8'.
  5909                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5910                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5911                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5912
  5913             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5914                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5915                 88  CO-OVRD-BY-R78             VALUE '1'.
  5916                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5917                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5918                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5919                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5920                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5921                 88  CO-OVRD-MEAN               VALUE '8'.
  5922                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5923
  5924             20  CF-CO-BEN-I-G-CD           PIC X.
  5925                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 109
* EL050.cbl
  5926                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5927                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5928
  5929         16  FILLER                         PIC X(304).
  5930
  5931
  5932****************************************************************
  5933*             CARRIER MASTER RECORD                            *
  5934****************************************************************
  5935
  5936     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5937         16  CF-ADDRESS-DATA.
  5938             20  CF-MAIL-TO-NAME            PIC X(30).
  5939             20  CF-IN-CARE-OF              PIC X(30).
  5940             20  CF-ADDRESS-LINE-1          PIC X(30).
  5941             20  CF-ADDRESS-LINE-2          PIC X(30).
  5942             20  CF-CITY-STATE              PIC X(30).
  5943             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5944             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5945
  5946         16  CF-CLAIM-NO-CONTROL.
  5947             20  CF-CLAIM-NO-METHOD         PIC X.
  5948                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5949                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5950                 88  CLAIM-NO-SEQ               VALUE '3'.
  5951                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5952             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5953                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5954                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5955                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5956
  5957         16  CF-CHECK-NO-CONTROL.
  5958             20  CF-CHECK-NO-METHOD         PIC X.
  5959                 88  CHECK-NO-MANUAL            VALUE '1'.
  5960                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5961                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5962                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5963             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5964                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5965
  5966         16  CF-DOMICILE-STATE              PIC XX.
  5967
  5968         16  CF-EXPENSE-CONTROLS.
  5969             20  CF-EXPENSE-METHOD          PIC X.
  5970                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5971                 88  DOLLARS-PER-PMT            VALUE '2'.
  5972                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5973                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5974             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5975             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5976
  5977         16  CF-CORRESPONDENCE-CONTROL.
  5978             20  CF-LETTER-RESEND-OPT       PIC X.
  5979                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5980                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5981             20  FILLER                     PIC X(4).
  5982
  5983         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 110
* EL050.cbl
  5984             20  CF-MANUAL-SW               PIC X.
  5985                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5986             20  CF-FUTURE-SW               PIC X.
  5987                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5988             20  CF-PTC-SW                  PIC X.
  5989                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5990             20  CF-IBNR-SW                 PIC X.
  5991                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5992             20  CF-PTC-LF-SW               PIC X.
  5993                 88  CF-LF-PTC-USED             VALUE '1'.
  5994             20  CF-CDT-ACCESS-METHOD       PIC X.
  5995                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5996                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5997                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5998             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5999
  6000         16  CF-CLAIM-CALC-METHOD           PIC X.
  6001             88  360-PLUS-MONTHS                VALUE '1'.
  6002             88  365-PLUS-MONTHS                VALUE '2'.
  6003             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6004             88  360-DAILY                      VALUE '4'.
  6005             88  365-DAILY                      VALUE '5'.
  6006
  6007         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6008         16  FILLER                         PIC X(11).
  6009
  6010         16  CF-LIMIT-AMOUNTS.
  6011             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6012             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6013             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6014             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6015             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6016             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6017             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6018             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6019             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6020             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6021
  6022         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6023         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6024         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6025
  6026         16  CF-ZIP-CODE.
  6027             20  CF-ZIP-PRIME.
  6028                 24  CF-ZIP-1ST             PIC X.
  6029                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6030                 24  FILLER                 PIC X(4).
  6031             20  CF-ZIP-PLUS4               PIC X(4).
  6032         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6033             20  CF-CAN-POSTAL-1            PIC XXX.
  6034             20  CF-CAN-POSTAL-2            PIC XXX.
  6035             20  FILLER                     PIC XXX.
  6036
  6037         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6038         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6039         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6040
  6041         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 111
* EL050.cbl
  6042             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6043             88  CF-NO-RATING                   VALUE 'N'.
  6044
  6045         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6046
  6047         16  CF-CARRIER-OVER-SHORT.
  6048             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6049             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6050
  6051         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6052         16  CF-SECPAY-SWITCH               PIC X.
  6053             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6054             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6055         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6056         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6057         16  FILLER                         PIC X(444).
  6058*        16  FILLER                         PIC X(452).
  6059
  6060
  6061****************************************************************
  6062*             MORTALITY MASTER RECORD                          *
  6063****************************************************************
  6064
  6065     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6066         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6067                                INDEXED BY CF-MORT-NDX.
  6068             20  CF-MORT-TABLE              PIC X(5).
  6069             20  CF-MORT-TABLE-TYPE         PIC X.
  6070                 88  CF-MORT-JOINT              VALUE 'J'.
  6071                 88  CF-MORT-SINGLE             VALUE 'S'.
  6072                 88  CF-MORT-COMBINED           VALUE 'C'.
  6073                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6074                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6075             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6076             20  CF-MORT-AGE-METHOD         PIC XX.
  6077                 88  CF-AGE-LAST                VALUE 'AL'.
  6078                 88  CF-AGE-NEAR                VALUE 'AN'.
  6079             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6080             20  CF-MORT-ADJUSTMENT-DIRECTION
  6081                                            PIC X.
  6082                 88  CF-MINUS                   VALUE '-'.
  6083                 88  CF-PLUS                    VALUE '+'.
  6084             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6085             20  CF-MORT-JOINT-CODE         PIC X.
  6086                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6087             20  CF-MORT-PC-Q               PIC X.
  6088                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6089             20  CF-MORT-TABLE-CODE         PIC X(4).
  6090             20  CF-MORT-COMMENTS           PIC X(15).
  6091             20  FILLER                     PIC X(14).
  6092
  6093         16  FILLER                         PIC X(251).
  6094
  6095
  6096****************************************************************
  6097*             BUSSINESS TYPE MASTER RECORD                     *
  6098****************************************************************
  6099
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 112
* EL050.cbl
  6100     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6101* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6102* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6103* AND RECORD 05 IS TYPES 81-99
  6104         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6105             20  CF-BUSINESS-TITLE          PIC  X(19).
  6106             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6107                                            PIC S9V9(4) COMP-3.
  6108             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6109             20  FILLER                     PIC  X.
  6110         16  FILLER                         PIC  X(248).
  6111
  6112
  6113****************************************************************
  6114*             TERMINAL MASTER RECORD                           *
  6115****************************************************************
  6116
  6117     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6118
  6119         16  CF-COMPANY-TERMINALS.
  6120             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6121                                  PIC X(4).
  6122         16  FILLER               PIC X(248).
  6123
  6124
  6125****************************************************************
  6126*             LIFE EDIT MASTER RECORD                          *
  6127****************************************************************
  6128
  6129     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6130         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6131             20  CF-LIFE-CODE-IN            PIC XX.
  6132             20  CF-LIFE-CODE-OUT           PIC XX.
  6133         16  FILLER                         PIC X(248).
  6134
  6135
  6136****************************************************************
  6137*             AH EDIT MASTER RECORD                            *
  6138****************************************************************
  6139
  6140     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6141         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6142             20  CF-AH-CODE-IN              PIC XXX.
  6143             20  CF-AH-CODE-OUT             PIC XX.
  6144         16  FILLER                         PIC X(248).
  6145
  6146
  6147****************************************************************
  6148*             CREDIBILITY TABLES                               *
  6149****************************************************************
  6150
  6151     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6152         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6153                             INDEXED BY CF-CRDB-NDX.
  6154             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6155             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6156             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6157         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 113
* EL050.cbl
  6158
  6159
  6160****************************************************************
  6161*             REPORT CUSTOMIZATION RECORD                      *
  6162****************************************************************
  6163
  6164     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6165         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6166             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6167             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6168             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6169**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6170****       A T-TRANSFER.                                   ****
  6171             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6172
  6173         16  FILLER                         PIC XX.
  6174
  6175         16  CF-CARRIER-CNTL-OPT.
  6176             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6177                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6178                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6179             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6180                                            PIC X.
  6181         16  CF-GROUP-CNTL-OPT.
  6182             20  CF-GROUP-OPT-SEQ           PIC 9.
  6183                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6184                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6185             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6186                                            PIC X(6).
  6187         16  CF-STATE-CNTL-OPT.
  6188             20  CF-STATE-OPT-SEQ           PIC 9.
  6189                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6190                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6191             20  CF-STATE-SELECT OCCURS 3 TIMES
  6192                                            PIC XX.
  6193         16  CF-ACCOUNT-CNTL-OPT.
  6194             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6195                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6196                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6197             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6198                                            PIC X(10).
  6199         16  CF-BUS-TYP-CNTL-OPT.
  6200             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6201                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6202                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6203             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6204                                            PIC XX.
  6205         16  CF-LF-TYP-CNTL-OPT.
  6206             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6207                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6208                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6209             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6210                                            PIC XX.
  6211         16  CF-AH-TYP-CNTL-OPT.
  6212             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6213                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6214                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6215             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 114
* EL050.cbl
  6216                                            PIC XX.
  6217         16  CF-REPTCD1-CNTL-OPT.
  6218             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6219                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6220                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6221             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6222                                            PIC X(10).
  6223         16  CF-REPTCD2-CNTL-OPT.
  6224             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6225                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6226                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6227             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6228                                            PIC X(10).
  6229         16  CF-USER1-CNTL-OPT.
  6230             20  CF-USER1-OPT-SEQ           PIC 9.
  6231                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6232                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6233             20  CF-USER1-SELECT OCCURS 3 TIMES
  6234                                            PIC X(10).
  6235         16  CF-USER2-CNTL-OPT.
  6236             20  CF-USER2-OPT-SEQ           PIC 9.
  6237                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6238                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6239             20  CF-USER2-SELECT OCCURS 3 TIMES
  6240                                            PIC X(10).
  6241         16  CF-USER3-CNTL-OPT.
  6242             20  CF-USER3-OPT-SEQ           PIC 9.
  6243                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6244                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6245             20  CF-USER3-SELECT OCCURS 3 TIMES
  6246                                            PIC X(10).
  6247         16  CF-USER4-CNTL-OPT.
  6248             20  CF-USER4-OPT-SEQ           PIC 9.
  6249                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6250                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6251             20  CF-USER4-SELECT OCCURS 3 TIMES
  6252                                            PIC X(10).
  6253         16  CF-USER5-CNTL-OPT.
  6254             20  CF-USER5-OPT-SEQ           PIC 9.
  6255                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6256                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6257             20  CF-USER5-SELECT OCCURS 3 TIMES
  6258                                            PIC X(10).
  6259         16  CF-REINS-CNTL-OPT.
  6260             20  CF-REINS-OPT-SEQ           PIC 9.
  6261                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6262                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6263             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6264                 24  CF-REINS-PRIME         PIC XXX.
  6265                 24  CF-REINS-SUB           PIC XXX.
  6266
  6267         16  CF-AGENT-CNTL-OPT.
  6268             20  CF-AGENT-OPT-SEQ           PIC 9.
  6269                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6270                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6271             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6272                                            PIC X(10).
  6273
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 115
* EL050.cbl
  6274         16  FILLER                         PIC X(43).
  6275
  6276         16  CF-LOSS-RATIO-SELECT.
  6277             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6278             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6279         16  CF-ENTRY-DATE-SELECT.
  6280             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6281             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6282         16  CF-EFFECTIVE-DATE-SELECT.
  6283             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6284             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6285
  6286         16  CF-EXCEPTION-LIST-IND          PIC X.
  6287             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6288
  6289         16  FILLER                         PIC X(318).
  6290
  6291****************************************************************
  6292*                  EXCEPTION REPORTING RECORD                  *
  6293****************************************************************
  6294
  6295     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6296         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6297             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6298
  6299         16  CF-COMBINED-LIFE-AH-OPT.
  6300             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6301             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6302             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6303             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6304
  6305         16  CF-LIFE-OPT.
  6306             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6307             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6308             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6309             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6310             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6311             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6312             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6313             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6314             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6315             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6316
  6317         16  CF-AH-OPT.
  6318             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6319             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6320             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6321             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6322             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6323             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6324             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6325             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6326             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6327             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6328
  6329         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6330             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6331             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 116
* EL050.cbl
  6332             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6333
  6334         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6335
  6336         16  FILLER                         PIC X(673).
  6337
  6338
  6339****************************************************************
  6340*             MORTGAGE SYSTEM PLAN RECORD                      *
  6341****************************************************************
  6342
  6343     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6344         16  CF-PLAN-TYPE                   PIC X.
  6345             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6346             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6347             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6348         16  CF-PLAN-ABBREV                 PIC XXX.
  6349         16  CF-PLAN-DESCRIPT               PIC X(10).
  6350         16  CF-PLAN-NOTES                  PIC X(20).
  6351         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6352         16  CF-PLAN-UNDERWRITING.
  6353             20  CF-PLAN-TERM-DATA.
  6354                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6355                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6356             20  CF-PLAN-AGE-DATA.
  6357                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6358                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6359                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6360             20  CF-PLAN-BENEFIT-DATA.
  6361                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6362                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6363                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6364                                            PIC S9(7)V99  COMP-3.
  6365         16  CF-PLAN-POLICY-FORMS.
  6366             20  CF-POLICY-FORM             PIC X(12).
  6367             20  CF-MASTER-APPLICATION      PIC X(12).
  6368             20  CF-MASTER-POLICY           PIC X(12).
  6369         16  CF-PLAN-RATING.
  6370             20  CF-RATE-CODE               PIC X(5).
  6371             20  CF-SEX-RATING              PIC X.
  6372                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6373                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6374             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6375             20  CF-SUB-STD-TYPE            PIC X.
  6376                 88  CF-PCT-OF-PREM            VALUE '1'.
  6377                 88  CF-PCT-OF-BENE            VALUE '2'.
  6378         16  CF-PLAN-PREM-TOLERANCES.
  6379             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6380             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6381         16  CF-PLAN-PYMT-TOLERANCES.
  6382             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6383             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6384         16  CF-PLAN-MISC-DATA.
  6385             20  FILLER                     PIC X.
  6386             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6387             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6388         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6389         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 117
* EL050.cbl
  6390             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6391                                                     '1'.
  6392             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6393                                                     '2'.
  6394         16  CF-MIB-SEARCH-SW               PIC X.
  6395             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6396             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6397             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6398             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6399         16  CF-ALPHA-SEARCH-SW             PIC X.
  6400             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6401             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6402             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6403             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6404             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6405             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6406             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6407             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6408             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6409             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6410                                                     'A' 'B' 'C'
  6411                                                     'X' 'Y' 'Z'.
  6412         16  CF-EFF-DT-RULE-SW              PIC X.
  6413             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6414             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6415             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6416             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6417             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6418         16  FILLER                         PIC X(4).
  6419         16  CF-HEALTH-QUESTIONS            PIC X.
  6420             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6421         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6422         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6423         16  CF-PLAN-SNGL-JNT               PIC X.
  6424             88  CF-COMBINED-PLAN              VALUE 'C'.
  6425             88  CF-JNT-PLAN                   VALUE 'J'.
  6426             88  CF-SNGL-PLAN                  VALUE 'S'.
  6427         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6428         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6429         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6430         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6431         16  CF-RERATE-CNTL                 PIC  X.
  6432             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6433             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6434             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6435             88  CF-AUTO-RECALC                 VALUE '4'.
  6436         16  CF-BENEFIT-TYPE                PIC  X.
  6437             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6438             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6439         16  CF-POLICY-FEE                  PIC S999V99
  6440                                                    COMP-3.
  6441         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6442         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6443         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6444         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6445         16  FILLER                         PIC  X(32).
  6446         16  CF-TERMINATION-FORM            PIC  X(04).
  6447         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 118
* EL050.cbl
  6448         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6449                                                       COMP-3.
  6450         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6451         16  CF-ISSUE-LETTER                PIC  X(4).
  6452         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6453         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6454             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6455             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6456         16  CF-MP-REFUND-CALC              PIC X.
  6457             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6458             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6459             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6460             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6461             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6462             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6463             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6464             88  CF-MP-REFD-MEAN                VALUE '8'.
  6465         16  CF-ALT-RATE-CODE               PIC  X(5).
  6466
  6467
  6468         16  FILLER                         PIC X(498).
  6469****************************************************************
  6470*             MORTGAGE COMPANY MASTER RECORD                   *
  6471****************************************************************
  6472
  6473     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6474         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6475         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6476             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6477             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6478             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6479             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6480             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6481
  6482         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6483         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6484         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6485         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6486         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6487
  6488         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6489             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6490         16  CF-MP-RECON-USE-IND            PIC X(1).
  6491             88  CF-MP-USE-RECON             VALUE 'Y'.
  6492         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6493             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6494         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6495             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6496             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6497         16  FILLER                         PIC X(1).
  6498         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6499             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6500         16  CF-MORTG-MIB-VERSION           PIC X.
  6501             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6502             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6503             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6504         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6505             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 119
* EL050.cbl
  6506                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6507             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6508                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6509             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6510                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6511             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6512                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6513             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6514                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6515             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6516                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6517         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6518         16  FILLER                         PIC X(7).
  6519         16  CF-MORTG-DESTINATION-SYMBOL.
  6520             20  CF-MORTG-MIB-COMM          PIC X(5).
  6521             20  CF-MORTG-MIB-TERM          PIC X(5).
  6522         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6523             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6524         16  FILLER                         PIC X(03).
  6525         16  CF-MP-CHECK-NO-CONTROL.
  6526             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6527                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6528                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6529                                                ' ' LOW-VALUES.
  6530                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6531                                               VALUE '3'.
  6532         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6533         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6534         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6535             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6536                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6537             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6538                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6539             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6540                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6541             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6542                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6543             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6544                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6545             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6546                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6547         16  CF-MORTG-BILLING-AREA.
  6548             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6549                                            PIC X.
  6550         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6551         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6552         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6553         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6554             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6555             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6556         16  FILLER                         PIC X.
  6557         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6558             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6559             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6560         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6561         16  FILLER                         PIC X(8).
  6562         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6563         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 120
* EL050.cbl
  6564         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6565         16  CF-ACH-COMPANY-ID.
  6566             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6567                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6568                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6569                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6570             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6571         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6572             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6573         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6574             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6575             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6576         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6577         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6578         16  FILLER                         PIC X(536).
  6579
  6580****************************************************************
  6581*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6582****************************************************************
  6583
  6584     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6585         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6586             20  CF-FEMALE-HEIGHT.
  6587                 24  CF-FEMALE-FT           PIC 99.
  6588                 24  CF-FEMALE-IN           PIC 99.
  6589             20  CF-FEMALE-MIN-WT           PIC 999.
  6590             20  CF-FEMALE-MAX-WT           PIC 999.
  6591         16  FILLER                         PIC X(428).
  6592
  6593     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6594         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6595             20  CF-MALE-HEIGHT.
  6596                 24  CF-MALE-FT             PIC 99.
  6597                 24  CF-MALE-IN             PIC 99.
  6598             20  CF-MALE-MIN-WT             PIC 999.
  6599             20  CF-MALE-MAX-WT             PIC 999.
  6600         16  FILLER                         PIC X(428).
  6601******************************************************************
  6602*             AUTOMATIC ACTIVITY RECORD                          *
  6603******************************************************************
  6604     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6605         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6606             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6607             20  CF-SYS-LETTER-ID           PIC X(04).
  6608             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6609             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6610             20  CF-SYS-RESET-SW            PIC X(01).
  6611             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6612             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6613
  6614         16  FILLER                         PIC X(50).
  6615
  6616         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6617             20  CF-USER-ACTIVE-SW          PIC X(01).
  6618             20  CF-USER-LETTER-ID          PIC X(04).
  6619             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6620             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6621             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 121
* EL050.cbl
  6622             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6623             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6624             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6625
  6626         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 122
* EL050.cbl
  6628*    COPY ERCACCT.
  6629******************************************************************
  6630*                                                                *
  6631*                                                                *
  6632*                            ERCACCT                             *
  6633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6634*                            VMOD=2.031                          *
  6635*                                                                *
  6636*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6637*                                                                *
  6638*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6639*   VSAM ACCOUNT MASTER FILES.                                   *
  6640*                                                                *
  6641*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6642*                                                                *
  6643*   FILE TYPE = VSAM,KSDS                                        *
  6644*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6645*                                                                *
  6646*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6647*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6648*                                                                *
  6649*   LOG = NO                                                     *
  6650*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6651*                                                                *
  6652*                                                                *
  6653******************************************************************
  6654*                   C H A N G E   L O G
  6655*
  6656* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6657*-----------------------------------------------------------------
  6658*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6659* EFFECTIVE    NUMBER
  6660*-----------------------------------------------------------------
  6661* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6662* 092705    2005050300006  PEMA  ADD SPP LEASES
  6663* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6664* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6665* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6666* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6667* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6668* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6669******************************************************************
  6670
  6671 01  ACCOUNT-MASTER.
  6672     12  AM-RECORD-ID                      PIC XX.
  6673         88  VALID-AM-ID                      VALUE 'AM'.
  6674
  6675     12  AM-CONTROL-PRIMARY.
  6676         16  AM-COMPANY-CD                 PIC X.
  6677         16  AM-MSTR-CNTRL.
  6678             20  AM-CONTROL-A.
  6679                 24  AM-CARRIER            PIC X.
  6680                 24  AM-GROUPING.
  6681                     28 AM-GROUPING-PREFIX PIC XXX.
  6682                     28 AM-GROUPING-PRIME  PIC XXX.
  6683                 24  AM-STATE              PIC XX.
  6684                 24  AM-ACCOUNT.
  6685                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 123
* EL050.cbl
  6686                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6687             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6688                                           PIC X(19).
  6689             20  AM-CNTRL-B.
  6690                 24  AM-EXPIRATION-DT      PIC XX.
  6691                 24  FILLER                PIC X(4).
  6692             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6693                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6694
  6695     12  AM-CONTROL-BY-VAR-GRP.
  6696         16  AM-COMPANY-CD-A1              PIC X.
  6697         16  AM-VG-CARRIER                 PIC X.
  6698         16  AM-VG-GROUPING                PIC X(6).
  6699         16  AM-VG-STATE                   PIC XX.
  6700         16  AM-VG-ACCOUNT                 PIC X(10).
  6701         16  AM-VG-DATE.
  6702             20  AM-VG-EXPIRATION-DT       PIC XX.
  6703             20  FILLER                    PIC X(4).
  6704         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6705                                           PIC 9(11)      COMP-3.
  6706     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6707         16  FILLER                        PIC X(10).
  6708         16  AM-VG-KEY3.
  6709             20  AM-VG3-ACCOUNT            PIC X(10).
  6710             20  AM-VG3-EXP-DT             PIC XX.
  6711         16  FILLER                        PIC X(4).
  6712     12  AM-MAINT-INFORMATION.
  6713         16  AM-LAST-MAINT-DT              PIC XX.
  6714         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6715         16  AM-LAST-MAINT-USER            PIC X(4).
  6716         16  FILLER                        PIC XX.
  6717
  6718     12  AM-EFFECTIVE-DT                   PIC XX.
  6719     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6720
  6721     12  AM-PREV-DATES  COMP-3.
  6722         16  AM-PREV-EXP-DT                PIC 9(11).
  6723         16  AM-PREV-EFF-DT                PIC 9(11).
  6724
  6725     12  AM-REPORT-CODE-1                  PIC X(10).
  6726     12  AM-REPORT-CODE-2                  PIC X(10).
  6727
  6728     12  AM-CITY-CODE                      PIC X(4).
  6729     12  AM-COUNTY-PARISH                  PIC X(6).
  6730
  6731     12  AM-NAME                           PIC X(30).
  6732     12  AM-PERSON                         PIC X(30).
  6733     12  AM-ADDRS                          PIC X(30).
  6734     12  AM-CITY.
  6735         16  AM-ADDR-CITY                  PIC X(28).
  6736         16  AM-ADDR-STATE                 PIC XX.
  6737     12  AM-ZIP.
  6738         16  AM-ZIP-PRIME.
  6739             20  AM-ZIP-PRI-1ST            PIC X.
  6740                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6741             20  FILLER                    PIC X(4).
  6742         16  AM-ZIP-PLUS4                  PIC X(4).
  6743     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 124
* EL050.cbl
  6744         16  AM-CAN-POSTAL-1               PIC XXX.
  6745         16  AM-CAN-POSTAL-2               PIC XXX.
  6746         16  FILLER                        PIC XXX.
  6747     12  AM-TEL-NO.
  6748         16  AM-AREA-CODE                  PIC 999.
  6749         16  AM-TEL-PRE                    PIC 999.
  6750         16  AM-TEL-NBR                    PIC 9(4).
  6751     12  AM-TEL-LOC                        PIC X.
  6752         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6753         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6754
  6755     12  AM-COMM-STRUCTURE.
  6756         16  AM-DEFN-1.
  6757             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6758                 24  AM-AGT.
  6759                     28  AM-AGT-PREFIX     PIC X(4).
  6760                     28  AM-AGT-PRIME      PIC X(6).
  6761                 24  AM-COM-TYP            PIC X.
  6762                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6763                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6764                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6765                 24  AM-RECALC-LV-INDIC    PIC X.
  6766                 24  AM-RETRO-LV-INDIC     PIC X.
  6767                 24  AM-GL-CODES           PIC X.
  6768                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6769                 24  FILLER                PIC X(01).
  6770         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6771             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6772                 24  FILLER                PIC X(11).
  6773                 24  AM-L-COMA             PIC XXX.
  6774                 24  AM-J-COMA             PIC XXX.
  6775                 24  AM-A-COMA             PIC XXX.
  6776                 24  FILLER                PIC X(6).
  6777
  6778     12  AM-COMM-CHANGE-STATUS             PIC X.
  6779         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6780
  6781     12  AM-CSR-CODE                       PIC X(4).
  6782
  6783     12  AM-BILLING-STATUS                 PIC X.
  6784         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6785         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6786     12  AM-AUTO-REFUND-SW                 PIC X.
  6787         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6788         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6789     12  AM-GPCD                           PIC 99.
  6790     12  AM-IG                             PIC X.
  6791         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6792         88  AM-HAS-GROUP                     VALUE '2'.
  6793     12  AM-STATUS                         PIC X.
  6794         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6795         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6796         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6797         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6798         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6799         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6800         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6801         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 125
* EL050.cbl
  6802         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6803         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6804     12  AM-REMIT-TO                       PIC 99.
  6805     12  AM-ID-NO                          PIC X(11).
  6806
  6807     12  AM-CAL-TABLE                      PIC XX.
  6808     12  AM-LF-DEVIATION                   PIC XXX.
  6809     12  AM-AH-DEVIATION                   PIC XXX.
  6810     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6811     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6812     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6813     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6814     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6815     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6816
  6817     12  AM-USER-FIELDS.
  6818         16  AM-FLD-1                      PIC XX.
  6819         16  AM-FLD-2                      PIC XX.
  6820         16  AM-FLD-3                      PIC XX.
  6821         16  AM-FLD-4                      PIC XX.
  6822         16  AM-FLD-5                      PIC XX.
  6823
  6824     12  AM-1ST-PROD-DATE.
  6825         16  AM-1ST-PROD-YR                PIC XX.
  6826         16  AM-1ST-PROD-MO                PIC XX.
  6827         16  AM-1ST-PROD-DA                PIC XX.
  6828     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6829     12  AM-CERTS-PURGED-DATE.
  6830         16  AM-PUR-YR                     PIC XX.
  6831         16  AM-PUR-MO                     PIC XX.
  6832         16  AM-PUR-DA                     PIC XX.
  6833     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6834     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6835     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6836     12  AM-INACTIVE-DATE.
  6837         16  AM-INA-MO                     PIC 99.
  6838         16  AM-INA-DA                     PIC 99.
  6839         16  AM-INA-YR                     PIC 99.
  6840     12  AM-AR-HI-CERT-DATE                PIC XX.
  6841
  6842     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6843     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6844
  6845     12  AM-OB-PAYMENT-MODE                PIC X.
  6846         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6847         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6848         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6849         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6850
  6851     12  AM-AH-ONLY-INDICATOR              PIC X.
  6852         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6853         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6854
  6855     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6856
  6857     12  AM-OVER-SHORT.
  6858         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6859         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 126
* EL050.cbl
  6860
  6861     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6862     12  AM-DCC-CLP-STATE                  PIC XX.
  6863
  6864     12  AM-RECALC-COMM                    PIC X.
  6865     12  AM-RECALC-REIN                    PIC X.
  6866
  6867     12  AM-REI-TABLE                      PIC XXX.
  6868     12  AM-REI-ET-LF                      PIC X.
  6869     12  AM-REI-ET-AH                      PIC X.
  6870     12  AM-REI-PE-LF                      PIC X.
  6871     12  AM-REI-PE-AH                      PIC X.
  6872     12  AM-REI-PRT-ST                     PIC X.
  6873     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6874     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6875     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6876     12  AM-REI-GROUP-A                    PIC X(6).
  6877     12  AM-REI-MORT                       PIC X(4).
  6878     12  AM-REI-PRT-OW                     PIC X.
  6879     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6880     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6881     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6882     12  AM-REI-GROUP-B                    PIC X(6).
  6883
  6884     12  AM-TRUST-TYPE                     PIC X(2).
  6885
  6886     12  AM-EMPLOYER-STMT-USED             PIC X.
  6887     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6888
  6889     12  AM-STD-AH-TYPE                    PIC XX.
  6890     12  AM-EARN-METHODS.
  6891         16  AM-EARN-METHOD-R              PIC X.
  6892             88 AM-REF-RL-R78                 VALUE 'R'.
  6893             88 AM-REF-RL-PR                  VALUE 'P'.
  6894             88 AM-REF-RL-MEAN                VALUE 'M'.
  6895             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6896         16  AM-EARN-METHOD-L              PIC X.
  6897             88 AM-REF-LL-R78                 VALUE 'R'.
  6898             88 AM-REF-LL-PR                  VALUE 'P'.
  6899             88 AM-REF-LL-MEAN                VALUE 'M'.
  6900             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6901         16  AM-EARN-METHOD-A              PIC X.
  6902             88 AM-REF-AH-R78                 VALUE 'R'.
  6903             88 AM-REF-AH-PR                  VALUE 'P'.
  6904             88 AM-REF-AH-MEAN                VALUE 'M'.
  6905             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6906             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6907             88 AM-REF-AH-NET                 VALUE 'N'.
  6908
  6909     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6910     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6911     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6912
  6913     12  AM-RET-Y-N                        PIC X.
  6914     12  AM-RET-P-E                        PIC X.
  6915     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6916     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6917     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 127
* EL050.cbl
  6918     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6919         16  AM-POOL-PRIME                 PIC XXX.
  6920         16  AM-POOL-SUB                   PIC XXX.
  6921     12  AM-RETRO-EARNINGS.
  6922         16  AM-RET-EARN-R                 PIC X.
  6923         16  AM-RET-EARN-L                 PIC X.
  6924         16  AM-RET-EARN-A                 PIC X.
  6925     12  AM-RET-ST-TAX-USE                 PIC X.
  6926         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6927         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6928     12  AM-RETRO-BEG-EARNINGS.
  6929         16  AM-RET-BEG-EARN-R             PIC X.
  6930         16  AM-RET-BEG-EARN-L             PIC X.
  6931         16  AM-RET-BEG-EARN-A             PIC X.
  6932     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6933     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6934
  6935     12  AM-USER-SELECT-OPTIONS.
  6936         16  AM-USER-SELECT-1              PIC X(10).
  6937         16  AM-USER-SELECT-2              PIC X(10).
  6938         16  AM-USER-SELECT-3              PIC X(10).
  6939         16  AM-USER-SELECT-4              PIC X(10).
  6940         16  AM-USER-SELECT-5              PIC X(10).
  6941
  6942     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6943
  6944     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6945
  6946     12  AM-RPT045A-SWITCH                 PIC X.
  6947         88  RPT045A-OFF                   VALUE 'N'.
  6948
  6949     12  AM-INSURANCE-LIMITS.
  6950         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6951         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6952
  6953     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6954         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6955
  6956     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6957         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6958         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6959
  6960     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6961
  6962     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6963     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6964     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6965     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6966     12  AM-DCC-UEF-STATE                  PIC XX.
  6967     12  FILLER                            PIC XXX.
  6968     12  AM-REPORT-CODE-3                  PIC X(10).
  6969*    12  FILLER                            PIC X(22).
  6970
  6971     12  AM-RESERVE-DATE.
  6972         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6973         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6974         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6975
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 128
* EL050.cbl
  6976     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6977     12  AM-NOTIFICATION-TYPES.
  6978         16  AM-NOTIF-OF-LETTERS           PIC X.
  6979         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6980         16  AM-NOTIF-OF-REPORTS           PIC X.
  6981         16  AM-NOTIF-OF-STATUS            PIC X.
  6982
  6983     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6984         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6985         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6986         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6987         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6988
  6989     12  AM-BENEFIT-CONTROLS.
  6990         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6991             20  AM-BENEFIT-CODE           PIC XX.
  6992             20  AM-BENEFIT-TYPE           PIC X.
  6993             20  AM-BENEFIT-REVISION       PIC XXX.
  6994             20  AM-BENEFIT-REM-TERM       PIC X.
  6995             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6996             20  FILLER                    PIC XX.
  6997         16  FILLER                        PIC X(80).
  6998
  6999     12  AM-TRANSFER-DATA.
  7000         16  AM-TRANSFERRED-FROM.
  7001             20  AM-TRNFROM-CARRIER        PIC X.
  7002             20  AM-TRNFROM-GROUPING.
  7003                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7004                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7005             20  AM-TRNFROM-STATE          PIC XX.
  7006             20  AM-TRNFROM-ACCOUNT.
  7007                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7008                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7009             20  AM-TRNFROM-DTE            PIC XX.
  7010         16  AM-TRANSFERRED-TO.
  7011             20  AM-TRNTO-CARRIER          PIC X.
  7012             20  AM-TRNTO-GROUPING.
  7013                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7014                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7015             20  AM-TRNTO-STATE            PIC XX.
  7016             20  AM-TRNTO-ACCOUNT.
  7017                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7018                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7019             20  AM-TRNTO-DTE              PIC XX.
  7020         16  FILLER                        PIC X(10).
  7021
  7022     12  AM-SAVED-REMIT-TO                 PIC 99.
  7023
  7024     12  AM-COMM-STRUCTURE-SAVED.
  7025         16  AM-DEFN-1-SAVED.
  7026             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7027                 24  AM-AGT-SV             PIC X(10).
  7028                 24  AM-COM-TYP-SV         PIC X.
  7029                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7030                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7031                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7032                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7033                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 129
* EL050.cbl
  7034                 24  AM-GL-CODES-SV        PIC X.
  7035                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7036                 24  FILLER                PIC X.
  7037         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7038             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7039                 24  FILLER                PIC X(11).
  7040                 24  AM-L-COMA-SV          PIC XXX.
  7041                 24  AM-J-COMA-SV          PIC XXX.
  7042                 24  AM-A-COMA-SV          PIC XXX.
  7043                 24  FILLER                PIC X(6).
  7044
  7045     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7046         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7047            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7048            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7049            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7050
  7051     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7052     12  FILLER                            PIC X(120).
  7053
  7054     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7055         16  AM-CONTROL-NAME               PIC X(30).
  7056         16  AM-EXECUTIVE-ONE.
  7057             20  AM-EXEC1-NAME             PIC X(15).
  7058             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7059                                                          COMP-3.
  7060             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7061                                                          COMP-3.
  7062         16  AM-EXECUTIVE-TWO.
  7063             20  AM-EXEC2-NAME             PIC X(15).
  7064             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7065                                                          COMP-3.
  7066             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7067                                                          COMP-3.
  7068
  7069     12  AM-RETRO-ADDITIONAL-DATA.
  7070         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7071         16  AM-RETRO-PREM-P-E             PIC X.
  7072         16  AM-RETRO-CLMS-P-I             PIC X.
  7073         16  AM-RETRO-RET-BRACKET-LF.
  7074             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7075                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7076                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7077             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7078                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7079                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7080             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7081                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7082                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7083         16  AM-RETRO-RET-BRACKET-AH.
  7084             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7085                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7086                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7087                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7088             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7089                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7090                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7091             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 130
* EL050.cbl
  7092                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7093                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7094
  7095     12  AM-COMMENTS.
  7096         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7097
  7098     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7099         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7100         16  AM-FLI-BILLING-CODE           PIC X.
  7101         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7102         16  AM-FLI-UNITED-IDENT           PIC X.
  7103         16  AM-FLI-INTEREST-LOST-DATA.
  7104             20  AM-FLI-BANK-NO            PIC X(5).
  7105             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7106             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7107             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7108         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7109             20  AM-FLI-AGT                PIC X(9).
  7110             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7111             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7112         16  FILLER                        PIC X(102).
  7113
  7114     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7115         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7116             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7117             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7118             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7119             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7120             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7121         16  FILLER                          PIC X(10).
  7122******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 131
* EL050.cbl
  7124*    COPY ERCREIN.
  7125******************************************************************
  7126*                                                                *
  7127*                            ERCREIN                             *
  7128*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7129*                            VMOD=2.010                          *
  7130*                                                                *
  7131*   ONLINE CREDIT SYSTEM                                         *
  7132*                                                                *
  7133*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7134*                                                                *
  7135*   FILE TYPE = VSAM,KSDS                                        *
  7136*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7137*                                                                *
  7138*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7139*       ALTERNATE PATH = NONE                                    *
  7140*                                                                *
  7141*   LOG = NO                                                     *
  7142*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7143*                                                                *
  7144******************************************************************
  7145*                   C H A N G E   L O G
  7146*
  7147* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7148*-----------------------------------------------------------------
  7149*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7150* EFFECTIVE    NUMBER
  7151*-----------------------------------------------------------------
  7152* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7153* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7154******************************************************************
  7155 01  REINSURANCE-RECORD.
  7156     12  RE-RECORD-ID                      PIC XX.
  7157         88  VALID-RE-ID                      VALUE 'RE'.
  7158
  7159     12  RE-CONTROL-PRIMARY.
  7160         16  RE-COMPANY-CD                 PIC X.
  7161         16  RE-KEY.
  7162             20  RE-CODE                   PIC X.
  7163                 88  RE-TABLE-RECORD          VALUE 'A'.
  7164                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7165             20  RE-TABLE                  PIC XXX.
  7166             20  FILLER                    PIC XXX.
  7167         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7168             20  FILLER                    PIC X.
  7169             20  RE-COMPANY.
  7170                 24  RE-COMP-PRIME         PIC XXX.
  7171                 24  RE-COMP-SUB           PIC XXX.
  7172
  7173     12  RE-MAINT-INFORMATION.
  7174         16  RE-LAST-MAINT-DT              PIC XX.
  7175         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7176         16  RE-LAST-MAINT-USER            PIC X(4).
  7177         16  FILLER                        PIC X(10).
  7178
  7179     12  RE-TABLE-DATA.
  7180         16  RE-100-COMP                   PIC 99.
  7181
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 132
* EL050.cbl
  7182         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7183             20  RE-REI-COMP-NO.
  7184                 24  RE-REI-COMP           PIC XXX.
  7185                 24  RE-REI-COMP-SUB       PIC XXX.
  7186             20  RE-LF-QC                  PIC X.
  7187             20  RE-AH-QC                  PIC X.
  7188             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7189             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7190             20  RE-LFAGE-LO               PIC 99.
  7191             20  RE-LFAGE-HI               PIC 99.
  7192             20  RE-AHAGE-LO               PIC 99.
  7193             20  RE-AHAGE-HI               PIC 99.
  7194             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7195             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7196             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7197             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7198             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7199             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7200             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7201             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7202             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7203             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7204             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7205             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7206             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7207             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7208             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7209             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7210             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7211             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7212             20  RE-LF-BEN-CODE            PIC X.
  7213             20  RE-AH-BEN-CODE            PIC X.
  7214             20  RE-INTERACTIVE            PIC X.
  7215             20  RE-REMAINING              PIC X.
  7216             20  RE-LF-RUNOFF-SW           PIC X.
  7217             20  RE-AH-RUNOFF-SW           PIC X.
  7218             20  FILLER                    PIC X(19).
  7219
  7220         16  RE-COMP-INFO-END              PIC X(6).
  7221         16  RE-NSP-ST-CD-LF               PIC XX.
  7222         16  RE-NSP-ST-CD-AH               PIC XX.
  7223         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7224             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7225
  7226         16  FILLER                        PIC X(27).
  7227
  7228     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7229         16  RE-NAME                       PIC X(30).
  7230         16  RE-LF-PE                      PIC X.
  7231         16  RE-AH-PE                      PIC X.
  7232         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7233         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7234         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7235         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7236         16  RE-PRT-ST                     PIC X.
  7237         16  RE-PRT-OW                     PIC X.
  7238         16  RE-MORT-CODE                  PIC X(4).
  7239         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 133
* EL050.cbl
  7240         16  RE-ZERO-LF-FEE                PIC X.
  7241         16  RE-ZERO-AH-FEE                PIC X.
  7242         16  RE-CEDE-NAME                  PIC X(30).
  7243         16  RE-LF-COMM                    PIC X.
  7244         16  RE-AH-COMM                    PIC X.
  7245         16  RE-LF-TAX                     PIC X.
  7246         16  RE-AH-TAX                     PIC X.
  7247         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7248         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7249         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7250
  7251         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7252             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7253
  7254         16  RE-LF-CEDING-FEE-BRACKETS.
  7255             20  RE-LF-FEE-METHOD          PIC X.
  7256                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7257                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7258                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7259                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7260             20  RE-LF-FEE-BASIS           PIC X.
  7261                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7262                 88  RE-LF-NET-CEDED               VALUE '2'.
  7263                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7264                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7265                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7266                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7267                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7268                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7269             20  FILLER                    PIC XXX.
  7270             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7271                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7272                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7273
  7274         16  RE-AH-CEDING-FEE-BRACKETS.
  7275             20  RE-AH-FEE-METHOD          PIC X.
  7276                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7277                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7278                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7279                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7280             20  RE-AH-FEE-BASIS           PIC X.
  7281                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7282                 88  RE-AH-NET-CEDED               VALUE '2'.
  7283                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7284                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7285                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7286                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7287                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7288                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7289             20  FILLER                    PIC XXX.
  7290             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7291                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7292                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7293
  7294         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7295
  7296         16  RE-OLD-CEDING-STMT            PIC X.
  7297
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 134
* EL050.cbl
  7298         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7299         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7300         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7301         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7302         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7303         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7304         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7305         16  RE-MORT-SW                    PIC X.
  7306         16  RE-CEDING-TYPE-FLAG           PIC X.
  7307             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7308             88  RE-CEDED                          VALUE 'C'.
  7309             88  RE-ASSUMED                        VALUE 'A'.
  7310             88  RE-PHANTOM                        VALUE 'P'.
  7311
  7312         16  RE-CEDING-STMT-OPT-A          PIC X.
  7313             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7314         16  RE-CEDING-STMT-OPT-B          PIC X.
  7315             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7316         16  RE-CEDING-STMT-OPT-C          PIC X.
  7317             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7318         16  RE-CEDING-STMT-OPT-D          PIC X.
  7319             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7320         16  RE-CEDING-STMT-OPT-E          PIC X.
  7321             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7322
  7323         16  RE-PRT-CRSV                   PIC X.
  7324
  7325         16  RE-GL-CENTER                  PIC X(4).
  7326
  7327         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7328
  7329         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7330
  7331         16  RE-EARN-STOP-CODE             PIC X.
  7332             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7333             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7334
  7335         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7336             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7337
  7338         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7339         16  FILLER                        PIC X(2281).
  7340
  7341         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7342
  7343******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 135
* EL050.cbl
  7345*    COPY ERCCTBL.
  7346******************************************************************
  7347*                                                                *
  7348*                                                                *
  7349*                            ERCCTBL                             *
  7350*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7351*                            VMOD=2.003
  7352*                                                                *
  7353*   ONLINE CREDIT SYSTEM                                         *
  7354*                                                                *
  7355*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7356*                                                                *
  7357*   FILE TYPE = VSAM,KSDS                                        *
  7358*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7359*                                                                *
  7360*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7361*       ALTERNATE PATH = NONE                                    *
  7362*                                                                *
  7363*   LOG = NO                                                     *
  7364*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7365*                                                                *
  7366*                                                                *
  7367******************************************************************
  7368
  7369 01  COMM-TABLE-RECORD.
  7370     12  CT-RECORD-ID                      PIC XX.
  7371         88  VALID-CT-ID                      VALUE 'CT'.
  7372
  7373     12  CT-CONTROL-PRIMARY.
  7374         16  CT-COMPANY-CD                 PIC X.
  7375         16  CT-TABLE                      PIC XXX.
  7376         16  CT-CNTRL-2.
  7377             20  CT-BEN-TYPE               PIC X.
  7378             20  CT-BEN-CODE               PIC XX.
  7379
  7380     12  CT-MAINT-INFORMATION.
  7381         16  CT-LAST-MAINT-DT              PIC XX.
  7382         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7383         16  CT-LAST-MAINT-USER            PIC X(4).
  7384         16  FILLER                        PIC X(31).
  7385
  7386     12  CT-LIMITS.
  7387         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7388
  7389         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7390
  7391         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7392
  7393     12  CT-RATES.
  7394         16  CT-RTX          OCCURS 27 TIMES.
  7395             20  CT-RT                     PIC SV9(5)     COMP-3.
  7396             20  CT-RT-R   REDEFINES
  7397                 CT-RT                     PIC XXX.
  7398
  7399     12  FILLER                            PIC  X(42).
  7400
  7401******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 136
* EL050.cbl
  7403*    COPY ERCFORM.
  7404******************************************************************
  7405*                                                                *
  7406*                                                                *
  7407*                            ERCFORM.                            *
  7408*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7409*                            VMOD=2.003                          *
  7410*                                                                *
  7411*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7412*                                                                *
  7413*    FILE TYPE = VSAM,KSDS                                       *
  7414*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7415*                                                                *
  7416*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7417*                                                                *
  7418*    LOG = YES                                                   *
  7419*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7420******************************************************************
  7421 01  FORM-MASTER.
  7422    12  FO-RECORD-ID                 PIC X(02).
  7423        88  VALID-FO-ID                  VALUE 'FO'.
  7424
  7425    12  FO-CONTROL-PRIMARY.
  7426        16  FO-COMPANY-CD            PIC X(01).
  7427        16  FO-STATE                 PIC X(02).
  7428        16  FO-FORM-ID               PIC X(12).
  7429        16  FO-FORM-EXP-DT           PIC X(02).
  7430
  7431    12  FO-POLICY-FORM-DATA.
  7432        16  FO-IND-GRP-CD            PIC X(01).
  7433        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7434        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7435        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7436        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7437        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7438        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7439        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7440        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7441        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7442        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7443        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7444        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7445        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7446        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7447        16  FO-APP-CERT-USE-CD       PIC X(01).
  7448
  7449    12  FILLER                       PIC X(29).
  7450
  7451    12  FO-FORM-PLAN-TABLE.
  7452        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7453            20  FO-PLAN-TYPE         PIC X(01).
  7454            20  FO-PLAN-ID           PIC X(02).
  7455            20  FO-PLAN-TERM         PIC 9(03).
  7456            20  FO-PLAN-REFUND-METHOD
  7457                                     PIC X.
  7458
  7459    12  FILLER                       PIC X(30).
  7460
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 137
* EL050.cbl
  7461    12  FO-COMMENTS-AREA.
  7462        16  FO-COMMENT-LINE-1        PIC X(78).
  7463
  7464    12  FILLER                       PIC X(20).
  7465
  7466    12  FO-MAINT-INFORMATION.
  7467        16  FO-LAST-MAINT-DT         PIC X(02).
  7468        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7469        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 138
* EL050.cbl
  7471*    COPY ELCMSTR.
  7472******************************************************************
  7473*                                                                *
  7474*                            ELCMSTR.                            *
  7475*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7476*                            VMOD=2.012                          *
  7477*                                                                *
  7478*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7479*                                                                *
  7480*   FILE TYPE = VSAM,KSDS                                        *
  7481*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7482*                                                                *
  7483*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7484*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7485*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7486*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7487*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7488*                                                 RKP=75,LEN=21  *
  7489*                                                                *
  7490*   **** NOTE ****                                               *
  7491*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7492*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7493*                                                                *
  7494*   LOG = YES                                                    *
  7495*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7496******************************************************************
  7497*                   C H A N G E   L O G
  7498*
  7499* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7500*-----------------------------------------------------------------
  7501*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7502* EFFECTIVE    NUMBER
  7503*-----------------------------------------------------------------
  7504* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7505* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7506* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7507* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7508* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7509* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7510******************************************************************
  7511 01  CLAIM-MASTER.
  7512     12  CL-RECORD-ID                PIC XX.
  7513         88  VALID-CL-ID         VALUE 'CL'.
  7514
  7515     12  CL-CONTROL-PRIMARY.
  7516         16  CL-COMPANY-CD           PIC X.
  7517         16  CL-CARRIER              PIC X.
  7518         16  CL-CLAIM-NO             PIC X(7).
  7519         16  CL-CERT-NO.
  7520             20  CL-CERT-PRIME       PIC X(10).
  7521             20  CL-CERT-SFX         PIC X.
  7522
  7523     12  CL-CONTROL-BY-NAME.
  7524         16  CL-COMPANY-CD-A1        PIC X.
  7525         16  CL-INSURED-LAST-NAME    PIC X(15).
  7526         16  CL-INSURED-NAME.
  7527             20  CL-INSURED-1ST-NAME PIC X(12).
  7528             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 139
* EL050.cbl
  7529
  7530     12  CL-CONTROL-BY-SSN.
  7531         16  CL-COMPANY-CD-A2        PIC X.
  7532         16  CL-SOC-SEC-NO.
  7533             20  CL-SSN-STATE        PIC XX.
  7534             20  CL-SSN-ACCOUNT      PIC X(6).
  7535             20  CL-SSN-LN3          PIC X(3).
  7536
  7537     12  CL-CONTROL-BY-CERT-NO.
  7538         16  CL-COMPANY-CD-A4        PIC X.
  7539         16  CL-CERT-NO-A4.
  7540             20  CL-CERT-A4-PRIME    PIC X(10).
  7541             20  CL-CERT-A4-SFX      PIC X.
  7542
  7543     12  CL-CONTROL-BY-CCN.
  7544         16  CL-COMPANY-CD-A5        PIC X.
  7545         16  CL-CCN-A5.
  7546             20  CL-CCN.
  7547                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7548                 24  CL-CCN-PRIME-A5 PIC X(12).
  7549             20  CL-CCN-FILLER-A5    PIC X(4).
  7550
  7551     12  CL-INSURED-PROFILE-DATA.
  7552         16  CL-INSURED-BIRTH-DT     PIC XX.
  7553         16  CL-INSURED-SEX-CD       PIC X.
  7554             88  INSURED-IS-MALE        VALUE 'M'.
  7555             88  INSURED-IS-FEMALE      VALUE 'F'.
  7556             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7557         16  CL-INSURED-OCC-CD       PIC X(6).
  7558         16  FILLER                  PIC X(5).
  7559
  7560     12  CL-PROCESSING-INFO.
  7561         16  CL-PROCESSOR-ID         PIC X(4).
  7562         16  CL-CLAIM-STATUS         PIC X.
  7563             88  CLAIM-IS-OPEN          VALUE 'O'.
  7564             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7565         16  CL-CLAIM-TYPE           PIC X.
  7566*            88  AH-CLAIM               VALUE 'A'.
  7567*            88  LIFE-CLAIM             VALUE 'L'.
  7568*            88  PROPERTY-CLAIM         VALUE 'P'.
  7569*            88  IUI-CLAIM              VALUE 'I'.
  7570*            88  GAP-CLAIM              VALUE 'G'.
  7571*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7572         16  CL-CLAIM-PREM-TYPE      PIC X.
  7573             88  SINGLE-PREMIUM         VALUE '1'.
  7574             88  O-B-COVERAGE           VALUE '2'.
  7575             88  OPEN-END-COVERAGE      VALUE '3'.
  7576         16  CL-INCURRED-DT          PIC XX.
  7577         16  CL-REPORTED-DT          PIC XX.
  7578         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7579         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7580         16  CL-LAST-PMT-DT          PIC XX.
  7581         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7582         16  CL-PAID-THRU-DT         PIC XX.
  7583         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7584         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7585         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7586         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 140
* EL050.cbl
  7587             88  CL-360-DAY-YR          VALUE '1'.
  7588             88  CL-365-DAY-YR          VALUE '2'.
  7589             88  CL-FULL-MONTHS         VALUE '3'.
  7590         16  CL-CAUSE-CD             PIC X(6).
  7591
  7592         16  CL-PRIME-CERT-NO.
  7593             20  CL-PRIME-CERT-PRIME PIC X(10).
  7594             20  CL-PRIME-CERT-SFX   PIC X.
  7595
  7596         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7597             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7598             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7599
  7600         16  CL-MICROFILM-NO         PIC X(10).
  7601         16  FILLER REDEFINES CL-MICROFILM-NO.
  7602             20  CL-BENEFIT-PERIOD   PIC 99.
  7603             20  FILLER              PIC X(8).
  7604         16  CL-PROG-FORM-TYPE       PIC X.
  7605         16  CL-LAST-ADD-ON-DT       PIC XX.
  7606
  7607         16  CL-LAST-REOPEN-DT       PIC XX.
  7608         16  CL-LAST-CLOSE-DT        PIC XX.
  7609         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7610             88  FINAL-PAID             VALUE '1'.
  7611             88  CLAIM-DENIED           VALUE '2'.
  7612             88  AUTO-CLOSE             VALUE '3'.
  7613             88  MANUAL-CLOSE           VALUE '4'.
  7614             88  BENEFITS-CHANGED       VALUE 'C'.
  7615             88  SETUP-ERRORS           VALUE 'E'.
  7616         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7617         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7618         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7619             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7620         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7621         16  FILLER                  PIC X.
  7622
  7623     12  CL-CERTIFICATE-DATA.
  7624         16  CL-CERT-ORIGIN          PIC X.
  7625             88  CERT-WAS-ONLINE        VALUE '1'.
  7626             88  CERT-WAS-CREATED       VALUE '2'.
  7627             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7628         16  CL-CERT-KEY-DATA.
  7629             20  CL-CERT-CARRIER     PIC X.
  7630             20  CL-CERT-GROUPING    PIC X(6).
  7631             20  CL-CERT-STATE       PIC XX.
  7632             20  CL-CERT-ACCOUNT.
  7633                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7634                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7635             20  CL-CERT-EFF-DT      PIC XX.
  7636
  7637     12  CL-STATUS-CONTROLS.
  7638         16  CL-PRIORITY-CD          PIC X.
  7639             88  CONFIDENTIAL-DATA      VALUE '8'.
  7640             88  HIGHEST-PRIORITY       VALUE '9'.
  7641         16  CL-SUPV-ATTN-CD         PIC X.
  7642             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7643             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7644         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 141
* EL050.cbl
  7645         16  CL-RESTORED-DT          PIC XX.
  7646         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7647         16  CL-NEXT-RESEND-DT       PIC XX.
  7648         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7649         16  CL-CRITICAL-PERIOD      PIC 99.
  7650*        16  FILLER                  PIC XX.
  7651         16  CL-LAST-MAINT-DT        PIC XX.
  7652         16  CL-LAST-MAINT-USER      PIC X(4).
  7653         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7654         16  CL-LAST-MAINT-TYPE      PIC X.
  7655             88  CLAIM-SET-UP           VALUE ' '.
  7656             88  PAYMENT-MADE           VALUE '1'.
  7657             88  LETTER-SENT            VALUE '2'.
  7658             88  MASTER-WAS-ALTERED     VALUE '3'.
  7659             88  MASTER-WAS-RESTORED    VALUE '4'.
  7660             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7661             88  FILE-CONVERTED         VALUE '6'.
  7662             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7663             88  ERROR-CORRECTION       VALUE 'E'.
  7664         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7665         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7666         16  CL-BENEFICIARY          PIC X(10).
  7667         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7668         16  CL-DENIAL-TYPE          PIC X.
  7669             88  CL-TYPE-DENIAL          VALUE '1'.
  7670             88  CL-TYPE-RESCISSION      VALUE '2'.
  7671             88  CL-TYPE-REFORMATION     VALUE '3'.
  7672             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7673             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7674         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7675         16  filler                  pic x(3).
  7676*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7677*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7678*        16  CL-RTW-DT               PIC XX.
  7679
  7680     12  CL-TRAILER-CONTROLS.
  7681         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7682             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7683             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7684             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7685         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7686         16  FILLER                  PIC XX.
  7687         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7688         16  CL-ADDRESS-TRAILER-CNT.
  7689             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7690                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7691             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7692                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7693             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7694                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7695             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7696                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7697             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7698                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7699             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7700                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7701             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7702                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 142
* EL050.cbl
  7703
  7704     12  CL-CV-REFERENCE-NO.
  7705         16  CL-CV-REFNO-PRIME       PIC X(18).
  7706         16  CL-CV-REFNO-SFX         PIC XX.
  7707
  7708     12  CL-FILE-LOCATION            PIC X(4).
  7709
  7710     12  CL-PROCESS-ERRORS.
  7711         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7712             88  NO-FATAL-ERRORS        VALUE ZERO.
  7713         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7714             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7715
  7716     12  CL-PRODUCT-CD               PIC X.
  7717
  7718     12  CL-CURRENT-KEY-DATA.
  7719         16  CL-CURRENT-CARRIER      PIC X.
  7720         16  CL-CURRENT-GROUPING     PIC X(6).
  7721         16  CL-CURRENT-STATE        PIC XX.
  7722         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7723
  7724     12  CL-ASSOCIATES               PIC X.
  7725         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7726         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7727         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7728         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7729
  7730     12  CL-ACTIVITY-CODE            PIC 99.
  7731     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7732     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7733
  7734     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7735     12  CL-LAG-REPORT-CODE          PIC 9.
  7736     12  CL-LOAN-TYPE                PIC XX.
  7737     12  CL-LEGAL-STATE              PIC XX.
  7738
  7739     12  CL-YESNOSW                  PIC X.
  7740     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7741         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7742         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7743         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7744     12  cl-insured-type             pic x.
  7745         88  cl-claim-on-primary         value 'P'.
  7746         88  cl-claim-on-co-borrower     value 'C'.
  7747     12  cl-benefit-expiration-dt    PIC XX.
  7748
  7749 01  PLAN-RECORDS.
  7750     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7751     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7752
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 143
* EL050.cbl
  7754 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7755                          ACCOUNT-MASTER REINSURANCE-RECORD
  7756                          COMM-TABLE-RECORD FORM-MASTER
  7757                          CLAIM-MASTER PLAN-RECORDS.
  7758 0000-DFHEXIT SECTION.
  7759     MOVE '9#                    $   ' TO DFHEIV0.
  7760     MOVE 'EL050' TO DFHEIV1.
  7761     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7762
  7763     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7764
  7765
  7766* EXEC CICS  HANDLE CONDITION
  7767*           ERROR    (9300-ABEND)
  7768*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7769*    END-EXEC.
  7770*    MOVE '"$.J                  ! " #00007761' TO DFHEIV0
  7771     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7773     MOVE X'2220233030303037373631' TO DFHEIV0(25:11)
  7774     CALL 'kxdfhei1' USING DFHEIV0
  7775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7776
  7777
  7778 0000-COPY-PROCEDURE-DIV.
  7779*                          COPY ELC50PD.
  7780******************************************************************
  7781*                                                                *
  7782*                            ELC50PD                             *
  7783*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7784*                            VMOD=2.188                          *
  7785*                                                                *
  7786******************************************************************
  7787*                   C H A N G E   L O G
  7788*
  7789* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7790*-----------------------------------------------------------------
  7791*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7792* EFFECTIVE    NUMBER
  7793*-----------------------------------------------------------------
  7794* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7795* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7796* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7797*                             2709 AND 2718
  7798* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7799* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7800* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7801* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7802* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7803*                                IS OPEN OR CNC DT < PD THRU
  7804* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7805* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7806* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7807* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7808* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7809* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7810* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7811* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 144
* EL050.cbl
  7812* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7813* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7814* 020906                   PEMA  EXPAND LOAN OFFICER
  7815* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7816* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7817* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7818* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7819* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7820* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7821* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7822* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7823* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7824* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7825* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7826* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7827* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7828* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7829* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7830* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7831* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7832* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7833* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7834* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7835* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7836* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7837* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7838* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7839* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7840*                                UPDATE VIN ON CERT TRAILER
  7841* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7842* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7843* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7844* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7845* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7846* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7847* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7848* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7849* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7850* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7851* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7852* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7853* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7854* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7855* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7856* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7857* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7858* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7859* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7860* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7861* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7862* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7863* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7864* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7865* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7866* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7867* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7868* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7869* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 145
* EL050.cbl
  7870* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7871* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7872* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7873* 032912  CR2011110200001  PEMA  AHL CHANGES
  7874* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7875* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7876* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7877* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7878* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7879* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7880* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7881* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7882* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7883* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7884* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7885* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7886* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7887* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7888* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7889* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7890* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7891* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7892* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7893* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7894* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7895* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7896* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7897* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7898* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7899* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7900* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7901*                                CERT #, ADD 2898 FORCIBLE ERROR
  7902* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7903* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7904* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7905* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7906* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7907* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7908* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7909* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7910* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7911* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7912* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7913* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7914* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7915* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7916* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7917* 100617  CR2017062000003  PEMA  New comm cap edits
  7918* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7919* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7920* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7921* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7922* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7923******************************************************************
  7924************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7925******************************************************************
  7926
  7927     INITIALIZE  WS-CRI-SSN-WORK-AREA.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 146
* EL050.cbl
  7928
  7929     MOVE SPACES                 TO PB-FATAL-FLAG
  7930                                    PB-FORCE-ER-CD
  7931                                    PB-WARN-ER-CD
  7932                                    PB-OUT-BAL-CD.
  7933
  7934     MOVE SPACE                  TO WS-IG-OVRD-AH
  7935                                    WS-IG-OVRD-LF
  7936                                    WS-IG-OVRD-AM
  7937                                    WS-IG-OVRD
  7938                                    WS-IG-OVRD-AH-PL
  7939                                    WS-IG-OVRD-LF-PL
  7940                                    WS-IG-OVRD-AH-BEN
  7941                                    WS-IG-OVRD-LF-BEN.
  7942
  7943******************************************************************
  7944*************       INITIALIZE COMMON ERRORS       ***************
  7945******************************************************************
  7946
  7947     MOVE +0                     TO PB-NO-OF-ERRORS.
  7948     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7949
  7950******************************************************************
  7951
  7952     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7953     SET JULIAN-TO-BIN           TO TRUE.
  7954*    MOVE 5                      TO DC-OPTION-CODE.
  7955     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7956     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7957
  7958     MOVE ZERO                   TO  SUB4.
  7959
  7960 0040-INITIALIZE-GA-BILL-DT.
  7961
  7962     ADD +1                      TO  SUB4.
  7963
  7964     IF  SUB4 GREATER THAN +5
  7965         GO TO 0050-CHECK-CNTL-FOUND.
  7966
  7967     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7968         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7969
  7970     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7971
  7972 0050-CHECK-CNTL-FOUND.
  7973
  7974     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7975        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7976                                         WS-AH-REM-TERM-CALC
  7977                                         EC-CO-REM-TERM-CALC
  7978        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7979        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7980        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7981                                         WS-TOL-AH-CLAIM
  7982        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7983                                         WS-TOL-AH-PREM
  7984                                         EC-CO-TOL-PREM
  7985        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 147
* EL050.cbl
  7986                                         WS-TOL-AH-REFUND
  7987                                         EC-CO-TOL-REFUND
  7988        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7989                                         WS-AH-REFUND-OVS-AMT
  7990                                         EC-CO-OVR-SHT-AMT
  7991        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7992                                         WS-TOL-AH-PREM-PCT
  7993                                         EC-CO-TOL-PREM-PCT
  7994        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7995                                         WS-TOL-AH-REFUND-PCT
  7996                                         EC-CO-TOL-REFUND-PCT
  7997        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7998                                         WS-AH-REFUND-OVS-PCT
  7999                                         EC-CO-OVR-SHT-PCT
  8000        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8001        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8002        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8003        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8004        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8005        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8006        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8007        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8008        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8009        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8010        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8011        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8012                                         EC-CO-MONTH-END-DT
  8013        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8014          GO TO 0100-READ-ACCT.
  8015
  8016     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8017     MOVE SPACES                 TO CNTL-ACCESS.
  8018     MOVE '1'                    TO CNTL-REC-TYPE.
  8019     MOVE +0                     TO CNTL-SEQ-NO.
  8020
  8021     MOVE '1' TO RC-SW-1.
  8022     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8023     IF NOT CF-COMPANY-MASTER
  8024         MOVE ZEROS             TO WK-CO-TOL-PREM
  8025                                   WK-CO-TOL-CLAIM
  8026                                   WK-CO-TOL-REFUND
  8027                                   WK-REFUND-OVS-AMT
  8028                                   WK-REFUND-OVS-PCT
  8029                                   WK-CO-TOL-PREM-PCT
  8030                                   WK-CO-TOL-REFUND-PCT
  8031                                   WK-DEFAULT-APR
  8032                                   WK-CO-MAX-CAP
  8033        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8034                                   WK-CR-R78-METHOD
  8035                                   WK-CO-REF-REJECT-SW
  8036                                   WK-CO-PREM-REJECT-SW
  8037                                   WK-REM-TRM-CALC-OPTION
  8038                                   WK-BIRTH-DATE-INPUT
  8039                                   WK-JOINT-AGE-INPUT
  8040        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8041        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8042        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8043        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 148
* EL050.cbl
  8044          GO TO 0099-COMPANY-NOT-FOUND.
  8045
  8046     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8047        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8048     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8049        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8050     IF CF-CO-TOL-CAP NOT NUMERIC
  8051        MOVE +0                    TO CF-CO-TOL-CAP.
  8052     IF CF-DEFAULT-APR NOT NUMERIC
  8053        MOVE +0                    TO CF-DEFAULT-APR.
  8054
  8055     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8056     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8057     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8058     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8059     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8060     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8061     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8062     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8063     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8064     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8065     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8066     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8067
  8068     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8069          CF-CO-OVR-SHT-AMT > +0
  8070        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8071
  8072     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8073          CF-CO-OVR-SHT-PCT > +0
  8074        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8075
  8076     IF CF-VALID-REM-TRM-OPTION
  8077         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8078     ELSE
  8079         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8080
  8081     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8082     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8083     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8084     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8085
  8086     GO TO 0050-CHECK-CNTL-FOUND.
  8087
  8088 0099-COMPANY-NOT-FOUND.
  8089
  8090     MOVE ER-2616                TO WS-ERROR.
  8091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8092
  8093 0100-READ-ACCT.
  8094
  8095     MOVE SPACES                 TO DATE-RANGE-SW.
  8096
  8097     IF WK-ACCT-ADDR = ZEROS
  8098        GO TO 0102-ACCT-GETMAIN.
  8099
  8100     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8101     SET ERACCT-FILE-ADDRESSED   TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 149
* EL050.cbl
  8102     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8103
  8104     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8105        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8106        GO TO 0105-READ-ACCT
  8107     END-IF
  8108
  8109     IF PB-CARRIER NOT = SPACES
  8110        IF PB-CARRIER NOT = AM-VG-CARRIER
  8111           GO TO 0105-READ-ACCT.
  8112
  8113     IF PB-STATE NOT = SPACES
  8114        IF PB-STATE NOT = AM-VG-STATE
  8115           GO TO 0105-READ-ACCT.
  8116
  8117     IF PB-GROUPING NOT = SPACES
  8118        IF PB-GROUPING NOT = AM-VG-GROUPING
  8119           GO TO 0105-READ-ACCT.
  8120
  8121     MOVE 'X'                 TO DATE-RANGE-SW.
  8122
  8123     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8124        MOVE 'X'                 TO DATE-RANGE-SW
  8125        GO TO 0105-READ-ACCT.
  8126
  8127     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8128        GO TO 0105-READ-ACCT.
  8129
  8130     GO TO 0180-ACCOUNT-FOUND.
  8131
  8132 0102-ACCT-GETMAIN.
  8133     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8134     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8135
  8136 0105-READ-ACCT.
  8137     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8138     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8139     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8140     MOVE PB-STATE               TO ACCT-STATE.
  8141     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8142     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8143
  8144     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8145
  8146     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8147
  8148 0110-FIND-ACCT-TOLERANCES-LOOP.
  8149     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8150
  8151     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8152        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8153        GO TO 0199-ACCT-NOT-FOUND
  8154     END-IF
  8155     IF PB-CARRIER NOT = SPACES
  8156        IF PB-CARRIER NOT = AM-VG-CARRIER
  8157           GO TO 0199-ACCT-NOT-FOUND.
  8158
  8159     IF PB-STATE NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 150
* EL050.cbl
  8160        IF PB-STATE NOT = AM-VG-STATE
  8161           GO TO 0199-ACCT-NOT-FOUND.
  8162
  8163     IF PB-GROUPING NOT = SPACES
  8164        IF PB-GROUPING NOT = AM-VG-GROUPING
  8165           GO TO 0199-ACCT-NOT-FOUND.
  8166
  8167     MOVE 'X'                    TO DATE-RANGE-SW.
  8168
  8169     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8170        MOVE 'X'                 TO DATE-RANGE-SW
  8171        GO TO 0199-ACCT-NOT-FOUND.
  8172
  8173     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8174        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8175
  8176 0180-ACCOUNT-FOUND.
  8177     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8178     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8179     MOVE AM-STATE               TO PB-SV-STATE.
  8180     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8181
  8182     IF AM-CANCEL-FEE  NOT NUMERIC
  8183        MOVE ZEROS TO AM-CANCEL-FEE.
  8184
  8185     IF AM-MAX-MON-BEN NOT NUMERIC
  8186        MOVE ZEROS TO AM-MAX-MON-BEN.
  8187
  8188     IF AM-MAX-TOT-BEN NOT NUMERIC
  8189        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8190
  8191     IF AM-CLP-TOL-PCT NOT NUMERIC
  8192        MOVE +0                  TO AM-CLP-TOL-PCT
  8193     END-IF
  8194     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8195        MOVE +0                  TO AM-SPP-LEASE-COMM
  8196     END-IF
  8197     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8198        MOVE ER-2611             TO   WS-ERROR
  8199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8200
  8201     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8202        MOVE ER-2621             TO   WS-ERROR
  8203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8204
  8205     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8206        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8207        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8208        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8209         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8210
  8211     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8212     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8213     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8214     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8215     IF AM-CLP-TOL-PCT NOT = ZEROS
  8216        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8217     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 151
* EL050.cbl
  8218     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8219        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8220     END-IF
  8221*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8222*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8223*                                   WS-ADMIN-FEES
  8224*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8225*          (SUB5 > +10)
  8226*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8227*             AND (AM-A-COM (SUB5) NUMERIC)
  8228*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8229*                + (AM-A-COM (SUB5) * 1000)
  8230*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8231*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8232*                + (AM-A-COM (SUB5) * 1000)
  8233*             END-IF
  8234*             IF AM-COM-TYP (SUB5) = 'N'
  8235*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8236*                + (AM-A-COM (SUB5) * 1000)
  8237*             END-IF
  8238*          END-IF
  8239*       END-PERFORM
  8240*    END-IF
  8241     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8242        AND (PB-ISSUE)
  8243        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8244                                    ws-cred-union-fees
  8245        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8246           (SUB5 > +10)
  8247           MOVE +0 TO WS-WK-RATE
  8248           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8249                                   'O' OR 'S')
  8250              IF (AM-A-COM (SUB5) NUMERIC)
  8251                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8252                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8253              ELSE
  8254                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8255                 IF PB-ISSUE
  8256                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8257                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8258                 ELSE
  8259                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8260                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8261                 END-IF
  8262                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8263                 MOVE ZEROS             TO WS-SUB1
  8264                                           WS-COMMISSION
  8265                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8266                 MOVE '0530'               TO CTBL-SW
  8267                 MOVE ' '                  TO WS-CTBL-READ-SW
  8268                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8269                 IF FIRST-TIME-THROUGH
  8270                    MOVE 'AA'              TO CTBL-BEN-CODE
  8271                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8272                 END-IF
  8273                 IF CTBL-TABLE-FOUND
  8274                    IF PB-ISSUE
  8275                       COMPUTE WS-COMM-CK-AMT =
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 152
* EL050.cbl
  8276                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8277                    ELSE
  8278                       COMPUTE WS-COMM-CK-AMT =
  8279                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8280                    END-IF
  8281                    PERFORM 8800-GET-COMP-RATE
  8282                              THRU 8800-EXIT
  8283                 END-IF
  8284              END-IF
  8285              if am-com-typ (sub5) = 'O' or 'S'
  8286                 compute ws-cred-union-fees rounded =
  8287                    ws-cred-union-fees +
  8288                    (pb-i-ah-premium-amt * ws-wk-rate)
  8289              else
  8290                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8291                + (WS-WK-RATE * 1000)
  8292              end-if
  8293           END-IF
  8294        END-PERFORM
  8295     END-IF
  8296     IF PB-COMPANY-ID EQUAL 'CRI'
  8297         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8298
  8299     IF PB-COMPANY-ID EQUAL 'NCL'
  8300         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8301     END-IF
  8302
  8303     GO TO 0200-READ-CERT.
  8304
  8305 0199-ACCT-NOT-FOUND.
  8306
  8307     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8308
  8309     IF DATE-RANGE-SW NOT = SPACES
  8310        MOVE ER-2601             TO WS-ERROR
  8311        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8312     ELSE
  8313        MOVE ER-2619             TO WS-ERROR
  8314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8315
  8316     GO TO 9990-RETURN.
  8317
  8318 0200-READ-CERT.
  8319
  8320     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8321     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8322     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8323     MOVE PB-SV-STATE            TO CERT-STATE.
  8324     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8325     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8326     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8327
  8328     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8329
  8330     IF CERT-WAS-NOT-FOUND
  8331        GO TO 0299-CERT-NOT-FOUND.
  8332
  8333     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 153
* EL050.cbl
  8334        MOVE ER-2759             TO WS-ERROR
  8335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8336        GO TO 0298-UNLOCK-RETURN.
  8337
  8338     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8339         MOVE ER-2758            TO WS-ERROR
  8340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8341         GO TO 0298-UNLOCK-RETURN.
  8342
  8343     IF PB-ISSUE
  8344        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8345           IF CERT-WAS-CREATED-FOR-CLAIM
  8346              NEXT SENTENCE
  8347            ELSE
  8348              MOVE ER-2626       TO WS-ERROR
  8349              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8350              GO TO 0298-UNLOCK-RETURN.
  8351
  8352     IF NOT PB-CANCELLATION
  8353        GO TO 0300-CONTINUE-EDIT.
  8354
  8355     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8356     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8357     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8358     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8359     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8360     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8361
  8362     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8363     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8364     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8365     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8366     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8367     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8368     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8369     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8370     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8371
  8372     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8373     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8374     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8375     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8376     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8377     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8378     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8379
  8380     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8381     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8382
  8383     MOVE CM-CREDIT-INTERFACE-SW-1
  8384                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8385     MOVE CM-CREDIT-INTERFACE-SW-2
  8386                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8387
  8388     IF CM-O-B-COVERAGE
  8389         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8390
  8391     IF CM-LIVES NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 154
* EL050.cbl
  8392         MOVE ZERO                TO CM-LIVES.
  8393
  8394     IF CM-BILLED NOT NUMERIC
  8395         MOVE ZERO                TO CM-BILLED.
  8396
  8397     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8398         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8399         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8400         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8401         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8402         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8403         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8404         MOVE CM-LIVES             TO PB-CI-LIVES
  8405*The next line causes a problem with my change  I dont think it is
  8406*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8407
  8408     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8409     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8410     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8411     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8412     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8413     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8414
  8415     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8416     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8417     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8418     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8419
  8420     IF CM-LIFE-COMM-PCT NUMERIC
  8421         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8422     ELSE
  8423         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8424
  8425     IF CM-AH-COMM-PCT NUMERIC
  8426         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8427     ELSE
  8428         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8429
  8430     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8431
  8432     IF CM-LOAN-APR       NOT NUMERIC
  8433           MOVE ZERO               TO CM-LOAN-APR.
  8434
  8435     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8436           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8437
  8438     IF CM-LOAN-TERM      NOT NUMERIC
  8439           MOVE ZERO               TO CM-LOAN-TERM.
  8440
  8441     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8442           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8443
  8444     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8445           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8446
  8447     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8448     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8449     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 155
* EL050.cbl
  8450     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8451     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8452     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8453     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8454     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8455     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8456     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8457     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8458     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8459     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8460
  8461     IF CM-STATE = CM-SSN-STATE
  8462         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8463
  8464     IF CM-STATE NOT = CM-MEMB-STATE
  8465         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8466
  8467     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8468
  8469     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8470*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8471        IF CM-ADDL-CLP NOT NUMERIC
  8472           MOVE +0               TO CM-ADDL-CLP
  8473        END-IF
  8474        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8475        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8476           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8477        END-IF
  8478     END-IF
  8479     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8480        MOVE +0                  TO WS-ADMIN-FEES
  8481                                    WS-CSO-ADMIN-FEE
  8482                                    WS-COMM-AND-MFEE
  8483                                    WS-1ST-YR-ALLOW
  8484        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8485           (SUB5 > +10)
  8486           MOVE +0 TO WS-WK-RATE
  8487           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8488              IF (AM-A-COM (SUB5) NUMERIC)
  8489                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8490                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8491              ELSE
  8492                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8493                 IF PB-ISSUE
  8494                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8495                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8496                 ELSE
  8497                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8498                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8499                 END-IF
  8500                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8501                 MOVE ZEROS             TO WS-SUB1
  8502                                           WS-COMMISSION
  8503                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8504                 MOVE '0530'               TO CTBL-SW
  8505                 MOVE ' '                  TO WS-CTBL-READ-SW
  8506                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8507                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 156
* EL050.cbl
  8508                    MOVE 'AA'              TO CTBL-BEN-CODE
  8509                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8510                 END-IF
  8511                 IF CTBL-TABLE-FOUND
  8512                    IF PB-ISSUE
  8513                       COMPUTE WS-COMM-CK-AMT =
  8514                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8515                    ELSE
  8516                       COMPUTE WS-COMM-CK-AMT =
  8517                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8518                    END-IF
  8519                    PERFORM 8800-GET-COMP-RATE
  8520                              THRU 8800-EXIT
  8521                 END-IF
  8522              END-IF
  8523              IF AM-COM-TYP (SUB5) = 'I'
  8524                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8525                   + (WS-WK-RATE * 1000)
  8526              END-IF
  8527              IF AM-COM-TYP (SUB5) = 'N'
  8528                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8529                   + (WS-WK-RATE * 1000)
  8530              END-IF
  8531              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8532                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8533                   + (WS-WK-RATE * 1000)
  8534              END-IF
  8535              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8536                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8537                   + (WS-WK-RATE * 1000)
  8538              END-IF
  8539           END-IF
  8540        END-PERFORM
  8541     END-IF
  8542     GO TO 0300-CONTINUE-EDIT.
  8543
  8544 0298-UNLOCK-RETURN.
  8545      PERFORM 9250-UNLOCK-RETURN
  8546      GO TO 9990-RETURN.
  8547
  8548 0299-CERT-NOT-FOUND.
  8549
  8550     MOVE '1'                     TO CERT-STATUS-SW.
  8551
  8552     IF PB-COMPANY-ID = 'UCL'
  8553         IF WS-ERROR = ER-2799
  8554             GO TO 3000-CONTINUE-EDIT.
  8555
  8556     IF NOT PB-CANCELLATION
  8557         GO TO 0300-CONTINUE-EDIT.
  8558
  8559     MOVE ER-2726                  TO  WS-ERROR.
  8560     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8561     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8562     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8563                                    PB-CI-LF-TERM
  8564                                    PB-C-LF-REM-TERM
  8565                                    PB-CI-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 157
* EL050.cbl
  8566                                    PB-C-AH-REM-TERM
  8567                                    PB-CI-LF-BENEFIT-CD
  8568                                    PB-CI-LF-BENEFIT-AMT
  8569                                    PB-CI-LF-ALT-BENEFIT-AMT
  8570                                    PB-CI-LF-PREMIUM-AMT
  8571                                    PB-CI-LF-ALT-PREMIUM-AMT
  8572                                    PB-CI-AH-BENEFIT-CD
  8573                                    PB-CI-AH-BENEFIT-AMT
  8574                                    PB-CI-AH-PREMIUM-AMT
  8575                                    PB-CI-PAY-FREQUENCY
  8576                                    PB-CI-LOAN-APR
  8577                                    PB-CI-LOAN-TERM
  8578                                    PB-CI-LIFE-COMMISSION
  8579                                    PB-CI-AH-COMMISSION
  8580                                    PB-CI-CURR-SEQ
  8581                                    PB-CI-AH-CANCEL-AMT
  8582                                    PB-CI-LF-CANCEL-AMT
  8583                                    PB-CI-RATE-DEV-PCT-LF
  8584                                    PB-CI-RATE-DEV-PCT-AH
  8585                                    PB-CI-EXTENTION-DAYS
  8586                                    PB-CI-TERM-IN-DAYS
  8587                                    PB-CI-LIVES
  8588                                    PB-CI-LF-CRIT-PER
  8589                                    PB-CI-AH-CRIT-PER
  8590                                    PB-CI-ADDL-CLP
  8591                                    PB-CI-DDF-IU-RATE-UP.
  8592
  8593     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8594                                    PB-CI-AH-SETTLEMENT-DT
  8595                                    PB-CI-DEATH-DT
  8596                                    PB-CI-LF-PRIOR-CANCEL-DT
  8597                                    PB-CI-AH-PRIOR-CANCEL-DT
  8598                                    PB-CI-ENTRY-DT
  8599                                    PB-CI-LF-EXPIRE-DT
  8600                                    PB-CI-AH-EXPIRE-DT
  8601                                    PB-CI-LOAN-1ST-PMT-DT.
  8602
  8603     IF ACCOUNT-MAST-FOUND
  8604        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8605        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8606
  8607
  8608 0300-CONTINUE-EDIT.
  8609
  8610     IF PB-ISSUE
  8611        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8612            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8613
  8614     IF PB-ISSUE
  8615        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8616            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8617
  8618     IF PB-ISSUE
  8619       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8620          (AM-NO-AH-ONLY)
  8621           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8622               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8623                   MOVE ER-2679 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 158
* EL050.cbl
  8624                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8625
  8626     IF PB-ISSUE
  8627        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8628        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8629        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8630     ELSE
  8631        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8632        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8633        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8634
  8635     MOVE 'N'                    TO PLAN-MASTER-SW
  8636                                    PLAN-MASTER-LIFE-SW
  8637                                    FORM-MASTER-SW
  8638                                    WS-APP-CERT-SW.
  8639
  8640     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8641                                    WS-PL-TOL-LF-REFUND
  8642                                    WS-PL-REF-OVS-AMT
  8643                                    WS-PL-TOL-LF-PREM-PCT
  8644                                    WS-PL-TOL-LF-REFUND-PCT
  8645                                    WS-PL-REF-OVS-PCT
  8646                                    WS-PL-TOL-LF-CLAIM.
  8647
  8648     IF PB-COMPANY-ID = 'NCL'
  8649       IF PB-ISSUE
  8650         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8651             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8652             IF FORM-MASTER-FOUND
  8653                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8654
  8655     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8656        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8657
  8658********************** MON CODE **********************
  8659     IF PB-COMPANY-ID = 'MON'
  8660     IF PB-ISSUE
  8661     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8662        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8663             PB-I-LOAN-APR = ZERO)
  8664               MOVE 14.0         TO PB-I-LOAN-APR.
  8665******************************************************
  8666
  8667     IF PB-COMPANY-ID = 'NCL'
  8668       IF PB-ISSUE
  8669           IF FORM-MASTER-FOUND
  8670             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8671                AM-DISMBR-COVERAGE
  8672                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8673                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8674                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8675                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8676                                           PB-I-LIFE-BENEFIT-CD.
  8677
  8678     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8679
  8680     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8681         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 159
* EL050.cbl
  8682         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8683         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8684         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8685         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8686           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8687             GO TO 0301-LIFE-BENEFIT-SEARCH
  8688         ELSE
  8689             NEXT SENTENCE
  8690     ELSE
  8691         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8692
  8693     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8694     MOVE '4'                    TO CNTL-REC-TYPE.
  8695     MOVE +0                     TO CNTL-SEQ-NO.
  8696     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8697
  8698     MOVE '1' TO RC-SW-2.
  8699     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8700
  8701     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8702        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8703         GO TO 0305-BENEFIT-NOT-FOUND.
  8704
  8705     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8706
  8707 0301-LIFE-BENEFIT-SEARCH.
  8708
  8709     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8710
  8711     IF NO-BENEFIT-FOUND
  8712        GO TO 0305-BENEFIT-NOT-FOUND.
  8713
  8714     IF WS-BEN-CD = '99'
  8715        GO TO 0305-BENEFIT-NOT-FOUND.
  8716
  8717     IF PB-COMPANY-ID = 'NCL'
  8718         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8719             GO TO 0304-LIFE-BENEFIT-FOUND.
  8720
  8721     MOVE +1                     TO SUB5.
  8722     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8723
  8724* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8725* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8726     IF PB-COMPANY-ID = 'DMD'
  8727         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8728
  8729 0302-EDIT-ACCT-LF-BENEFITS.
  8730
  8731     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8732        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8733           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8734                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8735           GO TO 03XX-GET-LIFE-ERPLAN.
  8736
  8737     IF SUB5 LESS THAN +20
  8738        ADD +1                   TO SUB5
  8739        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 160
* EL050.cbl
  8740
  8741     MOVE +1                     TO SUB5.
  8742
  8743     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8744        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8745
  8746 0303-EDIT-DMD-EXTRA-BENEFITS.
  8747
  8748     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8749        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8750           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8751                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8752           GO TO 03XX-GET-LIFE-ERPLAN.
  8753
  8754     IF SUB5 LESS THAN +30
  8755        ADD +1                   TO SUB5
  8756        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8757
  8758     MOVE +1                     TO SUB5.
  8759
  8760 03XX-EDIT-FOR-NINETY-LF.
  8761
  8762***************************************************************
  8763*                                                             *
  8764*    NINETY BENEFIT PLAN TYPES:                               *
  8765*                                                             *
  8766*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8767*      92 = ALL GROUP REDUCING BENEFITS                       *
  8768*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8769*      94 = ALL GROUP LEVEL BENEFITS                          *
  8770*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8771*           BENEFIT CONTROLS.                                 *
  8772*      99 = ALL BENEFITS                                      *
  8773*                                                             *
  8774***************************************************************
  8775
  8776     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8777                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8778
  8779     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8780       AND
  8781        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8782        GO TO 03XX-GET-LIFE-ERPLAN.
  8783
  8784     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8785       AND
  8786        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8787        IF CF-REDUCING (SUB3)
  8788           IF (PB-I-INDV-GRP-OVRD = 'I')
  8789              OR
  8790           ((AM-IG = '1') AND
  8791           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8792              OR
  8793           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8794           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8795           (AM-IG NOT = '2'))
  8796              GO TO 03XX-GET-LIFE-ERPLAN.
  8797
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 161
* EL050.cbl
  8798     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8799       AND
  8800        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8801        IF CF-REDUCING (SUB3)
  8802           IF (PB-I-INDV-GRP-OVRD = 'G')
  8803              OR
  8804           ((AM-IG = '2') AND
  8805           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8806              OR
  8807           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8808           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8809           (AM-IG NOT = '1'))
  8810              GO TO 03XX-GET-LIFE-ERPLAN.
  8811
  8812     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8813       AND
  8814        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8815        IF CF-LEVEL    (SUB3)
  8816           IF (PB-I-INDV-GRP-OVRD = 'I')
  8817              OR
  8818           ((AM-IG = '1') AND
  8819           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8820              OR
  8821           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8822           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8823            (AM-IG NOT = '2'))
  8824              GO TO 03XX-GET-LIFE-ERPLAN.
  8825
  8826     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8827       AND
  8828        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8829        IF CF-LEVEL    (SUB3)
  8830           IF (PB-I-INDV-GRP-OVRD = 'G')
  8831              OR
  8832           ((AM-IG = '2') AND
  8833           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8834              OR
  8835           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8836           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8837           (AM-IG NOT = '1'))
  8838              GO TO 03XX-GET-LIFE-ERPLAN.
  8839
  8840     IF SUB5 LESS THAN +20
  8841        ADD +1                   TO SUB5
  8842        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8843
  8844     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8845
  8846     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8847        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8848
  8849     MOVE +1                     TO SUB5.
  8850
  8851 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8852
  8853     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8854                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8855
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 162
* EL050.cbl
  8856     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8857       AND
  8858        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8859        GO TO 03XX-GET-LIFE-ERPLAN.
  8860
  8861     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8862       AND
  8863        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8864        IF CF-REDUCING (SUB3)
  8865           IF (PB-I-INDV-GRP-OVRD = 'I')
  8866              OR
  8867           ((AM-IG = '1') AND
  8868           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8869              OR
  8870           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8871           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8872           (AM-IG NOT = '2'))
  8873              GO TO 03XX-GET-LIFE-ERPLAN.
  8874
  8875     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8876       AND
  8877        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8878        IF CF-REDUCING (SUB3)
  8879           IF (PB-I-INDV-GRP-OVRD = 'G')
  8880              OR
  8881           ((AM-IG = '2') AND
  8882           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8883              OR
  8884           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8885           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8886           (AM-IG NOT = '1'))
  8887              GO TO 03XX-GET-LIFE-ERPLAN.
  8888
  8889     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8890       AND
  8891        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8892        IF CF-LEVEL    (SUB3)
  8893           IF (PB-I-INDV-GRP-OVRD = 'I')
  8894              OR
  8895           ((AM-IG = '1') AND
  8896           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8897              OR
  8898           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8899           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8900            (AM-IG NOT = '2'))
  8901              GO TO 03XX-GET-LIFE-ERPLAN.
  8902
  8903     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8904       AND
  8905        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8906        IF CF-LEVEL    (SUB3)
  8907           IF (PB-I-INDV-GRP-OVRD = 'G')
  8908              OR
  8909           ((AM-IG = '2') AND
  8910           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8911              OR
  8912           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8913           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 163
* EL050.cbl
  8914           (AM-IG NOT = '1'))
  8915              GO TO 03XX-GET-LIFE-ERPLAN.
  8916
  8917     IF SUB5 LESS THAN +30
  8918        ADD +1                   TO SUB5
  8919        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8920
  8921     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8922
  8923 03XX-EDIT-FOR-NINETY-LF-CONT.
  8924
  8925     MOVE +99                    TO SUB5.
  8926
  8927     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8928        IF PB-ISSUE
  8929           MOVE ER-1924          TO  WS-ERROR
  8930           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8931
  8932     GO TO 0304-LIFE-BENEFIT-FOUND.
  8933
  8934 03XX-GET-LIFE-ERPLAN.
  8935
  8936     IF WK-PLAN-ADDR EQUAL +0
  8937        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8938
  8939     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8940     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8941     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8942     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8943     MOVE 'Y'                    TO PLAN-MASTER-SW
  8944                                    PLAN-MASTER-LIFE-SW.
  8945     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8946
  8947 03XX-ERPLAN-LIFE-GETMAIN.
  8948
  8949     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8950     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8951
  8952 03XX-ERPLAN-LIFE-READ.
  8953
  8954     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8955     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8956     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8957     MOVE PB-SV-STATE            TO PLAN-STATE.
  8958     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8959     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8960     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8961     MOVE WS-SAVE-BENEFIT-REVISION
  8962                                 TO PLAN-REVISION-NO.
  8963
  8964     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8965     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8966
  8967     IF PB-COMPANY-ID = 'NCL'
  8968       IF NOT LF-PLAN-MASTER-FOUND
  8969         IF NOT PB-POLICY-IS-DECLINED  AND
  8970            NOT PB-POLICY-IS-VOIDED
  8971             MOVE  ER-1921         TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 164
* EL050.cbl
  8972             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8973             GO TO 0304-LIFE-BENEFIT-FOUND.
  8974
  8975     IF NOT LF-PLAN-MASTER-FOUND
  8976        GO TO 0304-LIFE-BENEFIT-FOUND.
  8977
  8978 XXXX-CHECK-LF-PLAN-KEY.
  8979
  8980     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8981        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8982        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8983        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8984        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8985        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8986        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8987        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8988        MOVE 'N'                 TO PLAN-MASTER-SW
  8989          GO TO 03XX-ERPLAN-LIFE-READ.
  8990
  8991     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8992
  8993     IF  PB-CANCELLATION
  8994         GO TO  0303-LF-ACCT-BEN-FOUND.
  8995
  8996     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8997        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8998           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8999           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9000              MOVE ER-2644             TO WS-ERROR
  9001              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9002           ELSE
  9003              NEXT SENTENCE
  9004        ELSE
  9005           IF PB-COMPANY-ID NOT = 'NCL'
  9006              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9007                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9008
  9009 0303-LF-ACCT-BEN-FOUND.
  9010
  9011     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9012
  9013     IF PL-DEV-CODE NOT = SPACES
  9014        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9015
  9016     IF PL-DEV-PCT NUMERIC AND
  9017        PL-DEV-PCT NOT = ZEROS
  9018        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9019
  9020     IF PL-TOL-PREM-AMT GREATER THAN +0
  9021        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9022
  9023     IF PL-TOL-REF-AMT GREATER THAN +0
  9024        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9025
  9026     IF PL-TOL-PREM-PCT GREATER THAN +0
  9027        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9028
  9029     IF PL-TOL-REF-PCT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 165
* EL050.cbl
  9030        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9031
  9032     IF PL-TOL-CLM-AMT GREATER THAN +0
  9033        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9034
  9035     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9036                          PL-OVER-SHORT-AMT > +0
  9037        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9038
  9039     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9040                          PL-OVER-SHORT-PCT > +0
  9041        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9042
  9043     IF PL-SALES-TAX NUMERIC AND
  9044                          PL-SALES-TAX > +0
  9045         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9046
  9047     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9048        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9049                                    WS-IG-OVRD-AM.
  9050
  9051 0304-LIFE-BENEFIT-FOUND.
  9052
  9053     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9054
  9055     IF PB-ISSUE
  9056        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9057     ELSE
  9058        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9059
  9060     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9061     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9062     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9063     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9064     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9065                                         WS-LF-REFUND-CALC.
  9066     if (ws-lf-earnings-calc = '5')
  9067        and (pb-i-loan-apr = zeros)
  9068        and (benefit-code-chg)
  9069        move +99.9999 to pb-i-loan-apr
  9070     end-if
  9071
  9072     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9073        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9074
  9075     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9076        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9077     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9078
  9079     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9080     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9081     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9082     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9083     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9084     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9085
  9086     IF PB-COMPANY-ID = 'NCL'  AND
  9087        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 166
* EL050.cbl
  9088         NEXT SENTENCE
  9089     ELSE
  9090         IF SUB5 NOT GREATER THAN +20
  9091            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9092               MOVE WS-SAVE-BENEFIT-REM-TERM
  9093                                      TO WS-AM-LF-BENE-REM-TERM
  9094                                         EC-BR-LF-REM-TERM-CALC.
  9095
  9096     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9097     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9098
  9099     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9100
  9101 0305-BENEFIT-NOT-FOUND.
  9102
  9103     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9104     MOVE ER-2604                TO WS-ERROR.
  9105     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9106
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 167
* EL050.cbl
  9108
  9109 0310-FIND-AH-BENEFIT-RECORD.
  9110
  9111     MOVE 'N'                    TO PLAN-MASTER-SW
  9112                                    PLAN-MASTER-AH-SW.
  9113
  9114     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9115                                    WS-PL-TOL-AH-REFUND
  9116                                    WS-AH-PL-REF-OVS-AMT
  9117                                    WS-PL-TOL-AH-PREM-PCT
  9118                                    WS-PL-TOL-AH-REFUND-PCT
  9119                                    WS-AH-PL-REF-OVS-PCT
  9120                                    WS-PL-TOL-AH-CLAIM.
  9121     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9122
  9123
  9124     if pb-issue
  9125        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9126           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9127        end-if
  9128        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9129           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9130           GO TO 0399-BENEFIT-NOT-FOUND
  9131        end-if
  9132     end-if
  9133
  9134     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9135        GO TO 0400-FIND-CARRIER.
  9136
  9137     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9138
  9139     IF WK-AH-BEN-ADDR NOT = ZEROS
  9140         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9141         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9142         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9143         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9144           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9145             GO TO 0311-AH-BENEFIT-SEARCH
  9146         ELSE
  9147             NEXT SENTENCE
  9148     ELSE
  9149         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9150
  9151     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9152     MOVE '5'                    TO CNTL-REC-TYPE.
  9153     MOVE +0                     TO CNTL-SEQ-NO.
  9154     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9155
  9156     MOVE '2' TO RC-SW-2.
  9157     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9158
  9159     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9160        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9161          GO TO 0399-BENEFIT-NOT-FOUND.
  9162
  9163     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9164
  9165 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 168
* EL050.cbl
  9166
  9167     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9168
  9169     IF NO-BENEFIT-FOUND
  9170         GO TO 0399-BENEFIT-NOT-FOUND.
  9171
  9172     IF WS-BEN-CD = '99'
  9173        GO TO 0399-BENEFIT-NOT-FOUND.
  9174
  9175     IF PB-COMPANY-ID  =  'NCL'
  9176         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9177             GO TO 0314-A-H-BENEFIT-FOUND.
  9178
  9179     MOVE +1                     TO SUB5.
  9180     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9181
  9182* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9183* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9184     IF PB-COMPANY-ID = 'DMD'
  9185         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9186
  9187 0312-EDIT-ACCT-AH-BENEFITS.
  9188
  9189     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9190        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9191           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9192                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9193           GO TO 03XX-GET-AH-ERPLAN.
  9194
  9195     IF SUB5 LESS THAN +20
  9196        ADD +1                   TO SUB5
  9197        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9198
  9199     MOVE +1                     TO SUB5.
  9200
  9201     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9202        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9203
  9204 0313-EDIT-DMD-EXTRA-BENEFITS.
  9205
  9206     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9207        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9208           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9209                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9210           GO TO 03XX-GET-AH-ERPLAN.
  9211
  9212     IF SUB5 LESS THAN +30
  9213        ADD +1                   TO SUB5
  9214        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9215
  9216     MOVE +1                     TO SUB5.
  9217
  9218 03XX-EDIT-FOR-NINETY-AH.
  9219
  9220***************************************************************
  9221*                                                             *
  9222*    NINETY BENEFIT PLAN TYPES:                               *
  9223*                                                             *
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 169
* EL050.cbl
  9224*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9225*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9226*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9227*           BENEFIT CONTROLS.                                 *
  9228*      99 = ALL BENEFITS.                                     *
  9229*                                                             *
  9230***************************************************************
  9231
  9232     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9233                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9234
  9235     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9236       AND
  9237        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9238        GO TO 03XX-GET-AH-ERPLAN.
  9239
  9240     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9241       AND
  9242        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9243           IF (PB-I-INDV-GRP-OVRD = 'I')
  9244              OR
  9245           ((AM-IG = '1') AND
  9246           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9247              OR
  9248           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9249           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9250           (AM-IG NOT = '2'))
  9251              GO TO 03XX-GET-AH-ERPLAN.
  9252
  9253     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9254       AND
  9255        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9256           IF (PB-I-INDV-GRP-OVRD = 'G')
  9257              OR
  9258           ((AM-IG = '2') AND
  9259           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9260              OR
  9261           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9262           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9263           (AM-IG NOT = '1'))
  9264              GO TO 03XX-GET-AH-ERPLAN.
  9265
  9266     IF SUB5 LESS THAN +20
  9267        ADD +1                   TO SUB5
  9268        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9269
  9270     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9271        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9272
  9273     MOVE +1                    TO SUB5.
  9274
  9275 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9276
  9277     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9278                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9279
  9280     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9281       AND
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 170
* EL050.cbl
  9282        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9283        GO TO 03XX-GET-AH-ERPLAN.
  9284
  9285     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9286       AND
  9287        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9288           IF (PB-I-INDV-GRP-OVRD = 'I')
  9289              OR
  9290           ((AM-IG = '1') AND
  9291           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9292              OR
  9293           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9294           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9295           (AM-IG NOT = '2'))
  9296              GO TO 03XX-GET-AH-ERPLAN.
  9297
  9298     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9299       AND
  9300        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9301           IF (PB-I-INDV-GRP-OVRD = 'G')
  9302              OR
  9303           ((AM-IG = '2') AND
  9304           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9305              OR
  9306           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9307           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9308           (AM-IG NOT = '1'))
  9309              GO TO 03XX-GET-AH-ERPLAN.
  9310
  9311     IF SUB5 LESS THAN +30
  9312        ADD +1                   TO SUB5
  9313        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9314
  9315 03XX-EDIT-FOR-NINETY-AH-CONT.
  9316
  9317     MOVE +99                    TO SUB5.
  9318
  9319     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9320
  9321     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9322        IF PB-ISSUE
  9323           MOVE ER-1925          TO  WS-ERROR
  9324           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9325
  9326     GO TO 0314-A-H-BENEFIT-FOUND.
  9327
  9328 03XX-GET-AH-ERPLAN.
  9329
  9330     IF WK-PLAN-ADDR EQUAL +0
  9331         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9332
  9333     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9334     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9335     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9336     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9337     MOVE 'Y'                    TO PLAN-MASTER-SW
  9338                                    PLAN-MASTER-AH-SW.
  9339*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 171
* EL050.cbl
  9340     GO TO 03XX-ERPLAN-AH-READ.
  9341
  9342 03XX-ERPLAN-AH-GETMAIN.
  9343
  9344     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9345     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9346
  9347 03XX-ERPLAN-AH-READ.
  9348
  9349     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9350     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9351     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9352     MOVE PB-SV-STATE            TO PLAN-STATE.
  9353     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9354     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9355     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9356     MOVE WS-SAVE-BENEFIT-REVISION
  9357                                 TO PLAN-REVISION-NO.
  9358
  9359     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9360     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9361
  9362     IF PB-COMPANY-ID = 'NCL'
  9363       IF NOT AH-PLAN-MASTER-FOUND
  9364         IF NOT PB-POLICY-IS-DECLINED  AND
  9365            NOT PB-POLICY-IS-VOIDED
  9366             MOVE  ER-1922         TO  WS-ERROR
  9367             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9368             GO TO 0314-A-H-BENEFIT-FOUND.
  9369
  9370     IF NOT AH-PLAN-MASTER-FOUND
  9371        GO TO 0314-A-H-BENEFIT-FOUND.
  9372
  9373 XXXX-CHECK-AH-PLAN-KEY.
  9374
  9375     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9376        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9377        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9378        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9379        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9380        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9381        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9382        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9383        MOVE 'N'                 TO PLAN-MASTER-SW
  9384          GO TO 03XX-ERPLAN-AH-READ.
  9385
  9386     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9387
  9388     IF  PB-CANCELLATION
  9389         GO TO  0313-AH-ACCT-BEN-FOUND.
  9390
  9391     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9392       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9393          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9394          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9395             MOVE ER-2644             TO WS-ERROR
  9396             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9397          ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 172
* EL050.cbl
  9398             NEXT SENTENCE
  9399       ELSE
  9400          IF PB-COMPANY-ID NOT = 'NCL'
  9401             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9402                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9403
  9404 0313-AH-ACCT-BEN-FOUND.
  9405
  9406     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9407
  9408     IF PL-DEV-CODE NOT = SPACES
  9409        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9410
  9411     IF PL-DEV-PCT NUMERIC AND
  9412        PL-DEV-PCT NOT = ZEROS
  9413        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9414
  9415     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9416        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9417
  9418     IF PL-TOL-REF-AMT NOT EQUAL +0
  9419        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9420
  9421     IF PL-TOL-PREM-PCT GREATER THAN +0
  9422        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9423
  9424     IF PL-TOL-REF-PCT GREATER THAN +0
  9425        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9426
  9427     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9428        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9429
  9430     IF PL-OVER-SHORT-AMT NUMERIC AND
  9431                          PL-OVER-SHORT-AMT > +0
  9432        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9433
  9434     IF PL-OVER-SHORT-PCT NUMERIC AND
  9435                          PL-OVER-SHORT-PCT > +0
  9436        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9437
  9438     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9439        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9440        IF WS-IG-OVRD-AM EQUAL SPACES
  9441            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9442
  9443 0314-A-H-BENEFIT-FOUND.
  9444
  9445     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9446
  9447     IF PB-ISSUE
  9448        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9449       ELSE
  9450        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9451
  9452     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9453     if cf-maximum-benefits (sub3) numeric
  9454        move cf-maximum-benefits (sub3)
  9455                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 173
* EL050.cbl
  9456     else
  9457        move zeros               to ws-ah-max-bens
  9458     end-if
  9459     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9460     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9461     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9462                                         WS-AH-REFUND-CALC.
  9463
  9464     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9465        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9466
  9467     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9468        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9469     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9470
  9471     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9472     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9473     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9474     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9475     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9476     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9477
  9478     IF PB-COMPANY-ID = 'NCL'  AND
  9479        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9480         NEXT SENTENCE
  9481     ELSE
  9482         IF SUB5 NOT GREATER THAN +20
  9483            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9484                MOVE WS-SAVE-BENEFIT-REM-TERM
  9485                                      TO WS-AM-AH-BENE-REM-TERM
  9486                                         EC-BR-AH-REM-TERM-CALC.
  9487
  9488     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9489     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9490
  9491     GO TO 0400-FIND-CARRIER.
  9492
  9493 0399-BENEFIT-NOT-FOUND.
  9494
  9495     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9496     MOVE ER-2605                TO WS-ERROR.
  9497     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9498
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 174
* EL050.cbl
  9500
  9501 0400-FIND-CARRIER.
  9502
  9503     MOVE PB-SV-CARRIER          TO WS-CARR.
  9504
  9505     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9506     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9507     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9508     MOVE '6'                    TO CNTL-REC-TYPE.
  9509
  9510*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9511     MOVE SPACE                  TO WS-DMD-RATING-SW
  9512                                    EC-BR-DMD-RATING-SW.
  9513
  9514     MOVE '2'                    TO RC-SW-1.
  9515     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9516
  9517     IF NOT CF-CARRIER-MASTER
  9518        GO TO 0400-CARRIER-NOT-FOUND.
  9519
  9520 0400-BUILD-CARR-TOL.
  9521
  9522     IF CF-CR-TOL-PREM NUMERIC AND
  9523        CF-CR-TOL-PREM GREATER THAN +0
  9524        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9525                                    WS-TOL-AH-PREM.
  9526
  9527     IF CF-CR-TOL-REFUND NUMERIC AND
  9528        CF-CR-TOL-REFUND GREATER THAN +0
  9529        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9530                                    WS-TOL-AH-REFUND.
  9531
  9532     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9533        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9534        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9535                                    WS-AH-REFUND-OVS-AMT.
  9536
  9537     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9538        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9539        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9540                                    WS-AH-REFUND-OVS-PCT.
  9541
  9542     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9543        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9544        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9545                                    WS-TOL-AH-PREM-PCT.
  9546
  9547     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9548        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9549        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9550                                     WS-TOL-AH-REFUND-PCT.
  9551
  9552     IF CF-COMPANY-ID EQUAL 'DMD'
  9553         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9554                                    EC-BR-DMD-RATING-SW.
  9555
  9556     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9557     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 175
* EL050.cbl
  9558        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9559     END-IF
  9560     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9561        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9562     END-IF
  9563     IF WS-TOL-CLP-PCT = ZEROS
  9564        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9565     END-IF
  9566
  9567     IF WS-SPP-LEASE-COMM = ZEROS
  9568        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9569     END-IF
  9570     GO TO 0400-FIND-ERPDEF.
  9571
  9572 0400-CARRIER-NOT-FOUND.
  9573
  9574     MOVE ER-2602                TO WS-ERROR.
  9575     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9576
  9577 0400-FIND-ERPDEF.
  9578*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9579     IF (PB-COMPANY-ID = 'DCC')
  9580        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9581        CONTINUE
  9582     ELSE
  9583        GO TO 0400-FIND-ERCOMP
  9584     END-IF
  9585     MOVE ' '                    TO PDEF-MASTER-SW
  9586     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9587     MOVE PB-STATE               TO ERPDEF-STATE
  9588     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9589        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9590     END-IF
  9591     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9592     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9593     IF PB-ISSUE
  9594        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9595     ELSE
  9596        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9597     END-IF
  9598     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9599     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9600     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9601     IF PDEF-MASTER-FOUND
  9602        MOVE 'N'                 TO PDEF-MASTER-SW
  9603        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9604        IF PDEF-MASTER-FOUND
  9605           IF (ERPDEF-KEY-SAVE (1:16) =
  9606                        PD-CONTROL-PRIMARY (1:16))
  9607              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9608              CONTINUE
  9609           ELSE
  9610              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9611              IF (ERPDEF-KEY-SAVE (1:16) =
  9612                        PD-CONTROL-PRIMARY (1:16))
  9613                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9614                 CONTINUE
  9615              ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 176
* EL050.cbl
  9616                 MOVE 'N'        TO PDEF-MASTER-SW
  9617              END-IF
  9618           END-IF
  9619        END-IF
  9620        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9621     END-IF
  9622     IF PDEF-MASTER-FOUND
  9623        IF PD-TRUNCATED = 'Y'
  9624           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9625        END-IF
  9626     END-IF
  9627     .
  9628 0400-FIND-ERCOMP.
  9629     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9630        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9631           (WS-SUB1 > +10)
  9632           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9633                 OR 'A' OR 'N'
  9634              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9635              MOVE PB-CARRIER    TO COMP-CARRIER
  9636              MOVE PB-GROUPING   TO COMP-GROUPING
  9637              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9638              MOVE AM-AGT (WS-SUB1)
  9639                                 TO COMP-FIN-RESP
  9640              MOVE 'G'           TO COMP-TYPE
  9641              PERFORM 8582-READ-COMPENSATION-MASTER
  9642                                 THRU 8582-EXIT
  9643              IF COMP-MASTER-FOUND
  9644                 IF CO-GA-INACTIVE
  9645                    MOVE ER-2763 TO WS-ERROR
  9646                    PERFORM 9900-ERROR-FORMAT
  9647                                 THRU 9900-EXIT
  9648                    MOVE +11     TO WS-SUB1
  9649                 END-IF
  9650                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9651                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9652                    MOVE ER-2788 TO WS-ERROR
  9653                    PERFORM 9900-ERROR-FORMAT
  9654                                 THRU 9900-EXIT
  9655                    MOVE +11     TO WS-SUB1
  9656                 END-IF
  9657              END-IF
  9658           END-IF
  9659        END-PERFORM
  9660     END-IF
  9661     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9662        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9663           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9664                                    WS-CLP-STATE
  9665        ELSE
  9666           MOVE SPACES           TO PB-I-CLP-STATE
  9667                                    WS-CLP-STATE
  9668        END-IF
  9669     END-IF
  9670
  9671     IF (PB-COMPANY-ID = 'DCC')
  9672        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9673        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 177
* EL050.cbl
  9674        CONTINUE
  9675     ELSE
  9676        GO TO 0400-FIND-STATE-RECORD
  9677     END-IF
  9678     MOVE SPACES                 TO WS-CLP-STATE
  9679     MOVE +0                     TO WS-BANK-FEE
  9680                                    WS-BANK-LFEE
  9681                                    WS-BANK-NOCHRGB
  9682
  9683     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9684     IF (PB-ISSUE)
  9685        AND (PB-I-BANK-NUMBER NOT =
  9686            SPACES AND ZEROS AND LOW-VALUES)
  9687        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9688     ELSE
  9689        IF (PB-CANCELLATION)
  9690           AND (PB-CI-BANK-NUMBER NOT =
  9691                SPACES AND ZEROS AND LOW-VALUES)
  9692           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9693        END-IF
  9694     END-IF
  9695     IF COMP-FIN-RESP NOT = LOW-VALUES
  9696        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9697        MOVE PB-CARRIER          TO COMP-CARRIER
  9698        MOVE PB-GROUPING         TO COMP-GROUPING
  9699        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9700        MOVE 'B'                 TO COMP-TYPE
  9701        PERFORM 8582-READ-COMPENSATION-MASTER
  9702                                 THRU 8582-EXIT
  9703        IF COMP-MASTER-FOUND
  9704           IF CO-MAX-BANK-FEE NOT NUMERIC
  9705              MOVE +0            TO CO-MAX-BANK-FEE
  9706           END-IF
  9707           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9708              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9709           END-IF
  9710           IF CO-GA-INACTIVE
  9711              MOVE ER-2763       TO WS-ERROR
  9712              PERFORM 9900-ERROR-FORMAT
  9713                                 THRU 9900-EXIT
  9714           END-IF
  9715           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9716              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9717              MOVE ER-2788 TO WS-ERROR
  9718              PERFORM 9900-ERROR-FORMAT
  9719                                 THRU 9900-EXIT
  9720              MOVE +11     TO WS-SUB1
  9721           END-IF
  9722           IF WS-AH-BEN-CATEGORY = 'G'
  9723              MOVE CO-MAX-BANK-FEE
  9724                                 TO WS-BANK-FEE
  9725                                    PB-I-BANK-FEE
  9726           ELSE
  9727              MOVE CO-MAX-BANK-FEE-LEASE
  9728                                 TO WS-BANK-LFEE
  9729                                    PB-I-BANK-FEE
  9730           END-IF
  9731           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 178
* EL050.cbl
  9732              AND (WS-AH-REFUND-CALC = 'G'))
  9733                        OR
  9734              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9735              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9736              CONTINUE
  9737           ELSE
  9738              MOVE ER-2789 TO WS-ERROR
  9739              PERFORM 9900-ERROR-FORMAT
  9740                                 THRU 9900-EXIT
  9741           END-IF
  9742           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9743                                    PB-I-CLP-STATE
  9744           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9745           MOVE CO-CARRIER       TO BXRF-CARRIER
  9746           MOVE CO-GROUPING      TO BXRF-GROUPING
  9747           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9748           MOVE BXRF-MAX-REC-LENGTH
  9749                                 TO BXRF-REC-LENGTH
  9750           PERFORM 8584-READ-BANK-CROSS-REF
  9751                                 THRU 8584-EXIT
  9752           IF BXRF-MASTER-FOUND
  9753              MOVE ' '           TO BANK-ACCT-SW
  9754              MOVE BK-BANK-POINTER-CNT
  9755                                 TO BK-BANK-POINTER-CNT
  9756              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9757                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9758                 OR (BANK-ACCT-FOUND)
  9759                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9760                    AND (BK-AM-EXP-DT (WS-SUB1)
  9761                                 > PB-CERT-EFF-DT)
  9762                    AND (BK-AM-EFF-DT (WS-SUB1)
  9763                                 NOT > PB-CERT-EFF-DT)
  9764                    SET BANK-ACCT-FOUND TO TRUE
  9765                 END-IF
  9766              END-PERFORM
  9767              IF NOT BANK-ACCT-FOUND
  9768                 MOVE ZEROS      TO WS-BANK-FEE
  9769                                    WS-BANK-LFEE
  9770                 MOVE ER-2869    TO WS-ERROR
  9771                 PERFORM 9900-ERROR-FORMAT
  9772                                 THRU 9900-EXIT
  9773              ELSE
  9774                 PERFORM 5000-PROCESS-REPS
  9775                                 THRU 5000-EXIT
  9776                 IF AGENT-MASTER-FOUND
  9777                    MOVE +0      TO WS-BANK-FEE
  9778                                    WS-BANK-LFEE
  9779*                   MOVE AG-SPP-FEES (1)
  9780*                                TO PB-I-BANK-FEE
  9781*                                   WS-BANK-FEE
  9782                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9783                       (WS-SUB1 > +10)
  9784                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9785                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9786                       END-IF
  9787                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9788                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9789                       END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 179
* EL050.cbl
  9790                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9791                          AG-SPP-FEES (WS-SUB1)
  9792                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9793                          AG-SPP-LFEES (WS-SUB1)
  9794                    END-PERFORM
  9795                    IF WS-AH-BEN-CATEGORY = 'G'
  9796                       MOVE WS-BANK-FEE
  9797                                 TO PB-I-BANK-FEE
  9798                    ELSE
  9799                       MOVE WS-BANK-LFEE
  9800                                 TO PB-I-BANK-FEE
  9801                    END-IF
  9802                 END-IF
  9803              END-IF
  9804           END-IF
  9805        ELSE
  9806           MOVE ER-2879          TO WS-ERROR
  9807           PERFORM 9900-ERROR-FORMAT
  9808                                 THRU 9900-EXIT
  9809        END-IF
  9810     ELSE
  9811        MOVE ER-2879             TO WS-ERROR
  9812        PERFORM 9900-ERROR-FORMAT
  9813                                 THRU 9900-EXIT
  9814     END-IF
  9815     IF WS-AH-BEN-CATEGORY = 'G'
  9816        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9817        + WS-BANK-FEE
  9818     ELSE
  9819        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9820        + WS-BANK-LFEE
  9821     END-IF
  9822     .
  9823 0400-FIND-STATE-RECORD.
  9824
  9825     IF WK-STATE-ADDR NOT = ZEROS
  9826         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9827         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9828         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9829         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9830         IF PB-SV-STATE = CF-STATE-CODE
  9831             GO TO 0405-CONTINUE-EDIT
  9832         ELSE
  9833             NEXT SENTENCE
  9834     ELSE
  9835         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9836
  9837     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9838     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9839     MOVE '3'                    TO CNTL-REC-TYPE.
  9840     MOVE +0                     TO CNTL-SEQ-NO.
  9841
  9842     MOVE '3'                    TO RC-SW-2.
  9843     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9844
  9845     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9846        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9847        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 180
* EL050.cbl
  9848        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9849                                    WS-TOL-AH-CLAIM
  9850                                    WS-MINIMUM-REFUND
  9851                                    WS-TOL-LF-PREM
  9852                                    WS-TOL-AH-PREM
  9853                                    WS-TOL-LF-REFUND
  9854                                    WS-TOL-AH-REFUND
  9855                                    EC-ST-TOL-PREM-PCT
  9856                                    WS-TOL-LF-PREM-PCT
  9857                                    WS-TOL-AH-PREM-PCT
  9858                                    EC-ST-TOL-REFUND-PCT
  9859                                    WS-TOL-LF-REFUND-PCT
  9860                                    WS-TOL-AH-REFUND-PCT
  9861                                    EC-ST-TOL-PREM
  9862                                    EC-ST-TOL-REFUND
  9863                                    EC-ST-FST-PMT-DAYS-MAX
  9864                                    WS-FREE-LOOK-PERIOD
  9865                                    WS-ST-LF-PREM-TAX
  9866                                    WS-ST-AH-PREM-TAX-I
  9867                                    WS-ST-AH-PREM-TAX-G
  9868                                    WS-BANK-FEE
  9869                                    WS-BANK-LFEE
  9870                                    WS-TOL-CLP-PCT
  9871                                    WS-SPP-LEASE-COMM
  9872                                    WS-INT-PERIODS
  9873                                    WS-EXTRA-PMTS
  9874        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9875                                    EC-ST-FST-PMT-DAYS-CHG
  9876                                    WS-LF-REM-TERM-CALC
  9877                                    WS-LF-REFUND-CALC
  9878                                    EC-ST-LF-REM-TERM-CALC
  9879                                    EC-ST-LF-REFUND-CALC
  9880                                    WS-AH-REM-TERM-CALC
  9881                                    WS-AH-REFUND-CALC
  9882                                    WS-LF-BEN-CATEGORY
  9883                                    WS-AH-BEN-CATEGORY
  9884                                    WS-CLP-STATE
  9885                                    WS-ST-REFUND-CLAIM-FLAG
  9886                                    WS-ST-CAUSAL-STATE
  9887                                    ws-st-agent-sig-edit
  9888                                    EC-ST-AH-REM-TERM-CALC
  9889                                    EC-ST-AH-REFUND-CALC
  9890          GO TO 0499-STATE-NOT-FOUND.
  9891
  9892     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9893
  9894 0405-CONTINUE-EDIT.
  9895     IF PB-COMPANY-ID <> 'AHL'
  9896        MOVE +0                  TO SUB3
  9897        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9898        IF SUB3 > +0
  9899           MOVE ER-3270          TO WS-ERROR
  9900           PERFORM 9900-ERROR-FORMAT
  9901                                 THRU 9900-EXIT
  9902        else
  9903           IF PB-CERT-PRIME NOT NUMERIC
  9904              MOVE ER-2722       TO WS-ERROR
  9905              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 181
* EL050.cbl
  9906                                 THRU 9900-EXIT
  9907           end-if
  9908        END-IF
  9909     END-IF
  9910     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9911
  9912     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9913        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9914                                    WS-TOL-AH-CLAIM.
  9915
  9916     IF CF-ST-REFUND-MIN NOT NUMERIC
  9917        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9918
  9919     IF CF-ST-REFUND-MIN NOT = ZEROS
  9920        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9921
  9922     IF CF-ST-TOL-PREM  NOT = ZEROS
  9923        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9924                                    WS-TOL-AH-PREM
  9925        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9926
  9927     IF CF-ST-TOL-REFUND NOT = ZEROS
  9928        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9929                                    WS-TOL-AH-REFUND
  9930        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9931
  9932     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9933        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9934        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9935                                    WS-AH-REFUND-OVS-AMT
  9936                                    EC-ST-OVR-SHT-AMT.
  9937
  9938     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9939        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9940        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9941                                    WS-TOL-LF-PREM-PCT
  9942                                    WS-TOL-AH-PREM-PCT.
  9943
  9944     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9945        CF-ST-TOL-REF-PCT GREATER THAN +0
  9946        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9947                                    WS-TOL-LF-REFUND-PCT
  9948                                    WS-TOL-AH-REFUND-PCT.
  9949
  9950     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9951        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9952        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9953                                    WS-AH-REFUND-OVS-PCT
  9954                                    EC-ST-OVR-SHT-PCT.
  9955
  9956     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9957     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9958
  9959     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9960          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9961
  9962     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9963     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 182
* EL050.cbl
  9964     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9965
  9966     IF CF-ST-LF-PREM-TAX NUMERIC
  9967        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9968     END-IF
  9969     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9970        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9971     END-IF
  9972     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9973        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9974     END-IF
  9975
  9976     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9977         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9978     END-IF.
  9979
  9980     IF CF-ST-CAUSAL-STATE > SPACES
  9981         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9982     END-IF.
  9983     if cf-st-extra-interest-periods not numeric
  9984        move zeros               to cf-st-extra-interest-periods
  9985     end-if
  9986     if cf-st-extra-payments not numeric
  9987        move zeros               to cf-st-extra-payments
  9988     end-if
  9989
  9990     move cf-st-extra-interest-periods
  9991                                 to ws-int-periods
  9992     move cf-st-extra-payments   to ws-extra-pmts
  9993     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9994     move cf-st-net-only-state   to ws-net-only-state
  9995     if cf-st-comm-cap-sl not numeric
  9996        move zeros               to cf-st-comm-cap-sl
  9997     end-if
  9998     if cf-st-comm-cap-jl not numeric
  9999        move zeros               to cf-st-comm-cap-jl
 10000     end-if
 10001     if cf-st-comm-cap-sa not numeric
 10002        move zeros               to cf-st-comm-cap-sa
 10003     end-if
 10004     if cf-st-comm-cap-ja not numeric
 10005        move zeros               to cf-st-comm-cap-ja
 10006     end-if
 10007     if cf-st-ga-comm-cap-sl not numeric
 10008        move zeros               to cf-st-ga-comm-cap-sl
 10009     end-if
 10010     if cf-st-ga-comm-cap-jl not numeric
 10011        move zeros               to cf-st-ga-comm-cap-jl
 10012     end-if
 10013     if cf-st-ga-comm-cap-sa not numeric
 10014        move zeros               to cf-st-ga-comm-cap-sa
 10015     end-if
 10016     if cf-st-ga-comm-cap-ja not numeric
 10017        move zeros               to cf-st-ga-comm-cap-ja
 10018     end-if
 10019
 10020     if cf-st-tot-comm-cap-sl not numeric
 10021        move zeros               to cf-st-tot-comm-cap-sl
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 183
* EL050.cbl
 10022     end-if
 10023     if cf-st-tot-comm-cap-jl not numeric
 10024        move zeros               to cf-st-tot-comm-cap-jl
 10025     end-if
 10026     if cf-st-tot-comm-cap-sa not numeric
 10027        move zeros               to cf-st-tot-comm-cap-sa
 10028     end-if
 10029     if cf-st-tot-comm-cap-ja not numeric
 10030        move zeros               to cf-st-tot-comm-cap-ja
 10031     end-if
 10032
 10033     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10034     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10035     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10036     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10037     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10038     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10039     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10040     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10041     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10042     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10043     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10044     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10045     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10046     IF WS-LF-BENEFIT-CD = ZEROS
 10047        GO TO 0410-CHECK-AH.
 10048
 10049     IF CF-ST-RT-CALC NOT = SPACES
 10050        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10051                                    EC-ST-LF-REM-TERM-CALC
 10052     END-IF
 10053
 10054     IF WS-LF-COVERAGE-TYPE = 'R'
 10055        IF WS-LF-EARNINGS-CALC = '5'
 10056           IF CF-ST-RF-LN-CALC > '0'
 10057              MOVE CF-ST-RF-LN-CALC
 10058                                 TO WS-LF-REFUND-CALC
 10059                                    EC-ST-LF-REFUND-CALC
 10060           END-IF
 10061        ELSE
 10062           IF CF-ST-RF-LR-CALC > '0'
 10063              MOVE CF-ST-RF-LR-CALC
 10064                                 TO WS-LF-REFUND-CALC
 10065                                    EC-ST-LF-REFUND-CALC
 10066           END-IF
 10067        END-IF
 10068     ELSE
 10069        IF CF-ST-RF-LL-CALC > '0'
 10070           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10071                                    EC-ST-LF-REFUND-CALC
 10072        END-IF
 10073     END-IF
 10074
 10075     IF CF-ST-RT-CALC NOT = SPACES
 10076        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10077                                    EC-ST-LF-REM-TERM-CALC
 10078     END-IF
 10079
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 184
* EL050.cbl
 10080     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10081     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10082
 10083     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10084
 10085     IF NO-BENEFIT-FOUND
 10086        GO TO 0410-CHECK-AH.
 10087
 10088     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10089        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10090                                 TO EC-ST-LF-REM-TERM-CALC
 10091                                    WS-LF-REM-TERM-CALC
 10092     END-IF
 10093
 10094     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10095        MOVE CF-ST-REFUND-CALC (SUB3)
 10096                                 TO WS-LF-REFUND-CALC
 10097                                    EC-ST-LF-REFUND-CALC
 10098     END-IF
 10099*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10100     if cf-st-extra-periods (sub3) not numeric
 10101        move zeros               to cf-st-extra-periods (sub3)
 10102     end-if
 10103     if cf-st-extra-periods (sub3) > zeros
 10104        if ws-lf-ben-category = 'P'
 10105           move cf-st-extra-periods (sub3)
 10106                                 to ws-extra-pmts
 10107        else
 10108           if ws-lf-ben-category = 'I'
 10109              move cf-st-extra-periods (sub3)
 10110                                 to ws-int-periods
 10111           end-if
 10112        end-if
 10113     end-if
 10114     .
 10115 0410-CHECK-AH.
 10116
 10117     IF WS-AH-BENEFIT-CD = ZEROS
 10118        GO TO 0500-SET-ACCOUNT.
 10119
 10120     IF CF-ST-RT-CALC NOT = SPACES
 10121        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10122                                    EC-ST-AH-REM-TERM-CALC
 10123     END-IF
 10124
 10125     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10126        IF CF-ST-RF-CP-CALC > '0'
 10127           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10128                                    EC-ST-AH-REFUND-CALC
 10129        END-IF
 10130     ELSE
 10131        IF CF-ST-RF-AH-CALC > '0'
 10132           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10133                                    EC-ST-AH-REFUND-CALC
 10134        END-IF
 10135     END-IF
 10136     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10137     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 185
* EL050.cbl
 10138
 10139     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10140
 10141     IF NO-BENEFIT-FOUND
 10142        GO TO 0500-SET-ACCOUNT.
 10143
 10144     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10145        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10146                                 TO WS-AH-REM-TERM-CALC
 10147                                    EC-ST-AH-REM-TERM-CALC
 10148     END-IF
 10149
 10150     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10151        MOVE CF-ST-REFUND-CALC (SUB3)
 10152                                 TO WS-AH-REFUND-CALC
 10153                                    EC-ST-AH-REFUND-CALC
 10154     END-IF
 10155
 10156*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10157
 10158     GO TO 0500-SET-ACCOUNT.
 10159
 10160 0499-STATE-NOT-FOUND.
 10161
 10162     MOVE ER-2603                TO WS-ERROR.
 10163     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10164
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 186
* EL050.cbl
 10166
 10167 0500-SET-ACCOUNT.
 10168*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10169     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10170        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10171        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10172        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10173        MOVE '3'                 TO CNTL-REC-TYPE
 10174        MOVE +0                  TO CNTL-SEQ-NO
 10175
 10176        MOVE '3'                 TO RC-SW-2
 10177        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10178
 10179        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10180           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10181           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10182           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10183                                    WS-ST-AH-PREM-TAX-I
 10184                                    WS-ST-AH-PREM-TAX-G
 10185        ELSE
 10186           IF CF-ST-LF-PREM-TAX NUMERIC
 10187              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10188           END-IF
 10189           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10190              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10191           END-IF
 10192           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10193              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10194           END-IF
 10195        END-IF
 10196        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10197     END-IF
 10198*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10199*  FOR DCC ONLY
 10200     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10201
 10202        MOVE ' '                 TO STAT-MASTER-SW
 10203        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10204        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10205        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10206        MOVE PB-STATE            TO ELSTAT-STATE
 10207        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10208           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10209        END-IF
 10210
 10211        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10212        SET BIN-TO-GREG          TO TRUE
 10213        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10214        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10215        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10216
 10217        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10218        IF STAT-MASTER-FOUND
 10219           MOVE 'N'              TO STAT-MASTER-SW
 10220           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10221           IF STAT-MASTER-FOUND
 10222              IF (ELSTAT-KEY-SAVE (1:12) =
 10223                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 187
* EL050.cbl
 10224                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10225                    MOVE 'F'        TO STAT-MASTER-SW
 10226                 ELSE
 10227                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10228                    IF (STAT-MASTER-FOUND)
 10229                       AND (ELSTAT-KEY-SAVE (1:12) =
 10230                           SF-CONTROL-PRIMARY (1:12))
 10231                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10232                       MOVE 'F'     TO STAT-MASTER-SW
 10233                    END-IF
 10234                 END-IF
 10235              END-IF
 10236           END-IF
 10237        END-IF
 10238
 10239        IF STAT-MASTER-SW = 'F'
 10240           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10241              and (sf-st-lf-prem-tax > zeros)
 10242              MOVE SF-ST-LF-PREM-TAX
 10243                                 TO WS-ST-LF-PREM-TAX
 10244           END-IF
 10245           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10246              and (sf-st-ah-prem-tax-i > zeros)
 10247              MOVE SF-ST-AH-PREM-TAX-I
 10248                                 TO WS-ST-AH-PREM-TAX-I
 10249           END-IF
 10250           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10251              and (sf-st-ah-prem-tax-g > zeros)
 10252              MOVE SF-ST-AH-PREM-TAX-G
 10253                                 TO WS-ST-AH-PREM-TAX-G
 10254           END-IF
 10255        END-IF
 10256     END-IF
 10257     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10258        AND (PB-ISSUE)
 10259        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10260        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10261        AND (AM-GPCD = 06)
 10262        MOVE 'Y'                 TO WS-GOOD-HIN
 10263        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10264           MOVE PB-I-VIN         TO WS-WORK-VIN
 10265           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10266              (V1 > 16)
 10267              IF WS-WORK-VIN (V1:1) NUMERIC
 10268                 MOVE WS-WORK-VIN-N (V1)
 10269                                 TO WS-ROW-B-VAL (V1)
 10270              ELSE
 10271                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10272                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10273                    OR (V2 > 26)
 10274                 END-PERFORM
 10275                 IF V2 < 27
 10276                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10277                 ELSE
 10278                    MOVE 'N'     TO WS-GOOD-HIN
 10279                 END-IF
 10280              END-IF
 10281              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 188
* EL050.cbl
 10282                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10283              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10284                 WS-ROW-D-VAL (V1)
 10285           END-PERFORM
 10286           MOVE ZEROS            TO WS-VIN-REMAINDER
 10287           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10288             REMAINDER WS-VIN-REMAINDER
 10289           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10290              CONTINUE
 10291           ELSE
 10292              MOVE 'N'           TO WS-GOOD-HIN
 10293           END-IF
 10294        ELSE
 10295           MOVE 'N'              TO WS-GOOD-HIN
 10296        END-IF
 10297        IF WS-GOOD-HIN NOT = 'Y'
 10298           MOVE ER-3826           TO WS-ERROR
 10299           PERFORM 9900-ERROR-FORMAT
 10300                                 THRU 9900-EXIT
 10301        END-IF
 10302     END-IF
 10303     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10304        AND (PB-ISSUE)
 10305        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10306        AND (AM-GPCD NOT = 06)
 10307        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10308           perform 3400-edit-vin thru 3400-exit
 10309        ELSE
 10310          MOVE ER-3826           TO WS-ERROR
 10311          PERFORM 9900-ERROR-FORMAT
 10312                                 THRU 9900-EXIT
 10313        END-IF
 10314     END-IF
 10315     if (pb-company-id = 'CID')
 10316        and (pb-issue)
 10317        and (pb-i-vin not = spaces and low-values and zeros)
 10318        perform 3400-edit-vin    thru 3400-exit
 10319     end-if
 10320******************************************************************
 10321******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10322******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10323******* METHODS.
 10324******************************************************************
 10325     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10326        IF PB-CANCELLATION
 10327           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10328              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10329                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10330                IF FORM-MASTER-FOUND
 10331                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10332******************************************************************
 10333
 10334     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10335     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10336
 10337     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10338     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10339     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 189
* EL050.cbl
 10340     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10341
 10342
 10343     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10344     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10345     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10346
 10347     IF AM-LF-OB-RATE NOT NUMERIC
 10348         MOVE ZERO               TO AM-LF-OB-RATE.
 10349
 10350     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10351         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10352
 10353     IF AM-AH-OB-RATE NOT NUMERIC
 10354         MOVE ZERO               TO AM-AH-OB-RATE.
 10355
 10356     IF WS-LF-JOINT-INDICATOR = 'J'
 10357         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10358     ELSE
 10359         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10360
 10361     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10362
 10363     IF WS-IG-OVRD-AM  EQUAL SPACE
 10364         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10365
 10366     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10367         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10368                                       WS-IG-OVRD
 10369     ELSE
 10370         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10371             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10372                                       WS-IG-OVRD
 10373         ELSE
 10374             MOVE AM-IG             TO WS-IG-OVRD-AH
 10375                                       WS-IG-OVRD.
 10376
 10377     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10378         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10379                                       WS-IG-OVRD
 10380     ELSE
 10381         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10382             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10383                                       WS-IG-OVRD
 10384         ELSE
 10385             MOVE AM-IG             TO WS-IG-OVRD-LF
 10386                                       WS-IG-OVRD.
 10387
 10388     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10389     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10390     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10391     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10392*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10393     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10394                                              TO 'PRLDSFCTIA'.
 10395
 10396     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10397     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 190
* EL050.cbl
 10398     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10399     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10400
 10401     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10402     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10403     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10404     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10405     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10406     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10407     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10408
 10409     IF WS-ACCT-AH-DEV-PCT > +0
 10410        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10411     ELSE
 10412        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10413
 10414     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10415        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10416     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10417        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10418
 10419        IF AM-EARN-METHOD-L = 'S'
 10420            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10421                                        WS-LF-REFUND-CALC.
 10422
 10423        IF AM-EARN-METHOD-R = 'S'
 10424            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10425                                        WS-LF-REFUND-CALC.
 10426
 10427     IF WS-LF-COVERAGE-TYPE = 'R'
 10428         IF AM-EARN-METHOD-R = 'R'
 10429            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10430                                    WS-LF-REFUND-CALC.
 10431     IF WS-LF-COVERAGE-TYPE = 'R'
 10432         IF AM-EARN-METHOD-R = 'P'
 10433            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10434                                    WS-LF-REFUND-CALC.
 10435     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10436         IF AM-EARN-METHOD-L = 'R'
 10437            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10438                                    WS-LF-REFUND-CALC.
 10439     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10440         IF AM-EARN-METHOD-L = 'P'
 10441            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10442                                    WS-LF-REFUND-CALC.
 10443     IF WS-LF-COVERAGE-TYPE = 'R'
 10444         IF AM-EARN-METHOD-R = 'A'
 10445            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10446                                    WS-LF-REFUND-CALC.
 10447     IF WS-LF-COVERAGE-TYPE = 'R'
 10448         IF AM-EARN-METHOD-R = 'M'
 10449            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10450                                    WS-LF-REFUND-CALC.
 10451     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10452         IF AM-EARN-METHOD-L = 'A'
 10453            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10454                                    WS-LF-REFUND-CALC.
 10455     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 191
* EL050.cbl
 10456         IF AM-EARN-METHOD-L = 'M'
 10457            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10458                                    WS-LF-REFUND-CALC.
 10459
 10460     IF AM-EARN-METHOD-A = 'R'
 10461        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10462                                    WS-AH-REFUND-CALC.
 10463     IF AM-EARN-METHOD-A = 'P'
 10464        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10465                                    WS-AH-REFUND-CALC.
 10466     IF AM-EARN-METHOD-A = 'C'
 10467        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10468                                    WS-AH-REFUND-CALC.
 10469     IF AM-EARN-METHOD-A = 'A'
 10470        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10471                                    WS-AH-REFUND-CALC.
 10472     IF AM-EARN-METHOD-A = 'M'
 10473        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10474                                    WS-AH-REFUND-CALC.
 10475     IF AM-EARN-METHOD-A = 'N'
 10476        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10477                                    WS-AH-REFUND-CALC.
 10478     IF AM-EARN-METHOD-A = 'S'
 10479        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10480                                    WS-AH-REFUND-CALC.
 10481
 10482     IF AM-TOL-PREM NOT = ZEROS
 10483        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10484                                    WS-TOL-AH-PREM.
 10485
 10486     IF AM-OVR-SHT-AMT NUMERIC AND
 10487                  AM-OVR-SHT-AMT > 0
 10488        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10489                                    EC-AM-LF-OVR-SHT-AMT
 10490                                    WS-AH-REFUND-OVS-AMT
 10491                                    EC-AM-AH-OVR-SHT-AMT.
 10492
 10493     IF AM-OVR-SHT-PCT NUMERIC AND
 10494                    AM-OVR-SHT-PCT > 0
 10495        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10496                                    EC-AM-LF-OVR-SHT-PCT
 10497                                    WS-AH-REFUND-OVS-PCT
 10498                                    EC-AM-AH-OVR-SHT-PCT.
 10499
 10500     IF AM-TOL-REF-PCT NUMERIC AND
 10501                  AM-TOL-REF-PCT > 0
 10502        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10503                                    WS-TOL-AH-REFUND-PCT.
 10504
 10505     IF AM-TOL-REF  NOT = ZEROS  AND
 10506                  AM-TOL-REF NUMERIC
 10507        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10508                                    EC-AM-LF-TOL-REFUND
 10509                                    WS-TOL-AH-REFUND
 10510                                    EC-AM-AH-TOL-REFUND.
 10511
 10512     IF AM-TOL-CLM  NOT = ZEROS
 10513        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 192
* EL050.cbl
 10514                                    WS-TOL-AH-CLAIM.
 10515
 10516     IF AM-CLP-TOL-PCT NOT NUMERIC
 10517        MOVE +0                  TO AM-CLP-TOL-PCT
 10518     END-IF
 10519
 10520     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10521        MOVE +0                  TO AM-SPP-LEASE-COMM
 10522     END-IF
 10523     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10524        MOVE WS-PL-TOL-LF-PREM-PCT
 10525                                 TO WS-TOL-LF-PREM-PCT.
 10526
 10527     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10528        MOVE WS-PL-TOL-AH-PREM-PCT
 10529                                 TO WS-TOL-AH-PREM-PCT.
 10530
 10531     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10532        MOVE WS-PL-TOL-LF-REFUND-PCT
 10533                                 TO WS-TOL-LF-REFUND-PCT.
 10534
 10535     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10536        MOVE WS-PL-TOL-AH-REFUND-PCT
 10537                                 TO WS-TOL-AH-REFUND-PCT.
 10538
 10539     IF WS-PL-REF-OVS-AMT > +0
 10540        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10541
 10542     IF WS-PL-REF-OVS-PCT > +0
 10543        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10544
 10545     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10546        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10547     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10548        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10549     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10550        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10551     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10552        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10553     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10554        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10555     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10556        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10557
 10558     IF WS-AH-PL-REF-OVS-AMT > +0
 10559        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10560
 10561     IF WS-AH-PL-REF-OVS-PCT > +0
 10562        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10563
 10564     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10565     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10566
 10567     IF PB-CANCELLATION
 10568        GO TO 3000-CONTINUE-EDIT.
 10569
 10570     MOVE +1 TO SUB1.
 10571     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 193
* EL050.cbl
 10572     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10573
 10574     IF CF-COMPANY-ID = 'DMD'
 10575       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10576         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10577        ELSE
 10578         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10579
 10580  0525-FIND-ACCT-COMM.
 10581     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10582        NEXT SENTENCE
 10583      ELSE
 10584         ADD +1 TO SUB1
 10585         IF SUB1 LESS +11
 10586            GO TO 0525-FIND-ACCT-COMM
 10587          ELSE
 10588             GO TO 0550-st-comm-cap-check.
 10589
 10590     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10591     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10592                                    PB-I-LIFE-COMMISSION.
 10593***  IF PB-COMPANY-ID = 'CRI'
 10594     IF PB-PREM-ACCTNG-ONLY
 10595         GO TO 0550-st-comm-cap-check.
 10596
 10597     MOVE '0530' TO CTBL-SW.
 10598     MOVE ' '    TO WS-CTBL-READ-SW.
 10599
 10600
 10601 0530-GET-AH-COMP.
 10602     IF NO-AH-COVERAGE  OR
 10603        NO-AH-BENEFIT-MATCH
 10604           GO TO 0540-NEXT-READ-STEP.
 10605
 10606     IF AM-A-COM (SUB1) NUMERIC
 10607        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10608         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10609         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10610         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10611         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10612     ELSE
 10613          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10614          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10615          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10616          MOVE ZEROS             TO WS-SUB1
 10617                                    WS-COMMISSION
 10618          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10619          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10620          IF WS-COMMISSION > ZEROS
 10621             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10622             GO TO 0540-NEXT-READ-STEP
 10623          END-IF
 10624          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10625          IF CTBL-TABLE-FOUND
 10626             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10627                                        PB-I-AH-TERM
 10628             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10629             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 194
* EL050.cbl
 10630             GO TO 0540-NEXT-READ-STEP
 10631          ELSE
 10632             IF FIRST-TIME-THROUGH
 10633                 GO TO 0530-GET-AH-COMP
 10634             ELSE
 10635                 MOVE ER-2609                TO WS-ERROR
 10636                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10637
 10638 0540-NEXT-READ-STEP.
 10639     MOVE '0540' TO CTBL-SW.
 10640     MOVE ' '    TO WS-CTBL-READ-SW.
 10641
 10642 0540-GET-LF-COMP.
 10643     IF NO-LIFE-COVERAGE  OR
 10644        NO-LF-BENEFIT-MATCH
 10645           GO TO 0550-st-comm-cap-check.
 10646
 10647     IF WS-LF-JOINT-INDICATOR = 'J'
 10648        IF AM-J-COM (SUB1) NUMERIC
 10649           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10650           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10651           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10652           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10653           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10654        ELSE
 10655           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10656           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10657           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10658           MOVE ZEROS                TO WS-SUB1
 10659                                        WS-COMMISSION
 10660           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10661           IF WS-COMMISSION > ZEROS
 10662              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10663              GO TO 0550-st-comm-cap-check
 10664           END-IF
 10665           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10666           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10667           IF CTBL-TABLE-FOUND
 10668              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10669              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10670              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10671              GO TO 0550-st-comm-cap-check
 10672           ELSE
 10673              IF FIRST-TIME-THROUGH
 10674                  GO TO 0540-GET-LF-COMP
 10675              ELSE
 10676                  MOVE ER-2609                TO WS-ERROR
 10677                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10678                  GO TO 0550-st-comm-cap-check.
 10679
 10680     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10681        IF AM-L-COM (SUB1) NUMERIC
 10682           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10683           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10684           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10685           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10686           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10687        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 195
* EL050.cbl
 10688           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10689           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10690           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10691           MOVE ZEROS                TO WS-SUB1
 10692                                        WS-COMMISSION
 10693           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10694           IF WS-COMMISSION IS GREATER THAN ZEROS
 10695              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10696              GO TO 0550-st-comm-cap-check
 10697           END-IF
 10698           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10699           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10700           IF CTBL-TABLE-FOUND
 10701              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10702              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10703              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10704              GO TO 0550-st-comm-cap-check
 10705           ELSE
 10706              IF FIRST-TIME-THROUGH
 10707                  GO TO 0540-GET-LF-COMP
 10708              ELSE
 10709                  MOVE ER-2609                TO WS-ERROR
 10710                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10711
 10712 0550-st-comm-cap-check.
 10713
 10714     move +0                     to ws-tot-sl-wk-rate
 10715                                    ws-sl-wk-rate
 10716                                    ws-ga-sl-wk-rate
 10717                                    ws-tot-jl-wk-rate
 10718                                    ws-jl-wk-rate
 10719                                    ws-ga-jl-wk-rate
 10720                                    ws-tot-sa-wk-rate
 10721                                    ws-sa-wk-rate
 10722                                    ws-ga-sa-wk-rate
 10723                                    ws-tot-ja-wk-rate
 10724                                    ws-ja-wk-rate
 10725                                    ws-ga-ja-wk-rate
 10726     perform varying sub5 from +1 by +1 until
 10727        (sub5 > +10)
 10728        move +0                  to ws-wk-rate
 10729        if (am-gl-codes (sub5) <> 'Y')
 10730           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10731           if pb-i-lf-benefit-cd <> '  ' and '00'
 10732              move zeros         to ws-wk-rate
 10733              if (am-l-com (sub5) numeric)
 10734                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10735                 move am-l-com(sub5)
 10736                                 to ws-wk-rate
 10737              else
 10738                 move pb-company-cd to ctbl-company-cd
 10739                 move pb-i-lf-benefit-cd
 10740                                 to ctbl-ben-code
 10741                 move pb-i-lf-term  to ws-work-term
 10742                 move pb-life-override-l1
 10743                                 to ctbl-ben-type
 10744                 move zeros      to ws-sub1
 10745                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 196
* EL050.cbl
 10746                 move am-l-coma (sub5)
 10747                                 to ctbl-table
 10748                 move '0540'     to ctbl-sw
 10749                 perform 0552-get-it
 10750                                 thru 0552-exit
 10751              end-if
 10752              compute ws-tot-sl-wk-rate =
 10753                 ws-tot-sl-wk-rate + ws-wk-rate
 10754              if am-com-typ(sub5) = 'C' or 'D'
 10755                 compute ws-sl-wk-rate =
 10756                    ws-sl-wk-rate + ws-wk-rate
 10757              else
 10758                 if am-com-typ(sub5) = 'O' or 'P'
 10759                    compute ws-ga-sl-wk-rate =
 10760                       ws-ga-sl-wk-rate + ws-wk-rate
 10761                 end-if
 10762              end-if
 10763
 10764              move zeros         to ws-wk-rate
 10765              if (am-j-com (sub5) numeric)
 10766                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10767                 move am-j-com(sub5)
 10768                                 to ws-wk-rate
 10769              else
 10770                 move pb-company-cd to ctbl-company-cd
 10771                 move pb-i-lf-benefit-cd
 10772                                 to ctbl-ben-code
 10773                 move pb-i-lf-term  to ws-work-term
 10774                 move pb-life-override-l1
 10775                                 to ctbl-ben-type
 10776                 move zeros      to ws-sub1
 10777                                    ws-commission
 10778                 move am-j-coma (sub5)
 10779                                 to ctbl-table
 10780                 move '0540'     to ctbl-sw
 10781                 perform 0552-get-it
 10782                                 thru 0552-exit
 10783              end-if
 10784              compute ws-tot-jl-wk-rate =
 10785                 ws-tot-jl-wk-rate + ws-wk-rate
 10786              if am-com-typ(sub5) = 'C' or 'D'
 10787                 compute ws-jl-wk-rate =
 10788                    ws-jl-wk-rate + ws-wk-rate
 10789              else
 10790                 if am-com-typ(sub5) = 'O' or 'P'
 10791                    compute ws-ga-jl-wk-rate =
 10792                       ws-ga-jl-wk-rate + ws-wk-rate
 10793                 end-if
 10794              end-if
 10795           end-if
 10796           move zeros            to ws-wk-rate
 10797
 10798           if pb-i-ah-benefit-cd <> '  ' and '00'
 10799              if (am-a-com (sub5) numeric)
 10800                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10801                 move am-a-com(sub5)
 10802                                 to ws-wk-rate
 10803              else
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 197
* EL050.cbl
 10804                 move pb-company-cd to ctbl-company-cd
 10805                 move pb-i-ah-benefit-cd
 10806                                 to ctbl-ben-code
 10807                 move pb-i-ah-term  to ws-work-term
 10808                 move pb-ah-override-l1
 10809                                 to ctbl-ben-type
 10810                 move zeros      to ws-sub1
 10811                                    ws-commission
 10812                 move am-a-coma (sub5)
 10813                                 to ctbl-table
 10814                 move '0530'     to ctbl-sw
 10815                 perform 0552-get-it
 10816                                 thru 0552-exit
 10817              end-if
 10818              compute ws-tot-sa-wk-rate =
 10819                 ws-tot-sa-wk-rate + ws-wk-rate
 10820              if am-com-typ(sub5) = 'C' or 'D'
 10821                 compute ws-sa-wk-rate =
 10822                    ws-sa-wk-rate + ws-wk-rate
 10823              else
 10824                 if am-com-typ(sub5) = 'O' or 'P'
 10825                    compute ws-ga-sa-wk-rate =
 10826                       ws-ga-sa-wk-rate + ws-wk-rate
 10827                 end-if
 10828              end-if
 10829           end-if
 10830        end-if
 10831     end-perform
 10832
 10833     go to 0550-continue
 10834
 10835     .
 10836 0552-get-it.
 10837
 10838     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10839     MOVE ZEROS                  TO WS-SUB1
 10840                                    WS-COMMISSION
 10841     MOVE ' '                    TO WS-CTBL-READ-SW
 10842     PERFORM 8300-READ-CTBL-TABLE
 10843                                 THRU 8300-EXIT
 10844     IF FIRST-TIME-THROUGH
 10845        MOVE 'AA'                TO CTBL-BEN-CODE
 10846        PERFORM 8300-READ-CTBL-TABLE
 10847                                 THRU 8300-EXIT
 10848     END-IF
 10849     IF CTBL-TABLE-FOUND
 10850        if pb-life-override-l1 = ctbl-ben-type
 10851           move pb-i-lf-benefit-amt
 10852                                 to WS-COMM-CK-AMT
 10853        else
 10854           compute ws-comm-ck-amt =
 10855              pb-I-ah-benefit-amt * pb-i-ah-term
 10856        end-if
 10857        PERFORM 8800-GET-COMP-RATE
 10858                                 THRU 8800-EXIT
 10859     else
 10860        move zeros               to ws-wk-rate
 10861     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 198
* EL050.cbl
 10862
 10863     .
 10864 0552-exit.
 10865     exit.
 10866
 10867 0550-continue.
 10868
 10869     if ws-lf-joint-indicator = 'J'
 10870        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10871           and (ws-st-comm-cap-jl <> zeros)
 10872           MOVE ER-1956          TO WS-ERROR
 10873           PERFORM 9900-ERROR-FORMAT
 10874                                 THRU 9900-EXIT
 10875        end-if
 10876        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10877           and (ws-st-ga-comm-cap-jl <> zeros)
 10878           MOVE ER-1959          TO WS-ERROR
 10879           PERFORM 9900-ERROR-FORMAT
 10880                                 THRU 9900-EXIT
 10881        end-if
 10882        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10883           and (ws-st-tot-comm-cap-jl <> zeros)
 10884           MOVE ER-1962          TO WS-ERROR
 10885           PERFORM 9900-ERROR-FORMAT
 10886                                 THRU 9900-EXIT
 10887        end-if
 10888     else
 10889        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10890           and (ws-st-comm-cap-sl <> zeros)
 10891           MOVE ER-1955          TO WS-ERROR
 10892           PERFORM 9900-ERROR-FORMAT
 10893                                 THRU 9900-EXIT
 10894        end-if
 10895        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10896           and (ws-st-ga-comm-cap-sl <> zeros)
 10897           MOVE ER-1958          TO WS-ERROR
 10898           PERFORM 9900-ERROR-FORMAT
 10899                                 THRU 9900-EXIT
 10900        end-if
 10901        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10902           and (ws-st-tot-comm-cap-sl <> zeros)
 10903           MOVE ER-1961          TO WS-ERROR
 10904           PERFORM 9900-ERROR-FORMAT
 10905                                 THRU 9900-EXIT
 10906        end-if
 10907
 10908     if ws-ah-joint-indicator = 'J'
 10909        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10910           and (ws-st-comm-cap-ja <> zeros)
 10911           MOVE ER-1957          TO WS-ERROR
 10912           PERFORM 9900-ERROR-FORMAT
 10913                                 THRU 9900-EXIT
 10914        end-if
 10915        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10916           and (ws-st-ga-comm-cap-ja <> zeros)
 10917           MOVE ER-1960          TO WS-ERROR
 10918           PERFORM 9900-ERROR-FORMAT
 10919                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 199
* EL050.cbl
 10920        end-if
 10921        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10922           and (ws-st-tot-comm-cap-ja <> zeros)
 10923           MOVE ER-1963          TO WS-ERROR
 10924           PERFORM 9900-ERROR-FORMAT
 10925                                 THRU 9900-EXIT
 10926        end-if
 10927     else
 10928        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10929           and (ws-st-comm-cap-sa <> zeros)
 10930           MOVE ER-1957          TO WS-ERROR
 10931           PERFORM 9900-ERROR-FORMAT
 10932                                 THRU 9900-EXIT
 10933        end-if
 10934        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 10935           and (ws-st-ga-comm-cap-sa <> zeros)
 10936           MOVE ER-1960          TO WS-ERROR
 10937           PERFORM 9900-ERROR-FORMAT
 10938                                 THRU 9900-EXIT
 10939        end-if
 10940        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 10941           and (ws-st-tot-comm-cap-sa <> zeros)
 10942           MOVE ER-1963          TO WS-ERROR
 10943           PERFORM 9900-ERROR-FORMAT
 10944                                 THRU 9900-EXIT
 10945        end-if
 10946     end-if
 10947     .
 10948 0560-EDIT-CONTINUE.
 10949     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10950                                    WS-AH-PMF-COMM
 10951*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10952*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10953     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10954        (SUB1 > +10)
 10955        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10956           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10957           MOVE '0530'           TO CTBL-SW
 10958           MOVE ' '              TO WS-CTBL-READ-SW
 10959           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10960           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10961           MOVE '0540'           TO CTBL-SW
 10962           MOVE ' '              TO WS-CTBL-READ-SW
 10963           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10964        END-IF
 10965     END-PERFORM
 10966     GO TO 0564-EDIT-CONTINUE
 10967     .
 10968 0561-CHECK-AH.
 10969     IF (NO-AH-COVERAGE)
 10970        OR (NO-AH-BENEFIT-MATCH)
 10971        CONTINUE
 10972     ELSE
 10973        IF (AM-A-COM (SUB1) NUMERIC)
 10974           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10975           IF (AM-COM-TYP (SUB1) = 'A')
 10976              AND (WS-AH-PMF-COMM = ZEROS)
 10977              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 200
* EL050.cbl
 10978           END-IF
 10979           CONTINUE
 10980        ELSE
 10981           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10982           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10983           MOVE PB-AH-OVERRIDE-L1
 10984                                 TO CTBL-BEN-TYPE
 10985           MOVE ZEROS            TO WS-SUB1
 10986                                    WS-COMMISSION
 10987           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10988           PERFORM 8300-READ-CTBL-TABLE
 10989                                 THRU 8300-EXIT
 10990           IF CTBL-TABLE-FOUND
 10991              IF (AM-COM-TYP (SUB1) = 'A')
 10992                 AND (WS-AH-PMF-COMM = ZEROS)
 10993                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10994                                        PB-I-AH-TERM
 10995                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10996                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10997              END-IF
 10998              CONTINUE
 10999           ELSE
 11000              IF FIRST-TIME-THROUGH
 11001                 GO TO 0561-CHECK-AH
 11002              ELSE
 11003                 MOVE ER-2609    TO WS-ERROR
 11004                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11005              END-IF
 11006           END-IF
 11007        END-IF
 11008     END-IF
 11009     .
 11010 0561-EXIT.
 11011     EXIT.
 11012 0563-CHECK-LF.
 11013     IF (NO-LIFE-COVERAGE)
 11014        OR (NO-LF-BENEFIT-MATCH)
 11015        CONTINUE
 11016     ELSE
 11017        IF WS-LF-JOINT-INDICATOR = 'J'
 11018           IF AM-J-COM (SUB1) NUMERIC
 11019              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11020              IF (AM-COM-TYP (SUB1) = 'A')
 11021                 AND (WS-LF-PMF-COMM = ZEROS)
 11022                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11023              END-IF
 11024              CONTINUE
 11025           ELSE
 11026              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11027              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11028              MOVE PB-LIFE-OVERRIDE-L1
 11029                                 TO CTBL-BEN-TYPE
 11030              MOVE ZEROS         TO WS-SUB1
 11031                                    WS-COMMISSION
 11032              MOVE AM-J-COMA (SUB1)
 11033                                 TO CTBL-TABLE
 11034              PERFORM 8300-READ-CTBL-TABLE
 11035                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 201
* EL050.cbl
 11036              IF CTBL-TABLE-FOUND
 11037                 IF (AM-COM-TYP (SUB1) = 'A')
 11038                    AND (WS-LF-PMF-COMM = ZEROS)
 11039                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11040                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11041                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11042                 END-IF
 11043                 CONTINUE
 11044              ELSE
 11045                 IF FIRST-TIME-THROUGH
 11046                    GO TO 0563-CHECK-LF
 11047                 ELSE
 11048                    MOVE ER-2609 TO WS-ERROR
 11049                    PERFORM 9900-ERROR-FORMAT
 11050                                 THRU 9900-EXIT
 11051*                   GO TO 0560-EDIT-CONTINUE
 11052                 END-IF
 11053              END-IF
 11054           END-IF
 11055        ELSE
 11056           IF AM-L-COM (SUB1) NUMERIC
 11057              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11058              IF (AM-COM-TYP (SUB1) = 'A')
 11059                 AND (WS-LF-PMF-COMM = ZEROS)
 11060                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11061              END-IF
 11062              CONTINUE
 11063           ELSE
 11064              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11065              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11066              MOVE PB-LIFE-OVERRIDE-L1
 11067                                 TO CTBL-BEN-TYPE
 11068              MOVE ZEROS         TO WS-SUB1
 11069                                    WS-COMMISSION
 11070              MOVE AM-L-COMA (SUB1)
 11071                                 TO CTBL-TABLE
 11072              PERFORM 8300-READ-CTBL-TABLE
 11073                                 THRU 8300-EXIT
 11074              IF CTBL-TABLE-FOUND
 11075                 CONTINUE
 11076              ELSE
 11077                 IF FIRST-TIME-THROUGH
 11078                    GO TO 0563-CHECK-LF
 11079                 ELSE
 11080                    MOVE ER-2609 TO WS-ERROR
 11081                    PERFORM 9900-ERROR-FORMAT
 11082                                 THRU 9900-EXIT
 11083                 END-IF
 11084              END-IF
 11085           END-IF
 11086        END-IF
 11087     END-IF
 11088     .
 11089 0563-EXIT.
 11090     EXIT.
 11091 0564-EDIT-CONTINUE.
 11092
 11093     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 202
* EL050.cbl
 11094         IF PB-I-NUM-BILLED EQUAL ZEROS
 11095            MOVE ER-8148       TO WS-ERROR
 11096            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11097
 11098*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11099*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11100*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11101*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11102*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11103*         IF NO-CONVERSION-ERROR
 11104*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11105*         ELSE
 11106*             IF PB-COMPANY-ID EQUAL 'HAN'
 11107*                 MOVE ZEROS     TO PB-I-AGE.
 11108     IF PB-I-BIRTHDAY > LOW-VALUES
 11109        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11110        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11111        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11112        PERFORM 8500-DATE-CONVERT
 11113                                 THRU 8500-EXIT
 11114        IF NO-CONVERSION-ERROR
 11115           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11116           IF PB-I-AGE > ZEROS
 11117              IF WS-WORK-AGE NOT = PB-I-AGE
 11118                 MOVE ER-9501    TO WS-ERROR
 11119                 PERFORM 9900-ERROR-FORMAT
 11120                                 THRU 9900-EXIT
 11121              END-IF
 11122           ELSE
 11123              MOVE WS-WORK-AGE   TO PB-I-AGE
 11124           END-IF
 11125        END-IF
 11126     END-IF
 11127     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11128                                   WS-INS-AGE-SET
 11129     IF PB-I-AGE = ZEROS
 11130        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11131           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11132                                   WS-INS-AGE-SET
 11133           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11134
 11135     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11136                                   WS-AH-EDIT-AGE.
 11137
 11138     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11139        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11140        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11141        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11142        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11143        IF NO-CONVERSION-ERROR
 11144           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11145           IF PB-I-JOINT-AGE > 0
 11146              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11147                 MOVE ER-9503    TO WS-ERROR
 11148                 PERFORM 9900-ERROR-FORMAT
 11149                                 THRU 9900-EXIT
 11150              END-IF
 11151           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 203
* EL050.cbl
 11152              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11153           END-IF
 11154        ELSE
 11155           MOVE ZEROS            TO PB-I-JOINT-AGE
 11156        END-IF
 11157     END-IF
 11158     IF PB-I-JOINT-AGE NOT NUMERIC
 11159        MOVE ZERO               TO PB-I-JOINT-AGE.
 11160
 11161     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11162                                   WS-JNT-AGE-SET
 11163     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11164        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11165           (WS-AH-JOINT-INDICATOR = 'J')
 11166           IF PB-I-JOINT-AGE = ZEROS
 11167               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11168                                          WS-JNT-AGE-SET
 11169               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11170           END-IF
 11171        END-IF
 11172     END-IF
 11173
 11174     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11175     IF WS-LF-JOINT-INDICATOR = 'J'
 11176        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11177        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11178            IF  PB-I-JOINT-AGE = ZERO
 11179                MOVE ER-2686       TO WS-ERROR
 11180                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11181            ELSE
 11182                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11183                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11184                    IF PB-COMPANY-ID NOT = 'LBL'
 11185                        MOVE ER-2685    TO WS-ERROR
 11186                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11187
 11188     IF WS-AH-JOINT-INDICATOR = 'J'
 11189        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11190            IF  PB-I-JOINT-AGE = ZERO
 11191                MOVE ER-2686       TO WS-ERROR
 11192                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11193            ELSE
 11194                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11195                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11196                                           WS-EDIT-AGE
 11197                    IF PB-COMPANY-ID NOT = 'LBL'
 11198                        MOVE ER-2685    TO WS-ERROR
 11199                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11200
 11201******************************************************************
 11202*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11203******************************************************************
 11204
 11205     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11206        (WS-AH-SPECIAL-CALC-CD = 'O')
 11207        NEXT SENTENCE
 11208     ELSE
 11209        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 204
* EL050.cbl
 11210          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11211           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11212            WS-AH-JOINT-INDICATOR = 'J')  AND
 11213           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11214            MOVE ER-2627             TO WS-ERROR
 11215            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11216
 11217     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11218        (WS-AH-SPECIAL-CALC-CD = 'O')
 11219         NEXT SENTENCE
 11220     ELSE
 11221         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11222            WS-AH-JOINT-INDICATOR = 'J'
 11223             IF PB-I-JOINT-INSURED = SPACES
 11224                 IF PB-COMPANY-ID NOT = 'JAL'
 11225                     MOVE ER-2696    TO WS-ERROR
 11226                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11227
 11228     IF PB-COMPANY-ID NOT = 'BOA'
 11229        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11230           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11231           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11232               PB-I-JOINT-INSURED NOT = SPACES)
 11233                MOVE ER-2691         TO WS-ERROR
 11234                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11235
 11236     IF PB-COMPANY-ID = 'BOA'
 11237        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11238           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11239            IF PB-I-JOINT-AGE NOT = ZEROS
 11240                MOVE ER-2691         TO WS-ERROR
 11241                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11242
 11243     IF PB-COMPANY-ID = 'CRI'
 11244        IF PB-I-SIG-SW = 'J'
 11245           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11246              WS-AH-JOINT-INDICATOR NOT = 'J'
 11247              MOVE ER-2675       TO WS-ERROR
 11248              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11249
 11250     IF PB-COMPANY-ID = 'CRI'
 11251        IF PB-I-SIG-SW = 'S'
 11252           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11253              WS-AH-JOINT-INDICATOR = 'J'
 11254              MOVE ER-2676       TO WS-ERROR
 11255              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11256
 11257     IF PB-COMPANY-ID = 'CVL'
 11258         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11259            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11260              MOVE ER-2783           TO WS-ERROR
 11261              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11262     IF (WS-LF-JOINT-INDICATOR = 'J')
 11263        AND (WS-AH-JOINT-INDICATOR = 'J')
 11264        AND (PB-I-LF-TERM > 120)
 11265        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11266        MOVE ER-2783             TO WS-ERROR
 11267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 205
* EL050.cbl
 11268     END-IF
 11269     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11270
 11271     IF PB-I-INDV-GRP-OVRD = 'I'
 11272        MOVE ER-2666             TO WS-ERROR
 11273        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11274        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11275
 11276     IF PB-I-INDV-GRP-OVRD = 'G'
 11277        MOVE ER-2666             TO WS-ERROR
 11278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11279        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11280
 11281     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11282        NEXT SENTENCE
 11283     ELSE
 11284        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11285
 11286     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11287        IF WS-ERROR = ER-2666
 11288           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11289           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11290
 11291     IF PB-COMPANY-ID = 'CID'
 11292        IF PB-STATE = 'UT' OR 'MO'
 11293           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11294                 OR '76' OR '77')
 11295                      OR
 11296               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11297                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11298                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11299                   OR '2K' OR '2L'))
 11300              AND PB-I-INDV-GRP-CD = 'I'
 11301              MOVE ER-2721             TO WS-ERROR
 11302              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11303           END-IF
 11304        END-IF
 11305     END-IF
 11306
 11307     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11308     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11309        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11310     ELSE
 11311        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11312     END-IF
 11313
 11314*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11315*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11316     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11317                                    ACCOUNT-AH-CK-SW.
 11318
 11319     IF PB-REISSUED-CERT       OR
 11320        PB-REIN-ONLY-CERT      OR
 11321        PB-POLICY-IS-DECLINED  OR
 11322        PB-POLICY-IS-VOIDED
 11323*       OR PB-MONTHLY-CERT
 11324         GO TO 3000-CONTINUE-EDIT.
 11325
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 206
* EL050.cbl
 11326     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11327        IF WS-EDIT-AGE           > +65
 11328           MOVE ER-2709          TO WS-ERROR
 11329           PERFORM 9900-ERROR-FORMAT
 11330                                 THRU 9900-EXIT
 11331        ELSE
 11332           IF WS-EDIT-AGE        > +55
 11333              MOVE ER-2718       TO WS-ERROR
 11334              PERFORM 9900-ERROR-FORMAT
 11335                                 THRU 9900-EXIT
 11336           END-IF
 11337        END-IF
 11338     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11339        IF WS-EDIT-AGE           > +65
 11340           MOVE ER-2709          TO WS-ERROR
 11341           PERFORM 9900-ERROR-FORMAT
 11342                                 THRU 9900-EXIT
 11343        END-IF
 11344     END-IF
 11345     .
 11346
 11347 0565-LIFE-PLAN-LIMIT-EDITS.
 11348
 11349     IF NOT LF-PLAN-MASTER-FOUND
 11350        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11351                                    EC-AM-LF-MAX-TOT-BEN
 11352        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11353
 11354     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11355
 11356     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11357         IF PL-LM-AGE (1) = ZEROS
 11358             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11359
 11360     IF NO-LF-BENEFIT-MATCH          OR
 11361        WS-LF-BENEFIT-CD = ZEROS     OR
 11362        WS-LF-SPECIAL-CALC-CD = 'M'
 11363        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11364
 11365     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11366     MOVE +1                     TO SUB2.
 11367
 11368     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11369        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11370           MOVE +5   TO SUB2
 11371           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11372              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11373              (PL-LM-AGE (SUB2) EQUAL +0)
 11374              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11375              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11376
 11377     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11378
 11379     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11380                               + PB-I-LF-ALT-BENEFIT-AMT.
 11381
 11382 0568-CHECK-LIFE-ATT-AGE.
 11383
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 207
* EL050.cbl
 11384     IF PL-ATT-AGE NUMERIC AND
 11385        PL-ATT-AGE > +0
 11386        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11387     END-IF
 11388*    IF PL-ATT-AGE NUMERIC AND
 11389*       PL-ATT-AGE > +0
 11390*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11391*       IF PB-I-BIRTHDAY > LOW-VALUES
 11392*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11393*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11394*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11395*          SET BIN-PLUS-ELAPSED  TO TRUE
 11396*          PERFORM 8500-DATE-CONVERT
 11397*                                THRU 8500-EXIT
 11398*          IF NO-CONVERSION-ERROR
 11399*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11400*             MOVE ER-2669       TO WS-ERROR
 11401*             PERFORM 9900-ERROR-FORMAT
 11402*                                THRU 9900-EXIT
 11403*          END-IF
 11404*       ELSE
 11405*          IF WS-ATT-AGE >= PL-ATT-AGE
 11406*             MOVE ER-2669       TO WS-ERROR
 11407*             PERFORM 9900-ERROR-FORMAT
 11408*                                THRU 9900-EXIT
 11409*          END-IF
 11410*       END-IF
 11411*    END-IF
 11412     .
 11413 0570-CHECK-LIFE-LIMITS.
 11414
 11415     IF PB-COMPANY-ID EQUAL 'CRI'
 11416        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11417           IF SUB2 GREATER THAN +4
 11418              MOVE ER-2637 TO WS-ERROR
 11419              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11420              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11421
 11422     IF PB-COMPANY-ID  =  'NCL'
 11423        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11424            SUB2 GREATER THAN +8
 11425             MOVE 'U'         TO PB-BATCH-ENTRY
 11426             MOVE ER-2637     TO WS-ERROR
 11427             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11428             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11429
 11430     IF SUB2 > +8
 11431        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11432           AND (PB-I-SIG-SW = 'Y')
 11433           CONTINUE
 11434        ELSE
 11435           MOVE ER-2637          TO WS-ERROR
 11436           PERFORM 9900-ERROR-FORMAT
 11437                                 THRU 9900-EXIT
 11438        END-IF
 11439        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11440     END-IF
 11441     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 208
* EL050.cbl
 11442     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11443     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11444
 11445     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11446        ADD +1  TO SUB2
 11447        GO TO 0570-CHECK-LIFE-LIMITS.
 11448
 11449     IF PB-COMPANY-ID = 'NCL'
 11450         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11451
 11452     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11453        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11454        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11455           AND (PB-I-SIG-SW = 'Y')
 11456           CONTINUE
 11457        ELSE
 11458           MOVE ER-2637          TO WS-ERROR
 11459           PERFORM 9900-ERROR-FORMAT
 11460                                 THRU 9900-EXIT
 11461        END-IF
 11462     END-IF
 11463     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11464
 11465
 11466 0570-CHECK-NCL-LIFE-LIMITS.
 11467
 11468     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11469        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11470         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11471
 11472     IF APP-CERT-USED
 11473         IF SUB2  LESS THAN  +5
 11474             MOVE +5          TO SUB2
 11475             GO TO 0570-CHECK-LIFE-LIMITS.
 11476
 11477     MOVE ER-2637             TO WS-ERROR.
 11478     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11479
 11480     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11481
 11482 0575-CHECK-NCL-SIG-SWITCH.
 11483
 11484     IF NOT APP-CERT-USED
 11485         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11486
 11487     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11488        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11489        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11490        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11491         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11492
 11493     IF SUB2 GREATER THAN +4
 11494         IF PL-LM-AGE (5) = ZEROS  AND
 11495            PL-LM-AGE (6) = ZEROS  AND
 11496            PL-LM-AGE (7) = ZEROS  AND
 11497            PL-LM-AGE (8) = ZEROS
 11498             MOVE  ER-1927        TO WS-ERROR
 11499             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 209
* EL050.cbl
 11500             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11501         ELSE
 11502             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11503                 MOVE  ER-1920    TO WS-ERROR
 11504                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11505
 11506     IF PB-I-SIG-SW  = 'Y'
 11507       IF NOT PB-I-POLICY-ACCEPTED  AND
 11508          NOT PB-I-POLICY-DECLINED
 11509           MOVE 'U'               TO PB-BATCH-ENTRY
 11510           MOVE  ER-1926          TO WS-ERROR
 11511           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11512
 11513
 11514 0580-AH-PLAN-LIMIT-EDITS.
 11515
 11516     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11517        IF PB-I-AH-BENEFIT-AMT > +1250
 11518           MOVE ER-2702          TO WS-ERROR
 11519           PERFORM 9900-ERROR-FORMAT
 11520                                 THRU 9900-EXIT
 11521        END-IF
 11522     END-IF
 11523
 11524     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11525        AND (PB-MONTHLY-CERT)
 11526        IF PB-I-AH-BENEFIT-AMT > +3000
 11527           MOVE ER-2881          TO WS-ERROR
 11528           PERFORM 9900-ERROR-FORMAT
 11529                                 THRU 9900-EXIT
 11530        END-IF
 11531     END-IF
 11532     IF NOT AH-PLAN-MASTER-FOUND
 11533        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11534        GO TO 3000-CONTINUE-EDIT.
 11535
 11536     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11537
 11538     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11539         IF PL-LM-AGE (1) = ZEROS
 11540             GO TO 3000-CONTINUE-EDIT.
 11541
 11542     IF NO-AH-BENEFIT-MATCH          OR
 11543        WS-AH-BENEFIT-CD = ZEROS     OR
 11544        WS-AH-SPECIAL-CALC-CD = 'M'
 11545        GO TO 3000-CONTINUE-EDIT.
 11546
 11547     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11548     MOVE +1                     TO SUB2.
 11549
 11550     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11551        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11552           MOVE +5 TO SUB2
 11553           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11554              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11555              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11556              (PL-LM-AGE (SUB2) EQUAL +0)
 11557              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 210
* EL050.cbl
 11558              GO TO 3000-CONTINUE-EDIT.
 11559
 11560     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11561
 11562 0590-CHECK-AH-ATT-AGE.
 11563
 11564     IF PL-ATT-AGE NUMERIC AND
 11565        PL-ATT-AGE GREATER THAN +0
 11566        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11567     END-IF
 11568*       IF WS-ATT-AGE >= PL-ATT-AGE
 11569*          MOVE ER-3054          TO WS-ERROR
 11570*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11571     .
 11572 0597-CHECK-AH-LIMITS.
 11573
 11574     IF PB-COMPANY-ID EQUAL 'CRI'
 11575        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11576           IF SUB2 GREATER THAN +4
 11577              MOVE ER-2638       TO WS-ERROR
 11578              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11579              GO TO 3000-CONTINUE-EDIT.
 11580
 11581     IF PB-COMPANY-ID  =  'NCL'
 11582        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11583            SUB2 GREATER THAN +8
 11584             MOVE 'U'            TO PB-BATCH-ENTRY
 11585             MOVE ER-2638        TO WS-ERROR
 11586             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11587             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11588
 11589     IF SUB2 > +8
 11590        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11591           AND (PB-I-SIG-SW = 'Y')
 11592           CONTINUE
 11593        ELSE
 11594           MOVE ER-2638          TO WS-ERROR
 11595           PERFORM 9900-ERROR-FORMAT
 11596                                 THRU 9900-EXIT
 11597        END-IF
 11598        GO TO 3000-CONTINUE-EDIT
 11599     END-IF
 11600
 11601     IF PB-COMPANY-ID = 'CRI'
 11602        IF WS-ERROR = ER-2638
 11603           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11604
 11605     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11606     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11607     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11608     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11609
 11610     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11611        ADD +1                   TO SUB2
 11612        GO TO 0597-CHECK-AH-LIMITS.
 11613
 11614     IF PB-COMPANY-ID = 'NCL'
 11615         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 211
* EL050.cbl
 11616
 11617     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11618        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11619        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11620                                 > PL-LM-AMT (SUB2))
 11621        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11622           AND (PB-I-SIG-SW = 'Y')
 11623           CONTINUE
 11624        ELSE
 11625           MOVE ER-2638          TO WS-ERROR
 11626           PERFORM 9900-ERROR-FORMAT
 11627                                 THRU 9900-EXIT
 11628        END-IF
 11629     END-IF
 11630
 11631     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11632         IF  WS-ERROR    EQUAL    ER-2638
 11633             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11634                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11635                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11636                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11637                MOVE  ER-1910    TO  WS-ERROR
 11638                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11639
 11640     IF PB-COMPANY-ID = 'CRI'
 11641        IF WS-ERROR = ER-2638
 11642            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11643            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11644            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11645
 11646     GO TO 3000-CONTINUE-EDIT.
 11647
 11648 0597-CHECK-NCL-AH-LIMITS.
 11649
 11650     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11651        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11652        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11653                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11654         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11655
 11656     IF APP-CERT-USED
 11657         IF SUB2  LESS THAN  +5
 11658             MOVE +5             TO SUB2
 11659             GO TO 0597-CHECK-AH-LIMITS.
 11660
 11661     MOVE ER-2638                TO WS-ERROR.
 11662     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11663
 11664     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11665
 11666 0599-CHECK-NCL-SIG-SWITCH.
 11667
 11668     IF NOT APP-CERT-USED
 11669         GO TO 3000-CONTINUE-EDIT.
 11670
 11671     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11672        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11673        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 212
* EL050.cbl
 11674        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11675         GO TO 3000-CONTINUE-EDIT.
 11676
 11677     IF SUB2 GREATER THAN +4
 11678         IF PL-LM-AGE (5) = ZEROS  AND
 11679            PL-LM-AGE (6) = ZEROS  AND
 11680            PL-LM-AGE (7) = ZEROS  AND
 11681            PL-LM-AGE (8) = ZEROS
 11682             MOVE  ER-1927        TO WS-ERROR
 11683             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11684             GO TO 3000-CONTINUE-EDIT
 11685         ELSE
 11686             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11687                 MOVE  ER-1920    TO WS-ERROR
 11688                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11689
 11690     IF PB-I-SIG-SW  = 'Y'
 11691       IF NOT PB-I-POLICY-ACCEPTED  AND
 11692          NOT PB-I-POLICY-DECLINED
 11693           MOVE 'U'               TO PB-BATCH-ENTRY
 11694           MOVE  ER-1926          TO WS-ERROR
 11695           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11696
 11697******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 213
* EL050.cbl
 11699
 11700 3000-CONTINUE-EDIT.
 11701
 11702     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11703     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11704     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11705     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11706     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11707
 11708     IF BROWSE-STARTED
 11709        PERFORM 9990-RETURN THRU 9990-EXIT
 11710        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11711
 11712     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11713        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11714        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11715        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11716*       MOVE 1                   TO DC-OPTION-CODE
 11717        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11718        IF DATE-CONVERSION-ERROR
 11719           MOVE ER-2622          TO WS-ERROR
 11720           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11721        ELSE
 11722           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11723              MOVE ER-2623       TO WS-ERROR
 11724              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11725           ELSE
 11726              MOVE ER-2622       TO WS-ERROR
 11727              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11728
 11729     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11730     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11731     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11732*    MOVE 1                      TO DC-OPTION-CODE.
 11733     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11734     IF DATE-CONVERSION-ERROR
 11735        GO TO 3005-EDIT-CONTINUE
 11736     ELSE
 11737        IF DC-ELAPSED-DAYS GREATER +180
 11738           MOVE ER-2613          TO WS-ERROR
 11739           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11740        ELSE
 11741           IF DC-ELAPSED-DAYS GREATER +90
 11742              MOVE ER-2612       TO WS-ERROR
 11743              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11744           ELSE
 11745             IF DC-ELAPSED-DAYS GREATER +60
 11746                MOVE ER-2614     TO WS-ERROR
 11747                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11748
 11749 3005-EDIT-CONTINUE.
 11750
 11751     IF PB-CANCELLATION
 11752         GO TO 3700-EDIT-CANCEL.
 11753
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 214
* EL050.cbl
 11755******************************************************************
 11756*                  E D I T   I S S U E                           *
 11757******************************************************************
 11758
 11759 3020-EDIT-ISSUE.
 11760
 11761      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11762      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11763      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11764      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11765      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11766
 11767     IF PB-ISSUE-FORCE
 11768        OR PB-ISSUE-DATE-FORCED
 11769        OR PB-FORCE-OFF
 11770        OR PB-OVERCHARGE-FORCE
 11771        or pb-exceeded-limit-forced
 11772        CONTINUE
 11773     ELSE
 11774        MOVE ER-2670             TO WS-ERROR
 11775        PERFORM 9900-ERROR-FORMAT
 11776                                 THRU 9900-EXIT
 11777     END-IF
 11778     .
 11779 3022-SET-POLICY-STATUS.
 11780
 11781     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11782
 11783     IF (PB-REISSUED-CERT)
 11784             OR
 11785        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11786         AND (PB-MONTHLY-CERT))
 11787         MOVE '5'                TO PB-I-ENTRY-STATUS
 11788         MOVE 'E'                TO PB-BATCH-ENTRY
 11789     END-IF
 11790
 11791     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11792        IF PB-MONTHLY-CERT
 11793           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11794        END-IF
 11795        IF PB-CASH-CERT
 11796           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11797        END-IF
 11798     END-IF
 11799     IF PB-POLICY-IS-DECLINED
 11800         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11801     IF PB-POLICY-IS-VOIDED
 11802         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11803     IF PB-NEEDS-UNDERWRITING
 11804         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11805     IF PB-REIN-ONLY-CERT
 11806         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11807     IF PB-PREM-ACCTNG-ONLY
 11808         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11809
 11810     MOVE SPACE                  TO PB-I-OB-FLAG.
 11811
 11812     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 215
* EL050.cbl
 11813         MOVE ER-2665            TO WS-ERROR
 11814         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11815         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11816
 11817     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11818        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11819           MOVE 'Z'             TO PB-I-OB-FLAG.
 11820
 11821     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11822        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11823           MOVE 'Z'             TO PB-I-OB-FLAG.
 11824
 11825     IF ACCOUNT-MAST-FOUND
 11826         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11827         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11828         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11829         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11830         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11831         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11832         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11833     END-IF
 11834
 11835     IF ACCOUNT-MAST-FOUND
 11836        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11837         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11838
 11839     IF (ACCOUNT-MAST-FOUND)
 11840*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11841        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11842        IF PB-REISSUED-CERT
 11843           CONTINUE
 11844        ELSE
 11845           MOVE ER-2608          TO WS-ERROR
 11846           PERFORM 9900-ERROR-FORMAT
 11847                                 THRU 9900-EXIT
 11848         END-IF
 11849     END-IF
 11850
 11851     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11852        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11853        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11854
 11855**********   DMD CUSTOM CODE FOLLOWS  **********
 11856 3024-EDIT-DMD-FIELDS.
 11857     IF PB-COMPANY-ID NOT = 'DMD'
 11858        GO TO 3025-EDIT-REINSURANCE.
 11859
 11860*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11861*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11862*** ERROR IF THEY ARE NOT EQUAL.
 11863
 11864     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11865     SET BIN-TO-GREG               TO TRUE.
 11866     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11867     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11868**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11869
 11870     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 216
* EL050.cbl
 11871     SET BIN-TO-GREG               TO TRUE.
 11872     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11873     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11874**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11875
 11876     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11877        MOVE ER-8116               TO WS-ERROR
 11878        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11879
 11880     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11881
 11882     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11883                                      WK-FULL-CERT-NO.
 11884     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11885
 11886     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11887
 11888     IF PB-VALID-LIFE
 11889        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11890     ELSE
 11891        IF PB-VALID-AH
 11892          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11893
 11894
 11895     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11896     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11897     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11898                                      DCUA-UNDRWRTR-CODE
 11899                                      DCUA-UNDRWRTR-GROUP-CODE
 11900                                      DCUA-RETURN-CODE.
 11901
 11902****************************************************************
 11903*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11904***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11905***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11906***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11907***   TO THIS RECORD.                                        ***
 11908****************************************************************
 11909     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11910     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11911     IF DCUA-SUCCESSFUL-PROCESS
 11912        GO TO 3024-EDIT-DL7-CONT.
 11913
 11914     IF DCUA-RETURN-CODE EQUAL '01'
 11915        MOVE ER-8110               TO WS-ERROR
 11916        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11917        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11918        GO TO 3024-EDIT-DL7-CONT.
 11919
 11920     IF DCUA-RETURN-CODE EQUAL '02'
 11921        MOVE ER-8111               TO WS-ERROR
 11922        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11923        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11924        GO TO 3024-EDIT-DL7-CONT.
 11925
 11926     IF DCUA-RETURN-CODE EQUAL '03'
 11927        MOVE ER-8074               TO WS-ERROR
 11928        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 217
* EL050.cbl
 11929        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11930        GO TO 3024-EDIT-DL7-CONT.
 11931
 11932     IF DCUA-RETURN-CODE EQUAL '04'
 11933        MOVE ER-8075               TO WS-ERROR
 11934        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11935        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11936        GO TO 3024-EDIT-DL7-CONT.
 11937
 11938     IF DCUA-RETURN-CODE EQUAL '05'
 11939        MOVE ER-8076               TO WS-ERROR
 11940        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11941        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11942        GO TO 3024-EDIT-DL7-CONT.
 11943
 11944     IF DCUA-RETURN-CODE EQUAL '06'
 11945        MOVE ER-8077               TO WS-ERROR
 11946        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11947        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11948        GO TO 3024-EDIT-DL7-CONT.
 11949
 11950     IF DCUA-RETURN-CODE EQUAL '07'
 11951        MOVE ER-8078               TO WS-ERROR
 11952        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11953        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11954        GO TO 3024-EDIT-DL7-CONT.
 11955
 11956     IF DCUA-RETURN-CODE EQUAL 'E1'
 11957        MOVE ER-8079               TO WS-ERROR
 11958        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11959        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11960        GO TO 3024-EDIT-DL7-CONT.
 11961
 11962     IF DCUA-RETURN-CODE EQUAL 'E2'
 11963        MOVE ER-8080               TO WS-ERROR
 11964        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11965        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11966        GO TO 3024-EDIT-DL7-CONT.
 11967
 11968     IF DCUA-RETURN-CODE EQUAL 'E3'
 11969        MOVE ER-8098               TO WS-ERROR
 11970        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11971        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11972        GO TO 3024-EDIT-DL7-CONT.
 11973
 11974     IF DCUA-RETURN-CODE EQUAL 'C1'
 11975        MOVE ER-8099               TO WS-ERROR
 11976        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11977        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11978        GO TO 3024-EDIT-DL7-CONT.
 11979
 11980     IF DCUA-RETURN-CODE EQUAL 'U1'
 11981        MOVE ER-8109               TO WS-ERROR
 11982        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11983        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11984        GO TO 3024-EDIT-DL7-CONT.
 11985
 11986     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 218
* EL050.cbl
 11987        MOVE ER-8112               TO WS-ERROR
 11988        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11989        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11990        GO TO 3024-EDIT-DL7-CONT.
 11991
 11992     IF DCUA-RETURN-CODE EQUAL 'N2'
 11993        MOVE ER-8113               TO WS-ERROR
 11994        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11996        GO TO 3024-EDIT-DL7-CONT.
 11997
 11998     IF DCUA-RETURN-CODE EQUAL 'N3'
 11999        MOVE ER-8114               TO WS-ERROR
 12000        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12001        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12002        GO TO 3024-EDIT-DL7-CONT.
 12003
 12004     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12005     MOVE ER-8097                  TO WS-ERROR.
 12006     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12007     GO TO 3024-EDIT-DL7-CONT.
 12008
 12009 3024-EDIT-DL7-CONT.
 12010
 12011     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12012     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12013     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12014        NEXT SENTENCE
 12015     ELSE
 12016        MOVE ER-9263               TO WS-ERROR
 12017        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12018
 12019******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12020******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12021     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12022        NEXT SENTENCE
 12023     ELSE
 12024        MOVE ER-8039               TO WS-ERROR
 12025        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12026
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 219
* EL050.cbl
 12028****************************************************************
 12029*** VALIDATE STATE  : DLO022                                 ***
 12030****************************************************************
 12031     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12032     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12033
 12034     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12035     IF DVSC-SUCCESSFUL-EDIT
 12036        GO TO 3024-EDIT-DL22-CONT.
 12037
 12038     IF DVSC-RETURN-CODE EQUAL '01'
 12039        MOVE ER-8300               TO WS-ERROR
 12040        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12041        GO TO 3024-EDIT-DL22-CONT.
 12042
 12043     IF DVSC-RETURN-CODE EQUAL '02'
 12044        MOVE ER-8301               TO WS-ERROR
 12045        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12046        GO TO 3024-EDIT-DL22-CONT.
 12047
 12048     IF DVSC-RETURN-CODE EQUAL '03'
 12049        MOVE ER-8302               TO WS-ERROR
 12050        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12051        GO TO 3024-EDIT-DL22-CONT.
 12052
 12053     IF DVSC-RETURN-CODE EQUAL 'N1'
 12054        MOVE ER-8304               TO WS-ERROR
 12055        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12056        GO TO 3024-EDIT-DL22-CONT.
 12057
 12058     MOVE ER-8303                  TO WS-ERROR
 12059     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12060
 12061 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 220
* EL050.cbl
 12063****************************************************************
 12064*** VALIDATE LOAN OFFICER : DLO021                           ***
 12065****************************************************************
 12066
 12067     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12068     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12069     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12070     IF DVLO-SUCCESSFUL-EDIT
 12071        GO TO 3024-EDIT-DL21-CONT.
 12072
 12073     IF DVLO-RETURN-CODE EQUAL '01'
 12074        MOVE ER-8081               TO WS-ERROR
 12075        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12076        GO TO 3024-EDIT-DL21-CONT.
 12077
 12078     IF DVLO-RETURN-CODE EQUAL '02'
 12079        MOVE ER-8082               TO WS-ERROR
 12080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12081        GO TO 3024-EDIT-DL21-CONT.
 12082
 12083     IF DVLO-RETURN-CODE EQUAL '03'
 12084        MOVE ER-8083               TO WS-ERROR
 12085        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12086        GO TO 3024-EDIT-DL21-CONT.
 12087
 12088     IF DVLO-RETURN-CODE EQUAL '04'
 12089        MOVE ER-8084               TO WS-ERROR
 12090        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12091        GO TO 3024-EDIT-DL21-CONT.
 12092
 12093     IF DVLO-RETURN-CODE EQUAL '05'
 12094        MOVE ER-8085               TO WS-ERROR
 12095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12096        GO TO 3024-EDIT-DL21-CONT.
 12097
 12098     MOVE ER-7825                  TO WS-ERROR
 12099     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12100     GO TO 3024-EDIT-DL21-CONT.
 12101
 12102 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 221
* EL050.cbl
 12104
 12105****************************************************************
 12106*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12107****************************************************************
 12108
 12109     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12110     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12111     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12112     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12113     IF DIPF-SUCCESSFUL-EDIT
 12114        GO TO 3024-EDIT-DL02-CONT.
 12115
 12116     IF DIPF-RETURN-CODE EQUAL '01'
 12117        MOVE ER-8086               TO WS-ERROR
 12118        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12119        GO TO 3024-EDIT-DL02-CONT.
 12120
 12121     IF DIPF-RETURN-CODE EQUAL '02'
 12122        MOVE ER-8087               TO WS-ERROR
 12123        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12124        GO TO 3024-EDIT-DL02-CONT.
 12125
 12126     IF DIPF-RETURN-CODE EQUAL '03'
 12127        MOVE ER-8088               TO WS-ERROR
 12128        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12129        GO TO 3024-EDIT-DL02-CONT.
 12130
 12131     MOVE ER-8095                  TO WS-ERROR
 12132     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12133     GO TO 3024-EDIT-DL02-CONT.
 12134
 12135 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 222
* EL050.cbl
 12137
 12138****************************************************************
 12139*** VALIDATE BANK ID : DLO003                                ***
 12140****************************************************************
 12141
 12142     MOVE WK-GREG-CENT           TO WCG-CENT.
 12143     MOVE WK-GREG-YYMM           TO WCG-REST.
 12144     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12145        MOVE ER-8040               TO WS-ERROR
 12146        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12147
 12148     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12149     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12150     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12151     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12152     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12153     IF DVBI-SUCCESSFUL-EDIT
 12154        GO TO 3024-EDIT-DL03-CONT.
 12155
 12156     IF DVBI-RETURN-CODE EQUAL '01'
 12157        MOVE ER-8089               TO WS-ERROR
 12158        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12159        GO TO 3024-EDIT-DL03-CONT.
 12160
 12161     IF DVBI-RETURN-CODE EQUAL '02'
 12162        MOVE ER-8090               TO WS-ERROR
 12163        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12164        GO TO 3024-EDIT-DL03-CONT.
 12165
 12166     IF DVBI-RETURN-CODE EQUAL '03'
 12167        MOVE ER-8091               TO WS-ERROR
 12168        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12169        GO TO 3024-EDIT-DL03-CONT.
 12170
 12171     IF DVBI-RETURN-CODE EQUAL '04'
 12172        MOVE ER-8092               TO WS-ERROR
 12173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12174        GO TO 3024-EDIT-DL03-CONT.
 12175
 12176     IF DVBI-RETURN-CODE EQUAL '05'
 12177        MOVE ER-8093               TO WS-ERROR
 12178        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12179        GO TO 3024-EDIT-DL03-CONT.
 12180
 12181     IF DVBI-RETURN-CODE EQUAL '06'
 12182        MOVE ER-8094               TO WS-ERROR
 12183        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12184        GO TO 3024-EDIT-DL03-CONT.
 12185
 12186     MOVE ER-8096                  TO WS-ERROR
 12187     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12188     GO TO 3024-EDIT-DL03-CONT.
 12189
 12190 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 223
* EL050.cbl
 12192
 12193     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12194        NEXT SENTENCE
 12195     ELSE
 12196        MOVE ER-8042               TO WS-ERROR
 12197        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12198
 12199     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12200     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12201     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12202
 12203     IF DMPF-RETURN-CODE = '01'
 12204        MOVE ER-8067               TO WS-ERROR
 12205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12206        GO TO 3024-EDIT-DL01-CONT.
 12207
 12208     IF DMPF-RETURN-CODE = '02'
 12209        MOVE ER-8068               TO WS-ERROR
 12210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12211        GO TO 3024-EDIT-DL01-CONT.
 12212
 12213     IF DMPF-RETURN-CODE = '03'
 12214        MOVE ER-8069               TO WS-ERROR
 12215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12216        GO TO 3024-EDIT-DL01-CONT.
 12217
 12218     IF DMPF-RETURN-CODE = 'E1'
 12219        MOVE ER-8070               TO WS-ERROR
 12220        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12221        GO TO 3024-EDIT-DL01-CONT.
 12222
 12223     IF DMPF-RETURN-CODE = 'N1'
 12224        MOVE ER-8071               TO WS-ERROR
 12225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12226        GO TO 3024-EDIT-DL01-CONT.
 12227
 12228     IF DMPF-RETURN-CODE NOT = 'OK'
 12229        MOVE ER-8072               TO WS-ERROR
 12230        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12231
 12232 3024-EDIT-DL01-CONT.
 12233******************************************************************
 12234***  VALIDATES RATE CODES : DLO017                             ***
 12235******************************************************************
 12236
 12237      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12238      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12239      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12240      IF DVRC-SUCCESSFUL-EDIT
 12241        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12242        GO TO 3024-CHECK-VALID-RATE.
 12243
 12244      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12245
 12246      IF DVRC-RETURN-CODE EQUAL '01'
 12247         MOVE ER-7817                   TO WS-ERROR
 12248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12249         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 224
* EL050.cbl
 12250
 12251      IF DVRC-RETURN-CODE EQUAL '02'
 12252         MOVE ER-7818                   TO WS-ERROR
 12253         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12254         GO TO 3025-EDIT-REINSURANCE.
 12255
 12256      IF DVRC-RETURN-CODE EQUAL '03'
 12257         MOVE ER-7819                   TO WS-ERROR
 12258         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12259         GO TO 3025-EDIT-REINSURANCE.
 12260
 12261       MOVE ER-7820                     TO WS-ERROR.
 12262       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12263       GO TO 3025-EDIT-REINSURANCE.
 12264
 12265******************************************************************
 12266***  GET PREMIUM RATES : DLO011                                ***
 12267******************************************************************
 12268
 12269 3024-CHECK-VALID-RATE.
 12270
 12271     IF VALID-RATE-CODE
 12272        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12273        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12274        MOVE SPACES                TO DPRB-RETURN-CODE
 12275        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12276     ELSE
 12277         GO TO 3025-EDIT-REINSURANCE.
 12278
 12279      IF DPRB-SUCCESSFUL-PROCESS
 12280         IF PB-VALID-LIFE
 12281             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12282             GO TO 3025-EDIT-REINSURANCE
 12283         ELSE
 12284             IF PB-VALID-AH
 12285                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12286                 GO TO 3025-EDIT-REINSURANCE.
 12287
 12288      IF DPRB-RETURN-CODE EQUAL '01'
 12289         MOVE ER-7812                   TO WS-ERROR
 12290         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12291         GO TO 3025-EDIT-REINSURANCE.
 12292
 12293      IF DPRB-RETURN-CODE EQUAL '02'
 12294         MOVE ER-7813                   TO WS-ERROR
 12295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12296         GO TO 3025-EDIT-REINSURANCE.
 12297
 12298      IF DPRB-RETURN-CODE EQUAL '03'
 12299         MOVE ER-7814                   TO WS-ERROR
 12300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12301         GO TO 3025-EDIT-REINSURANCE.
 12302
 12303      IF DPRB-RETURN-CODE EQUAL '04'
 12304         IF NOT DPRB-1ST-TIME
 12305            MOVE ER-7815                   TO WS-ERROR
 12306            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12307            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 225
* EL050.cbl
 12308          ELSE
 12309         IF PB-VALID-LIFE
 12310            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12311          ELSE
 12312            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12313         END-IF
 12314         MOVE SPACES                TO DOCC-RETURN-CODE
 12315         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12316         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12317         IF DOCC-RETURN-CODE = 'OK'
 12318             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12319             GO TO 3024-CHECK-VALID-RATE
 12320           ELSE
 12321             MOVE ER-7823               TO WS-ERROR
 12322             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12323             GO TO 3025-EDIT-REINSURANCE.
 12324
 12325       MOVE ER-7816                     TO WS-ERROR.
 12326       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12327       GO TO 3025-EDIT-REINSURANCE.
 12328
 12329**********   DMD CUSTOM CODE ABOVE    **********
 12330
 12331 3025-EDIT-REINSURANCE.
 12332     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12333         GO TO 3027-EDIT-CONTINUE.
 12334
 12335     MOVE LOW-VALUES               TO ERREIN-KEY.
 12336     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12337     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12338                                      REIN-CODE-2
 12339                                      REIN-CODE-3.
 12340     MOVE 'A'                      TO REIN-TYPE.
 12341
 12342     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12343
 12344     MOVE '3026' TO REIN-SW.
 12345     MOVE ' '                   TO WS-REIN-READ-SW.
 12346
 12347     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12348     IF REIN-TABLE-NOT-FOUND
 12349         GO TO 3026-NO-SPEC-TABLE.
 12350
 12351     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12352     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12353                                   WS-NSP-ST-CD-LF.
 12354     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12355                                   WS-NSP-ST-CD-AH.
 12356
 12357     GO TO 3040-EDIT-CONTINUE.
 12358
 12359 3026-NO-SPEC-TABLE.
 12360
 12361     MOVE ER-2664                TO WS-ERROR.
 12362     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12363     GO TO 3040-EDIT-CONTINUE.
 12364
 12365 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 226
* EL050.cbl
 12366
 12367     IF PB-I-REIN-TABLE = SPACES
 12368       GO TO 3040-EDIT-CONTINUE.
 12369
 12370     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12371          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12372          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12373           GO TO 3040-EDIT-CONTINUE.
 12374
 12375     MOVE LOW-VALUES            TO ERREIN-KEY.
 12376     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12377     MOVE 'A'                   TO REIN-TYPE.
 12378     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12379
 12380     MOVE '3028'                TO REIN-SW.
 12381     MOVE ' '                   TO WS-REIN-READ-SW.
 12382
 12383     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12384     IF REIN-TABLE-NOT-FOUND
 12385         GO TO 3028-NO-REIN-TABLE.
 12386
 12387     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12388     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12389                                   WS-NSP-ST-CD-LF.
 12390     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12391                                   WS-NSP-ST-CD-AH.
 12392
 12393     GO TO 3040-EDIT-CONTINUE.
 12394
 12395 3028-NO-REIN-TABLE.
 12396
 12397     MOVE ER-2615                TO WS-ERROR.
 12398     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12399     GO TO 3040-EDIT-CONTINUE.
 12400
 12401 3040-EDIT-CONTINUE.
 12402
 12403     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12404         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12405
 12406     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12407         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12408
 12409     IF (NOT PB-REISSUED-CERT)
 12410        AND (NOT PB-MONTHLY-CERT)
 12411        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12412            MOVE '001'           TO PB-I-LF-TERM
 12413            MOVE 'M'             TO PB-I-INSURED-SEX.
 12414
 12415     IF (NOT PB-REISSUED-CERT)
 12416        AND (NOT PB-MONTHLY-CERT)
 12417        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12418            MOVE '001'           TO PB-I-AH-TERM
 12419            MOVE 'M'             TO PB-I-INSURED-SEX.
 12420
 12421 3040-EDIT-1ST-PMT-DT.
 12422     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12423     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 227
* EL050.cbl
 12424         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12425
 12426******************************************************************
 12427*                                                                *
 12428*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12429*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12430*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12431*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12432*                                                                *
 12433******************************************************************
 12434
 12435     IF PB-EFF-DT-PROCESSING
 12436        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12437                                    PB-I-LF-EXPIRE-DT
 12438                                    PB-I-AH-EXPIRE-DT
 12439        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12440        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12441        MOVE ZERO                TO DC-ELAPSED-DAYS
 12442        MOVE +1                  TO DC-ELAPSED-MONTHS
 12443        SET BIN-PLUS-ELAPSED     TO TRUE
 12444*       MOVE 6                   TO DC-OPTION-CODE
 12445        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12446        IF NO-CONVERSION-ERROR
 12447           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12448
 12449******************************************************************
 12450*                                                                *
 12451*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12452*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12453*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12454*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12455*                                                                *
 12456******************************************************************
 12457
 12458     IF PB-EXT-DAYS-PROCESSING
 12459          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12460                                         PB-I-LF-EXPIRE-DT
 12461                                         PB-I-AH-EXPIRE-DT
 12462          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12463          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12464          MOVE +1                     TO DC-ELAPSED-MONTHS
 12465          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12466          SET BIN-PLUS-ELAPSED        TO TRUE
 12467*         MOVE 6                      TO DC-OPTION-CODE
 12468          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12469          IF NO-CONVERSION-ERROR
 12470             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12471
 12472******************************************************************
 12473*                                                                *
 12474*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12475*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12476*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12477*        (EXPIRE DATE - (TERM -1))  *  -1.
 12478*                                                                *
 12479******************************************************************
 12480
 12481     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 228
* EL050.cbl
 12482        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12483           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12484              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12485              MOVE PB-I-AH-TERM      TO WS-TERM
 12486           ELSE
 12487              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12488              MOVE PB-I-LF-TERM      TO WS-TERM
 12489        ELSE
 12490           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12491              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12492              MOVE PB-I-LF-TERM      TO WS-TERM
 12493           ELSE
 12494              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12495              MOVE PB-I-AH-TERM      TO WS-TERM.
 12496
 12497     IF PB-EXPIRE-DT-PROCESSING
 12498        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12499        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12500        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12501        MOVE ZERO                TO DC-ELAPSED-DAYS
 12502                                    DC-ODD-DAYS-OVER
 12503          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12504          SET BIN-PLUS-ELAPSED    TO TRUE
 12505*         MOVE 6                  TO DC-OPTION-CODE
 12506          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12507          IF NO-CONVERSION-ERROR
 12508             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12509
 12510******************************************************************
 12511*                                                                *
 12512*            1ST PAYMENT DATE PROCESSING                         *
 12513*                                                                *
 12514******************************************************************
 12515
 12516     IF PB-1ST-PMT-DT-PROCESSING
 12517        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12518                                    PB-I-AH-EXPIRE-DT
 12519        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12520
 12521     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12522         NEXT SENTENCE
 12523     ELSE
 12524         MOVE ER-2680                 TO WS-ERROR
 12525         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12526         GO TO 3060-ORIG-TERM-CHECK.
 12527
 12528     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12529     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12530     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12531*    MOVE 1                      TO DC-OPTION-CODE.
 12532     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12533                                    DC-ELAPSED-DAYS
 12534                                    DC-ODD-DAYS-OVER.
 12535
 12536     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12537
 12538     IF DATE-CONVERSION-ERROR
 12539        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 229
* EL050.cbl
 12540
 12541     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12542     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12543        AND (WS-LF-COVERAGE-TYPE = 'L')
 12544        IF (DC-ELAPSED-MONTHS > 1)
 12545                      OR
 12546           ((DC-ELAPSED-MONTHS = 1)
 12547           AND (DC-ODD-DAYS-OVER > 0))
 12548           MOVE ER-2882          TO WS-ERROR
 12549           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12550        END-IF
 12551     END-IF
 12552     if dc-elapsed-months > 0
 12553        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12554        + dc-odd-days-over
 12555     end-if
 12556     IF PB-EXT-DAYS-PROCESSING
 12557        CONTINUE
 12558     ELSE
 12559        IF DC-ELAPSED-MONTHS = +0
 12560           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12561        ELSE
 12562           IF (WS-LF-EARNINGS-CALC = '4')
 12563              AND (DC-ELAPSED-MONTHS > ZERO)
 12564              AND (DC-ELAPSED-DAYS > ZERO)
 12565              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12566           ELSE
 12567              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12568                                 THRU 6499-EXIT
 12569              MOVE WS-ODD-DAYS-OVER
 12570                                 TO PB-I-EXTENTION-DAYS
 12571           END-IF
 12572        END-IF
 12573     END-IF
 12574******************************************************************
 12575*                                                                *
 12576*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12577*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12578*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12579*            AND ANY ODD DAYS.                                   *
 12580*                                                                *
 12581******************************************************************
 12582
 12583     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12584                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12585     IF WS-LF-EARNINGS-CALC NOT = '4'
 12586        IF DC-ELAPSED-DAYS > ZEROS
 12587           MOVE ER-2681          TO WS-ERROR
 12588           PERFORM 9900-ERROR-FORMAT
 12589                                 THRU 9900-EXIT
 12590        END-IF
 12591     END-IF
 12592
 12593     IF WS-LF-EARNINGS-CALC NOT = '4'
 12594        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12595           MOVE ER-2681          TO WS-ERROR
 12596           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12597
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 230
* EL050.cbl
 12598     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12599        (PB-I-LF-TERM NOT = ZERO) AND
 12600         NOT NO-LIFE-COVERAGE
 12601          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12602          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12603          IF WS-LF-EARNINGS-CALC = '4'
 12604             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12605             PB-I-PAY-FREQUENCY
 12606          END-IF
 12607          MOVE ZERO              TO DC-ELAPSED-DAYS
 12608                                    DC-ODD-DAYS-OVER
 12609          MOVE 1                 TO DC-END-OF-MONTH
 12610          SET BIN-PLUS-ELAPSED        TO TRUE
 12611*         MOVE 6                 TO DC-OPTION-CODE
 12612          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12613          IF NO-CONVERSION-ERROR
 12614             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12615             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12616                (WS-LF-SPECIAL-CALC-CD = 'L')
 12617                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12618                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12619                  MOVE +1             TO DC-ELAPSED-MONTHS
 12620                  SET BIN-PLUS-ELAPSED  TO TRUE
 12621*                 MOVE 6              TO DC-OPTION-CODE
 12622                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12623                  IF NO-CONVERSION-ERROR
 12624                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12625
 12626* okay, i had to move the new att age edit down here because the
 12627* expiration date could get recalculated and i need the exp date
 12628     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12629        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12630        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12631        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12632           AND ZEROS
 12633           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12634           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12635           SET ELAPSED-BETWEEN-BIN TO TRUE
 12636           PERFORM 8500-DATE-CONVERT
 12637                                 THRU 8500-EXIT
 12638           IF NO-CONVERSION-ERROR
 12639              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12640                 MOVE ER-2669       TO WS-ERROR
 12641*                PERFORM 9900-ERROR-FORMAT
 12642*                                THRU 9900-EXIT
 12643              END-IF
 12644           END-IF
 12645        ELSE
 12646           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12647           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12648              MOVE ER-2669       TO WS-ERROR
 12649*             PERFORM 9900-ERROR-FORMAT
 12650*                                THRU 9900-EXIT
 12651           ELSE
 12652              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12653                 MOVE ER-1570    TO WS-ERROR
 12654                 PERFORM 9900-ERROR-FORMAT
 12655                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 231
* EL050.cbl
 12656              END-IF
 12657           END-IF
 12658        END-IF
 12659        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12660           AND ZEROS
 12661           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12662           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12663           SET ELAPSED-BETWEEN-BIN TO TRUE
 12664           PERFORM 8500-DATE-CONVERT
 12665                                 THRU 8500-EXIT
 12666           IF NO-CONVERSION-ERROR
 12667              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12668                 MOVE ER-2669       TO WS-ERROR
 12669*                PERFORM 9900-ERROR-FORMAT
 12670*                                THRU 9900-EXIT
 12671              END-IF
 12672           END-IF
 12673        ELSE
 12674           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12675             (PB-I-LF-TERM / 12)
 12676           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12677              MOVE ER-2669       TO WS-ERROR
 12678*             PERFORM 9900-ERROR-FORMAT
 12679*                                THRU 9900-EXIT
 12680           ELSE
 12681              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12682                 MOVE ER-1571    TO WS-ERROR
 12683                 PERFORM 9900-ERROR-FORMAT
 12684                                 THRU 9900-EXIT
 12685              END-IF
 12686           END-IF
 12687        END-IF
 12688        IF WS-ERROR = ER-2669
 12689           PERFORM 9900-ERROR-FORMAT
 12690                                 THRU 9900-EXIT
 12691        END-IF
 12692     END-IF
 12693     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12694        (PB-I-AH-TERM NOT = ZERO) AND
 12695         NOT NO-AH-COVERAGE
 12696          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12697             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12698             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12699             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12700          ELSE
 12701             IF WS-LF-EARNINGS-CALC = '4'
 12702                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12703                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12704                PB-I-PAY-FREQUENCY
 12705             ELSE
 12706                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12707                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12708             END-IF
 12709          END-IF
 12710          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12711                                         DC-ODD-DAYS-OVER
 12712          MOVE 1                      TO DC-END-OF-MONTH
 12713          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 232
* EL050.cbl
 12714*         MOVE 6                      TO DC-OPTION-CODE
 12715          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12716          IF NO-CONVERSION-ERROR
 12717             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12718     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12719        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12720        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12721        IF PB-I-BIRTHDAY > LOW-VALUES
 12722           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12723           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12724           SET ELAPSED-BETWEEN-BIN TO TRUE
 12725           PERFORM 8500-DATE-CONVERT
 12726                                 THRU 8500-EXIT
 12727           IF NO-CONVERSION-ERROR
 12728              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12729                 MOVE ER-3054       TO WS-ERROR
 12730*                PERFORM 9900-ERROR-FORMAT
 12731*                                THRU 9900-EXIT
 12732              END-IF
 12733           END-IF
 12734        ELSE
 12735           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12736           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12737              MOVE ER-3054       TO WS-ERROR
 12738*             PERFORM 9900-ERROR-FORMAT
 12739*                                THRU 9900-EXIT
 12740           END-IF
 12741        END-IF
 12742        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12743           AND ZEROS
 12744           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12745           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12746           SET ELAPSED-BETWEEN-BIN TO TRUE
 12747           PERFORM 8500-DATE-CONVERT
 12748                                 THRU 8500-EXIT
 12749           IF NO-CONVERSION-ERROR
 12750              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12751                 MOVE ER-3054       TO WS-ERROR
 12752*                PERFORM 9900-ERROR-FORMAT
 12753*                                THRU 9900-EXIT
 12754              END-IF
 12755           END-IF
 12756        ELSE
 12757           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12758             (PB-I-AH-TERM / 12)
 12759           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12760              MOVE ER-3054       TO WS-ERROR
 12761*             PERFORM 9900-ERROR-FORMAT
 12762*                                THRU 9900-EXIT
 12763           END-IF
 12764        END-IF
 12765        IF WS-ERROR = ER-3054
 12766           PERFORM 9900-ERROR-FORMAT
 12767                                 THRU 9900-EXIT
 12768        END-IF
 12769     END-IF
 12770     MOVE SPACE                       TO DC-END-OF-MONTH.
 12771
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 233
* EL050.cbl
 12772     IF PB-COMPANY-ID = 'NCB'
 12773        GO TO 3040-EDIT-EXTENSION-DAYS.
 12774
 12775     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12776       AND
 12777        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12778        NEXT SENTENCE
 12779     ELSE
 12780        GO TO 3040-EDIT-EXTENSION-DAYS.
 12781
 12782     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12783        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12784        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12785     ELSE
 12786        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12787        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12788
 12789     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12790*    MOVE '1'      TO DC-OPTION-CODE
 12791     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12792     IF (NO-CONVERSION-ERROR)
 12793        AND (DC-ELAPSED-MONTHS > +1)
 12794        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12795        MOVE ER-2668   TO WS-ERROR
 12796        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12797
 12798 3040-EDIT-EXTENSION-DAYS.
 12799
 12800     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12801        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12802         GO TO 3050-EDIT-TERM-IN-DAYS
 12803     ELSE
 12804         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12805
 12806     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12807         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12808     ELSE
 12809        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12810           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12811           MOVE ER-2681         TO WS-ERROR
 12812           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12813
 12814     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12815        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12816        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12817         GO TO 3060-ORIG-TERM-CHECK.
 12818
 12819     GO TO 3060-ORIG-TERM-CHECK.
 12820
 12821 3050-EDIT-TERM-IN-DAYS.
 12822
 12823     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12824
 12825     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12826         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12827     ELSE
 12828         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12829            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 234
* EL050.cbl
 12830            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12831
 12832     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12833                                       REMAINDER WS-WORK-TERM.
 12834     IF WS-WORK-TERM GREATER THAN ZERO
 12835         ADD +1 TO PB-I-LF-TERM.
 12836
 12837     IF NOT NO-AH-COVERAGE
 12838         MOVE ER-2684            TO WS-ERROR
 12839         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12840
 12841
 12842 3060-ORIG-TERM-CHECK.
 12843
 12844******************************************************************
 12845*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12846******************************************************************
 12847
 12848     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12849        NEXT SENTENCE
 12850     ELSE
 12851        IF NOT NO-LIFE-COVERAGE
 12852           IF PB-I-LF-TERM NUMERIC
 12853              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12854              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12855              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12856                  NEXT SENTENCE
 12857           ELSE
 12858              MOVE ER-2647       TO WS-ERROR
 12859              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12860
 12861     IF NOT NO-AH-COVERAGE
 12862         IF PB-I-AH-TERM NUMERIC
 12863            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12864            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12865            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12866             NEXT SENTENCE
 12867          ELSE
 12868              MOVE ER-2658       TO WS-ERROR
 12869              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12870
 12871     IF PB-COMPANY-ID = 'NCB'
 12872        GO TO 3070-LOAN-TERM-CHECK.
 12873
 12874     IF POLICY-HAS-AH
 12875       AND
 12876        POLICY-HAS-LIFE
 12877       AND
 12878        PB-I-LF-TERM NUMERIC
 12879       AND
 12880        PB-I-AH-TERM NUMERIC
 12881        NEXT SENTENCE
 12882     ELSE
 12883        GO TO 3070-LOAN-TERM-CHECK.
 12884
 12885     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12886     IF WS-TEX-FACT-2 LESS THAN +0
 12887        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 235
* EL050.cbl
 12888
 12889     IF WS-TEX-FACT-2 GREATER THAN +1
 12890        MOVE ER-2668             TO WS-ERROR
 12891        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12892
 12893 3070-LOAN-TERM-CHECK.
 12894
 12895     IF (WS-LF-BENEFIT-CD = ZERO)
 12896         OR (NO-LF-BENEFIT-MATCH)
 12897            GO TO 3125-EDIT-PMT-FREQ.
 12898*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12899*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12900*          AND 'V' AND 'W' AND 'X'
 12901*          GO TO 3125-EDIT-PMT-FREQ
 12902*       END-IF
 12903*    ELSE
 12904*       IF WS-AH-DCC-TRUNC = 'T'
 12905*          CONTINUE
 12906*       ELSE
 12907*          GO TO 3125-EDIT-PMT-FREQ
 12908*       END-IF
 12909*    END-IF
 12910     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12911                    OR
 12912        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12913        AND (WS-AH-DCC-TRUNC = 'T'))
 12914        CONTINUE
 12915     ELSE
 12916        GO TO 3125-EDIT-PMT-FREQ
 12917     END-IF
 12918     IF PB-I-LOAN-TERM NOT NUMERIC
 12919         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12920
 12921     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12922        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12923*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12924        PB-I-LOAN-TERM NOT GREATER THAN +360
 12925         NEXT SENTENCE
 12926     ELSE
 12927         MOVE ER-2648            TO WS-ERROR
 12928         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12929
 12930     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12931        MOVE ER-3058             TO WS-ERROR
 12932        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12933     end-if
 12934
 12935     IF WS-STATE-ABBREVIATION = 'NC'
 12936        IF PB-I-LOAN-TERM > +59
 12937           CONTINUE
 12938        ELSE
 12939           MOVE ER-2792          TO WS-ERROR
 12940           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12941        END-IF
 12942     END-IF
 12943
 12944     .
 12945 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 236
* EL050.cbl
 12946     IF (WS-LF-BENEFIT-CD = ZERO)
 12947         OR (NO-LF-BENEFIT-MATCH)
 12948            GO TO 3127-EDIT-LOAN-OFFICER.
 12949     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12950                    OR
 12951        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12952        AND (WS-AH-DCC-TRUNC = 'T'))
 12953                    OR
 12954         (PB-COMPANY-ID = 'AHL')
 12955        CONTINUE
 12956     ELSE
 12957        IF (PB-I-LOAN-TERM > ZEROS)
 12958           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12959           MOVE ER-1575          TO WS-ERROR
 12960           PERFORM 9900-ERROR-FORMAT
 12961                                 THRU 9900-EXIT
 12962        END-IF
 12963     END-IF
 12964     IF WS-LF-EARNINGS-CALC NOT = '4'
 12965         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12966            MOVE ER-2653         TO WS-ERROR
 12967            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12968            GO TO 3127-EDIT-LOAN-OFFICER
 12969         ELSE
 12970            GO TO 3127-EDIT-LOAN-OFFICER.
 12971
 12972     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12973         MOVE ER-2655            TO WS-ERROR
 12974         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12975         GO TO 3127-EDIT-LOAN-OFFICER.
 12976
 12977     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12978         MOVE ER-2654            TO WS-ERROR
 12979         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12980         GO TO 3127-EDIT-LOAN-OFFICER.
 12981
 12982     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12983         GIVING WS-TEX-FACT-2
 12984             REMAINDER WS-TEX-FACT-3.
 12985
 12986*    IF WS-TEX-FACT-3 NOT = ZERO
 12987*       MOVE ER-2654             TO WS-ERROR
 12988*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12989
 12990
 12991 3127-EDIT-LOAN-OFFICER.
 12992
 12993     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12994        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12995           MOVE ER-2690          TO WS-ERROR
 12996           PERFORM 9900-ERROR-FORMAT
 12997                                 THRU 9900-EXIT
 12998        ELSE
 12999           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13000           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13001           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13002           MOVE PB-SV-STATE      TO LOFC-STATE
 13003           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 237
* EL050.cbl
 13004           MOVE PB-I-LOAN-OFFICER
 13005                                 TO LOFC-CODE
 13006           PERFORM 8586-READ-LOAN-OFFICER
 13007                                 THRU 8586-EXIT
 13008           IF (NOT LOFC-MASTER-FOUND)
 13009              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13010              MOVE ER-3006       TO WS-ERROR
 13011              PERFORM 9900-ERROR-FORMAT
 13012                                 THRU 9900-EXIT
 13013           END-IF
 13014        END-IF
 13015     END-IF
 13016     .
 13017 3129-EDIT-APR.
 13018
 13019     IF (WS-LF-BENEFIT-CD = ZERO)
 13020        OR (NO-LF-BENEFIT-MATCH)
 13021        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13022           GO TO 3130-EDIT-AGE
 13023*       ELSE
 13024*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13025*             GO TO 3130-EDIT-AGE
 13026*          END-IF
 13027        END-IF
 13028     END-IF
 13029
 13030     IF (WS-STATE-ABBREVIATION = 'OH')
 13031         AND (PB-I-RATE-CLASS NOT = 'L ')
 13032         AND (PB-I-LF-TERM GREATER THAN 60)
 13033         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13034         GO TO 3129-APR-CONT.
 13035
 13036     IF (WS-STATE-ABBREVIATION = 'RI')
 13037         AND (PB-I-LF-TERM GREATER THAN 60)
 13038         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13039         GO TO 3129-APR-CONT.
 13040
 13041     IF (WS-STATE-ABBREVIATION = 'UT')
 13042         AND (PB-I-LF-TERM GREATER THAN 62)
 13043         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13044         AND (PB-CERT-EFF-DT LESS WS-830901)
 13045         GO TO 3129-APR-CONT.
 13046
 13047     IF PB-COMPANY-ID = 'LAP'
 13048        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13049           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13050              MOVE ER-2656         TO WS-ERROR
 13051              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13052              GO TO 3130-EDIT-AGE.
 13053
 13054     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13055        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13056        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13057        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13058        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13059        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13060         GO TO 3130-EDIT-AGE.
 13061
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 238
* EL050.cbl
 13062 3129-APR-CONT.
 13063     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13064         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13065         GO TO 3130-EDIT-AGE.
 13066
 13067     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13068         WS-AH-BENEFIT-CD (1:1) = 'S')
 13069        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13070        AND (PB-I-LOAN-APR = ZERO)
 13071        MOVE ER-2657             TO WS-ERROR
 13072        PERFORM 9900-ERROR-FORMAT
 13073                                 THRU 9900-EXIT
 13074        GO TO 3130-EDIT-AGE
 13075     END-IF
 13076*    IF PB-I-LOAN-APR = ZERO
 13077*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13078*    END-IF
 13079
 13080     if pb-i-loan-apr = +99.9999
 13081        move er-2656             to ws-error
 13082        PERFORM 9900-ERROR-FORMAT
 13083                                 THRU 9900-EXIT
 13084        GO TO 3130-EDIT-AGE
 13085     end-if
 13086*    IF PB-I-LOAN-APR = ZERO
 13087*       MOVE ER-2656             TO WS-ERROR
 13088*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13089*       GO TO 3130-EDIT-AGE.
 13090
 13091*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13092     if pb-i-loan-apr not = +99.9999
 13093        IF PB-I-LOAN-APR > +30.000
 13094           MOVE ER-2657          TO WS-ERROR
 13095           PERFORM 9900-ERROR-FORMAT
 13096                                 THRU 9900-EXIT
 13097        end-if
 13098     end-if
 13099     .
 13100 3130-EDIT-AGE.
 13101
 13102******************************************************************
 13103*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13104******************************************************************
 13105
 13106     IF NOT NO-LIFE-COVERAGE
 13107        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13108           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13109               MOVE ER-2628             TO WS-ERROR
 13110               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13111
 13112     IF NOT NO-AH-COVERAGE
 13113        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13114           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13115               MOVE ER-2628         TO WS-ERROR
 13116               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13117
 13118 3133-SEX-CODE.
 13119     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 239
* EL050.cbl
 13120         IF WS-DEFAULT-SEX = 'M'
 13121             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13122          ELSE
 13123             IF WS-DEFAULT-SEX = 'F'
 13124             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13125
 13126     IF PB-I-INSURED-SEX = '1'
 13127         MOVE 'M' TO PB-I-INSURED-SEX.
 13128
 13129     IF PB-I-INSURED-SEX = '2'
 13130         MOVE 'F' TO PB-I-INSURED-SEX.
 13131
 13132 3134-SIG-SW-EDIT.
 13133     IF PB-I-SIG-SW = SPACE
 13134         MOVE 'N'                TO  PB-I-SIG-SW.
 13135
 13136     IF PB-COMPANY-ID = 'NCL'
 13137         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13138             NEXT SENTENCE
 13139         ELSE
 13140             MOVE ER-1923        TO  WS-ERROR
 13141             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13142     ELSE
 13143     IF PB-COMPANY-ID = 'CRI'
 13144         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13145             NEXT SENTENCE
 13146         ELSE
 13147             MOVE ER-2606        TO  WS-ERROR
 13148             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13149     ELSE
 13150     IF PB-COMPANY-ID = 'TMS'
 13151         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13152             NEXT SENTENCE
 13153         ELSE
 13154             MOVE ER-2689        TO  WS-ERROR
 13155             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13156     ELSE
 13157         IF PB-I-SIG-SW = 'Y' OR 'N'
 13158             NEXT SENTENCE
 13159         ELSE
 13160             MOVE ER-2651        TO  WS-ERROR
 13161             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13162
 13163     IF PB-COMPANY-ID = 'FLA'
 13164         IF (WS-EDIT-AGE GREATER 54  OR
 13165             WS-AH-EDIT-AGE GREATER 54)  AND
 13166            PB-I-SIG-SW = 'N'
 13167            MOVE ER-2651         TO  WS-ERROR
 13168            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13169
 13170 3135-NAME-EDIT.
 13171
 13172     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13173        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13174        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13175           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13176                                 TO PB-I-JOINT-FIRST-NAME
 13177        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 240
* EL050.cbl
 13178     END-IF
 13179     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13180        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13181        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13182           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13183                                 TO PB-I-JOINT-LAST-NAME
 13184        END-PERFORM
 13185     END-IF
 13186     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13187        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13188        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13189           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13190                                 TO PB-I-INSURED-FIRST-NAME
 13191        END-PERFORM
 13192     END-IF
 13193     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13194        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13195        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13196           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13197                                 TO PB-I-INSURED-LAST-NAME
 13198        END-PERFORM
 13199     END-IF
 13200     IF PB-I-INSURED-LAST-NAME = SPACES
 13201       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13202       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13203           MOVE ER-2660    TO WS-ERROR
 13204           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13205
 13206 3136-EDIT-SEX.
 13207
 13208******************************************************************
 13209*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13210******************************************************************
 13211
 13212     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13213        (WS-AH-SPECIAL-CALC-CD = 'O')
 13214        NEXT SENTENCE
 13215     ELSE
 13216        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13217           NEXT SENTENCE
 13218        ELSE
 13219           MOVE ER-2629            TO WS-ERROR
 13220           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13221
 13222 3137-EDIT-EFF-DATE.
 13223
 13224     IF PB-REISSUED-CERT       OR
 13225        PB-POLICY-IS-DECLINED  OR
 13226        PB-POLICY-IS-VOIDED
 13227         GO TO 3139-EDIT-COVERAGE-CODES.
 13228
 13229     MOVE SPACE                  TO WS-2671-SW
 13230                                    WS-2672-SW.
 13231
 13232     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13233         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13234             MOVE ER-2703        TO WS-ERROR
 13235             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 241
* EL050.cbl
 13236             GO TO 3139-EDIT-COVERAGE-CODES.
 13237
 13238     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13239         GO TO 3139-EDIT-COVERAGE-CODES.
 13240
 13241     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13242     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13243*    MOVE '1'                    TO DC-OPTION-CODE.
 13244     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13245     MOVE +0                     TO DC-ELAPSED-MONTHS
 13246                                    DC-ELAPSED-DAYS.
 13247     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13248
 13249     IF DATE-CONVERSION-ERROR
 13250         GO TO 3139-EDIT-COVERAGE-CODES.
 13251
 13252     IF DC-ELAPSED-DAYS GREATER +180
 13253         MOVE ER-2672            TO WS-ERROR
 13254         MOVE 'Y'                TO WS-2672-SW
 13255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13256     END-IF
 13257
 13258     IF WS-ERROR = ER-2671  AND
 13259        PB-COMPANY-ID  = 'LBL'
 13260        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13261        MOVE SPACE               TO WS-2671-SW
 13262        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13263
 13264     IF PB-ISSUE-DATE-FORCED  AND
 13265      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13266         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13267         MOVE ER-2673            TO WS-ERROR
 13268         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13269         MOVE SPACE              TO WS-2671-SW
 13270                                    WS-2672-SW.
 13271
 13272     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13273         IF PB-ISSUE-DATE-FORCED
 13274             MOVE ER-2600          TO  WS-ERROR
 13275             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13276         ELSE
 13277             MOVE ER-2692          TO  WS-ERROR
 13278             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13279
 13280
 13281 3139-EDIT-COVERAGE-CODES.
 13282
 13283     if pb-company-id not = 'AHL'
 13284        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13285           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13286           MOVE ER-2787          TO WS-ERROR
 13287           PERFORM 9900-ERROR-FORMAT
 13288                                 THRU 9900-EXIT
 13289        END-IF
 13290     end-if
 13291     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13292        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13293                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 242
* EL050.cbl
 13294           MOVE ER-2719          TO WS-ERROR
 13295           PERFORM 9900-ERROR-FORMAT
 13296                                 THRU 9900-EXIT
 13297        END-IF
 13298     END-IF
 13299
 13300     IF PB-POLICY-IS-DECLINED  OR
 13301        PB-POLICY-IS-VOIDED
 13302         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13303
 13304     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13305        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13306         MOVE ER-2630                TO WS-ERROR
 13307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13308
 13309     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13310        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13311        PB-I-LF-PREMIUM-AMT = ZERO
 13312         GO TO 3140-CHECK-AH-FOR-ZERO.
 13313
 13314     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13315        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13316        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13317         GO TO 3140-CHECK-AH-FOR-ZERO.
 13318
 13319     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13320        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13321        MOVE ER-2631             TO WS-ERROR
 13322        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13323     END-IF
 13324
 13325
 13326******************************************************************
 13327*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13328******************************************************************
 13329
 13330     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13331        NEXT SENTENCE
 13332     ELSE
 13333        IF PB-I-LF-BENEFIT-AMT = ZERO
 13334           MOVE ER-2632             TO WS-ERROR
 13335           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13336
 13337
 13338******************************************************************
 13339*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13340******************************************************************
 13341
 13342     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13343        CONTINUE
 13344     ELSE
 13345        IF PB-I-LF-PREMIUM-AMT = ZERO
 13346           IF (NOT PB-COMP-LF-PREM)
 13347              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13348              and (ws-lf-ben-category not = 'C')
 13349              MOVE ER-2633       TO WS-ERROR
 13350              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13351           END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 243
* EL050.cbl
 13352        END-IF
 13353     END-IF
 13354     .
 13355 3140-CHECK-AH-FOR-ZERO.
 13356
 13357     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13358        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13359        PB-I-AH-PREMIUM-AMT = ZERO
 13360         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13361
 13362     IF PB-COMPANY-ID = 'CSL'  AND
 13363        PB-I-AH-BENEFIT-CD = ZERO  AND
 13364        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13365        PB-I-AH-PREMIUM-AMT = ZERO
 13366         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13367
 13368     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13369        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13370        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13371         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13372
 13373     IF PB-I-AH-BENEFIT-CD = ZERO
 13374         MOVE ER-2634            TO WS-ERROR
 13375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13376
 13377******************************************************************
 13378*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13379******************************************************************
 13380
 13381     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13382        NEXT SENTENCE
 13383     ELSE
 13384        IF PB-I-AH-BENEFIT-AMT = ZERO
 13385           MOVE ER-2635             TO WS-ERROR
 13386           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13387
 13388******************************************************************
 13389*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13390******************************************************************
 13391
 13392     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13393        NEXT SENTENCE
 13394     ELSE
 13395        IF PB-I-AH-PREMIUM-AMT = ZERO
 13396            IF NOT PB-COMP-AH-PREM
 13397                MOVE ER-2636    TO WS-ERROR
 13398                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13399
 13400
 13401 3140-EDIT-MAX-AMT-SIZES.
 13402* CUSTOM CODE FOR CLIENT    'DMD'
 13403     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13404                                     WS-RES-MUNI-TAX
 13405                                     PB-I-STATE-TAX
 13406                                     PB-I-MUNI-TAX.
 13407
 13408     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13409
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 244
* EL050.cbl
 13410     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13411        GO TO 3150-RATE-OUTSTAND-BAL.
 13412
 13413     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13414        GO TO 3150-RATE-OUTSTAND-BAL.
 13415
 13416     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13417        GO TO 3150-RATE-OUTSTAND-BAL.
 13418
 13419     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13420                             OR 'RIC')
 13421        GO TO 3150-RATE-OUTSTAND-BAL.
 13422
 13423     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13424        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13425            GO TO 3150-RATE-OUTSTAND-BAL
 13426        ELSE
 13427           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13428               GO TO 3150-RATE-OUTSTAND-BAL.
 13429
 13430     IF NOT PB-NO-MONTHS-SKIPPED
 13431        GO TO 3150-RATE-OUTSTAND-BAL.
 13432
 13433     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13434        GO TO 3150-RATE-OUTSTAND-BAL.
 13435
 13436     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13437        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13438           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13439             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13440           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13441           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13442              MOVE ER-2693     TO WS-ERROR
 13443              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13444              GO TO 3150-RATE-OUTSTAND-BAL
 13445           ELSE
 13446              GO TO 3150-RATE-OUTSTAND-BAL.
 13447
 13448 3150-RATE-OUTSTAND-BAL.
 13449
 13450* DMD RATING TEST
 13451     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13452         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13453         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13454         MOVE ER-2687                 TO WS-ERROR
 13455         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13456         MOVE 'B'                     TO PB-I-OB-FLAG
 13457         GO TO 3260-EDIT-CONTINUE.
 13458
 13459     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13460         IF  WS-ERROR    EQUAL    ER-2693
 13461             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13462                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13463                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13464                 MOVE  +0            TO  WS-ERROR.
 13465
 13466     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13467         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 245
* EL050.cbl
 13468             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13469                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13470                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13471                 MOVE  +0            TO  WS-ERROR.
 13472
 13473     IF PLAN-MASTER-AH-SW = 'Y'
 13474        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13475            IF  WS-ERROR    EQUAL    ER-2693
 13476              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13477                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13478                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13479                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13480                 MOVE  ER-1910           TO  WS-ERROR
 13481                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13482
 13483     IF PLAN-MASTER-AH-SW = 'Y'
 13484        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13485            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13486               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13487               MOVE  ER-1910           TO  WS-ERROR
 13488               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13489
 13490     IF PLAN-MASTER-AH-SW = 'Y'
 13491        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13492            IF  WS-ERROR    EQUAL    ER-2693
 13493                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13494                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13495                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13496                 MOVE  +0       TO  WS-ERROR.
 13497
 13498     IF WS-ERROR = ER-2693
 13499        IF PB-COMPANY-ID = 'JAL' AND
 13500           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13501           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13502           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13503
 13504     IF WS-ERROR = ER-2693
 13505        IF PB-COMPANY-ID = 'NCL'  AND
 13506           PB-I-AH-BENEFIT-CD = 'OA'
 13507           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13508           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13509
 13510     IF WS-ERROR = ER-2693
 13511        IF PB-COMPANY-ID = 'CNL' AND
 13512           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13513           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13514           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13515
 13516     IF WS-ERROR = ER-2693
 13517        IF PB-COMPANY-ID = 'HER'
 13518           IF WS-LEVEL
 13519              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13520              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13521
 13522     IF ((LF-BENEFIT-FOUND) AND
 13523         (NOT NO-LIFE-COVERAGE)  AND
 13524         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13525       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 246
* EL050.cbl
 13526             (NOT NO-AH-COVERAGE)    AND
 13527             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13528         NEXT SENTENCE
 13529     ELSE
 13530         GO TO 3215-EDIT-RATES.
 13531
 13532     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13533        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13534           MOVE ER-2674          TO WS-ERROR
 13535           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13536           GO TO 3215-EDIT-RATES.
 13537
 13538     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13539        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13540           MOVE ER-2674          TO WS-ERROR
 13541           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13542           GO TO 3215-EDIT-RATES.
 13543
 13544     MOVE 'B'                    TO PB-I-OB-FLAG.
 13545
 13546     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13547         NEXT SENTENCE
 13548     ELSE
 13549         IF NOT NO-LIFE-COVERAGE
 13550             IF WS-ACCT-LF-OB-RT = ZERO
 13551                MOVE ER-2641    TO WS-ERROR
 13552                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13553
 13554     IF PB-COMPANY-ID = 'CRI'
 13555       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13556         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13557         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13558         IF WS-ERROR = ER-2675
 13559            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13560            MOVE ER-2687              TO WS-ERROR
 13561            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13562         ELSE
 13563            MOVE ER-2687              TO WS-ERROR
 13564            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13565
 13566
 13567     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13568         NEXT SENTENCE
 13569     ELSE
 13570       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13571            NEXT SENTENCE
 13572       ELSE
 13573         IF NOT NO-AH-COVERAGE
 13574             IF WS-ACCT-AH-OB-RT = ZERO
 13575                MOVE ER-2642    TO WS-ERROR
 13576                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13577
 13578     IF PB-COMPANY-ID = 'CRI'
 13579       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13580         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13581         IF WS-ERROR = ER-2676
 13582            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13583            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 247
* EL050.cbl
 13584            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13585         ELSE
 13586            MOVE ER-2687              TO WS-ERROR
 13587            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13588
 13589     IF PB-COMPANY-ID NOT = 'GIC'
 13590         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13591            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13592     ELSE
 13593         IF PB-I-LF-PREM-CALC = ZEROS
 13594             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13595                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13596
 13597     IF PB-COMPANY-ID NOT = 'GIC'
 13598         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13599            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13600     ELSE
 13601         IF PB-I-AH-PREM-CALC = ZEROS
 13602             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13603                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13604
 13605     MOVE ZEROS TO PB-I-MORT-CODE.
 13606
 13607     GO TO 3260-EDIT-CONTINUE.
 13608
 13609
 13610 3215-EDIT-RATES.
 13611     IF ACCOUNT-MAST-FOUND
 13612         NEXT SENTENCE
 13613     ELSE
 13614         GO TO 3999-END-EDIT.
 13615
 13616 3220-CHECK-LF-RATES.
 13617
 13618     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13619        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13620        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13621        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13622           AND (NOT WS-LF-CASH))
 13623                           OR
 13624           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13625           AND (NOT WS-AH-CASH)))
 13626                       AND
 13627           (PB-I-ENTRY-STATUS NOT = '5')
 13628           MOVE 'M'              TO PB-BATCH-ENTRY
 13629                                    PB-I-ENTRY-STATUS
 13630        END-IF
 13631     END-IF
 13632     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13633                                    PB-I-AH-PREM-CALC
 13634                                    PB-I-LF-ALT-PREM-CALC
 13635                                    PB-I-LF-ALT-RATE
 13636                                    PB-I-LF-REI-RATE
 13637                                    PB-I-LF-ALT-REI-RATE
 13638                                    PB-I-AH-REI-RATE
 13639                                    PB-I-TOT-FEES-CALC.
 13640
 13641     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 248
* EL050.cbl
 13642        NEXT SENTENCE
 13643     ELSE
 13644        MOVE ZEROS               TO PB-I-LF-RATE
 13645                                    PB-I-AH-RATE.
 13646
 13647     IF PB-I-TOT-FEES NOT NUMERIC
 13648        MOVE ZEROS               TO PB-I-TOT-FEES
 13649     END-IF
 13650     IF PB-I-LIVES NOT NUMERIC
 13651         MOVE ZERO               TO PB-I-LIVES.
 13652
 13653     IF PB-I-NUM-BILLED NOT NUMERIC
 13654         MOVE ZERO               TO PB-I-NUM-BILLED.
 13655
 13656     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13657        MOVE +0                  TO PB-I-LF-PREM-TAX
 13658     END-IF
 13659
 13660     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13661        MOVE +0                  TO PB-I-AH-PREM-TAX
 13662     END-IF
 13663
 13664     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13665        PB-I-PAY-FREQUENCY = ZEROS
 13666            MOVE 12 TO CP-PAY-FREQUENCY
 13667     ELSE
 13668            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13669
 13670     IF PB-I-STATE-TAX NOT NUMERIC
 13671         MOVE ZEROS               TO PB-I-STATE-TAX.
 13672
 13673     IF PB-I-MUNI-TAX NOT NUMERIC
 13674         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13675
 13676     MOVE SPACES                 TO CP-BEN-CATEGORY
 13677     IF PB-COMPANY-ID  = 'CSL'  AND
 13678        PB-I-LF-TERM NOT = ZERO
 13679        COMPUTE WS-PAYMENT-AMT =
 13680             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13681        COMPUTE WS-CSL-AMT1 =
 13682             PB-I-LF-TERM * AM-MAX-MON-BEN
 13683        COMPUTE WS-CSL-AMT2 =
 13684             WS-PAYMENT-AMT * PB-I-LF-TERM
 13685        IF CP-PAY-FREQUENCY NOT = 12
 13686           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13687           MOVE '8' TO WS-CSL-CALC-CD
 13688        ELSE
 13689           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13690              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13691               AM-MAX-TOT-BEN
 13692               MOVE '6' TO WS-CSL-CALC-CD
 13693           ELSE
 13694              IF (WS-CSL-AMT1  GREATER THAN
 13695                 AM-MAX-TOT-BEN) AND
 13696                 (WS-CSL-AMT2  GREATER THAN
 13697                 AM-MAX-TOT-BEN)
 13698                 MOVE '7' TO WS-CSL-CALC-CD
 13699              ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 249
* EL050.cbl
 13700                 MOVE '5' TO WS-CSL-CALC-CD.
 13701
 13702     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13703         NEXT SENTENCE
 13704     ELSE
 13705         GO TO 3300-CHECK-AH-RATES.
 13706
 13707*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13708
 13709     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13710        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13711              OR
 13712           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13713           MOVE ER-2618          TO WS-ERROR
 13714           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13715           GO TO 3300-CHECK-AH-RATES.
 13716
 13717     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13718           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13719                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13720
 13721     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13722         MOVE ER-2687             TO WS-ERROR
 13723         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13724         MOVE 'Z000'              TO PB-I-MORT-CODE
 13725         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13726         GO TO 3300-CHECK-AH-RATES.
 13727
 13728     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13729        IF PB-I-LIVES = ZERO
 13730           MOVE ER-2688          TO WS-ERROR
 13731           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13732
 13733     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13734
 13735     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13736     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13737     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13738     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13739     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13740     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13741     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13742     MOVE '3'                    TO CP-PROCESS-TYPE.
 13743     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13744     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13745
 13746******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13747     IF PB-COMPANY-ID EQUAL 'CDL'
 13748         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13749            CP-EARN-AS-NET-PAY)
 13750             IF PB-CERT-EFF-DT GREATER  WS-931231
 13751                 MOVE '1'        TO CP-EARNING-METHOD.
 13752*******
 13753
 13754     MOVE PB-SV-STATE            TO CP-STATE.
 13755     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13756     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13757     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 250
* EL050.cbl
 13758     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13759     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13760                                    CP-RATING-BENEFIT-AMT.
 13761     IF CP-STATE-STD-ABBRV = 'OR'
 13762         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13763                                         PB-I-LF-ALT-BENEFIT-AMT.
 13764     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13765     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13766     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13767     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13768     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13769     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13770     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13771     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13772     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13773                                    CP-REMAINING-TERM
 13774                                    CP-LOAN-TERM.
 13775
 13776     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13777         NEXT SENTENCE
 13778     ELSE
 13779         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13780             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13781                                           PB-I-LF-PREMIUM-AMT.
 13782
 13783     IF PB-COMPANY-ID EQUAL 'CSL'
 13784        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13785           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13786                                         PB-I-LF-PREMIUM-AMT.
 13787
 13788     IF PB-COMPANY-ID EQUAL 'NCB'
 13789         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13790            CP-EARN-AS-NET-PAY
 13791             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13792                 PB-I-LF-PREMIUM-AMT.
 13793
 13794     IF (CP-TRUNCATED-LIFE)
 13795        or ((pb-company-id = 'AHL')
 13796           and (pb-i-loan-term > pb-i-lf-term))
 13797        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13798
 13799     IF PB-COMPANY-ID EQUAL 'CRI'
 13800        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13801
 13802     IF CP-TERM-IS-DAYS
 13803         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13804     ELSE
 13805         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13806     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13807        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13808        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13809        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13810        IF WS-LF-BEN-CATEGORY = 'D'
 13811           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13812           MOVE PB-I-LIFE-COMMISSION
 13813                                 TO CP-DCC-ACT-COMM
 13814           MOVE WS-LF-BEN-CATEGORY
 13815                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 251
* EL050.cbl
 13816        END-IF
 13817        IF (CP-BENEFIT-CD (1:1) = 'P')
 13818           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13819           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13820           add pb-i-ah-premium-amt to cp-original-premium
 13821        END-IF
 13822     END-IF
 13823     IF PB-COMPANY-ID = 'CSL'
 13824         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13825         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13826         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13827
 13828     IF PB-COMPANY-ID = 'CSL'
 13829        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13830
 13831     IF (CP-SPECIAL-CALC-CD = 'H')
 13832        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13833         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13834                                    TO CP-ALTERNATE-BENEFIT
 13835         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13836     if (pb-company-id = 'CID')
 13837        and (ws-lf-earnings-calc = '4')
 13838        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13839        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13840        move pb-i-term-type      to cp-pmt-mode
 13841        move pb-i-no-of-payments to cp-no-of-pmts
 13842     end-if
 13843     move ws-net-only-state      to cp-net-only-state
 13844     IF (PB-COMPANY-ID = 'CID')
 13845        AND (WS-LF-EARNINGS-CALC = 'B')
 13846        AND (CP-STATE-STD-ABBRV = 'MN')
 13847        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13848                                 TO CP-ALTERNATE-BENEFIT
 13849        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13850     END-IF
 13851     IF (PB-COMPANY-ID = 'CID')
 13852        AND (WS-LF-EARNINGS-CALC = 'B')
 13853        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13854                                 TO CP-ALTERNATE-BENEFIT
 13855        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13856        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13857*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13858*         pb-i-lf-alt-premium-amt
 13859        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13860        IF WS-LF-BEN-CATEGORY = 'P'
 13861           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13862        ELSE
 13863           IF WS-LF-BEN-CATEGORY = 'I'
 13864              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13865           END-IF
 13866        END-IF
 13867     END-IF
 13868     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13869     MOVE 'R'                   TO CP-RATE-FILE.
 13870     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13871
 13872     IF CP-ERROR-RATE-NOT-FOUND
 13873        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 252
* EL050.cbl
 13874        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13875        GO TO 3300-CHECK-AH-RATES.
 13876
 13877     IF PB-COMPANY-ID EQUAL 'CRI'
 13878        IF CP-ERROR-NO-LIMITS-CRI
 13879           IF NOT ACCOUNT-LIFE-CHECKED
 13880              MOVE ER-2607      TO WS-ERROR
 13881              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13882
 13883******************************************************************
 13884*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13885*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13886******************************************************************
 13887
 13888* CALC LIFE AGE AT EXPIRATION.
 13889
 13890     COMPUTE WS-AGE-AT-EXPIRE =
 13891          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13892
 13893*    IF PB-STATE = 'CO' OR 'UT'
 13894*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13895*        MOVE 'F'            TO PB-FATAL-FLAG
 13896*        MOVE ER-2709        TO WS-ERROR
 13897*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13898*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13899
 13900*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13901*        MOVE 'X'            TO PB-FATAL-FLAG
 13902*        MOVE ER-2718        TO WS-ERROR
 13903*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13904*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13905
 13906* CALC A & H AGE AT EXPIRATION.
 13907
 13908     COMPUTE WS-AGE-AT-EXPIRE =
 13909          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13910
 13911*    IF PB-STATE = 'CO' OR 'UT'
 13912*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13913*        MOVE 'F'            TO PB-FATAL-FLAG
 13914*        MOVE ER-2709        TO WS-ERROR
 13915*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13916*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13917
 13918*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13919*        MOVE 'X'            TO PB-FATAL-FLAG
 13920*        MOVE ER-2718        TO WS-ERROR
 13921*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13922*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13923
 13924     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13925        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13926
 13927     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13928        and (not pb-monthly-cert)
 13929        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13930     end-if
 13931
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 253
* EL050.cbl
 13932     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13933        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13934
 13935     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13936         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13937         MOVE ER-2639        TO WS-ERROR
 13938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13939
 13940
 13941******************************************************************
 13942*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13943******************************************************************
 13944
 13945 PREMIUM-EDITING-IS-BYPASSED.
 13946     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13947        AND (CP-R-MAX-ATT-AGE > +0)
 13948        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13949        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13950           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13951           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13952           MOVE '1'              TO DC-OPTION-CODE
 13953           PERFORM 8500-DATE-CONVERT
 13954                                 THRU 8500-EXIT
 13955           IF NO-CONVERSION-ERROR
 13956              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13957                 MOVE ER-2661       TO WS-ERROR
 13958*                PERFORM 9900-ERROR-FORMAT
 13959*                                THRU 9900-EXIT
 13960              END-IF
 13961           END-IF
 13962        ELSE
 13963           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13964           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13965              MOVE ER-2661       TO WS-ERROR
 13966*             PERFORM 9900-ERROR-FORMAT
 13967*                                THRU 9900-EXIT
 13968           ELSE
 13969              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13970                 MOVE ER-1570    TO WS-ERROR
 13971                 PERFORM 9900-ERROR-FORMAT
 13972                                 THRU 9900-EXIT
 13973              END-IF
 13974           END-IF
 13975        END-IF
 13976        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13977           MOVE PB-I-JOINT-BIRTHDAY
 13978                                 TO DC-BIN-DATE-1
 13979           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13980           MOVE '1'              TO DC-OPTION-CODE
 13981           PERFORM 8500-DATE-CONVERT
 13982                                 THRU 8500-EXIT
 13983           IF NO-CONVERSION-ERROR
 13984              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13985                 MOVE ER-2661       TO WS-ERROR
 13986*                PERFORM 9900-ERROR-FORMAT
 13987*                                THRU 9900-EXIT
 13988              END-IF
 13989           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 254
* EL050.cbl
 13990              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13991           END-IF
 13992        ELSE
 13993           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13994             (PB-I-LF-TERM / 12)
 13995           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13996              MOVE ER-2661       TO WS-ERROR
 13997*             PERFORM 9900-ERROR-FORMAT
 13998*                                THRU 9900-EXIT
 13999           ELSE
 14000              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14001                 MOVE ER-1571    TO WS-ERROR
 14002                 PERFORM 9900-ERROR-FORMAT
 14003                                 THRU 9900-EXIT
 14004              END-IF
 14005           END-IF
 14006        END-IF
 14007        IF WS-ERROR = ER-2661
 14008           PERFORM 9900-ERROR-FORMAT
 14009                                 THRU 9900-EXIT
 14010        END-IF
 14011     END-IF
 14012*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14013*       MOVE ER-2661             TO WS-ERROR
 14014*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14015
 14016     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14017        MOVE ER-2662             TO WS-ERROR
 14018        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14019
 14020     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14021        MOVE ER-2677             TO WS-ERROR
 14022        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14023
 14024     IF CP-ERROR-LOAN-TERM
 14025        MOVE ER-2648             TO WS-ERROR
 14026        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14027
 14028 3221-CHECK-ERROR-RATE-OPEN.
 14029
 14030     IF CP-ERROR-RATE-FILE-NOTOPEN
 14031         GO TO 3990-FILES-NOT-OPEN.
 14032
 14033     IF PB-COMPANY-ID NOT = 'DMD'
 14034        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14035     END-IF
 14036     .
 14037 3221-CONTINUE.
 14038     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14039                                    WS-DCC-AH-RATE
 14040     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14041        IF WS-LF-BEN-CATEGORY = 'D'
 14042           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14043              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14044        END-IF
 14045     END-IF
 14046     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14047*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 255
* EL050.cbl
 14048     IF (PB-COMPANY-ID = 'CID')
 14049        AND (WS-LF-EARNINGS-CALC = 'B')
 14050        AND (CP-STATE-STD-ABBRV = 'MN')
 14051        AND (PB-CERT-EFF-DT > X'A4FF')
 14052        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14053     END-IF
 14054     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14055
 14056     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14057     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14058        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14059        AND (PB-I-POLICY-IS-MONTHLY)
 14060        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14061        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14062     END-IF
 14063     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14064     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14065     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14066     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14067     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14068        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14069        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14070        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14071        MOVE ER-2786             TO WS-ERROR
 14072        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14073     END-IF
 14074
 14075     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14076
 14077******************************************************************
 14078*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14079******************************************************************
 14080     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14081        and ((not pb-monthly-cert)
 14082        or (ws-lf-ben-category = 'C'))
 14083        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14084
 14085     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14086        GO TO 3225-CHECK-ALT-LIFE-RATE
 14087     ELSE
 14088       IF PB-I-LF-RATE = ZERO
 14089          MOVE ER-2641          TO WS-ERROR
 14090          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14091
 14092 3225-CHECK-ALT-LIFE-RATE.
 14093
 14094     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14095        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14096        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14097         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14098
 14099     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14100         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14101             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14102                   OR
 14103              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14104              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14105              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 256
* EL050.cbl
 14106             MOVE ER-2720        TO  WS-ERROR
 14107             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14108             GO TO 3225-RATING-CONT
 14109         ELSE
 14110             GO TO 3225-RATING-CONT.
 14111     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14112        AND (AM-GPCD = 01 OR 06 OR 15)
 14113        MOVE ER-2798             TO WS-ERROR
 14114        PERFORM 9900-ERROR-FORMAT
 14115                                 THRU 9900-EXIT
 14116*       GO TO 3225-RATING-CONT
 14117     END-IF
 14118     if (pb-company-id = 'CID')
 14119        and (ws-lf-earnings-calc = 'B')
 14120        and (ws-lf-ben-category = 'P' or 'I')
 14121        and (ws-net-only-state = 'Y')
 14122        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14123        display ' balloon prem ' pb-i-lf-alt-prem-calc
 14124        go to 3225-rating-cont
 14125     end-if
 14126     IF (PB-COMPANY-ID = 'CID')
 14127        AND (WS-LF-EARNINGS-CALC = 'B')
 14128        AND (CP-STATE-STD-ABBRV = 'MN')
 14129        AND (PB-CERT-EFF-DT > X'A4FF')
 14130        GO TO 3225-RATING-CONT
 14131     END-IF
 14132     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14133        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14134           AND (PB-I-POLICY-IS-MONTHLY)
 14135           GO TO 3225-RATING-CONT
 14136        END-IF
 14137     END-IF
 14138
 14139     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14140        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14141        CP-EARN-AS-REG-BALLOON
 14142        NEXT SENTENCE
 14143     ELSE
 14144        MOVE '2'                 TO CP-EARNING-METHOD.
 14145
 14146 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14147
 14148     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14149
 14150     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14151        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14152        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14153         NEXT SENTENCE
 14154     ELSE
 14155         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14156
 14157     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14158     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14159     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14160                                     CP-RATING-BENEFIT-AMT.
 14161     IF CP-STATE-STD-ABBRV = 'OR'
 14162         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14163                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 257
* EL050.cbl
 14164     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14165        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14166     END-IF
 14167     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14168     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14169     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14170                                    CP-REMAINING-TERM
 14171                                    CP-LOAN-TERM.
 14172     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14173        ADD +1                   TO CP-ORIGINAL-TERM
 14174                                    CP-REMAINING-TERM
 14175                                    CP-LOAN-TERM.
 14176
 14177     MOVE 'R'                   TO CP-RATE-FILE.
 14178     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14179
 14180     IF CP-ERROR-RATE-NOT-FOUND
 14181         MOVE ER-2641            TO WS-ERROR
 14182         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14183         GO TO 3300-CHECK-AH-RATES.
 14184
 14185     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14186     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14187
 14188     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14189         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14190
 14191     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14192                               + PB-I-LF-ALT-BENEFIT-AMT.
 14193
 14194     IF ACCOUNT-LIFE-CHECKED  OR
 14195        PB-POLICY-IS-VOIDED   OR
 14196        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14197        and (not pb-monthly-cert))
 14198        GO TO 3225-CONTINUE.
 14199
 14200     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14201        GO TO 3225-CONTINUE.
 14202
 14203     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14204                             EC-RT-LF-MAX-TOT-BEN
 14205        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14206        MOVE ER-2639       TO WS-ERROR
 14207        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14208
 14209 3225-CONTINUE.
 14210     IF PB-I-LF-ALT-RATE = ZERO
 14211         MOVE ER-2659            TO WS-ERROR
 14212         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14213
 14214     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14215        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14216        MOVE ER-2698             TO WS-ERROR
 14217        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14218
 14219 3225-RATING-CONT.
 14220
 14221     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 258
* EL050.cbl
 14222        and (not pb-monthly-cert)
 14223         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14224         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14225         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14226            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14227            CONTINUE
 14228         ELSE
 14229            MOVE ER-2687         TO WS-ERROR
 14230            PERFORM 9900-ERROR-FORMAT
 14231                                 THRU 9900-EXIT
 14232         END-IF
 14233         GO TO 3290-EDIT-LF-REIN-RATE
 14234     END-IF
 14235
 14236* DMD RATING TEST
 14237     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14238         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14239         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14240         MOVE ER-2687                 TO WS-ERROR
 14241         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14242         GO TO 3290-EDIT-LF-REIN-RATE.
 14243
 14244 3230-CLIENT-MORT-CD-SPECIALS.
 14245
 14246     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14247     SET BIN-TO-GREG          TO TRUE.
 14248*    MOVE ' '                 TO DC-OPTION-CODE.
 14249     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14250     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14251
 14252 C-POS-3230-MORT-CD.
 14253     IF PB-COMPANY-ID = 'POS' AND
 14254        PB-SV-CARRIER = '2'
 14255         NEXT SENTENCE
 14256     ELSE
 14257         GO TO C-POS-3240-MORT-CD.
 14258
 14259     IF PB-SV-GROUPING = '030'
 14260        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14261         MOVE '2350' TO PB-I-MORT-CODE
 14262      ELSE
 14263         MOVE '3300' TO PB-I-MORT-CODE.
 14264
 14265
 14266 C-POS-3240-MORT-CD.
 14267     IF PB-COMPANY-ID = 'POS' AND
 14268        PB-SV-CARRIER = '1'
 14269         NEXT SENTENCE
 14270     ELSE
 14271         GO TO 3230-CONTINUE.
 14272
 14273     IF PB-SV-STATE = '45' OR '47'
 14274        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14275         MOVE '5200' TO PB-I-MORT-CODE
 14276     ELSE
 14277         MOVE '8300' TO PB-I-MORT-CODE.
 14278
 14279 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 259
* EL050.cbl
 14280
 14281     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14282        GO TO 3240-CONTINUE
 14283     END-IF
 14284
 14285     IF PB-CERT-EFF-DT > WS-971231
 14286        GO TO 3240-CONTINUE
 14287     END-IF
 14288
 14289     IF LF-BENEFIT-FOUND AND
 14290        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14291         MOVE 'F250'       TO PB-I-MORT-CODE
 14292     ELSE
 14293         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14294             MOVE '7250'   TO PB-I-MORT-CODE
 14295         ELSE
 14296             MOVE '4251'   TO PB-I-MORT-CODE
 14297         END-IF
 14298     END-IF
 14299
 14300     .
 14301 3240-CONTINUE.
 14302
 14303     IF PB-COMPANY-ID NOT = 'GNL'
 14304         GO TO 3256-CONTINUE.
 14305
 14306     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14307         MOVE 'A300' TO PB-I-MORT-CODE
 14308     ELSE
 14309         MOVE '8350' TO PB-I-MORT-CODE.
 14310
 14311 3256-CONTINUE.
 14312     IF PB-COMPANY-ID NOT = 'ABL'
 14313         GO TO 3260-EDIT-CONTINUE.
 14314
 14315     IF PB-I-LF-TERM GREATER THAN 59
 14316         MOVE 'F550' TO PB-I-MORT-CODE
 14317     ELSE
 14318         MOVE 'E550' TO PB-I-MORT-CODE.
 14319
 14320 3260-EDIT-CONTINUE.
 14321     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14322
 14323 3290-EDIT-LF-REIN-RATE.
 14324     IF LF-REIN-NSP-NOT-USED
 14325         GO TO 3290-RATING-CONT.
 14326
 14327     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14328        GO TO 3290-RATING-CONT.
 14329     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14330     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14331     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14332     MOVE '3'                   TO CP-PROCESS-TYPE.
 14333     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14334
 14335******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14336     IF PB-COMPANY-ID EQUAL 'CDL'
 14337         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 260
* EL050.cbl
 14338            CP-EARN-AS-NET-PAY)
 14339             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14340*            MOVE SPACE          TO DC-OPTION-CODE
 14341             SET BIN-TO-GREG     TO TRUE
 14342             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14343***  Y2K PROJ 7744
 14344             IF DC-GREG-DATE-CYMD GREATER 19931231
 14345                 MOVE '1'        TO CP-EARNING-METHOD.
 14346***  Y2K PROJ 7744
 14347*******
 14348
 14349     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14350     MOVE PB-SV-STATE           TO CP-STATE.
 14351     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14352     MOVE ZERO                  TO CP-DEVIATION-CODE
 14353                                   CP-RATE-DEV-PCT.
 14354     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14355     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14356                                   CP-RATING-BENEFIT-AMT.
 14357
 14358************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14359     IF PB-COMPANY-ID EQUAL 'NCB'
 14360         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14361            CP-EARN-AS-NET-PAY
 14362             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14363                 PB-I-LF-PREMIUM-AMT.
 14364************
 14365
 14366     IF CP-STATE-STD-ABBRV = 'OR'
 14367         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14368                                         PB-I-LF-ALT-BENEFIT-AMT.
 14369     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14370     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14371     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14372     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14373     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14374     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14375     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14376     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14377                                   CP-REMAINING-TERM
 14378                                   CP-LOAN-TERM.
 14379     IF CP-TRUNCATED-LIFE
 14380        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14381
 14382     IF CP-TERM-IS-DAYS
 14383         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14384     ELSE
 14385         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14386
 14387     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14388        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14389     END-IF
 14390     IF PB-COMPANY-ID NOT = 'TIC'
 14391          MOVE ZERO          TO CP-CLASS-CODE.
 14392
 14393     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14394
 14395     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 261
* EL050.cbl
 14396     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14397
 14398     IF CP-ERROR-RATE-NOT-FOUND
 14399        IF PB-I-OB
 14400           MOVE ER-2625      TO WS-ERROR
 14401           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14402           GO TO 3299-EDIT-CONTINUE
 14403        ELSE
 14404           MOVE ER-2643      TO WS-ERROR
 14405           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14406           GO TO 3299-EDIT-CONTINUE.
 14407
 14408     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14409
 14410     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14411     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14412
 14413     IF PB-I-LF-REI-RATE = ZERO
 14414         MOVE ER-2643        TO WS-ERROR
 14415         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14416
 14417 3290-CHECK-ALT-REIN-RATE.
 14418
 14419     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14420        GO TO 3290-RATING-CONT.
 14421
 14422     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14423     MOVE '2'                    TO CP-EARNING-METHOD.
 14424     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14425     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14426     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14427     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14428                                     CP-RATING-BENEFIT-AMT.
 14429     IF CP-STATE-STD-ABBRV = 'OR'
 14430         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14431                                         PB-I-LF-ALT-BENEFIT-AMT.
 14432     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14433        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14434     END-IF
 14435     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14436     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14437     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14438                                    CP-REMAINING-TERM
 14439                                    CP-LOAN-TERM.
 14440     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14441        ADD +1                   TO CP-ORIGINAL-TERM
 14442                                    CP-REMAINING-TERM
 14443                                    CP-LOAN-TERM.
 14444
 14445     MOVE 'R'                   TO CP-RATE-FILE.
 14446     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14447
 14448     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14449
 14450     IF PB-I-LF-ALT-REI-RATE = ZERO
 14451         MOVE ER-2643            TO WS-ERROR
 14452         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14453
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 262
* EL050.cbl
 14454 3290-RATING-CONT.
 14455
 14456     IF PB-I-OB
 14457*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14458        GO TO 3300-CHECK-AH-RATES.
 14459
 14460 3299-EDIT-CONTINUE.
 14461
 14462     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14463         NEXT SENTENCE
 14464     ELSE
 14465         MOVE ER-2620           TO WS-ERROR
 14466         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14467
 14468 3300-CHECK-AH-RATES.
 14469     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14470         NEXT SENTENCE
 14471     ELSE
 14472         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14473
 14474     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14475        and (not pb-monthly-cert))
 14476                  or
 14477        ((CF-COMPANY-ID = 'DMD') AND
 14478                (NO-DMD-RATING))
 14479         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14480            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14481            CONTINUE
 14482         ELSE
 14483            MOVE ER-2687         TO WS-ERROR
 14484            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14485         END-IF
 14486         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14487         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14488     END-IF
 14489
 14490     IF PB-I-OB
 14491        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14492
 14493     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14494         MOVE ER-2687             TO WS-ERROR
 14495         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14496         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14497         GO TO 3999-END-EDIT.
 14498
 14499*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14500     if pb-company-id = 'AHL'
 14501        go to 3300-skip-crit-per
 14502     end-if
 14503     if (pb-i-ah-crit-per not = zeros)
 14504        and (ws-ah-special-calc-cd not = 'C')
 14505        MOVE ER-1572             TO WS-ERROR
 14506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14507        go to 3300-skip-crit-per
 14508     END-IF
 14509     if (pb-company-id = 'DCC' or 'VPP')
 14510        and (am-dcc-product-code not = spaces)
 14511        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 263
* EL050.cbl
 14512     end-if
 14513     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14514        IF PB-I-AH-CRIT-PER = ZERO
 14515           move ws-ah-max-bens   to pb-i-ah-crit-per
 14516*          MOVE ER-2618       TO WS-ERROR
 14517*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14518*          GO TO 3999-END-EDIT
 14519        END-IF
 14520     END-IF
 14521     if (ws-ah-special-calc-cd = 'C')
 14522        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14523        MOVE ER-1576             TO WS-ERROR
 14524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14525     end-if
 14526
 14527     .
 14528 3300-skip-crit-per.
 14529     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14530     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14531     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14532     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14533     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14534     MOVE PB-SV-STATE            TO CP-STATE.
 14535     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14536     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14537     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14538*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14539     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14540     MOVE '3'                    TO CP-PROCESS-TYPE.
 14541     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14542     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14543                                    CP-RATING-BENEFIT-AMT.
 14544     IF PB-COMPANY-ID = 'CID'
 14545               OR
 14546        CP-STATE-STD-ABBRV = 'OR'
 14547         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14548                                         PB-I-AH-TERM.
 14549     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14550        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14551           AND (PB-I-POLICY-IS-MONTHLY)
 14552           MOVE PB-I-LF-BENEFIT-AMT
 14553                                 TO CP-NET-BENEFIT-AMT
 14554           move pb-i-ah-premium-amt to cp-original-premium
 14555           add pb-i-lf-premium-amt to cp-original-premium
 14556        END-IF
 14557     END-IF
 14558     MOVE SPACES                 TO CP-BEN-CATEGORY
 14559     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14560        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14561        EVALUATE TRUE
 14562           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14563              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14564              MOVE PB-I-LF-BENEFIT-AMT
 14565                                 TO CP-RATING-BENEFIT-AMT
 14566              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14567           WHEN WS-AH-BEN-CATEGORY = 'G'
 14568              MOVE PB-I-UNPAID-CASH-PRICE
 14569                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 264
* EL050.cbl
 14570           WHEN WS-AH-BEN-CATEGORY = 'D'
 14571              MOVE WS-AH-PMF-COMM
 14572                                 TO CP-DCC-PMF-COMM
 14573              MOVE PB-I-AH-COMMISSION
 14574                                 TO CP-DCC-ACT-COMM
 14575        END-EVALUATE
 14576     END-IF
 14577     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14578     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14579     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14580     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14581     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14582     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14583     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14584                                    CP-REMAINING-TERM
 14585                                    WS-WORK-TERM.
 14586     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14587
 14588     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14589     SET BIN-TO-GREG             TO TRUE.
 14590*    MOVE ' '                    TO DC-OPTION-CODE.
 14591     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14592     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14593
 14594     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14595     IF NOT VALID-SKIP-CODE
 14596         MOVE ER-2683            TO WS-ERROR
 14597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14598         GO TO 3320-RATE-CONTINUE.
 14599
 14600     IF PB-NO-MONTHS-SKIPPED
 14601         GO TO 3320-RATE-CONTINUE.
 14602
 14603     MOVE SPACE TO NUMBER-OF-MONTHS.
 14604
 14605     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14606         MOVE 'S'                TO SK-MO (6).
 14607     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14608         MOVE 'S'                TO SK-MO (7).
 14609     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14610         MOVE 'S'                TO SK-MO (8).
 14611     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14612         MOVE 'S'                TO SK-MO (9).
 14613     IF PB-I-SKIP-CODE = 'A'
 14614         MOVE 'S'                TO SK-MO (10).
 14615
 14616     MOVE 1                      TO SUB2.
 14617     MOVE PB-I-AH-TERM           TO SUB3.
 14618     MOVE WS-MONTH               TO SUB1.
 14619     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14620     GO TO 3320-RATE-CONTINUE.
 14621
 14622 3310-GET-SKIP-MO.
 14623     IF SUB1 = 13
 14624         MOVE 1                  TO SUB1.
 14625
 14626     IF SK-MO (SUB1) = 'S'
 14627         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 265
* EL050.cbl
 14628
 14629     ADD 1 TO SUB2
 14630              SUB1.
 14631
 14632 3320-RATE-CONTINUE.
 14633
 14634     IF WS-WORK-TERM = ZERO
 14635         MOVE 1                  TO WS-WORK-TERM.
 14636
 14637     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14638                                    CP-LOAN-TERM.
 14639
 14640     IF PB-COMPANY-ID EQUAL 'DMD'
 14641         NEXT SENTENCE
 14642     ELSE
 14643         MOVE ZERO               TO PB-I-AH-RATE
 14644                                    PB-I-AH-REI-RATE.
 14645
 14646
 14647     IF PB-COMPANY-ID EQUAL 'CRI'
 14648        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14649
 14650     IF PB-COMPANY-ID = 'CSL'
 14651         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14652         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14653         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14654         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14655
 14656     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14657        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14658           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14659              PB-I-RATE-DEV-PCT-LF
 14660        END-IF
 14661        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14662                                 TO CP-ALTERNATE-BENEFIT
 14663        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14664        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14665        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14666     END-IF
 14667*    if ws-clp-state not = spaces
 14668*       move ws-clp-state to cp-state
 14669*    end-if
 14670     IF (PB-COMPANY-ID = 'CID')
 14671        AND (WS-LF-EARNINGS-CALC = 'B')
 14672        AND (CP-STATE-STD-ABBRV = 'MN')
 14673        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14674     ELSE
 14675        MOVE ' '                 TO CP-AH-BALLOON-SW
 14676     END-IF
 14677     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14678     MOVE 'R'                   TO CP-RATE-FILE.
 14679     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14680
 14681     IF (CP-ERROR-RATE-NOT-FOUND)
 14682        and (not pb-monthly-cert)
 14683        IF PB-I-OB
 14684           MOVE ER-2624          TO WS-ERROR
 14685           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 266
* EL050.cbl
 14686           GO TO 3340-CALCULATE-PREMIUM-AMT
 14687        ELSE
 14688          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14689              NEXT SENTENCE
 14690          ELSE
 14691           MOVE ER-2642          TO WS-ERROR
 14692           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14693           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14694
 14695     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14696        CP-ERROR-DIV-BY-ZERO
 14697           MOVE ER-3782          TO WS-ERROR
 14698           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14699
 14700     IF PB-COMPANY-ID EQUAL 'CRI'
 14701        IF CP-ERROR-NO-LIMITS-CRI
 14702           IF NOT ACCOUNT-AH-CHECKED
 14703              MOVE ER-2607          TO WS-ERROR
 14704              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14705
 14706     IF ACCOUNT-AH-CHECKED
 14707        NEXT SENTENCE
 14708     ELSE
 14709       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14710          MOVE ER-2640           TO WS-ERROR
 14711          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14712
 14713     IF PB-COMPANY-ID = 'CRI'
 14714         IF WS-ERROR = ER-2640
 14715             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14716     IF ACCOUNT-AH-CHECKED
 14717        CONTINUE
 14718     ELSE
 14719        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14720           AND (CP-R-MAX-ATT-AGE > +0)
 14721           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14722           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14723              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14724              MOVE PB-I-AH-EXPIRE-DT
 14725                                 TO DC-BIN-DATE-2
 14726              MOVE '1'           TO DC-OPTION-CODE
 14727              PERFORM 8500-DATE-CONVERT
 14728                                 THRU 8500-EXIT
 14729              IF NO-CONVERSION-ERROR
 14730                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14731                    MOVE ER-2661       TO WS-ERROR
 14732*                   PERFORM 9900-ERROR-FORMAT
 14733*                                THRU 9900-EXIT
 14734                 END-IF
 14735              END-IF
 14736           ELSE
 14737              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14738              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14739                 MOVE ER-2661    TO WS-ERROR
 14740*                PERFORM 9900-ERROR-FORMAT
 14741*                                THRU 9900-EXIT
 14742              ELSE
 14743                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 267
* EL050.cbl
 14744                    MOVE ER-1570 TO WS-ERROR
 14745                    PERFORM 9900-ERROR-FORMAT
 14746                                 THRU 9900-EXIT
 14747                 END-IF
 14748              END-IF
 14749           END-IF
 14750           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14751              MOVE PB-I-JOINT-BIRTHDAY
 14752                                    TO DC-BIN-DATE-1
 14753              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14754              MOVE '1'              TO DC-OPTION-CODE
 14755              PERFORM 8500-DATE-CONVERT
 14756                                    THRU 8500-EXIT
 14757              IF NO-CONVERSION-ERROR
 14758                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14759                    MOVE ER-2661       TO WS-ERROR
 14760*                   PERFORM 9900-ERROR-FORMAT
 14761*                                   THRU 9900-EXIT
 14762                 END-IF
 14763              END-IF
 14764           ELSE
 14765              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14766                (PB-I-AH-TERM / 12)
 14767              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14768                 MOVE ER-2661       TO WS-ERROR
 14769*                PERFORM 9900-ERROR-FORMAT
 14770*                                   THRU 9900-EXIT
 14771              ELSE
 14772                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14773                    MOVE ER-1571 TO WS-ERROR
 14774                    PERFORM 9900-ERROR-FORMAT
 14775                                 THRU 9900-EXIT
 14776                 END-IF
 14777              END-IF
 14778           END-IF
 14779           IF WS-ERROR = ER-2661
 14780              PERFORM 9900-ERROR-FORMAT
 14781                                    THRU 9900-EXIT
 14782           END-IF
 14783        END-IF
 14784     END-IF
 14785*    IF ACCOUNT-AH-CHECKED
 14786*       NEXT SENTENCE
 14787*    ELSE
 14788*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14789*          MOVE ER-2661          TO WS-ERROR
 14790*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14791
 14792     IF ACCOUNT-AH-CHECKED
 14793        NEXT SENTENCE
 14794     ELSE
 14795        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14796           MOVE ER-2663          TO WS-ERROR
 14797           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14798
 14799     IF ACCOUNT-AH-CHECKED OR
 14800        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14801         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 268
* EL050.cbl
 14802        NEXT SENTENCE
 14803     ELSE
 14804        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14805           MOVE ER-2667            TO WS-ERROR
 14806           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14807
 14808     IF PB-COMPANY-ID = 'CRI'
 14809         IF WS-ERROR = ER-2667
 14810             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14811
 14812     IF ACCOUNT-AH-CHECKED
 14813        NEXT SENTENCE
 14814     ELSE
 14815        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14816           MOVE ER-2678            TO WS-ERROR
 14817           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14818
 14819     IF CP-ERROR-RATE-FILE-NOTOPEN
 14820         GO TO 3990-FILES-NOT-OPEN.
 14821
 14822 3321-CONTINUE.
 14823     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14824     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14825     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14826*    IF (PB-COMPANY-ID = 'DCC')
 14827        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14828        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14829                                    PB-I-LF-ALT-PREM-CALC
 14830        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14831        IF WS-AH-BEN-CATEGORY = 'G'
 14832           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14833           + PB-I-ADDL-CLP)
 14834           * (1 + WS-TOL-CLP-PCT)
 14835*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14836        ELSE
 14837           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14838           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14839*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14840        END-IF
 14841        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14842                                 TO PB-I-AH-PREM-CALC
 14843        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14844           MOVE ER-8152          TO WS-ERROR
 14845           PERFORM 9900-ERROR-FORMAT
 14846                                 THRU 9900-EXIT
 14847        ELSE
 14848           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14849                 PB-I-ADDL-CLP)
 14850              MOVE ER-8148       TO WS-ERROR
 14851              PERFORM 9900-ERROR-FORMAT
 14852                                 THRU 9900-EXIT
 14853           END-IF
 14854        END-IF
 14855     END-IF
 14856     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14857        AND (PB-I-POLICY-IS-MONTHLY)
 14858        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14859        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 269
* EL050.cbl
 14860        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14861           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14862        END-IF
 14863     END-IF
 14864     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14865        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14866        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14867        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14868        MOVE ER-2786             TO WS-ERROR
 14869        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14870     END-IF
 14871     MOVE +0                     TO PB-I-AH-CLP
 14872     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14873        evaluate true
 14874           when WS-AH-BEN-CATEGORY = 'D'
 14875              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14876                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14877           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14878              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14879           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14880              compute ws-cred-union-fees rounded =
 14881                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14882                    pb-i-ah-commission)
 14883              COMPUTE PB-I-AH-CLP =
 14884                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14885        end-evaluate
 14886     END-IF
 14887     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14888
 14889     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14890         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14891
 14892     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14893         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14894
 14895     if (ws-ah-special-calc-cd = 'E')
 14896        and (pb-monthly-cert)
 14897        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14898     end-if
 14899     IF PB-COMPANY-ID = 'CRI'
 14900         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14901            PB-I-PAYMENT-AMOUNT = ZERO
 14902             NEXT SENTENCE
 14903         ELSE
 14904             COMPUTE PB-I-AH-PREM-CALC =
 14905                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14906                 (CP-PREMIUM-RATE / 100)
 14907             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14908                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14909                                             PB-I-RATE-DEV-PCT-AH.
 14910
 14911     IF (PB-I-AH-RATE  = ZERO)
 14912        and (not pb-monthly-cert)
 14913       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14914           NEXT SENTENCE
 14915       ELSE
 14916         MOVE ER-2642            TO WS-ERROR
 14917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 270
* EL050.cbl
 14918
 14919     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14920     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14921     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14922     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14923     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14924     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14925
 14926     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14927        AND (WS-AH-BEN-CATEGORY = 'G')
 14928        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14929        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14930        IF CP-DEVIATION-CODE NOT = '000'
 14931           MOVE '000'            TO CP-DEVIATION-CODE
 14932           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14933           IF NO-CP-ERROR
 14934              COMPUTE PB-I-DDF-IU-RATE-UP =
 14935              PB-I-AH-CLP - CP-CALC-PREMIUM
 14936           ELSE
 14937              MOVE ER-3057        TO WS-ERROR
 14938              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14939           END-IF
 14940        END-IF
 14941     END-IF
 14942     .
 14943 3335-EDIT-AH-REIN-NSP-RATE.
 14944     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14945        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14946              compute ws-cred-union-fees rounded =
 14947                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14948                    pb-i-ah-commission)
 14949              COMPUTE PB-I-AH-CLP =
 14950                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14951        end-if
 14952     END-IF
 14953     IF AH-REIN-NSP-NOT-USED
 14954         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14955
 14956     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14957     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14958         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14959     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14960     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14961     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14962     MOVE PB-SV-STATE            TO CP-STATE.
 14963     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14964     MOVE ZERO                   TO CP-DEVIATION-CODE
 14965                                    CP-RATE-DEV-PCT.
 14966*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14967     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14968     MOVE '3'                    TO CP-PROCESS-TYPE.
 14969     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14970     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14971                                    CP-RATING-BENEFIT-AMT.
 14972     IF CP-STATE-STD-ABBRV = 'OR'
 14973         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14974                                         PB-I-AH-TERM.
 14975     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 271
* EL050.cbl
 14976     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14977     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14978     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14979     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14980     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14981                                    CP-REMAINING-TERM
 14982                                    WS-WORK-TERM.
 14983     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14984     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14985        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14986     END-IF
 14987     IF  PB-COMPANY-ID = 'TIC'
 14988         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14989            MOVE ZERO TO CP-CLASS-CODE.
 14990
 14991     IF PB-COMPANY-ID NOT = 'TIC'
 14992          MOVE ZERO          TO CP-CLASS-CODE.
 14993
 14994     MOVE ZERO               TO CP-DEVIATION-CODE.
 14995
 14996     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14997
 14998     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14999
 15000     MOVE 'R'                   TO CP-RATE-FILE.
 15001     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15002
 15003     IF CP-ERROR-RATE-NOT-FOUND
 15004         MOVE ER-2645        TO WS-ERROR
 15005         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15006         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15007
 15008     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15009
 15010     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15011     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15012
 15013     IF PB-I-AH-REI-RATE = ZERO
 15014         MOVE ER-2645        TO WS-ERROR
 15015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15016
 15017
 15018 3340-CALCULATE-PREMIUM-AMT.
 15019
 15020     IF PB-COMPANY-ID = 'NCL'
 15021         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15022             WS-AH-SPECIAL-CALC-CD = 'O')
 15023             GO TO 3999-END-EDIT.
 15024
 15025     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15026                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15027                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15028                         OR 'AHL'
 15029         NEXT SENTENCE
 15030     ELSE
 15031         IF WS-STATE-ABBREVIATION = 'CT'
 15032             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15033                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 272
* EL050.cbl
 15034                 COMPUTE PB-I-LF-PREM-CALC =
 15035                                     PB-I-LF-PREM-CALC * .90
 15036                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15037                                     PB-I-LF-ALT-PREM-CALC * .90
 15038                 COMPUTE PB-I-AH-PREM-CALC =
 15039                                     PB-I-AH-PREM-CALC * .90.
 15040
 15041     IF PB-COMP-LF-PREM
 15042        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15043        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15044
 15045     IF PB-COMP-AH-PREM
 15046        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15047
 15048 3340-CHECK-DCC-TOT-FEES.
 15049     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15050        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15051        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15052        AND (PB-I-POLICY-IS-MONTHLY)
 15053        CONTINUE
 15054     ELSE
 15055        GO TO 3340-EDIT-LF-AH-TOL
 15056     END-IF
 15057     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15058     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15059     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15060        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15061           PB-I-RATE-DEV-PCT-LF
 15062     END-IF
 15063     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15064        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15065           PB-I-RATE-DEV-PCT-AH
 15066     END-IF
 15067     MOVE 'N'                    TO CP-BEN-CATEGORY
 15068     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15069
 15070     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15071     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15072     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15073     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15074     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15075     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15076     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15077     MOVE '3'                    TO CP-PROCESS-TYPE.
 15078     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15079     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15080
 15081     MOVE PB-SV-STATE            TO CP-STATE.
 15082     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15083     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15084     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15085     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15086     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15087                                    CP-RATING-BENEFIT-AMT.
 15088     IF CP-STATE-STD-ABBRV = 'OR'
 15089         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15090                                         PB-I-LF-ALT-BENEFIT-AMT.
 15091     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 273
* EL050.cbl
 15092     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15093     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15094     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15095     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15096     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15097     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15098     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15099     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15100                                    CP-REMAINING-TERM
 15101                                    CP-LOAN-TERM.
 15102     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15103        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15104           PB-I-LF-PREMIUM-AMT
 15105     end-if
 15106
 15107     IF CP-TRUNCATED-LIFE
 15108        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15109
 15110     IF CP-TERM-IS-DAYS
 15111         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15112     ELSE
 15113         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15114
 15115     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15116     IF CP-SPECIAL-CALC-CD = 'H'
 15117         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15118                                    TO CP-ALTERNATE-BENEFIT
 15119         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15120     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15121     MOVE 'R'                    TO CP-RATE-FILE
 15122     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15123     IF NOT CP-ERROR-RATE-NOT-FOUND
 15124        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15125        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15126           AND (CP-BENEFIT-CD (1:1) = 'S')
 15127           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15128                                    PB-I-LF-PREMIUM-AMT
 15129        END-IF
 15130     ELSE
 15131        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15132     END-IF
 15133     .
 15134 3340-EDIT-LF-AH-TOL.
 15135
 15136***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15137***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15138***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15139***
 15140     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15141         PB-I-AH-PREMIUM-AMT
 15142          GIVING WS-CALC-WORK.
 15143
 15144     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15145        AND WS-CALC-WORK NOT = ZERO
 15146         MOVE ER-2649            TO WS-ERROR
 15147         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15148
 15149     SUBTRACT PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 274
* EL050.cbl
 15150             FROM PB-I-LF-PREMIUM-AMT
 15151                 GIVING WS-UNSIGN-WRK1.
 15152
 15153     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15154             FROM PB-I-LF-ALT-PREMIUM-AMT
 15155                 GIVING WS-UNSIGN-WRK4.
 15156
 15157     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15158                                + WS-UNSIGN-WRK4.
 15159
 15160     SUBTRACT PB-I-AH-PREM-CALC
 15161             FROM PB-I-AH-PREMIUM-AMT
 15162                 GIVING WS-UNSIGN-WRK2.
 15163
 15164******************************************************************
 15165*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15166******************************************************************
 15167
 15168     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15169         MOVE ZERO TO WS-UNSIGN-WRK1.
 15170
 15171     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15172         MOVE ZERO TO WS-UNSIGN-WRK2.
 15173
 15174     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15175             GIVING WS-UNSIGN-WRK3.
 15176
 15177 3342-CONTINUE.
 15178
 15179     IF (PB-I-LF-RATE = ZERO  AND
 15180         PB-I-AH-RATE = ZERO)
 15181         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15182            WS-AH-SPECIAL-CALC-CD = 'O'
 15183              NEXT SENTENCE
 15184         ELSE
 15185             GO TO 3345-EDIT-CONTINUE.
 15186
 15187     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15188         NEXT SENTENCE
 15189     ELSE
 15190     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15191        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15192           IF (PB-REISSUED-CERT         OR
 15193               PB-POLICY-IS-DECLINED    OR
 15194               PB-POLICY-IS-VOIDED)
 15195              NEXT SENTENCE
 15196           ELSE
 15197              IF WS-PREM-REJECT-SW = SPACE
 15198                 MOVE ER-2652    TO WS-ERROR
 15199                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15200                 GO TO 3344-CHECK-AH
 15201              ELSE
 15202                 MOVE ER-2650    TO WS-ERROR
 15203                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15204                 GO TO 3344-CHECK-AH.
 15205
 15206***
 15207***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 275
* EL050.cbl
 15208***
 15209
 15210     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15211         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15212            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15213             (1 + WS-TOL-LF-PREM-PCT)
 15214         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15215            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15216             (1 - WS-TOL-LF-PREM-PCT)
 15217     ELSE
 15218         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15219         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15220
 15221***
 15222***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15223***
 15224
 15225     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15226         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15227          WS-TOL-LF-PREM.
 15228
 15229     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15230         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15231          WS-TOL-LF-PREM.
 15232
 15233     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15234        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15235
 15236     IF PB-REISSUED-CERT
 15237        or PB-POLICY-IS-DECLINED
 15238        or PB-POLICY-IS-VOIDED
 15239        continue
 15240     ELSE
 15241        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15242              > WS-TOL-LF-HIGH-PREM-AMT)
 15243           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15244              < WS-TOL-LF-LOW-PREM-AMT))
 15245                      or
 15246           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15247              > WS-TOL-LF-HIGH-PREM-PCT)
 15248           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15249              < WS-TOL-LF-LOW-PREM-PCT))
 15250           IF WS-PREM-REJECT-SW = SPACE
 15251              MOVE ER-2652       TO WS-ERROR
 15252              PERFORM 9900-ERROR-FORMAT
 15253                                 THRU 9900-EXIT
 15254           ELSE
 15255              MOVE ER-2650       TO WS-ERROR
 15256              PERFORM 9900-ERROR-FORMAT
 15257                                 THRU 9900-EXIT
 15258           end-if
 15259        end-if
 15260     end-if
 15261
 15262*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15263*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15264*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15265*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 276
* EL050.cbl
 15266
 15267     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15268        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15269                      OR
 15270           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15271           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15272           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15273           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15274        END-IF
 15275     END-IF
 15276
 15277     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15278        IF WS-COMP-MAX-CAP GREATER THAN +0
 15279           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15280              IF (PB-REISSUED-CERT         OR
 15281                  PB-POLICY-IS-DECLINED    OR
 15282                  PB-POLICY-IS-VOIDED)
 15283                 NEXT SENTENCE
 15284              ELSE
 15285                  MOVE ER-2646   TO  WS-ERROR
 15286                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15287
 15288 3344-CVL-TOLERANCE-CHECK.
 15289
 15290      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15291          GO TO 3344-CHECK-AH.
 15292
 15293      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15294          GO TO 3344-CHECK-AH.
 15295
 15296      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15297                                     WS-UNSIGN-WRK6.
 15298
 15299      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15300          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15301                                 + PB-I-LF-PREMIUM-AMT
 15302                                 - PB-I-LF-PREM-CALC.
 15303
 15304      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15305          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15306                                 + PB-I-LF-ALT-PREMIUM-AMT
 15307                                 - PB-I-LF-ALT-PREM-CALC.
 15308
 15309      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15310          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15311              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15312                 MOVE ER-2652    TO  WS-ERROR
 15313                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15314              ELSE
 15315                 MOVE ER-2650    TO  WS-ERROR
 15316                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15317
 15318      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15319          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15320              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15321                 MOVE ER-2652    TO  WS-ERROR
 15322                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15323              ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 277
* EL050.cbl
 15324                 MOVE ER-2650    TO  WS-ERROR
 15325                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15326
 15327 3344-CHECK-AH.
 15328
 15329****************************************************************
 15330***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15331***
 15332
 15333     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15334         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15335             (1 + WS-TOL-AH-PREM-PCT)
 15336         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15337             (1 - WS-TOL-AH-PREM-PCT)
 15338     ELSE
 15339         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15340         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15341
 15342***
 15343***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15344***
 15345
 15346     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15347         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15348
 15349     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15350         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15351
 15352     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15353        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15354
 15355     IF (PB-REISSUED-CERT)
 15356        OR (PB-POLICY-IS-DECLINED)
 15357        OR (PB-POLICY-IS-VOIDED)
 15358        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15359        CONTINUE
 15360     ELSE
 15361        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15362              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15363                          or
 15364           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15365              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15366           IF WS-PREM-REJECT-SW = SPACE
 15367              MOVE ER-3052       TO WS-ERROR
 15368              PERFORM 9900-ERROR-FORMAT
 15369                                 THRU 9900-EXIT
 15370           ELSE
 15371              MOVE ER-3050       TO WS-ERROR
 15372              PERFORM 9900-ERROR-FORMAT
 15373                                 THRU 9900-EXIT
 15374           END-IF
 15375        END-IF
 15376     END-IF
 15377     if (pb-company-id = 'DCC' or 'VPP')
 15378        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15379        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15380        and (pb-i-policy-is-monthly)
 15381        compute ws-tol-ah-high-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 278
* EL050.cbl
 15382           pb-i-tot-fees-calc + ws-tol-ah-prem
 15383        compute ws-tol-ah-low-prem-amt =
 15384           pb-i-tot-fees-calc - ws-tol-ah-prem
 15385        if ws-tol-ah-prem-pct > zeros
 15386           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15387              (1 + ws-tol-ah-prem-pct)
 15388           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15389              (1 - ws-tol-ah-prem-pct)
 15390        else
 15391           move +9999999.99      to ws-tol-ah-high-prem-pct
 15392           move +0               to ws-tol-ah-low-prem-pct
 15393        end-if
 15394        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15395            or
 15396           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15397                          or
 15398           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15399           or
 15400           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15401            move er-3049         to ws-error
 15402           perform 9900-error-format
 15403                                 thru 9900-exit
 15404
 15405        end-if
 15406     end-if
 15407     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15408         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15409             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15410             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15411
 15412     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15413        IF WS-COMP-MAX-CAP GREATER THAN +0
 15414           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15415              IF (PB-REISSUED-CERT         OR
 15416                  PB-POLICY-IS-DECLINED    OR
 15417                  PB-POLICY-IS-VOIDED)
 15418                 NEXT SENTENCE
 15419              ELSE
 15420                  MOVE ER-2646   TO  WS-ERROR
 15421                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15422
 15423     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15424        (WS-COMP-MAX-CAP EQUAL +0)
 15425           GO TO 3345-EDIT-CONTINUE.
 15426
 15427     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15428        GREATER THAN WS-COMP-MAX-CAP
 15429           MOVE ER-2646          TO  WS-ERROR
 15430           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15431
 15432 3345-EDIT-CONTINUE.
 15433
 15434*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15435*       IF PB-ENTRY-BATCH   NUMERIC
 15436*          IF PB-ISSUE
 15437*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15438*          ELSE
 15439*              IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 279
* EL050.cbl
 15440*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15441
 15442*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15443*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15444*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15445*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15446*        ELSE
 15447*            MOVE  ER-1909            TO  WS-ERROR
 15448*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15449
 15450     IF PB-I-POLICY-ACCEPTED
 15451        IF PB-POLICY-IS-DECLINED  OR
 15452           PB-REISSUED-CERT  OR
 15453           PB-REIN-ONLY-CERT  OR
 15454           PB-POLICY-IS-VOIDED
 15455            MOVE  ER-1891         TO  WS-ERROR
 15456            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15457        ELSE
 15458            MOVE SPACE            TO  PB-BATCH-ENTRY
 15459            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15460
 15461     IF PB-I-POLICY-DECLINED
 15462        IF PB-REISSUED-CERT  OR
 15463           PB-REIN-ONLY-CERT  OR
 15464           PB-POLICY-IS-VOIDED
 15465            MOVE  ER-1906         TO  WS-ERROR
 15466            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15467        ELSE
 15468            MOVE  'D'             TO  PB-BATCH-ENTRY
 15469                                      PB-I-ENTRY-STATUS.
 15470
 15471     IF PB-I-NEEDS-UNDERWRITING
 15472        IF PB-POLICY-IS-DECLINED OR
 15473           PB-REISSUED-CERT  OR
 15474           PB-REIN-ONLY-CERT  OR
 15475           PB-POLICY-IS-VOIDED
 15476            MOVE  ER-1907         TO  WS-ERROR
 15477            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15478        ELSE
 15479            MOVE 'U'              TO  PB-BATCH-ENTRY
 15480                                      PB-I-ENTRY-STATUS.
 15481
 15482     IF PB-NEEDS-UNDERWRITING
 15483        MOVE  ER-1901             TO  WS-ERROR
 15484        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15485     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15486        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15487        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15488        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15489           AND (NOT WS-LF-CASH))
 15490                           OR
 15491           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15492           AND (NOT WS-AH-CASH)))
 15493                       AND
 15494           (PB-I-ENTRY-STATUS NOT = '5')
 15495           MOVE 'M'              TO PB-BATCH-ENTRY
 15496                                    PB-I-ENTRY-STATUS
 15497        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 280
* EL050.cbl
 15498     END-IF
 15499     move pending-business       to ws-passed-erpndb
 15500     move ' '                    to ws-exceed-limit-yn
 15501     perform 7780-call-agg       thru 7780-exit
 15502*    display ' el050 exceed ' ws-exceed-limit-yn
 15503     if ws-exceed-limit-yn = 'Y'
 15504        MOVE  ER-9813            TO WS-ERROR
 15505        move 'Y'                 to ws-9813-sw
 15506        PERFORM  9900-ERROR-FORMAT
 15507                                 THRU 9900-EXIT
 15508     end-if
 15509     if (PB-EXCEEDED-LIMIT-FORCED)
 15510        and (ws-9813-sw = 'Y')
 15511        subtract +1 from PB-NO-OF-ERRORS
 15512        move er-9823             to ws-error
 15513        PERFORM  9900-ERROR-FORMAT
 15514                                 THRU 9900-EXIT
 15515     end-if
 15516     IF  PB-COMPANY-ID NOT = 'NCL'
 15517         GO TO 3999-END-EDIT.
 15518
 15519     IF PB-REISSUED-CERT  OR
 15520        PB-POLICY-IS-DECLINED  OR
 15521        PB-POLICY-IS-VOIDED  OR
 15522        PB-I-OB
 15523         GO TO 3999-END-EDIT.
 15524
 15525     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15526         MOVE  ER-2644            TO  WS-ERROR
 15527         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15528         GO TO 3999-END-EDIT.
 15529
 15530     MOVE 'N'                     TO  FORM-MASTER-SW.
 15531     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15532
 15533     IF NOT FORM-MASTER-FOUND
 15534         GO TO 3999-END-EDIT.
 15535
 15536     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15537                                      FORM-MASTER-AH-SW.
 15538
 15539     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15540         MOVE  +1                 TO SUB6
 15541         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15542
 15543     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15544         MOVE  +1                 TO SUB6
 15545         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15546
 15547     IF LF-FORM-MASTER-FOUND  OR
 15548        AH-FORM-MASTER-FOUND
 15549         GO TO 3360-CHECK-FORM-LIMITS
 15550     ELSE
 15551         GO TO 3999-END-EDIT.
 15552
 15553******************************************************************
 15554*                  3350-GET-ERFORM                               *
 15555*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 281
* EL050.cbl
 15556*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15557******************************************************************
 15558
 15559 3350-GET-ERFORM.
 15560
 15561     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15562         GO TO  3350-ERFORM-GETMAIN.
 15563
 15564     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15565     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15566     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15567     MOVE 'Y'                     TO FORM-MASTER-SW.
 15568
 15569     IF PB-CANCELLATION
 15570         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15571            PB-SV-STATE          EQUAL   FO-STATE       AND
 15572            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15573              GO TO 3350-EXIT
 15574         ELSE
 15575             NEXT SENTENCE
 15576     ELSE
 15577         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15578            PB-SV-STATE          EQUAL   FO-STATE       AND
 15579            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15580              GO TO 3350-EXIT.
 15581
 15582 3350-ERFORM-GETMAIN.
 15583
 15584     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15585     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15586
 15587 3350-ERFORM-READ.
 15588
 15589     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15590     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15591     IF PB-CANCELLATION
 15592         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15593     ELSE
 15594         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15595     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15596
 15597     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15598
 15599     IF FORM-MASTER-FOUND
 15600       IF PB-CANCELLATION
 15601          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15602             PB-SV-STATE          EQUAL   FO-STATE       AND
 15603             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15604              GO  TO 3350-EXIT
 15605          ELSE
 15606              NEXT SENTENCE
 15607       ELSE
 15608          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15609             PB-SV-STATE          EQUAL   FO-STATE       AND
 15610             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15611              GO  TO 3350-EXIT.
 15612
 15613     MOVE  'N'                    TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 282
* EL050.cbl
 15614     MOVE  ER-1895                TO  WS-ERROR.
 15615     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15616
 15617 3350-EXIT.
 15618      EXIT.
 15619
 15620******************************************************************
 15621*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15622*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15623*   VALID FOR THE POLICY FORM USED.                              *
 15624******************************************************************
 15625
 15626 3355-EDIT-FORM-LF-BENEFITS.
 15627
 15628     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15629        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15630         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15631         GO TO   3355-EXIT.
 15632
 15633     IF  SUB6    LESS THAN   +40
 15634         ADD  +1      TO  SUB6
 15635         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15636
 15637     MOVE  ER-1896         TO  WS-ERROR.
 15638     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15639
 15640 3355-EXIT.
 15641      EXIT.
 15642
 15643******************************************************************
 15644*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15645*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15646*   VALID FOR THE POLICY FORM USED.                              *
 15647******************************************************************
 15648
 15649 3356-EDIT-FORM-AH-BENEFITS.
 15650
 15651     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15652        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15653         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15654         GO TO  3356-EXIT.
 15655
 15656      IF  SUB6    LESS THAN     +40
 15657          ADD  +1      TO  SUB6
 15658          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15659
 15660     MOVE  ER-1897         TO  WS-ERROR.
 15661     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15662
 15663 3356-EXIT.
 15664      EXIT.
 15665
 15666******************************************************************
 15667*                  3357-BENEFIT-SEARCH                           *
 15668*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15669*   CANCELLATIONS ONLY.                                          *
 15670******************************************************************
 15671 3357-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 283
* EL050.cbl
 15672     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15673         MOVE +1                          TO SUB6
 15674         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15675
 15676     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15677         MOVE +1                          TO SUB6
 15678         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15679
 15680 3357-EXIT.
 15681     EXIT.
 15682
 15683******************************************************************
 15684*                  3358-BENEFIT-LIFE-SEARCH                      *
 15685*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15686*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15687*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15688******************************************************************
 15689 3358-BENEFIT-LIFE-SEARCH.
 15690     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15691       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15692         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15693           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15694              IF FO-PLAN-REFUND-METHOD (SUB6)
 15695                     IS GREATER THAN SPACES
 15696                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15697                                          WS-LF-REFUND-CALC
 15698                 GO TO 3358-EXIT.
 15699
 15700     IF SUB6 LESS THAN +40
 15701         ADD +1                 TO SUB6
 15702         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15703
 15704 3358-EXIT.
 15705     EXIT.
 15706******************************************************************
 15707*                  3359-BENEFIT-AH-SEARCH                        *
 15708*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15709*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15710*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15711******************************************************************
 15712 3359-BENEFIT-AH-SEARCH.
 15713     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15714       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15715         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15716           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15717              IF FO-PLAN-REFUND-METHOD (SUB6)
 15718                      IS GREATER THAN SPACES
 15719                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15720                                          WS-AH-REFUND-CALC
 15721                 GO TO 3359-EXIT.
 15722
 15723     IF SUB6 LESS THAN +40
 15724         ADD +1                 TO SUB6
 15725         GO TO 3359-BENEFIT-AH-SEARCH.
 15726
 15727 3359-EXIT.
 15728     EXIT.
 15729
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 284
* EL050.cbl
 15730******************************************************************
 15731*                  3360-CHECK-FORM-LIMITS                        *
 15732*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15733*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15734******************************************************************
 15735
 15736 3360-CHECK-FORM-LIMITS.
 15737
 15738     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15739         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15740
 15741     IF NOT LF-FORM-MASTER-FOUND
 15742         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15743
 15744 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15745
 15746     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15747       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15748        WS-LF-JOINT-INDICATOR = 'J'  AND
 15749        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15750         IF PB-COMPANY-ID = 'NCL'
 15751            MOVE  ER-1911          TO  WS-ERROR
 15752            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15753         ELSE
 15754            MOVE  ER-1892          TO  WS-ERROR
 15755            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15756
 15757 3360-CHECK-FORM-LF-ATT-AGE.
 15758
 15759     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15760
 15761     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15762         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15763         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15764            IF PB-COMPANY-ID = 'NCL'
 15765                MOVE  ER-1913      TO  WS-ERROR
 15766                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15767            ELSE
 15768                MOVE  ER-1894      TO  WS-ERROR
 15769                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15770
 15771 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15772
 15773     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15774         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15775         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15776            IF PB-COMPANY-ID = 'NCL'
 15777                MOVE  ER-1914      TO  WS-ERROR
 15778                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15779            ELSE
 15780                MOVE  ER-1899      TO  WS-ERROR
 15781                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15782
 15783 3360-CHECK-FORM-LF-TERM-BAMT.
 15784
 15785     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15786         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15787         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 285
* EL050.cbl
 15788           IF  PB-COMPANY-ID = 'NCL'
 15789               MOVE  ER-1916       TO  WS-ERROR
 15790               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15791           ELSE
 15792               MOVE  ER-1902       TO  WS-ERROR
 15793               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15794
 15795     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15796                                    PB-I-LF-ALT-BENEFIT-AMT.
 15797
 15798     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15799         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15800         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15801             IF  PB-COMPANY-ID = 'NCL'
 15802                 MOVE  ER-1918     TO  WS-ERROR
 15803                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15804             ELSE
 15805                 MOVE  ER-1904     TO  WS-ERROR
 15806                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15807
 15808******************************************************************
 15809*                  3360-CHECK-FORM-AH-LIMITS                     *
 15810*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15811*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15812******************************************************************
 15813
 15814 3360-CHECK-FORM-AH-LIMITS.
 15815
 15816     IF NOT AH-FORM-MASTER-FOUND
 15817         GO TO 3999-END-EDIT.
 15818
 15819 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15820
 15821     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15822       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15823        WS-AH-JOINT-INDICATOR = 'J'  AND
 15824        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15825         IF PB-COMPANY-ID = 'NCL'
 15826            MOVE  ER-1912          TO  WS-ERROR
 15827            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15828         ELSE
 15829            MOVE  ER-1893          TO  WS-ERROR
 15830            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15831
 15832 3360-CHECK-FORM-AH-ATT-AGE.
 15833
 15834     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15835
 15836     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15837         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15838         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15839            IF PB-COMPANY-ID = 'NCL'
 15840                MOVE  ER-1913      TO  WS-ERROR
 15841                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15842            ELSE
 15843                MOVE  ER-1894      TO  WS-ERROR
 15844                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15845
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 286
* EL050.cbl
 15846 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15847
 15848     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15849         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15850         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15851            IF PB-COMPANY-ID = 'NCL'
 15852                MOVE  ER-1915      TO  WS-ERROR
 15853                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15854            ELSE
 15855                MOVE  ER-1900      TO  WS-ERROR
 15856                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15857
 15858 3360-CHECK-FORM-AH-TERM-BAMT.
 15859
 15860     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15861         FO-AH-MAX-TERM    GREATER THAN  +0
 15862         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15863             IF  PB-COMPANY-ID = 'NCL'
 15864                 MOVE  ER-1917     TO  WS-ERROR
 15865                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15866             ELSE
 15867                  MOVE  ER-1903    TO  WS-ERROR
 15868                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15869
 15870     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15871         FO-MAX-AH-AMT    GREATER THAN  +0
 15872         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15873             IF  PB-COMPANY-ID = 'NCL'
 15874                 MOVE  ER-1919     TO  WS-ERROR
 15875                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15876             ELSE
 15877                 MOVE  ER-1905     TO  WS-ERROR
 15878                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15879
 15880     GO TO 3999-END-EDIT.
 15881
 15882******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 287
* EL050.cbl
 15884 3400-edit-vin.
 15885
 15886     move spaces                 to hldi-pass-area
 15887     MOVE PB-I-VIN               TO WS-WORK-VIN
 15888     MOVE +8                     TO V2
 15889     MOVE ZEROS                  TO WS-VIN-TOTAL
 15890     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15891      (V1 > 17)
 15892        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15893           MOVE ER-3825          TO WS-ERROR
 15894           PERFORM 9900-ERROR-FORMAT
 15895                                 THRU 9900-EXIT
 15896        ELSE
 15897           IF V1 = 8
 15898              MOVE 10            TO V2
 15899           END-IF
 15900           IF V1 = 9
 15901              MOVE 0             TO V2
 15902           END-IF
 15903           IF V1 = 10
 15904              MOVE 9             TO V2
 15905           END-IF
 15906           IF WS-WORK-VIN (V1:1) NUMERIC
 15907              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15908               + (WS-WORK-VIN-N (V1) * V2)
 15909           ELSE
 15910              MOVE WS-WORK-VIN (V1:1)
 15911                            TO WS-HEX-BYTE
 15912              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15913              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15914               + (WS-NUM (V3) * V2)
 15915           END-IF
 15916           COMPUTE V2 = V2 - 1
 15917        END-IF
 15918     END-PERFORM
 15919     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15920     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15921        REMAINDER WS-VIN-REMAINDER
 15922     IF ((WS-WORK-VIN (9:1) = 'X')
 15923        AND (WS-VIN-REMAINDER = 10))
 15924                OR
 15925        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15926        if pb-company-id = 'VPP'
 15927           perform 3410-check-with-hldi
 15928                                 thru 3410-exit
 15929        end-if
 15930     ELSE
 15931        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15932           MOVE ER-3826          TO WS-ERROR
 15933           PERFORM 9900-ERROR-FORMAT
 15934                                 THRU 9900-EXIT
 15935        ELSE
 15936           MOVE ER-3827          TO WS-ERROR
 15937           PERFORM 9900-ERROR-FORMAT
 15938                                 THRU 9900-EXIT
 15939        END-IF
 15940     END-IF
 15941
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 288
* EL050.cbl
 15942     .
 15943 3400-exit.
 15944     exit.
 15945 3410-check-with-hldi.
 15946     move spaces                 to hldi-pass-area
 15947     move pb-i-vin               to pa-vin
 15948     perform 7785-call-hldi      thru 7785-exit
 15949*    display 'PA-VIN        ' PA-VIN
 15950*    display 'PA-ErrorCode  ' PA-ErrorCode
 15951*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 15952*    display 'PA-ModelYear  ' PA-ModelYear
 15953*    display 'PA-MakeName   ' PA-MakeName
 15954*    display 'PA-ModelName  ' PA-ModelName
 15955*    display 'PA-SeriesName ' PA-SeriesName
 15956     if pa-errorcode (1:1) not = '0'
 15957        move spaces              to hldi-pass-area
 15958        move pb-i-vin            to pa-vin
 15959*       move pa-errordesc        to pa-seriesname
 15960*       perform 7786-call-hldim  thru 7786-exit
 15961*       display 'PA-VIN        ' PA-VIN
 15962*       display 'PA-ErrorCode  ' PA-ErrorCode
 15963*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 15964*       display 'PA-ModelYear  ' PA-ModelYear
 15965*       display 'PA-MakeName   ' PA-MakeName
 15966*       display 'PA-ModelName  ' PA-ModelName
 15967*       display 'PA-SeriesName ' PA-SeriesName
 15968     end-if
 15969     .
 15970 3410-exit.
 15971     exit.
 15972******************************************************************
 15973*                  E D I T   C A N C E L                         *
 15974******************************************************************
 15975
 15976 3700-EDIT-CANCEL.
 15977     IF PB-COMPANY-ID = 'DMD'
 15978         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15979                                         WS-RES-MUNI-TAX
 15980                                         PB-CI-STATE-TAX
 15981                                         PB-CI-MUNI-TAX
 15982         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15983
 15984*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15985*       IF PB-ENTRY-BATCH  NUMERIC
 15986*          IF PB-CANCELLATION
 15987*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15988*          ELSE
 15989*             IF PB-ISSUE
 15990*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15991
 15992     IF PB-C-INT-ON-REFS NOT NUMERIC
 15993        MOVE ZEROS               TO PB-C-INT-ON-REFS
 15994     END-IF
 15995*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15996*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15997
 15998     IF CM-ENTRY-STATUS = 'V'
 15999        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 289
* EL050.cbl
 16000        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16001        GO TO 3999-END-EDIT.
 16002
 16003     IF CM-ENTRY-STATUS = 'D'
 16004        MOVE ER-2781             TO WS-ERROR
 16005        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16006        GO TO 3999-END-EDIT.
 16007
 16008     IF CM-ENTRY-STATUS = 'U'
 16009        MOVE ER-2782             TO WS-ERROR
 16010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16011
 16012***************************************************************
 16013*                                                             *
 16014*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16015*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16016*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16017*   OF ANOTHER COVERAGE.                                      *
 16018*                                                             *
 16019***************************************************************
 16020
 16021     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16022                                    PB-C-AH-CANCEL-VOID-SW.
 16023
 16024     if pb-company-id = 'DCC' or 'VPP'
 16025        if ((pb-ci-lf-cancel-amt <> zeros)
 16026                       or
 16027            (pb-ci-ah-cancel-amt <> zeros))
 16028           MOVE ER-3068          TO WS-ERROR
 16029           PERFORM 9900-ERROR-FORMAT
 16030                                 THRU 9900-EXIT
 16031           GO TO 3999-END-EDIT
 16032        end-if
 16033     end-if
 16034     IF PB-C-LF-CANCEL-AMT = ZERO
 16035        NEXT SENTENCE
 16036     ELSE
 16037        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16038           AND
 16039           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16040               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16041               MOVE ER-2745           TO WS-ERROR
 16042               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16043
 16044     IF PB-C-AH-CANCEL-AMT = ZERO
 16045        NEXT SENTENCE
 16046     ELSE
 16047        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16048           AND
 16049           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16050               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16051               MOVE ER-2745           TO WS-ERROR
 16052               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16053
 16054     IF WS-LF-EARNINGS-CALC = '4'
 16055        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16056
 16057     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 290
* EL050.cbl
 16058     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16059     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16060     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16061     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16062     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16063
 16064     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16065                                      PB-C-AH-REF-CALC.
 16066     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16067
 16068******************************************************************
 16069*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16070*             TO VALIDATE COVERAGE.                              *
 16071******************************************************************
 16072
 16073     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16074        PB-C-LF-CANCEL-AMT = ZEROS
 16075          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16076      ELSE
 16077          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16078
 16079     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16080        PB-C-AH-CANCEL-AMT = ZEROS
 16081          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16082      ELSE
 16083          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16084
 16085     EVALUATE TRUE
 16086         WHEN PB-CANCEL-FORCE             OR
 16087              PB-CANCEL-DATE-FORCED       OR
 16088              PB-FORCE-OFF
 16089                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16090                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16091                  END-IF
 16092         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16093               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16094              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16095                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16096         WHEN OTHER
 16097              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16098                 MOVE ER-2794              TO WS-ERROR
 16099              ELSE
 16100                 MOVE ER-2749              TO WS-ERROR
 16101              END-IF
 16102              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16103     END-EVALUATE.
 16104
 16105
 16106*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16107*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16108*            MOVE  ER-1909            TO  WS-ERROR
 16109*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16110*        ELSE
 16111*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16112
 16113     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16114     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16115        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 291
* EL050.cbl
 16116     ELSE
 16117        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16118     END-IF
 16119     .
 16120 3705-EDIT-CANCEL-DT.
 16121
 16122     IF LF-COVERAGE-CANCELLED
 16123        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16124         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16125         MOVE WS-CURRENT-MONTH-END
 16126                                 TO DC-BIN-DATE-2
 16127         SET ELAPSED-BETWEEN-BIN TO TRUE
 16128*        MOVE 1                  TO DC-OPTION-CODE
 16129         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16130         IF DATE-CONVERSION-ERROR
 16131            NEXT SENTENCE
 16132          ELSE
 16133             IF DC-ELAPSED-DAYS GREATER +180
 16134                IF PB-CANCEL-DATE-FORCED  OR
 16135                   PB-CANCEL-DATE-FORCED-NO-FEE
 16136                      MOVE ER-2751  TO WS-ERROR
 16137                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16138                 ELSE
 16139                   MOVE ER-2752  TO WS-ERROR
 16140                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16141
 16142     IF AH-COVERAGE-CANCELLED
 16143        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16144         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16145         MOVE WS-CURRENT-MONTH-END
 16146                                 TO DC-BIN-DATE-2
 16147         SET ELAPSED-BETWEEN-BIN TO TRUE
 16148*        MOVE 1                  TO DC-OPTION-CODE
 16149         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16150         IF DATE-CONVERSION-ERROR
 16151            NEXT SENTENCE
 16152          ELSE
 16153             IF DC-ELAPSED-DAYS GREATER +180
 16154                IF PB-CANCEL-DATE-FORCED OR
 16155                   PB-CANCEL-DATE-FORCED-NO-FEE
 16156                      MOVE ER-2751  TO WS-ERROR
 16157                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16158                 ELSE
 16159                   MOVE ER-2752  TO WS-ERROR
 16160                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16161
 16162     IF WS-ERROR = ER-2752
 16163        AND (PB-COMPANY-ID = 'ABL'
 16164         OR  PB-COMPANY-ID = 'FGL'
 16165         OR  PB-COMPANY-ID = 'IST'
 16166         OR  PB-COMPANY-ID = 'JHL'
 16167         OR  PB-COMPANY-ID = 'LAP'
 16168         OR  PB-COMPANY-ID = 'LBL'
 16169         OR  PB-COMPANY-ID = 'NCB'
 16170         OR  PB-COMPANY-ID = 'NLI'
 16171         OR  PB-COMPANY-ID = 'OFI'
 16172         OR  PB-COMPANY-ID = 'PLI'
 16173         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 292
* EL050.cbl
 16174         OR  PB-COMPANY-ID = 'TIC'
 16175         OR  PB-COMPANY-ID = 'HER'
 16176         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16177         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16178            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16179            MOVE ER-2762     TO WS-ERROR
 16180            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16181
 16182     IF LF-COVERAGE-CANCELLED
 16183        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16184        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16185             MOVE ER-2733         TO WS-ERROR
 16186             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16187
 16188     IF AH-COVERAGE-CANCELLED
 16189        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16190        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16191              MOVE ER-2733        TO WS-ERROR
 16192              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16193
 16194     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16195        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16196        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16197           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16198            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16199              IF PB-COMPANY-ID NOT = 'LAP'
 16200               MOVE ER-2704            TO WS-ERROR
 16201               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16202
 16203     IF CERT-WAS-NOT-FOUND
 16204         GO TO 3999-END-EDIT.
 16205
 16206     IF PB-COMPANY-ID EQUAL 'CDC'
 16207        IF LF-COVERAGE-CANCELLED
 16208           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16209            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16210            MOVE PB-C-LF-CANCEL-DT
 16211                                 TO DC-BIN-DATE-2
 16212            SET ELAPSED-BETWEEN-BIN TO TRUE
 16213*           MOVE 1               TO DC-OPTION-CODE
 16214            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16215            IF DATE-CONVERSION-ERROR
 16216               NEXT SENTENCE
 16217             ELSE
 16218                IF DC-ELAPSED-DAYS GREATER +60
 16219                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16220
 16221     IF PB-COMPANY-ID EQUAL 'CDC'
 16222        IF AH-COVERAGE-CANCELLED
 16223           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16224            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16225            MOVE PB-C-AH-CANCEL-DT
 16226                                 TO DC-BIN-DATE-2
 16227            MOVE +0              TO DC-ELAPSED-DAYS
 16228                                    DC-ELAPSED-MONTHS
 16229            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16230*           MOVE 1               TO DC-OPTION-CODE
 16231            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 293
* EL050.cbl
 16232            IF DATE-CONVERSION-ERROR
 16233               NEXT SENTENCE
 16234             ELSE
 16235                IF DC-ELAPSED-DAYS GREATER +60
 16236                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16237
 16238     MOVE +0                     TO DC-ELAPSED-DAYS
 16239                                    DC-ELAPSED-MONTHS.
 16240
 16241     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16242        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16243          MOVE 'Z'                TO PB-CI-OB-FLAG
 16244          MOVE ER-2767            TO WS-ERROR
 16245          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16246          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16247          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16248          GO TO 3775-OVER-REF-CHK
 16249        ELSE
 16250          MOVE ZEROS              TO PB-CI-LIVES
 16251                                     PB-C-LIVES
 16252          IF PB-CI-OB-FLAG NOT = 'B'
 16253             MOVE SPACE           TO PB-CI-OB-FLAG.
 16254
 16255     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16256         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16257     ELSE
 16258         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16259
 16260     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16261        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16262            MOVE ER-2760         TO WS-ERROR
 16263            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16264
 16265     IF LF-COVERAGE-CANCELLED
 16266        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16267         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16268            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16269               MOVE ER-2774       TO WS-ERROR
 16270               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16271
 16272     IF AH-COVERAGE-CANCELLED
 16273        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16274         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16275            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16276               MOVE ER-2775       TO WS-ERROR
 16277               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16278
 16279     IF LF-COVERAGE-CANCELLED
 16280        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16281         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16282            MOVE ER-2776         TO WS-ERROR
 16283            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16284
 16285     IF AH-COVERAGE-CANCELLED
 16286        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16287         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16288            MOVE ER-2777         TO WS-ERROR
 16289            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 294
* EL050.cbl
 16290
 16291     IF LF-COVERAGE-CANCELLED
 16292        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16293        if pb-ci-lf-expire-dt = low-values or spaces
 16294           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16295           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16296           MOVE PB-CI-EXTENTION-DAYS
 16297                                 TO DC-ELAPSED-DAYS
 16298           SET BIN-PLUS-ELAPSED  TO TRUE
 16299           PERFORM 8500-DATE-CONVERT
 16300                                 THRU 8500-EXIT
 16301           IF DATE-CONVERSION-ERROR
 16302              move low-values    to dc-bin-date-2
 16303           end-if
 16304        else
 16305           move pb-ci-lf-expire-dt
 16306                                 to dc-bin-date-2
 16307        end-if
 16308        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16309           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16310                             OR  'FIA'
 16311              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16312           ELSE
 16313              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16314              MOVE ER-2731       TO WS-ERROR
 16315              PERFORM 9900-ERROR-FORMAT
 16316                                 THRU 9900-EXIT
 16317           end-if
 16318        end-if
 16319     end-if
 16320*    IF LF-COVERAGE-CANCELLED
 16321*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16322*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16323*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16324*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16325*        SET BIN-PLUS-ELAPSED      TO TRUE
 16326*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16327*        IF DATE-CONVERSION-ERROR
 16328*           NEXT SENTENCE
 16329*         ELSE
 16330*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16331*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16332*                            OR  'FIA'
 16333*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16334*              ELSE
 16335*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16336*               MOVE ER-2731       TO WS-ERROR
 16337*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16338     .
 16339 3705-EDIT-AH-CANCEL-DT.
 16340     IF AH-COVERAGE-CANCELLED
 16341        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16342        if pb-ci-AH-expire-dt = low-values or spaces
 16343           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16344           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16345           MOVE PB-CI-EXTENTION-DAYS
 16346                                 TO DC-ELAPSED-DAYS
 16347           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 295
* EL050.cbl
 16348           PERFORM 8500-DATE-CONVERT
 16349                                 THRU 8500-EXIT
 16350           IF DATE-CONVERSION-ERROR
 16351              move low-values    to dc-bin-date-2
 16352           end-if
 16353        else
 16354           move pb-ci-ah-expire-dt
 16355                                 to dc-bin-date-2
 16356        end-if
 16357        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16358           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16359                             OR  'FIA'
 16360              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16361           ELSE
 16362              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16363              MOVE ER-2771       TO WS-ERROR
 16364              PERFORM 9900-ERROR-FORMAT
 16365                                 THRU 9900-EXIT
 16366           end-if
 16367        end-if
 16368     end-if
 16369*    IF AH-COVERAGE-CANCELLED
 16370*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16371*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16372*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16373*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16374**       MOVE 6                    TO DC-OPTION-CODE
 16375*        SET BIN-PLUS-ELAPSED      TO TRUE
 16376*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16377*        IF DATE-CONVERSION-ERROR
 16378*           NEXT SENTENCE
 16379*         ELSE
 16380*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16381*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16382*                             OR 'FIA'
 16383*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16384*             ELSE
 16385*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16386*              MOVE ER-2771       TO WS-ERROR
 16387*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16388     .
 16389 3705-EDIT-CONTINUED.
 16390
 16391*    IF LF-COVERAGE-CANCELLED
 16392*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16393*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16394*            MOVE ER-2727         TO WS-ERROR
 16395*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16396*
 16397*    IF AH-COVERAGE-CANCELLED
 16398*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16399*        IF PB-COMPANY-ID = 'ACE'
 16400*           MOVE ER-2727        TO WS-ERROR
 16401*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16402*        ELSE
 16403*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16404*              MOVE ER-2727     TO WS-ERROR
 16405*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 296
* EL050.cbl
 16406
 16407     IF PB-COMPANY-ID = 'ACE'
 16408       IF AH-COVERAGE-CANCELLED
 16409         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16410           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16411              MOVE ER-2732      TO WS-ERROR
 16412              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16413
 16414     IF PB-COMPANY-ID      EQUAL   'HER'
 16415        IF WS-ERROR        EQUAL   ER-2727
 16416            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16417            MOVE  ER-2725          TO  WS-ERROR
 16418            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16419
 16420     IF PB-C-CLAIM-CREATED-CANCEL
 16421            MOVE ER-2748         TO WS-ERROR
 16422            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16423
 16424     IF PB-C-LAST-NAME NOT = SPACES
 16425         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16426            MOVE ER-2747         TO WS-ERROR
 16427            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16428
 16429 3710-EDIT-LUMP-SUM-PRIOR.
 16430
 16431     IF AH-COVERAGE-CANCELLED
 16432         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16433             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16434                MOVE ER-2735    TO WS-ERROR
 16435                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16436
 16437     IF LF-COVERAGE-CANCELLED
 16438         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16439             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16440                MOVE ER-2735    TO WS-ERROR
 16441                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16442
 16443 3710-EDIT-PRIOR-DEATH.
 16444
 16445*    IF LF-COVERAGE-CANCELLED
 16446*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16447*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16448*           (NOT PB-CI-OB)
 16449*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16450*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16451*                   MOVE ER-2732  TO WS-ERROR
 16452*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16453*
 16454*    IF AH-COVERAGE-CANCELLED
 16455*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16456*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16457*           (NOT PB-CI-OB)
 16458*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16459*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16460*                   MOVE ER-2732  TO WS-ERROR
 16461*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16462
 16463     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 297
* EL050.cbl
 16464         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16465            (NOT PB-COMP-LF-CANCEL)
 16466             NEXT SENTENCE
 16467         ELSE
 16468           IF PB-C-LF-CANCEL-VOIDED
 16469              NEXT SENTENCE
 16470           ELSE
 16471              MOVE ER-2753      TO WS-ERROR
 16472              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16473
 16474     IF CANCEL-FUTURE-DT
 16475         GO TO 3999-END-EDIT.
 16476
 16477 3715-GET-REMAIN-TERM-LF.
 16478
 16479     IF NO-LF-BENEFIT-MATCH  OR
 16480        WS-LF-BENEFIT-CD = ZEROS
 16481        GO TO 3730-GET-AH-REMAIN-TERM.
 16482
 16483     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16484     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16485     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16486     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16487     MOVE PB-SV-STATE            TO CP-STATE.
 16488     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16489     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16490     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16491     MOVE '2'                    TO CP-PROCESS-TYPE.
 16492     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16493     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16494     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16495     IF (PB-COMPANY-ID = 'CID')
 16496        AND (CP-STATE-STD-ABBRV = 'WI')
 16497        MOVE '7'                 TO CP-REM-TERM-METHOD
 16498        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16499     ELSE
 16500        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16501        MOVE WS-REM-TRM-CALC-OPTION
 16502                                 TO CP-REM-TRM-CALC-OPTION
 16503     END-IF
 16504**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16505     IF (PB-COMPANY-ID = 'CID')
 16506        AND (CP-STATE-STD-ABBRV = 'MO')
 16507        AND (PB-CERT-EFF-DT >= X'9B41')
 16508        AND (PB-CERT-EFF-DT <= X'A2FB')
 16509        MOVE '7'                 TO CP-REM-TERM-METHOD
 16510        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16511     END-IF
 16512     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16513                                    CP-LOAN-TERM.
 16514     IF CP-TRUNCATED-LIFE
 16515        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16516
 16517     IF CP-TERM-IS-DAYS
 16518         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16519     ELSE
 16520         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16521
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 298
* EL050.cbl
 16522     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16523
 16524     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16525
 16526     IF LF-COVERAGE-CANCELLED
 16527        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16528        NEXT SENTENCE
 16529      ELSE
 16530          GO TO 3730-GET-AH-REMAIN-TERM.
 16531
 16532 3720-GET-LF-REFUND.
 16533
 16534     IF PB-C-LF-CANCEL-VOIDED
 16535        GO TO 3730-GET-AH-REMAIN-TERM
 16536     end-if
 16537
 16538     IF PB-COMPANY-ID EQUAL 'BOA'
 16539         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16540         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16541         GO TO 3730-GET-AH-REMAIN-TERM.
 16542
 16543     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16544        (WS-AH-SPECIAL-CALC-CD = 'M')
 16545         MOVE ER-2767            TO WS-ERROR
 16546         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16547         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16548         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16549         GO TO 3780-UPDATE-CANCEL-CERT.
 16550
 16551*    if (ws-lf-earnings-calc = '6')
 16552*       or (pb-c-lf-refund-override = '6')
 16553*       move cp-remaining-term-1 to cp-remaining-term-2
 16554*    end-if
 16555     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16556
 16557     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16558     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16559     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16560     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16561     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16562     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16563     IF PB-COMPANY-ID = 'DCC'
 16564        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16565        IF PDEF-MASTER-FOUND
 16566           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16567              (V1 > +8)
 16568              OR (PD-PROD-CODE (V1) = 'L')
 16569           END-PERFORM
 16570           IF V1 < +9
 16571              MOVE PD-MAX-AMT (V1)
 16572                           TO CP-R-MAX-TOT-BEN
 16573                              EC-AM-LF-MAX-TOT-BEN
 16574           END-IF
 16575        ELSE
 16576        MOVE ' '                 TO PDEF-MASTER-SW
 16577        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16578        MOVE PB-STATE            TO ERPDEF-STATE
 16579        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 299
* EL050.cbl
 16580           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16581        END-IF
 16582        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16583        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16584        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16585        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16586        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16587        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16588        IF PDEF-MASTER-FOUND
 16589           MOVE 'N'              TO PDEF-MASTER-SW
 16590           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16591           IF PDEF-MASTER-FOUND
 16592              IF (ERPDEF-KEY-SAVE (1:16) =
 16593                           PD-CONTROL-PRIMARY (1:16))
 16594                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16595                 CONTINUE
 16596              ELSE
 16597                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16598                 IF (ERPDEF-KEY-SAVE (1:16) =
 16599                           PD-CONTROL-PRIMARY (1:16))
 16600                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16601                    CONTINUE
 16602                 ELSE
 16603                    MOVE 'N'     TO PDEF-MASTER-SW
 16604                 END-IF
 16605              END-IF
 16606
 16607              IF PDEF-MASTER-FOUND
 16608                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16609                    (V1 > +8)
 16610                    OR (PD-PROD-CODE (V1) = 'L')
 16611                 END-PERFORM
 16612                 IF V1 < +9
 16613                    MOVE PD-MAX-AMT (V1)
 16614                                 TO CP-R-MAX-TOT-BEN
 16615                                    EC-AM-LF-MAX-TOT-BEN
 16616                 END-IF
 16617              END-IF
 16618           END-IF
 16619           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16620        END-IF
 16621        END-IF
 16622     END-IF
 16623     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16624
 16625     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16626
 16627     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16628                                    PB-C-LF-REM-TERM.
 16629
 16630     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16631     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16632
 16633     IF PB-COMPANY-ID EQUAL 'FLC'
 16634        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16635           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16636           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16637                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 300
* EL050.cbl
 16638                    - CM-LF-ITD-DEATH-AMT
 16639           IF PB-C-LF-REF-CALC LESS THAN +0
 16640              MOVE +0            TO PB-C-LF-REF-CALC
 16641              GO TO 3730-GET-AH-REMAIN-TERM
 16642           ELSE
 16643              GO TO 3730-GET-AH-REMAIN-TERM.
 16644
 16645     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16646                            OR '4' OR '5' OR '6' OR '8'
 16647                            OR '9' OR 'G'
 16648        MOVE PB-C-LF-REFUND-OVERRIDE
 16649                                 TO CP-EARNING-METHOD.
 16650
 16651     if pb-company-id = 'AHL'
 16652        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16653        if cp-class-code = spaces
 16654           move zeros            to cp-class-code
 16655        end-if
 16656     ELSE
 16657        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16658     END-IF
 16659*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16660     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16661     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16662                                    CP-RATING-BENEFIT-AMT.
 16663     IF CP-STATE-STD-ABBRV = 'OR'
 16664         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16665                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16666     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16667     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16668     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16669     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16670     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16671     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16672     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16673     IF WS-DEFAULT-APR NOT NUMERIC
 16674         MOVE ZEROS TO WS-DEFAULT-APR.
 16675****   N O T E   ****
 16676*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16677*      THE OH HARD CODING IN ELCRFNDP
 16678
 16679     IF PB-COMPANY-ID = 'CID'
 16680        IF CP-STATE-STD-ABBRV = 'OH'
 16681           MOVE WS-LF-EARNINGS-CALC
 16682                                 TO CP-EARNING-METHOD
 16683        END-IF
 16684     END-IF
 16685
 16686****   N O T E   ****
 16687
 16688*    IF CP-EARN-AS-NET-PAY
 16689*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16690*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16691*               MOVE WS-DEFAULT-APR
 16692*                                TO  CP-LOAN-APR
 16693*               MOVE ER-3780     TO  WS-ERROR
 16694*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16695*           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 301
* EL050.cbl
 16696*               MOVE ER-3781     TO  WS-ERROR
 16697*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16698*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16699     move ' '                    to cp-ext-days-calc
 16700     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16701
 16702     IF CP-REFUND-TYPE-USED NOT = SPACE
 16703         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16704
 16705     IF CP-ERROR-RATE-IS-ZERO OR
 16706        CP-ERROR-RATE-NOT-FOUND
 16707        MOVE ER-2740             TO WS-ERROR
 16708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16709
 16710     IF CP-ERROR-RATE-FILE-NOTOPEN
 16711        MOVE ER-2617             TO WS-ERROR
 16712        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16713
 16714     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16715        AND PB-CI-ENTRY-STATUS = 'M'
 16716        MOVE +0                  TO PB-C-LF-REF-CALC
 16717     ELSE
 16718        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16719     END-IF
 16720
 16721     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16722         GO TO 3730-GET-AH-REMAIN-TERM.
 16723
 16724*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16725*       ADD +1                   TO PB-C-LF-REM-TERM
 16726*                                   CP-REMAINING-TERM
 16727*                                   CP-ORIGINAL-TERM.
 16728
 16729     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16730     MOVE '2'                    TO CP-EARNING-METHOD
 16731                                    CP-RATING-METHOD.
 16732     IF PB-COMPANY-ID = 'CID'
 16733        IF (CP-STATE-STD-ABBRV = 'MN')
 16734           AND (PB-CERT-EFF-DT > X'A4FF')
 16735           AND (WS-LF-EARNINGS-CALC = 'B')
 16736           MOVE '5'              TO CP-EARNING-METHOD
 16737           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16738        END-IF
 16739     END-IF
 16740     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16741                                        CP-REMAINING-BENEFIT
 16742                                        CP-RATING-BENEFIT-AMT.
 16743     IF CP-STATE-STD-ABBRV = 'OR'
 16744         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16745                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16746     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16747     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16748
 16749     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16750
 16751     IF CP-ERROR-RATE-IS-ZERO OR
 16752        CP-ERROR-RATE-NOT-FOUND
 16753        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 302
* EL050.cbl
 16754        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16755
 16756     IF CP-ERROR-RATE-FILE-NOTOPEN
 16757        MOVE ER-2617             TO WS-ERROR
 16758        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16759
 16760     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16761
 16762******************************************************************
 16763
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 303
* EL050.cbl
 16765 3730-GET-AH-REMAIN-TERM.
 16766     IF NO-AH-BENEFIT-MATCH  OR
 16767        WS-AH-BENEFIT-CD = ZEROS
 16768         GO TO 3770-CHECK-REFUNDS.
 16769
 16770     IF PB-CI-AH-LUMP-SUM-DISAB
 16771         IF  PB-C-AH-CANCEL-AMT = ZERO
 16772            IF NOT PB-COMP-AH-CANCEL
 16773             GO TO 3770-CHECK-REFUNDS.
 16774
 16775     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16776     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16777     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16778     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16779     MOVE PB-SV-STATE            TO CP-STATE.
 16780     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16781     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16782     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16783     MOVE '2'                    TO CP-PROCESS-TYPE.
 16784     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16785     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16786     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16787     IF (PB-COMPANY-ID = 'CID')
 16788        AND (CP-STATE-STD-ABBRV = 'WI')
 16789        MOVE '7'                 TO CP-REM-TERM-METHOD
 16790        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16791     ELSE
 16792        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16793        MOVE WS-REM-TRM-CALC-OPTION
 16794                                 TO CP-REM-TRM-CALC-OPTION
 16795     END-IF
 16796     IF (PB-COMPANY-ID = 'CID')
 16797        AND (CP-STATE-STD-ABBRV = 'MO')
 16798        AND (PB-CERT-EFF-DT >= X'9B41')
 16799        AND (PB-CERT-EFF-DT <= X'A2FB')
 16800        MOVE '7'                 TO CP-REM-TERM-METHOD
 16801        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16802     END-IF
 16803     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16804                                    CP-LOAN-TERM.
 16805     IF NOT CP-TERM-IS-DAYS
 16806         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16807
 16808     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16809
 16810     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16811
 16812     IF AH-COVERAGE-CANCELLED
 16813        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16814        NEXT SENTENCE
 16815      ELSE
 16816         GO TO 3770-CHECK-REFUNDS.
 16817
 16818 3740-GET-AH-REFUND.
 16819
 16820     IF PB-C-AH-CANCEL-VOIDED
 16821        GO TO 3780-UPDATE-CANCEL-CERT
 16822     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 304
* EL050.cbl
 16823
 16824     IF PB-COMPANY-ID = 'BOA'
 16825         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16826         GO TO 3770-CHECK-REFUNDS.
 16827
 16828     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16829*    MOVE ' '                    TO DC-OPTION-CODE
 16830     SET BIN-TO-GREG             TO TRUE
 16831     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16832     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16833                                    PB-C-AH-REM-TERM.
 16834     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16835     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16836
 16837     IF PB-COMPANY-ID EQUAL 'FLC'
 16838        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16839           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16840           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16841                    - CM-AH-ITD-AH-PMT)
 16842           IF PB-C-AH-REF-CALC LESS THAN +0
 16843              MOVE +0            TO PB-C-AH-REF-CALC
 16844              GO TO 3770-CHECK-REFUNDS
 16845           ELSE
 16846              GO TO 3770-CHECK-REFUNDS.
 16847
 16848     IF PB-COMPANY-ID = 'DCC'
 16849        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16850            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16851           MOVE 'S'              TO CP-EARNING-METHOD
 16852        END-IF
 16853     END-IF
 16854     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16855                            OR '4' OR '5' OR '6' OR '8'
 16856                            OR '9' OR 'G' OR 'S'
 16857        MOVE PB-C-AH-REFUND-OVERRIDE
 16858                                 TO CP-EARNING-METHOD.
 16859
 16860     if pb-company-id = 'AHL'
 16861        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16862        if cp-class-code = spaces
 16863           move zeros            to cp-class-code
 16864        end-if
 16865     ELSE
 16866        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16867     END-IF
 16868*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16869     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16870     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16871                                    CP-RATING-BENEFIT-AMT.
 16872     IF CP-STATE-STD-ABBRV = 'OR'
 16873         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16874                                         PB-CI-AH-TERM.
 16875     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16876     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16877     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16878     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16879     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16880     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 305
* EL050.cbl
 16881
 16882     IF CP-STATE-STD-ABBRV = 'OH'
 16883        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16884                                AND 'CID' AND 'DCC' and 'VPP'
 16885                                AND 'AHL')
 16886           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16887              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16888              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16889              MOVE '6' TO CP-EARNING-METHOD
 16890           END-IF
 16891        END-IF
 16892        IF PB-COMPANY-ID = 'CID'
 16893           IF NO-LIFE-COVERAGE
 16894              IF CP-CRITICAL-PERIOD
 16895                 MOVE '2'       TO CP-EARNING-METHOD
 16896              ELSE
 16897                 MOVE '6'       TO CP-EARNING-METHOD
 16898              END-IF
 16899           ELSE
 16900              IF WS-LF-COVERAGE-TYPE = 'L'
 16901                 MOVE '2'       TO CP-EARNING-METHOD
 16902              ELSE
 16903                 IF (PB-CI-LF-TERM > +60) OR
 16904                    (WS-LF-EARNINGS-CALC = '5')
 16905                    IF CP-CRITICAL-PERIOD
 16906                       MOVE '2'  TO CP-EARNING-METHOD
 16907                    ELSE
 16908                       MOVE '6'  TO CP-EARNING-METHOD
 16909                    END-IF
 16910                 ELSE
 16911                    MOVE '1'     TO CP-EARNING-METHOD
 16912                 END-IF
 16913              END-IF
 16914           END-IF
 16915        END-IF
 16916     END-IF
 16917
 16918*    IF CP-STATE-STD-ABBRV = 'VA'
 16919*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16920*          IF CP-ORIGINAL-TERM GREATER 61
 16921*             MOVE '6' TO CP-EARNING-METHOD
 16922*          ELSE
 16923*             MOVE '1' TO CP-EARNING-METHOD.
 16924
 16925     IF WS-DEFAULT-APR NOT NUMERIC
 16926         MOVE ZEROS TO WS-DEFAULT-APR.
 16927     IF CP-EARN-AS-NET-PAY
 16928         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16929            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16930                MOVE WS-DEFAULT-APR
 16931                                 TO  CP-LOAN-APR
 16932                MOVE ER-3780     TO  WS-ERROR
 16933                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16934            ELSE
 16935                MOVE ER-3781     TO  WS-ERROR
 16936                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16937     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16938     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 306
* EL050.cbl
 16939        AND CP-CANCEL-REASON = 'R'
 16940        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16941        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16942     END-IF
 16943     IF PB-COMPANY-ID = 'DCC'
 16944        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16945        AND (CP-EARNING-METHOD = 'D')
 16946        AND (CP-CANCEL-REASON NOT = 'R')
 16947        CONTINUE
 16948     ELSE
 16949        GO TO 3750-CONTINUE
 16950     END-IF
 16951     MOVE ' '                    TO DD-IU-SW
 16952     IF NOT PDEF-MASTER-FOUND
 16953        MOVE ' '                 TO PDEF-MASTER-SW
 16954        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16955        MOVE PB-STATE            TO ERPDEF-STATE
 16956        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16957           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16958        END-IF
 16959        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16960        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16961        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16962        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16963        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16964        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16965        IF PDEF-MASTER-FOUND
 16966           MOVE 'N'              TO PDEF-MASTER-SW
 16967           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16968           IF PDEF-MASTER-FOUND
 16969              IF (ERPDEF-KEY-SAVE (1:16) =
 16970                           PD-CONTROL-PRIMARY (1:16))
 16971                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16972                 CONTINUE
 16973              ELSE
 16974                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16975                 IF (ERPDEF-KEY-SAVE (1:16) =
 16976                           PD-CONTROL-PRIMARY (1:16))
 16977                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16978                    CONTINUE
 16979                 ELSE
 16980                    MOVE ER-2740 TO WS-ERROR
 16981                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16982                    GO TO 3770-CHECK-REFUNDS
 16983                 END-IF
 16984              END-IF
 16985           END-IF
 16986           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16987        END-IF
 16988     END-IF
 16989     IF PDEF-MASTER-FOUND
 16990        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16991           (V1 > +8)
 16992           OR (PD-PROD-CODE (V1) = 'I')
 16993        END-PERFORM
 16994        IF V1 < +9
 16995           SET DD-IU-PRESENT        TO TRUE
 16996        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 307
* EL050.cbl
 16997        IF WS-AH-DCC-TRUNC = 'T'
 16998           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16999        ELSE
 17000           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17001        END-IF
 17002        EVALUATE TRUE
 17003           WHEN WS-TERM > +168
 17004              MOVE 15               TO V1
 17005           WHEN WS-TERM > +156
 17006              MOVE 14               TO V1
 17007           WHEN WS-TERM > +144
 17008              MOVE 13               TO V1
 17009           WHEN WS-TERM > +132
 17010              MOVE 12               TO V1
 17011           WHEN WS-TERM > +120
 17012              MOVE 11               TO V1
 17013           WHEN WS-TERM > +108
 17014              MOVE 10               TO V1
 17015           WHEN WS-TERM > +96
 17016              MOVE 9                TO V1
 17017           WHEN WS-TERM > +84
 17018              MOVE 8                TO V1
 17019           WHEN WS-TERM > +72
 17020              MOVE 7                TO V1
 17021           WHEN WS-TERM > +60
 17022              MOVE 6                TO V1
 17023           WHEN WS-TERM > +48
 17024              MOVE 5                TO V1
 17025           WHEN WS-TERM > +36
 17026              MOVE 4                TO V1
 17027           WHEN WS-TERM > +24
 17028              MOVE 3                TO V1
 17029           WHEN WS-TERM > +12
 17030              MOVE 2                TO V1
 17031           WHEN OTHER
 17032              MOVE 1                TO V1
 17033        END-EVALUATE
 17034
 17035        EVALUATE TRUE
 17036*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17037*             < +13)
 17038*             AND (DD-IU-PRESENT)
 17039*             MOVE 2                TO V2
 17040*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17041*             MOVE 1                TO V2
 17042           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17043              MOVE 2                TO V2
 17044           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17045              MOVE 3                TO V2
 17046           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17047              MOVE 4                TO V2
 17048           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17049              MOVE 5                TO V2
 17050           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17051              MOVE 6                TO V2
 17052           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17053              MOVE 7                TO V2
 17054           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 308
* EL050.cbl
 17055              MOVE 8                TO V2
 17056           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17057              MOVE 9                TO V2
 17058           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17059              MOVE 10               TO V2
 17060           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17061              MOVE 11               TO V2
 17062           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17063              MOVE 12               TO V2
 17064           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17065              MOVE 13               TO V2
 17066           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17067              MOVE 14               TO V2
 17068           WHEN OTHER
 17069              MOVE 15               TO V2
 17070        END-EVALUATE
 17071
 17072        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17073                                 TO CP-DDF-LO-FACT
 17074        MOVE PD-UEP-FACTOR (V1 V2)
 17075                                 TO CP-DDF-HI-FACT
 17076
 17077        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17078        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17079        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17080           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17081        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17082        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17083        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17084           + PD-1ST-YR-ADMIN-ALLOW
 17085
 17086        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17087*       IF PI-CLP-YN = 'Y'
 17088*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17089*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17090*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17091*       END-IF
 17092
 17093        IF DD-IU-PRESENT
 17094           MOVE 'I'              TO CP-EARNING-METHOD
 17095        END-IF
 17096        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17097                                     CP-CLP-RATE-UP
 17098        IF CP-IU-RATE-UP NOT = ZEROS
 17099           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17100              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17101           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17102              / (1 - WS-WORK-FACT)
 17103        END-IF
 17104     END-IF
 17105     .
 17106 3750-CONTINUE.
 17107     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17108
 17109     IF CP-REFUND-TYPE-USED NOT = SPACE
 17110         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17111
 17112     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 309
* EL050.cbl
 17113        CP-ERROR-RATE-NOT-FOUND
 17114        MOVE ER-2740             TO WS-ERROR
 17115        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17116
 17117     IF CP-ERROR-RATE-FILE-NOTOPEN
 17118        MOVE ER-2617             TO WS-ERROR
 17119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17120     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17121        AND (PB-CI-ENTRY-STATUS = 'M')
 17122        MOVE +0                  TO PB-C-AH-REF-CALC
 17123     ELSE
 17124        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17125     END-IF
 17126     if pb-company-id = 'VPP'
 17127        MOVE cm-ah-clp           to cp-original-premium
 17128        move zeros               to cp-calc-refund
 17129        perform 7600-get-refund  thru 7600-exit
 17130        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17131           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17132        else
 17133           move zeros            to pb-c-ah-rfnd-clp
 17134        end-if
 17135        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17136           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17137           pb-ci-cancel-fee
 17138     end-if
 17139     IF PB-COMPANY-ID = 'DCC'
 17140        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17141        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17142        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17143        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17144        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17145        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17146        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17147        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17148*       if pb-c-cancel-amt < +0
 17149*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17150*       end-if
 17151*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17152     END-IF
 17153     .
 17154 3770-CHECK-REFUNDS.
 17155
 17156     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17157        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17158           MOVE ER-2766          TO WS-ERROR
 17159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17160           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17161           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17162              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17163
 17164     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17165        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17166           MOVE ER-2766          TO WS-ERROR
 17167           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17168           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17169           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17170              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 310
* EL050.cbl
 17171
 17172     IF PB-COMP-LF-CANCEL
 17173        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17174        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17175           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17176              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17177
 17178     IF PB-COMP-AH-CANCEL
 17179        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17180        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17181           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17182              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17183
 17184     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17185             GIVING WS-UNSIGN-WRK1
 17186     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17187             GIVING WS-UNSIGN-WRK2.
 17188
 17189     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17190         MOVE ZERO TO WS-UNSIGN-WRK1.
 17191
 17192     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17193         MOVE ZERO TO WS-UNSIGN-WRK2.
 17194
 17195     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17196
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 311
* EL050.cbl
 17198
 17199 3772-CONTINUE.
 17200
 17201**********************************
 17202*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17203*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17204*** DOUBLES THE TOLERANCE AMOUNT.
 17205***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17206**********************************
 17207     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17208     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17209         IF WS-REF-REJECT-SW = SPACE
 17210             MOVE ER-2754        TO WS-ERROR
 17211             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17212           ELSE
 17213             MOVE ER-2736        TO WS-ERROR
 17214             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17215**********************************
 17216
 17217 3773-CONTINUE.
 17218
 17219     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17220        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17221           MOVE ER-2723          TO WS-ERROR
 17222           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17223
 17224     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17225        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17226           MOVE ER-2724          TO WS-ERROR
 17227           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17228
 17229     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17230         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17231             (1 + WS-LF-REFUND-OVS-PCT)
 17232     ELSE
 17233         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17234
 17235     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17236         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17237             (1 - WS-TOL-LF-REFUND-PCT)
 17238     ELSE
 17239         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17240
 17241     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17242        AND (PB-CI-ENTRY-STATUS = 'M')
 17243        AND (PB-C-LF-CANCEL-AMT > +0)
 17244        MOVE ER-3843             TO WS-ERROR
 17245        PERFORM 9900-ERROR-FORMAT
 17246                                 THRU 9900-EXIT
 17247     END-IF
 17248     EVALUATE TRUE
 17249        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17250           CONTINUE
 17251        WHEN PB-C-LF-CANCEL-AMT = +0
 17252                 AND PB-C-LF-REF-CALC > +0
 17253           CONTINUE
 17254        WHEN WS-LF-REFUND-OVS-AMT = 0
 17255                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 312
* EL050.cbl
 17256           CONTINUE
 17257        WHEN OTHER
 17258           IF WS-TOL-LF-REFUND  = +0
 17259              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17260           END-IF
 17261           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17262                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17263                          (PB-C-LF-CANCEL-AMT))
 17264              CONTINUE
 17265           ELSE
 17266              IF WS-LF-REFUND-OVS-AMT = +0
 17267                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17268              END-IF
 17269              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17270                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17271                                       PB-C-LF-CANCEL-AMT)
 17272                 CONTINUE
 17273              ELSE
 17274                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17275                   MOVE ER-2754   TO  WS-ERROR
 17276                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17277                 ELSE
 17278                    MOVE ER-2736   TO  WS-ERROR
 17279                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17280                 END-IF
 17281              END-IF
 17282           END-IF
 17283     END-EVALUATE.
 17284
 17285     EVALUATE TRUE
 17286        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17287           CONTINUE
 17288        WHEN PB-C-LF-CANCEL-AMT = +0
 17289                 AND PB-C-LF-REF-CALC > +0
 17290           CONTINUE
 17291        WHEN OTHER
 17292           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17293               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17294              CONTINUE
 17295           ELSE
 17296              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17297               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17298                CONTINUE
 17299              ELSE
 17300                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17301                     MOVE ER-2754   TO  WS-ERROR
 17302                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17303                 ELSE
 17304                     MOVE ER-2736   TO  WS-ERROR
 17305                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17306                 END-IF
 17307              END-IF
 17308           END-IF
 17309     END-EVALUATE.
 17310
 17311     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17312         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17313             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 313
* EL050.cbl
 17314     ELSE
 17315         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17316
 17317     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17318         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17319             (1 - WS-TOL-AH-REFUND-PCT)
 17320     ELSE
 17321         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17322
 17323     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17324        AND (PB-CI-ENTRY-STATUS = 'M')
 17325        AND (PB-C-AH-CANCEL-AMT > +0)
 17326        MOVE ER-3843             TO WS-ERROR
 17327        PERFORM 9900-ERROR-FORMAT
 17328                                 THRU 9900-EXIT
 17329     END-IF
 17330     EVALUATE TRUE
 17331        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17332           CONTINUE
 17333*       WHEN PB-C-AH-REF-CALC = +0 AND
 17334*                  PB-C-AH-CANCEL-AMT > +0
 17335        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17336                   PB-C-AH-REF-CALC > +0
 17337           CONTINUE
 17338        WHEN WS-AH-REFUND-OVS-AMT = +0
 17339                AND WS-TOL-AH-REFUND = +0
 17340           CONTINUE
 17341        WHEN OTHER
 17342           IF WS-TOL-AH-REFUND = +0
 17343              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17344           END-IF
 17345           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17346               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17347                                         PB-C-AH-CANCEL-AMT)
 17348              CONTINUE
 17349           ELSE
 17350              IF WS-AH-REFUND-OVS-AMT = +0
 17351                 MOVE +9999999.99 TO
 17352                         WS-AH-REFUND-OVS-AMT
 17353              END-IF
 17354              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17355                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17356                                         PB-C-AH-CANCEL-AMT)
 17357                 CONTINUE
 17358              ELSE
 17359                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17360                    MOVE ER-2754   TO  WS-ERROR
 17361                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17362                 ELSE
 17363                    MOVE ER-2736   TO  WS-ERROR
 17364                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17365                 END-IF
 17366              END-IF
 17367           END-IF
 17368     END-EVALUATE.
 17369
 17370     EVALUATE TRUE
 17371        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 314
* EL050.cbl
 17372           CONTINUE
 17373*       WHEN PB-C-AH-REF-CALC > +0 AND
 17374*                  PB-C-AH-CANCEL-AMT = +0
 17375        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17376                   PB-C-AH-REF-CALC = +0
 17377           CONTINUE
 17378        WHEN OTHER
 17379           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17380               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17381              CONTINUE
 17382           ELSE
 17383              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17384                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17385                 CONTINUE
 17386              ELSE
 17387                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17388                     MOVE ER-2754   TO  WS-ERROR
 17389                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17390                 ELSE
 17391                     MOVE ER-2736   TO  WS-ERROR
 17392                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17393                 END-IF
 17394              END-IF
 17395           END-IF
 17396     END-EVALUATE.
 17397
 17398     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17399        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17400        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17401           AND  PB-C-LF-REF-CALC < +1.00
 17402           AND  PB-C-AH-REF-CALC < +1.00
 17403           CONTINUE
 17404        ELSE
 17405           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17406              AND (PB-CI-ENTRY-STATUS = 'M')
 17407              CONTINUE
 17408           ELSE
 17409              MOVE ER-2741       TO WS-ERROR
 17410              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17411           END-IF
 17412        END-IF
 17413     END-IF
 17414
 17415     IF (PB-C-LF-CANCEL-AMT = ZERO
 17416        AND WS-LF-BENEFIT-CD NOT = ZERO
 17417        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17418        AND PB-C-LF-REF-CALC NOT = ZERO)
 17419        OR
 17420        (PB-C-LF-CANCEL-AMT = ZERO
 17421        AND WS-LF-BENEFIT-CD NOT = ZERO
 17422        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17423             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17424                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17425                NEXT SENTENCE
 17426             ELSE
 17427                MOVE ER-2739        TO WS-ERROR
 17428                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17429
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 315
* EL050.cbl
 17430     IF (PB-C-AH-CANCEL-AMT = ZERO
 17431        AND WS-AH-BENEFIT-CD NOT = ZERO
 17432        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17433        AND PB-C-AH-REF-CALC NOT = ZERO)
 17434        OR
 17435        (PB-C-AH-CANCEL-AMT = ZERO
 17436        AND WS-AH-BENEFIT-CD NOT = ZERO
 17437        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17438             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17439                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17440                NEXT SENTENCE
 17441             ELSE
 17442                MOVE ER-2738        TO WS-ERROR
 17443                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17444
 17445 3775-OVER-REF-CHK.
 17446
 17447     IF PB-CI-ENTRY-STATUS = '5'
 17448        GO TO 3780-UPDATE-CANCEL-CERT.
 17449
 17450     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17451                              PB-CI-LF-ALT-PREMIUM-AMT.
 17452
 17453     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17454        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17455                                 PB-C-LF-REF-CALC
 17456      ELSE
 17457        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17458                                 PB-C-LF-CANCEL-AMT.
 17459
 17460     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17461        MOVE ER-2755             TO WS-ERROR
 17462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17463
 17464     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17465
 17466     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17467        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17468                                 PB-C-AH-REF-CALC
 17469      ELSE
 17470        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17471                                 PB-C-AH-CANCEL-AMT.
 17472
 17473     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17474        MOVE ER-2778             TO WS-ERROR
 17475        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17476
 17477     IF PB-CI-OB-FLAG NOT = 'Z'
 17478        NEXT SENTENCE
 17479       ELSE
 17480         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17481            MOVE ER-2757           TO WS-ERROR
 17482            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17483
 17484 3780-UPDATE-CANCEL-CERT.
 17485
 17486     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17487        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 316
* EL050.cbl
 17488        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17489
 17490     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17491         MOVE ER-2729              TO WS-ERROR
 17492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17493
 17494     IF PB-CI-LF-BENEFIT-CD = ZERO
 17495         GO TO 3780-UPDATE-CONT-1.
 17496
 17497     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17498         GO TO 3780-UPDATE-CONT-1.
 17499
 17500     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17501       AND
 17502        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17503       AND
 17504        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17505       AND
 17506        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17507            NEXT SENTENCE
 17508       ELSE
 17509        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17510          AND
 17511***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17512***       AND
 17513           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17514            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17515               MOVE ER-2730      TO WS-ERROR
 17516               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17517               GO TO 3999-END-EDIT
 17518            ELSE
 17519               GO TO 3999-END-EDIT
 17520        ELSE
 17521            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17522               MOVE ER-2765           TO WS-ERROR
 17523               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17524               GO TO 3785-CHECK-REF-INT.
 17525*              GO TO 3999-END-EDIT.
 17526
 17527 3780-UPDATE-CONT-1.
 17528     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17529
 17530     IF PB-CI-AH-BENEFIT-CD = ZERO
 17531         GO TO 3780-UPDATE-CONT-2.
 17532
 17533     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17534         GO TO 3780-UPDATE-CONT-2.
 17535
 17536     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17537
 17538     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17539       AND
 17540        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17541       AND
 17542        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17543       AND
 17544        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17545            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 317
* EL050.cbl
 17546       ELSE
 17547        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17548          AND
 17549***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17550***       AND
 17551           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17552           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17553            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17554               MOVE ER-2773      TO WS-ERROR
 17555               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17556               GO TO 3999-END-EDIT
 17557            ELSE
 17558               GO TO 3999-END-EDIT
 17559            END-IF
 17560           ELSE
 17561             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17562                IF MSTR-CERT-NO = W-CL-CERT-NO
 17563                   MOVE ER-2890 TO WS-ERROR
 17564                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17565                   GO TO 3999-END-EDIT
 17566                ELSE
 17567                   MOVE ER-2898 TO WS-ERROR
 17568                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17569                   GO TO 3999-END-EDIT
 17570                END-IF
 17571             ELSE
 17572                GO TO 3785-CHECK-REF-INT
 17573             END-IF
 17574           END-IF
 17575          ELSE
 17576            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17577              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17578                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17579                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17580                      MOVE ER-2890 TO WS-ERROR
 17581                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17582                      GO TO 3999-END-EDIT
 17583                   ELSE
 17584                      MOVE ER-2898 TO WS-ERROR
 17585                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17586                      GO TO 3999-END-EDIT
 17587                   END-IF
 17588                ELSE
 17589                   MOVE ER-2765 TO WS-ERROR
 17590                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17591                   GO TO 3785-CHECK-REF-INT
 17592                END-IF
 17593              ELSE
 17594               MOVE ER-2765      TO WS-ERROR
 17595               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17596               GO TO 3785-CHECK-REF-INT.
 17597*              GO TO 3999-END-EDIT.
 17598
 17599 3780-UPDATE-CONT-2.
 17600
 17601     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17602        AND WS-LF-BENEFIT-CD = ZERO
 17603           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 318
* EL050.cbl
 17604           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17605
 17606     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17607        AND WS-AH-BENEFIT-CD = ZERO
 17608           MOVE ER-2744           TO WS-ERROR
 17609           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17610
 17611     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17612        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17613        AND
 17614        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17615         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17616           MOVE ER-2746           TO WS-ERROR
 17617           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17618
 17619     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17620       AND
 17621        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17622             MOVE ER-2737        TO WS-ERROR
 17623             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17624
 17625     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17626       AND
 17627        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17628             MOVE ER-2737        TO WS-ERROR
 17629             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17630
 17631     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17632         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17633             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17634             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17635         ELSE
 17636             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17637                 MOVE ER-2768    TO WS-ERROR
 17638                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17639             ELSE
 17640                 MOVE ER-2756    TO WS-ERROR
 17641                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17642
 17643     IF CERT-PEND-ISSUE-RETURNED
 17644        MOVE ER-2772             TO WS-ERROR
 17645        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17646 3785-CHECK-REF-INT.
 17647*    IF PB-STATE NOT = 'NH' and 'TN'
 17648     IF PB-STATE NOT = 'NH'
 17649        GO TO 3999-END-EDIT
 17650     END-IF
 17651
 17652     MOVE ER-2796                TO WS-ERROR
 17653     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17654     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17655        OR (CM-REF-INTERFACE-SW = 'Y')
 17656        MOVE ER-2793             TO WS-ERROR
 17657        PERFORM 9900-ERROR-FORMAT
 17658                                 THRU 9900-EXIT
 17659     END-IF
 17660     MOVE +0                     TO WS-PAYMENT-AMT
 17661     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 319
* EL050.cbl
 17662        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17663               PB-C-AH-CANCEL-DT
 17664           GO TO 3999-END-EDIT
 17665        END-IF
 17666     end-if
 17667***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17668***-_-
 17669***-_-   For TN it's only flat cancels
 17670***-_-
 17671***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17672     if pb-state = 'TN'
 17673        if ((pb-c-lf-cancel-dt <> low-values)
 17674           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17675                      or
 17676           ((pb-c-ah-cancel-dt <> low-values)
 17677           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17678           GO TO 3999-END-EDIT
 17679        END-IF
 17680     end-if
 17681     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17682        GO TO 3999-END-EDIT
 17683     END-IF
 17684***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17685***-_-
 17686***-_-   if cancel date within 15 days of effective date, bypass
 17687***-_-
 17688***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17689     IF PB-STATE NOT = 'NH'
 17690        GO TO 3785-CONTINUE
 17691     END-IF
 17692     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17693     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17694     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17695        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17696     END-IF
 17697     MOVE '1'                    TO DC-OPTION-CODE
 17698     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17699     IF NO-CONVERSION-ERROR
 17700        IF DC-ELAPSED-DAYS < +16
 17701           GO TO 3999-END-EDIT
 17702        END-IF
 17703     END-IF
 17704***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17705***-_-
 17706***-_-   if cancel date within 30 days of current date then
 17707***-_-   bypass else subtract 15 days from period
 17708***-_-
 17709***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17710     MOVE +0                     TO DC-ELAPSED-DAYS
 17711     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17712     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17713     MOVE '1'                    TO DC-OPTION-CODE
 17714     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17715     IF NO-CONVERSION-ERROR
 17716        IF DC-ELAPSED-DAYS > +30
 17717           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17718        ELSE
 17719           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 320
* EL050.cbl
 17720        END-IF
 17721     ELSE
 17722        GO TO 3999-END-EDIT
 17723     END-IF
 17724     .
 17725 3785-CONTINUE.
 17726     if pb-state = 'TN'
 17727        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17728        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17729        MOVE '1'                 TO DC-OPTION-CODE
 17730        PERFORM 8500-DATE-CONVERT
 17731                                 THRU 8500-EXIT
 17732        IF no-CONVERSION-ERROR
 17733           IF DC-ELAPSED-DAYS < +16
 17734              GO TO 3999-END-EDIT
 17735           END-IF
 17736        END-IF
 17737     end-if
 17738***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17739***-_-
 17740***-_-   'NH' is 10%, TN is 3.5%
 17741***-_-
 17742***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17743*    if pb-state = 'NH'
 17744*       move +1.10               to ws-work-rate
 17745*    else
 17746*       move +1.035              to ws-work-rate
 17747*    end-if
 17748     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17749     display ' cal int ' ws-st-refund-int-rate ' ' ws-work-rate
 17750       ' ' dc-elapsed-days
 17751     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17752        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17753           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17754     IF WS-PAYMENT-AMT < 10.00
 17755        GO TO 3999-END-EDIT
 17756     END-IF
 17757*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17758
 17759     if (cm-soc-sec-no(1:9) numeric)
 17760        and (cm-soc-sec-no(1:9) not = zeros)
 17761        GO TO 3999-END-EDIT
 17762     END-IF
 17763     MOVE ER-2795                TO WS-ERROR
 17764     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17765
 17766     GO TO 3999-END-EDIT.
 17767******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 321
* EL050.cbl
 17769 3990-FILES-NOT-OPEN.
 17770
 17771     MOVE ER-2617                TO WS-ERROR.
 17772     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17773     GO TO 9990-RETURN.
 17774
 17775 3999-END-EDIT.
 17776
 17777     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17778
 17779     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17780         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17781         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17782             PERFORM 9250-UNLOCK-RETURN
 17783             GO TO 9990-RETURN
 17784          ELSE
 17785             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17786             GO TO 9990-RETURN.
 17787
 17788     IF PB-CANCELLATION
 17789          GO TO 9990-RETURN.
 17790
 17791     IF CERT-WAS-NOT-FOUND
 17792        MOVE SPACES              TO CERTIFICATE-MASTER.
 17793
 17794     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17795
 17796     IF CERT-WAS-FOUND
 17797         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17798             PERFORM 9250-UNLOCK-RETURN
 17799          ELSE
 17800            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17801      ELSE
 17802         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17803
 17804*    if pb-company-id = 'VPP'
 17805*       perform 8150-read-elcrtt thru 8150-exit
 17806*       if ws-vehicle-odometer numeric
 17807*          if ws-vehicle-odometer > 6000
 17808*             move er-1583       to ws-error
 17809*             PERFORM 9900-ERROR-FORMAT
 17810*                                THRU 9900-EXIT
 17811*          end-if
 17812*       end-if
 17813*    end-if
 17814     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17815        IF ((PB-COMPANY-ID = 'DCC')
 17816           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17817                         or
 17818            (pb-company-id = 'CID' or 'VPP')
 17819            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17820        END-IF
 17821     END-IF.
 17822
 17823     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17824         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17825     END-IF.
 17826     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 322
* EL050.cbl
 17827     perform 8150-read-elcrtt    thru 8150-exit
 17828     if ws-ins-age-defaulted = 'Y'
 17829        move er-1573             to ws-error
 17830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17831     end-if
 17832
 17833     if ws-jnt-age-defaulted = 'Y'
 17834        move er-1574             to ws-error
 17835        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17836     end-if
 17837***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17838***                                                           ****
 17839***  Set an error if the state requires verification of agent ****
 17840***  and agent hasn't verified yet and the status is not =    ****
 17841***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17842***  and the entry date > 09/01/2015.                         ****
 17843***                                                           ****
 17844***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17845     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17846        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17847        and (pb-account (9:2) not = 'OB')
 17848        if (ws-st-agent-sig-edit = 'Y')
 17849           and (am-report-code-1 not = 'CONLEY')
 17850           evaluate true
 17851              when cs-agent-edit-status = 'C'
 17852                 move er-1743    to ws-error
 17853                 perform 9900-error-format
 17854                                 thru 9900-exit
 17855              when cs-agent-edit-status = 'S'
 17856                 move er-1744    to ws-error
 17857                 perform 9900-error-format
 17858                                 thru 9900-exit
 17859              when cs-agent-edit-status = 'M'
 17860                 move er-1745    to ws-error
 17861                 perform 9900-error-format
 17862                                 thru 9900-exit
 17863              when cs-agent-edit-status = 'R'
 17864                 move er-1747    to ws-error
 17865                 perform 9900-error-format
 17866                                 thru 9900-exit
 17867              when cs-agent-edit-status = 'N'
 17868                 move er-1748    to ws-error
 17869                 perform 9900-error-format
 17870                                 thru 9900-exit
 17871              when cs-agent-edit-status <> 'V' and 'U' and
 17872                                           'R' and 'N'
 17873                 move er-1746    to ws-error
 17874                 perform 9900-error-format
 17875                                 thru 9900-exit
 17876           end-evaluate
 17877        end-if
 17878     end-if
 17879     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17880     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17881        AND (WS-NO-SECURE-PAY))
 17882                  OR
 17883        (WS-LF-SPECIAL-CALC-CD = 'O'
 17884        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 323
* EL050.cbl
 17885        SET SKIP-ADDR-EDIT       TO TRUE
 17886     END-IF
 17887     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17888        AND (NOT SKIP-ADDR-EDIT)
 17889        MOVE ER-2963             TO WS-ERROR
 17890        PERFORM 9900-ERROR-FORMAT
 17891                                 THRU 9900-EXIT
 17892        GO TO 9990-RETURN
 17893     END-IF
 17894     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17895     IF ERPNDM-FOUND NOT = 'X'
 17896        move 'Y'                 to erpndm-unlock-sw
 17897        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17898           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17899           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17900           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 17901           or (pm-zip-code    = zeros)
 17902           or (pm-zip-code not numeric))
 17903           AND (NOT SKIP-ADDR-EDIT)
 17904           MOVE ER-2694          TO WS-ERROR
 17905           PERFORM 9900-ERROR-FORMAT
 17906                                 THRU 9900-EXIT
 17907        END-IF
 17908        MOVE ' '                 TO STATE-RECORD-ERROR
 17909        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17910        MOVE PM-STATE            TO CNTL-ACCESS
 17911        MOVE '3'                 TO CNTL-REC-TYPE
 17912        MOVE +0                  TO CNTL-SEQ-NO
 17913        MOVE '0'                 TO RC-SW-2
 17914        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17915        IF (NO-STATE-RECORD)
 17916           OR (CF-RECORD-TYPE NOT = '3')
 17917           OR (PM-STATE NOT = CF-STATE-CODE)
 17918           IF (PM-STATE = SPACES)
 17919              AND (SKIP-ADDR-EDIT)
 17920              CONTINUE
 17921           ELSE
 17922              MOVE ER-2963       TO WS-ERROR
 17923              PERFORM 9900-ERROR-FORMAT
 17924                                 THRU 9900-EXIT
 17925           END-IF
 17926        END-IF
 17927        if (ws-error not = er-2963 and er-2694)
 17928           and (pm-city-st-zip-verified = ' ')
 17929           and (pb-company-id = 'CID')
 17930           move spaces           to zipcd-pass-area
 17931           move pm-zip-code      to pa-zip
 17932           move pm-city          to pa-city
 17933           move pm-state         to pa-state
 17934           perform 7790-call-zip-verify
 17935                                 thru 7790-exit
 17936           if pa-errorcode-zip (1:1) = ' '
 17937                    move 'Y'     to pm-city-st-zip-verified
 17938                    PERFORM 8102-REWRITE-ERPNDM
 17939                                 THRU 8102-EXIT
 17940                    move 'N'     to erpndm-unlock-sw
 17941           else
 17942              MOVE ER-3061       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 324
* EL050.cbl
 17943              PERFORM 9900-ERROR-FORMAT
 17944                                 THRU 9900-EXIT
 17945           end-if
 17946        end-if
 17947        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17948           MOVE ER-2883          TO WS-ERROR
 17949           PERFORM 9900-ERROR-FORMAT
 17950                                 THRU 9900-EXIT
 17951        END-IF
 17952        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17953           MOVE ' '                 TO STATE-RECORD-ERROR
 17954           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17955           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17956           MOVE '3'                 TO CNTL-REC-TYPE
 17957           MOVE +0                  TO CNTL-SEQ-NO
 17958           MOVE '0'                 TO RC-SW-2
 17959           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17960           IF NO-STATE-RECORD
 17961              OR (CF-RECORD-TYPE NOT = '3')
 17962              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17963              MOVE ER-2964          TO WS-ERROR
 17964              PERFORM 9900-ERROR-FORMAT
 17965                                    THRU 9900-EXIT
 17966           END-IF
 17967        END-IF
 17968     ELSE
 17969        IF NOT SKIP-ADDR-EDIT
 17970           MOVE ER-2393          TO WS-ERROR
 17971           PERFORM 9900-ERROR-FORMAT
 17972                                 THRU 9900-EXIT
 17973        END-IF
 17974     END-IF
 17975     if need-to-unlock-erpndm
 17976        perform 8104-unlock-erpndm
 17977                                 thru 8104-exit
 17978     end-if
 17979     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17980
 17981     IF (ERMAIL-FOUND = ' ' AND
 17982        ERPNDM-FOUND = ' ')
 17983        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17984           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17985           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17986          OR
 17987           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17988          OR
 17989           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17990           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17991           GO TO 3999-UNLOCK-ERMAIL.
 17992
 17993     IF ERPNDM-FOUND = 'X'
 17994        GO TO 3999-UNLOCK-ERMAIL.
 17995
 17996     IF PM-INSURED-LAST-NAME      = SPACES
 17997        AND PM-INSURED-FIRST-NAME = SPACES
 17998        AND PM-ADDRESS-LINE-1     = SPACES
 17999        AND PM-ADDRESS-LINE-2     = SPACES
 18000        AND PM-CITY-STATE         = SPACES
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 325
* EL050.cbl
 18001        AND PM-CRED-BENE-NAME     = SPACES
 18002        AND PM-CRED-BENE-ADDR     = SPACES
 18003        AND PM-CRED-BENE-CTYST    = SPACES
 18004        GO TO 3999-UNLOCK-ERMAIL
 18005     END-IF
 18006
 18007     MOVE SPACES                 TO MAILING-DATA.
 18008
 18009     MOVE 'MA'                   TO MA-RECORD-ID.
 18010     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18011     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18012     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18013     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18014     MOVE PB-SV-STATE            TO MA-STATE.
 18015     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18016     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18017
 18018     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18019     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18020
 18021     IF ERMAIL-FOUND = ' '
 18022        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18023     ELSE
 18024        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18025        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18026        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18027
 18028     GO TO 9990-RETURN.
 18029
 18030 3999-UNLOCK-ERMAIL.
 18031     IF ERMAIL-FOUND = ' '
 18032        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18033
 18034     GO TO 9990-RETURN.
 18035******************************************************************
 18036
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 326
* EL050.cbl
 18038 4000-UPDATE-CANCELLED-CERT.
 18039     IF CERT-WAS-NOT-FOUND
 18040        GO TO 4299-EXIT.
 18041
 18042*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18043     IF PB-C-INT-ON-REFS > ZEROS
 18044        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18045     END-IF
 18046     IF PB-C-REF-INTERFACE-SW = 'Y'
 18047        MOVE PB-C-REF-INTERFACE-SW
 18048                                 TO CM-REF-INTERFACE-SW
 18049     END-IF
 18050     IF ERMAIL-FOUND = ' '
 18051        PERFORM 8140-UNLOCK-ERMAIL
 18052                                 THRU 8140-EXIT
 18053     end-if
 18054     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18055     IF ERMAIL-FOUND = 'X'
 18056        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18057        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18058        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18059        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18060           MOVE ER-2694          TO WS-ERROR
 18061           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18062     END-IF
 18063
 18064     IF PB-C-POST-CARD-IND = 'Y'
 18065        MOVE +8                  TO SUB
 18066*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18067        IF ERMAIL-FOUND = ' '
 18068           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18069              (SUB > +7)
 18070              OR (MA-MAIL-STATUS (SUB) = '1')
 18071           END-PERFORM
 18072        END-IF
 18073        IF (SUB > +7)
 18074           OR (ERMAIL-FOUND = 'X')
 18075           MOVE ER-3789          TO WS-ERROR
 18076           PERFORM 9900-ERROR-FORMAT
 18077                                 THRU 9900-EXIT
 18078        END-IF
 18079     ELSE
 18080        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18081     END-IF
 18082
 18083     IF ERMAIL-FOUND = ' '
 18084        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18085     END-IF.
 18086
 18087     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18088
 18089     IF PB-CI-OB-FLAG = 'Z'
 18090        GO TO 4150-SUMMARY-CERT-CANCEL.
 18091
 18092     IF PB-C-LF-CANCEL-VOIDED
 18093         PERFORM 4200-REVERSE-LF-CANCEL.
 18094     IF PB-C-AH-CANCEL-VOIDED
 18095         PERFORM 4200-REVERSE-AH-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 327
* EL050.cbl
 18096
 18097 4100-APPLY-LF-CANCEL.
 18098
 18099     MOVE +0                     TO WS-SUB.
 18100
 18101 4100-CHECK-LF-ERRORS.
 18102
 18103     ADD +1                       TO WS-SUB.
 18104
 18105     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18106        IF LF-COVERAGE-CANCELLED
 18107           GO TO 4100-LF-CANCEL-CONT
 18108        ELSE
 18109           GO TO 4100-UPDATE-LF-COVERAGE.
 18110
 18111     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18112                                   ER-2729 OR
 18113                                   ER-2730 OR
 18114                                   ER-2731 OR
 18115                                   ER-2732 OR
 18116                                   ER-2737 OR
 18117                                   ER-2740 OR
 18118                                   ER-2743 OR
 18119                                   ER-2749 OR
 18120                                   ER-2750 OR
 18121                                   ER-2755 OR
 18122                                   ER-2757 OR
 18123                                   ER-2760 OR
 18124                                   ER-2772 OR
 18125                                   ER-2774 OR
 18126                                   ER-2776 OR
 18127                                   ER-2794
 18128        GO TO 4100-UPDATE-LF-COVERAGE.
 18129
 18130     GO TO 4100-CHECK-LF-ERRORS.
 18131
 18132 4100-UPDATE-LF-COVERAGE.
 18133
 18134     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18135     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18136     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18137        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18138     END-IF
 18139     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18140                                      TO CM-CREDIT-INTERFACE-SW-2.
 18141     IF CM-LF-CANCEL-DT = LOW-VALUE
 18142         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18143
 18144     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18145         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18146                                         CM-LF-STATUS-AT-CANCEL.
 18147
 18148     GO TO 4100-APPLY-AH-CANCEL.
 18149
 18150 4100-LF-CANCEL-CONT.
 18151     IF PB-C-LF-CANCEL-VOIDED
 18152         GO TO 4100-APPLY-AH-CANCEL.
 18153
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 328
* EL050.cbl
 18154     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18155         GO TO 4100-APPLY-AH-CANCEL.
 18156
 18157     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18158        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18159           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18160        ELSE
 18161           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18162
 18163     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18164     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18165
 18166     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18167         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18168
 18169     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18170        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18171         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18172         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18173
 18174     IF PB-RECORD-RETURNED
 18175        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18176      ELSE
 18177        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18178
 18179 4100-APPLY-AH-CANCEL.
 18180
 18181     MOVE +0                      TO WS-SUB.
 18182
 18183 4100-CHECK-AH-ERRORS.
 18184
 18185     ADD +1                       TO WS-SUB.
 18186
 18187     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18188        IF AH-COVERAGE-CANCELLED
 18189           GO TO 4100-AH-CANCEL-CONT
 18190        ELSE
 18191           GO TO 4100-UPDATE-AH-COVERAGE.
 18192
 18193     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18194                                   ER-2729 OR
 18195                                   ER-2732 OR
 18196                                   ER-2737 OR
 18197                                   ER-2740 OR
 18198                                   ER-2744 OR
 18199                                   ER-2749 OR
 18200                                   ER-2750 OR
 18201                                   ER-2755 OR
 18202                                   ER-2757 OR
 18203                                   ER-2760 OR
 18204                                   ER-2771 OR
 18205                                   ER-2772 OR
 18206                                   ER-2773 OR
 18207                                   ER-2775 OR
 18208                                   ER-2777 OR
 18209                                   ER-2778 OR
 18210                                   ER-2794
 18211        GO TO 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 329
* EL050.cbl
 18212
 18213     GO TO 4100-CHECK-AH-ERRORS.
 18214
 18215 4100-UPDATE-AH-COVERAGE.
 18216
 18217     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18218     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18219     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18220     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18221                                      TO CM-CREDIT-INTERFACE-SW-2.
 18222     IF CM-AH-CANCEL-DT = LOW-VALUE
 18223         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18224
 18225     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18226         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18227                                         CM-AH-STATUS-AT-CANCEL.
 18228
 18229     IF LF-COVERAGE-CANCELLED
 18230         IF PB-RECORD-RETURNED
 18231              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18232          ELSE
 18233              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18234
 18235     GO TO 4299-EXIT.
 18236
 18237 4100-AH-CANCEL-CONT.
 18238     IF PB-C-AH-CANCEL-VOIDED
 18239         GO TO 4299-EXIT.
 18240
 18241     if cm-credit-interface-sw-2 = ' '
 18242        if pb-fatal-errors or pb-unforced-errors
 18243           move '4'              to cm-credit-interface-sw-2
 18244        else
 18245           move '1'              to cm-credit-interface-sw-2
 18246        end-if
 18247     end-if
 18248     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18249         GO TO 4299-EXIT.
 18250
 18251     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18252        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18253           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18254        ELSE
 18255           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18256
 18257     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18258     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18259
 18260     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18261         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18262
 18263     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18264         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18265         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18266
 18267     IF PB-RECORD-RETURNED
 18268        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18269      ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 330
* EL050.cbl
 18270        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18271
 18272     GO TO 4299-EXIT.
 18273
 18274 4150-SUMMARY-CERT-CANCEL.
 18275     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18276
 18277     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18278        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18279                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18280     ELSE
 18281        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18282                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18283
 18284     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18285        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18286                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18287     ELSE
 18288        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18289                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18290
 18291     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18292        NEXT SENTENCE
 18293     ELSE
 18294        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18295
 18296     GO TO 4299-EXIT.
 18297
 18298 4200-REVERSE-LF-CANCEL.
 18299     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18300
 18301     IF CM-LF-CANCEL-APPLIED
 18302        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18303        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18304        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 18305
 18306     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18307
 18308     IF PB-RECORD-RETURNED
 18309        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18310       ELSE
 18311        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18312
 18313 4200-REVERSE-LF-EXIT.
 18314       EXIT.
 18315
 18316 4200-REVERSE-AH-CANCEL.
 18317     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18318
 18319     IF CM-AH-CANCEL-APPLIED
 18320        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18321        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18322        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18323
 18324     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18325
 18326     IF PB-RECORD-RETURNED
 18327        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 331
* EL050.cbl
 18328       ELSE
 18329        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18330
 18331 4200-REVERSE-AH-EXIT.
 18332       EXIT.
 18333
 18334 4299-EXIT.
 18335       EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 332
* EL050.cbl
 18337
 18338 4500-UPDATE-NEW-CERT.
 18339     IF CERT-WAS-FOUND
 18340         NEXT SENTENCE
 18341       ELSE
 18342         GO TO 4520-BUILD-NEW-KEY.
 18343
 18344     IF  CLASIC-CREATED-CERT
 18345         GO TO 4999-EXIT.
 18346
 18347     IF  CERT-WAS-CREATED-FOR-CLAIM
 18348         GO TO 4520-BUILD-NEW-KEY.
 18349
 18350     IF CERT-ADDED-BATCH
 18351        IF CM-RECORD-ID = 'CM'
 18352            GO TO 4999-EXIT.
 18353
 18354 4520-BUILD-NEW-KEY.
 18355* BUILD CONTROL PRIMARY
 18356
 18357     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18358                                       CM-COMPANY-CD-A1
 18359                                       CM-COMPANY-CD-A2
 18360                                       CM-COMPANY-CD-A4
 18361                                       CM-COMPANY-CD-A5.
 18362
 18363     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18364     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18365     MOVE PB-SV-STATE               TO CM-STATE.
 18366     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18367     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18368     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18369     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18370
 18371     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18372
 18373     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18374     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18375     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18376     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18377
 18378     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18379        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18380
 18381     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18382         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18383         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18384         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18385         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18386     ELSE
 18387         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18388
 18389     IF PB-COMPANY-ID   EQUAL  'CRI'
 18390         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18391         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18392         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18393         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18394         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 333
* EL050.cbl
 18395
 18396     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18397        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18398         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18399
 18400     IF PB-COMPANY-ID  = 'LBL'
 18401        IF PB-I-JOINT-COVERAGE
 18402            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18403                                           PB-I-MEMBER-NO
 18404            GO TO 4550-CONT-CERT-PROCESS.
 18405
 18406     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18407        NEXT SENTENCE
 18408     ELSE
 18409        GO TO 4540-BUILD-MEMBER-NO.
 18410
 18411******************************************************************
 18412*                                                                *
 18413*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18414*    FOR 'MON'.                                                  *
 18415*                                                                *
 18416******************************************************************
 18417
 18418     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18419     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18420     MOVE +1                     TO WS-SUB1
 18421                                    WS-SUB2.
 18422
 18423 4530-EDIT-MEMB-NAME.
 18424
 18425     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18426        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18427        ADD +1                       TO WS-SUB2.
 18428
 18429     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18430        ADD +1                       TO WS-SUB1
 18431        GO TO 4530-EDIT-MEMB-NAME.
 18432
 18433     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18434     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18435     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18436*    MOVE SPACE                      TO DC-OPTION-CODE.
 18437     SET  BIN-TO-GREG                TO TRUE.
 18438     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18439     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18440
 18441     GO TO 4550-CONT-CERT-PROCESS.
 18442
 18443******************************************************************
 18444*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18445******************************************************************
 18446
 18447 4540-BUILD-MEMBER-NO.
 18448
 18449     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18450         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18451         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18452         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 334
* EL050.cbl
 18453         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18454     ELSE
 18455         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18456
 18457     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18458        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18459         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18460
 18461 4550-CONT-CERT-PROCESS.
 18462
 18463*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18464*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18465*    ELSE
 18466*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18467
 18468     IF CERT-WAS-CREATED-FOR-CLAIM
 18469        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18470        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18471
 18472     IF CERT-AND-CLAIM-ONLINE
 18473        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18474        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18475
 18476     MOVE 'CM'                     TO CM-RECORD-ID.
 18477     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18478
 18479     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18480        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18481        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18482     ELSE
 18483        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18484        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18485
 18486     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18487     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18488     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18489     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18490     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18491     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18492     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18493                                      CM-LF-ITD-CANCEL-AMT
 18494                                      CM-LF-ITD-DEATH-AMT
 18495                                      CM-AH-ITD-AH-PMT
 18496                                      CM-AH-ITD-LUMP-PMT
 18497                                      CM-AH-ITD-CANCEL-AMT
 18498                                      CM-LF-NSP-PREMIUM-AMT
 18499                                      CM-AH-NSP-PREMIUM-AMT.
 18500*                                     CM-CLAIM-DEDUCT-WITHHELD
 18501*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18502     if pb-i-loan-apr = +99.9999
 18503        move zeros                 to cm-loan-apr
 18504     else
 18505        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18506     end-if
 18507     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18508     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18509     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18510     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 335
* EL050.cbl
 18511     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18512     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18513     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18514     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18515     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18516     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18517     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18518
 18519     IF PB-I-LIVES NOT NUMERIC
 18520         MOVE ZERO                 TO PB-I-LIVES.
 18521
 18522     IF PB-I-NUM-BILLED NOT NUMERIC
 18523         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18524
 18525     MOVE PB-I-LIVES               TO CM-LIVES.
 18526     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18527
 18528     IF PB-COMPANY-ID EQUAL  'DMD'
 18529         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18530         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18531
 18532     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18533     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18534     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18535     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18536     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18537     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18538
 18539     IF PB-I-LF-POLICY-FEE NUMERIC
 18540        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18541     ELSE
 18542        MOVE +0                    TO CM-LF-POLICY-FEE.
 18543
 18544     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18545        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18546        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18547     ELSE
 18548        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18549
 18550     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18551     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18552     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18553     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18554     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18555     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18556     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18557     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18558     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18559
 18560     IF PB-I-CANCEL-FEE NUMERIC
 18561        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18562     ELSE
 18563        MOVE +0                  TO CM-CANCEL-FEE
 18564     END-IF
 18565
 18566     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18567        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18568     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 336
* EL050.cbl
 18569        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18570
 18571     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18572     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18573
 18574     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18575                                      CM-LF-DEATH-EXIT-DT
 18576                                      CM-AH-SETTLEMENT-EXIT-DT.
 18577
 18578*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18579*                       'TIH' OR 'OFL' OR 'FLA' OR
 18580*                       'TII' OR 'TMS' OR 'CRI' OR
 18581*                       'NCL'
 18582     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18583
 18584     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18585         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18586            MOVE '2'                TO CM-PREMIUM-TYPE.
 18587
 18588     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18589         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18590            MOVE '2'                TO CM-PREMIUM-TYPE.
 18591
 18592     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18593         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18594     ELSE
 18595         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18596         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18597
 18598     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18599     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18600     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18601     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18602     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18603     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18604     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18605     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18606
 18607     IF PB-NO-MONTHS-SKIPPED
 18608         MOVE SPACE                 TO CM-SKIP-CODE
 18609     ELSE
 18610         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18611
 18612     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18613     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18614                                       CM-LF-STATUS-AT-CANCEL.
 18615
 18616     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18617     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18618                                       CM-AH-STATUS-AT-CANCEL.
 18619
 18620     MOVE '1'                       TO CM-ENTRY-STATUS.
 18621
 18622     IF PB-REISSUED-CERT
 18623        MOVE '5'                    TO CM-ENTRY-STATUS.
 18624
 18625     IF PB-MONTHLY-CERT
 18626        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 337
* EL050.cbl
 18627
 18628     IF PB-CASH-CERT
 18629        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18630
 18631     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18632     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18633     IF PB-POLICY-IS-DECLINED
 18634        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18635
 18636     IF PB-POLICY-IS-VOIDED
 18637        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18638
 18639     IF PB-NEEDS-UNDERWRITING
 18640        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18641
 18642     IF PB-REIN-ONLY-CERT
 18643        MOVE '9'                    TO CM-ENTRY-STATUS.
 18644
 18645     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18646         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18647     ELSE
 18648         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18649
 18650     IF PB-RECORD-RETURNED
 18651        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18652      ELSE
 18653        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18654
 18655     IF PB-I-MAIL-ADDRS-PRESENT
 18656        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18657
 18658     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18659                                       CM-ENTRY-DT.
 18660
 18661 4999-EXIT.
 18662     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 338
* EL050.cbl
 18664
 18665 5000-PROCESS-REPS.
 18666     MOVE ' '                    TO AGTC-MASTER-SW
 18667     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18668     MOVE CO-TYPE                TO AGTC-TYPE
 18669     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18670     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18671     IF (AGTC-MASTER-SW NOT = 'N')
 18672        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18673        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18674        PERFORM 8583-READ-ERAGTC-NEXT
 18675                                 THRU 8583-EXIT
 18676     END-IF
 18677     IF AGTC-MASTER-SW = 'N'
 18678        CONTINUE
 18679     ELSE
 18680        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18681           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18682              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18683              MOVE 'Y'           TO AGTC-MASTER-SW
 18684           END-IF
 18685        END-IF
 18686     END-IF
 18687     .
 18688 5000-EXIT.
 18689     EXIT.
 18690 6370-EDIT-INPUT-LF-CODE.
 18691     move ' ' to ws-benefit-cd-chg-sw
 18692     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18693        MOVE +1                  TO SUB
 18694        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18695        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18696        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18697        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18698        GO TO 6370-SEARCH-LOOP.
 18699
 18700     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18701
 18702     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18703     MOVE SPACES                 TO CNTL-ACCESS.
 18704*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18705     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18706     MOVE +0                     TO CNTL-SEQ-NO.
 18707     MOVE '4' TO RC-SW-2.
 18708     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18709
 18710     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18711        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18712        GO TO 6370-NO-LF-FOUND.
 18713
 18714     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18715     MOVE +1                     TO SUB.
 18716
 18717 6370-SEARCH-LOOP.
 18718     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18719         GO TO 6370-NO-LF-FOUND.
 18720
 18721     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 339
* EL050.cbl
 18722        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18723           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18724           set benefit-code-chg to true
 18725        end-if
 18726        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18727        GO TO 6370-HER-NET-PAY-CHECK.
 18728
 18729     ADD 1   TO SUB.
 18730*    IF SUB GREATER 120
 18731     IF SUB GREATER 200
 18732         GO TO 6370-NO-LF-FOUND.
 18733
 18734     GO TO 6370-SEARCH-LOOP.
 18735
 18736 6370-NO-LF-FOUND.
 18737
 18738     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18739        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18740        set benefit-code-chg to true
 18741     end-if
 18742     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18743
 18744 6370-HER-NET-PAY-CHECK.
 18745
 18746     IF PB-COMPANY-ID = 'CID'
 18747        IF PB-SV-STATE = 'CA' OR 'MN'
 18748           IF PB-I-LF-BENEFIT-CD = '02'
 18749              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18750           ELSE
 18751              IF PB-I-LF-BENEFIT-CD = '04'
 18752                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18753              END-IF
 18754           END-IF
 18755        END-IF
 18756     END-IF
 18757
 18758     IF PB-COMPANY-ID NOT = 'HER'
 18759         GO TO 6370-EXIT.
 18760
 18761     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18762         GO TO 6370-EXIT.
 18763
 18764     IF PB-I-LF-TERM NOT NUMERIC
 18765         MOVE ZEROS              TO PB-I-LF-TERM.
 18766
 18767     IF PB-I-LOAN-TERM NOT NUMERIC
 18768         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18769
 18770     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18771         GO TO 6370-EXIT.
 18772
 18773     IF PB-I-LF-BENEFIT-CD = '33'
 18774         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18775
 18776     IF PB-I-LF-BENEFIT-CD = '34'
 18777         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18778
 18779 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 340
* EL050.cbl
 18780     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 341
* EL050.cbl
 18782
 18783 6380-EDIT-INPUT-AH-CODE.
 18784     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18785        MOVE +1                  TO SUB
 18786        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18787        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18788        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18789        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18790        GO TO 6380-SEARCH-LOOP.
 18791
 18792     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18793
 18794     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18795     MOVE SPACES                 TO CNTL-ACCESS.
 18796     MOVE 'A'                    TO CNTL-REC-TYPE.
 18797*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18798     MOVE +0                     TO CNTL-SEQ-NO.
 18799     MOVE '5' TO RC-SW-2.
 18800     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18801
 18802     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18803        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18804        GO TO 6380-NO-AH-FOUND.
 18805
 18806     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18807     MOVE +1 TO SUB.
 18808
 18809 6380-SEARCH-LOOP.
 18810     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18811         GO TO 6380-NO-AH-FOUND.
 18812
 18813     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18814         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18815         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18816
 18817     ADD 1   TO SUB.
 18818     IF SUB GREATER THAN 96
 18819*    IF SUB GREATER THAN 300
 18820         GO TO 6380-NO-AH-FOUND.
 18821
 18822     GO TO 6380-SEARCH-LOOP.
 18823
 18824 6380-NO-AH-FOUND.
 18825
 18826     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18827
 18828     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18829         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18830     ELSE
 18831         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18832
 18833 6380-CSO-AH-ONLY-CHECKS.
 18834
 18835     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18836        NEXT SENTENCE
 18837      ELSE
 18838        GO TO 6380-EXIT.
 18839
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 342
* EL050.cbl
 18840     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18841         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18842
 18843
 18844     GO TO 6380-EXIT
 18845     .
 18846 6380-CSO-LIFE-WITH-AH-CHECKS.
 18847
 18848
 18849     .
 18850 6380-EXIT.
 18851     EXIT.
 18852
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 343
* EL050.cbl
 18854
 18855 6400-COMPUTE-EXTENSION-DAYS.
 18856
 18857******************************************************************
 18858*                                                                *
 18859*                   COMPUTE EXTENSION DAYS                       *
 18860*                                                                *
 18861*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18862*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18863*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18864*    THE EXTENSION DAYS.                                         *
 18865*                                                                *
 18866******************************************************************
 18867
 18868     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18869     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18870
 18871******************************************************************
 18872*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18873*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18874******************************************************************
 18875
 18876     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18877        COMPUTE WS-ODD-DAYS-OVER =
 18878               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18879     ELSE
 18880        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18881
 18882     IF WS-ODD-DAYS-OVER = ZEROS
 18883           GO TO 6499-EXIT
 18884     ELSE
 18885        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18886           IF WS-WDF-MONTH = 02
 18887              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18888              ADD 2       TO  WS-ODD-DAYS-OVER
 18889              GO TO 6499-EXIT
 18890           ELSE
 18891              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18892                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18893                 GO TO 6499-EXIT
 18894               ELSE
 18895                 GO TO 6499-EXIT
 18896        ELSE
 18897           GO TO 6499-EXIT.
 18898
 18899 6412-CHECK-TO-DAY.
 18900
 18901        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18902           IF WS-WDT-DAY = 28
 18903              ADD 2              TO WS-ODD-DAYS-OVER
 18904           ELSE
 18905              IF WS-WDT-DAY = 29
 18906                 ADD 1           TO WS-ODD-DAYS-OVER
 18907              ELSE
 18908                 NEXT SENTENCE
 18909        ELSE
 18910           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18911              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 344
* EL050.cbl
 18912
 18913     GO TO 6499-EXIT.
 18914
 18915
 18916 6415-CHECK-LEAP-YEAR.
 18917
 18918     IF DC-DAYS-IN-MONTH = 29
 18919        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18920
 18921 6415-EXIT.
 18922     EXIT.
 18923
 18924 6499-EXIT.
 18925      EXIT.
 18926
 18927 6500-END.
 18928     EXIT.
 18929
 18930
 18931******************************************************************
 18932************* PROCEDURE DIVISION FOR EL050 ***********************
 18933********************** ELC50PD END *******************************
 18934
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 345
* EL050.cbl
 18936
 18937**START***********************************************************
 18938*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18939*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18940******************************************************************
 18941*
 18942 6600-GET-STATE-MUNICIPAL-TAX.
 18943
 18944     IF PB-COMPANY-ID NOT = 'DMD'
 18945         GO TO 6640-EXIT.
 18946
 18947     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18948     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18949     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18950*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18951*
 18952***  Y2K PROJ 7744
 18953     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18954     SET BIN-TO-GREG          TO TRUE.
 18955     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18956
 18957     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18958
 18959     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18960     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18961
 18962
 18963* EXEC CICS HANDLE CONDITION
 18964*        INVREQ    (6610-START-BROWSE)
 18965*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18966*        NOTFND    (6630-END-OF-FILE)
 18967*    END-EXEC.
 18968*    MOVE '"$8JI                 ! # #00018952' TO DFHEIV0
 18969     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18970     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18971     MOVE X'2320233030303138393532' TO DFHEIV0(25:11)
 18972     CALL 'kxdfhei1' USING DFHEIV0
 18973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18974
 18975
 18976 6610-START-BROWSE.
 18977
 18978
 18979* EXEC CICS HANDLE CONDITION
 18980*        NOTFND    (6630-END-OF-FILE)
 18981*        DISABLED  (6630-ERRESS-PROBLEM)
 18982*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18983*        ENDFILE   (6630-END-OF-FILE)
 18984*    END-EXEC.
 18985*    MOVE '"$IcJ''                ! $ #00018960' TO DFHEIV0
 18986     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18987     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18988     MOVE X'2420233030303138393630' TO DFHEIV0(25:11)
 18989     CALL 'kxdfhei1' USING DFHEIV0
 18990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18991
 18992
 18993
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 346
* EL050.cbl
 18994* EXEC CICS STARTBR
 18995*        DATASET (FILE-ID-ERRESS)
 18996*        RIDFLD  (WS-ERRESS-KEY)
 18997*        GTEQ
 18998*    END-EXEC.
 18999     MOVE 0
 19000       TO DFHEIV11
 19001*    MOVE '&,         G          &   #00018967' TO DFHEIV0
 19002     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19003     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19004     MOVE X'2020233030303138393637' TO DFHEIV0(25:11)
 19005     CALL 'kxdfhei1' USING DFHEIV0,
 19006           FILE-ID-ERRESS,
 19007           WS-ERRESS-KEY,
 19008           DFHEIV99,
 19009           DFHEIV11,
 19010           DFHEIV99
 19011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19012
 19013
 19014 6620-READ-NEXT-ERRESS-MASTER.
 19015
 19016
 19017* EXEC CICS HANDLE CONDITION
 19018*        NOTFND    (6630-END-OF-FILE)
 19019*        ENDFILE   (6630-END-OF-FILE)
 19020*        DISABLED  (6630-ERRESS-PROBLEM)
 19021*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19022*    END-EXEC.
 19023*    MOVE '"$I''cJ                ! % #00018975' TO DFHEIV0
 19024     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19025     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19026     MOVE X'2520233030303138393735' TO DFHEIV0(25:11)
 19027     CALL 'kxdfhei1' USING DFHEIV0
 19028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19029
 19030
 19031
 19032* EXEC CICS READNEXT
 19033*        DATASET (FILE-ID-ERRESS)
 19034*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19035*        RIDFLD  (WS-ERRESS-KEY)
 19036*    END-EXEC.
 19037     MOVE LENGTH OF
 19038      RESIDENT-STATE-TAX-MASTER
 19039       TO DFHEIV12
 19040     MOVE 0
 19041       TO DFHEIV11
 19042*    MOVE '&.IL                  )   #00018982' TO DFHEIV0
 19043     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19044     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19045     MOVE X'2020233030303138393832' TO DFHEIV0(25:11)
 19046     CALL 'kxdfhei1' USING DFHEIV0,
 19047           FILE-ID-ERRESS,
 19048           RESIDENT-STATE-TAX-MASTER,
 19049           DFHEIV12,
 19050           WS-ERRESS-KEY,
 19051           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 347
* EL050.cbl
 19052           DFHEIV11,
 19053           DFHEIV99,
 19054           DFHEIV99
 19055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19056
 19057
 19058     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19059
 19060* EXEC CICS ENDBR
 19061*            DATASET (FILE-ID-ERRESS)
 19062*       END-EXEC
 19063     MOVE 0
 19064       TO DFHEIV11
 19065*    MOVE '&2                    $   #00018989' TO DFHEIV0
 19066     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19067     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19068     MOVE X'2020233030303138393839' TO DFHEIV0(25:11)
 19069     CALL 'kxdfhei1' USING DFHEIV0,
 19070           FILE-ID-ERRESS,
 19071           DFHEIV11,
 19072           DFHEIV99
 19073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19074        GO TO 6630-END-OF-FILE.
 19075
 19076     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19077        NEXT SENTENCE
 19078      ELSE
 19079        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19080
 19081*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19082*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19083*
 19084     MOVE +2                     TO WS-SUB1.
 19085
 19086     IF PB-ISSUE
 19087     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19088        MOVE +1                  TO WS-SUB1.
 19089
 19090     IF PB-CANCELLATION
 19091     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19092        MOVE +1                  TO WS-SUB1.
 19093*
 19094*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19095*
 19096***  Y2K PROJ 7744
 19097     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19098***  Y2K PROJ 7744
 19099
 19100*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19101* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19102* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19103
 19104     ADD 1                    TO WS-YEAR-YY.
 19105
 19106     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19107         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19108                              TO WS-RES-STATE-TAX
 19109         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 348
* EL050.cbl
 19110                              TO WS-RES-MUNI-TAX
 19111     ELSE
 19112         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19113                              TO WS-RES-STATE-TAX
 19114         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19115                              TO WS-RES-MUNI-TAX.
 19116
 19117*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19118
 19119     IF PB-CANCELLATION
 19120         GO TO 6640-CANCEL-TAX.
 19121
 19122     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19123         COMPUTE PB-I-STATE-TAX ROUNDED =
 19124                                   PB-I-LF-PREMIUM-AMT
 19125                                 * WS-RES-STATE-TAX
 19126         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19127                                   PB-I-LF-PREMIUM-AMT
 19128                                 * WS-RES-MUNI-TAX
 19129     ELSE
 19130     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19131         COMPUTE PB-I-STATE-TAX ROUNDED =
 19132                                   PB-I-AH-PREMIUM-AMT
 19133                                 * WS-RES-STATE-TAX
 19134         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19135                                   PB-I-AH-PREMIUM-AMT
 19136                                 * WS-RES-MUNI-TAX.
 19137
 19138
 19139* EXEC CICS ENDBR
 19140*         DATASET (FILE-ID-ERRESS)
 19141*    END-EXEC.
 19142     MOVE 0
 19143       TO DFHEIV11
 19144*    MOVE '&2                    $   #00019056' TO DFHEIV0
 19145     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19146     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19147     MOVE X'2020233030303139303536' TO DFHEIV0(25:11)
 19148     CALL 'kxdfhei1' USING DFHEIV0,
 19149           FILE-ID-ERRESS,
 19150           DFHEIV11,
 19151           DFHEIV99
 19152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19153
 19154
 19155     GO TO 6640-EXIT.
 19156
 19157 6640-CANCEL-TAX.
 19158     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19159
 19160     IF PB-C-LF-CANCEL-AMT > ZEROS
 19161         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19162                                   PB-C-LF-CANCEL-AMT
 19163                                 * WS-RES-STATE-TAX
 19164         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19165                                   PB-C-LF-CANCEL-AMT
 19166                                *  WS-RES-MUNI-TAX
 19167     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 349
* EL050.cbl
 19168     IF PB-C-AH-CANCEL-AMT > ZEROS
 19169         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19170                                   PB-C-AH-CANCEL-AMT
 19171                                 * WS-RES-STATE-TAX
 19172         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19173                                   PB-C-AH-CANCEL-AMT
 19174                                *  WS-RES-MUNI-TAX.
 19175
 19176
 19177* EXEC CICS ENDBR
 19178*         DATASET (FILE-ID-ERRESS)
 19179*    END-EXEC.
 19180     MOVE 0
 19181       TO DFHEIV11
 19182*    MOVE '&2                    $   #00019081' TO DFHEIV0
 19183     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19184     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19185     MOVE X'2020233030303139303831' TO DFHEIV0(25:11)
 19186     CALL 'kxdfhei1' USING DFHEIV0,
 19187           FILE-ID-ERRESS,
 19188           DFHEIV11,
 19189           DFHEIV99
 19190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19191
 19192
 19193     GO TO 6640-EXIT.
 19194
 19195 6630-END-OF-FILE.
 19196     MOVE ER-8002              TO WS-ERROR.
 19197     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19198
 19199     GO TO 6640-EXIT.
 19200
 19201 6630-ERRESS-PROBLEM.
 19202     MOVE ER-8044              TO WS-ERROR.
 19203     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19204
 19205 6640-EXIT.
 19206     EXIT.
 19207
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 350
* EL050.cbl
 19209 6650-GET-RES-STATE-COMM.
 19210
 19211     IF PB-COMPANY-ID NOT = 'DMD'
 19212         GO TO 6700-COMM-EXIT.
 19213
 19214     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19215     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19216     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19217     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19218     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19219     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19220     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19221
 19222*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19223*
 19224***  Y2K PROJ 7744
 19225     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19226     SET BIN-TO-GREG          TO TRUE.
 19227     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19228
 19229     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19230***  Y2K PROJ 7744
 19231
 19232     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19233
 19234
 19235* EXEC CICS HANDLE CONDITION
 19236*        INVREQ    (6660-START-BROWSE)
 19237*        DISABLED  (6690-ERRESC-PROBLEM)
 19238*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19239*        NOTFND    (6690-END-OF-FILE)
 19240*    END-EXEC.
 19241*    MOVE '"$8cJI                ! & #00019126' TO DFHEIV0
 19242     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19244     MOVE X'2620233030303139313236' TO DFHEIV0(25:11)
 19245     CALL 'kxdfhei1' USING DFHEIV0
 19246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19247
 19248
 19249
 19250* EXEC CICS RESETBR
 19251*        DATASET (FILE-ID-ERRESC)
 19252*        RIDFLD  (WS-ERRESC-KEY)
 19253*    END-EXEC.
 19254     MOVE 0
 19255       TO DFHEIV11
 19256*    MOVE '&4         G          &   #00019133' TO DFHEIV0
 19257     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19259     MOVE X'2020233030303139313333' TO DFHEIV0(25:11)
 19260     CALL 'kxdfhei1' USING DFHEIV0,
 19261           FILE-ID-ERRESC,
 19262           WS-ERRESC-KEY,
 19263           DFHEIV99,
 19264           DFHEIV11,
 19265           DFHEIV99
 19266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 351
* EL050.cbl
 19267
 19268
 19269 6660-START-BROWSE.
 19270
 19271
 19272* EXEC CICS HANDLE CONDITION
 19273*        NOTFND    (6690-END-OF-FILE)
 19274*        DISABLED  (6690-ERRESC-PROBLEM)
 19275*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19276*        ENDFILE   (6690-END-OF-FILE)
 19277*    END-EXEC.
 19278*    MOVE '"$IcJ''                ! '' #00019140' TO DFHEIV0
 19279     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19280     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19281     MOVE X'2720233030303139313430' TO DFHEIV0(25:11)
 19282     CALL 'kxdfhei1' USING DFHEIV0
 19283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19284
 19285
 19286
 19287* EXEC CICS STARTBR
 19288*        DATASET (FILE-ID-ERRESC)
 19289*        RIDFLD  (WS-ERRESC-KEY)
 19290*        GTEQ
 19291*    END-EXEC.
 19292     MOVE 0
 19293       TO DFHEIV11
 19294*    MOVE '&,         G          &   #00019147' TO DFHEIV0
 19295     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19296     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19297     MOVE X'2020233030303139313437' TO DFHEIV0(25:11)
 19298     CALL 'kxdfhei1' USING DFHEIV0,
 19299           FILE-ID-ERRESC,
 19300           WS-ERRESC-KEY,
 19301           DFHEIV99,
 19302           DFHEIV11,
 19303           DFHEIV99
 19304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19305
 19306
 19307     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19308
 19309 6670-READ-NEXT-ERRESC-MASTER.
 19310
 19311
 19312* EXEC CICS HANDLE CONDITION
 19313*        NOTFND    (6690-END-OF-FILE)
 19314*        DISABLED  (6690-ERRESC-PROBLEM)
 19315*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19316*        ENDFILE   (6690-END-OF-FILE)
 19317*    END-EXEC.
 19318*    MOVE '"$IcJ''                ! ( #00019157' TO DFHEIV0
 19319     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19320     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19321     MOVE X'2820233030303139313537' TO DFHEIV0(25:11)
 19322     CALL 'kxdfhei1' USING DFHEIV0
 19323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19324
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 352
* EL050.cbl
 19325
 19326
 19327* EXEC CICS READNEXT
 19328*        DATASET (FILE-ID-ERRESC)
 19329*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19330*        RIDFLD  (ERRESC-RECORD-KEY)
 19331*    END-EXEC.
 19332     MOVE LENGTH OF
 19333      ACCOUNT-RESIDENT-ST-COMMISSION
 19334       TO DFHEIV12
 19335     MOVE 0
 19336       TO DFHEIV11
 19337*    MOVE '&.IL                  )   #00019164' TO DFHEIV0
 19338     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19339     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19340     MOVE X'2020233030303139313634' TO DFHEIV0(25:11)
 19341     CALL 'kxdfhei1' USING DFHEIV0,
 19342           FILE-ID-ERRESC,
 19343           ACCOUNT-RESIDENT-ST-COMMISSION,
 19344           DFHEIV12,
 19345           ERRESC-RECORD-KEY,
 19346           DFHEIV99,
 19347           DFHEIV11,
 19348           DFHEIV99,
 19349           DFHEIV99
 19350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19351
 19352
 19353     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19354        NEXT SENTENCE
 19355     ELSE
 19356
 19357* EXEC CICS ENDBR
 19358*            DATASET (FILE-ID-ERRESC)
 19359*       END-EXEC
 19360     MOVE 0
 19361       TO DFHEIV11
 19362*    MOVE '&2                    $   #00019173' TO DFHEIV0
 19363     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19364     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19365     MOVE X'2020233030303139313733' TO DFHEIV0(25:11)
 19366     CALL 'kxdfhei1' USING DFHEIV0,
 19367           FILE-ID-ERRESC,
 19368           DFHEIV11,
 19369           DFHEIV99
 19370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19371        GO TO 6690-END-OF-FILE.
 19372
 19373     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19374
 19375* EXEC CICS ENDBR
 19376*            DATASET (FILE-ID-ERRESC)
 19377*       END-EXEC
 19378     MOVE 0
 19379       TO DFHEIV11
 19380*    MOVE '&2                    $   #00019179' TO DFHEIV0
 19381     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19382     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 353
* EL050.cbl
 19383     MOVE X'2020233030303139313739' TO DFHEIV0(25:11)
 19384     CALL 'kxdfhei1' USING DFHEIV0,
 19385           FILE-ID-ERRESC,
 19386           DFHEIV11,
 19387           DFHEIV99
 19388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19389        GO TO 6690-END-OF-FILE.
 19390
 19391     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19392        NEXT SENTENCE
 19393      ELSE
 19394        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19395
 19396* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19397*
 19398     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19399
 19400     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19401
 19402     IF WS-SUB1 > ZERO
 19403         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19404             PERFORM 6680-SET-COMMISSION
 19405         ELSE
 19406             PERFORM 6680-SET-TABLE-CODE.
 19407
 19408
 19409* EXEC CICS ENDBR
 19410*         DATASET (FILE-ID-ERRESC)
 19411*    END-EXEC.
 19412     MOVE 0
 19413       TO DFHEIV11
 19414*    MOVE '&2                    $   #00019201' TO DFHEIV0
 19415     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19416     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19417     MOVE X'2020233030303139323031' TO DFHEIV0(25:11)
 19418     CALL 'kxdfhei1' USING DFHEIV0,
 19419           FILE-ID-ERRESC,
 19420           DFHEIV11,
 19421           DFHEIV99
 19422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19423
 19424
 19425     GO TO 6700-COMM-EXIT.
 19426
 19427 6680-SET-TABLE-CODE.
 19428     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19429        MOVE ZEROS             TO WS-SUB1
 19430     ELSE
 19431* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19432* TO COMPUTE AH COMMISSION.
 19433        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19434        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19435        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19436        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19437        PERFORM 6680-READ-CTBL-TABLE
 19438        IF WS-CTBL-READ-SW NOT = 'Y'
 19439           MOVE ZEROS          TO WS-SUB1.
 19440
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 354
* EL050.cbl
 19441 6680-READ-CTBL-TABLE.
 19442*
 19443* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19444* TO COMPUTE LIFE COMMISSION
 19445
 19446     IF CTBL-SW = '0540'
 19447        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19448        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19449        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19450
 19451     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19452
 19453     IF CTBL-TABLE-FOUND
 19454        IF CTBL-SW = '0530'
 19455             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19456                                    * PB-I-AH-TERM
 19457             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19458             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19459        ELSE
 19460             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19461             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19462             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19463     ELSE
 19464        IF FIRST-TIME-THROUGH
 19465            GO TO 6680-READ-CTBL-TABLE
 19466        ELSE
 19467            MOVE ZEROS         TO WS-SUB1.
 19468
 19469 6680-SET-COMMISSION.
 19470     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19471           MOVE ZEROS          TO WS-SUB1
 19472       ELSE
 19473           MOVE RESC-COMMISSION-PER (WS-SUB)
 19474                               TO WS-COMMISSION
 19475           IF CTBL-SW = '0530'
 19476               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19477           ELSE
 19478               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19479
 19480 6680-SEARCH-CATEGORY.
 19481     ADD +1                   TO WS-SUB.
 19482     IF WS-SUB > +12
 19483         GO TO 6680-EXIT.
 19484
 19485     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19486          MOVE WS-SUB         TO WS-SUB1
 19487          GO TO 6680-EXIT.
 19488
 19489     GO TO 6680-SEARCH-CATEGORY.
 19490
 19491 6680-EXIT.
 19492     EXIT.
 19493
 19494 6690-END-OF-FILE.
 19495     GO TO 6700-COMM-EXIT.
 19496
 19497 6690-ERRESC-PROBLEM.
 19498      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 355
* EL050.cbl
 19499      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19500
 19501      GO TO 6700-COMM-EXIT.
 19502
 19503 6700-COMM-EXIT.
 19504     EXIT.
 19505
 19506 7000-GET-RATE.
 19507
 19508* EXEC CICS LINK
 19509*        PROGRAM    ('ELRATE')
 19510*        COMMAREA   (CALCULATION-PASS-AREA)
 19511*        LENGTH     (CP-COMM-LENGTH)
 19512*    END-EXEC.
 19513     MOVE 'ELRATE' TO DFHEIV1
 19514*    MOVE '."C                   (   #00019287' TO DFHEIV0
 19515     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19517     MOVE X'2020233030303139323837' TO DFHEIV0(25:11)
 19518     CALL 'kxdfhei1' USING DFHEIV0,
 19519           DFHEIV1,
 19520           CALCULATION-PASS-AREA,
 19521           CP-COMM-LENGTH,
 19522           DFHEIV99,
 19523           DFHEIV99,
 19524           DFHEIV99,
 19525           DFHEIV99
 19526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19527
 19528
 19529 7000-EXIT.
 19530     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 356
* EL050.cbl
 19532 7100-FIND-BENEFIT-IN-STATE.
 19533     MOVE 'N'                    TO BEN-SEARCH-SW.
 19534
 19535     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19536         VARYING SUB3 FROM 1 BY 1 UNTIL
 19537            ((SUB3 GREATER 50) OR
 19538              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19539               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19540
 19541     IF SUB3 NOT = 51
 19542         MOVE 'Y'                TO BEN-SEARCH-SW.
 19543
 19544     GO TO 7199-EXIT.
 19545
 19546 7100-BENEFIT-DUMMY.
 19547
 19548 7100-DUMMY-EXIT.
 19549     EXIT.
 19550
 19551 7199-EXIT.
 19552     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 357
* EL050.cbl
 19554 7200-FIND-BENEFIT.
 19555     MOVE 'N'                    TO BEN-SEARCH-SW.
 19556
 19557     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19558         VARYING SUB3 FROM 1 BY 1 UNTIL
 19559            ((SUB3 GREATER 8) OR
 19560            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19561
 19562     IF SUB3 NOT = 9
 19563         MOVE 'Y'                TO BEN-SEARCH-SW.
 19564
 19565     GO TO 7200-EXIT.
 19566
 19567 7200-BENEFIT-DUMMY.
 19568
 19569 7200-DUMMY-EXIT.
 19570     EXIT.
 19571
 19572 7200-EXIT.
 19573     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 358
* EL050.cbl
 19575 7250-LOOK-FOR-RESCINDED-CLAIM.
 19576     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19577                                    W-CL-COMP-CD.
 19578     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19579                                    W-CL-CERT-NO.
 19580
 19581
 19582* EXEC CICS HANDLE CONDITION
 19583*        NOTFND  (7250-CONTINUE)
 19584*        ENDFILE (7250-CONTINUE)
 19585*    END-EXEC.
 19586*    MOVE '"$I''                  ! ) #00019345' TO DFHEIV0
 19587     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19589     MOVE X'2920233030303139333435' TO DFHEIV0(25:11)
 19590     CALL 'kxdfhei1' USING DFHEIV0
 19591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19592
 19593
 19594
 19595* EXEC CICS IGNORE CONDITION
 19596*        DUPKEY
 19597*    END-EXEC.
 19598*    MOVE '"*$                   !   #00019350' TO DFHEIV0
 19599     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19600     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19601     MOVE X'2020233030303139333530' TO DFHEIV0(25:11)
 19602     CALL 'kxdfhei1' USING DFHEIV0
 19603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19604
 19605
 19606
 19607* EXEC CICS STARTBR
 19608*        DATASET   (CLMS-ID)
 19609*        RIDFLD    (ELMSTR-KEY)
 19610*        GENERIC   EQUAL
 19611*        KEYLENGTH (ELMSTR-LENGTH)
 19612*    END-EXEC.
 19613     MOVE 0
 19614       TO DFHEIV11
 19615*    MOVE '&,   KG    E          &   #00019354' TO DFHEIV0
 19616     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19617     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19618     MOVE X'2020233030303139333534' TO DFHEIV0(25:11)
 19619     CALL 'kxdfhei1' USING DFHEIV0,
 19620           CLMS-ID,
 19621           ELMSTR-KEY,
 19622           ELMSTR-LENGTH,
 19623           DFHEIV11,
 19624           DFHEIV99
 19625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19626
 19627
 19628     MOVE 'Y'                    TO W-BROWSE-SW.
 19629
 19630 7250-NEXT-CLAIM.
 19631
 19632
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 359
* EL050.cbl
 19633* EXEC CICS READNEXT
 19634*        DATASET   (CLMS-ID)
 19635*        RIDFLD    (ELMSTR-KEY)
 19636*        SET       (ADDRESS OF CLAIM-MASTER)
 19637*    END-EXEC.
 19638     MOVE 0
 19639       TO DFHEIV11
 19640*    MOVE '&.S                   )   #00019365' TO DFHEIV0
 19641     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19642     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19643     MOVE X'2020233030303139333635' TO DFHEIV0(25:11)
 19644     CALL 'kxdfhei1' USING DFHEIV0,
 19645           CLMS-ID,
 19646           DFHEIV20,
 19647           DFHEIV99,
 19648           ELMSTR-KEY,
 19649           DFHEIV99,
 19650           DFHEIV11,
 19651           DFHEIV99,
 19652           DFHEIV99
 19653     SET ADDRESS OF CLAIM-MASTER TO
 19654         DFHEIV20
 19655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19656
 19657
 19658     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19659        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19660         GO TO 7250-CONTINUE
 19661     END-IF.
 19662
 19663     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19664        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19665        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19666        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19667        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19668         GO TO 7250-NEXT-CLAIM
 19669     END-IF.
 19670
 19671     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19672        OR (CL-CLAIM-TYPE = 'I')
 19673        OR (CL-CLAIM-TYPE = 'G')
 19674        OR (CL-CLAIM-TYPE = 'F')
 19675          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19676              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19677              GO TO 7250-CONTINUE
 19678          END-IF
 19679     END-IF.
 19680
 19681     GO TO 7250-NEXT-CLAIM.
 19682
 19683 7250-CONTINUE.
 19684
 19685     IF W-BROWSE-SW = 'Y'
 19686
 19687* EXEC CICS ENDBR
 19688*            DATASET   (CLMS-ID)
 19689*        END-EXEC
 19690     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 360
* EL050.cbl
 19691       TO DFHEIV11
 19692*    MOVE '&2                    $   #00019399' TO DFHEIV0
 19693     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19694     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19695     MOVE X'2020233030303139333939' TO DFHEIV0(25:11)
 19696     CALL 'kxdfhei1' USING DFHEIV0,
 19697           CLMS-ID,
 19698           DFHEIV11,
 19699           DFHEIV99
 19700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19701         MOVE 'N' TO W-BROWSE-SW
 19702     END-IF.
 19703
 19704 7250-EXIT.
 19705     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 361
* EL050.cbl
 19707 7300-CHECK-FOR-OPEN-CLMS.
 19708
 19709*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19710*    MOVE SPACES                 TO CNTL-ACCESS.
 19711*    MOVE '1'                    TO CNTL-REC-TYPE.
 19712*    MOVE +0                     TO CNTL-SEQ-NO.
 19713
 19714*    MOVE '3'                    TO RC-SW-1.
 19715*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19716
 19717*    IF NOT CF-COMPANY-MASTER
 19718*         PERFORM 0099-COMPANY-NOT-FOUND
 19719*         GO TO 7300-EXIT.
 19720
 19721     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19722                                    W-CL-COMP-CD.
 19723     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19724                                    W-CL-CERT-NO.
 19725
 19726
 19727* EXEC CICS HANDLE CONDITION
 19728*        NOTFND  (7300-CONTINUE)
 19729*        ENDFILE (7300-CONTINUE)
 19730*    END-EXEC.
 19731*    MOVE '"$I''                  ! * #00019427' TO DFHEIV0
 19732     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19734     MOVE X'2A20233030303139343237' TO DFHEIV0(25:11)
 19735     CALL 'kxdfhei1' USING DFHEIV0
 19736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19737
 19738
 19739
 19740* EXEC CICS IGNORE CONDITION
 19741*        DUPKEY
 19742*    END-EXEC.
 19743*    MOVE '"*$                   !   #00019432' TO DFHEIV0
 19744     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19746     MOVE X'2020233030303139343332' TO DFHEIV0(25:11)
 19747     CALL 'kxdfhei1' USING DFHEIV0
 19748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19749
 19750
 19751
 19752* EXEC CICS STARTBR
 19753*        DATASET   (CLMS-ID)
 19754*        RIDFLD    (ELMSTR-KEY)
 19755*        GENERIC   EQUAL
 19756*        KEYLENGTH (ELMSTR-LENGTH)
 19757*    END-EXEC.
 19758     MOVE 0
 19759       TO DFHEIV11
 19760*    MOVE '&,   KG    E          &   #00019436' TO DFHEIV0
 19761     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19762     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19763     MOVE X'2020233030303139343336' TO DFHEIV0(25:11)
 19764     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 362
* EL050.cbl
 19765           CLMS-ID,
 19766           ELMSTR-KEY,
 19767           ELMSTR-LENGTH,
 19768           DFHEIV11,
 19769           DFHEIV99
 19770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19771
 19772
 19773     MOVE 'Y'                    TO W-BROWSE-SW.
 19774
 19775 7300-NEXT-CLAIM.
 19776
 19777
 19778* EXEC CICS READNEXT
 19779*        DATASET   (CLMS-ID)
 19780*        RIDFLD    (ELMSTR-KEY)
 19781*        SET       (ADDRESS OF CLAIM-MASTER)
 19782*    END-EXEC.
 19783     MOVE 0
 19784       TO DFHEIV11
 19785*    MOVE '&.S                   )   #00019447' TO DFHEIV0
 19786     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19787     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19788     MOVE X'2020233030303139343437' TO DFHEIV0(25:11)
 19789     CALL 'kxdfhei1' USING DFHEIV0,
 19790           CLMS-ID,
 19791           DFHEIV20,
 19792           DFHEIV99,
 19793           ELMSTR-KEY,
 19794           DFHEIV99,
 19795           DFHEIV11,
 19796           DFHEIV99,
 19797           DFHEIV99
 19798     SET ADDRESS OF CLAIM-MASTER TO
 19799         DFHEIV20
 19800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19801
 19802
 19803     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19804        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19805         GO TO 7300-CONTINUE.
 19806
 19807     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19808        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19809        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19810        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19811        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19812         GO TO 7300-NEXT-CLAIM.
 19813
 19814*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19815     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19816        OR (CL-CLAIM-TYPE = 'I')
 19817        OR (CL-CLAIM-TYPE = 'G')
 19818        OR (CL-CLAIM-TYPE = 'F')
 19819        IF CLAIM-IS-OPEN
 19820           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19821             AND PB-C-AH-CANCEL-DT > SPACES
 19822              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 363
* EL050.cbl
 19823              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19824           END-IF
 19825           EVALUATE TRUE
 19826             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19827                 MOVE ER-2884      TO WS-ERROR
 19828             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19829                 MOVE ER-2887      TO WS-ERROR
 19830             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19831                 MOVE ER-2886      TO WS-ERROR
 19832             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19833                 MOVE ER-2888      TO WS-ERROR
 19834             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19835                 MOVE ER-2885      TO WS-ERROR
 19836             WHEN OTHER
 19837                 MOVE ER-2768      TO WS-ERROR
 19838           END-EVALUATE
 19839           IF PB-C-AH-CANCEL-VOIDED OR
 19840              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19841                NOT AH-COVERAGE-CANCELLED)
 19842               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19843               MOVE ER-2768      TO WS-ERROR
 19844           END-IF
 19845           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19846           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19847              PB-FORCE-CODE NOT EQUAL '8'
 19848               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19849           END-IF
 19850           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19851           GO TO 7300-NEXT-CLAIM
 19852        ELSE
 19853           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19854*****THIS IS A RESCISSION OR REFORMATION
 19855              IF AH-COVERAGE-CANCELLED
 19856                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19857                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19858                    MOVE 1                   TO DC-ELAPSED-DAYS
 19859                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19860                    SET BIN-PLUS-ELAPSED     TO TRUE
 19861                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19862                    IF NO-CONVERSION-ERROR
 19863                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19864                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19865                          MOVE ER-2897 TO WS-ERROR
 19866                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19867                          GO TO 7300-NEXT-CLAIM
 19868                       END-IF
 19869                    END-IF
 19870                 ELSE
 19871                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19872                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19873                         MOVE ER-2890 TO WS-ERROR
 19874                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19875                         GO TO 7300-NEXT-CLAIM
 19876                      ELSE
 19877                         MOVE ER-2898 TO WS-ERROR
 19878                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19879                         GO TO 7300-NEXT-CLAIM
 19880                      END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 364
* EL050.cbl
 19881                   END-IF
 19882                 END-IF
 19883              END-IF
 19884           ELSE
 19885              IF CL-DENIAL-TYPE = '1'  AND
 19886                 CL-TOTAL-PAID-AMT = 0
 19887                    GO TO 7300-NEXT-CLAIM
 19888              END-IF
 19889              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19890               AND PB-C-AH-CANCEL-DT > SPACES
 19891                 MOVE ER-2756        TO WS-ERROR
 19892                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19893                 GO TO 7300-NEXT-CLAIM
 19894              END-IF
 19895           END-IF
 19896        END-IF
 19897     ELSE
 19898*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19899        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19900           IF (CLAIM-IS-OPEN)
 19901              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19902                 <> zeros
 19903              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19904                 <> zeros)
 19905              MOVE ER-2889      TO WS-ERROR
 19906              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19907              GO TO 7300-NEXT-CLAIM
 19908           ELSE
 19909              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19910*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19911                 IF (LF-COVERAGE-CANCELLED AND
 19912                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19913                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19914                         MOVE ER-2890 TO WS-ERROR
 19915                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19916                         GO TO 7300-NEXT-CLAIM
 19917                      ELSE
 19918                         MOVE ER-2898 TO WS-ERROR
 19919                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19920                         GO TO 7300-NEXT-CLAIM
 19921                      END-IF
 19922                 END-IF
 19923              ELSE
 19924                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19925                    and (CL-TOTAL-PAID-AMT = 0)
 19926                    GO TO 7300-NEXT-CLAIM
 19927                 END-IF
 19928                 IF (
 19929                      (AH-COVERAGE-CANCELLED)
 19930                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19931                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19932                      and (pb-ci-ah-cancel-amt +
 19933                         pb-c-ah-cancel-amt) <> zeros
 19934                    )
 19935                               OR
 19936                    (
 19937                      (LF-COVERAGE-CANCELLED)
 19938                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 365
* EL050.cbl
 19939                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19940                      and (pb-ci-lf-cancel-amt +
 19941                         pb-c-lf-cancel-amt) <> zeros
 19942                    )
 19943                       MOVE ER-2965 TO WS-ERROR
 19944                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19945                       GO TO 7300-NEXT-CLAIM
 19946                 END-IF
 19947                 IF LF-COVERAGE-CANCELLED
 19948                  IF CL-TOTAL-PAID-AMT > 0
 19949                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19950                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19951                        MOVE ER-2891 TO WS-ERROR
 19952                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19953                        GO TO 7300-NEXT-CLAIM
 19954                      END-IF
 19955                    ELSE
 19956****only show this error if cert num matches exactly
 19957                      IF PB-CERT-NO = CL-CERT-NO
 19958                         MOVE ER-2892 TO WS-ERROR
 19959                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19960                         GO TO 7300-NEXT-CLAIM
 19961                      END-IF
 19962                    END-IF
 19963                  END-IF
 19964                 END-IF
 19965              END-IF
 19966           END-IF
 19967        END-IF
 19968     END-IF
 19969
 19970     GO TO 7300-NEXT-CLAIM.
 19971
 19972 7300-CONTINUE.
 19973
 19974     IF W-BROWSE-SW = 'Y'
 19975
 19976* EXEC CICS ENDBR
 19977*            DATASET   (CLMS-ID)
 19978*        END-EXEC.
 19979     MOVE 0
 19980       TO DFHEIV11
 19981*    MOVE '&2                    $   #00019625' TO DFHEIV0
 19982     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19983     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19984     MOVE X'2020233030303139363235' TO DFHEIV0(25:11)
 19985     CALL 'kxdfhei1' USING DFHEIV0,
 19986           CLMS-ID,
 19987           DFHEIV11,
 19988           DFHEIV99
 19989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19990
 19991
 19992 7300-EXIT.
 19993     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 366
* EL050.cbl
 19995
 19996 7400-GET-REMAIN-TERM.
 19997
 19998* EXEC CICS LINK
 19999*        PROGRAM    ('ELRTRM')
 20000*        COMMAREA   (CALCULATION-PASS-AREA)
 20001*        LENGTH     (CP-COMM-LENGTH)
 20002*    END-EXEC.
 20003     MOVE 'ELRTRM' TO DFHEIV1
 20004*    MOVE '."C                   (   #00019634' TO DFHEIV0
 20005     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20006     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20007     MOVE X'2020233030303139363334' TO DFHEIV0(25:11)
 20008     CALL 'kxdfhei1' USING DFHEIV0,
 20009           DFHEIV1,
 20010           CALCULATION-PASS-AREA,
 20011           CP-COMM-LENGTH,
 20012           DFHEIV99,
 20013           DFHEIV99,
 20014           DFHEIV99,
 20015           DFHEIV99
 20016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20017
 20018
 20019 7400-EXIT.
 20020     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 367
* EL050.cbl
 20022
 20023 7500-GET-REMAIN-AMOUNT.
 20024
 20025* EXEC CICS LINK
 20026*        PROGRAM    ('ELRAMT')
 20027*        COMMAREA   (CALCULATION-PASS-AREA)
 20028*        LENGTH     (CP-COMM-LENGTH)
 20029*    END-EXEC.
 20030     MOVE 'ELRAMT' TO DFHEIV1
 20031*    MOVE '."C                   (   #00019645' TO DFHEIV0
 20032     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20033     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20034     MOVE X'2020233030303139363435' TO DFHEIV0(25:11)
 20035     CALL 'kxdfhei1' USING DFHEIV0,
 20036           DFHEIV1,
 20037           CALCULATION-PASS-AREA,
 20038           CP-COMM-LENGTH,
 20039           DFHEIV99,
 20040           DFHEIV99,
 20041           DFHEIV99,
 20042           DFHEIV99
 20043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20044
 20045
 20046 7500-EXIT.
 20047     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 368
* EL050.cbl
 20049
 20050 7600-GET-REFUND.
 20051
 20052* EXEC CICS LINK
 20053*        PROGRAM    ('ELRFND')
 20054*        COMMAREA   (CALCULATION-PASS-AREA)
 20055*        LENGTH     (CP-COMM-LENGTH)
 20056*    END-EXEC.
 20057     MOVE 'ELRFND' TO DFHEIV1
 20058*    MOVE '."C                   (   #00019656' TO DFHEIV0
 20059     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20061     MOVE X'2020233030303139363536' TO DFHEIV0(25:11)
 20062     CALL 'kxdfhei1' USING DFHEIV0,
 20063           DFHEIV1,
 20064           CALCULATION-PASS-AREA,
 20065           CP-COMM-LENGTH,
 20066           DFHEIV99,
 20067           DFHEIV99,
 20068           DFHEIV99,
 20069           DFHEIV99
 20070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20071
 20072
 20073 7600-EXIT.
 20074     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 369
* EL050.cbl
 20076 7700-CALL-DL1.
 20077
 20078* EXEC CICS LINK
 20079*        PROGRAM    ('DLO001')
 20080*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20081*        LENGTH     (DLO001-COMM-LENGTH)
 20082*    END-EXEC.
 20083     MOVE 'DLO001' TO DFHEIV1
 20084*    MOVE '."C                   (   #00019666' TO DFHEIV0
 20085     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20087     MOVE X'2020233030303139363636' TO DFHEIV0(25:11)
 20088     CALL 'kxdfhei1' USING DFHEIV0,
 20089           DFHEIV1,
 20090           WS-DLO-MASTER-POLICY-FORM,
 20091           DLO001-COMM-LENGTH,
 20092           DFHEIV99,
 20093           DFHEIV99,
 20094           DFHEIV99,
 20095           DFHEIV99
 20096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20097
 20098
 20099 7700-EXIT.
 20100     EXIT.
 20101
 20102 7710-CALL-DL2.
 20103
 20104* EXEC CICS LINK
 20105*        PROGRAM    ('DLO002')
 20106*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20107*        LENGTH     (DLO002-COMM-LENGTH)
 20108*    END-EXEC.
 20109     MOVE 'DLO002' TO DFHEIV1
 20110*    MOVE '."C                   (   #00019676' TO DFHEIV0
 20111     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20113     MOVE X'2020233030303139363736' TO DFHEIV0(25:11)
 20114     CALL 'kxdfhei1' USING DFHEIV0,
 20115           DFHEIV1,
 20116           WS-DLO-INTERNAL-POLICY-FORM,
 20117           DLO002-COMM-LENGTH,
 20118           DFHEIV99,
 20119           DFHEIV99,
 20120           DFHEIV99,
 20121           DFHEIV99
 20122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20123
 20124
 20125 7710-EXIT.
 20126     EXIT.
 20127
 20128 7720-CALL-DL3.
 20129
 20130* EXEC CICS LINK
 20131*        PROGRAM    ('DLO003')
 20132*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20133*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 370
* EL050.cbl
 20134*    END-EXEC.
 20135     MOVE 'DLO003' TO DFHEIV1
 20136*    MOVE '."C                   (   #00019686' TO DFHEIV0
 20137     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20139     MOVE X'2020233030303139363836' TO DFHEIV0(25:11)
 20140     CALL 'kxdfhei1' USING DFHEIV0,
 20141           DFHEIV1,
 20142           WS-DLO-VALID-BANK-ID,
 20143           DLO003-COMM-LENGTH,
 20144           DFHEIV99,
 20145           DFHEIV99,
 20146           DFHEIV99,
 20147           DFHEIV99
 20148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20149
 20150
 20151 7720-EXIT.
 20152     EXIT.
 20153
 20154 7730-CALL-DL7.
 20155
 20156* EXEC CICS LINK
 20157*        PROGRAM    ('DLO007')
 20158*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20159*        LENGTH     (DLO007-COMM-LENGTH)
 20160*    END-EXEC.
 20161     MOVE 'DLO007' TO DFHEIV1
 20162*    MOVE '."C                   (   #00019696' TO DFHEIV0
 20163     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20165     MOVE X'2020233030303139363936' TO DFHEIV0(25:11)
 20166     CALL 'kxdfhei1' USING DFHEIV0,
 20167           DFHEIV1,
 20168           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20169           DLO007-COMM-LENGTH,
 20170           DFHEIV99,
 20171           DFHEIV99,
 20172           DFHEIV99,
 20173           DFHEIV99
 20174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20175
 20176
 20177 7730-EXIT.
 20178     EXIT.
 20179
 20180 7740-CALL-DL11.
 20181
 20182* EXEC CICS LINK
 20183*        PROGRAM    ('DLO011')
 20184*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20185*        LENGTH     (DLO011-COMM-LENGTH)
 20186*    END-EXEC.
 20187     MOVE 'DLO011' TO DFHEIV1
 20188*    MOVE '."C                   (   #00019706' TO DFHEIV0
 20189     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20191     MOVE X'2020233030303139373036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 371
* EL050.cbl
 20192     CALL 'kxdfhei1' USING DFHEIV0,
 20193           DFHEIV1,
 20194           WS-DLO-PREM-RATES-BEN-TYPE,
 20195           DLO011-COMM-LENGTH,
 20196           DFHEIV99,
 20197           DFHEIV99,
 20198           DFHEIV99,
 20199           DFHEIV99
 20200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20201
 20202
 20203 7740-EXIT.
 20204     EXIT.
 20205
 20206 7750-CALL-DL17.
 20207
 20208* EXEC CICS LINK
 20209*        PROGRAM    ('DLO017')
 20210*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20211*        LENGTH     (DLO017-COMM-LENGTH)
 20212*    END-EXEC.
 20213     MOVE 'DLO017' TO DFHEIV1
 20214*    MOVE '."C                   (   #00019716' TO DFHEIV0
 20215     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20216     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20217     MOVE X'2020233030303139373136' TO DFHEIV0(25:11)
 20218     CALL 'kxdfhei1' USING DFHEIV0,
 20219           DFHEIV1,
 20220           WS-DLO-VALID-RATE-CODE,
 20221           DLO017-COMM-LENGTH,
 20222           DFHEIV99,
 20223           DFHEIV99,
 20224           DFHEIV99,
 20225           DFHEIV99
 20226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20227
 20228
 20229 7750-EXIT.
 20230     EXIT.
 20231
 20232 7755-CALL-DL19.
 20233
 20234* EXEC CICS LINK
 20235*        PROGRAM    ('DLO019')
 20236*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20237*        LENGTH     (DLO019-COMM-LENGTH)
 20238*    END-EXEC.
 20239     MOVE 'DLO019' TO DFHEIV1
 20240*    MOVE '."C                   (   #00019726' TO DFHEIV0
 20241     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20243     MOVE X'2020233030303139373236' TO DFHEIV0(25:11)
 20244     CALL 'kxdfhei1' USING DFHEIV0,
 20245           DFHEIV1,
 20246           WS-DLO-ORIG-COV-CAT,
 20247           DLO019-COMM-LENGTH,
 20248           DFHEIV99,
 20249           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 372
* EL050.cbl
 20250           DFHEIV99,
 20251           DFHEIV99
 20252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20253
 20254
 20255 7755-EXIT.
 20256     EXIT.
 20257
 20258 7760-CALL-DL21.
 20259
 20260* EXEC CICS LINK
 20261*        PROGRAM    ('DLO021')
 20262*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20263*        LENGTH     (DLO021-COMM-LENGTH)
 20264*    END-EXEC.
 20265     MOVE 'DLO021' TO DFHEIV1
 20266*    MOVE '."C                   (   #00019736' TO DFHEIV0
 20267     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20269     MOVE X'2020233030303139373336' TO DFHEIV0(25:11)
 20270     CALL 'kxdfhei1' USING DFHEIV0,
 20271           DFHEIV1,
 20272           WS-DLO-VALID-LOAN-OFFICER,
 20273           DLO021-COMM-LENGTH,
 20274           DFHEIV99,
 20275           DFHEIV99,
 20276           DFHEIV99,
 20277           DFHEIV99
 20278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20279
 20280
 20281 7760-EXIT.
 20282     EXIT.
 20283
 20284 7770-CALL-DL22.
 20285
 20286* EXEC CICS LINK
 20287*        PROGRAM    ('DLO022')
 20288*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20289*        LENGTH     (DLO022-COMM-LENGTH)
 20290*    END-EXEC.
 20291     MOVE 'DLO022' TO DFHEIV1
 20292*    MOVE '."C                   (   #00019746' TO DFHEIV0
 20293     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20295     MOVE X'2020233030303139373436' TO DFHEIV0(25:11)
 20296     CALL 'kxdfhei1' USING DFHEIV0,
 20297           DFHEIV1,
 20298           WS-DLO-VALID-STATE-CODE,
 20299           DLO022-COMM-LENGTH,
 20300           DFHEIV99,
 20301           DFHEIV99,
 20302           DFHEIV99,
 20303           DFHEIV99
 20304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20305
 20306
 20307 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 373
* EL050.cbl
 20308     EXIT.
 20309
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 374
* EL050.cbl
 20311
 20312 7780-CALL-AGG.
 20313
 20314* EXEC CICS LINK
 20315*        PROGRAM    ('ELAGGO')
 20316*        COMMAREA   (WS-PASS-to-pemaggo)
 20317*        LENGTH     (ws-passed-key-LENGTH)
 20318*    END-EXEC.
 20319     MOVE 'ELAGGO' TO DFHEIV1
 20320*    MOVE '."C                   (   #00019758' TO DFHEIV0
 20321     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20323     MOVE X'2020233030303139373538' TO DFHEIV0(25:11)
 20324     CALL 'kxdfhei1' USING DFHEIV0,
 20325           DFHEIV1,
 20326           WS-PASS-to-pemaggo,
 20327           ws-passed-key-LENGTH,
 20328           DFHEIV99,
 20329           DFHEIV99,
 20330           DFHEIV99,
 20331           DFHEIV99
 20332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20333
 20334 7780-EXIT.
 20335     EXIT.
 20336 7785-CALL-HLDI.
 20337
 20338* EXEC CICS LINK
 20339*        PROGRAM    ('ELHLDI')
 20340*        COMMAREA   (HLDI-PASS-AREA)
 20341*        LENGTH     (HLDI-PASS-AREA-LEN)
 20342*    END-EXEC.
 20343     MOVE 'ELHLDI' TO DFHEIV1
 20344*    MOVE '."C                   (   #00019766' TO DFHEIV0
 20345     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20347     MOVE X'2020233030303139373636' TO DFHEIV0(25:11)
 20348     CALL 'kxdfhei1' USING DFHEIV0,
 20349           DFHEIV1,
 20350           HLDI-PASS-AREA,
 20351           HLDI-PASS-AREA-LEN,
 20352           DFHEIV99,
 20353           DFHEIV99,
 20354           DFHEIV99,
 20355           DFHEIV99
 20356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20357
 20358 7785-EXIT.
 20359     EXIT.
 20360 7786-CALL-HLDIM.
 20361
 20362* EXEC CICS LINK
 20363*        PROGRAM    ('ELHLDIM')
 20364*        COMMAREA   (HLDI-PASS-AREA)
 20365*        LENGTH     (HLDI-PASS-AREA-LEN)
 20366*    END-EXEC.
 20367     MOVE 'ELHLDIM' TO DFHEIV1
 20368*    MOVE '."C                   (   #00019774' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 375
* EL050.cbl
 20369     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20371     MOVE X'2020233030303139373734' TO DFHEIV0(25:11)
 20372     CALL 'kxdfhei1' USING DFHEIV0,
 20373           DFHEIV1,
 20374           HLDI-PASS-AREA,
 20375           HLDI-PASS-AREA-LEN,
 20376           DFHEIV99,
 20377           DFHEIV99,
 20378           DFHEIV99,
 20379           DFHEIV99
 20380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20381
 20382 7786-EXIT.
 20383     EXIT.
 20384 7790-CALL-ZIP-VERIFY.
 20385
 20386
 20387* EXEC CICS LINK
 20388*        PROGRAM    ('WSZIPCD')
 20389*        COMMAREA   (ZIPCD-PASS-AREA)
 20390*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20391*    END-EXEC.
 20392     MOVE 'WSZIPCD' TO DFHEIV1
 20393*    MOVE '."C                   (   #00019783' TO DFHEIV0
 20394     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20395     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20396     MOVE X'2020233030303139373833' TO DFHEIV0(25:11)
 20397     CALL 'kxdfhei1' USING DFHEIV0,
 20398           DFHEIV1,
 20399           ZIPCD-PASS-AREA,
 20400           ZIPCD-PASS-AREA-LEN,
 20401           DFHEIV99,
 20402           DFHEIV99,
 20403           DFHEIV99,
 20404           DFHEIV99
 20405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20406
 20407
 20408 7790-EXIT.
 20409     EXIT.
 20410 7800-REWRITE-CERT.
 20411******************************************************************
 20412*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20413*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20414******************************************************************
 20415
 20416     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20417        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20418        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20419        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20420
 20421* EXEC CICS REWRITE
 20422*                  DATASET (CERT-ID)
 20423*                  FROM    (CERTIFICATE-MASTER)
 20424*              END-EXEC
 20425     MOVE LENGTH OF
 20426      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 376
* EL050.cbl
 20427       TO DFHEIV11
 20428*    MOVE '&& L                  %   #00019801' TO DFHEIV0
 20429     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20430     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20431     MOVE X'2020233030303139383031' TO DFHEIV0(25:11)
 20432     CALL 'kxdfhei1' USING DFHEIV0,
 20433           CERT-ID,
 20434           CERTIFICATE-MASTER,
 20435           DFHEIV11,
 20436           DFHEIV99
 20437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20438        GO TO 7800-EXIT.
 20439
 20440       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20441       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20442
 20443 7800-EXIT.
 20444      EXIT.
 20445
 20446 7900-DELETE-CERT.
 20447
 20448* EXEC CICS DELETE
 20449*        DATASET (CERT-ID)
 20450*    END-EXEC.
 20451*    MOVE '&(                    &   #00019814' TO DFHEIV0
 20452     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20454     MOVE X'2020233030303139383134' TO DFHEIV0(25:11)
 20455     CALL 'kxdfhei1' USING DFHEIV0,
 20456           CERT-ID,
 20457           DFHEIV99,
 20458           DFHEIV99,
 20459           DFHEIV99,
 20460           DFHEIV99
 20461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20462
 20463
 20464 7900-EXIT.
 20465     EXIT.
 20466
 20467 8000-WRITE-CERT.
 20468
 20469* EXEC CICS HANDLE CONDITION
 20470*        DUPKEY    (8000-FREE-MAIN)
 20471*    END-EXEC.
 20472*    MOVE '"$$                   ! + #00019822' TO DFHEIV0
 20473     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20475     MOVE X'2B20233030303139383232' TO DFHEIV0(25:11)
 20476     CALL 'kxdfhei1' USING DFHEIV0
 20477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20478
 20479
 20480
 20481* EXEC CICS WRITE
 20482*        DATASET     (CERT-ID)
 20483*        FROM        (CERTIFICATE-MASTER)
 20484*        RIDFLD      (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 377
* EL050.cbl
 20485*    END-EXEC.
 20486     MOVE LENGTH OF
 20487      CERTIFICATE-MASTER
 20488       TO DFHEIV11
 20489*    MOVE '&$ L                  ''   #00019826' TO DFHEIV0
 20490     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20491     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20492     MOVE X'2020233030303139383236' TO DFHEIV0(25:11)
 20493     CALL 'kxdfhei1' USING DFHEIV0,
 20494           CERT-ID,
 20495           CERTIFICATE-MASTER,
 20496           DFHEIV11,
 20497           ELCERT-KEY,
 20498           DFHEIV99,
 20499           DFHEIV99
 20500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20501
 20502
 20503 8000-FREE-MAIN.
 20504
 20505 8000-EXIT.
 20506      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 378
* EL050.cbl
 20508
 20509 8100-READ-ERPNDM.
 20510
 20511* EXEC CICS HANDLE CONDITION
 20512*         NOTFND     (8100-NOTFND)
 20513*         ENDFILE    (8100-NOTFND)
 20514*    END-EXEC.
 20515*    MOVE '"$I''                  ! , #00019839' TO DFHEIV0
 20516     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20518     MOVE X'2C20233030303139383339' TO DFHEIV0(25:11)
 20519     CALL 'kxdfhei1' USING DFHEIV0
 20520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20521
 20522
 20523     MOVE SPACES                 TO ERPNDM-FOUND.
 20524     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20525
 20526
 20527* EXEC CICS READ UPDATE
 20528*         DATASET   (FILE-ERPNDM)
 20529*         RIDFLD    (PM-CONTROL-PRIMARY)
 20530*         INTO      (PENDING-MAILING-DATA)
 20531*    END-EXEC.
 20532     MOVE LENGTH OF
 20533      PENDING-MAILING-DATA
 20534       TO DFHEIV11
 20535*    MOVE '&"IL       EU         (   #00019847' TO DFHEIV0
 20536     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20537     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20538     MOVE X'2020233030303139383437' TO DFHEIV0(25:11)
 20539     CALL 'kxdfhei1' USING DFHEIV0,
 20540           FILE-ERPNDM,
 20541           PENDING-MAILING-DATA,
 20542           DFHEIV11,
 20543           PM-CONTROL-PRIMARY,
 20544           DFHEIV99,
 20545           DFHEIV99,
 20546           DFHEIV99
 20547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20548
 20549
 20550     GO TO 8100-EXIT.
 20551
 20552 8100-NOTFND.
 20553
 20554     MOVE 'X'                    TO ERPNDM-FOUND.
 20555     MOVE ER-2694                TO WS-ERROR.
 20556     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20557     MOVE ER-2883                TO WS-ERROR
 20558     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20559     .
 20560 8100-EXIT.
 20561     EXIT.
 20562 8102-REWRITE-ERPNDM.
 20563
 20564
 20565* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 379
* EL050.cbl
 20566*         DATASET    (FILE-ERPNDM)
 20567*         FROM       (PENDING-MAILING-DATA)
 20568*    END-EXEC
 20569     MOVE LENGTH OF
 20570      PENDING-MAILING-DATA
 20571       TO DFHEIV11
 20572*    MOVE '&& L                  %   #00019867' TO DFHEIV0
 20573     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20574     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20575     MOVE X'2020233030303139383637' TO DFHEIV0(25:11)
 20576     CALL 'kxdfhei1' USING DFHEIV0,
 20577           FILE-ERPNDM,
 20578           PENDING-MAILING-DATA,
 20579           DFHEIV11,
 20580           DFHEIV99
 20581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20582
 20583     .
 20584 8102-EXIT.
 20585     EXIT.
 20586 8104-UNLOCK-ERPNDM.
 20587
 20588
 20589* EXEC CICS UNLOCK
 20590*         DATASET   (FILE-ERPNDM)
 20591*    END-EXEC
 20592*    MOVE '&*                    #   #00019877' TO DFHEIV0
 20593     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20594     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20595     MOVE X'2020233030303139383737' TO DFHEIV0(25:11)
 20596     CALL 'kxdfhei1' USING DFHEIV0,
 20597           FILE-ERPNDM,
 20598           DFHEIV99
 20599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20600
 20601     .
 20602 8104-EXIT.
 20603     EXIT.
 20604 8110-READ-ERMAIL.
 20605
 20606* EXEC CICS HANDLE CONDITION
 20607*         NOTFND     (8110-NOTFND)
 20608*         ENDFILE    (8110-NOTFND)
 20609*    END-EXEC.
 20610*    MOVE '"$I''                  ! - #00019885' TO DFHEIV0
 20611     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20612     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20613     MOVE X'2D20233030303139383835' TO DFHEIV0(25:11)
 20614     CALL 'kxdfhei1' USING DFHEIV0
 20615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20616
 20617
 20618     MOVE SPACES                 TO ERMAIL-FOUND.
 20619     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20620     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20621     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20622     MOVE PB-SV-STATE            TO MA-STATE.
 20623
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 380
* EL050.cbl
 20624
 20625* EXEC CICS READ
 20626*         UPDATE
 20627*         DATASET   (FILE-ERMAIL)
 20628*         RIDFLD    (MA-CONTROL-PRIMARY)
 20629*         INTO      (MAILING-DATA)
 20630*    END-EXEC.
 20631     MOVE LENGTH OF
 20632      MAILING-DATA
 20633       TO DFHEIV11
 20634*    MOVE '&"IL       EU         (   #00019896' TO DFHEIV0
 20635     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20636     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20637     MOVE X'2020233030303139383936' TO DFHEIV0(25:11)
 20638     CALL 'kxdfhei1' USING DFHEIV0,
 20639           FILE-ERMAIL,
 20640           MAILING-DATA,
 20641           DFHEIV11,
 20642           MA-CONTROL-PRIMARY,
 20643           DFHEIV99,
 20644           DFHEIV99,
 20645           DFHEIV99
 20646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20647
 20648
 20649     GO TO 8110-EXIT.
 20650
 20651 8110-NOTFND.
 20652     MOVE 'X'                    TO ERMAIL-FOUND.
 20653
 20654 8110-EXIT.
 20655     EXIT.
 20656
 20657 8120-REWRITE-ERMAIL.
 20658
 20659* EXEC CICS REWRITE
 20660*         DATASET    (FILE-ERMAIL)
 20661*         FROM       (MAILING-DATA)
 20662*    END-EXEC.
 20663     MOVE LENGTH OF
 20664      MAILING-DATA
 20665       TO DFHEIV11
 20666*    MOVE '&& L                  %   #00019912' TO DFHEIV0
 20667     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20668     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20669     MOVE X'2020233030303139393132' TO DFHEIV0(25:11)
 20670     CALL 'kxdfhei1' USING DFHEIV0,
 20671           FILE-ERMAIL,
 20672           MAILING-DATA,
 20673           DFHEIV11,
 20674           DFHEIV99
 20675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20676
 20677
 20678 8120-EXIT.
 20679     EXIT.
 20680
 20681 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 381
* EL050.cbl
 20682
 20683* EXEC CICS HANDLE CONDITION
 20684*         DUPKEY   (8130-EXIT)
 20685*    END-EXEC.
 20686*    MOVE '"$$                   ! . #00019921' TO DFHEIV0
 20687     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20688     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20689     MOVE X'2E20233030303139393231' TO DFHEIV0(25:11)
 20690     CALL 'kxdfhei1' USING DFHEIV0
 20691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20692
 20693
 20694
 20695* EXEC CICS WRITE
 20696*         DATASET     (FILE-ERMAIL)
 20697*         RIDFLD      (MA-CONTROL-PRIMARY)
 20698*         FROM        (MAILING-DATA)
 20699*    END-EXEC.
 20700     MOVE LENGTH OF
 20701      MAILING-DATA
 20702       TO DFHEIV11
 20703*    MOVE '&$ L                  ''   #00019925' TO DFHEIV0
 20704     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20705     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20706     MOVE X'2020233030303139393235' TO DFHEIV0(25:11)
 20707     CALL 'kxdfhei1' USING DFHEIV0,
 20708           FILE-ERMAIL,
 20709           MAILING-DATA,
 20710           DFHEIV11,
 20711           MA-CONTROL-PRIMARY,
 20712           DFHEIV99,
 20713           DFHEIV99
 20714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20715
 20716
 20717 8130-EXIT.
 20718     EXIT.
 20719
 20720 8140-UNLOCK-ERMAIL.
 20721
 20722* EXEC CICS UNLOCK
 20723*         DATASET   (FILE-ERMAIL)
 20724*    END-EXEC.
 20725*    MOVE '&*                    #   #00019935' TO DFHEIV0
 20726     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20727     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20728     MOVE X'2020233030303139393335' TO DFHEIV0(25:11)
 20729     CALL 'kxdfhei1' USING DFHEIV0,
 20730           FILE-ERMAIL,
 20731           DFHEIV99
 20732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20733
 20734
 20735 8140-EXIT.
 20736     EXIT.
 20737
 20738 8150-read-elcrtt.
 20739
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 382
* EL050.cbl
 20740
 20741* EXEC CICS HANDLE CONDITION
 20742*        NOTFND   (8150-exit)
 20743*    END-EXEC
 20744*    MOVE '"$I                   ! / #00019944' TO DFHEIV0
 20745     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20746     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20747     MOVE X'2F20233030303139393434' TO DFHEIV0(25:11)
 20748     CALL 'kxdfhei1' USING DFHEIV0
 20749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20750
 20751     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20752     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20753
 20754
 20755* EXEC CICS READ
 20756*        DATASET  (CRTT-ID)
 20757*        RIDFLD   (WS-ELCRTT-KEY)
 20758*        INTO     (CERTIFICATE-TRAILERS)
 20759*    END-EXEC
 20760     MOVE LENGTH OF
 20761      CERTIFICATE-TRAILERS
 20762       TO DFHEIV11
 20763*    MOVE '&"IL       E          (   #00019951' TO DFHEIV0
 20764     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20765     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20766     MOVE X'2020233030303139393531' TO DFHEIV0(25:11)
 20767     CALL 'kxdfhei1' USING DFHEIV0,
 20768           CRTT-ID,
 20769           CERTIFICATE-TRAILERS,
 20770           DFHEIV11,
 20771           WS-ELCRTT-KEY,
 20772           DFHEIV99,
 20773           DFHEIV99,
 20774           DFHEIV99
 20775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20776
 20777     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20778     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20779     move cs-vehicle-odometer    to ws-vehicle-odometer
 20780
 20781     .
 20782 8150-exit.
 20783     exit.
 20784 8180-UPDATE-VIN-NUMBER.
 20785
 20786* EXEC CICS HANDLE CONDITION
 20787*        NOTFND   (8180-NOTFND)
 20788*    END-EXEC.
 20789*    MOVE '"$I                   ! 0 #00019965' TO DFHEIV0
 20790     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20792     MOVE X'3020233030303139393635' TO DFHEIV0(25:11)
 20793     CALL 'kxdfhei1' USING DFHEIV0
 20794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20795
 20796
 20797     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 383
* EL050.cbl
 20798     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20799
 20800
 20801* EXEC CICS READ
 20802*        UPDATE
 20803*        DATASET  (CRTT-ID)
 20804*        RIDFLD   (WS-ELCRTT-KEY)
 20805*        INTO     (CERTIFICATE-TRAILERS)
 20806*    END-EXEC.
 20807     MOVE LENGTH OF
 20808      CERTIFICATE-TRAILERS
 20809       TO DFHEIV11
 20810*    MOVE '&"IL       EU         (   #00019972' TO DFHEIV0
 20811     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20812     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20813     MOVE X'2020233030303139393732' TO DFHEIV0(25:11)
 20814     CALL 'kxdfhei1' USING DFHEIV0,
 20815           CRTT-ID,
 20816           CERTIFICATE-TRAILERS,
 20817           DFHEIV11,
 20818           WS-ELCRTT-KEY,
 20819           DFHEIV99,
 20820           DFHEIV99,
 20821           DFHEIV99
 20822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20823
 20824
 20825     IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 20826        or (hldi-pass-area not = spaces)
 20827        move pa-modelyear        to cs-year
 20828        move pa-makename         to cs-make
 20829        move pa-modelname        to cs-model
 20830        move pa-seriesname       to cs-future
 20831        MOVE PB-I-VIN TO CS-VIN-NUMBER
 20832
 20833* EXEC CICS REWRITE
 20834*           DATASET  (CRTT-ID)
 20835*           FROM     (CERTIFICATE-TRAILERS)
 20836*        END-EXEC
 20837     MOVE LENGTH OF
 20838      CERTIFICATE-TRAILERS
 20839       TO DFHEIV11
 20840*    MOVE '&& L                  %   #00019986' TO DFHEIV0
 20841     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20842     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20843     MOVE X'2020233030303139393836' TO DFHEIV0(25:11)
 20844     CALL 'kxdfhei1' USING DFHEIV0,
 20845           CRTT-ID,
 20846           CERTIFICATE-TRAILERS,
 20847           DFHEIV11,
 20848           DFHEIV99
 20849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20850     ELSE
 20851
 20852* EXEC CICS UNLOCK
 20853*          DATASET  (CRTT-ID)
 20854*       END-EXEC
 20855*    MOVE '&*                    #   #00019991' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 384
* EL050.cbl
 20856     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20857     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20858     MOVE X'2020233030303139393931' TO DFHEIV0(25:11)
 20859     CALL 'kxdfhei1' USING DFHEIV0,
 20860           CRTT-ID,
 20861           DFHEIV99
 20862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20863     END-IF.
 20864
 20865     GO TO 8180-EXIT.
 20866
 20867 8180-NOTFND.
 20868
 20869     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20870     MOVE 'CS'         TO CS-RECORD-ID.
 20871     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20872     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20873     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20874     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20875
 20876* EXEC CICS WRITE
 20877*       DATASET  (CRTT-ID)
 20878*       RIDFLD   (WS-ELCRTT-KEY)
 20879*       FROM     (CERTIFICATE-TRAILERS)
 20880*    END-EXEC.
 20881     MOVE LENGTH OF
 20882      CERTIFICATE-TRAILERS
 20883       TO DFHEIV11
 20884*    MOVE '&$ L                  ''   #00020006' TO DFHEIV0
 20885     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20886     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20887     MOVE X'2020233030303230303036' TO DFHEIV0(25:11)
 20888     CALL 'kxdfhei1' USING DFHEIV0,
 20889           CRTT-ID,
 20890           CERTIFICATE-TRAILERS,
 20891           DFHEIV11,
 20892           WS-ELCRTT-KEY,
 20893           DFHEIV99,
 20894           DFHEIV99
 20895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20896
 20897
 20898 8180-EXIT.
 20899     EXIT.
 20900
 20901 8190-UPDATE-REFUND-CLAIM-FLAG.
 20902
 20903* EXEC CICS HANDLE CONDITION
 20904*        NOTFND   (8190-NOTFND)
 20905*    END-EXEC.
 20906*    MOVE '"$I                   ! 1 #00020016' TO DFHEIV0
 20907     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20909     MOVE X'3120233030303230303136' TO DFHEIV0(25:11)
 20910     CALL 'kxdfhei1' USING DFHEIV0
 20911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20912
 20913
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 385
* EL050.cbl
 20914     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20915     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20916
 20917
 20918* EXEC CICS READ
 20919*        UPDATE
 20920*        DATASET  (CRTT-ID)
 20921*        RIDFLD   (WS-ELCRTT-KEY)
 20922*        INTO     (CERTIFICATE-TRAILERS)
 20923*    END-EXEC.
 20924     MOVE LENGTH OF
 20925      CERTIFICATE-TRAILERS
 20926       TO DFHEIV11
 20927*    MOVE '&"IL       EU         (   #00020023' TO DFHEIV0
 20928     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20929     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20930     MOVE X'2020233030303230303233' TO DFHEIV0(25:11)
 20931     CALL 'kxdfhei1' USING DFHEIV0,
 20932           CRTT-ID,
 20933           CERTIFICATE-TRAILERS,
 20934           DFHEIV11,
 20935           WS-ELCRTT-KEY,
 20936           DFHEIV99,
 20937           DFHEIV99,
 20938           DFHEIV99
 20939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20940
 20941
 20942     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20943
 20944* EXEC CICS REWRITE
 20945*       DATASET  (CRTT-ID)
 20946*       FROM     (CERTIFICATE-TRAILERS)
 20947*    END-EXEC.
 20948     MOVE LENGTH OF
 20949      CERTIFICATE-TRAILERS
 20950       TO DFHEIV11
 20951*    MOVE '&& L                  %   #00020031' TO DFHEIV0
 20952     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20953     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20954     MOVE X'2020233030303230303331' TO DFHEIV0(25:11)
 20955     CALL 'kxdfhei1' USING DFHEIV0,
 20956           CRTT-ID,
 20957           CERTIFICATE-TRAILERS,
 20958           DFHEIV11,
 20959           DFHEIV99
 20960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20961
 20962
 20963     GO TO 8190-EXIT.
 20964
 20965 8190-NOTFND.
 20966
 20967     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20968     MOVE 'CS'         TO CS-RECORD-ID.
 20969     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20970     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20971     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 386
* EL050.cbl
 20972     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20973
 20974* EXEC CICS WRITE
 20975*       DATASET  (CRTT-ID)
 20976*       RIDFLD   (WS-ELCRTT-KEY)
 20977*       FROM     (CERTIFICATE-TRAILERS)
 20978*    END-EXEC.
 20979     MOVE LENGTH OF
 20980      CERTIFICATE-TRAILERS
 20981       TO DFHEIV11
 20982*    MOVE '&$ L                  ''   #00020046' TO DFHEIV0
 20983     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20985     MOVE X'2020233030303230303436' TO DFHEIV0(25:11)
 20986     CALL 'kxdfhei1' USING DFHEIV0,
 20987           CRTT-ID,
 20988           CERTIFICATE-TRAILERS,
 20989           DFHEIV11,
 20990           WS-ELCRTT-KEY,
 20991           DFHEIV99,
 20992           DFHEIV99
 20993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20994
 20995
 20996 8190-EXIT.
 20997     EXIT.
 20998
 20999 8195-UPDATE-AGE-FLAGS.
 21000
 21001* EXEC CICS HANDLE CONDITION
 21002*        NOTFND   (8195-NOTFND)
 21003*    END-EXEC.
 21004*    MOVE '"$I                   ! 2 #00020056' TO DFHEIV0
 21005     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21007     MOVE X'3220233030303230303536' TO DFHEIV0(25:11)
 21008     CALL 'kxdfhei1' USING DFHEIV0
 21009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21010
 21011
 21012     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21013     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21014
 21015
 21016* EXEC CICS READ
 21017*        UPDATE
 21018*        DATASET  (CRTT-ID)
 21019*        RIDFLD   (WS-ELCRTT-KEY)
 21020*        INTO     (CERTIFICATE-TRAILERS)
 21021*    END-EXEC.
 21022     MOVE LENGTH OF
 21023      CERTIFICATE-TRAILERS
 21024       TO DFHEIV11
 21025*    MOVE '&"IL       EU         (   #00020063' TO DFHEIV0
 21026     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21027     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21028     MOVE X'2020233030303230303633' TO DFHEIV0(25:11)
 21029     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 387
* EL050.cbl
 21030           CRTT-ID,
 21031           CERTIFICATE-TRAILERS,
 21032           DFHEIV11,
 21033           WS-ELCRTT-KEY,
 21034           DFHEIV99,
 21035           DFHEIV99,
 21036           DFHEIV99
 21037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21038
 21039
 21040     IF WS-INS-AGE-SET = 'Y'
 21041        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21042     END-IF
 21043     IF WS-JNT-AGE-SET = 'Y'
 21044        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21045     END-IF
 21046
 21047
 21048* EXEC CICS REWRITE
 21049*       DATASET  (CRTT-ID)
 21050*       FROM     (CERTIFICATE-TRAILERS)
 21051*    END-EXEC.
 21052     MOVE LENGTH OF
 21053      CERTIFICATE-TRAILERS
 21054       TO DFHEIV11
 21055*    MOVE '&& L                  %   #00020077' TO DFHEIV0
 21056     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21057     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21058     MOVE X'2020233030303230303737' TO DFHEIV0(25:11)
 21059     CALL 'kxdfhei1' USING DFHEIV0,
 21060           CRTT-ID,
 21061           CERTIFICATE-TRAILERS,
 21062           DFHEIV11,
 21063           DFHEIV99
 21064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21065
 21066
 21067     GO TO 8195-EXIT.
 21068
 21069 8195-NOTFND.
 21070
 21071     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21072     MOVE 'CS'         TO CS-RECORD-ID.
 21073     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21074     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21075     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21076     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21077     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21078
 21079* EXEC CICS WRITE
 21080*       DATASET  (CRTT-ID)
 21081*       RIDFLD   (WS-ELCRTT-KEY)
 21082*       FROM     (CERTIFICATE-TRAILERS)
 21083*    END-EXEC.
 21084     MOVE LENGTH OF
 21085      CERTIFICATE-TRAILERS
 21086       TO DFHEIV11
 21087*    MOVE '&$ L                  ''   #00020093' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 388
* EL050.cbl
 21088     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21089     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21090     MOVE X'2020233030303230303933' TO DFHEIV0(25:11)
 21091     CALL 'kxdfhei1' USING DFHEIV0,
 21092           CRTT-ID,
 21093           CERTIFICATE-TRAILERS,
 21094           DFHEIV11,
 21095           WS-ELCRTT-KEY,
 21096           DFHEIV99,
 21097           DFHEIV99
 21098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21099
 21100
 21101 8195-EXIT.
 21102     EXIT.
 21103
 21104 8200-READ-REIN-TABLE.
 21105
 21106* EXEC CICS HANDLE CONDITION
 21107*         NOTFND   (8200-NOTFND)
 21108*    END-EXEC.
 21109*    MOVE '"$I                   ! 3 #00020103' TO DFHEIV0
 21110     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21112     MOVE X'3320233030303230313033' TO DFHEIV0(25:11)
 21113     CALL 'kxdfhei1' USING DFHEIV0
 21114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21115
 21116
 21117
 21118* EXEC CICS READ
 21119*        DATASET     (REIN-ID)
 21120*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21121*        RIDFLD      (ERREIN-KEY)
 21122*    END-EXEC.
 21123*    MOVE '&"S        E          (   #00020107' TO DFHEIV0
 21124     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21126     MOVE X'2020233030303230313037' TO DFHEIV0(25:11)
 21127     CALL 'kxdfhei1' USING DFHEIV0,
 21128           REIN-ID,
 21129           DFHEIV20,
 21130           DFHEIV99,
 21131           ERREIN-KEY,
 21132           DFHEIV99,
 21133           DFHEIV99,
 21134           DFHEIV99
 21135     SET ADDRESS OF REINSURANCE-RECORD TO
 21136         DFHEIV20
 21137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21138
 21139
 21140     GO TO 8200-EXIT.
 21141
 21142 8200-NOTFND.
 21143     MOVE 'N'             TO WS-REIN-READ-SW.
 21144
 21145 8200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 389
* EL050.cbl
 21146      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 390
* EL050.cbl
 21148
 21149 8300-READ-CTBL-TABLE.
 21150
 21151* EXEC CICS HANDLE CONDITION
 21152*        NOTFND    (8300-NOTFND)
 21153*        DISABLED  (8300-ERRESS-PROBLEM)
 21154*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21155*        ENDFILE   (8300-NOTFND)
 21156*    END-EXEC.
 21157*    MOVE '"$IcJ''                ! 4 #00020123' TO DFHEIV0
 21158     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21160     MOVE X'3420233030303230313233' TO DFHEIV0(25:11)
 21161     CALL 'kxdfhei1' USING DFHEIV0
 21162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21163
 21164
 21165
 21166* EXEC CICS READ
 21167*        DATASET     (CTBL-ID)
 21168*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21169*        RIDFLD      (ERCTBL-KEY)
 21170*    END-EXEC.
 21171*    MOVE '&"S        E          (   #00020130' TO DFHEIV0
 21172     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21173     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21174     MOVE X'2020233030303230313330' TO DFHEIV0(25:11)
 21175     CALL 'kxdfhei1' USING DFHEIV0,
 21176           CTBL-ID,
 21177           DFHEIV20,
 21178           DFHEIV99,
 21179           ERCTBL-KEY,
 21180           DFHEIV99,
 21181           DFHEIV99,
 21182           DFHEIV99
 21183     SET ADDRESS OF COMM-TABLE-RECORD TO
 21184         DFHEIV20
 21185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21186
 21187
 21188     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21189
 21190     GO TO 8300-EXIT.
 21191
 21192 8300-NOTFND.
 21193
 21194     IF CTBL-SW = '0530'
 21195         MOVE 'AA'                     TO WS-AH-COMP-CD
 21196         MOVE '0550'                   TO CTBL-SW
 21197         MOVE '1'                      TO WS-CTBL-READ-SW
 21198         GO TO 8300-EXIT.
 21199
 21200     IF CTBL-SW = '0540'
 21201         MOVE 'AA'                     TO WS-LF-COMP-CD
 21202         MOVE '0550'                   TO CTBL-SW
 21203         MOVE '1'                      TO WS-CTBL-READ-SW
 21204         GO TO 8300-EXIT.
 21205
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 391
* EL050.cbl
 21206     IF CTBL-SW = '0550'
 21207         MOVE '2'                      TO WS-CTBL-READ-SW
 21208         GO TO 8300-EXIT.
 21209
 21210     GO TO 8300-EXIT.
 21211
 21212 8300-ERRESS-PROBLEM.
 21213
 21214      MOVE ER-8050              TO WS-ERROR.
 21215      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21216
 21217     GO TO 8300-EXIT.
 21218
 21219 8300-EXIT.
 21220      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 392
* EL050.cbl
 21222
 21223
 21224 8400-GETMAIN-ERFORM.
 21225
 21226
 21227* EXEC CICS   GETMAIN
 21228*        LENGTH  (500)
 21229*        SET     (ADDRESS OF FORM-MASTER)
 21230*    END-EXEC.
 21231     MOVE 500
 21232       TO DFHEIV11
 21233*    MOVE '," L                  $   #00020174' TO DFHEIV0
 21234     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21235     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21236     MOVE X'2020233030303230313734' TO DFHEIV0(25:11)
 21237     CALL 'kxdfhei1' USING DFHEIV0,
 21238           DFHEIV20,
 21239           DFHEIV11,
 21240           DFHEIV99
 21241     SET ADDRESS OF FORM-MASTER TO
 21242         DFHEIV20
 21243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21244
 21245
 21246     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21247
 21248 8400-EXIT.
 21249      EXIT.
 21250
 21251 8450-READ-FORM-MASTER.
 21252
 21253
 21254* EXEC CICS  HANDLE CONDITION
 21255*        NOTFND   (8450-FORM-NOT-FOUND)
 21256*        ENDFILE  (8450-FORM-NOT-FOUND)
 21257*    END-EXEC.
 21258*    MOVE '"$I''                  ! 5 #00020186' TO DFHEIV0
 21259     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21261     MOVE X'3520233030303230313836' TO DFHEIV0(25:11)
 21262     CALL 'kxdfhei1' USING DFHEIV0
 21263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21264
 21265
 21266
 21267* EXEC CICS   READ
 21268*        DATASET   (FORM-ID)
 21269*        RIDFLD    (ERFORM-KEY)
 21270*        INTO      (FORM-MASTER)
 21271*        GTEQ
 21272*    END-EXEC.
 21273     MOVE LENGTH OF
 21274      FORM-MASTER
 21275       TO DFHEIV11
 21276*    MOVE '&"IL       G          (   #00020191' TO DFHEIV0
 21277     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21278     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21279     MOVE X'2020233030303230313931' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 393
* EL050.cbl
 21280     CALL 'kxdfhei1' USING DFHEIV0,
 21281           FORM-ID,
 21282           FORM-MASTER,
 21283           DFHEIV11,
 21284           ERFORM-KEY,
 21285           DFHEIV99,
 21286           DFHEIV99,
 21287           DFHEIV99
 21288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21289
 21290
 21291     MOVE  'Y'           TO  FORM-MASTER-SW.
 21292
 21293     GO TO  8450-EXIT.
 21294
 21295 8450-FORM-NOT-FOUND.
 21296
 21297     MOVE  'N'           TO  FORM-MASTER-SW.
 21298
 21299 8450-EXIT.
 21300      EXIT.
 21301
 21302 8500-DATE-CONVERT.
 21303
 21304* EXEC CICS LINK
 21305*        PROGRAM    ('ELDATCV')
 21306*        COMMAREA   (DATE-CONVERSION-DATA)
 21307*        LENGTH     (DC-COMM-LENGTH)
 21308*    END-EXEC.
 21309     MOVE 'ELDATCV' TO DFHEIV1
 21310*    MOVE '."C                   (   #00020210' TO DFHEIV0
 21311     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21312     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21313     MOVE X'2020233030303230323130' TO DFHEIV0(25:11)
 21314     CALL 'kxdfhei1' USING DFHEIV0,
 21315           DFHEIV1,
 21316           DATE-CONVERSION-DATA,
 21317           DC-COMM-LENGTH,
 21318           DFHEIV99,
 21319           DFHEIV99,
 21320           DFHEIV99,
 21321           DFHEIV99
 21322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21323
 21324
 21325 8500-EXIT.
 21326     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 394
* EL050.cbl
 21328
 21329 8555-RELOAD-CONTROL-FILE.
 21330     CONTINUE.
 21331
 21332 8555-EXIT.
 21333     EXIT.
 21334
 21335 8557-GETMAIN-ERPLAN.
 21336
 21337
 21338* EXEC CICS GETMAIN
 21339*        LENGTH    (840)
 21340*        SET       (ADDRESS OF PLAN-RECORDS)
 21341*    END-EXEC.
 21342     MOVE 840
 21343       TO DFHEIV11
 21344*    MOVE '," L                  $   #00020228' TO DFHEIV0
 21345     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21346     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21347     MOVE X'2020233030303230323238' TO DFHEIV0(25:11)
 21348     CALL 'kxdfhei1' USING DFHEIV0,
 21349           DFHEIV20,
 21350           DFHEIV11,
 21351           DFHEIV99
 21352     SET ADDRESS OF PLAN-RECORDS TO
 21353         DFHEIV20
 21354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21355
 21356
 21357     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21358
 21359 8557-EXIT.
 21360     EXIT.
 21361
 21362 8560-GETMAIN.
 21363
 21364* EXEC CICS GETMAIN
 21365*        LENGTH    (2000)
 21366*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21367*    END-EXEC.
 21368     MOVE 2000
 21369       TO DFHEIV11
 21370*    MOVE '," L                  $   #00020239' TO DFHEIV0
 21371     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21372     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21373     MOVE X'2020233030303230323339' TO DFHEIV0(25:11)
 21374     CALL 'kxdfhei1' USING DFHEIV0,
 21375           DFHEIV20,
 21376           DFHEIV11,
 21377           DFHEIV99
 21378     SET ADDRESS OF ACCOUNT-MASTER TO
 21379         DFHEIV20
 21380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21381
 21382
 21383     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21384
 21385 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 395
* EL050.cbl
 21386     EXIT.
 21387
 21388 8570-START-ACCOUNT-MASTER.
 21389
 21390* EXEC CICS HANDLE CONDITION
 21391*        NOTFND    (0199-ACCT-NOT-FOUND)
 21392*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21393*    END-EXEC.
 21394*    MOVE '"$I''                  ! 6 #00020250' TO DFHEIV0
 21395     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21396     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21397     MOVE X'3620233030303230323530' TO DFHEIV0(25:11)
 21398     CALL 'kxdfhei1' USING DFHEIV0
 21399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21400
 21401
 21402
 21403* EXEC CICS STARTBR
 21404*        DATASET    (ACCT-ID)
 21405*        RIDFLD     (ERACCT-KEY)
 21406*        GTEQ
 21407*    END-EXEC.
 21408     MOVE 0
 21409       TO DFHEIV11
 21410*    MOVE '&,         G          &   #00020255' TO DFHEIV0
 21411     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21412     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21413     MOVE X'2020233030303230323535' TO DFHEIV0(25:11)
 21414     CALL 'kxdfhei1' USING DFHEIV0,
 21415           ACCT-ID,
 21416           ERACCT-KEY,
 21417           DFHEIV99,
 21418           DFHEIV11,
 21419           DFHEIV99
 21420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21421
 21422
 21423 8570-EXIT.
 21424     EXIT.
 21425
 21426 8580-READ-ACCOUNT-MASTER.
 21427
 21428* EXEC CICS HANDLE CONDITION
 21429*        NOTFND    (0199-ACCT-NOT-FOUND)
 21430*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21431*    END-EXEC.
 21432*    MOVE '"$I''                  ! 7 #00020265' TO DFHEIV0
 21433     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21435     MOVE X'3720233030303230323635' TO DFHEIV0(25:11)
 21436     CALL 'kxdfhei1' USING DFHEIV0
 21437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21438
 21439
 21440
 21441* EXEC CICS READNEXT
 21442*        DATASET     (ACCT-ID)
 21443*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 396
* EL050.cbl
 21444*        RIDFLD      (ERACCT-KEY)
 21445*    END-EXEC.
 21446     MOVE LENGTH OF
 21447      ACCOUNT-MASTER
 21448       TO DFHEIV12
 21449     MOVE 0
 21450       TO DFHEIV11
 21451*    MOVE '&.IL                  )   #00020270' TO DFHEIV0
 21452     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21453     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21454     MOVE X'2020233030303230323730' TO DFHEIV0(25:11)
 21455     CALL 'kxdfhei1' USING DFHEIV0,
 21456           ACCT-ID,
 21457           ACCOUNT-MASTER,
 21458           DFHEIV12,
 21459           ERACCT-KEY,
 21460           DFHEIV99,
 21461           DFHEIV11,
 21462           DFHEIV99,
 21463           DFHEIV99
 21464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21465
 21466
 21467 8580-EXIT.
 21468     EXIT.
 21469
 21470 8582-READ-COMPENSATION-MASTER.
 21471
 21472* EXEC CICS HANDLE CONDITION
 21473*        NOTFND    (8582-COMP-NOT-FOUND)
 21474*        ENDFILE   (8582-COMP-NOT-FOUND)
 21475*    END-EXEC.
 21476*    MOVE '"$I''                  ! 8 #00020280' TO DFHEIV0
 21477     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21479     MOVE X'3820233030303230323830' TO DFHEIV0(25:11)
 21480     CALL 'kxdfhei1' USING DFHEIV0
 21481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21482
 21483
 21484
 21485* EXEC CICS READ
 21486*        DATASET     (COMP-ID)
 21487*        INTO        (COMPENSATION-MASTER)
 21488*        RIDFLD      (ERCOMP-KEY)
 21489*    END-EXEC.
 21490     MOVE LENGTH OF
 21491      COMPENSATION-MASTER
 21492       TO DFHEIV11
 21493*    MOVE '&"IL       E          (   #00020285' TO DFHEIV0
 21494     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21495     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21496     MOVE X'2020233030303230323835' TO DFHEIV0(25:11)
 21497     CALL 'kxdfhei1' USING DFHEIV0,
 21498           COMP-ID,
 21499           COMPENSATION-MASTER,
 21500           DFHEIV11,
 21501           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 397
* EL050.cbl
 21502           DFHEIV99,
 21503           DFHEIV99,
 21504           DFHEIV99
 21505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21506
 21507
 21508     MOVE 'Y'                    TO COMP-MASTER-SW
 21509
 21510     GO TO 8582-EXIT
 21511     .
 21512 8582-COMP-NOT-FOUND.
 21513
 21514     MOVE 'N'                    TO COMP-MASTER-SW.
 21515
 21516 8582-EXIT.
 21517     EXIT.
 21518
 21519 8583-READ-ERAGTC.
 21520
 21521* EXEC CICS HANDLE CONDITION
 21522*        NOTFND    (8583-AGTC-NOT-FOUND)
 21523*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21524*    END-EXEC.
 21525*    MOVE '"$I''                  ! 9 #00020303' TO DFHEIV0
 21526     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21527     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21528     MOVE X'3920233030303230333033' TO DFHEIV0(25:11)
 21529     CALL 'kxdfhei1' USING DFHEIV0
 21530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21531
 21532
 21533
 21534* EXEC CICS STARTBR
 21535*        DATASET    (AGTC-ID)
 21536*        RIDFLD     (ERAGTC-KEY)
 21537*        GTEQ
 21538*    END-EXEC.
 21539     MOVE 0
 21540       TO DFHEIV11
 21541*    MOVE '&,         G          &   #00020308' TO DFHEIV0
 21542     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21543     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21544     MOVE X'2020233030303230333038' TO DFHEIV0(25:11)
 21545     CALL 'kxdfhei1' USING DFHEIV0,
 21546           AGTC-ID,
 21547           ERAGTC-KEY,
 21548           DFHEIV99,
 21549           DFHEIV11,
 21550           DFHEIV99
 21551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21552
 21553
 21554 8583-READ-ERAGTC-NEXT.
 21555
 21556* EXEC CICS READNEXT
 21557*        DATASET     (AGTC-ID)
 21558*        INTO        (AGENT-COMMISSIONS)
 21559*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 398
* EL050.cbl
 21560*    END-EXEC.
 21561     MOVE LENGTH OF
 21562      AGENT-COMMISSIONS
 21563       TO DFHEIV12
 21564     MOVE 0
 21565       TO DFHEIV11
 21566*    MOVE '&.IL                  )   #00020315' TO DFHEIV0
 21567     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21568     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21569     MOVE X'2020233030303230333135' TO DFHEIV0(25:11)
 21570     CALL 'kxdfhei1' USING DFHEIV0,
 21571           AGTC-ID,
 21572           AGENT-COMMISSIONS,
 21573           DFHEIV12,
 21574           ERAGTC-KEY,
 21575           DFHEIV99,
 21576           DFHEIV11,
 21577           DFHEIV99,
 21578           DFHEIV99
 21579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21580
 21581
 21582*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21583
 21584     GO TO 8583-EXIT
 21585     .
 21586 8583-AGTC-NOT-FOUND.
 21587
 21588     MOVE 'N'                    TO AGTC-MASTER-SW.
 21589
 21590 8583-EXIT.
 21591     EXIT.
 21592
 21593 8584-READ-BANK-CROSS-REF.
 21594
 21595* EXEC CICS HANDLE CONDITION
 21596*        NOTFND    (8584-BXRF-NOT-FOUND)
 21597*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21598*    END-EXEC.
 21599*    MOVE '"$I''                  ! : #00020333' TO DFHEIV0
 21600     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21602     MOVE X'3A20233030303230333333' TO DFHEIV0(25:11)
 21603     CALL 'kxdfhei1' USING DFHEIV0
 21604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21605
 21606
 21607
 21608* EXEC CICS READ
 21609*        DATASET     (BXRF-ID)
 21610*        INTO        (BANK-CROSS-REFERENCE)
 21611*        RIDFLD      (ERBXRF-KEY)
 21612*        LENGTH      (BXRF-REC-LENGTH)
 21613*    END-EXEC.
 21614*    MOVE '&"IL       E          (   #00020338' TO DFHEIV0
 21615     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21617     MOVE X'2020233030303230333338' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 399
* EL050.cbl
 21618     CALL 'kxdfhei1' USING DFHEIV0,
 21619           BXRF-ID,
 21620           BANK-CROSS-REFERENCE,
 21621           BXRF-REC-LENGTH,
 21622           ERBXRF-KEY,
 21623           DFHEIV99,
 21624           DFHEIV99,
 21625           DFHEIV99
 21626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21627
 21628
 21629     MOVE 'Y'                    TO BXRF-MASTER-SW
 21630
 21631     GO TO 8584-EXIT
 21632     .
 21633 8584-BXRF-NOT-FOUND.
 21634
 21635     MOVE 'N'                    TO BXRF-MASTER-SW.
 21636
 21637 8584-EXIT.
 21638     EXIT.
 21639
 21640 8585-READ-PLAN-MASTER.
 21641
 21642
 21643* EXEC CICS HANDLE CONDITION
 21644*        NOTFND    (8585-PLAN-NOT-FOUND)
 21645*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21646*    END-EXEC.
 21647*    MOVE '"$I''                  ! ; #00020358' TO DFHEIV0
 21648     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21650     MOVE X'3B20233030303230333538' TO DFHEIV0(25:11)
 21651     CALL 'kxdfhei1' USING DFHEIV0
 21652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21653
 21654
 21655
 21656* EXEC CICS READ
 21657*        DATASET     (PLAN-ID)
 21658*        INTO        (PLAN-MASTER)
 21659*        RIDFLD      (ERPLAN-KEY)
 21660*    END-EXEC.
 21661     MOVE LENGTH OF
 21662      PLAN-MASTER
 21663       TO DFHEIV11
 21664*    MOVE '&"IL       E          (   #00020363' TO DFHEIV0
 21665     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21666     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21667     MOVE X'2020233030303230333633' TO DFHEIV0(25:11)
 21668     CALL 'kxdfhei1' USING DFHEIV0,
 21669           PLAN-ID,
 21670           PLAN-MASTER,
 21671           DFHEIV11,
 21672           ERPLAN-KEY,
 21673           DFHEIV99,
 21674           DFHEIV99,
 21675           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 400
* EL050.cbl
 21676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21677
 21678
 21679     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21680
 21681     GO TO 8585-EXIT.
 21682
 21683 8585-PLAN-NOT-FOUND.
 21684
 21685     MOVE 'N'                    TO PLAN-MASTER-SW.
 21686
 21687 8585-EXIT.
 21688     EXIT.
 21689
 21690 8586-READ-LOAN-OFFICER.
 21691
 21692* EXEC CICS READ
 21693*        DATASET     (LOFC-ID)
 21694*        INTO        (LOAN-OFFICER-MASTER)
 21695*        RIDFLD      (ERLOFC-KEY)
 21696*        RESP        (WS-RESPONSE)
 21697*    END-EXEC
 21698     MOVE LENGTH OF
 21699      LOAN-OFFICER-MASTER
 21700       TO DFHEIV11
 21701*    MOVE '&"IL       E          (  N#00020381' TO DFHEIV0
 21702     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21704     MOVE X'204E233030303230333831' TO DFHEIV0(25:11)
 21705     CALL 'kxdfhei1' USING DFHEIV0,
 21706           LOFC-ID,
 21707           LOAN-OFFICER-MASTER,
 21708           DFHEIV11,
 21709           ERLOFC-KEY,
 21710           DFHEIV99,
 21711           DFHEIV99,
 21712           DFHEIV99
 21713     MOVE EIBRESP  TO WS-RESPONSE
 21714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21715
 21716     IF WS-RESP-NORMAL
 21717        MOVE 'Y'                 TO LOFC-MASTER-SW
 21718     ELSE
 21719        MOVE 'N'                 TO LOFC-MASTER-SW
 21720     END-IF
 21721     .
 21722 8586-EXIT.
 21723     EXIT.
 21724 8587-START-ERPDEF.
 21725
 21726* EXEC CICS STARTBR
 21727*       DATASET   (PDEF-ID)
 21728*       RIDFLD    (ERPDEF-KEY)
 21729*       GTEQ
 21730*       RESP      (WS-RESPONSE)
 21731*    END-EXEC
 21732     MOVE 0
 21733       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 401
* EL050.cbl
 21734*    MOVE '&,         G          &  N#00020397' TO DFHEIV0
 21735     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21736     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21737     MOVE X'204E233030303230333937' TO DFHEIV0(25:11)
 21738     CALL 'kxdfhei1' USING DFHEIV0,
 21739           PDEF-ID,
 21740           ERPDEF-KEY,
 21741           DFHEIV99,
 21742           DFHEIV11,
 21743           DFHEIV99
 21744     MOVE EIBRESP  TO WS-RESPONSE
 21745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21746     IF WS-RESP-NORMAL
 21747        MOVE 'Y'                 TO PDEF-MASTER-SW
 21748     ELSE
 21749        MOVE 'N'                 TO PDEF-MASTER-SW
 21750     END-IF
 21751     .
 21752 8587-EXIT.
 21753     EXIT.
 21754 8588-READ-ERPDEF.
 21755
 21756* EXEC CICS READNEXT
 21757*       DATASET   (PDEF-ID)
 21758*       RIDFLD    (ERPDEF-KEY)
 21759*       INTO      (PRODUCT-MASTER)
 21760*       RESP      (WS-RESPONSE)
 21761*    END-EXEC
 21762     MOVE LENGTH OF
 21763      PRODUCT-MASTER
 21764       TO DFHEIV12
 21765     MOVE 0
 21766       TO DFHEIV11
 21767*    MOVE '&.IL                  )  N#00020412' TO DFHEIV0
 21768     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21769     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21770     MOVE X'204E233030303230343132' TO DFHEIV0(25:11)
 21771     CALL 'kxdfhei1' USING DFHEIV0,
 21772           PDEF-ID,
 21773           PRODUCT-MASTER,
 21774           DFHEIV12,
 21775           ERPDEF-KEY,
 21776           DFHEIV99,
 21777           DFHEIV11,
 21778           DFHEIV99,
 21779           DFHEIV99
 21780     MOVE EIBRESP  TO WS-RESPONSE
 21781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21782     IF WS-RESP-NORMAL
 21783        MOVE 'Y'                 TO PDEF-MASTER-SW
 21784     ELSE
 21785        MOVE 'N'                 TO PDEF-MASTER-SW
 21786     END-IF
 21787     .
 21788 8588-EXIT.
 21789     EXIT.
 21790 8589-ENDBR-ERPDEF.
 21791
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 402
* EL050.cbl
 21792* EXEC CICS ENDBR
 21793*       DATASET   (PDEF-ID)
 21794*    END-EXEC
 21795     MOVE 0
 21796       TO DFHEIV11
 21797*    MOVE '&2                    $   #00020427' TO DFHEIV0
 21798     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21799     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21800     MOVE X'2020233030303230343237' TO DFHEIV0(25:11)
 21801     CALL 'kxdfhei1' USING DFHEIV0,
 21802           PDEF-ID,
 21803           DFHEIV11,
 21804           DFHEIV99
 21805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21806     .
 21807 8589-EXIT.
 21808     EXIT.
 21809 8590-READ-CERT-MASTER.
 21810     IF PB-COMPANY-ID = 'UCL'
 21811         GO TO 8690-READ-CERT-MASTER-UCL.
 21812
 21813
 21814* EXEC CICS HANDLE CONDITION
 21815*         NOTFND    (0299-CERT-NOT-FOUND)
 21816*    END-EXEC.
 21817*    MOVE '"$I                   ! < #00020437' TO DFHEIV0
 21818     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21820     MOVE X'3C20233030303230343337' TO DFHEIV0(25:11)
 21821     CALL 'kxdfhei1' USING DFHEIV0
 21822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21823
 21824
 21825
 21826* EXEC CICS READ
 21827*        DATASET     (CERT-ID)
 21828*        INTO        (CERTIFICATE-MASTER)
 21829*        RIDFLD      (ELCERT-KEY)
 21830*        UPDATE
 21831*    END-EXEC.
 21832     MOVE LENGTH OF
 21833      CERTIFICATE-MASTER
 21834       TO DFHEIV11
 21835*    MOVE '&"IL       EU         (   #00020441' TO DFHEIV0
 21836     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21837     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21838     MOVE X'2020233030303230343431' TO DFHEIV0(25:11)
 21839     CALL 'kxdfhei1' USING DFHEIV0,
 21840           CERT-ID,
 21841           CERTIFICATE-MASTER,
 21842           DFHEIV11,
 21843           ELCERT-KEY,
 21844           DFHEIV99,
 21845           DFHEIV99,
 21846           DFHEIV99
 21847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21848
 21849
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 403
* EL050.cbl
 21850 8590-EXIT.
 21851     EXIT.
 21852
 21853 8690-READ-CERT-MASTER-UCL.
 21854
 21855* EXEC CICS HANDLE CONDITION
 21856*         NOTFND    (8700-READ-CERT-MASTER)
 21857*    END-EXEC.
 21858*    MOVE '"$I                   ! = #00020452' TO DFHEIV0
 21859     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21861     MOVE X'3D20233030303230343532' TO DFHEIV0(25:11)
 21862     CALL 'kxdfhei1' USING DFHEIV0
 21863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21864
 21865
 21866 8690-READ-CERT-CONT.
 21867
 21868* EXEC CICS READ
 21869*        DATASET     (CERT-ID)
 21870*        INTO        (CERTIFICATE-MASTER)
 21871*        RIDFLD      (ELCERT-KEY)
 21872*        UPDATE
 21873*    END-EXEC.
 21874     MOVE LENGTH OF
 21875      CERTIFICATE-MASTER
 21876       TO DFHEIV11
 21877*    MOVE '&"IL       EU         (   #00020457' TO DFHEIV0
 21878     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21879     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21880     MOVE X'2020233030303230343537' TO DFHEIV0(25:11)
 21881     CALL 'kxdfhei1' USING DFHEIV0,
 21882           CERT-ID,
 21883           CERTIFICATE-MASTER,
 21884           DFHEIV11,
 21885           ELCERT-KEY,
 21886           DFHEIV99,
 21887           DFHEIV99,
 21888           DFHEIV99
 21889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21890
 21891
 21892     GO TO 8590-EXIT.
 21893
 21894 8700-READ-CERT-MASTER.
 21895     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21896     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21897
 21898* EXEC CICS HANDLE CONDITION
 21899*         DUPKEY    (8720-COMP-ACCOUNTS)
 21900*         ENDFILE   (8730-END-BROWSE)
 21901*         NOTFND    (8740-NOT-FOUND)
 21902*    END-EXEC.
 21903*    MOVE '"$$''I                 ! > #00020469' TO DFHEIV0
 21904     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21905     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21906     MOVE X'3E20233030303230343639' TO DFHEIV0(25:11)
 21907     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 404
* EL050.cbl
 21908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21909
 21910
 21911
 21912* EXEC CICS STARTBR
 21913*        DATASET     ('ELCERT5')
 21914*        RIDFLD      (ELCERT2-KEY)
 21915*        EQUAL
 21916*    END-EXEC.
 21917     MOVE 'ELCERT5' TO DFHEIV1
 21918     MOVE 0
 21919       TO DFHEIV11
 21920*    MOVE '&,         E          &   #00020475' TO DFHEIV0
 21921     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21922     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21923     MOVE X'2020233030303230343735' TO DFHEIV0(25:11)
 21924     CALL 'kxdfhei1' USING DFHEIV0,
 21925           DFHEIV1,
 21926           ELCERT2-KEY,
 21927           DFHEIV99,
 21928           DFHEIV11,
 21929           DFHEIV99
 21930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21931
 21932
 21933 8710-READ-NEXT.
 21934
 21935* EXEC CICS READNEXT
 21936*        DATASET     ('ELCERT5')
 21937*        INTO        (CERTIFICATE-MASTER)
 21938*        RIDFLD      (ELCERT2-KEY)
 21939*    END-EXEC.
 21940     MOVE LENGTH OF
 21941      CERTIFICATE-MASTER
 21942       TO DFHEIV12
 21943     MOVE 'ELCERT5' TO DFHEIV1
 21944     MOVE 0
 21945       TO DFHEIV11
 21946*    MOVE '&.IL                  )   #00020482' TO DFHEIV0
 21947     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21948     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21949     MOVE X'2020233030303230343832' TO DFHEIV0(25:11)
 21950     CALL 'kxdfhei1' USING DFHEIV0,
 21951           DFHEIV1,
 21952           CERTIFICATE-MASTER,
 21953           DFHEIV12,
 21954           ELCERT2-KEY,
 21955           DFHEIV99,
 21956           DFHEIV11,
 21957           DFHEIV99,
 21958           DFHEIV99
 21959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21960
 21961
 21962 8720-COMP-ACCOUNTS.
 21963
 21964* EXEC CICS ENTER
 21965*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 405
* EL050.cbl
 21966*         FROM (PB-C-LAST-NAME)
 21967*    END-EXEC.
 21968     MOVE 001
 21969       TO DFHEIV11
 21970*    MOVE ':$F                   %   #00020489' TO DFHEIV0
 21971     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21972     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21973     MOVE X'2020233030303230343839' TO DFHEIV0(25:11)
 21974     CALL 'kxdfhei1' USING DFHEIV0,
 21975           DFHEIV11,
 21976           PB-C-LAST-NAME,
 21977           DFHEIV99,
 21978           DFHEIV99
 21979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21980
 21981
 21982
 21983* EXEC CICS ENTER
 21984*         TRACEID (002)
 21985*         FROM (CM-INSURED-LAST-NAME)
 21986*    END-EXEC.
 21987     MOVE 002
 21988       TO DFHEIV11
 21989*    MOVE ':$F                   %   #00020494' TO DFHEIV0
 21990     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21991     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21992     MOVE X'2020233030303230343934' TO DFHEIV0(25:11)
 21993     CALL 'kxdfhei1' USING DFHEIV0,
 21994           DFHEIV11,
 21995           CM-INSURED-LAST-NAME,
 21996           DFHEIV99,
 21997           DFHEIV99
 21998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21999
 22000
 22001     IF PB-CERT-NO NOT = CM-CERT-NO
 22002         GO TO 8730-END-BROWSE.
 22003
 22004     IF PB-ACCOUNT = CM-ACCOUNT
 22005         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22006             MOVE ER-2799        TO WS-ERROR
 22007             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22008             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22009             GO TO 8730-END-BROWSE.
 22010
 22011     GO TO 8710-READ-NEXT.
 22012
 22013 8730-END-BROWSE.
 22014
 22015* EXEC CICS ENDBR
 22016*         DATASET    ('ELCERT5')
 22017*    END-EXEC.
 22018     MOVE 'ELCERT5' TO DFHEIV1
 22019     MOVE 0
 22020       TO DFHEIV11
 22021*    MOVE '&2                    $   #00020512' TO DFHEIV0
 22022     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22023     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 406
* EL050.cbl
 22024     MOVE X'2020233030303230353132' TO DFHEIV0(25:11)
 22025     CALL 'kxdfhei1' USING DFHEIV0,
 22026           DFHEIV1,
 22027           DFHEIV11,
 22028           DFHEIV99
 22029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22030
 22031
 22032 8740-NOT-FOUND.
 22033     GO TO 0299-CERT-NOT-FOUND.
 22034
 22035 8750-START-ELSTAT.
 22036
 22037* EXEC CICS STARTBR
 22038*       DATASET   (STAT-ID)
 22039*       RIDFLD    (ELSTAT-KEY)
 22040*       GTEQ
 22041*       RESP      (WS-RESPONSE)
 22042*    END-EXEC
 22043     MOVE 0
 22044       TO DFHEIV11
 22045*    MOVE '&,         G          &  N#00020520' TO DFHEIV0
 22046     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22047     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22048     MOVE X'204E233030303230353230' TO DFHEIV0(25:11)
 22049     CALL 'kxdfhei1' USING DFHEIV0,
 22050           STAT-ID,
 22051           ELSTAT-KEY,
 22052           DFHEIV99,
 22053           DFHEIV11,
 22054           DFHEIV99
 22055     MOVE EIBRESP  TO WS-RESPONSE
 22056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22057     IF WS-RESP-NORMAL
 22058        MOVE 'Y'                 TO STAT-MASTER-SW
 22059     ELSE
 22060        MOVE 'N'                 TO STAT-MASTER-SW
 22061     END-IF
 22062     .
 22063 8750-EXIT.
 22064     EXIT.
 22065 8752-READ-ELSTAT.
 22066
 22067* EXEC CICS READNEXT
 22068*       DATASET   (STAT-ID)
 22069*       RIDFLD    (ELSTAT-KEY)
 22070*       INTO      (STATE-FILE)
 22071*       RESP      (WS-RESPONSE)
 22072*    END-EXEC
 22073     MOVE LENGTH OF
 22074      STATE-FILE
 22075       TO DFHEIV12
 22076     MOVE 0
 22077       TO DFHEIV11
 22078*    MOVE '&.IL                  )  N#00020535' TO DFHEIV0
 22079     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22080     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22081     MOVE X'204E233030303230353335' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 407
* EL050.cbl
 22082     CALL 'kxdfhei1' USING DFHEIV0,
 22083           STAT-ID,
 22084           STATE-FILE,
 22085           DFHEIV12,
 22086           ELSTAT-KEY,
 22087           DFHEIV99,
 22088           DFHEIV11,
 22089           DFHEIV99,
 22090           DFHEIV99
 22091     MOVE EIBRESP  TO WS-RESPONSE
 22092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22093     IF WS-RESP-NORMAL
 22094        MOVE 'Y'                 TO STAT-MASTER-SW
 22095     ELSE
 22096        MOVE 'N'                 TO STAT-MASTER-SW
 22097     END-IF
 22098     .
 22099 8752-EXIT.
 22100     EXIT.
 22101 8800-GET-COMP-RATE.
 22102     MOVE +1 TO IB.
 22103     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22104         ADD +9 TO IB
 22105         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22106             ADD +9 TO IB
 22107             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22108                MOVE ZEROS       TO WS-WK-RATE
 22109                GO TO 8800-EXIT.
 22110
 22111     IF PB-I-AGE GREATER CT-AGE (1)
 22112         ADD +3 TO IB
 22113         IF PB-I-AGE GREATER CT-AGE (2)
 22114             ADD +3 TO IB
 22115             IF PB-I-AGE GREATER CT-AGE (3)
 22116                MOVE ZEROS       TO WS-WK-RATE
 22117                GO TO 8800-EXIT.
 22118
 22119     IF WS-WORK-TERM GREATER CT-TRM (1)
 22120         ADD +1 TO IB
 22121         IF WS-WORK-TERM GREATER CT-TRM (2)
 22122             ADD +1 TO IB
 22123             IF WS-WORK-TERM GREATER CT-TRM (3)
 22124                MOVE ZEROS       TO WS-WK-RATE
 22125                GO TO 8800-EXIT.
 22126
 22127     IF CT-RT (IB) NOT NUMERIC
 22128         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22129         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22130         GO TO 8800-GET-COMP-RATE.
 22131
 22132     MOVE CT-RT (IB) TO WS-WK-RATE.
 22133
 22134 8800-EXIT.
 22135     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 408
* EL050.cbl
 22137 8900-ADDRESS-FILE.
 22138     IF ERACCT-FILE-ADDRESSED
 22139         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22140         GO TO 8900-ADDRESS-EXIT.
 22141
 22142     IF ELCNTL-FILE-ADDRESSED
 22143         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22144         GO TO 8900-ADDRESS-EXIT.
 22145
 22146     IF ERPLAN-FILE-ADDRESSED
 22147         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22148         GO TO 8900-ADDRESS-EXIT.
 22149
 22150     IF ERFORM-FILE-ADDRESSED
 22151         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22152         GO TO 8900-ADDRESS-EXIT.
 22153
 22154 8900-ADDRESS-EXIT.
 22155     EXIT.
 22156
 22157 9000-READ-CONTROL.
 22158
 22159* EXEC CICS HANDLE CONDITION
 22160*        NOTFND    (9000-NOTFND)
 22161*    END-EXEC.
 22162*    MOVE '"$I                   ! ? #00020606' TO DFHEIV0
 22163     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22165     MOVE X'3F20233030303230363036' TO DFHEIV0(25:11)
 22166     CALL 'kxdfhei1' USING DFHEIV0
 22167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22168
 22169
 22170
 22171* EXEC CICS READ
 22172*        DATASET     (CNTL-ID)
 22173*        SET         (ADDRESS OF CONTROL-FILE)
 22174*        RIDFLD      (ELCNTL-KEY)
 22175*        GTEQ
 22176*    END-EXEC.
 22177*    MOVE '&"S        G          (   #00020610' TO DFHEIV0
 22178     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22179     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22180     MOVE X'2020233030303230363130' TO DFHEIV0(25:11)
 22181     CALL 'kxdfhei1' USING DFHEIV0,
 22182           CNTL-ID,
 22183           DFHEIV20,
 22184           DFHEIV99,
 22185           ELCNTL-KEY,
 22186           DFHEIV99,
 22187           DFHEIV99,
 22188           DFHEIV99
 22189     SET ADDRESS OF CONTROL-FILE TO
 22190         DFHEIV20
 22191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22192
 22193
 22194     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 409
* EL050.cbl
 22195
 22196 9000-NOTFND.
 22197     IF RC-SW-1 = '1'
 22198        MOVE ER-2616              TO WS-ERROR
 22199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22200        GO TO 9000-EXIT.
 22201
 22202     IF RC-SW-1 = '2'
 22203        MOVE ER-2602              TO WS-ERROR
 22204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22205
 22206 9000-EXIT.
 22207      EXIT.
 22208
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 410
* EL050.cbl
 22210 9100-READ-CONTROL.
 22211
 22212* EXEC CICS HANDLE CONDITION
 22213*        NOTFND  (9100-NOTFND)
 22214*        ENDFILE (9100-NOTFND)
 22215*    END-EXEC.
 22216*    MOVE '"$I''                  ! @ #00020634' TO DFHEIV0
 22217     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22218     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22219     MOVE X'4020233030303230363334' TO DFHEIV0(25:11)
 22220     CALL 'kxdfhei1' USING DFHEIV0
 22221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22222
 22223
 22224
 22225* EXEC CICS READ
 22226*        DATASET     (CNTL-ID)
 22227*        INTO        (CONTROL-FILE)
 22228*        RIDFLD      (ELCNTL-KEY)
 22229*        GTEQ
 22230*    END-EXEC.
 22231     MOVE LENGTH OF
 22232      CONTROL-FILE
 22233       TO DFHEIV11
 22234*    MOVE '&"IL       G          (   #00020639' TO DFHEIV0
 22235     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22236     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22237     MOVE X'2020233030303230363339' TO DFHEIV0(25:11)
 22238     CALL 'kxdfhei1' USING DFHEIV0,
 22239           CNTL-ID,
 22240           CONTROL-FILE,
 22241           DFHEIV11,
 22242           ELCNTL-KEY,
 22243           DFHEIV99,
 22244           DFHEIV99,
 22245           DFHEIV99
 22246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22247
 22248
 22249     GO TO 9100-EXIT.
 22250
 22251 9100-NOTFND.
 22252     IF RC-SW-2 = '0'
 22253        MOVE '1'                  TO STATE-RECORD-ERROR
 22254        GO TO 9100-EXIT
 22255     END-IF
 22256     IF RC-SW-2 = '1'
 22257        MOVE '1'                  TO LF-BENEFIT-ERROR
 22258        MOVE ER-2604              TO WS-ERROR
 22259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22260        GO TO 9100-EXIT.
 22261
 22262     IF RC-SW-2 = '2'
 22263        MOVE '1'                  TO AH-BENEFIT-ERROR
 22264        MOVE ER-2605              TO WS-ERROR
 22265        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22266        GO TO 9100-EXIT.
 22267
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 411
* EL050.cbl
 22268     IF RC-SW-2 = '3'
 22269         MOVE ER-2603           TO WS-ERROR
 22270         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22271         GO TO 9100-EXIT.
 22272
 22273     IF RC-SW-2 = '4'
 22274         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22275         GO TO 9100-EXIT.
 22276
 22277     IF RC-SW-2 = '5'
 22278         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22279         IF WS-AH-INPUT-CD-1 = SPACE
 22280             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22281         ELSE
 22282             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22283
 22284 9100-EXIT.
 22285      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 412
* EL050.cbl
 22287 9200-CONTROL-GETMAIN.
 22288
 22289* EXEC CICS GETMAIN
 22290*         LENGTH   (750)
 22291*         SET      (ADDRESS OF CONTROL-FILE)
 22292*    END-EXEC.
 22293     MOVE 750
 22294       TO DFHEIV11
 22295*    MOVE '," L                  $   #00020685' TO DFHEIV0
 22296     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22297     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22298     MOVE X'2020233030303230363835' TO DFHEIV0(25:11)
 22299     CALL 'kxdfhei1' USING DFHEIV0,
 22300           DFHEIV20,
 22301           DFHEIV11,
 22302           DFHEIV99
 22303     SET ADDRESS OF CONTROL-FILE TO
 22304         DFHEIV20
 22305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22306
 22307
 22308     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22309
 22310 9200-EXIT.
 22311     EXIT.
 22312
 22313 9250-UNLOCK-RETURN.
 22314
 22315* EXEC CICS UNLOCK
 22316*        DATASET   (CERT-ID)
 22317*    END-EXEC.
 22318*    MOVE '&*                    #   #00020696' TO DFHEIV0
 22319     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22320     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22321     MOVE X'2020233030303230363936' TO DFHEIV0(25:11)
 22322     CALL 'kxdfhei1' USING DFHEIV0,
 22323           CERT-ID,
 22324           DFHEIV99
 22325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22326
 22327
 22328 9300-ABEND.
 22329     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22330
 22331
 22332* EXEC CICS LINK
 22333*        PROGRAM   ('EL004')
 22334*        COMMAREA  (WS-ERROR-LINE)
 22335*        LENGTH    (72)
 22336*    END-EXEC.
 22337     MOVE 'EL004' TO DFHEIV1
 22338     MOVE 72
 22339       TO DFHEIV11
 22340*    MOVE '."C                   (   #00020703' TO DFHEIV0
 22341     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22343     MOVE X'2020233030303230373033' TO DFHEIV0(25:11)
 22344     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 413
* EL050.cbl
 22345           DFHEIV1,
 22346           WS-ERROR-LINE,
 22347           DFHEIV11,
 22348           DFHEIV99,
 22349           DFHEIV99,
 22350           DFHEIV99,
 22351           DFHEIV99
 22352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22353
 22354
 22355     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22356
 22357
 22358* EXEC CICS ABEND
 22359*        ABCODE ('EL50')
 22360*    END-EXEC.
 22361     MOVE 'EL50' TO DFHEIV5
 22362*    MOVE '.,A                   "   #00020711' TO DFHEIV0
 22363     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22364     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22365     MOVE X'2020233030303230373131' TO DFHEIV0(25:11)
 22366     CALL 'kxdfhei1' USING DFHEIV0,
 22367           DFHEIV5
 22368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22369
 22370
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 414
* EL050.cbl
 22372
 22373******************************************************************
 22374*                                                                *
 22375*            E R R O R   F O R M A T   R O U T I N E             *
 22376*                                                                *
 22377******************************************************************
 22378
 22379 9900-ERROR-FORMAT.
 22380
 22381     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22382                    PB-COMMON-ERROR (2) OR
 22383                    PB-COMMON-ERROR (3) OR
 22384                    PB-COMMON-ERROR (4) OR
 22385                    PB-COMMON-ERROR (5) OR
 22386                    PB-COMMON-ERROR (6) OR
 22387                    PB-COMMON-ERROR (7) OR
 22388                    PB-COMMON-ERROR (8) OR
 22389                    PB-COMMON-ERROR (9) OR
 22390                    PB-COMMON-ERROR (10)
 22391        GO TO 9900-EXIT.
 22392
 22393     IF PB-NO-OF-ERRORS = +10
 22394        GO TO 9900-EXIT.
 22395
 22396     ADD +1  TO PB-NO-OF-ERRORS.
 22397     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22398                                       (PB-NO-OF-ERRORS).
 22399 9900-EXIT.
 22400     EXIT.
 22401
 22402 9990-RETURN.
 22403     IF BROWSE-STARTED
 22404
 22405* EXEC CICS ENDBR
 22406*            DATASET  (ACCT-ID)
 22407*       END-EXEC.
 22408     MOVE 0
 22409       TO DFHEIV11
 22410*    MOVE '&2                    $   #00020748' TO DFHEIV0
 22411     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22412     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22413     MOVE X'2020233030303230373438' TO DFHEIV0(25:11)
 22414     CALL 'kxdfhei1' USING DFHEIV0,
 22415           ACCT-ID,
 22416           DFHEIV11,
 22417           DFHEIV99
 22418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22419
 22420
 22421 9990-EXIT.
 22422     EXIT.
 22423
 22424
 22425****Check for CRTO record, add one if not found.
 22426 9991-CHECK-FOR-ELCRTO.
 22427
 22428* EXEC CICS HANDLE CONDITION
 22429*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 415
* EL050.cbl
 22430*         ENDFILE (9991-CRTO-NOT-FOUND)
 22431*     END-EXEC.
 22432*    MOVE '"$I''                  ! A #00020758' TO DFHEIV0
 22433     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22435     MOVE X'4120233030303230373538' TO DFHEIV0(25:11)
 22436     CALL 'kxdfhei1' USING DFHEIV0
 22437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22438
 22439     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22440     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22441     MOVE +0                     TO ELCRTO-SEQ-NO
 22442
 22443
 22444* EXEC CICS READ
 22445*       DATASET   ('ELCRTO')
 22446*       INTO      (ORIGINAL-CERTIFICATE)
 22447*       RIDFLD    (ELCRTO-KEY)
 22448*       GTEQ
 22449*       RESP      (WS-RESPONSE)
 22450*    END-EXEC
 22451     MOVE LENGTH OF
 22452      ORIGINAL-CERTIFICATE
 22453       TO DFHEIV11
 22454     MOVE 'ELCRTO' TO DFHEIV1
 22455*    MOVE '&"IL       G          (  N#00020766' TO DFHEIV0
 22456     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22458     MOVE X'204E233030303230373636' TO DFHEIV0(25:11)
 22459     CALL 'kxdfhei1' USING DFHEIV0,
 22460           DFHEIV1,
 22461           ORIGINAL-CERTIFICATE,
 22462           DFHEIV11,
 22463           ELCRTO-KEY,
 22464           DFHEIV99,
 22465           DFHEIV99,
 22466           DFHEIV99
 22467     MOVE EIBRESP  TO WS-RESPONSE
 22468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22469
 22470     IF WS-RESP-NORMAL
 22471        AND (OC-CONTROL-PRIMARY (1:33) =
 22472                 PB-CONTROL-BY-ACCOUNT (1:33))
 22473        AND (OC-RECORD-TYPE =  'I')
 22474           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22475               GO TO 9991-CHECK-INDICATORS
 22476           ELSE
 22477               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22478               GO TO 9991-CRTO-ADD-REC
 22479           END-IF
 22480     END-IF.
 22481
 22482 9991-CRTO-NOT-FOUND.
 22483
 22484     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22485     MOVE 'OC'                TO OC-RECORD-ID
 22486     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22487                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 416
* EL050.cbl
 22488     MOVE +4096               TO OC-KEY-SEQ-NO.
 22489
 22490 9991-CRTO-ADD-REC.
 22491
 22492     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22493     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22494     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22495     MOVE 'I'                 TO OC-RECORD-TYPE
 22496     IF PB-ISSUE
 22497         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22498         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22499         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22500         MOVE PB-I-AGE               TO OC-INS-AGE
 22501         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22502         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22503         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22504         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22505         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22506         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22507         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22508         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22509         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22510         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22511         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22512         IF PB-I-JOINT-COMMISSION > +0
 22513             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22514         ELSE
 22515             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22516         END-IF
 22517         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22518         MOVE +0                     TO OC-LF-CANCEL-AMT
 22519                                        OC-LF-ITD-CANCEL-AMT
 22520         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22521         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22522         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22523         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22524         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22525         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22526         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22527         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22528         MOVE +0                     TO OC-AH-CANCEL-AMT
 22529                                        OC-AH-ITD-CANCEL-AMT
 22530         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22531         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22532         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22533     ELSE
 22534         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22535         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22536         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22537         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22538         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22539         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22540         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22541         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22542         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22543          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22544             MOVE SPACES             TO OC-LF-BENCD
 22545             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 417
* EL050.cbl
 22546                                        OC-LF-BEN-AMT
 22547                                        OC-LF-PRM-AMT
 22548                                        OC-LF-ALT-BEN-AMT
 22549                                        OC-LF-ALT-PRM-AMT
 22550                                        OC-LF-COMM-PCT
 22551                                        OC-LF-CANCEL-AMT
 22552             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22553             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22554         ELSE
 22555             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22556             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22557             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22558             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22559             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22560             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22561             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22562             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22563             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22564             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22565         END-IF
 22566         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22567         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22568          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22569             MOVE SPACES             TO OC-AH-BENCD
 22570             MOVE ZEROS              TO OC-AH-TERM
 22571                                        OC-AH-BEN-AMT
 22572                                        OC-AH-PRM-AMT
 22573                                        OC-AH-COMM-PCT
 22574                                        OC-AH-CANCEL-AMT
 22575                                        OC-AH-CP
 22576             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22577             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22578         ELSE
 22579             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22580             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22581             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22582             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22583             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22584             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22585             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22586             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22587             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22588         END-IF
 22589         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22590         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22591         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22592         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22593     END-IF
 22594     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22595
 22596     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22597
 22598
 22599* EXEC CICS READ
 22600*         DATASET   (FILE-ERMAIL)
 22601*         RIDFLD    (MA-CONTROL-PRIMARY)
 22602*         INTO      (MAILING-DATA)
 22603*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 418
* EL050.cbl
 22604*    END-EXEC
 22605     MOVE LENGTH OF
 22606      MAILING-DATA
 22607       TO DFHEIV11
 22608*    MOVE '&"IL       E          (  N#00020902' TO DFHEIV0
 22609     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22611     MOVE X'204E233030303230393032' TO DFHEIV0(25:11)
 22612     CALL 'kxdfhei1' USING DFHEIV0,
 22613           FILE-ERMAIL,
 22614           MAILING-DATA,
 22615           DFHEIV11,
 22616           MA-CONTROL-PRIMARY,
 22617           DFHEIV99,
 22618           DFHEIV99,
 22619           DFHEIV99
 22620     MOVE EIBRESP  TO WS-RESPONSE
 22621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22622
 22623     IF WS-RESP-NORMAL
 22624         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22625     END-IF.
 22626
 22627     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22628     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22629
 22630
 22631* EXEC CICS READ
 22632*         DATASET  (CRTT-ID)
 22633*         RIDFLD   (WS-ELCRTT-KEY)
 22634*         INTO     (CERTIFICATE-TRAILERS)
 22635*         RESP     (WS-RESPONSE)
 22636*    END-EXEC
 22637     MOVE LENGTH OF
 22638      CERTIFICATE-TRAILERS
 22639       TO DFHEIV11
 22640*    MOVE '&"IL       E          (  N#00020916' TO DFHEIV0
 22641     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22643     MOVE X'204E233030303230393136' TO DFHEIV0(25:11)
 22644     CALL 'kxdfhei1' USING DFHEIV0,
 22645           CRTT-ID,
 22646           CERTIFICATE-TRAILERS,
 22647           DFHEIV11,
 22648           WS-ELCRTT-KEY,
 22649           DFHEIV99,
 22650           DFHEIV99,
 22651           DFHEIV99
 22652     MOVE EIBRESP  TO WS-RESPONSE
 22653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22654
 22655     IF WS-RESP-NORMAL
 22656         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22657         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22658     END-IF.
 22659
 22660
 22661* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 419
* EL050.cbl
 22662*       DATASET   ('ELCRTO')
 22663*       FROM      (ORIGINAL-CERTIFICATE)
 22664*       RIDFLD    (OC-CONTROL-PRIMARY)
 22665*       RESP      (WS-RESPONSE)
 22666*    END-EXEC.
 22667     MOVE LENGTH OF
 22668      ORIGINAL-CERTIFICATE
 22669       TO DFHEIV11
 22670     MOVE 'ELCRTO' TO DFHEIV1
 22671*    MOVE '&$ L                  ''  N#00020928' TO DFHEIV0
 22672     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22673     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22674     MOVE X'204E233030303230393238' TO DFHEIV0(25:11)
 22675     CALL 'kxdfhei1' USING DFHEIV0,
 22676           DFHEIV1,
 22677           ORIGINAL-CERTIFICATE,
 22678           DFHEIV11,
 22679           OC-CONTROL-PRIMARY,
 22680           DFHEIV99,
 22681           DFHEIV99
 22682     MOVE EIBRESP  TO WS-RESPONSE
 22683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22684
 22685
 22686     GO TO 9991-EXIT.
 22687
 22688 9991-CHECK-INDICATORS.
 22689
 22690     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22691         GO TO 9991-EXIT
 22692     END-IF.
 22693
 22694     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22695         GO TO 9991-EXIT
 22696     END-IF.
 22697
 22698
 22699* EXEC CICS READ
 22700*       DATASET   ('ELCRTO')
 22701*       INTO      (ORIGINAL-CERTIFICATE)
 22702*       RIDFLD    (OC-CONTROL-PRIMARY)
 22703*       UPDATE
 22704*       RESP      (WS-RESPONSE)
 22705*    END-EXEC
 22706     MOVE LENGTH OF
 22707      ORIGINAL-CERTIFICATE
 22708       TO DFHEIV11
 22709     MOVE 'ELCRTO' TO DFHEIV1
 22710*    MOVE '&"IL       EU         (  N#00020947' TO DFHEIV0
 22711     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22712     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22713     MOVE X'204E233030303230393437' TO DFHEIV0(25:11)
 22714     CALL 'kxdfhei1' USING DFHEIV0,
 22715           DFHEIV1,
 22716           ORIGINAL-CERTIFICATE,
 22717           DFHEIV11,
 22718           OC-CONTROL-PRIMARY,
 22719           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 420
* EL050.cbl
 22720           DFHEIV99,
 22721           DFHEIV99
 22722     MOVE EIBRESP  TO WS-RESPONSE
 22723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22724     IF WS-RESP-NORMAL
 22725        IF PB-ISSUE
 22726          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22727          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22728          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22729          MOVE PB-I-AGE               TO OC-INS-AGE
 22730          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22731          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22732          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22733          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22734          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22735          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22736          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22737          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22738          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22739          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22740          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22741          IF PB-I-JOINT-COMMISSION > +0
 22742              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22743          ELSE
 22744              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22745          END-IF
 22746          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22747          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22748          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22749          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22750          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22751          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22752          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22753          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22754          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22755
 22756          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22757
 22758* EXEC CICS READ
 22759*             DATASET   (FILE-ERMAIL)
 22760*             RIDFLD    (MA-CONTROL-PRIMARY)
 22761*             INTO      (MAILING-DATA)
 22762*             RESP      (WS-RESPONSE)
 22763*         END-EXEC
 22764     MOVE LENGTH OF
 22765      MAILING-DATA
 22766       TO DFHEIV11
 22767*    MOVE '&"IL       E          (  N#00020987' TO DFHEIV0
 22768     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22769     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22770     MOVE X'204E233030303230393837' TO DFHEIV0(25:11)
 22771     CALL 'kxdfhei1' USING DFHEIV0,
 22772           FILE-ERMAIL,
 22773           MAILING-DATA,
 22774           DFHEIV11,
 22775           MA-CONTROL-PRIMARY,
 22776           DFHEIV99,
 22777           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 421
* EL050.cbl
 22778           DFHEIV99
 22779     MOVE EIBRESP  TO WS-RESPONSE
 22780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22781          IF WS-RESP-NORMAL
 22782             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22783          END-IF
 22784
 22785          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22786          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22787
 22788* EXEC CICS READ
 22789*             DATASET  (CRTT-ID)
 22790*             RIDFLD   (WS-ELCRTT-KEY)
 22791*             INTO     (CERTIFICATE-TRAILERS)
 22792*             RESP     (WS-RESPONSE)
 22793*         END-EXEC
 22794     MOVE LENGTH OF
 22795      CERTIFICATE-TRAILERS
 22796       TO DFHEIV11
 22797*    MOVE '&"IL       E          (  N#00020999' TO DFHEIV0
 22798     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22800     MOVE X'204E233030303230393939' TO DFHEIV0(25:11)
 22801     CALL 'kxdfhei1' USING DFHEIV0,
 22802           CRTT-ID,
 22803           CERTIFICATE-TRAILERS,
 22804           DFHEIV11,
 22805           WS-ELCRTT-KEY,
 22806           DFHEIV99,
 22807           DFHEIV99,
 22808           DFHEIV99
 22809     MOVE EIBRESP  TO WS-RESPONSE
 22810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22811          IF WS-RESP-NORMAL
 22812             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22813                               OC-INS-AGE-DEFAULT-FLAG
 22814             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22815                               OC-JNT-AGE-DEFAULT-FLAG
 22816          END-IF
 22817
 22818        ELSE
 22819          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22820             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22821             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22822             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22823          END-IF
 22824          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22825             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22826             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22827             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22828          END-IF
 22829          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22830        END-IF
 22831
 22832* EXEC CICS REWRITE
 22833*          DATASET   ('ELCRTO')
 22834*          FROM      (ORIGINAL-CERTIFICATE)
 22835*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 422
* EL050.cbl
 22836*       END-EXEC
 22837     MOVE LENGTH OF
 22838      ORIGINAL-CERTIFICATE
 22839       TO DFHEIV11
 22840     MOVE 'ELCRTO' TO DFHEIV1
 22841*    MOVE '&& L                  %  N#00021025' TO DFHEIV0
 22842     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22843     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22844     MOVE X'204E233030303231303235' TO DFHEIV0(25:11)
 22845     CALL 'kxdfhei1' USING DFHEIV0,
 22846           DFHEIV1,
 22847           ORIGINAL-CERTIFICATE,
 22848           DFHEIV11,
 22849           DFHEIV99
 22850     MOVE EIBRESP  TO WS-RESPONSE
 22851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22852     END-IF.
 22853
 22854 9991-EXIT.
 22855     EXIT.
 22856
 22857
 22858 9999-RETURN.
 22859     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22860
 22861
 22862* EXEC CICS RETURN
 22863*    END-EXEC.
 22864*    MOVE '.(                    ''   #00021039' TO DFHEIV0
 22865     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22866     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22867     MOVE X'2020233030303231303339' TO DFHEIV0(25:11)
 22868     CALL 'kxdfhei1' USING DFHEIV0,
 22869           DFHEIV99,
 22870           DFHEIV99,
 22871           DFHEIV99,
 22872           DFHEIV99,
 22873           DFHEIV99,
 22874           DFHEIV99
 22875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22876
 22877
 22878
 22879* GOBACK.
 22880     MOVE '9%                    "   ' TO DFHEIV0
 22881     MOVE 'EL050' TO DFHEIV1
 22882     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22883     GOBACK.
 22884
 22885 9999-DFHBACK SECTION.
 22886     MOVE '9%                    "   ' TO DFHEIV0
 22887     MOVE 'EL050' TO DFHEIV1
 22888     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22889     GOBACK.
 22890 9999-DFHEXIT.
 22891     IF DFHEIGDJ EQUAL 0001
 22892         NEXT SENTENCE
 22893     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 423
* EL050.cbl
 22894         GO TO 9300-ABEND,
 22895               3990-FILES-NOT-OPEN
 22896         DEPENDING ON DFHEIGDI
 22897     ELSE IF DFHEIGDJ EQUAL 3
 22898         GO TO 6610-START-BROWSE,
 22899               6630-ERRESS-PROBLEM,
 22900               6630-END-OF-FILE
 22901         DEPENDING ON DFHEIGDI
 22902     ELSE IF DFHEIGDJ EQUAL 4
 22903         GO TO 6630-END-OF-FILE,
 22904               6630-ERRESS-PROBLEM,
 22905               6630-ERRESS-PROBLEM,
 22906               6630-END-OF-FILE
 22907         DEPENDING ON DFHEIGDI
 22908     ELSE IF DFHEIGDJ EQUAL 5
 22909         GO TO 6630-END-OF-FILE,
 22910               6630-END-OF-FILE,
 22911               6630-ERRESS-PROBLEM,
 22912               6630-ERRESS-PROBLEM
 22913         DEPENDING ON DFHEIGDI
 22914     ELSE IF DFHEIGDJ EQUAL 6
 22915         GO TO 6660-START-BROWSE,
 22916               6690-ERRESC-PROBLEM,
 22917               6690-ERRESC-PROBLEM,
 22918               6690-END-OF-FILE
 22919         DEPENDING ON DFHEIGDI
 22920     ELSE IF DFHEIGDJ EQUAL 7
 22921         GO TO 6690-END-OF-FILE,
 22922               6690-ERRESC-PROBLEM,
 22923               6690-ERRESC-PROBLEM,
 22924               6690-END-OF-FILE
 22925         DEPENDING ON DFHEIGDI
 22926     ELSE IF DFHEIGDJ EQUAL 8
 22927         GO TO 6690-END-OF-FILE,
 22928               6690-ERRESC-PROBLEM,
 22929               6690-ERRESC-PROBLEM,
 22930               6690-END-OF-FILE
 22931         DEPENDING ON DFHEIGDI
 22932     ELSE IF DFHEIGDJ EQUAL 9
 22933         GO TO 7250-CONTINUE,
 22934               7250-CONTINUE
 22935         DEPENDING ON DFHEIGDI
 22936     ELSE IF DFHEIGDJ EQUAL 10
 22937         GO TO 7300-CONTINUE,
 22938               7300-CONTINUE
 22939         DEPENDING ON DFHEIGDI
 22940     ELSE IF DFHEIGDJ EQUAL 11
 22941         GO TO 8000-FREE-MAIN
 22942         DEPENDING ON DFHEIGDI
 22943     ELSE IF DFHEIGDJ EQUAL 12
 22944         GO TO 8100-NOTFND,
 22945               8100-NOTFND
 22946         DEPENDING ON DFHEIGDI
 22947     ELSE IF DFHEIGDJ EQUAL 13
 22948         GO TO 8110-NOTFND,
 22949               8110-NOTFND
 22950         DEPENDING ON DFHEIGDI
 22951     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 424
* EL050.cbl
 22952         GO TO 8130-EXIT
 22953         DEPENDING ON DFHEIGDI
 22954     ELSE IF DFHEIGDJ EQUAL 15
 22955         GO TO 8150-exit
 22956         DEPENDING ON DFHEIGDI
 22957     ELSE IF DFHEIGDJ EQUAL 16
 22958         GO TO 8180-NOTFND
 22959         DEPENDING ON DFHEIGDI
 22960     ELSE IF DFHEIGDJ EQUAL 17
 22961         GO TO 8190-NOTFND
 22962         DEPENDING ON DFHEIGDI
 22963     ELSE IF DFHEIGDJ EQUAL 18
 22964         GO TO 8195-NOTFND
 22965         DEPENDING ON DFHEIGDI
 22966     ELSE IF DFHEIGDJ EQUAL 19
 22967         GO TO 8200-NOTFND
 22968         DEPENDING ON DFHEIGDI
 22969     ELSE IF DFHEIGDJ EQUAL 20
 22970         GO TO 8300-NOTFND,
 22971               8300-ERRESS-PROBLEM,
 22972               8300-ERRESS-PROBLEM,
 22973               8300-NOTFND
 22974         DEPENDING ON DFHEIGDI
 22975     ELSE IF DFHEIGDJ EQUAL 21
 22976         GO TO 8450-FORM-NOT-FOUND,
 22977               8450-FORM-NOT-FOUND
 22978         DEPENDING ON DFHEIGDI
 22979     ELSE IF DFHEIGDJ EQUAL 22
 22980         GO TO 0199-ACCT-NOT-FOUND,
 22981               0199-ACCT-NOT-FOUND
 22982         DEPENDING ON DFHEIGDI
 22983     ELSE IF DFHEIGDJ EQUAL 23
 22984         GO TO 0199-ACCT-NOT-FOUND,
 22985               0199-ACCT-NOT-FOUND
 22986         DEPENDING ON DFHEIGDI
 22987     ELSE IF DFHEIGDJ EQUAL 24
 22988         GO TO 8582-COMP-NOT-FOUND,
 22989               8582-COMP-NOT-FOUND
 22990         DEPENDING ON DFHEIGDI
 22991     ELSE IF DFHEIGDJ EQUAL 25
 22992         GO TO 8583-AGTC-NOT-FOUND,
 22993               8583-AGTC-NOT-FOUND
 22994         DEPENDING ON DFHEIGDI
 22995     ELSE IF DFHEIGDJ EQUAL 26
 22996         GO TO 8584-BXRF-NOT-FOUND,
 22997               8584-BXRF-NOT-FOUND
 22998         DEPENDING ON DFHEIGDI
 22999     ELSE IF DFHEIGDJ EQUAL 27
 23000         GO TO 8585-PLAN-NOT-FOUND,
 23001               8585-PLAN-NOT-FOUND
 23002         DEPENDING ON DFHEIGDI
 23003     ELSE IF DFHEIGDJ EQUAL 28
 23004         GO TO 0299-CERT-NOT-FOUND
 23005         DEPENDING ON DFHEIGDI
 23006     ELSE IF DFHEIGDJ EQUAL 29
 23007         GO TO 8700-READ-CERT-MASTER
 23008         DEPENDING ON DFHEIGDI
 23009     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 22-May-18 11:21 Page 425
* EL050.cbl
 23010         GO TO 8720-COMP-ACCOUNTS,
 23011               8730-END-BROWSE,
 23012               8740-NOT-FOUND
 23013         DEPENDING ON DFHEIGDI
 23014     ELSE IF DFHEIGDJ EQUAL 31
 23015         GO TO 9000-NOTFND
 23016         DEPENDING ON DFHEIGDI
 23017     ELSE IF DFHEIGDJ EQUAL 32
 23018         GO TO 9100-NOTFND,
 23019               9100-NOTFND
 23020         DEPENDING ON DFHEIGDI
 23021     ELSE IF DFHEIGDJ EQUAL 33
 23022         GO TO 9991-CRTO-NOT-FOUND,
 23023               9991-CRTO-NOT-FOUND
 23024         DEPENDING ON DFHEIGDI.
 23025     MOVE '9%                    "   ' TO DFHEIV0
 23026     MOVE 'EL050' TO DFHEIV1
 23027     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23028     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41696     Code:       94700
