* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   3
* EL6311.cbl
    72
    73 ENVIRONMENT DIVISION.
    74
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   4
* EL6311.cbl
    76 DATA DIVISION.
    77 WORKING-STORAGE SECTION.
    78 01  DFH-START PIC X(04).
    79 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    80 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    81 77  FILLER  PIC X(32)  VALUE '********************************'.
    82 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    83 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    84 77  A1                          PIC S999 COMP-3 VALUE +0.
    85 77  N1                          PIC S999 COMP-3 VALUE +0.
    86 77  N2                          PIC S999 COMP-3 VALUE +0.
    87 77  N3                          PIC S999 COMP-3 VALUE +0.
    88 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    89 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    90 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    91     88  REVERSAL                    VALUE 'Y'.
    92 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    93 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    94 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    95 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    96 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    97     88  ERMAIL-FOUND                 VALUE 'Y'.
    98 77  A2                          PIC S9(5) COMP-3 VALUE +0.
    99 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   100 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   101 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   102     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   103 77  ws-stop-sw                  pic x value ' '.
   104     88  i-say-stop                 value 'Y'.
   105 77  ws-check-sw                 pic x value ' '.
   106     88  i-have-checks              value 'Y'.
   107 77  ws-proc-check-sw            pic x value ' '.
   108     88  i-have-processed-checks    value 'Y'.
   109 77  ws-chek-browse-sw           pic x value ' '.
   110 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   111 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   112 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   113 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   114
   115*    COPY ELCSCTM.
   116******************************************************************
   117*                                                                *
   118*                                                                *
   119*                            ELCSCTM                             *
   120*                            VMOD=2.001                          *
   121*                                                                *
   122*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   123*                                                                *
   124******************************************************************
   125 01  SECURITY-MESSAGE.
   126     12  FILLER                          PIC X(30)
   127            VALUE '** LOGIC SECURITY VIOLATION -'.
   128     12  SM-READ                         PIC X(6).
   129     12  FILLER                          PIC X(5)
   130            VALUE ' PGM='.
   131     12  SM-PGM                          PIC X(6).
   132     12  FILLER                          PIC X(5)
   133            VALUE ' OPR='.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   5
* EL6311.cbl
   134     12  SM-PROCESSOR-ID                 PIC X(4).
   135     12  FILLER                          PIC X(6)
   136            VALUE ' TERM='.
   137     12  SM-TERMID                       PIC X(4).
   138     12  FILLER                          PIC XX   VALUE SPACE.
   139     12  SM-JUL-DATE                     PIC 9(5).
   140     12  FILLER                          PIC X    VALUE SPACE.
   141     12  SM-TIME                         PIC 99.99.
   142
   143
   144*    COPY ELCSCRTY.
   145******************************************************************
   146*                                                                *
   147*                                                                *
   148*                            ELCSCRTY                            *
   149*                            VMOD=2.001                          *
   150*                                                                *
   151*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   152*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   153*        SAVED IN PI-SECURITY-ADDRESS.                           *
   154*                                                                *
   155******************************************************************
   156 01  SECURITY-CONTROL.
   157     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   158     12  FILLER                       PIC XX    VALUE 'SC'.
   159     12  SC-CREDIT-CODES.
   160         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   161             20  SC-CREDIT-DISPLAY    PIC X.
   162             20  SC-CREDIT-UPDATE     PIC X.
   163     12  SC-CLAIMS-CODES.
   164         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   165             20  SC-CLAIMS-DISPLAY    PIC X.
   166             20  SC-CLAIMS-UPDATE     PIC X.
   167
   168 01  WS-VA-NO-COMM-MESS.
   169     12  FILLER                  PIC X(41) VALUE
   170        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   171 01  WS-OC-MESSAGE.
   172     12  FILLER                  PIC X(43) VALUE
   173        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   174     12  WS-OC-DIS-AMT           PIC -----9.99.
   175     12  FILLER                  PIC X(4) VALUE ' ON '.
   176     12  WS-OC-DATE              PIC X(10).
   177 01  WS-DATE-AREA.
   178     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   179     12  WS-CURRENT-DT.
   180         16  FILLER              PIC X(6)    VALUE SPACES.
   181         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   182     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   183     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   184     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   185
   186 01  STANDARD-AREAS.
   187     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   188     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   189     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   190     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   191     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   6
* EL6311.cbl
   192     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   193     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   194     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   195     12  PGM-NAME                PIC X(8).
   196     12  TIME-IN                 PIC S9(7).
   197     12  TIME-OUT-R  REDEFINES TIME-IN.
   198         16  FILLER              PIC X.
   199         16  TIME-OUT            PIC 99V99.
   200         16  FILLER              PIC XX.
   201     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   202     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   203     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   204     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   205     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   206     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   207     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   208     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   209     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   210     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   211     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   212     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   213     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   214     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   215     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   216     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   217     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   218     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   219     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   220     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   221     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   222     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   223     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   224     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   225     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   226     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   227     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   228     12  FILE-ID                 PIC X(8).
   229     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   230     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   231     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   232     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   233     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   234     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   235     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   236     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   237     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   238     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   239     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   240     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   241     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   242     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   243     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   244
   245 01  WS-PASS-AREA.
   246     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   247     05  WS-PASS-VADS-REC    PIC X(350).
   248*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   249*                                COPY ELCZREC.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   7
* EL6311.cbl
   250******************************************************************
   251*                                                                *
   252*                                                                *
   253*                            ELCZREC.                            *
   254*                                                                *
   255*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   256*                                                                *
   257******************************************************************
   258*-----------------------------------------------------------------
   259*                   C H A N G E   L O G
   260*
   261* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   262*-----------------------------------------------------------------
   263*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   264* EFFECTIVE    NUMBER
   265*-----------------------------------------------------------------
   266* 122011    2011022800001  AJRA  NEW FILE
   267* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   268* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   269* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   270* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   271*-----------------------------------------------------------------
   272 01  W-Z-CONTROL-DATA.
   273     05  W-NUMBER-OF-COPIES      PIC  9.
   274     05  FILLER                  PIC  X.
   275     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   276     05  FILLER                  PIC  X.
   277     05  W-DAYS-TO-RESEND        PIC  999.
   278     05  FILLER                  PIC  X.
   279     05  W-FORM-TO-RESEND        PIC  X(4).
   280     05  W-ADD-BAR-CODE          PIC  X.
   281     05  W-PROMPT-LETTER         PIC  X.
   282     05  W-HAS-RETURN-ENV        PIC  X.
   283     05  W-ENCLOSURE-CD          PIC  XXX.
   284     05  W-SIG-FLAG-DEFAULT      PIC  X.
   285     05  W-AUTO-CLOSE-IND        PIC  X.
   286     05  FILLER                  PIC  X.
   287     05  W-LETTER-TO-BENE        PIC  X.
   288     05  FILLER                  PIC  X.
   289     05  W-LETTER-TO-ACCT        PIC  X.
   290     05  FILLER                  PIC  X.
   291     05  W-LETTER-TYPE           PIC  X.
   292     05  FILLER                  PIC  X.
   293     05  W-PRINT-CERTIFICATE     PIC  X.
   294     05  FILLER                  PIC  X.
   295     05  W-REFUND-REQUIRED       PIC  X.
   296     05  FILLER                  PIC  X.
   297     05  W-ONBASE-CODE           PIC  XX.
   298     05  FILLER                  PIC  X.
   299     05  W-ACCT-SUMM             PIC  X.
   300     05  FILLER                  PIC  X.
   301     05  W-CSO-SUMM              PIC  X.
   302     05  FILLER                  PIC  X.
   303     05  W-REASONS-REQUIRED      PIC  X.
   304     05  FILLER                  PIC  X(29).
   305******************************************************************
   306*                                                                *
   307*              A C C E S S   K E Y S                             *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   8
* EL6311.cbl
   308*                                                                *
   309******************************************************************
   310
   311 01  ACCESS-KEYS.
   312     12  ERPYAJ-KEY.
   313         16  ERPYAJ-COMPANY-CD       PIC X.
   314         16  ERPYAJ-CARRIER          PIC X.
   315         16  ERPYAJ-GROUPING         PIC X(6).
   316         16  ERPYAJ-FIN-RESP         PIC X(10).
   317         16  ERPYAJ-ACCOUNT          PIC X(10).
   318         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   319         16  ERPYAJ-TYPE             PIC X.
   320     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   321     12  ELCERT-KEY.
   322         16  ELCERT-COMPANY-CD       PIC X.
   323         16  ELCERT-CARRIER          PIC X.
   324         16  ELCERT-GROUPING         PIC X(6).
   325         16  ELCERT-STATE            PIC XX.
   326         16  ELCERT-ACCOUNT          PIC X(10).
   327         16  ELCERT-CERT-EFF-DT      PIC XX.
   328         16  ELCERT-CERT-NO.
   329             20  ELCERT-CERT-PRIME   PIC X(10).
   330             20  ELCERT-CERT-SFX     PIC X.
   331
   332     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   333     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   334     12  ELCRTO-KEY.
   335         16  ELCRTO-COMPANY-CD       PIC X.
   336         16  ELCRTO-CARRIER          PIC X.
   337         16  ELCRTO-GROUPING         PIC X(6).
   338         16  ELCRTO-STATE            PIC XX.
   339         16  ELCRTO-ACCOUNT          PIC X(10).
   340         16  ELCRTO-CERT-EFF-DT      PIC XX.
   341         16  ELCRTO-CERT-NO.
   342             20  ELCRTO-CERT-PRIME   PIC X(10).
   343             20  ELCRTO-CERT-SFX     PIC X.
   344         16  ELCRTO-RECORD-TYPE      PIC X.
   345         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   346
   347     12  ELCRTT-KEY.
   348         16  ELCRTT-PRIMARY          PIC X(33).
   349         16  ELCRTT-REC-TYPE         PIC X(1).
   350     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   351     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   352
   353     12  ERPNDB-KEY.
   354         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   355         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   356         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   357         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   358             ERPNDB-BATCH-SEQ-NO     PIC XX.
   359         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   360
   361     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   362     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   363     12  ERCHEK-KEY.
   364         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   365         16  CHEK-CARRIER            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   9
* EL6311.cbl
   366         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   367         16  CHEK-STATE              PIC XX      VALUE SPACES.
   368         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   369         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   370         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   371         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   372         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   373     12  ELLETR-KEY.
   374         16  LETR-COMPANY-CD     PIC X.
   375         16  LETR-LETTER-ID      PIC X(4).
   376         16  LETR-FILLER         PIC X(8).
   377         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   378     12  ERPNDM-KEY.
   379         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   380         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   381         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   382         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   383
   384*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   385     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   386*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   387     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   388
   389     12  ERPNDB-ALT-KEY.
   390         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   391         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   392         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   393         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   394         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   395         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   396         16  ERPNDB-CERT-NO.
   397             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   398             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   399         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   400         16  ERPNDB-RECORD-TYPE      PIC X.
   401
   402      12  ERPNDB-CSR-KEY.
   403          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   404          20  ERPNDB-CSR-ID                PIC X(4).
   405          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   406          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   407          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   408
   409     12  ERNOTE-KEY.
   410         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   411         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   412         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   413         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   414         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   415         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   416         16  ERNOTE-CERT-NO.
   417             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   418             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   419
   420     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   421     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   422
   423     12  ERCNOT-KEY.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  10
* EL6311.cbl
   424         16  ERCNOT-PART-KEY.
   425             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   426             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   427             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   428             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   429             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   430             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   431             20  ERCNOT-CERT-NO.
   432                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   433                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   434         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   435         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   436
   437     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   438     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   439
   440     12  ERMAIL-KEY.
   441         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   442         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   443         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   444         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   445         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   446         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   447         16  ERMAIL-CERT-NO.
   448             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   449             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   450
   451     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   452     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   453
   454     12  ERRQST-KEY.
   455         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   456         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   457
   458     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   459     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   460
   461     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   462
   463     12  ERLOFC-KEY.
   464         16  ERLOFC-COMPANY-CD          PIC  X.
   465         16  ERLOFC-CARRIER             PIC  X.
   466         16  ERLOFC-GROUPING            PIC  X(6).
   467         16  ERLOFC-STATE               PIC  XX.
   468         16  ERLOFC-ACCOUNT             PIC  X(10).
   469         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   470*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   471
   472     12  ERACCT-KEY.
   473         16  ERACCT-COMPANY-CD          PIC  X.
   474         16  ERACCT-CARRIER             PIC  X.
   475         16  ERACCT-GROUPING            PIC  X(6).
   476         16  ERACCT-STATE               PIC  XX.
   477         16  ERACCT-ACCOUNT             PIC  X(10).
   478         16  ERACCT-EXP-DT.
   479             20  ERACCT-DT              PIC  XX.
   480             20  ERACCT-FILL            PIC  X(4).
   481
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  11
* EL6311.cbl
   482     12  ERENDT-KEY.
   483         16  ENDT-COMPANY-CD       PIC X.
   484         16  ENDT-CARRIER          PIC X.
   485         16  ENDT-GROUPING         PIC X(6).
   486         16  ENDT-STATE            PIC XX.
   487         16  ENDT-ACCOUNT          PIC X(10).
   488         16  ENDT-CERT-EFF-DT      PIC XX.
   489         16  ENDT-CERT-PRIME       PIC X(10).
   490         16  ENDT-CERT-SFX         PIC X.
   491         16  ENDT-RECORD-TYPE      PIC X.
   492         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   493
   494 01  WS-ELMSTR-WORK.
   495     12  ELMSTR-KEY.
   496         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   497         16  MSTR-CERT-NO.
   498             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   499             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   500     12  W-CLAIM-KEY.
   501         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   502         16  W-CL-CERT-NO.
   503             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   504             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   505      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   506 01  CANCEL-GEN-PASS-AREA.
   507     05  CG-OPTION-CODE          PIC X.
   508         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   509         88  CG-FLAT-CANCEL        VALUE '1'.
   510         88  CG-CANCEL             VALUE '2'.
   511         88  CG-CANCEL-REISSUE     VALUE '3'.
   512     05  CG-ERROR-CODE           PIC 99.
   513         88  CG-SUCCESS            VALUE 00.
   514         88  CG-DATE-ERROR         VALUE 01.
   515         88  CG-CERT-NOT-FOUND     VALUE 02.
   516         88  CG-AMOUNT-ERROR       VALUE 04.
   517         88  CG-OPTION-ERROR       VALUE 05.
   518         88  CG-PREV-CAN           VALUE 06.
   519         88  CG-INVALID-DATA       VALUE 07.
   520         88  CG-NO-ACCT-MSTR       VALUE 08.
   521         88  CG-SFX-A-EXIST        VALUE 09.
   522         88  CG-MISC-ERROR         VALUE 99.
   523     05  CG-COMPANY-ID           PIC XXX.
   524     05  CG-PROC-ID              PIC XXXX.
   525     05  CG-CURRENT-DT           PIC XX.
   526     05  CG-MONTH-END-DT         PIC XX.
   527     05  CG-CERT-KEY.
   528         10  CG-CERT-COMPANY-CD  PIC X.
   529         10  CG-CERT-CARRIER     PIC X.
   530         10  CG-CERT-GROUP       PIC X(6).
   531         10  CG-CERT-STATE       PIC XX.
   532         10  CG-CERT-ACCOUNT     PIC X(10).
   533         10  CG-CERT-EFF-DT      PIC XX.
   534         10  CG-CERT-CERT-NO     PIC X(11).
   535     05  CG-LF-CAN-DATA.
   536         10  CG-LF-CAN-DT        PIC XX.
   537         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   538     05  CG-AH-CAN-DATA.
   539         10  CG-AH-CAN-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  12
* EL6311.cbl
   540         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   541     05  CG-CERT-PROFILE-DATA.
   542         10  CG-INS-LNAME        PIC X(15).
   543         10  CG-INS-FNAME        PIC X(10).
   544         10  CG-INS-MID-INIT     PIC X.
   545         10  CG-INS-AGE          PIC 99.
   546         10  CG-JNT-LNAME        PIC X(15).
   547         10  CG-JNT-FNAME        PIC X(10).
   548         10  CG-JNT-MID-INIT     PIC X.
   549         10  CG-JNT-AGE          PIC 99.
   550     05  CG-LF-ISS-DATA.
   551         10  CG-LF-BENCD         PIC XX.
   552         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   553         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   554     05  CG-AH-ISS-DATA.
   555         10  CG-AH-BENCD         PIC XX.
   556         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   557     05  CG-BATCH-NO             PIC X(6).
   558     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   559     05  FILLER                  PIC X(306).
   560******************************************************************
   561*                                                                *
   562*            G E N E R A L   W O R K   A R E A                   *
   563*                                                                *
   564******************************************************************
   565
   566 01  WORK-AREA.
   567     12  WS-RESPONSE             PIC S9(8)   COMP.
   568         88  RESP-NORMAL           VALUE +0.
   569         88  resp-file-notfnd      value +12.
   570         88  RESP-NOTFND           VALUE +13.
   571         88  resp-duprec           value +14.
   572         88  resp-dupkey           value +15.
   573         88  resp-invreq           value +16.
   574         88  RESP-NOTOPEN          VALUE +19.
   575         88  RESP-ENDFILE          VALUE +20.
   576         88  resp-lengtherr        value +22.
   577     12  DEEDIT-FIELD            PIC X(15).
   578     12  FILLER          REDEFINES DEEDIT-FIELD.
   579         16  FILLER              PIC X(4).
   580         16  DEEDIT-FIELD-X11    PIC X(11).
   581     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   582                                 PIC S9(15).
   583     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   584                                 PIC S9(13)V99.
   585     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   586                                 PIC S9(11)V9999.
   587     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   588     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   589     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   590         16  WS-CALC-TERM-WHOLE  PIC S999.
   591         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   592
   593     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   594     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   595         16  WS-HR-MINS          PIC 99V99.
   596         16  FILLER              PIC XX.
   597
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  13
* EL6311.cbl
   598     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   599     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   600
   601     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   602     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   603
   604     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   605     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   606     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   607     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   608     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   609     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   610     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   611
   612     12  QID.
   613         16  QID-TERM            PIC X(4).
   614         16  FILLER              PIC X(4)    VALUE '607B'.
   615
   616     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   617         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   618
   619     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   620         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   621
   622     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   623         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   624                                         'A'.
   625
   626     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   627
   628     12  WS-NUMERIC-SW           PIC X.
   629        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   630
   631     12  WS-EDIT-CSO-FIELD.
   632         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   633                                 PIC X.
   634
   635     12  WS-SAVE-INPUT-FIELDS.
   636         16  WS-BAGE             PIC 99       VALUE ZERO.
   637*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   638         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   639         16  FILLER REDEFINES WS-BAPR.
   640             20  WS-APR-WHOLE-NUM    PIC 99.
   641             20  WS-APR-DEC          PIC 9999.
   642         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   643         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   644
   645         16  WS-B-COVERAGE OCCURS 2 TIMES.
   646             20  WS-TERM-IN-DAYS-SW  PIC X.
   647                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   648             20  WS-BTERM        PIC 999       COMP-3.
   649             20  WS-BALT-TERM    PIC 999       COMP-3.
   650             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   651             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   652             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   653             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   654             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   655             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  14
* EL6311.cbl
   656
   657         16  WS-C-FIELDS COMP-3.
   658             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   659             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   660             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   661
   662         16  WS-D-FIELDS COMP-3.
   663             20  WS-DRISS        PIC S9(5)    VALUE +0.
   664             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   665             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   666             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   667             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   668             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   669
   670     12  WS-SAVE-BIRTH-DATE.
   671         16  FILLER              PIC X(4)   VALUE SPACES.
   672         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   673
   674     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   675     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   676     12  FILLER REDEFINES WS-WORK-BIN-RED.
   677         16  FILLER              PIC X(02).
   678         16  WS-WORK-BIN-DT      PIC X(02).
   679     12  WS-SW-1                 PIC X     VALUE SPACE.
   680     12  WS-SW-2                 PIC X     VALUE SPACE.
   681     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   682         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   683     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   684         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   685
   686     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   687     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   688     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   689     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   690     12  WS-CONVERTED-CANCEL-DATES.
   691         16  WS-CONVERTED-CANDT1                  PIC XX.
   692         16  WS-CONVERTED-CANDT2                  PIC XX.
   693
   694     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   695
   696     12  WS-REC-FOUND-SW         PIC X.
   697         88  RECORD-NOT-FOUND    VALUE 'N'.
   698
   699     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   700         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   701         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   702
   703     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   704         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   705         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   706
   707     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   708         88  BROWSE-STARTED      VALUE 'Y'.
   709
   710     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   711         88  FIRST-TIME          VALUE 'Y'.
   712
   713     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  15
* EL6311.cbl
   714         88  FIRST-ENTRY         VALUE 'Y'.
   715
   716     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   717         88  REC-BILLED          VALUE 'Y'.
   718
   719     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   720         88  NO-CURSOR-SET       VALUE +0.
   721         88  CURSOR-SET          VALUE +1.
   722
   723     12  WS-ERR-SW               PIC X.
   724         88  STD-ERRORS          VALUE 'S'.
   725         88  TRN-ERRORS          VALUE 'T'.
   726
   727     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   728         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   729
   730     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   731         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   732
   733     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   734         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   735
   736     12  WS-ERR-CODE.
   737         16  FILLER              PIC 99.
   738         16  WS-ERROR-SUB        PIC 99.
   739
   740     12  WS-DATE-WORK.
   741         16  WS-WORK-MM          PIC XX.
   742         16  WS-WORK-DD          PIC XX.
   743         16  WS-WORK-YY          PIC XX.
   744
   745     12  WS-MM-YY.
   746         16  WS-MM               PIC XX.
   747         16  FILLER              PIC X     VALUE '/'.
   748         16  WS-YY               PIC XX.
   749
   750     12  WS-CERT-EFF-DT          PIC XX.
   751
   752     12  WS-MEMBER-NO            PIC X(12).
   753     12  FILLER  REDEFINES  WS-MEMBER-NO.
   754         16  WS-MEMBER-NO-1-8    PIC 9(8).
   755         16  FILLER              PIC X(4).
   756
   757     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   758
   759     12  WS-ERPNDB-ALT-KEY.
   760         16  WS-PB-COMPANY-CD-A1         PIC X.
   761         16  WS-PB-CARRIER               PIC X.
   762         16  WS-PB-GROUPING              PIC X(6).
   763         16  WS-PB-STATE                 PIC XX.
   764         16  WS-PB-ACCOUNT               PIC X(10).
   765         16  WS-PB-CERT-EFF-DT           PIC XX.
   766         16  WS-PB-CERT-NO.
   767             20  WS-PB-CERT-PRIME        PIC X(10).
   768             20  WS-PB-CERT-SFX          PIC X.
   769         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   770         16  WS-PB-RECORD-TYPE           PIC X.
   771
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  16
* EL6311.cbl
   772     12  WS-SHOW-SAVE-AREAS.
   773         16  WS-NEW-CERT-NO.
   774             20  WS-NEW-PRIME    PIC X(10).
   775             20  WS-NEW-SUFFIX   PIC X.
   776         16  WS-NEW-CERT-EFF-DT  PIC XX.
   777         16  WS-NEW-RECORD-TYPE  PIC X.
   778         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   779             88   SHOW-RECORD            VALUE 'Y'.
   780
   781     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   782
   783     12  WS-BATCH-NO.
   784         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   785         16  FILLER              PIC X(5) VALUE SPACES.
   786
   787     12  WS-FIRST-NAME.
   788         16  WS-1ST-INIT         PIC X.
   789         16  FILLER              PIC X(9).
   790
   791     12  WS-INITIALS.
   792         16  WS-INITIAL-1        PIC X.
   793         16  WS-INITIAL-2        PIC X.
   794
   795     12  WS-C-HDG.
   796         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   797         16  FILLER              PIC X(4) VALUE '-REF'.
   798
   799     12  WS-D-PREM-HDG.
   800         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   801         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   802
   803     12  WS-D-REFUND-HDG.
   804         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   805         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   806
   807     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   808
   809     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   810     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   811     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   812     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   813     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   814     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   815     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   816
   817     12  WS-01-CANCEL-ERR        PIC X(25)
   818         VALUE 'CANCEL DATE ERROR'.
   819     12  WS-02-CANCEL-ERR        PIC X(25)
   820         VALUE 'CERT NOT FOUND'.
   821     12  WS-04-CANCEL-ERR        PIC X(25)
   822         VALUE 'CANCEL AMOUNT ERROR'.
   823     12  WS-05-CANCEL-ERR        PIC X(25)
   824         VALUE 'CANCEL OPTION ERROR'.
   825     12  WS-06-CANCEL-ERR        PIC X(25)
   826         VALUE 'PREVIOUSLY CANCELLED'.
   827     12  WS-07-CANCEL-ERR        PIC X(25)
   828         VALUE 'INVALID DATA'.
   829     12  WS-08-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  17
* EL6311.cbl
   830         VALUE 'NO ACCOUNT MASTER'.
   831     12  WS-09-CANCEL-ERR        PIC X(25)
   832         VALUE 'SUFFIX ALREADY EXISTS'.
   833     12  WS-99-CANCEL-ERR        PIC X(25)
   834         VALUE 'MISC CANCEL ERROR'.
   835
   836     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   837     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   838
   839     12  WS-AGE-FIELDS.
   840         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   841         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   842         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   843         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   844
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  18
* EL6311.cbl
   846
   847******************************************************************
   848*                                                                *
   849*                 B A T C H   T O T A L S                        *
   850*                                                                *
   851******************************************************************
   852
   853     12  WS-BATCH-RECORD.
   854         16  FILLER                       PIC X(10).
   855         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   856         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   857         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   858         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   859         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   860         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   861         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   862         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   863         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   864         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   865         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   866         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   867         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   868         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   869         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   870         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   871         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   872         16  WS-ACCOUNT-NAME              PIC X(30).
   873         16  FILLER                       PIC X.
   874         16  WS-REFERENCE                 PIC X(12).
   875         16  FILLER                       PIC X(197).
   876
   877     12  WS-BATCH-TOTALS.
   878         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   879         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   880         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   881         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   882         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   883         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   884         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   885         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   886         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   887         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   888         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   889         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   890         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   891         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   892         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   893         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   894         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   895         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   896         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   897
   898     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   899
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  19
* EL6311.cbl
   901
   902******************************************************************
   903*                                                                *
   904*                E R R O R   M E S S A G E S                     *
   905*                                                                *
   906******************************************************************
   907
   908 01  ERROR-MESSAGES.
   909     12  ER-0004                 PIC  9(4) VALUE 0004.
   910     12  ER-0008                 PIC  9(4) VALUE 0008.
   911     12  ER-0023                 PIC  9(4) VALUE 0023.
   912     12  ER-0029                 PIC  9(4) VALUE 0029.
   913     12  ER-0033                 PIC  9(4) VALUE 0033.
   914     12  ER-0070                 PIC  9(4) VALUE 0070.
   915     12  ER-0220                 PIC  9(4) VALUE 0220.
   916     12  ER-0248                 PIC  9(4) VALUE 0248.
   917     12  ER-0280                 PIC  9(4) VALUE 0280.
   918     12  ER-0348                 PIC  9(4) VALUE 0348.
   919     12  ER-0582                 PIC  9(4) VALUE 0582.
   920     12  ER-0877                 PIC  9(4) VALUE 0877.
   921     12  ER-1236                 PIC  9(4) VALUE 1236.
   922     12  ER-1570                 PIC  9(4) VALUE 1570.
   923     12  ER-1575                 PIC  9(4) VALUE 1575.
   924     12  ER-1609                 PIC  9(4) VALUE 1609.
   925     12  ER-1819                 PIC  9(4) VALUE 1819.
   926     12  ER-2077                 PIC  9(4) VALUE 2077.
   927     12  ER-2129                 PIC  9(4) VALUE 2129.
   928     12  ER-2188                 PIC  9(4) VALUE 2188.
   929     12  ER-2192                 PIC  9(4) VALUE 2192.
   930     12  ER-2196                 PIC  9(4) VALUE 2196.
   931     12  ER-2197                 PIC  9(4) VALUE 2197.
   932     12  ER-2198                 PIC  9(4) VALUE 2198.
   933     12  ER-2200                 PIC  9(4) VALUE 2200.
   934     12  ER-2212                 PIC  9(4) VALUE 2212.
   935     12  ER-2218                 PIC  9(4) VALUE 2218.
   936     12  ER-2220                 PIC  9(4) VALUE 2220.
   937     12  ER-2222                 PIC  9(4) VALUE 2222.
   938     12  ER-2223                 PIC  9(4) VALUE 2223.
   939     12  ER-2224                 PIC  9(4) VALUE 2224.
   940     12  ER-2225                 PIC  9(4) VALUE 2225.
   941     12  ER-2226                 PIC  9(4) VALUE 2226.
   942     12  ER-2227                 PIC  9(4) VALUE 2227.
   943     12  ER-2228                 PIC  9(4) VALUE 2228.
   944     12  ER-2240                 PIC  9(4) VALUE 2240.
   945     12  ER-2241                 PIC  9(4) VALUE 2241.
   946     12  ER-2242                 PIC  9(4) VALUE 2242.
   947     12  ER-2243                 PIC  9(4) VALUE 2243.
   948     12  ER-2244                 PIC  9(4) VALUE 2244.
   949     12  ER-2245                 PIC  9(4) VALUE 2245.
   950     12  ER-2246                 PIC  9(4) VALUE 2246.
   951     12  ER-2247                 PIC  9(4) VALUE 2247.
   952     12  ER-2251                 PIC  9(4) VALUE 2251.
   953     12  ER-2252                 PIC  9(4) VALUE 2252.
   954     12  ER-2253                 PIC  9(4) VALUE 2253.
   955     12  ER-2254                 PIC  9(4) VALUE 2254.
   956     12  ER-2255                 PIC  9(4) VALUE 2255.
   957     12  ER-2256                 PIC  9(4) VALUE 2256.
   958     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  20
* EL6311.cbl
   959     12  ER-2258                 PIC  9(4) VALUE 2258.
   960     12  ER-2259                 PIC  9(4) VALUE 2259.
   961     12  ER-2260                 PIC  9(4) VALUE 2260.
   962     12  ER-2261                 PIC  9(4) VALUE 2261.
   963     12  ER-2287                 PIC  9(4) VALUE 2287.
   964     12  ER-2336                 PIC  9(4) VALUE 2336.
   965     12  ER-2337                 PIC  9(4) VALUE 2337.
   966     12  ER-2437                 PIC  9(4) VALUE 2437.
   967     12  ER-2471                 PIC  9(4) VALUE 2471.
   968     12  ER-2530                 PIC  9(4) VALUE 2530.
   969     12  ER-2531                 PIC  9(4) VALUE 2531.
   970     12  ER-2532                 PIC  9(4) VALUE 2532.
   971     12  ER-2533                 PIC  9(4) VALUE 2533.
   972     12  ER-2547                 PIC  9(4) VALUE 2547.
   973     12  ER-2591                 PIC  9(4) VALUE 2591.
   974     12  ER-2592                 PIC  9(4) VALUE 2592.
   975     12  ER-2593                 PIC  9(4) VALUE 2593.
   976     12  ER-2600                 PIC  9(4) VALUE 2600.
   977     12  ER-2601                 PIC  9(4) VALUE 2601.
   978     12  ER-2604                 PIC  9(4) VALUE 2604.
   979     12  ER-2605                 PIC  9(4) VALUE 2605.
   980     12  ER-2606                 PIC  9(4) VALUE 2606.
   981     12  ER-2607                 PIC  9(4) VALUE 2607.
   982     12  ER-2622                 PIC  9(4) VALUE 2622.
   983     12  ER-2625                 PIC  9(4) VALUE 2625.
   984     12  ER-2626                 PIC  9(4) VALUE 2626.
   985     12  ER-2627                 PIC  9(4) VALUE 2627.
   986     12  ER-2628                 PIC  9(4) VALUE 2628.
   987     12  ER-2629                 PIC  9(4) VALUE 2629.
   988     12  ER-2630                 PIC  9(4) VALUE 2630.
   989     12  ER-2631                 PIC  9(4) VALUE 2631.
   990     12  ER-2632                 PIC  9(4) VALUE 2632.
   991     12  ER-2633                 PIC  9(4) VALUE 2633.
   992     12  ER-2634                 PIC  9(4) VALUE 2634.
   993     12  ER-2635                 PIC  9(4) VALUE 2635.
   994     12  ER-2636                 PIC  9(4) VALUE 2636.
   995     12  ER-2639                 PIC  9(4) VALUE 2639.
   996     12  ER-2640                 PIC  9(4) VALUE 2640.
   997     12  ER-2647                 PIC  9(4) VALUE 2647.
   998     12  ER-2648                 PIC  9(4) VALUE 2648.
   999     12  ER-2649                 PIC  9(4) VALUE 2649.
  1000     12  ER-2650                 PIC  9(4) VALUE 2650.
  1001     12  ER-2653                 PIC  9(4) VALUE 2653.
  1002     12  ER-2654                 PIC  9(4) VALUE 2654.
  1003     12  ER-2655                 PIC  9(4) VALUE 2655.
  1004     12  ER-2656                 PIC  9(4) VALUE 2656.
  1005     12  ER-2657                 PIC  9(4) VALUE 2657.
  1006     12  ER-2660                 PIC  9(4) VALUE 2660.
  1007     12  ER-2661                 PIC  9(4) VALUE 2661.
  1008     12  ER-2662                 PIC  9(4) VALUE 2662.
  1009     12  ER-2663                 PIC  9(4) VALUE 2663.
  1010     12  ER-2664                 PIC  9(4) VALUE 2664.
  1011     12  ER-2667                 PIC  9(4) VALUE 2667.
  1012     12  ER-2668                 PIC  9(4) VALUE 2668.
  1013     12  ER-2669                 PIC  9(4) VALUE 2669.
  1014     12  ER-2670                 PIC  9(4) VALUE 2670.
  1015     12  ER-2671                 PIC  9(4) VALUE 2671.
  1016     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  21
* EL6311.cbl
  1017     12  ER-2673                 PIC  9(4) VALUE 2673.
  1018     12  ER-2677                 PIC  9(4) VALUE 2677.
  1019     12  ER-2678                 PIC  9(4) VALUE 2678.
  1020     12  ER-2679                 PIC  9(4) VALUE 2679.
  1021     12  ER-2680                 PIC  9(4) VALUE 2680.
  1022     12  ER-2681                 PIC  9(4) VALUE 2681.
  1023     12  ER-2682                 PIC  9(4) VALUE 2682.
  1024     12  ER-2683                 PIC  9(4) VALUE 2683.
  1025     12  ER-2684                 PIC  9(4) VALUE 2684.
  1026     12  ER-2686                 PIC  9(4) VALUE 2686.
  1027     12  ER-2689                 PIC  9(4) VALUE 2689.
  1028     12  ER-2690                 PIC  9(4) VALUE 2690.
  1029     12  ER-2693                 PIC  9(4) VALUE 2693.
  1030     12  ER-2695                 PIC  9(4) VALUE 2695.
  1031     12  ER-2701                 PIC  9(4) VALUE 2701.
  1032     12  ER-2720                 PIC  9(4) VALUE 2720.
  1033     12  ER-2709                 PIC  9(4) VALUE 2709.
  1034     12  ER-2704                 PIC  9(4) VALUE 2704.
  1035     12  ER-2725                 PIC  9(4) VALUE 2725.
  1036     12  ER-2726                 PIC  9(4) VALUE 2726.
  1037     12  ER-2728                 PIC  9(4) VALUE 2728.
  1038     12  ER-2729                 PIC  9(4) VALUE 2729.
  1039     12  ER-2731                 PIC  9(4) VALUE 2731.
  1040     12  ER-2732                 PIC  9(4) VALUE 2732.
  1041     12  ER-2733                 PIC  9(4) VALUE 2733.
  1042     12  ER-2735                 PIC  9(4) VALUE 2735.
  1043     12  ER-2738                 PIC  9(4) VALUE 2738.
  1044     12  ER-2742                 PIC  9(4) VALUE 2742.
  1045     12  ER-2743                 PIC  9(4) VALUE 2743.
  1046     12  ER-2744                 PIC  9(4) VALUE 2744.
  1047     12  ER-2747                 PIC  9(4) VALUE 2747.
  1048     12  ER-2749                 PIC  9(4) VALUE 2749.
  1049     12  ER-2753                 PIC  9(4) VALUE 2753.
  1050     12  ER-2755                 PIC  9(4) VALUE 2755.
  1051     12  ER-2757                 PIC  9(4) VALUE 2757.
  1052     12  ER-2771                 PIC  9(4) VALUE 2771.
  1053     12  ER-2774                 PIC  9(4) VALUE 2774.
  1054     12  ER-2775                 PIC  9(4) VALUE 2775.
  1055     12  ER-2776                 PIC  9(4) VALUE 2776.
  1056     12  ER-2777                 PIC  9(4) VALUE 2777.
  1057     12  ER-2794                 PIC  9(4) VALUE 2794.
  1058     12  ER-2799                 PIC  9(4) VALUE 2799.
  1059     12  ER-2900                 PIC  9(4) VALUE 2900.
  1060     12  ER-2902                 PIC  9(4) VALUE 2902.
  1061     12  ER-2945                 PIC  9(4) VALUE 2945.
  1062     12  ER-3000                 PIC  9(4) VALUE 3000.
  1063     12  ER-3006                 PIC  9(4) VALUE 3006.
  1064     12  ER-3054                 PIC  9(4) VALUE 3054.
  1065     12  ER-3224                 PIC  9(4) VALUE 3224.
  1066     12  ER-3269                 PIC  9(4) VALUE 3269.
  1067     12  er-3444                 pic  9(4) value 3444.
  1068     12  er-3446                 pic  9(4) value 3446.
  1069     12  er-3447                 pic  9(4) value 3447.
  1070     12  er-3448                 pic  9(4) value 3448.
  1071     12  er-3449                 pic  9(4) value 3449.
  1072     12  ER-3504                 PIC  9(4) VALUE 3504.
  1073     12  ER-3513                 PIC  9(4) VALUE 3513.
  1074     12  ER-3831                 PIC  9(4) VALUE 3831.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  22
* EL6311.cbl
  1075     12  ER-3834                 PIC  9(4) VALUE 3834.
  1076     12  ER-3835                 PIC  9(4) VALUE 3835.
  1077     12  ER-4005                 PIC  9(4) VALUE 4005.
  1078     12  ER-7144                 PIC  9(4) VALUE 7144.
  1079     12  ER-7401                 PIC  9(4) VALUE 7401.
  1080     12  ER-7402                 PIC  9(4) VALUE 7402.
  1081     12  ER-7403                 PIC  9(4) VALUE 7403.
  1082     12  ER-7404                 PIC  9(4) VALUE 7404.
  1083     12  ER-7423                 PIC  9(4) VALUE 7423.
  1084     12  ER-7424                 PIC  9(4) VALUE 7424.
  1085     12  ER-7433                 PIC  9(4) VALUE 7433.
  1086     12  ER-7450                 PIC  9(4) VALUE 7450.
  1087     12  ER-7451                 PIC  9(4) VALUE 7451.
  1088     12  ER-7530                 PIC  9(4) VALUE 7530.
  1089     12  ER-7573                 PIC  9(4) VALUE 7573.
  1090     12  ER-7631                 PIC  9(4) VALUE 7631.
  1091     12  ER-7632                 PIC  9(4) VALUE 7632.
  1092     12  ER-7633                 PIC  9(4) VALUE 7633.
  1093     12  ER-7537                 PIC  9(4) VALUE 7537.
  1094     12  ER-7538                 PIC  9(4) VALUE 7538.
  1095     12  ER-7574                 PIC  9(4) VALUE 7574.
  1096     12  ER-7997                 PIC  9(4) VALUE 7997.
  1097     12  ER-7998                 PIC  9(4) VALUE 7998.
  1098     12  ER-8148                 PIC  9(4) VALUE 8148.
  1099     12  ER-9063                 PIC  9(4) VALUE 9063.
  1100     12  ER-9076                 PIC  9(4) VALUE 9076.
  1101     12  ER-9618                 PIC  9(4) VALUE 9618.
  1102     12  ER-9841                 PIC  9(4) VALUE 9841.
  1103
  1104*                                COPY ELCTEXT.
  1105******************************************************************
  1106*                                                                *
  1107*                                                                *
  1108*                            ELCTEXT.                            *
  1109*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1110*                            VMOD=2.008                          *
  1111*                                                                *
  1112*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1113*                                     FORM LETTERS,              *
  1114*                                     CERT FORM DISPLAY.
  1115*                                                                *
  1116*   FILE TYPE = VSAM,KSDS                                        *
  1117*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1118*                                                                *
  1119*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1120*       ALTERNATE INDEX = NONE                                   *
  1121*                                                                *
  1122*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1123*       ALTERNATE INDEX = NONE                                   *
  1124*                                                                *
  1125*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1126*       ALTERNATE INDEX = NONE                                   *
  1127*                                                                *
  1128*   LOG = NO                                                     *
  1129*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1130******************************************************************
  1131 01  TEXT-FILES.
  1132     12  TEXT-FILE-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  23
* EL6311.cbl
  1133         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1134         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1135         88  HELP-FILE-TEXT             VALUE 'TH'.
  1136
  1137     12  TX-CONTROL-PRIMARY.
  1138         16  TX-COMPANY-CD           PIC X.
  1139             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1140         16  TX-ACCESS-CD-GENL       PIC X(12).
  1141
  1142         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1143             20  TX-LETTER-NO        PIC X(4).
  1144             20  FILLER              PIC X(8).
  1145
  1146         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1147             20  TX-FORM-NO          PIC X(12).
  1148
  1149         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1150             20  TX-HELP-TYPE        PIC X.
  1151                 88  HELP-FOR-GENERAL   VALUE ' '.
  1152                 88  HELP-BY-SCREEN     VALUE 'S'.
  1153                 88  HELP-BY-ERROR      VALUE 'E'.
  1154             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1155                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1156             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1157                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1158             20  FILLER              PIC X(4).
  1159
  1160         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1161
  1162     12  TX-PROCESS-CONTROL          PIC XX.
  1163         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1164
  1165     12  TX-TEXT-LINE                PIC X(70).
  1166
  1167     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1168         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1169         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1170         88  TX-VALID-FORM-SQUEEZE-VALUE
  1171                                        VALUE 'Y' ' '.
  1172
  1173     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1174         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1175         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1176         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1177         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1178         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1179         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1180         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1181                                              'K' 'N' ' '
  1182                                              'Z'.
  1183
  1184     12  TX-ARCHIVE-SW               PIC X.
  1185         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1186         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1187         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1188
  1189     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1190     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  24
* EL6311.cbl
  1191
  1192     12  TX-BSR-CODE                 PIC X.
  1193         88  TX-BSR-LETTER              VALUE 'B'.
  1194         88  TX-NON-BSR-LETTER          VALUE ' '.
  1195
  1196     12  FILLER                      PIC X.
  1197*****************************************************************
  1198*                                COPY ELCCRTO.
  1199******************************************************************
  1200*                                                                *
  1201*                            ELCCRTO.                            *
  1202*                                                                *
  1203*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1204*                                                                *
  1205*   FILE TYPE = VSAM,KSDS                                        *
  1206*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1207*                                                                *
  1208*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1209*                                                                *
  1210*   LOG = YES                                                    *
  1211*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1212******************************************************************
  1213*                   C H A N G E   L O G
  1214*
  1215* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1216*-----------------------------------------------------------------
  1217*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1218* EFFECTIVE    NUMBER
  1219*-----------------------------------------------------------------
  1220* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1221* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1222* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1223* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1224* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1225******************************************************************
  1226 01  ORIGINAL-CERTIFICATE.
  1227     12  OC-RECORD-ID                      PIC XX.
  1228         88  VALID-OC-ID                      VALUE 'OC'.
  1229     12  OC-CONTROL-PRIMARY.
  1230         16  OC-COMPANY-CD                 PIC X.
  1231         16  OC-CARRIER                    PIC X.
  1232         16  OC-GROUPING                   PIC X(6).
  1233         16  OC-STATE                      PIC XX.
  1234         16  OC-ACCOUNT                    PIC X(10).
  1235         16  OC-CERT-EFF-DT                PIC XX.
  1236         16  OC-CERT-NO.
  1237             20  OC-CERT-PRIME             PIC X(10).
  1238             20  OC-CERT-SFX               PIC X.
  1239         16  OC-RECORD-TYPE                PIC X.
  1240         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1241     12  OC-LAST-MAINT-DT                  PIC XX.
  1242     12  OC-LAST-MAINT-BY                  PIC X(4).
  1243     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1244     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1245     12  FILLER                            PIC X(49).
  1246     12  OC-ORIG-REC.
  1247         16  OC-INS-LAST-NAME              PIC X(15).
  1248         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  25
* EL6311.cbl
  1249         16  OC-INS-MIDDLE-INIT            PIC X.
  1250         16  OC-INS-AGE                    PIC S999     COMP-3.
  1251         16  OC-JNT-LAST-NAME              PIC X(15).
  1252         16  OC-JNT-FIRST-NAME             PIC X(10).
  1253         16  OC-JNT-MIDDLE-INIT            PIC X.
  1254         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1255         16  OC-LF-BENCD                   PIC XX.
  1256         16  OC-LF-TERM                    PIC S999      COMP-3.
  1257         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1258         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1259         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1260         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1261         16  OC-LF-EXP-DT                  PIC XX.
  1262         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1263         16  OC-LF-CANCEL-DT               PIC XX.
  1264         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1265         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1266         16  OC-AH-BENCD                   PIC XX.
  1267         16  OC-AH-TERM                    PIC S999      COMP-3.
  1268         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1269         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1270         16  OC-AH-EXP-DT                  PIC XX.
  1271         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1272         16  OC-AH-CP                      PIC 99.
  1273         16  OC-AH-CANCEL-DT               PIC XX.
  1274         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1275         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1276         16  OC-CRED-BENE-NAME             PIC X(25).
  1277         16  OC-1ST-PMT-DT                 PIC XX.
  1278         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1279         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1280         16  OC-ISSUE-TRAN-IND             PIC X.
  1281         16  OC-CANCEL-TRAN-IND            PIC X.
  1282         16  FILLER                        PIC X(211).
  1283
  1284     12  FILLER                            PIC X(50).
  1285******************************************************************
  1286*                                COPY ERCACCT.
  1287******************************************************************
  1288*                                                                *
  1289*                                                                *
  1290*                            ERCACCT                             *
  1291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1292*                            VMOD=2.031                          *
  1293*                                                                *
  1294*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1295*                                                                *
  1296*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1297*   VSAM ACCOUNT MASTER FILES.                                   *
  1298*                                                                *
  1299*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1300*                                                                *
  1301*   FILE TYPE = VSAM,KSDS                                        *
  1302*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1303*                                                                *
  1304*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1305*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1306*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  26
* EL6311.cbl
  1307*   LOG = NO                                                     *
  1308*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1309*                                                                *
  1310*                                                                *
  1311******************************************************************
  1312*                   C H A N G E   L O G
  1313*
  1314* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1315*-----------------------------------------------------------------
  1316*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1317* EFFECTIVE    NUMBER
  1318*-----------------------------------------------------------------
  1319* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1320* 092705    2005050300006  PEMA  ADD SPP LEASES
  1321* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1322* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1323* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1324* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1325* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1326******************************************************************
  1327
  1328 01  ACCOUNT-MASTER.
  1329     12  AM-RECORD-ID                      PIC XX.
  1330         88  VALID-AM-ID                      VALUE 'AM'.
  1331
  1332     12  AM-CONTROL-PRIMARY.
  1333         16  AM-COMPANY-CD                 PIC X.
  1334         16  AM-MSTR-CNTRL.
  1335             20  AM-CONTROL-A.
  1336                 24  AM-CARRIER            PIC X.
  1337                 24  AM-GROUPING.
  1338                     28 AM-GROUPING-PREFIX PIC XXX.
  1339                     28 AM-GROUPING-PRIME  PIC XXX.
  1340                 24  AM-STATE              PIC XX.
  1341                 24  AM-ACCOUNT.
  1342                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1343                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1344             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1345                                           PIC X(19).
  1346             20  AM-CNTRL-B.
  1347                 24  AM-EXPIRATION-DT      PIC XX.
  1348                 24  FILLER                PIC X(4).
  1349             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1350                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1351
  1352     12  AM-CONTROL-BY-VAR-GRP.
  1353         16  AM-COMPANY-CD-A1              PIC X.
  1354         16  AM-VG-CARRIER                 PIC X.
  1355         16  AM-VG-GROUPING                PIC X(6).
  1356         16  AM-VG-STATE                   PIC XX.
  1357         16  AM-VG-ACCOUNT                 PIC X(10).
  1358         16  AM-VG-DATE.
  1359             20  AM-VG-EXPIRATION-DT       PIC XX.
  1360             20  FILLER                    PIC X(4).
  1361         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1362                                           PIC 9(11)      COMP-3.
  1363     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1364         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  27
* EL6311.cbl
  1365         16  AM-VG-KEY3.
  1366             20  AM-VG3-ACCOUNT            PIC X(10).
  1367             20  AM-VG3-EXP-DT             PIC XX.
  1368         16  FILLER                        PIC X(4).
  1369     12  AM-MAINT-INFORMATION.
  1370         16  AM-LAST-MAINT-DT              PIC XX.
  1371         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1372         16  AM-LAST-MAINT-USER            PIC X(4).
  1373         16  FILLER                        PIC XX.
  1374
  1375     12  AM-EFFECTIVE-DT                   PIC XX.
  1376     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1377
  1378     12  AM-PREV-DATES  COMP-3.
  1379         16  AM-PREV-EXP-DT                PIC 9(11).
  1380         16  AM-PREV-EFF-DT                PIC 9(11).
  1381
  1382     12  AM-REPORT-CODE-1                  PIC X(10).
  1383     12  AM-REPORT-CODE-2                  PIC X(10).
  1384
  1385     12  AM-CITY-CODE                      PIC X(4).
  1386     12  AM-COUNTY-PARISH                  PIC X(6).
  1387
  1388     12  AM-NAME                           PIC X(30).
  1389     12  AM-PERSON                         PIC X(30).
  1390     12  AM-ADDRS                          PIC X(30).
  1391     12  AM-CITY.
  1392         16  AM-ADDR-CITY                  PIC X(28).
  1393         16  AM-ADDR-STATE                 PIC XX.
  1394     12  AM-ZIP.
  1395         16  AM-ZIP-PRIME.
  1396             20  AM-ZIP-PRI-1ST            PIC X.
  1397                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1398             20  FILLER                    PIC X(4).
  1399         16  AM-ZIP-PLUS4                  PIC X(4).
  1400     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1401         16  AM-CAN-POSTAL-1               PIC XXX.
  1402         16  AM-CAN-POSTAL-2               PIC XXX.
  1403         16  FILLER                        PIC XXX.
  1404     12  AM-TEL-NO.
  1405         16  AM-AREA-CODE                  PIC 999.
  1406         16  AM-TEL-PRE                    PIC 999.
  1407         16  AM-TEL-NBR                    PIC 9(4).
  1408     12  AM-TEL-LOC                        PIC X.
  1409         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1410         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1411
  1412     12  AM-COMM-STRUCTURE.
  1413         16  AM-DEFN-1.
  1414             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1415                 24  AM-AGT.
  1416                     28  AM-AGT-PREFIX     PIC X(4).
  1417                     28  AM-AGT-PRIME      PIC X(6).
  1418                 24  AM-COM-TYP            PIC X.
  1419                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1420                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1421                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1422                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  28
* EL6311.cbl
  1423                 24  AM-RETRO-LV-INDIC     PIC X.
  1424                 24  AM-GL-CODES           PIC X.
  1425                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1426                 24  FILLER                PIC X(01).
  1427         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1428             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1429                 24  FILLER                PIC X(11).
  1430                 24  AM-L-COMA             PIC XXX.
  1431                 24  AM-J-COMA             PIC XXX.
  1432                 24  AM-A-COMA             PIC XXX.
  1433                 24  FILLER                PIC X(6).
  1434
  1435     12  AM-COMM-CHANGE-STATUS             PIC X.
  1436         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1437
  1438     12  AM-CSR-CODE                       PIC X(4).
  1439
  1440     12  AM-BILLING-STATUS                 PIC X.
  1441         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1442         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1443     12  AM-AUTO-REFUND-SW                 PIC X.
  1444         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1445         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1446     12  AM-GPCD                           PIC 99.
  1447     12  AM-IG                             PIC X.
  1448         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1449         88  AM-HAS-GROUP                     VALUE '2'.
  1450     12  AM-STATUS                         PIC X.
  1451         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1452         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1453         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1454         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1455         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1456         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1457     12  AM-REMIT-TO                       PIC 99.
  1458     12  AM-ID-NO                          PIC X(11).
  1459
  1460     12  AM-CAL-TABLE                      PIC XX.
  1461     12  AM-LF-DEVIATION                   PIC XXX.
  1462     12  AM-AH-DEVIATION                   PIC XXX.
  1463     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1464     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1465     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1466     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1467     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1468     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1469
  1470     12  AM-USER-FIELDS.
  1471         16  AM-FLD-1                      PIC XX.
  1472         16  AM-FLD-2                      PIC XX.
  1473         16  AM-FLD-3                      PIC XX.
  1474         16  AM-FLD-4                      PIC XX.
  1475         16  AM-FLD-5                      PIC XX.
  1476
  1477     12  AM-1ST-PROD-DATE.
  1478         16  AM-1ST-PROD-YR                PIC XX.
  1479         16  AM-1ST-PROD-MO                PIC XX.
  1480         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  29
* EL6311.cbl
  1481     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1482     12  AM-CERTS-PURGED-DATE.
  1483         16  AM-PUR-YR                     PIC XX.
  1484         16  AM-PUR-MO                     PIC XX.
  1485         16  AM-PUR-DA                     PIC XX.
  1486     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1487     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1488     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1489     12  AM-INACTIVE-DATE.
  1490         16  AM-INA-MO                     PIC 99.
  1491         16  AM-INA-DA                     PIC 99.
  1492         16  AM-INA-YR                     PIC 99.
  1493     12  AM-AR-HI-CERT-DATE                PIC XX.
  1494
  1495     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1496     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1497
  1498     12  AM-OB-PAYMENT-MODE                PIC X.
  1499         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1500         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1501         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1502         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1503
  1504     12  AM-AH-ONLY-INDICATOR              PIC X.
  1505         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1506         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1507
  1508     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1509
  1510     12  AM-OVER-SHORT.
  1511         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1512         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1513
  1514     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1515     12  AM-DCC-CLP-STATE                  PIC XX.
  1516
  1517     12  AM-RECALC-COMM                    PIC X.
  1518     12  AM-RECALC-REIN                    PIC X.
  1519
  1520     12  AM-REI-TABLE                      PIC XXX.
  1521     12  AM-REI-ET-LF                      PIC X.
  1522     12  AM-REI-ET-AH                      PIC X.
  1523     12  AM-REI-PE-LF                      PIC X.
  1524     12  AM-REI-PE-AH                      PIC X.
  1525     12  AM-REI-PRT-ST                     PIC X.
  1526     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1527     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1528     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1529     12  AM-REI-GROUP-A                    PIC X(6).
  1530     12  AM-REI-MORT                       PIC X(4).
  1531     12  AM-REI-PRT-OW                     PIC X.
  1532     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1533     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1534     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1535     12  AM-REI-GROUP-B                    PIC X(6).
  1536
  1537     12  AM-TRUST-TYPE                     PIC X(2).
  1538
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  30
* EL6311.cbl
  1539     12  AM-EMPLOYER-STMT-USED             PIC X.
  1540     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1541
  1542     12  AM-STD-AH-TYPE                    PIC XX.
  1543     12  AM-EARN-METHODS.
  1544         16  AM-EARN-METHOD-R              PIC X.
  1545             88 AM-REF-RL-R78                 VALUE 'R'.
  1546             88 AM-REF-RL-PR                  VALUE 'P'.
  1547             88 AM-REF-RL-MEAN                VALUE 'M'.
  1548             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1549         16  AM-EARN-METHOD-L              PIC X.
  1550             88 AM-REF-LL-R78                 VALUE 'R'.
  1551             88 AM-REF-LL-PR                  VALUE 'P'.
  1552             88 AM-REF-LL-MEAN                VALUE 'M'.
  1553             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1554         16  AM-EARN-METHOD-A              PIC X.
  1555             88 AM-REF-AH-R78                 VALUE 'R'.
  1556             88 AM-REF-AH-PR                  VALUE 'P'.
  1557             88 AM-REF-AH-MEAN                VALUE 'M'.
  1558             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1559             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1560             88 AM-REF-AH-NET                 VALUE 'N'.
  1561
  1562     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1563     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1564     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1565
  1566     12  AM-RET-Y-N                        PIC X.
  1567     12  AM-RET-P-E                        PIC X.
  1568     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1569     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1570     12  AM-RET-GRP                        PIC X(6).
  1571     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1572         16  AM-POOL-PRIME                 PIC XXX.
  1573         16  AM-POOL-SUB                   PIC XXX.
  1574     12  AM-RETRO-EARNINGS.
  1575         16  AM-RET-EARN-R                 PIC X.
  1576         16  AM-RET-EARN-L                 PIC X.
  1577         16  AM-RET-EARN-A                 PIC X.
  1578     12  AM-RET-ST-TAX-USE                 PIC X.
  1579         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1580         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1581     12  AM-RETRO-BEG-EARNINGS.
  1582         16  AM-RET-BEG-EARN-R             PIC X.
  1583         16  AM-RET-BEG-EARN-L             PIC X.
  1584         16  AM-RET-BEG-EARN-A             PIC X.
  1585     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1586     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1587
  1588     12  AM-USER-SELECT-OPTIONS.
  1589         16  AM-USER-SELECT-1              PIC X(10).
  1590         16  AM-USER-SELECT-2              PIC X(10).
  1591         16  AM-USER-SELECT-3              PIC X(10).
  1592         16  AM-USER-SELECT-4              PIC X(10).
  1593         16  AM-USER-SELECT-5              PIC X(10).
  1594
  1595     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1596
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  31
* EL6311.cbl
  1597     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1598
  1599     12  AM-RPT045A-SWITCH                 PIC X.
  1600         88  RPT045A-OFF                   VALUE 'N'.
  1601
  1602     12  AM-INSURANCE-LIMITS.
  1603         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1604         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1605
  1606     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1607         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1608
  1609     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1610         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1611         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1612
  1613     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1614
  1615     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1616     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1617     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1618     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1619     12  AM-DCC-UEF-STATE                  PIC XX.
  1620     12  FILLER                            PIC XXX.
  1621     12  AM-REPORT-CODE-3                  PIC X(10).
  1622*    12  FILLER                            PIC X(22).
  1623
  1624     12  AM-RESERVE-DATE.
  1625         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1626         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1627         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1628
  1629     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1630     12  AM-NOTIFICATION-TYPES.
  1631         16  AM-NOTIF-OF-LETTERS           PIC X.
  1632         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1633         16  AM-NOTIF-OF-REPORTS           PIC X.
  1634         16  AM-NOTIF-OF-STATUS            PIC X.
  1635
  1636     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1637         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1638         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1639         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1640         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1641
  1642     12  AM-BENEFIT-CONTROLS.
  1643         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1644             20  AM-BENEFIT-CODE           PIC XX.
  1645             20  AM-BENEFIT-TYPE           PIC X.
  1646             20  AM-BENEFIT-REVISION       PIC XXX.
  1647             20  AM-BENEFIT-REM-TERM       PIC X.
  1648             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1649             20  FILLER                    PIC XX.
  1650         16  FILLER                        PIC X(80).
  1651
  1652     12  AM-TRANSFER-DATA.
  1653         16  AM-TRANSFERRED-FROM.
  1654             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  32
* EL6311.cbl
  1655             20  AM-TRNFROM-GROUPING.
  1656                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1657                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1658             20  AM-TRNFROM-STATE          PIC XX.
  1659             20  AM-TRNFROM-ACCOUNT.
  1660                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1661                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1662             20  AM-TRNFROM-DTE            PIC XX.
  1663         16  AM-TRANSFERRED-TO.
  1664             20  AM-TRNTO-CARRIER          PIC X.
  1665             20  AM-TRNTO-GROUPING.
  1666                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1667                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1668             20  AM-TRNTO-STATE            PIC XX.
  1669             20  AM-TRNTO-ACCOUNT.
  1670                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1671                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1672             20  AM-TRNTO-DTE              PIC XX.
  1673         16  FILLER                        PIC X(10).
  1674
  1675     12  AM-SAVED-REMIT-TO                 PIC 99.
  1676
  1677     12  AM-COMM-STRUCTURE-SAVED.
  1678         16  AM-DEFN-1-SAVED.
  1679             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1680                 24  AM-AGT-SV             PIC X(10).
  1681                 24  AM-COM-TYP-SV         PIC X.
  1682                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1683                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1684                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1685                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1686                 24  FILLER                PIC X.
  1687                 24  AM-GL-CODES-SV        PIC X.
  1688                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1689                 24  FILLER                PIC X.
  1690         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1691             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1692                 24  FILLER                PIC X(11).
  1693                 24  AM-L-COMA-SV          PIC XXX.
  1694                 24  AM-J-COMA-SV          PIC XXX.
  1695                 24  AM-A-COMA-SV          PIC XXX.
  1696                 24  FILLER                PIC X(6).
  1697
  1698     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1699         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1700            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1701            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1702            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1703
  1704     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1705     12  FILLER                            PIC X(120).
  1706
  1707     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1708         16  AM-CONTROL-NAME               PIC X(30).
  1709         16  AM-EXECUTIVE-ONE.
  1710             20  AM-EXEC1-NAME             PIC X(15).
  1711             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1712                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  33
* EL6311.cbl
  1713             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1714                                                          COMP-3.
  1715         16  AM-EXECUTIVE-TWO.
  1716             20  AM-EXEC2-NAME             PIC X(15).
  1717             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1718                                                          COMP-3.
  1719             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1720                                                          COMP-3.
  1721
  1722     12  AM-RETRO-ADDITIONAL-DATA.
  1723         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1724         16  AM-RETRO-PREM-P-E             PIC X.
  1725         16  AM-RETRO-CLMS-P-I             PIC X.
  1726         16  AM-RETRO-RET-BRACKET-LF.
  1727             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1728                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1729                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1730             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1731                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1732                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1733             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1734                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1735                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1736         16  AM-RETRO-RET-BRACKET-AH.
  1737             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1738                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1739                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1740                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1741             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1742                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1743                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1744             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1745                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1746                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1747
  1748     12  AM-COMMENTS.
  1749         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1750
  1751     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1752         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1753         16  AM-FLI-BILLING-CODE           PIC X.
  1754         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1755         16  AM-FLI-UNITED-IDENT           PIC X.
  1756         16  AM-FLI-INTEREST-LOST-DATA.
  1757             20  AM-FLI-BANK-NO            PIC X(5).
  1758             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1759             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1760             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1761         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1762             20  AM-FLI-AGT                PIC X(9).
  1763             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1764             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1765         16  FILLER                        PIC X(102).
  1766
  1767     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1768         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1769             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1770             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  34
* EL6311.cbl
  1771             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1772             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1773             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1774         16  FILLER                          PIC X(10).
  1775******************************************************************
  1776*                                COPY ELCVADS.
  1777******************************************************************
  1778*                                                                *
  1779*                                                                *
  1780*                            ELCVADS.                            *
  1781*                                                                *
  1782*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1783*   ELVADS                  LENGTH = 350                         *
  1784******************************************************************
  1785******************************************************************
  1786*                   C H A N G E   L O G
  1787*
  1788* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1789*-----------------------------------------------------------------
  1790*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1791* EFFECTIVE    NUMBER
  1792*-----------------------------------------------------------------
  1793* 100111    2011022800001  AJRA  NAPERSOFT
  1794******************************************************************
  1795
  1796 01  VIRGINIA-DISCLOSURE.
  1797     12  VD-COMPANY-CD              PIC X.
  1798     12  VD-CARRIER                 PIC X.
  1799     12  VD-GROUPING.
  1800         20  VD-GROUPING-PREFIX     PIC XXX.
  1801         20  VD-GROUPING-PRIME      PIC XXX.
  1802     12  VD-STATE                   PIC XX.
  1803     12  VD-ACCOUNT.
  1804         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1805         20  VD-ACCOUNT-PRIME       PIC X(6).
  1806     12  VD-CERT-EFF-DT             PIC XX.
  1807     12  VD-CERT-NO.
  1808         20  VD-CERT-PRIME          PIC X(10).
  1809         20  VD-CERT-SFX            PIC X.
  1810     12  VD-ENTRY-BATCH             PIC X(6).
  1811     12  VD-CSR-ID                  PIC X(4).
  1812     12  VD-NAME.
  1813         20  VD-INSURED-LAST-NAME   PIC X(15).
  1814         20  VD-INSURED-FIRST-NAME.
  1815             24  VD-INSURED-1ST-INIT PIC X.
  1816             24  FILLER             PIC X(9).
  1817         20  VD-INSURED-MIDDLE-INIT PIC X.
  1818     12  VD-JOINT-INSURED.
  1819         20 VD-JOINT-LAST-NAME      PIC X(15).
  1820         20 VD-JOINT-FIRST-NAME.
  1821            24  VD-JOINT-FIRST-INIT PIC X.
  1822            24  FILLER              PIC X(9).
  1823         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1824     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1825     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1826     12  VD-INSURED-CITY-STATE.
  1827         20  VD-INSURED-CITY        PIC X(28).
  1828         20  VD-INSURED-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  35
* EL6311.cbl
  1829     12  VD-INSURED-ZIP-CODE.
  1830         20  VD-INSURED-ZIP-PRIME.
  1831             24  VD-INSURED-ZIP-1   PIC X.
  1832                 88  VD-CANADIAN-POST-CODE
  1833                                       VALUE 'A' THRU 'Z'.
  1834             24  FILLER             PIC X(4).
  1835         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1836     12  VD-BENEFICIARY-NAME        PIC X(30).
  1837     12  VD-ACCOUNT-NAME            PIC X(30).
  1838     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1839     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1840     12  VD-1ST-PMT-DT              PIC XX.
  1841     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1842         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1843         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1844                                             '90' THRU '99'.
  1845     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1846                                    PIC XX.
  1847     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1848     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1849     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1850     12  VD-LF-TERM                 PIC S999   COMP-3.
  1851     12  VD-AH-BENEFIT-CD           PIC XX.
  1852         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1853         88  VD-INVALID-AH             VALUE '  ' '00'
  1854                                             '90' THRU '99'.
  1855     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1856     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1857     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1858     12  VD-AH-TERM                 PIC S999   COMP-3.
  1859     12  VD-LETTER-ID               PIC X(4).
  1860     12  VD-PROC-ID                 PIC X(4).
  1861     12  VD-COMP-ID                 PIC X(3).
  1862     12  VD-CURRENT-DATE            PIC XX.
  1863     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1864     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1865     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  36
* EL6311.cbl
  1867*    COPY ELCDATE.
  1868******************************************************************
  1869*                                                                *
  1870*                                                                *
  1871*                            ELCDATE.                            *
  1872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1873*                            VMOD=2.003
  1874*                                                                *
  1875*                                                                *
  1876*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1877*                 LENGTH = 200                                   *
  1878******************************************************************
  1879
  1880 01  DATE-CONVERSION-DATA.
  1881     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1882     12  DC-OPTION-CODE                PIC X.
  1883         88  BIN-TO-GREG                VALUE ' '.
  1884         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1885         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1886         88  YMD-GREG-TO-BIN            VALUE '3'.
  1887         88  MDY-GREG-TO-BIN            VALUE '4'.
  1888         88  JULIAN-TO-BIN              VALUE '5'.
  1889         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1890         88  FIND-CENTURY               VALUE '7'.
  1891         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1892         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1893         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1894         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1895         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1896         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1897         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1898         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1899         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1900         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1901         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1902         88  BIN-3-TO-GREG              VALUE 'I'.
  1903         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1904         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1905         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1906         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1907         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1908         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1909         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1910         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1911         88  THREE-CHARACTER-BIN
  1912                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1913         88  GREGORIAN-TO-BIN
  1914                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1915         88  BIN-TO-GREGORIAN
  1916                  VALUES ' ' '1' 'I' '8' 'G'.
  1917         88  JULIAN-TO-BINARY
  1918                  VALUES '5' 'C' 'E' 'F'.
  1919     12  DC-ERROR-CODE                 PIC X.
  1920         88  NO-CONVERSION-ERROR        VALUE ' '.
  1921         88  DATE-CONVERSION-ERROR
  1922                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1923         88  DATE-IS-ZERO               VALUE '1'.
  1924         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  37
* EL6311.cbl
  1925         88  DATE-IS-INVALID            VALUE '3'.
  1926         88  DATE1-GREATER-DATE2        VALUE '4'.
  1927         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1928         88  DATE-INVALID-OPTION        VALUE '9'.
  1929         88  INVALID-CENTURY            VALUE 'A'.
  1930         88  ONLY-CENTURY               VALUE 'B'.
  1931         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1932         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1933     12  DC-END-OF-MONTH               PIC X.
  1934         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1935     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1936         88  USE-NORMAL-PROCESS         VALUE ' '.
  1937         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1938         88  ADJUST-UP-100-YRS          VALUE '2'.
  1939     12  FILLER                        PIC X.
  1940     12  DC-CONVERSION-DATES.
  1941         16  DC-BIN-DATE-1             PIC XX.
  1942         16  DC-BIN-DATE-2             PIC XX.
  1943         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1944         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1945                       DC-GREG-DATE-1-EDIT.
  1946             20  DC-EDIT1-MONTH        PIC 99.
  1947             20  SLASH1-1              PIC X.
  1948             20  DC-EDIT1-DAY          PIC 99.
  1949             20  SLASH1-2              PIC X.
  1950             20  DC-EDIT1-YEAR         PIC 99.
  1951         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1952         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1953                     DC-GREG-DATE-2-EDIT.
  1954             20  DC-EDIT2-MONTH        PIC 99.
  1955             20  SLASH2-1              PIC X.
  1956             20  DC-EDIT2-DAY          PIC 99.
  1957             20  SLASH2-2              PIC X.
  1958             20  DC-EDIT2-YEAR         PIC 99.
  1959         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1960         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1961                     DC-GREG-DATE-1-YMD.
  1962             20  DC-YMD-YEAR           PIC 99.
  1963             20  DC-YMD-MONTH          PIC 99.
  1964             20  DC-YMD-DAY            PIC 99.
  1965         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1966         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1967                      DC-GREG-DATE-1-MDY.
  1968             20  DC-MDY-MONTH          PIC 99.
  1969             20  DC-MDY-DAY            PIC 99.
  1970             20  DC-MDY-YEAR           PIC 99.
  1971         16  DC-GREG-DATE-1-ALPHA.
  1972             20  DC-ALPHA-MONTH        PIC X(10).
  1973             20  DC-ALPHA-DAY          PIC 99.
  1974             20  FILLER                PIC XX.
  1975             20  DC-ALPHA-CENTURY.
  1976                 24 DC-ALPHA-CEN-N     PIC 99.
  1977             20  DC-ALPHA-YEAR         PIC 99.
  1978         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1979         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1980         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1981         16  DC-JULIAN-DATE            PIC 9(05).
  1982         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  38
* EL6311.cbl
  1983                                       PIC 9(05).
  1984         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1985             20  DC-JULIAN-YEAR        PIC 99.
  1986             20  DC-JULIAN-DAYS        PIC 999.
  1987         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1988         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1989         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1990     12  DATE-CONVERSION-VARIBLES.
  1991         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1992         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1993             20  FILLER                PIC 9(3).
  1994             20  HOLD-CEN-1-CCYY.
  1995                 24  HOLD-CEN-1-CC     PIC 99.
  1996                 24  HOLD-CEN-1-YY     PIC 99.
  1997             20  HOLD-CEN-1-MO         PIC 99.
  1998             20  HOLD-CEN-1-DA         PIC 99.
  1999         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2000             20  HOLD-CEN-1-R-MO       PIC 99.
  2001             20  HOLD-CEN-1-R-DA       PIC 99.
  2002             20  HOLD-CEN-1-R-CCYY.
  2003                 24  HOLD-CEN-1-R-CC   PIC 99.
  2004                 24  HOLD-CEN-1-R-YY   PIC 99.
  2005             20  FILLER                PIC 9(3).
  2006         16  HOLD-CENTURY-1-X.
  2007             20  FILLER                PIC X(3)  VALUE SPACES.
  2008             20  HOLD-CEN-1-X-CCYY.
  2009                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2010                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2011             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2012             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2013         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2014             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2015             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2016             20  HOLD-CEN-1-R-X-CCYY.
  2017                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2018                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2019             20  FILLER                PIC XXX.
  2020         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2021         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2022         16  DC-JULIAN-DATE-1          PIC 9(07).
  2023         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2024             20  DC-JULIAN-1-CCYY.
  2025                 24  DC-JULIAN-1-CC    PIC 99.
  2026                 24  DC-JULIAN-1-YR    PIC 99.
  2027             20  DC-JULIAN-DA-1        PIC 999.
  2028         16  DC-JULIAN-DATE-2          PIC 9(07).
  2029         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2030             20  DC-JULIAN-2-CCYY.
  2031                 24  DC-JULIAN-2-CC    PIC 99.
  2032                 24  DC-JULIAN-2-YR    PIC 99.
  2033             20  DC-JULIAN-DA-2        PIC 999.
  2034         16  DC-GREG-DATE-A-EDIT.
  2035             20  DC-EDITA-MONTH        PIC 99.
  2036             20  SLASHA-1              PIC X VALUE '/'.
  2037             20  DC-EDITA-DAY          PIC 99.
  2038             20  SLASHA-2              PIC X VALUE '/'.
  2039             20  DC-EDITA-CCYY.
  2040                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  39
* EL6311.cbl
  2041                 24  DC-EDITA-YEAR     PIC 99.
  2042         16  DC-GREG-DATE-B-EDIT.
  2043             20  DC-EDITB-MONTH        PIC 99.
  2044             20  SLASHB-1              PIC X VALUE '/'.
  2045             20  DC-EDITB-DAY          PIC 99.
  2046             20  SLASHB-2              PIC X VALUE '/'.
  2047             20  DC-EDITB-CCYY.
  2048                 24  DC-EDITB-CENT     PIC 99.
  2049                 24  DC-EDITB-YEAR     PIC 99.
  2050         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2051         16  DC-GREG-DATE-CYMD-R REDEFINES
  2052                              DC-GREG-DATE-CYMD.
  2053             20  DC-CYMD-CEN           PIC 99.
  2054             20  DC-CYMD-YEAR          PIC 99.
  2055             20  DC-CYMD-MONTH         PIC 99.
  2056             20  DC-CYMD-DAY           PIC 99.
  2057         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2058         16  DC-GREG-DATE-MDCY-R REDEFINES
  2059                              DC-GREG-DATE-MDCY.
  2060             20  DC-MDCY-MONTH         PIC 99.
  2061             20  DC-MDCY-DAY           PIC 99.
  2062             20  DC-MDCY-CEN           PIC 99.
  2063             20  DC-MDCY-YEAR          PIC 99.
  2064    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2065        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2066    12  DC-EL310-DATE                  PIC X(21).
  2067    12  FILLER                         PIC X(28).
  2068
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  40
* EL6311.cbl
  2070*    COPY ELCLOGOF.
  2071******************************************************************
  2072*                                                                *
  2073*                                                                *
  2074*                            ELCLOGOF.                           *
  2075*                            VMOD=2.001                          *
  2076*                                                                *
  2077*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2078*                                                                *
  2079******************************************************************
  2080 01  CLASIC-LOGOFF.
  2081     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2082     12  LOGOFF-TEXT.
  2083         16  FILLER          PIC X(5)    VALUE SPACES.
  2084         16  LOGOFF-MSG.
  2085             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2086             20  FILLER      PIC X       VALUE SPACES.
  2087             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2088         16  FILLER          PIC X(80)
  2089           VALUE '* YOU ARE NOW LOGGED OFF'.
  2090         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2091         16  FILLER          PIC X       VALUE QUOTE.
  2092         16  LOGOFF-SYS-MSG  PIC X(17)
  2093           VALUE 'S CLAS-IC SYSTEM '.
  2094     12  TEXT-MESSAGES.
  2095         16  UNACCESS-MSG    PIC X(29)
  2096             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2097         16  PGMIDERR-MSG    PIC X(17)
  2098             VALUE 'PROGRAM NOT FOUND'.
  2099
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  41
* EL6311.cbl
  2101*    COPY ELCATTR.
  2102******************************************************************
  2103*                                                                *
  2104*                            ELCATTR.                            *
  2105*                            VMOD=2.001                          *
  2106*                                                                *
  2107*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2108*                                                                *
  2109*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2110*                                                                *
  2111*                   POS 1   P=PROTECTED                          *
  2112*                           U=UNPROTECTED                        *
  2113*                           S=ASKIP                              *
  2114*                   POS 2   A=ALPHA/NUMERIC                      *
  2115*                           N=NUMERIC                            *
  2116*                   POS 3   N=NORMAL                             *
  2117*                           B=BRIGHT                             *
  2118*                           D=DARK                               *
  2119*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2120*                           OF=MODIFIED DATA TAG OFF             *
  2121*                                                                *
  2122*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2123******************************************************************
  2124 01  ATTRIBUTE-LIST.
  2125     12  AL-PABOF            PIC X       VALUE 'Y'.
  2126     12  AL-PABON            PIC X       VALUE 'Z'.
  2127     12  AL-PADOF            PIC X       VALUE '%'.
  2128     12  AL-PADON            PIC X       VALUE '_'.
  2129     12  AL-PANOF            PIC X       VALUE '-'.
  2130     12  AL-PANON            PIC X       VALUE '/'.
  2131     12  AL-SABOF            PIC X       VALUE '8'.
  2132     12  AL-SABON            PIC X       VALUE '9'.
  2133     12  AL-SADOF            PIC X       VALUE '@'.
  2134     12  AL-SADON            PIC X       VALUE QUOTE.
  2135     12  AL-SANOF            PIC X       VALUE '0'.
  2136     12  AL-SANON            PIC X       VALUE '1'.
  2137     12  AL-UABOF            PIC X       VALUE 'H'.
  2138     12  AL-UABON            PIC X       VALUE 'I'.
  2139     12  AL-UADOF            PIC X       VALUE '<'.
  2140     12  AL-UADON            PIC X       VALUE '('.
  2141     12  AL-UANOF            PIC X       VALUE ' '.
  2142     12  AL-UANON            PIC X       VALUE 'A'.
  2143     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2144     12  AL-UNBON            PIC X       VALUE 'R'.
  2145     12  AL-UNDOF            PIC X       VALUE '*'.
  2146     12  AL-UNDON            PIC X       VALUE ')'.
  2147     12  AL-UNNOF            PIC X       VALUE '&'.
  2148     12  AL-UNNON            PIC X       VALUE 'J'.
  2149
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  42
* EL6311.cbl
  2151*    COPY ELCEMIB.
  2152******************************************************************
  2153*                                                                *
  2154*                                                                *
  2155*                            ELCEMIB.                            *
  2156*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2157*                            VMOD=2.005                          *
  2158*                                                                *
  2159*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2160*                                                                *
  2161******************************************************************
  2162 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2163     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2164     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2165     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2166     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2167     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2168     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2169     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2170     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2171     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2172         88  EMI-NO-ERRORS                    VALUE '1'.
  2173         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2174         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2175     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2176         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2177     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2178         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2179         88  EMI-AREA1-FULL                   VALUE '2'.
  2180     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2181         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2182         88  EMI-AREA2-FULL                   VALUE '2'.
  2183     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2184         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2185         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2186         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2187         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2188         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2189     12  EMI-ERROR-LINES.
  2190         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2191         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2192         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2193         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2194             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2195                 24  EMI-ERR-NUM         PIC X(4).
  2196                 24  EMI-FILLER          PIC X.
  2197                 24  EMI-SEV             PIC X.
  2198                 24  FILLER              PIC X.
  2199             20  FILLER                  PIC X(02).
  2200     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2201         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2202             20  EMI-ERROR-NUMBER    PIC X(4).
  2203             20  EMI-FILL            PIC X.
  2204             20  EMI-SEVERITY        PIC X.
  2205             20  FILLER              PIC X.
  2206             20  EMI-ERROR-TEXT.
  2207                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2208                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  43
* EL6311.cbl
  2209     12  EMI-SEVERITY-SAVE           PIC X.
  2210         88  EMI-NOTE                    VALUE 'N'.
  2211         88  EMI-WARNING                 VALUE 'W'.
  2212         88  EMI-FORCABLE                VALUE 'F'.
  2213         88  EMI-FATAL                   VALUE 'X'.
  2214     12  EMI-MESSAGE-FLAG            PIC X.
  2215         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2216         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2217     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2218     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2219         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2220         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2221         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2222     12  emi-claim-no                pic x(7).
  2223     12  emi-claim-type              pic x(6).
  2224     12  FILLER                      PIC X(124)  VALUE SPACES.
  2225     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2226     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2227     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2228     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2229
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  44
* EL6311.cbl
  2231*    COPY ELCINTF.
  2232******************************************************************
  2233*                                                                *
  2234*                                                                *
  2235*                            ELCINTF.                            *
  2236*                            VMOD=2.017                          *
  2237*                                                                *
  2238*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2239*                                                                *
  2240*       LENGTH = 1024                                            *
  2241*                                                                *
  2242******************************************************************
  2243*                   C H A N G E   L O G
  2244*
  2245* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2246*-----------------------------------------------------------------
  2247*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2248* EFFECTIVE    NUMBER
  2249*-----------------------------------------------------------------
  2250* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2251******************************************************************
  2252 01  PROGRAM-INTERFACE-BLOCK.
  2253     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2254     12  PI-CALLING-PROGRAM              PIC X(8).
  2255     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2256     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2257     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2258     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2259     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2260     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2261     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2262     12  PI-COMPANY-ID                   PIC XXX.
  2263     12  PI-COMPANY-CD                   PIC X.
  2264
  2265     12  PI-COMPANY-PASSWORD             PIC X(8).
  2266
  2267     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2268
  2269     12  PI-CONTROL-IN-PROGRESS.
  2270         16  PI-CARRIER                  PIC X.
  2271         16  PI-GROUPING                 PIC X(6).
  2272         16  PI-STATE                    PIC XX.
  2273         16  PI-ACCOUNT                  PIC X(10).
  2274         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2275                                         PIC X(10).
  2276         16  PI-CLAIM-CERT-GRP.
  2277             20  PI-CLAIM-NO             PIC X(7).
  2278             20  PI-CERT-NO.
  2279                 25  PI-CERT-PRIME       PIC X(10).
  2280                 25  PI-CERT-SFX         PIC X.
  2281             20  PI-CERT-EFF-DT          PIC XX.
  2282         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2283             20  PI-PLAN-CODE            PIC X(2).
  2284             20  PI-REVISION-NUMBER      PIC X(3).
  2285             20  PI-PLAN-EFF-DT          PIC X(2).
  2286             20  PI-PLAN-EXP-DT          PIC X(2).
  2287             20  FILLER                  PIC X(11).
  2288         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  45
* EL6311.cbl
  2289             20  PI-OE-REFERENCE-1.
  2290                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2291                 25  PI-OE-REF-1-SUFF    PIC XX.
  2292
  2293     12  PI-SESSION-IN-PROGRESS          PIC X.
  2294         88  CLAIM-SESSION                   VALUE '1'.
  2295         88  CREDIT-SESSION                  VALUE '2'.
  2296         88  WARRANTY-SESSION                VALUE '3'.
  2297         88  MORTGAGE-SESSION                VALUE '4'.
  2298         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2299
  2300
  2301*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2302
  2303     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2304     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2305
  2306     12  PI-CREDIT-USER                  PIC X.
  2307         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2308         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2309
  2310     12  PI-CLAIM-USER                   PIC X.
  2311         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2312         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2313
  2314     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2315         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2316         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2317         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2318         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2319         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2320
  2321     12  PI-PROCESSOR-ID                 PIC X(4).
  2322
  2323     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2324
  2325     12  PI-MEMBER-CAPTION               PIC X(10).
  2326
  2327     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2328         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2329
  2330     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2331     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2332     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2333     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2334
  2335     12  PI-AH-OVERRIDE-L1               PIC X.
  2336     12  PI-AH-OVERRIDE-L2               PIC XX.
  2337     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2338     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2339
  2340     12  PI-NEW-SYSTEM                   PIC X(2).
  2341
  2342     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2343     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2344         88  PI-USES-PAID-TO                 VALUE '1'.
  2345     12  PI-CRDTCRD-SYSTEM.
  2346         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  46
* EL6311.cbl
  2347             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2348             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2349         16  PI-CC-MONTH-END-DT          PIC XX.
  2350     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2351
  2352     12  PI-OE-REFERENCE-2.
  2353         16  PI-OE-REF-2-PRIME           PIC X(10).
  2354         16  PI-OE-REF-2-SUFF            PIC X.
  2355
  2356     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2357
  2358     12  PI-LANGUAGE-TYPE                PIC X.
  2359             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2360             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2361             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2362
  2363     12  PI-POLICY-LINKAGE-IND           PIC X.
  2364         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2365         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2366                                                   LOW-VALUES.
  2367
  2368     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2369     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2370         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2371         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2372
  2373     12  PI-PROCESSOR-CSR-IND            PIC X.
  2374         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2375         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2376
  2377     12  FILLER                          PIC X(3).
  2378
  2379     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2380
  2381     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2382         PI-SYSTEM-LEVEL.
  2383
  2384         16  PI-ENTRY-CODES.
  2385             20  PI-ENTRY-CD-1           PIC X.
  2386             20  PI-ENTRY-CD-2           PIC X.
  2387
  2388         16  PI-RETURN-CODES.
  2389             20  PI-RETURN-CD-1          PIC X.
  2390             20  PI-RETURN-CD-2          PIC X.
  2391
  2392         16  PI-UPDATE-STATUS-SAVE.
  2393             20  PI-UPDATE-BY            PIC X(4).
  2394             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2395
  2396         16  PI-LOWER-CASE-LETTERS       PIC X.
  2397             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2398
  2399*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2400*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2401*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2402
  2403         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2404             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  47
* EL6311.cbl
  2405             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2406             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2407             88  ACCNT-CNTL                  VALUE '3'.
  2408             88  CARR-ACCNT-CNTL             VALUE '4'.
  2409
  2410         16  PI-PROCESSOR-CAP-LIST.
  2411             20  PI-SYSTEM-CONTROLS.
  2412                24 PI-SYSTEM-DISPLAY     PIC X.
  2413                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2414                24 PI-SYSTEM-MODIFY      PIC X.
  2415                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2416             20  FILLER                  PIC XX.
  2417             20  PI-DISPLAY-CAP          PIC X.
  2418                 88  DISPLAY-CAP             VALUE 'Y'.
  2419             20  PI-MODIFY-CAP           PIC X.
  2420                 88  MODIFY-CAP              VALUE 'Y'.
  2421             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2422                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2423             20  PI-FORCE-CAP            PIC X.
  2424                 88  FORCE-CAP               VALUE 'Y'.
  2425
  2426         16  PI-PROGRAM-CONTROLS.
  2427             20  PI-PGM-PRINT-OPT        PIC X.
  2428             20  PI-PGM-FORMAT-OPT       PIC X.
  2429             20  PI-PGM-PROCESS-OPT      PIC X.
  2430             20  PI-PGM-TOTALS-OPT       PIC X.
  2431
  2432         16  PI-HELP-INTERFACE.
  2433             20  PI-LAST-ERROR-NO        PIC X(4).
  2434             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2435
  2436         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2437             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2438
  2439         16  PI-CR-CONTROL-IN-PROGRESS.
  2440             20  PI-CR-CARRIER           PIC X.
  2441             20  PI-CR-GROUPING          PIC X(6).
  2442             20  PI-CR-STATE             PIC XX.
  2443             20  PI-CR-ACCOUNT           PIC X(10).
  2444             20  PI-CR-FIN-RESP          PIC X(10).
  2445             20  PI-CR-TYPE              PIC X.
  2446
  2447         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2448
  2449         16  PI-CR-MONTH-END-DT          PIC XX.
  2450
  2451         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2452             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2453             88  PI-ZERO-CARRIER             VALUE '1'.
  2454             88  PI-ZERO-GROUPING            VALUE '2'.
  2455             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2456
  2457         16  PI-CARRIER-SECURITY         PIC X.
  2458             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2459
  2460         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2461             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2462             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  48
* EL6311.cbl
  2463
  2464         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2465             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2466                                         INDEXED BY PI-ACCESS-NDX
  2467                                         PIC X.
  2468
  2469         16  PI-GA-BILLING-CONTROL       PIC X.
  2470             88  PI-GA-BILLING               VALUE '1'.
  2471
  2472         16  PI-MAIL-PROCESSING          PIC X.
  2473             88  PI-MAIL-YES                 VALUE 'Y'.
  2474
  2475         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2476
  2477         16  PI-AR-SYSTEM.
  2478             20  PI-AR-PROCESSING-CNTL   PIC X.
  2479                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2480             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2481             20  PI-AR-MONTH-END-DT      PIC XX.
  2482
  2483         16  PI-MP-SYSTEM.
  2484             20  PI-MORTGAGE-USER            PIC X.
  2485                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2486                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2487             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2488                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2489                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2490                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2491                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2492                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2493             20  PI-MP-MONTH-END-DT          PIC XX.
  2494             20  PI-MP-REFERENCE-NO.
  2495                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2496                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2497
  2498         16  PI-LABEL-CONTROL            PIC X(01).
  2499             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2500             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2501
  2502         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2503             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2504
  2505         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2506             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2507             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2508
  2509         16  FILLER                      PIC X(14).
  2510
  2511     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2512******************************************************************
  2513
  2514     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2515*    COPY ELC631PI.
  2516******************************************************************
  2517*                                                                *
  2518*                                                                *
  2519*                            ELC631PI                            *
  2520*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  49
* EL6311.cbl
  2521*                                                                *
  2522*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2523*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2524*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2525*                                                                *
  2526*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2527*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2528*    BETWEEN PROGRAMS.                                           *
  2529*                                                                *
  2530*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2531*                                                                *
  2532*               EL631 - EL6311 - EL6312 - EL6313                 *
  2533*                                                                *
  2534******************************************************************
  2535*                   C H A N G E   L O G
  2536*
  2537* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2538*-----------------------------------------------------------------
  2539*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2540* EFFECTIVE    NUMBER
  2541*-----------------------------------------------------------------
  2542* 021414    2003053000001  PEMA  changes for auto chk request
  2543******************************************************************
  2544
  2545         16  PI-631-DATA.
  2546             20  PI-ERPNDB-KEY.
  2547                 24  PI-PB-COMPANY-CD     PIC X.
  2548                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2549                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2550                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2551
  2552             20  PI-ERPNDB-ALT-KEY.
  2553                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2554                 24  PI-PB-CARRIER        PIC X.
  2555                 24  PI-PB-GROUPING       PIC X(6).
  2556                 24  PI-PB-STATE          PIC XX.
  2557                 24  PI-PB-ACCOUNT        PIC X(10).
  2558                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2559                 24  PI-PB-CERT-NO.
  2560                     28  PI-PB-CERT-PRIME PIC X(10).
  2561                     28  PI-PB-CERT-SFX   PIC X.
  2562                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2563                 24  PI-PB-RECORD-TYPE    PIC X.
  2564
  2565             20  PI-ERPNDB-CSR-KEY.
  2566                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2567                 24  PI-PB-CSR-ID             PIC X(4).
  2568                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2569                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2570                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2571
  2572             20  PI-BROWSE-TYPE               PIC X.
  2573                 88  PI-FILE-BROWSE             VALUE ' '.
  2574                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2575                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2576                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2577                 88  PI-CSR-BROWSE              VALUE '4'.
  2578
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  50
* EL6311.cbl
  2579             20  PI-MAINT-FUNCTION            PIC X.
  2580                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2581                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2582                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2583                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2584                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2585                 88  PI-PF5-FUNCTION            VALUE '5'.
  2586                 88  PI-PF6-FUNCTION            VALUE '6'.
  2587
  2588             20  PI-FILE-SWITCHES.
  2589                 24  PI-ALL-ISSUES-SW         PIC X.
  2590                     88  ALL-ISSUES             VALUE 'Y'.
  2591                 24  PI-ALL-CANCELS-SW        PIC X.
  2592                     88  ALL-CANCELS            VALUE 'Y'.
  2593                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2594                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2595                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2596                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2597                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2598                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2599                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2600                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2601                 24  PI-HOLD-REC-SW           PIC X.
  2602                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2603                 24  PI-CHANGE-REC-SW         PIC X.
  2604                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2605                 24  PI-CHK-REQ-REC-SW        PIC X.
  2606                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2607                 24  PI-ISSUE-WARNING-SW      PIC X.
  2608                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2609                 24  PI-CANCEL-WARNING-SW     PIC X.
  2610                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2611             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2612                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2613             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2614                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2615
  2616             20  PI-MAP-NAME                  PIC X(8).
  2617
  2618             20  PI-CURSOR                    PIC S9(4) COMP.
  2619
  2620             20  PI-PREV-ALT-KEY              PIC X(36).
  2621             20  PI-PREV-CSR-KEY              PIC X(15).
  2622             20  PI-PREV-KEY.
  2623                 24  PI-PREV-COMPANY-CD       PIC X.
  2624                 24  PI-PREV-BATCH            PIC X(6).
  2625                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2626                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2627             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2628             20  PI-BROWSE-SW                 PIC X.
  2629                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2630                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2631             20  PI-SV-CARRIER                PIC X.
  2632             20  PI-SV-GROUPING               PIC X(6).
  2633             20  PI-SV-STATE                  PIC XX.
  2634             20  PI-EDIT-SW                   PIC X.
  2635             20  PI-DISPLAY-SW                PIC XX.
  2636                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  51
* EL6311.cbl
  2637                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2638             20  PI-CRITERIA-DATA             PIC X(350).
  2639             20  PI-BMODE                     PIC X.
  2640             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2641             20  PI-BPMTS                     PIC S999     COMP-3.
  2642             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2643             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2644             20  PI-CSR-SESSION-SW            PIC X.
  2645                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2646             20  PI-ERRORS-SW                 PIC X.
  2647                 88  FATAL-ERRORS               VALUE 'X'.
  2648*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2649             20  pi-unforced-sw               pic x.
  2650                 88  unforced-errors            value 'X'.
  2651             20  FILLER                       PIC X(4).
  2652
  2653        16  FILLER             PIC X(94).
  2654
  2655 01  W-LETTER-COMMUNICATION-AREAS.
  2656*    COPY ELC1042.
  2657******************************************************************
  2658*                                                                *
  2659*                                                                *
  2660*                           ELC1042                              *
  2661*                            VMOD=2.002                          *
  2662*                                                                *
  2663*    NOTE                                                        *
  2664*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2665*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2666*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2667*        TO THESE PROGRAMS.                                      *
  2668*                                                                *
  2669*    NOTE                                                        *
  2670*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2671*        USE ONLY!                                               *
  2672*                                                                *
  2673******************************************************************
  2674
  2675         16  PI-1042-WA.
  2676             20  PI-ACTION       PIC  X(01).
  2677                 88 PI-SHOW-MODE           VALUE '1'.
  2678                 88 PI-CLEAR-MODE          VALUE '2'.
  2679                 88 PI-CREATE-MODE         VALUE '3'.
  2680             20  PI-COMM-CONTROL PIC  X(12).
  2681             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2682             20  PI-EOF-SW       PIC  X(01).
  2683                 88  PI-FILE-EOF           VALUE 'Y'.
  2684             20  PI-FILETYP      PIC  X(01).
  2685             20  PI-FORM-SQUEEZE-CONTROL
  2686                                 PIC  X(01).
  2687                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2688                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2689             20  PI-LAST-CONTROL PIC  X(12).
  2690             20  PI-TEMP-STOR-ITEMS
  2691                                 PIC S9(04) COMP.
  2692             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2693             20  PI-UPDATE-SW    PIC  9(01).
  2694                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  52
* EL6311.cbl
  2695             20  PI-104-SCREEN-SENT-IND
  2696                                 PIC  X(01).
  2697                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2698                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2699             20  PI-1042-SCREEN-SENT-IND
  2700                                 PIC  X(01).
  2701                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2702                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2703             20  PI-1042-ARCHIVE-IND
  2704                                 PIC  X(01).
  2705                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2706             20  FILLER          PIC  X(29).
  2707*    COPY ELC689PI.
  2708******************************************************************
  2709*                                                                *
  2710*                            ELC689PI                            *
  2711*                            VMOD=2.003                          *
  2712*                                                                *
  2713*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2714*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2715*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2716*                                                                *
  2717*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2718*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2719*    BETWEEN PROGRAMS.                                           *
  2720*                                                                *
  2721*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2722*                                                                *
  2723*               EL631 - EL689  - EL6891 - EL6892                 *
  2724*                                                                *
  2725******************************************************************
  2726*                   C H A N G E   L O G
  2727*
  2728* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2729*-----------------------------------------------------------------
  2730*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2731* EFFECTIVE    NUMBER
  2732*-----------------------------------------------------------------
  2733* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2734* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2735* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2736******************************************************************
  2737
  2738
  2739         16  PI-689-WORK-AREA.
  2740             20  PI-689-ALT-PRINTER-ID
  2741                                 PIC  X(04).
  2742             20  PI-689-ARCHIVE-NUMBER
  2743                                 PIC  9(08).
  2744             20  PI-689-ARCHIVE-SW
  2745                                 PIC  X(01).
  2746                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2747             20  PI-689-DATA-SOURCE
  2748                                 PIC  X(01).
  2749                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2750                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2751                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2752                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  53
* EL6311.cbl
  2753                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2754             20  PI-689-ERROR-IND
  2755                                 PIC  X(01).
  2756                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2757             20  PI-689-ERROR    PIC  9(04).
  2758                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2759                 88  PI-689-FATAL-ERROR
  2760                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2761                            0042 0047 0051 0066 0067 0070
  2762                            0168 0169 0174 0175 0176 0177 0179
  2763                            0180 0181 0182 0184 0185 0189 0190
  2764                            0191
  2765                            0215 0279 0280
  2766                            0412 0413 0454
  2767                            0533 0537
  2768                            2055 2114 2208 2209 2216 2232 2369
  2769                            2398 2433 2908 2999
  2770                            3000 3770 3771 3775
  2771                            7250 7365 7367 7368 7369 7370 7371
  2772                            7272 7373 7374 7376 7377 7378 7379
  2773                            7381 7388 7390 7393 7395 7396 7398
  2774                            9095 9096 9281 9298 9299 9320 9327
  2775                            9426 9427.
  2776                 88  PI-689-STOP-ERROR
  2777                     VALUES 0004 0008 0013 0023 0029 0033
  2778                            0042 0047 0066 0067 0070
  2779                            0168 0169 0174 0175 0176 0177
  2780                            0181 0182 0184 0185 0189 0190
  2781                            0279 0280
  2782                            0412 0413 0454
  2783                            2055 2208 2209 2216 2232
  2784                            2398 2999
  2785                            3000 3770 3771 3775
  2786                            7250 7365 7369 7370 7371
  2787                            7272 7373 7374 7376 7377 7378 7379
  2788                            7381 7388 7390 7393 7396 7398
  2789                            9095 9096 9299 9320 9426.
  2790             20  PI-689-FOLLOW-UP-DATE
  2791                                 PIC  X(02).
  2792             20  PI-689-FORM-NUMBER
  2793                                 PIC  X(04).
  2794             20  PI-689-LABEL-SOURCE
  2795                                 PIC X(01).
  2796                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2797                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2798                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2799                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2800                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2801                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2802                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2803             20  PI-689-NUMBER-COPIES
  2804                                 PIC  9(01).
  2805             20  PI-689-NUMBER-LABEL-LINES
  2806                                 PIC  9(01).
  2807             20  PI-689-NUMBER-TEXT-RECORDS
  2808                                 PIC  9(03).
  2809             20  PI-689-PRINT-ORDER-SW
  2810                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  54
* EL6311.cbl
  2811                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2812                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2813                 88  PI-689-PRINT-LATER     VALUE '3'.
  2814                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2815             20  PI-689-PRINT-RESTRICTION
  2816                                 PIC  X(01).
  2817                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2818                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2819                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2820             20  PI-689-PRINT-SW PIC  X(01).
  2821                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2822             20  PI-689-RESEND-DATE-1
  2823                                 PIC  X(02).
  2824             20  PI-689-RESEND-LETR-1
  2825                                 PIC X(4).
  2826             20  PI-689-TEMP-STOR-ID
  2827                                 PIC  X(08).
  2828             20  PI-689-USE-SCREEN-IND
  2829                                 PIC  X(01).
  2830                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2831             20  PI-689-ARCH-POINTER
  2832                                 PIC S9(08) COMP.
  2833                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2834             20  PI-689-ARCT-POINTER
  2835                                 PIC S9(08) COMP.
  2836                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2837             20  PI-689-VARIABLE-DATA-GRP.
  2838                 24  PI-689-VARIABLE-DATA-1
  2839                                 PIC  X(30).
  2840                 24  PI-689-VARIABLE-DATA-2
  2841                                 PIC  X(30).
  2842                 24  PI-689-VARIABLE-DATA-3
  2843                                 PIC  X(30).
  2844                 24  PI-689-VARIABLE-DATA-4
  2845                                 PIC  X(30).
  2846
  2847         16  PI-689-KEY-DATA-FIELDS.
  2848             20  PI-689-ACCOUNT  PIC  X(10).
  2849             20  PI-689-CARRIER  PIC  X(01).
  2850             20  PI-689-CERT-NO.
  2851                 24  PI-689-CERT-PRIME
  2852                                 PIC  X(10).
  2853                 24  PI-689-CERT-SFX
  2854                                 PIC  X(01).
  2855             20  PI-689-CHG-SEQ-NO
  2856                                 PIC S9(04)    COMP.
  2857             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2858                                 PIC  X(02).
  2859             20  PI-689-ENTRY-BATCH
  2860                                 PIC  X(06).
  2861             20  PI-689-EFF-DATE PIC  X(02).
  2862             20  PI-689-EXP-DATE PIC  X(02).
  2863             20  PI-689-GROUPING PIC  X(06).
  2864             20  PI-689-RESP-PERSON
  2865                                 PIC  X(10).
  2866             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2867             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2868                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  55
* EL6311.cbl
  2869             20  PI-689-STATE    PIC  X(02).
  2870             20  PI-689-TYPE     PIC  X(01).
  2871             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2872             20  PI-689-ALT-SEQ-NO
  2873                                 PIC S9(04)    COMP.
  2874         16  PI-689-DATE-EDIT    PIC  X(08).
  2875         16  PI-689-FOLLOW-UP-EDIT
  2876                                 PIC  X(08).
  2877         16  PI-689-RESEND1-EDIT PIC  X(08).
  2878         16  PI-689-SEQ-EDIT     PIC  X(08).
  2879         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2880         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2881             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2882         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2883         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  56
* EL6311.cbl
  2885
  2886 01  WS-EL6315-PASS-AREA.
  2887        16  PI-6315-ISS-CAN-SW      PIC X.
  2888        16  FILLER                  PIC X(120).
  2889        16  PI-RES-REF-CLM-TYPE     PIC X.
  2890        16  FILLER                  PIC X.
  2891        16  PI-6315-PASS-AREA.
  2892            20 FILLER               PIC X(236).
  2893            20 PI-6315-FINALIZED    PIC X.
  2894            20 FILLER               PIC X(280).
  2895
  2896 01  WS-EL6316-PASS-AREA.
  2897        16  PI-ISS-CAN-SW           PIC X.
  2898        16  FILLER                  PIC X(121).
  2899        16  PI-CLM-RESC-IND         PIC X.
  2900        16  PI-6316-PASS-AREA.
  2901            20 FILLER               PIC X(236).
  2902            20 PI-6316-FINALIZED    PIC X.
  2903            20 FILLER               PIC X(280).
  2904
  2905******************************************************************
  2906*                                                                *
  2907*         P A S S   A R E A   F O R   E D I T                    *
  2908*                                                                *
  2909******************************************************************
  2910
  2911 01  PASSED-RECORD.
  2912     12  RECORD-SAVE                  PIC X(585).
  2913* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2914*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2915*                    BY  WK-CURRENT-DATE.
  2916******************************************************************
  2917*                                                                *
  2918*                                                                *
  2919*                             ELC50W1                            *
  2920*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2921*                            VMOD=2.004                          *
  2922*                                                                *
  2923*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2924*                                                                *
  2925*                                                                *
  2926******************************************************************
  2927
  2928     12  WK-WORK-AREA.
  2929         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2930         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2931         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2932         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2933         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2934         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2935         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2936         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2937         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2938         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2939         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2940         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2941         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2942         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  57
* EL6311.cbl
  2943         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2944         16  WK-CREDIT-EDIT-CONTROLS.
  2945             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2946             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2947             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2948             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2949             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2950             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2951         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2952         16  WK-SAVE-REIN-DATA.
  2953             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2954             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2955             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2956         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2957             88  ENTRY-FROM-EL6311       VALUE '6'.
  2958         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2959         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2960     12  WK-RECORD-ADDRESSES.
  2961         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2962         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2963         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2964         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2965         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2966         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2967         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2968         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2969     12  WK-OVER-SHORT-AREA.
  2970         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2971         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2972         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2973             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2974         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  58
* EL6311.cbl
  2976
  2977*    COPY ELCEDITC.
  2978******************************************************************
  2979*                                                                *
  2980*                                                                *
  2981*                            ELCEDITC                            *
  2982*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2983*                            VMOD=2.012                          *
  2984*                                                                *
  2985*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2986*                     EL6313, EL050 AND EL517.                   *
  2987*                                                                *
  2988******************************************************************
  2989******************************************************************
  2990*                   C H A N G E   L O G
  2991*
  2992* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2993*-----------------------------------------------------------------
  2994*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2995* EFFECTIVE    NUMBER
  2996*-----------------------------------------------------------------
  2997* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2998******************************************************************
  2999
  3000     12  EDIT-CRITERIA-DATA.
  3001         16  EC-CO-MONTH-END-DT       PIC XX.
  3002         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3003         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3004         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3005         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3006         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3007         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3008         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3009         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3010         16  EC-CO-REM-TERM-CALC      PIC X.
  3011               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3012               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3013               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3014               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3015
  3016         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3017               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3018               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3019               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3020               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3021               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3022               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3023               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3024               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3025               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3026               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3027
  3028         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3029               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3030               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3031               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3032               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3033               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  59
* EL6311.cbl
  3034               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3035               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3036               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3037
  3038         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3039                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3040                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3041
  3042         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3043                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3044                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3045                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3046                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3047                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3048                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3049                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3050                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3051
  3052         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3053               88  EC-BR-REDUCING                   VALUE 'R'.
  3054               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3055
  3056         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3057         16  EC-BR-LF-DESC             PIC X(10).
  3058         16  EC-BR-AH-DESC             PIC X(10).
  3059         16  EC-BR-LF-COMMENT          PIC X(10).
  3060         16  EC-BR-AH-COMMENT          PIC X(10).
  3061
  3062         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3063               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3064               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3065               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3066               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3067
  3068         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3069               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3070               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3071               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3072               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3073
  3074         16  EC-BR-LF-REFUND-CALC      PIC X.
  3075                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3076                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3077                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3078                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3079                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3080                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3081                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3082
  3083         16  EC-BR-AH-REFUND-CALC      PIC X.
  3084                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3085                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3086                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3087                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3088                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3089                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3090                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3091                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  60
* EL6311.cbl
  3092
  3093         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3094                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3095                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3096                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3097
  3098         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3099                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3100                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3101                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3102
  3103         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3104         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3105         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3106         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3107
  3108         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3109         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3110                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3111                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3112                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3113                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3114
  3115         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3116               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3117               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3118               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3119               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3120               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3121
  3122         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3123               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3124               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3125               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3126               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3127               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3128
  3129         16  EC-ST-LF-REFUND-CALC      PIC X.
  3130                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3131                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3132                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3133                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3134                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3135                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3136                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3137                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3138
  3139         16  EC-ST-AH-REFUND-CALC      PIC X.
  3140                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3141                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3142                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3143                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3144                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3145                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3146                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3147                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3148
  3149         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  61
* EL6311.cbl
  3150         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3151         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3152         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3153         16  EC-AM-EXPIRATION-DT       PIC XX.
  3154         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3155         16  EC-AM-CLASS-CD            PIC XX.
  3156         16  EC-AM-LF-DEVIATION        PIC XXX.
  3157         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3158         16  EC-AM-AH-DEVIATION        PIC XXX.
  3159         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3160         16  EC-AM-PHONE-NO            PIC X(10).
  3161
  3162         16  EC-AM-LF-REFUND-CALC      PIC X.
  3163                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3164                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3165                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3166                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3167                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3168                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3169                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3170
  3171         16  EC-AM-AH-REFUND-CALC      PIC X.
  3172                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3173                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3174                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3175                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3176                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3177                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3178                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3179
  3180         16  EC-AM-BEN-I-G-CD          PIC X.
  3181                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3182                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3183                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3184
  3185         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3186         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3187         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3188         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3189         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3190         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3191         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3192         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3193         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3194
  3195         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3196         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3197         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3198         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3199         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3200         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3201         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3202         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3203         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3204         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3205         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3206         16  EC-RT-LF-NSP-ST           PIC XX.
  3207         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  62
* EL6311.cbl
  3208         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3209         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3210
  3211         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3212             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3213                                             'M' '5' '9' '2'.
  3214             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3215             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3216             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3217             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3218             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3219             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3220             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3221             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3222             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3223             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3224
  3225         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3226             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3227                                             'M' '5' '9' '2'.
  3228             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3229             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3230             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3231             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3232             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3233             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3234             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3235             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3236             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3237             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3238
  3239         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3240         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3241         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3242         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3243         16  EC-CM-DEATH-DT            PIC XX.
  3244
  3245*DMD CUSTOM CODING FIELDS BELOW
  3246*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3247         16  EC-BR-DMD-RATING-SW       PIC X.
  3248                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3249                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3250                 88  NO-DMD-RATING               VALUE 'N'.
  3251
  3252         16  EC-NEW-CERT               PIC X(11).
  3253         16  EC-NEW-STATE              PIC XX.
  3254         16  FILLER                    PIC X.
  3255*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3256         16  OVER-SHORT-EDIT-FIELDS.
  3257             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3258             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3259             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3260             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3261             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3262             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3263             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3264             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3265             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  63
* EL6311.cbl
  3266         16  FILLER                    PIC X(71).
  3267
  3268******************************************************************
  3269
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  64
* EL6311.cbl
  3271
  3272*    COPY ELCJPFX.
  3273******************************************************************
  3274*                                                                *
  3275*                                                                *
  3276*                            ELCJPFX.                            *
  3277*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3278*                            VMOD=2.002                          *
  3279*                                                                *
  3280*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3281*                                                                *
  3282*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3283*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3284*        ELCNTL - CONTROL FILE                                   *
  3285*        ELMSTR - CLAIM MASTERS                                  *
  3286*        ELTRLR - ACTIVITY TRAILERS                              *
  3287*        ELCHKQ - CHECK QUE                                      *
  3288******************************************************************
  3289 01  JOURNAL-RECORD.
  3290     12  jp-date                     pic s9(5) comp-3.
  3291     12  jp-time                     pic s9(7) comp-3.
  3292     12  JP-USER-ID                  PIC X(4).
  3293     12  JP-FILE-ID                  PIC X(8).
  3294     12  JP-PROGRAM-ID               PIC X(8).
  3295     12  JP-RECORD-TYPE              PIC X.
  3296         88 JP-ADD              VALUE 'A'.
  3297         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3298         88 JP-AFTER-CHANGE     VALUE 'C'.
  3299         88 JP-DELETE           VALUE 'D'.
  3300         88 JP-GENERIC-DELETE   VALUE 'G'.
  3301         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3302         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3303     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3304     12  JP-RECORD-AREA
  3305
  3306
  3307                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  65
* EL6311.cbl
  3309*    COPY ELCAID.
  3310******************************************************************
  3311*                                                                *
  3312*                            ELCAID.                             *
  3313*                            VMOD=2.001                          *
  3314*                                                                *
  3315*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3316*                                                                *
  3317*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3318*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3319******************************************************************
  3320
  3321 01  DFHAID.
  3322   02  DFHNULL   PIC  X  VALUE  ' '.
  3323   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3324   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3325   02  DFHPEN    PIC  X  VALUE  '='.
  3326   02  DFHOPID   PIC  X  VALUE  'W'.
  3327   02  DFHPA1    PIC  X  VALUE  '%'.
  3328   02  DFHPA2    PIC  X  VALUE  '>'.
  3329   02  DFHPA3    PIC  X  VALUE  ','.
  3330   02  DFHPF1    PIC  X  VALUE  '1'.
  3331   02  DFHPF2    PIC  X  VALUE  '2'.
  3332   02  DFHPF3    PIC  X  VALUE  '3'.
  3333   02  DFHPF4    PIC  X  VALUE  '4'.
  3334   02  DFHPF5    PIC  X  VALUE  '5'.
  3335   02  DFHPF6    PIC  X  VALUE  '6'.
  3336   02  DFHPF7    PIC  X  VALUE  '7'.
  3337   02  DFHPF8    PIC  X  VALUE  '8'.
  3338   02  DFHPF9    PIC  X  VALUE  '9'.
  3339   02  DFHPF10   PIC  X  VALUE  ':'.
  3340   02  DFHPF11   PIC  X  VALUE  '#'.
  3341   02  DFHPF12   PIC  X  VALUE  '@'.
  3342   02  DFHPF13   PIC  X  VALUE  'A'.
  3343   02  DFHPF14   PIC  X  VALUE  'B'.
  3344   02  DFHPF15   PIC  X  VALUE  'C'.
  3345   02  DFHPF16   PIC  X  VALUE  'D'.
  3346   02  DFHPF17   PIC  X  VALUE  'E'.
  3347   02  DFHPF18   PIC  X  VALUE  'F'.
  3348   02  DFHPF19   PIC  X  VALUE  'G'.
  3349   02  DFHPF20   PIC  X  VALUE  'H'.
  3350   02  DFHPF21   PIC  X  VALUE  'I'.
  3351*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3352   02  DFHPF22   PIC  X  VALUE  '['.
  3353   02  DFHPF23   PIC  X  VALUE  '.'.
  3354   02  DFHPF24   PIC  X  VALUE  '<'.
  3355   02  DFHMSRE   PIC  X  VALUE  'X'.
  3356   02  DFHSTRF   PIC  X  VALUE  'h'.
  3357   02  DFHTRIG   PIC  X  VALUE  '"'.
  3358
  3359 01  FILLER    REDEFINES DFHAID.
  3360     12  FILLER              PIC X(8).
  3361     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3362
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  66
* EL6311.cbl
  3364*    COPY EL6311S.
  3365 01  EL631BI.
  3366     05  FILLER            PIC  X(0012).
  3367*    -------------------------------
  3368     05  BDATEL PIC S9(0004) COMP.
  3369     05  BDATEF PIC  X(0001).
  3370     05  FILLER REDEFINES BDATEF.
  3371         10  BDATEA PIC  X(0001).
  3372     05  BDATEI PIC  X(0008).
  3373*    -------------------------------
  3374     05  BTIMEL PIC S9(0004) COMP.
  3375     05  BTIMEF PIC  X(0001).
  3376     05  FILLER REDEFINES BTIMEF.
  3377         10  BTIMEA PIC  X(0001).
  3378     05  BTIMEI PIC  X(0005).
  3379*    -------------------------------
  3380     05  BHEADL PIC S9(0004) COMP.
  3381     05  BHEADF PIC  X(0001).
  3382     05  FILLER REDEFINES BHEADF.
  3383         10  BHEADA PIC  X(0001).
  3384     05  BHEADI PIC  X(0038).
  3385*    -------------------------------
  3386     05  BNCERTLL PIC S9(0004) COMP.
  3387     05  BNCERTLF PIC  X(0001).
  3388     05  FILLER REDEFINES BNCERTLF.
  3389         10  BNCERTLA PIC  X(0001).
  3390     05  BNCERTLI PIC  X(0008).
  3391*    -------------------------------
  3392     05  BNCERTL PIC S9(0004) COMP.
  3393     05  BNCERTF PIC  X(0001).
  3394     05  FILLER REDEFINES BNCERTF.
  3395         10  BNCERTA PIC  X(0001).
  3396     05  BNCERTI PIC  X(0011).
  3397*    -------------------------------
  3398     05  BNSTATLL PIC S9(0004) COMP.
  3399     05  BNSTATLF PIC  X(0001).
  3400     05  FILLER REDEFINES BNSTATLF.
  3401         10  BNSTATLA PIC  X(0001).
  3402     05  BNSTATLI PIC  X(0009).
  3403*    -------------------------------
  3404     05  BNSTATL PIC S9(0004) COMP.
  3405     05  BNSTATF PIC  X(0001).
  3406     05  FILLER REDEFINES BNSTATF.
  3407         10  BNSTATA PIC  X(0001).
  3408     05  BNSTATI PIC  X(0002).
  3409*    -------------------------------
  3410     05  BCHGTL PIC S9(0004) COMP.
  3411     05  BCHGTF PIC  X(0001).
  3412     05  FILLER REDEFINES BCHGTF.
  3413         10  BCHGTA PIC  X(0001).
  3414     05  BCHGTI PIC  X(0004).
  3415*    -------------------------------
  3416     05  BCHGL PIC S9(0004) COMP.
  3417     05  BCHGF PIC  X(0001).
  3418     05  FILLER REDEFINES BCHGF.
  3419         10  BCHGA PIC  X(0001).
  3420     05  BCHGI PIC  X(0004).
  3421*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  67
* EL6311.cbl
  3422     05  BMAINTL PIC S9(0004) COMP.
  3423     05  BMAINTF PIC  X(0001).
  3424     05  FILLER REDEFINES BMAINTF.
  3425         10  BMAINTA PIC  X(0001).
  3426     05  BMAINTI PIC  X(0001).
  3427*    -------------------------------
  3428     05  BMANTBYL PIC S9(0004) COMP.
  3429     05  BMANTBYF PIC  X(0001).
  3430     05  FILLER REDEFINES BMANTBYF.
  3431         10  BMANTBYA PIC  X(0001).
  3432     05  BMANTBYI PIC  X(0004).
  3433*    -------------------------------
  3434     05  BCHGHDGL PIC S9(0004) COMP.
  3435     05  BCHGHDGF PIC  X(0001).
  3436     05  FILLER REDEFINES BCHGHDGF.
  3437         10  BCHGHDGA PIC  X(0001).
  3438     05  BCHGHDGI PIC  X(0003).
  3439*    -------------------------------
  3440     05  BMANTDTL PIC S9(0004) COMP.
  3441     05  BMANTDTF PIC  X(0001).
  3442     05  FILLER REDEFINES BMANTDTF.
  3443         10  BMANTDTA PIC  X(0001).
  3444     05  BMANTDTI PIC  X(0008).
  3445*    -------------------------------
  3446     05  BMANTATL PIC S9(0004) COMP.
  3447     05  BMANTATF PIC  X(0001).
  3448     05  FILLER REDEFINES BMANTATF.
  3449         10  BMANTATA PIC  X(0001).
  3450     05  BMANTATI PIC  X(0005).
  3451*    -------------------------------
  3452     05  BCSRL PIC S9(0004) COMP.
  3453     05  BCSRF PIC  X(0001).
  3454     05  FILLER REDEFINES BCSRF.
  3455         10  BCSRA PIC  X(0001).
  3456     05  BCSRI PIC  X(0004).
  3457*    -------------------------------
  3458     05  BBATCHL PIC S9(0004) COMP.
  3459     05  BBATCHF PIC  X(0001).
  3460     05  FILLER REDEFINES BBATCHF.
  3461         10  BBATCHA PIC  X(0001).
  3462     05  BBATCHI PIC  X(0006).
  3463*    -------------------------------
  3464     05  BSEQL PIC S9(0004) COMP.
  3465     05  BSEQF PIC  X(0001).
  3466     05  FILLER REDEFINES BSEQF.
  3467         10  BSEQA PIC  X(0001).
  3468     05  BSEQI PIC  X(0004).
  3469*    -------------------------------
  3470     05  BMOENDTL PIC S9(0004) COMP.
  3471     05  BMOENDTF PIC  X(0001).
  3472     05  FILLER REDEFINES BMOENDTF.
  3473         10  BMOENDTA PIC  X(0001).
  3474     05  BMOENDTI PIC  X(0008).
  3475*    -------------------------------
  3476     05  BCARRL PIC S9(0004) COMP.
  3477     05  BCARRF PIC  X(0001).
  3478     05  FILLER REDEFINES BCARRF.
  3479         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  68
* EL6311.cbl
  3480     05  BCARRI PIC  X(0001).
  3481*    -------------------------------
  3482     05  BGROUPL PIC S9(0004) COMP.
  3483     05  BGROUPF PIC  X(0001).
  3484     05  FILLER REDEFINES BGROUPF.
  3485         10  BGROUPA PIC  X(0001).
  3486     05  BGROUPI PIC  X(0006).
  3487*    -------------------------------
  3488     05  BSTATEL PIC S9(0004) COMP.
  3489     05  BSTATEF PIC  X(0001).
  3490     05  FILLER REDEFINES BSTATEF.
  3491         10  BSTATEA PIC  X(0001).
  3492     05  BSTATEI PIC  X(0002).
  3493*    -------------------------------
  3494     05  BACCTL PIC S9(0004) COMP.
  3495     05  BACCTF PIC  X(0001).
  3496     05  FILLER REDEFINES BACCTF.
  3497         10  BACCTA PIC  X(0001).
  3498     05  BACCTI PIC  X(0010).
  3499*    -------------------------------
  3500     05  BVINHL PIC S9(0004) COMP.
  3501     05  BVINHF PIC  X(0001).
  3502     05  FILLER REDEFINES BVINHF.
  3503         10  BVINHA PIC  X(0001).
  3504     05  BVINHI PIC  X(0004).
  3505*    -------------------------------
  3506     05  BVINL PIC S9(0004) COMP.
  3507     05  BVINF PIC  X(0001).
  3508     05  FILLER REDEFINES BVINF.
  3509         10  BVINA PIC  X(0001).
  3510     05  BVINI PIC  X(0017).
  3511*    -------------------------------
  3512     05  BREFHDGL PIC S9(0004) COMP.
  3513     05  BREFHDGF PIC  X(0001).
  3514     05  FILLER REDEFINES BREFHDGF.
  3515         10  BREFHDGA PIC  X(0001).
  3516     05  BREFHDGI PIC  X(0004).
  3517*    -------------------------------
  3518     05  BREFL PIC S9(0004) COMP.
  3519     05  BREFF PIC  X(0001).
  3520     05  FILLER REDEFINES BREFF.
  3521         10  BREFA PIC  X(0001).
  3522     05  BREFI PIC  X(0012).
  3523*    -------------------------------
  3524     05  BAGEDEFL PIC S9(0004) COMP.
  3525     05  BAGEDEFF PIC  X(0001).
  3526     05  FILLER REDEFINES BAGEDEFF.
  3527         10  BAGEDEFA PIC  X(0001).
  3528     05  BAGEDEFI PIC  X(0004).
  3529*    -------------------------------
  3530     05  BCERTNOL PIC S9(0004) COMP.
  3531     05  BCERTNOF PIC  X(0001).
  3532     05  FILLER REDEFINES BCERTNOF.
  3533         10  BCERTNOA PIC  X(0001).
  3534     05  BCERTNOI PIC  X(0010).
  3535*    -------------------------------
  3536     05  BSUFIXL PIC S9(0004) COMP.
  3537     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  69
* EL6311.cbl
  3538     05  FILLER REDEFINES BSUFIXF.
  3539         10  BSUFIXA PIC  X(0001).
  3540     05  BSUFIXI PIC  X(0001).
  3541*    -------------------------------
  3542     05  BEFFDTL PIC S9(0004) COMP.
  3543     05  BEFFDTF PIC  X(0001).
  3544     05  FILLER REDEFINES BEFFDTF.
  3545         10  BEFFDTA PIC  X(0001).
  3546     05  BEFFDTI PIC  X(0008).
  3547*    -------------------------------
  3548     05  BLSTNML PIC S9(0004) COMP.
  3549     05  BLSTNMF PIC  X(0001).
  3550     05  FILLER REDEFINES BLSTNMF.
  3551         10  BLSTNMA PIC  X(0001).
  3552     05  BLSTNMI PIC  X(0015).
  3553*    -------------------------------
  3554     05  B1STNML PIC S9(0004) COMP.
  3555     05  B1STNMF PIC  X(0001).
  3556     05  FILLER REDEFINES B1STNMF.
  3557         10  B1STNMA PIC  X(0001).
  3558     05  B1STNMI PIC  X(0010).
  3559*    -------------------------------
  3560     05  BINITL PIC S9(0004) COMP.
  3561     05  BINITF PIC  X(0001).
  3562     05  FILLER REDEFINES BINITF.
  3563         10  BINITA PIC  X(0001).
  3564     05  BINITI PIC  X(0001).
  3565*    -------------------------------
  3566     05  BSEXL PIC S9(0004) COMP.
  3567     05  BSEXF PIC  X(0001).
  3568     05  FILLER REDEFINES BSEXF.
  3569         10  BSEXA PIC  X(0001).
  3570     05  BSEXI PIC  X(0001).
  3571*    -------------------------------
  3572     05  BAGEL PIC S9(0004) COMP.
  3573     05  BAGEF PIC  X(0001).
  3574     05  FILLER REDEFINES BAGEF.
  3575         10  BAGEA PIC  X(0001).
  3576     05  BAGEI PIC  X(0002).
  3577*    -------------------------------
  3578     05  BBIRTHL PIC S9(0004) COMP.
  3579     05  BBIRTHF PIC  X(0001).
  3580     05  FILLER REDEFINES BBIRTHF.
  3581         10  BBIRTHA PIC  X(0001).
  3582     05  BBIRTHI PIC  X(0008).
  3583*    -------------------------------
  3584     05  B1STPMTL PIC S9(0004) COMP.
  3585     05  B1STPMTF PIC  X(0001).
  3586     05  FILLER REDEFINES B1STPMTF.
  3587         10  B1STPMTA PIC  X(0001).
  3588     05  B1STPMTI PIC  X(0008).
  3589*    -------------------------------
  3590     05  BDAYSL PIC S9(0004) COMP.
  3591     05  BDAYSF PIC  X(0001).
  3592     05  FILLER REDEFINES BDAYSF.
  3593         10  BDAYSA PIC  X(0001).
  3594     05  BDAYSI PIC  X(0003).
  3595*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  70
* EL6311.cbl
  3596     05  BLNTRML PIC S9(0004) COMP.
  3597     05  BLNTRMF PIC  X(0001).
  3598     05  FILLER REDEFINES BLNTRMF.
  3599         10  BLNTRMA PIC  X(0001).
  3600     05  BLNTRMI PIC  X(0003).
  3601*    -------------------------------
  3602     05  BLNOFCRL PIC S9(0004) COMP.
  3603     05  BLNOFCRF PIC  X(0001).
  3604     05  FILLER REDEFINES BLNOFCRF.
  3605         10  BLNOFCRA PIC  X(0001).
  3606     05  BLNOFCRI PIC  X(0005).
  3607*    -------------------------------
  3608     05  BMODEL PIC S9(0004) COMP.
  3609     05  BMODEF PIC  X(0001).
  3610     05  FILLER REDEFINES BMODEF.
  3611         10  BMODEA PIC  X(0001).
  3612     05  BMODEI PIC  X(0001).
  3613*    -------------------------------
  3614     05  BFREQL PIC S9(0004) COMP.
  3615     05  BFREQF PIC  X(0001).
  3616     05  FILLER REDEFINES BFREQF.
  3617         10  BFREQA PIC  X(0001).
  3618     05  BFREQI PIC  X(0002).
  3619*    -------------------------------
  3620     05  BPMTSL PIC S9(0004) COMP.
  3621     05  BPMTSF PIC  X(0001).
  3622     05  FILLER REDEFINES BPMTSF.
  3623         10  BPMTSA PIC  X(0001).
  3624     05  BPMTSI PIC  999.
  3625*    -------------------------------
  3626     05  BPMTAMTL PIC S9(0004) COMP.
  3627     05  BPMTAMTF PIC  X(0001).
  3628     05  FILLER REDEFINES BPMTAMTF.
  3629         10  BPMTAMTA PIC  X(0001).
  3630     05  BPMTAMTI PIC  9(7)V99.
  3631*    -------------------------------
  3632     05  BAPRL PIC S9(0004) COMP.
  3633     05  BAPRF PIC  X(0001).
  3634     05  FILLER REDEFINES BAPRF.
  3635         10  BAPRA PIC  X(0001).
  3636     05  BAPRI PIC  X(7).
  3637*    -------------------------------
  3638     05  BLIVESL PIC S9(0004) COMP.
  3639     05  BLIVESF PIC  X(0001).
  3640     05  FILLER REDEFINES BLIVESF.
  3641         10  BLIVESA PIC  X(0001).
  3642     05  BLIVESI PIC  X(0009).
  3643*    -------------------------------
  3644     05  BMEMCAPL PIC S9(0004) COMP.
  3645     05  BMEMCAPF PIC  X(0001).
  3646     05  FILLER REDEFINES BMEMCAPF.
  3647         10  BMEMCAPA PIC  X(0001).
  3648     05  BMEMCAPI PIC  X(0011).
  3649*    -------------------------------
  3650     05  BORIGHDL PIC S9(0004) COMP.
  3651     05  BORIGHDF PIC  X(0001).
  3652     05  FILLER REDEFINES BORIGHDF.
  3653         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  71
* EL6311.cbl
  3654     05  BORIGHDI PIC  X(0009).
  3655*    -------------------------------
  3656     05  DMDBILL PIC S9(0004) COMP.
  3657     05  DMDBILF PIC  X(0001).
  3658     05  FILLER REDEFINES DMDBILF.
  3659         10  DMDBILA PIC  X(0001).
  3660     05  DMDBILI PIC  X(0006).
  3661*    -------------------------------
  3662     05  BFORCEL PIC S9(0004) COMP.
  3663     05  BFORCEF PIC  X(0001).
  3664     05  FILLER REDEFINES BFORCEF.
  3665         10  BFORCEA PIC  X(0001).
  3666     05  BFORCEI PIC  X(0001).
  3667*    -------------------------------
  3668     05  BENTRYL PIC S9(0004) COMP.
  3669     05  BENTRYF PIC  X(0001).
  3670     05  FILLER REDEFINES BENTRYF.
  3671         10  BENTRYA PIC  X(0001).
  3672     05  BENTRYI PIC  X(0001).
  3673*    -------------------------------
  3674     05  BREINL PIC S9(0004) COMP.
  3675     05  BREINF PIC  X(0001).
  3676     05  FILLER REDEFINES BREINF.
  3677         10  BREINA PIC  X(0001).
  3678     05  BREINI PIC  X(0001).
  3679*    -------------------------------
  3680     05  BBILCDL PIC S9(0004) COMP.
  3681     05  BBILCDF PIC  X(0001).
  3682     05  FILLER REDEFINES BBILCDF.
  3683         10  BBILCDA PIC  X(0001).
  3684     05  BBILCDI PIC  X(0001).
  3685*    -------------------------------
  3686     05  BUNWRITL PIC S9(0004) COMP.
  3687     05  BUNWRITF PIC  X(0001).
  3688     05  FILLER REDEFINES BUNWRITF.
  3689         10  BUNWRITA PIC  X(0001).
  3690     05  BUNWRITI PIC  X(0001).
  3691*    -------------------------------
  3692     05  BSKPCDL PIC S9(0004) COMP.
  3693     05  BSKPCDF PIC  X(0001).
  3694     05  FILLER REDEFINES BSKPCDF.
  3695         10  BSKPCDA PIC  X(0001).
  3696     05  BSKPCDI PIC  X(0001).
  3697*    -------------------------------
  3698     05  BINDGRPL PIC S9(0004) COMP.
  3699     05  BINDGRPF PIC  X(0001).
  3700     05  FILLER REDEFINES BINDGRPF.
  3701         10  BINDGRPA PIC  X(0001).
  3702     05  BINDGRPI PIC  X(0001).
  3703*    -------------------------------
  3704     05  BSIGL PIC S9(0004) COMP.
  3705     05  BSIGF PIC  X(0001).
  3706     05  FILLER REDEFINES BSIGF.
  3707         10  BSIGA PIC  X(0001).
  3708     05  BSIGI PIC  X(0001).
  3709*    -------------------------------
  3710     05  BRTCLSL PIC S9(0004) COMP.
  3711     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  72
* EL6311.cbl
  3712     05  FILLER REDEFINES BRTCLSF.
  3713         10  BRTCLSA PIC  X(0001).
  3714     05  BRTCLSI PIC  X(0002).
  3715*    -------------------------------
  3716     05  BCHGCNTL PIC S9(0004) COMP.
  3717     05  BCHGCNTF PIC  X(0001).
  3718     05  FILLER REDEFINES BCHGCNTF.
  3719         10  BCHGCNTA PIC  X(0001).
  3720     05  BCHGCNTI PIC  X(0003).
  3721*    -------------------------------
  3722     05  BMEMBERL PIC S9(0004) COMP.
  3723     05  BMEMBERF PIC  X(0001).
  3724     05  FILLER REDEFINES BMEMBERF.
  3725         10  BMEMBERA PIC  X(0001).
  3726     05  BMEMBERI PIC  X(0012).
  3727*    -------------------------------
  3728     05  BORGNOL PIC S9(0004) COMP.
  3729     05  BORGNOF PIC  X(0001).
  3730     05  FILLER REDEFINES BORGNOF.
  3731         10  BORGNOA PIC  X(0001).
  3732     05  BORGNOI PIC  X(0006).
  3733*    -------------------------------
  3734     05  BORGSEQL PIC S9(0004) COMP.
  3735     05  BORGSEQF PIC  X(0001).
  3736     05  FILLER REDEFINES BORGSEQF.
  3737         10  BORGSEQA PIC  X(0001).
  3738     05  BORGSEQI PIC  X(0004).
  3739*    -------------------------------
  3740     05  BBILLEDL PIC S9(0004) COMP.
  3741     05  BBILLEDF PIC  X(0001).
  3742     05  FILLER REDEFINES BBILLEDF.
  3743         10  BBILLEDA PIC  X(0001).
  3744     05  BBILLEDI PIC  9(9).
  3745*    -------------------------------
  3746     05  BKIND1L PIC S9(0004) COMP.
  3747     05  BKIND1F PIC  X(0001).
  3748     05  FILLER REDEFINES BKIND1F.
  3749         10  BKIND1A PIC  X(0001).
  3750     05  BKIND1I PIC  X(0002).
  3751*    -------------------------------
  3752     05  BTYPE1L PIC S9(0004) COMP.
  3753     05  BTYPE1F PIC  X(0001).
  3754     05  FILLER REDEFINES BTYPE1F.
  3755         10  BTYPE1A PIC  X(0001).
  3756     05  BTYPE1I PIC  X(0003).
  3757*    -------------------------------
  3758     05  BTERM1L PIC S9(0004) COMP.
  3759     05  BTERM1F PIC  X(0001).
  3760     05  FILLER REDEFINES BTERM1F.
  3761         10  BTERM1A PIC  X(0001).
  3762     05  BTERM1I PIC  X(0003).
  3763*    -------------------------------
  3764     05  BBEN1L PIC S9(0004) COMP.
  3765     05  BBEN1F PIC  X(0001).
  3766     05  FILLER REDEFINES BBEN1F.
  3767         10  BBEN1A PIC  X(0001).
  3768     05  BBEN1I PIC  X(0012).
  3769*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  73
* EL6311.cbl
  3770     05  BPREM1L PIC S9(0004) COMP.
  3771     05  BPREM1F PIC  X(0001).
  3772     05  FILLER REDEFINES BPREM1F.
  3773         10  BPREM1A PIC  X(0001).
  3774     05  BPREM1I PIC  X(0011).
  3775*    -------------------------------
  3776     05  BEXPIR1L PIC S9(0004) COMP.
  3777     05  BEXPIR1F PIC  X(0001).
  3778     05  FILLER REDEFINES BEXPIR1F.
  3779         10  BEXPIR1A PIC  X(0001).
  3780     05  BEXPIR1I PIC  X(0008).
  3781*    -------------------------------
  3782     05  BCP1L PIC S9(0004) COMP.
  3783     05  BCP1F PIC  X(0001).
  3784     05  FILLER REDEFINES BCP1F.
  3785         10  BCP1A PIC  X(0001).
  3786     05  BCP1I PIC  X(0002).
  3787*    -------------------------------
  3788     05  BALTBN1L PIC S9(0004) COMP.
  3789     05  BALTBN1F PIC  X(0001).
  3790     05  FILLER REDEFINES BALTBN1F.
  3791         10  BALTBN1A PIC  X(0001).
  3792     05  BALTBN1I PIC  X(0012).
  3793*    -------------------------------
  3794     05  BALTPR1L PIC S9(0004) COMP.
  3795     05  BALTPR1F PIC  X(0001).
  3796     05  FILLER REDEFINES BALTPR1F.
  3797         10  BALTPR1A PIC  X(0001).
  3798     05  BALTPR1I PIC  X(0011).
  3799*    -------------------------------
  3800     05  BBNCD1L PIC S9(0004) COMP.
  3801     05  BBNCD1F PIC  X(0001).
  3802     05  FILLER REDEFINES BBNCD1F.
  3803         10  BBNCD1A PIC  X(0001).
  3804     05  BBNCD1I PIC  X(0003).
  3805*    -------------------------------
  3806     05  BCPRM1L PIC S9(0004) COMP.
  3807     05  BCPRM1F PIC  X(0001).
  3808     05  FILLER REDEFINES BCPRM1F.
  3809         10  BCPRM1A PIC  X(0001).
  3810     05  BCPRM1I PIC  X(0011).
  3811*    -------------------------------
  3812     05  BCAPRM1L PIC S9(0004) COMP.
  3813     05  BCAPRM1F PIC  X(0001).
  3814     05  FILLER REDEFINES BCAPRM1F.
  3815         10  BCAPRM1A PIC  X(0001).
  3816     05  BCAPRM1I PIC  X(0011).
  3817*    -------------------------------
  3818     05  BENABR1L PIC S9(0004) COMP.
  3819     05  BENABR1F PIC  X(0001).
  3820     05  FILLER REDEFINES BENABR1F.
  3821         10  BENABR1A PIC  X(0001).
  3822     05  BENABR1I PIC  X(0005).
  3823*    -------------------------------
  3824     05  BDIFF1L PIC S9(0004) COMP.
  3825     05  BDIFF1F PIC  X(0001).
  3826     05  FILLER REDEFINES BDIFF1F.
  3827         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  74
* EL6311.cbl
  3828     05  BDIFF1I PIC  X(0011).
  3829*    -------------------------------
  3830     05  BBILIT1L PIC S9(0004) COMP.
  3831     05  BBILIT1F PIC  X(0001).
  3832     05  FILLER REDEFINES BBILIT1F.
  3833         10  BBILIT1A PIC  X(0001).
  3834     05  BBILIT1I PIC  X(0008).
  3835*    -------------------------------
  3836     05  BADIFF1L PIC S9(0004) COMP.
  3837     05  BADIFF1F PIC  X(0001).
  3838     05  FILLER REDEFINES BADIFF1F.
  3839         10  BADIFF1A PIC  X(0001).
  3840     05  BADIFF1I PIC  X(0011).
  3841*    -------------------------------
  3842     05  BKIND2L PIC S9(0004) COMP.
  3843     05  BKIND2F PIC  X(0001).
  3844     05  FILLER REDEFINES BKIND2F.
  3845         10  BKIND2A PIC  X(0001).
  3846     05  BKIND2I PIC  X(0002).
  3847*    -------------------------------
  3848     05  BTYPE2L PIC S9(0004) COMP.
  3849     05  BTYPE2F PIC  X(0001).
  3850     05  FILLER REDEFINES BTYPE2F.
  3851         10  BTYPE2A PIC  X(0001).
  3852     05  BTYPE2I PIC  X(0003).
  3853*    -------------------------------
  3854     05  BTERM2L PIC S9(0004) COMP.
  3855     05  BTERM2F PIC  X(0001).
  3856     05  FILLER REDEFINES BTERM2F.
  3857         10  BTERM2A PIC  X(0001).
  3858     05  BTERM2I PIC  X(0003).
  3859*    -------------------------------
  3860     05  BBEN2L PIC S9(0004) COMP.
  3861     05  BBEN2F PIC  X(0001).
  3862     05  FILLER REDEFINES BBEN2F.
  3863         10  BBEN2A PIC  X(0001).
  3864     05  BBEN2I PIC  X(0012).
  3865*    -------------------------------
  3866     05  BPREM2L PIC S9(0004) COMP.
  3867     05  BPREM2F PIC  X(0001).
  3868     05  FILLER REDEFINES BPREM2F.
  3869         10  BPREM2A PIC  X(0001).
  3870     05  BPREM2I PIC  X(0011).
  3871*    -------------------------------
  3872     05  BEXPIR2L PIC S9(0004) COMP.
  3873     05  BEXPIR2F PIC  X(0001).
  3874     05  FILLER REDEFINES BEXPIR2F.
  3875         10  BEXPIR2A PIC  X(0001).
  3876     05  BEXPIR2I PIC  X(0008).
  3877*    -------------------------------
  3878     05  BCP2L PIC S9(0004) COMP.
  3879     05  BCP2F PIC  X(0001).
  3880     05  FILLER REDEFINES BCP2F.
  3881         10  BCP2A PIC  X(0001).
  3882     05  BCP2I PIC  X(0002).
  3883*    -------------------------------
  3884     05  BALTBN2L PIC S9(0004) COMP.
  3885     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  75
* EL6311.cbl
  3886     05  FILLER REDEFINES BALTBN2F.
  3887         10  BALTBN2A PIC  X(0001).
  3888     05  BALTBN2I PIC  X(0012).
  3889*    -------------------------------
  3890     05  BALTPR2L PIC S9(0004) COMP.
  3891     05  BALTPR2F PIC  X(0001).
  3892     05  FILLER REDEFINES BALTPR2F.
  3893         10  BALTPR2A PIC  X(0001).
  3894     05  BALTPR2I PIC  X(0011).
  3895*    -------------------------------
  3896     05  BBNCD2L PIC S9(0004) COMP.
  3897     05  BBNCD2F PIC  X(0001).
  3898     05  FILLER REDEFINES BBNCD2F.
  3899         10  BBNCD2A PIC  X(0001).
  3900     05  BBNCD2I PIC  X(0003).
  3901*    -------------------------------
  3902     05  BCPRM2L PIC S9(0004) COMP.
  3903     05  BCPRM2F PIC  X(0001).
  3904     05  FILLER REDEFINES BCPRM2F.
  3905         10  BCPRM2A PIC  X(0001).
  3906     05  BCPRM2I PIC  X(0011).
  3907*    -------------------------------
  3908     05  BCAPRM2L PIC S9(0004) COMP.
  3909     05  BCAPRM2F PIC  X(0001).
  3910     05  FILLER REDEFINES BCAPRM2F.
  3911         10  BCAPRM2A PIC  X(0001).
  3912     05  BCAPRM2I PIC  X(0011).
  3913*    -------------------------------
  3914     05  BENABR2L PIC S9(0004) COMP.
  3915     05  BENABR2F PIC  X(0001).
  3916     05  FILLER REDEFINES BENABR2F.
  3917         10  BENABR2A PIC  X(0001).
  3918     05  BENABR2I PIC  X(0005).
  3919*    -------------------------------
  3920     05  BDIFF2L PIC S9(0004) COMP.
  3921     05  BDIFF2F PIC  X(0001).
  3922     05  FILLER REDEFINES BDIFF2F.
  3923         10  BDIFF2A PIC  X(0001).
  3924     05  BDIFF2I PIC  X(0011).
  3925*    -------------------------------
  3926     05  BBILIT2L PIC S9(0004) COMP.
  3927     05  BBILIT2F PIC  X(0001).
  3928     05  FILLER REDEFINES BBILIT2F.
  3929         10  BBILIT2A PIC  X(0001).
  3930     05  BBILIT2I PIC  X(0008).
  3931*    -------------------------------
  3932     05  BADIFF2L PIC S9(0004) COMP.
  3933     05  BADIFF2F PIC  X(0001).
  3934     05  FILLER REDEFINES BADIFF2F.
  3935         10  BADIFF2A PIC  X(0001).
  3936     05  BADIFF2I PIC  X(0011).
  3937*    -------------------------------
  3938     05  BERMSG1L PIC S9(0004) COMP.
  3939     05  BERMSG1F PIC  X(0001).
  3940     05  FILLER REDEFINES BERMSG1F.
  3941         10  BERMSG1A PIC  X(0001).
  3942     05  BERMSG1I PIC  X(0078).
  3943*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  76
* EL6311.cbl
  3944     05  BERMSG2L PIC S9(0004) COMP.
  3945     05  BERMSG2F PIC  X(0001).
  3946     05  FILLER REDEFINES BERMSG2F.
  3947         10  BERMSG2A PIC  X(0001).
  3948     05  BERMSG2I PIC  X(0078).
  3949*    -------------------------------
  3950     05  BERMSG3L PIC S9(0004) COMP.
  3951     05  BERMSG3F PIC  X(0001).
  3952     05  FILLER REDEFINES BERMSG3F.
  3953         10  BERMSG3A PIC  X(0001).
  3954     05  BERMSG3I PIC  X(0078).
  3955*    -------------------------------
  3956     05  BPFENTRL PIC S9(0004) COMP.
  3957     05  BPFENTRF PIC  X(0001).
  3958     05  FILLER REDEFINES BPFENTRF.
  3959         10  BPFENTRA PIC  X(0001).
  3960     05  BPFENTRI PIC  9(2).
  3961*    -------------------------------
  3962     05  BPF5HDRL PIC S9(0004) COMP.
  3963     05  BPF5HDRF PIC  X(0001).
  3964     05  FILLER REDEFINES BPF5HDRF.
  3965         10  BPF5HDRA PIC  X(0001).
  3966     05  BPF5HDRI PIC  X(0005).
  3967*    -------------------------------
  3968     05  BPF4HDRL PIC S9(0004) COMP.
  3969     05  BPF4HDRF PIC  X(0001).
  3970     05  FILLER REDEFINES BPF4HDRF.
  3971         10  BPF4HDRA PIC  X(0001).
  3972     05  BPF4HDRI PIC  X(0013).
  3973*    -------------------------------
  3974     05  BF15HDRL PIC S9(0004) COMP.
  3975     05  BF15HDRF PIC  X(0001).
  3976     05  FILLER REDEFINES BF15HDRF.
  3977         10  BF15HDRA PIC  X(0001).
  3978     05  BF15HDRI PIC  X(0010).
  3979 01  EL631BO REDEFINES EL631BI.
  3980     05  FILLER            PIC  X(0012).
  3981*    -------------------------------
  3982     05  FILLER            PIC  X(0003).
  3983     05  BDATEO PIC  X(0008).
  3984*    -------------------------------
  3985     05  FILLER            PIC  X(0003).
  3986     05  BTIMEO PIC  99.99.
  3987*    -------------------------------
  3988     05  FILLER            PIC  X(0003).
  3989     05  BHEADO PIC  X(0038).
  3990*    -------------------------------
  3991     05  FILLER            PIC  X(0003).
  3992     05  BNCERTLO PIC  X(0008).
  3993*    -------------------------------
  3994     05  FILLER            PIC  X(0003).
  3995     05  BNCERTO PIC  X(0011).
  3996*    -------------------------------
  3997     05  FILLER            PIC  X(0003).
  3998     05  BNSTATLO PIC  X(0009).
  3999*    -------------------------------
  4000     05  FILLER            PIC  X(0003).
  4001     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  77
* EL6311.cbl
  4002*    -------------------------------
  4003     05  FILLER            PIC  X(0003).
  4004     05  BCHGTO PIC  X(0004).
  4005*    -------------------------------
  4006     05  FILLER            PIC  X(0003).
  4007     05  BCHGO PIC  ZZZ9.
  4008*    -------------------------------
  4009     05  FILLER            PIC  X(0003).
  4010     05  BMAINTO PIC  X(0001).
  4011*    -------------------------------
  4012     05  FILLER            PIC  X(0003).
  4013     05  BMANTBYO PIC  X(0004).
  4014*    -------------------------------
  4015     05  FILLER            PIC  X(0003).
  4016     05  BCHGHDGO PIC  X(0003).
  4017*    -------------------------------
  4018     05  FILLER            PIC  X(0003).
  4019     05  BMANTDTO PIC  X(0008).
  4020*    -------------------------------
  4021     05  FILLER            PIC  X(0003).
  4022     05  BMANTATO PIC  99.99.
  4023*    -------------------------------
  4024     05  FILLER            PIC  X(0003).
  4025     05  BCSRO PIC  X(0004).
  4026*    -------------------------------
  4027     05  FILLER            PIC  X(0003).
  4028     05  BBATCHO PIC  X(0006).
  4029*    -------------------------------
  4030     05  FILLER            PIC  X(0003).
  4031     05  BSEQO PIC  X(0004).
  4032*    -------------------------------
  4033     05  FILLER            PIC  X(0003).
  4034     05  BMOENDTO PIC  X(0008).
  4035*    -------------------------------
  4036     05  FILLER            PIC  X(0003).
  4037     05  BCARRO PIC  X(0001).
  4038*    -------------------------------
  4039     05  FILLER            PIC  X(0003).
  4040     05  BGROUPO PIC  X(0006).
  4041*    -------------------------------
  4042     05  FILLER            PIC  X(0003).
  4043     05  BSTATEO PIC  X(0002).
  4044*    -------------------------------
  4045     05  FILLER            PIC  X(0003).
  4046     05  BACCTO PIC  X(0010).
  4047*    -------------------------------
  4048     05  FILLER            PIC  X(0003).
  4049     05  BVINHO PIC  X(0004).
  4050*    -------------------------------
  4051     05  FILLER            PIC  X(0003).
  4052     05  BVINO PIC  X(0017).
  4053*    -------------------------------
  4054     05  FILLER            PIC  X(0003).
  4055     05  BREFHDGO PIC  X(0004).
  4056*    -------------------------------
  4057     05  FILLER            PIC  X(0003).
  4058     05  BREFO PIC  X(0012).
  4059*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  78
* EL6311.cbl
  4060     05  FILLER            PIC  X(0003).
  4061     05  BAGEDEFO PIC  X(0004).
  4062*    -------------------------------
  4063     05  FILLER            PIC  X(0003).
  4064     05  BCERTNOO PIC  X(0010).
  4065*    -------------------------------
  4066     05  FILLER            PIC  X(0003).
  4067     05  BSUFIXO PIC  X(0001).
  4068*    -------------------------------
  4069     05  FILLER            PIC  X(0003).
  4070     05  BEFFDTO PIC  X(0008).
  4071*    -------------------------------
  4072     05  FILLER            PIC  X(0003).
  4073     05  BLSTNMO PIC  X(0015).
  4074*    -------------------------------
  4075     05  FILLER            PIC  X(0003).
  4076     05  B1STNMO PIC  X(0010).
  4077*    -------------------------------
  4078     05  FILLER            PIC  X(0003).
  4079     05  BINITO PIC  X(0001).
  4080*    -------------------------------
  4081     05  FILLER            PIC  X(0003).
  4082     05  BSEXO PIC  X(0001).
  4083*    -------------------------------
  4084     05  FILLER            PIC  X(0003).
  4085     05  BAGEO PIC  X(0002).
  4086*    -------------------------------
  4087     05  FILLER            PIC  X(0003).
  4088     05  BBIRTHO PIC  X(0008).
  4089*    -------------------------------
  4090     05  FILLER            PIC  X(0003).
  4091     05  B1STPMTO PIC  X(0008).
  4092*    -------------------------------
  4093     05  FILLER            PIC  X(0003).
  4094     05  BDAYSO PIC  X(0003).
  4095*    -------------------------------
  4096     05  FILLER            PIC  X(0003).
  4097     05  BLNTRMO PIC  X(0003).
  4098*    -------------------------------
  4099     05  FILLER            PIC  X(0003).
  4100     05  BLNOFCRO PIC  X(0005).
  4101*    -------------------------------
  4102     05  FILLER            PIC  X(0003).
  4103     05  BMODEO PIC  X(0001).
  4104*    -------------------------------
  4105     05  FILLER            PIC  X(0003).
  4106     05  BFREQO PIC  X(0002).
  4107*    -------------------------------
  4108     05  FILLER            PIC  X(0003).
  4109     05  BPMTSO PIC  X(0003).
  4110*    -------------------------------
  4111     05  FILLER            PIC  X(0003).
  4112     05  BPMTAMTO PIC  ZZZZZ9.99.
  4113*    -------------------------------
  4114     05  FILLER            PIC  X(0003).
  4115     05  BAPRO PIC  99.9999.
  4116*    -------------------------------
  4117     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  79
* EL6311.cbl
  4118     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4119*    -------------------------------
  4120     05  FILLER            PIC  X(0003).
  4121     05  BMEMCAPO PIC  X(0011).
  4122*    -------------------------------
  4123     05  FILLER            PIC  X(0003).
  4124     05  BORIGHDO PIC  X(0009).
  4125*    -------------------------------
  4126     05  FILLER            PIC  X(0003).
  4127     05  DMDBILO PIC  X(0006).
  4128*    -------------------------------
  4129     05  FILLER            PIC  X(0003).
  4130     05  BFORCEO PIC  X(0001).
  4131*    -------------------------------
  4132     05  FILLER            PIC  X(0003).
  4133     05  BENTRYO PIC  X(0001).
  4134*    -------------------------------
  4135     05  FILLER            PIC  X(0003).
  4136     05  BREINO PIC  X(0001).
  4137*    -------------------------------
  4138     05  FILLER            PIC  X(0003).
  4139     05  BBILCDO PIC  X(0001).
  4140*    -------------------------------
  4141     05  FILLER            PIC  X(0003).
  4142     05  BUNWRITO PIC  X(0001).
  4143*    -------------------------------
  4144     05  FILLER            PIC  X(0003).
  4145     05  BSKPCDO PIC  X(0001).
  4146*    -------------------------------
  4147     05  FILLER            PIC  X(0003).
  4148     05  BINDGRPO PIC  X(0001).
  4149*    -------------------------------
  4150     05  FILLER            PIC  X(0003).
  4151     05  BSIGO PIC  X(0001).
  4152*    -------------------------------
  4153     05  FILLER            PIC  X(0003).
  4154     05  BRTCLSO PIC  X(0002).
  4155*    -------------------------------
  4156     05  FILLER            PIC  X(0003).
  4157     05  BCHGCNTO PIC  X(0003).
  4158*    -------------------------------
  4159     05  FILLER            PIC  X(0003).
  4160     05  BMEMBERO PIC  X(0012).
  4161*    -------------------------------
  4162     05  FILLER            PIC  X(0003).
  4163     05  BORGNOO PIC  X(0006).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BORGSEQO PIC  X(0004).
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BKIND1O PIC  X(0002).
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  80
* EL6311.cbl
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BTERM1O PIC  X(0003).
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BBEN1O PIC  X(0012).
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BPREM1O PIC  X(0011).
  4185*    -------------------------------
  4186     05  FILLER            PIC  X(0003).
  4187     05  BEXPIR1O PIC  X(0008).
  4188*    -------------------------------
  4189     05  FILLER            PIC  X(0003).
  4190     05  BCP1O PIC  X(0002).
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BALTBN1O PIC  X(0012).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BALTPR1O PIC  X(0011).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BBNCD1O PIC  X(0003).
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BCPRM1O PIC  X(0011).
  4203*    -------------------------------
  4204     05  FILLER            PIC  X(0003).
  4205     05  BCAPRM1O PIC  X(0011).
  4206*    -------------------------------
  4207     05  FILLER            PIC  X(0003).
  4208     05  BENABR1O PIC  X(0005).
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BDIFF1O PIC  X(0011).
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BBILIT1O PIC  X(0008).
  4215*    -------------------------------
  4216     05  FILLER            PIC  X(0003).
  4217     05  BADIFF1O PIC  X(0011).
  4218*    -------------------------------
  4219     05  FILLER            PIC  X(0003).
  4220     05  BKIND2O PIC  X(0002).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BTYPE2O PIC  X(0003).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BTERM2O PIC  X(0003).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BBEN2O PIC  X(0012).
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BPREM2O PIC  X(0011).
  4233*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  81
* EL6311.cbl
  4234     05  FILLER            PIC  X(0003).
  4235     05  BEXPIR2O PIC  X(0008).
  4236*    -------------------------------
  4237     05  FILLER            PIC  X(0003).
  4238     05  BCP2O PIC  X(0002).
  4239*    -------------------------------
  4240     05  FILLER            PIC  X(0003).
  4241     05  BALTBN2O PIC  X(0012).
  4242*    -------------------------------
  4243     05  FILLER            PIC  X(0003).
  4244     05  BALTPR2O PIC  X(0011).
  4245*    -------------------------------
  4246     05  FILLER            PIC  X(0003).
  4247     05  BBNCD2O PIC  X(0003).
  4248*    -------------------------------
  4249     05  FILLER            PIC  X(0003).
  4250     05  BCPRM2O PIC  X(0011).
  4251*    -------------------------------
  4252     05  FILLER            PIC  X(0003).
  4253     05  BCAPRM2O PIC  X(0011).
  4254*    -------------------------------
  4255     05  FILLER            PIC  X(0003).
  4256     05  BENABR2O PIC  X(0005).
  4257*    -------------------------------
  4258     05  FILLER            PIC  X(0003).
  4259     05  BDIFF2O PIC  X(0011).
  4260*    -------------------------------
  4261     05  FILLER            PIC  X(0003).
  4262     05  BBILIT2O PIC  X(0008).
  4263*    -------------------------------
  4264     05  FILLER            PIC  X(0003).
  4265     05  BADIFF2O PIC  X(0011).
  4266*    -------------------------------
  4267     05  FILLER            PIC  X(0003).
  4268     05  BERMSG1O PIC  X(0078).
  4269*    -------------------------------
  4270     05  FILLER            PIC  X(0003).
  4271     05  BERMSG2O PIC  X(0078).
  4272*    -------------------------------
  4273     05  FILLER            PIC  X(0003).
  4274     05  BERMSG3O PIC  X(0078).
  4275*    -------------------------------
  4276     05  FILLER            PIC  X(0003).
  4277     05  BPFENTRO PIC  X(0002).
  4278*    -------------------------------
  4279     05  FILLER            PIC  X(0003).
  4280     05  BPF5HDRO PIC  X(0005).
  4281*    -------------------------------
  4282     05  FILLER            PIC  X(0003).
  4283     05  BPF4HDRO PIC  X(0013).
  4284*    -------------------------------
  4285     05  FILLER            PIC  X(0003).
  4286     05  BF15HDRO PIC  X(0010).
  4287*    -------------------------------
  4288 01  EL631CI REDEFINES EL631BI.
  4289     05  FILLER            PIC  X(0012).
  4290*    -------------------------------
  4291     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  82
* EL6311.cbl
  4292     05  CDATEF PIC  X(0001).
  4293     05  FILLER REDEFINES CDATEF.
  4294         10  CDATEA PIC  X(0001).
  4295     05  CDATEI PIC  X(0008).
  4296*    -------------------------------
  4297     05  CTIMEL PIC S9(0004) COMP.
  4298     05  CTIMEF PIC  X(0001).
  4299     05  FILLER REDEFINES CTIMEF.
  4300         10  CTIMEA PIC  X(0001).
  4301     05  CTIMEI PIC  X(0005).
  4302*    -------------------------------
  4303     05  CHEADL PIC S9(0004) COMP.
  4304     05  CHEADF PIC  X(0001).
  4305     05  FILLER REDEFINES CHEADF.
  4306         10  CHEADA PIC  X(0001).
  4307     05  CHEADI PIC  X(0038).
  4308*    -------------------------------
  4309     05  CCHGTL PIC S9(0004) COMP.
  4310     05  CCHGTF PIC  X(0001).
  4311     05  FILLER REDEFINES CCHGTF.
  4312         10  CCHGTA PIC  X(0001).
  4313     05  CCHGTI PIC  X(0004).
  4314*    -------------------------------
  4315     05  CCHGL PIC S9(0004) COMP.
  4316     05  CCHGF PIC  X(0001).
  4317     05  FILLER REDEFINES CCHGF.
  4318         10  CCHGA PIC  X(0001).
  4319     05  CCHGI PIC  X(0004).
  4320*    -------------------------------
  4321     05  CMAINTL PIC S9(0004) COMP.
  4322     05  CMAINTF PIC  X(0001).
  4323     05  FILLER REDEFINES CMAINTF.
  4324         10  CMAINTA PIC  X(0001).
  4325     05  CMAINTI PIC  X(0001).
  4326*    -------------------------------
  4327     05  CMANTBYL PIC S9(0004) COMP.
  4328     05  CMANTBYF PIC  X(0001).
  4329     05  FILLER REDEFINES CMANTBYF.
  4330         10  CMANTBYA PIC  X(0001).
  4331     05  CMANTBYI PIC  X(0004).
  4332*    -------------------------------
  4333     05  CCHGHDGL PIC S9(0004) COMP.
  4334     05  CCHGHDGF PIC  X(0001).
  4335     05  FILLER REDEFINES CCHGHDGF.
  4336         10  CCHGHDGA PIC  X(0001).
  4337     05  CCHGHDGI PIC  X(0003).
  4338*    -------------------------------
  4339     05  CMANTDTL PIC S9(0004) COMP.
  4340     05  CMANTDTF PIC  X(0001).
  4341     05  FILLER REDEFINES CMANTDTF.
  4342         10  CMANTDTA PIC  X(0001).
  4343     05  CMANTDTI PIC  X(0008).
  4344*    -------------------------------
  4345     05  CMANTATL PIC S9(0004) COMP.
  4346     05  CMANTATF PIC  X(0001).
  4347     05  FILLER REDEFINES CMANTATF.
  4348         10  CMANTATA PIC  X(0001).
  4349     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  83
* EL6311.cbl
  4350*    -------------------------------
  4351     05  CCSRL PIC S9(0004) COMP.
  4352     05  CCSRF PIC  X(0001).
  4353     05  FILLER REDEFINES CCSRF.
  4354         10  CCSRA PIC  X(0001).
  4355     05  CCSRI PIC  X(0004).
  4356*    -------------------------------
  4357     05  CBATCHL PIC S9(0004) COMP.
  4358     05  CBATCHF PIC  X(0001).
  4359     05  FILLER REDEFINES CBATCHF.
  4360         10  CBATCHA PIC  X(0001).
  4361     05  CBATCHI PIC  X(0006).
  4362*    -------------------------------
  4363     05  CSEQL PIC S9(0004) COMP.
  4364     05  CSEQF PIC  X(0001).
  4365     05  FILLER REDEFINES CSEQF.
  4366         10  CSEQA PIC  X(0001).
  4367     05  CSEQI PIC  X(0004).
  4368*    -------------------------------
  4369     05  CMOENDTL PIC S9(0004) COMP.
  4370     05  CMOENDTF PIC  X(0001).
  4371     05  FILLER REDEFINES CMOENDTF.
  4372         10  CMOENDTA PIC  X(0001).
  4373     05  CMOENDTI PIC  X(0008).
  4374*    -------------------------------
  4375     05  CCARRL PIC S9(0004) COMP.
  4376     05  CCARRF PIC  X(0001).
  4377     05  FILLER REDEFINES CCARRF.
  4378         10  CCARRA PIC  X(0001).
  4379     05  CCARRI PIC  X(0001).
  4380*    -------------------------------
  4381     05  CGROUPL PIC S9(0004) COMP.
  4382     05  CGROUPF PIC  X(0001).
  4383     05  FILLER REDEFINES CGROUPF.
  4384         10  CGROUPA PIC  X(0001).
  4385     05  CGROUPI PIC  X(0006).
  4386*    -------------------------------
  4387     05  CSTATEL PIC S9(0004) COMP.
  4388     05  CSTATEF PIC  X(0001).
  4389     05  FILLER REDEFINES CSTATEF.
  4390         10  CSTATEA PIC  X(0001).
  4391     05  CSTATEI PIC  X(0002).
  4392*    -------------------------------
  4393     05  CACCTL PIC S9(0004) COMP.
  4394     05  CACCTF PIC  X(0001).
  4395     05  FILLER REDEFINES CACCTF.
  4396         10  CACCTA PIC  X(0001).
  4397     05  CACCTI PIC  X(0010).
  4398*    -------------------------------
  4399     05  CORIGHDL PIC S9(0004) COMP.
  4400     05  CORIGHDF PIC  X(0001).
  4401     05  FILLER REDEFINES CORIGHDF.
  4402         10  CORIGHDA PIC  X(0001).
  4403     05  CORIGHDI PIC  X(0011).
  4404*    -------------------------------
  4405     05  CORGNOL PIC S9(0004) COMP.
  4406     05  CORGNOF PIC  X(0001).
  4407     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  84
* EL6311.cbl
  4408         10  CORGNOA PIC  X(0001).
  4409     05  CORGNOI PIC  X(0006).
  4410*    -------------------------------
  4411     05  CORGSEQL PIC S9(0004) COMP.
  4412     05  CORGSEQF PIC  X(0001).
  4413     05  FILLER REDEFINES CORGSEQF.
  4414         10  CORGSEQA PIC  X(0001).
  4415     05  CORGSEQI PIC  X(0004).
  4416*    -------------------------------
  4417     05  CREFHDGL PIC S9(0004) COMP.
  4418     05  CREFHDGF PIC  X(0001).
  4419     05  FILLER REDEFINES CREFHDGF.
  4420         10  CREFHDGA PIC  X(0001).
  4421     05  CREFHDGI PIC  X(0010).
  4422*    -------------------------------
  4423     05  CREFL PIC S9(0004) COMP.
  4424     05  CREFF PIC  X(0001).
  4425     05  FILLER REDEFINES CREFF.
  4426         10  CREFA PIC  X(0001).
  4427     05  CREFI PIC  X(0012).
  4428*    -------------------------------
  4429     05  CNHINTL PIC S9(0004) COMP.
  4430     05  CNHINTF PIC  X(0001).
  4431     05  FILLER REDEFINES CNHINTF.
  4432         10  CNHINTA PIC  X(0001).
  4433     05  CNHINTI PIC  9(7)V99.
  4434*    -------------------------------
  4435     05  CCERTNOL PIC S9(0004) COMP.
  4436     05  CCERTNOF PIC  X(0001).
  4437     05  FILLER REDEFINES CCERTNOF.
  4438         10  CCERTNOA PIC  X(0001).
  4439     05  CCERTNOI PIC  X(0010).
  4440*    -------------------------------
  4441     05  CSUFIXL PIC S9(0004) COMP.
  4442     05  CSUFIXF PIC  X(0001).
  4443     05  FILLER REDEFINES CSUFIXF.
  4444         10  CSUFIXA PIC  X(0001).
  4445     05  CSUFIXI PIC  X(0001).
  4446*    -------------------------------
  4447     05  CEFFDTL PIC S9(0004) COMP.
  4448     05  CEFFDTF PIC  X(0001).
  4449     05  FILLER REDEFINES CEFFDTF.
  4450         10  CEFFDTA PIC  X(0001).
  4451     05  CEFFDTI PIC  X(0008).
  4452*    -------------------------------
  4453     05  CLSTNML PIC S9(0004) COMP.
  4454     05  CLSTNMF PIC  X(0001).
  4455     05  FILLER REDEFINES CLSTNMF.
  4456         10  CLSTNMA PIC  X(0001).
  4457     05  CLSTNMI PIC  X(0015).
  4458*    -------------------------------
  4459     05  CPCYNL PIC S9(0004) COMP.
  4460     05  CPCYNF PIC  X(0001).
  4461     05  FILLER REDEFINES CPCYNF.
  4462         10  CPCYNA PIC  X(0001).
  4463     05  CPCYNI PIC  X(0001).
  4464*    -------------------------------
  4465     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  85
* EL6311.cbl
  4466     05  CINAMEF PIC  X(0001).
  4467     05  FILLER REDEFINES CINAMEF.
  4468         10  CINAMEA PIC  X(0001).
  4469     05  CINAMEI PIC  X(0015).
  4470*    -------------------------------
  4471     05  CINITSL PIC S9(0004) COMP.
  4472     05  CINITSF PIC  X(0001).
  4473     05  FILLER REDEFINES CINITSF.
  4474         10  CINITSA PIC  X(0001).
  4475     05  CINITSI PIC  X(0010).
  4476*    -------------------------------
  4477     05  CCANREAL PIC S9(0004) COMP.
  4478     05  CCANREAF PIC  X(0001).
  4479     05  FILLER REDEFINES CCANREAF.
  4480         10  CCANREAA PIC  X(0001).
  4481     05  CCANREAI PIC  X(0001).
  4482*    -------------------------------
  4483     05  CKIND1L PIC S9(0004) COMP.
  4484     05  CKIND1F PIC  X(0001).
  4485     05  FILLER REDEFINES CKIND1F.
  4486         10  CKIND1A PIC  X(0001).
  4487     05  CKIND1I PIC  X(0002).
  4488*    -------------------------------
  4489     05  CCANDT1L PIC S9(0004) COMP.
  4490     05  CCANDT1F PIC  X(0001).
  4491     05  FILLER REDEFINES CCANDT1F.
  4492         10  CCANDT1A PIC  X(0001).
  4493     05  CCANDT1I PIC  X(0008).
  4494*    -------------------------------
  4495     05  CREFND1L PIC S9(0004) COMP.
  4496     05  CREFND1F PIC  X(0001).
  4497     05  FILLER REDEFINES CREFND1F.
  4498         10  CREFND1A PIC  X(0001).
  4499     05  CREFND1I PIC  S9(9)V99.
  4500*    -------------------------------
  4501     05  CMTHD1L PIC S9(0004) COMP.
  4502     05  CMTHD1F PIC  X(0001).
  4503     05  FILLER REDEFINES CMTHD1F.
  4504         10  CMTHD1A PIC  X(0001).
  4505     05  CMTHD1I PIC  X(0001).
  4506*    -------------------------------
  4507     05  CKIND2L PIC S9(0004) COMP.
  4508     05  CKIND2F PIC  X(0001).
  4509     05  FILLER REDEFINES CKIND2F.
  4510         10  CKIND2A PIC  X(0001).
  4511     05  CKIND2I PIC  X(0002).
  4512*    -------------------------------
  4513     05  CCANDT2L PIC S9(0004) COMP.
  4514     05  CCANDT2F PIC  X(0001).
  4515     05  FILLER REDEFINES CCANDT2F.
  4516         10  CCANDT2A PIC  X(0001).
  4517     05  CCANDT2I PIC  X(0008).
  4518*    -------------------------------
  4519     05  CREFND2L PIC S9(0004) COMP.
  4520     05  CREFND2F PIC  X(0001).
  4521     05  FILLER REDEFINES CREFND2F.
  4522         10  CREFND2A PIC  X(0001).
  4523     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  86
* EL6311.cbl
  4524*    -------------------------------
  4525     05  CMTHD2L PIC S9(0004) COMP.
  4526     05  CMTHD2F PIC  X(0001).
  4527     05  FILLER REDEFINES CMTHD2F.
  4528         10  CMTHD2A PIC  X(0001).
  4529     05  CMTHD2I PIC  X(0001).
  4530*    -------------------------------
  4531     05  CLIVESL PIC S9(0004) COMP.
  4532     05  CLIVESF PIC  X(0001).
  4533     05  FILLER REDEFINES CLIVESF.
  4534         10  CLIVESA PIC  X(0001).
  4535     05  CLIVESI PIC  X(0003).
  4536*    -------------------------------
  4537     05  CFORCEL PIC S9(0004) COMP.
  4538     05  CFORCEF PIC  X(0001).
  4539     05  FILLER REDEFINES CFORCEF.
  4540         10  CFORCEA PIC  X(0001).
  4541     05  CFORCEI PIC  X(0001).
  4542*    -------------------------------
  4543     05  CBILCDL PIC S9(0004) COMP.
  4544     05  CBILCDF PIC  X(0001).
  4545     05  FILLER REDEFINES CBILCDF.
  4546         10  CBILCDA PIC  X(0001).
  4547     05  CBILCDI PIC  X(0001).
  4548*    -------------------------------
  4549     05  CCRFND1L PIC S9(0004) COMP.
  4550     05  CCRFND1F PIC  X(0001).
  4551     05  FILLER REDEFINES CCRFND1F.
  4552         10  CCRFND1A PIC  X(0001).
  4553     05  CCRFND1I PIC  X(0011).
  4554*    -------------------------------
  4555     05  CCRFND2L PIC S9(0004) COMP.
  4556     05  CCRFND2F PIC  X(0001).
  4557     05  FILLER REDEFINES CCRFND2F.
  4558         10  CCRFND2A PIC  X(0001).
  4559     05  CCRFND2I PIC  X(0011).
  4560*    -------------------------------
  4561     05  CBILIT1L PIC S9(0004) COMP.
  4562     05  CBILIT1F PIC  X(0001).
  4563     05  FILLER REDEFINES CBILIT1F.
  4564         10  CBILIT1A PIC  X(0001).
  4565     05  CBILIT1I PIC  X(0008).
  4566*    -------------------------------
  4567     05  CDRFND1L PIC S9(0004) COMP.
  4568     05  CDRFND1F PIC  X(0001).
  4569     05  FILLER REDEFINES CDRFND1F.
  4570         10  CDRFND1A PIC  X(0001).
  4571     05  CDRFND1I PIC  X(0011).
  4572*    -------------------------------
  4573     05  CBILIT2L PIC S9(0004) COMP.
  4574     05  CBILIT2F PIC  X(0001).
  4575     05  FILLER REDEFINES CBILIT2F.
  4576         10  CBILIT2A PIC  X(0001).
  4577     05  CBILIT2I PIC  X(0008).
  4578*    -------------------------------
  4579     05  CDRFND2L PIC S9(0004) COMP.
  4580     05  CDRFND2F PIC  X(0001).
  4581     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  87
* EL6311.cbl
  4582         10  CDRFND2A PIC  X(0001).
  4583     05  CDRFND2I PIC  X(0011).
  4584*    -------------------------------
  4585     05  CCANTXTL PIC S9(0004) COMP.
  4586     05  CCANTXTF PIC  X(0001).
  4587     05  FILLER REDEFINES CCANTXTF.
  4588         10  CCANTXTA PIC  X(0001).
  4589     05  CCANTXTI PIC  X(0005).
  4590*    -------------------------------
  4591     05  CCANFEEL PIC S9(0004) COMP.
  4592     05  CCANFEEF PIC  X(0001).
  4593     05  FILLER REDEFINES CCANFEEF.
  4594         10  CCANFEEA PIC  X(0001).
  4595     05  CCANFEEI PIC  X(0002).
  4596*    -------------------------------
  4597     05  CTERM1L PIC S9(0004) COMP.
  4598     05  CTERM1F PIC  X(0001).
  4599     05  FILLER REDEFINES CTERM1F.
  4600         10  CTERM1A PIC  X(0001).
  4601     05  CTERM1I PIC  X(0003).
  4602*    -------------------------------
  4603     05  CRTERM1L PIC S9(0004) COMP.
  4604     05  CRTERM1F PIC  X(0001).
  4605     05  FILLER REDEFINES CRTERM1F.
  4606         10  CRTERM1A PIC  X(0001).
  4607     05  CRTERM1I PIC  X(0003).
  4608*    -------------------------------
  4609     05  CPREM1L PIC S9(0004) COMP.
  4610     05  CPREM1F PIC  X(0001).
  4611     05  FILLER REDEFINES CPREM1F.
  4612         10  CPREM1A PIC  X(0001).
  4613     05  CPREM1I PIC  X(0011).
  4614*    -------------------------------
  4615     05  CTERM2L PIC S9(0004) COMP.
  4616     05  CTERM2F PIC  X(0001).
  4617     05  FILLER REDEFINES CTERM2F.
  4618         10  CTERM2A PIC  X(0001).
  4619     05  CTERM2I PIC  X(0003).
  4620*    -------------------------------
  4621     05  CRTERM2L PIC S9(0004) COMP.
  4622     05  CRTERM2F PIC  X(0001).
  4623     05  FILLER REDEFINES CRTERM2F.
  4624         10  CRTERM2A PIC  X(0001).
  4625     05  CRTERM2I PIC  X(0003).
  4626*    -------------------------------
  4627     05  CPREM2L PIC S9(0004) COMP.
  4628     05  CPREM2F PIC  X(0001).
  4629     05  FILLER REDEFINES CPREM2F.
  4630         10  CPREM2A PIC  X(0001).
  4631     05  CPREM2I PIC  X(0011).
  4632*    -------------------------------
  4633     05  CENTRDTL PIC S9(0004) COMP.
  4634     05  CENTRDTF PIC  X(0001).
  4635     05  FILLER REDEFINES CENTRDTF.
  4636         10  CENTRDTA PIC  X(0001).
  4637     05  CENTRDTI PIC  X(0008).
  4638*    -------------------------------
  4639     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  88
* EL6311.cbl
  4640     05  CPAYEEF PIC  X(0001).
  4641     05  FILLER REDEFINES CPAYEEF.
  4642         10  CPAYEEA PIC  X(0001).
  4643     05  CPAYEEI PIC  X(0006).
  4644*    -------------------------------
  4645     05  CRFNDSWL PIC S9(0004) COMP.
  4646     05  CRFNDSWF PIC  X(0001).
  4647     05  FILLER REDEFINES CRFNDSWF.
  4648         10  CRFNDSWA PIC  X(0001).
  4649     05  CRFNDSWI PIC  X(0003).
  4650*    -------------------------------
  4651     05  CLFHDGL PIC S9(0004) COMP.
  4652     05  CLFHDGF PIC  X(0001).
  4653     05  FILLER REDEFINES CLFHDGF.
  4654         10  CLFHDGA PIC  X(0001).
  4655     05  CLFHDGI PIC  X(0006).
  4656*    -------------------------------
  4657     05  CAHHDGL PIC S9(0004) COMP.
  4658     05  CAHHDGF PIC  X(0001).
  4659     05  FILLER REDEFINES CAHHDGF.
  4660         10  CAHHDGA PIC  X(0001).
  4661     05  CAHHDGI PIC  X(0006).
  4662*    -------------------------------
  4663     05  CENTDTL PIC S9(0004) COMP.
  4664     05  CENTDTF PIC  X(0001).
  4665     05  FILLER REDEFINES CENTDTF.
  4666         10  CENTDTA PIC  X(0001).
  4667     05  CENTDTI PIC  X(0008).
  4668*    -------------------------------
  4669     05  CENTBYL PIC S9(0004) COMP.
  4670     05  CENTBYF PIC  X(0001).
  4671     05  FILLER REDEFINES CENTBYF.
  4672         10  CENTBYA PIC  X(0001).
  4673     05  CENTBYI PIC  X(0004).
  4674*    -------------------------------
  4675     05  CCHGCNTL PIC S9(0004) COMP.
  4676     05  CCHGCNTF PIC  X(0001).
  4677     05  FILLER REDEFINES CCHGCNTF.
  4678         10  CCHGCNTA PIC  X(0001).
  4679     05  CCHGCNTI PIC  X(0003).
  4680*    -------------------------------
  4681     05  CLFREFNL PIC S9(0004) COMP.
  4682     05  CLFREFNF PIC  X(0001).
  4683     05  FILLER REDEFINES CLFREFNF.
  4684         10  CLFREFNA PIC  X(0001).
  4685     05  CLFREFNI PIC  X(0006).
  4686*    -------------------------------
  4687     05  CAHREFNL PIC S9(0004) COMP.
  4688     05  CAHREFNF PIC  X(0001).
  4689     05  FILLER REDEFINES CAHREFNF.
  4690         10  CAHREFNA PIC  X(0001).
  4691     05  CAHREFNI PIC  X(0006).
  4692*    -------------------------------
  4693     05  CREINCDL PIC S9(0004) COMP.
  4694     05  CREINCDF PIC  X(0001).
  4695     05  FILLER REDEFINES CREINCDF.
  4696         10  CREINCDA PIC  X(0001).
  4697     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  89
* EL6311.cbl
  4698*    -------------------------------
  4699     05  CAEFFDTL PIC S9(0004) COMP.
  4700     05  CAEFFDTF PIC  X(0001).
  4701     05  FILLER REDEFINES CAEFFDTF.
  4702         10  CAEFFDTA PIC  X(0001).
  4703     05  CAEFFDTI PIC  X(0008).
  4704*    -------------------------------
  4705     05  CAEXPDTL PIC S9(0004) COMP.
  4706     05  CAEXPDTF PIC  X(0001).
  4707     05  FILLER REDEFINES CAEXPDTF.
  4708         10  CAEXPDTA PIC  X(0001).
  4709     05  CAEXPDTI PIC  X(0008).
  4710*    -------------------------------
  4711     05  COMMLFL PIC S9(0004) COMP.
  4712     05  COMMLFF PIC  X(0001).
  4713     05  FILLER REDEFINES COMMLFF.
  4714         10  COMMLFA PIC  X(0001).
  4715     05  COMMLFI PIC  X(0006).
  4716*    -------------------------------
  4717     05  COMMAHL PIC S9(0004) COMP.
  4718     05  COMMAHF PIC  X(0001).
  4719     05  FILLER REDEFINES COMMAHF.
  4720         10  COMMAHA PIC  X(0001).
  4721     05  COMMAHI PIC  X(0006).
  4722*    -------------------------------
  4723     05  CERMSG1L PIC S9(0004) COMP.
  4724     05  CERMSG1F PIC  X(0001).
  4725     05  FILLER REDEFINES CERMSG1F.
  4726         10  CERMSG1A PIC  X(0001).
  4727     05  CERMSG1I PIC  X(0078).
  4728*    -------------------------------
  4729     05  CERMSG2L PIC S9(0004) COMP.
  4730     05  CERMSG2F PIC  X(0001).
  4731     05  FILLER REDEFINES CERMSG2F.
  4732         10  CERMSG2A PIC  X(0001).
  4733     05  CERMSG2I PIC  X(0078).
  4734*    -------------------------------
  4735     05  CERMSG3L PIC S9(0004) COMP.
  4736     05  CERMSG3F PIC  X(0001).
  4737     05  FILLER REDEFINES CERMSG3F.
  4738         10  CERMSG3A PIC  X(0001).
  4739     05  CERMSG3I PIC  X(0078).
  4740*    -------------------------------
  4741     05  CPFENTRL PIC S9(0004) COMP.
  4742     05  CPFENTRF PIC  X(0001).
  4743     05  FILLER REDEFINES CPFENTRF.
  4744         10  CPFENTRA PIC  X(0001).
  4745     05  CPFENTRI PIC  9(2).
  4746*    -------------------------------
  4747     05  CPF5HDRL PIC S9(0004) COMP.
  4748     05  CPF5HDRF PIC  X(0001).
  4749     05  FILLER REDEFINES CPF5HDRF.
  4750         10  CPF5HDRA PIC  X(0001).
  4751     05  CPF5HDRI PIC  X(0005).
  4752*    -------------------------------
  4753     05  CPF4HDRL PIC S9(0004) COMP.
  4754     05  CPF4HDRF PIC  X(0001).
  4755     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  90
* EL6311.cbl
  4756         10  CPF4HDRA PIC  X(0001).
  4757     05  CPF4HDRI PIC  X(0013).
  4758*    -------------------------------
  4759     05  CF15HDRL PIC S9(0004) COMP.
  4760     05  CF15HDRF PIC  X(0001).
  4761     05  FILLER REDEFINES CF15HDRF.
  4762         10  CF15HDRA PIC  X(0001).
  4763     05  CF15HDRI PIC  X(0022).
  4764 01  EL631CO REDEFINES EL631BI.
  4765     05  FILLER            PIC  X(0012).
  4766*    -------------------------------
  4767     05  FILLER            PIC  X(0003).
  4768     05  CDATEO PIC  X(0008).
  4769*    -------------------------------
  4770     05  FILLER            PIC  X(0003).
  4771     05  CTIMEO PIC  99.99.
  4772*    -------------------------------
  4773     05  FILLER            PIC  X(0003).
  4774     05  CHEADO PIC  X(0038).
  4775*    -------------------------------
  4776     05  FILLER            PIC  X(0003).
  4777     05  CCHGTO PIC  X(0004).
  4778*    -------------------------------
  4779     05  FILLER            PIC  X(0003).
  4780     05  CCHGO PIC  ZZZ9.
  4781*    -------------------------------
  4782     05  FILLER            PIC  X(0003).
  4783     05  CMAINTO PIC  X(0001).
  4784*    -------------------------------
  4785     05  FILLER            PIC  X(0003).
  4786     05  CMANTBYO PIC  X(0004).
  4787*    -------------------------------
  4788     05  FILLER            PIC  X(0003).
  4789     05  CCHGHDGO PIC  X(0003).
  4790*    -------------------------------
  4791     05  FILLER            PIC  X(0003).
  4792     05  CMANTDTO PIC  X(0008).
  4793*    -------------------------------
  4794     05  FILLER            PIC  X(0003).
  4795     05  CMANTATO PIC  99.99.
  4796*    -------------------------------
  4797     05  FILLER            PIC  X(0003).
  4798     05  CCSRO PIC  X(0004).
  4799*    -------------------------------
  4800     05  FILLER            PIC  X(0003).
  4801     05  CBATCHO PIC  X(0006).
  4802*    -------------------------------
  4803     05  FILLER            PIC  X(0003).
  4804     05  CSEQO PIC  X(0004).
  4805*    -------------------------------
  4806     05  FILLER            PIC  X(0003).
  4807     05  CMOENDTO PIC  X(0008).
  4808*    -------------------------------
  4809     05  FILLER            PIC  X(0003).
  4810     05  CCARRO PIC  X(0001).
  4811*    -------------------------------
  4812     05  FILLER            PIC  X(0003).
  4813     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  91
* EL6311.cbl
  4814*    -------------------------------
  4815     05  FILLER            PIC  X(0003).
  4816     05  CSTATEO PIC  X(0002).
  4817*    -------------------------------
  4818     05  FILLER            PIC  X(0003).
  4819     05  CACCTO PIC  X(0010).
  4820*    -------------------------------
  4821     05  FILLER            PIC  X(0003).
  4822     05  CORIGHDO PIC  X(0011).
  4823*    -------------------------------
  4824     05  FILLER            PIC  X(0003).
  4825     05  CORGNOO PIC  X(0006).
  4826*    -------------------------------
  4827     05  FILLER            PIC  X(0003).
  4828     05  CORGSEQO PIC  X(0004).
  4829*    -------------------------------
  4830     05  FILLER            PIC  X(0003).
  4831     05  CREFHDGO PIC  X(0010).
  4832*    -------------------------------
  4833     05  FILLER            PIC  X(0003).
  4834     05  CREFO PIC  X(0012).
  4835*    -------------------------------
  4836     05  FILLER            PIC  X(0003).
  4837     05  CNHINTO PIC  999999.99.
  4838*    -------------------------------
  4839     05  FILLER            PIC  X(0003).
  4840     05  CCERTNOO PIC  X(0010).
  4841*    -------------------------------
  4842     05  FILLER            PIC  X(0003).
  4843     05  CSUFIXO PIC  X(0001).
  4844*    -------------------------------
  4845     05  FILLER            PIC  X(0003).
  4846     05  CEFFDTO PIC  X(0008).
  4847*    -------------------------------
  4848     05  FILLER            PIC  X(0003).
  4849     05  CLSTNMO PIC  X(0015).
  4850*    -------------------------------
  4851     05  FILLER            PIC  X(0003).
  4852     05  CPCYNO PIC  X(0001).
  4853*    -------------------------------
  4854     05  FILLER            PIC  X(0003).
  4855     05  CINAMEO PIC  X(0015).
  4856*    -------------------------------
  4857     05  FILLER            PIC  X(0003).
  4858     05  CINITSO PIC  X(0010).
  4859*    -------------------------------
  4860     05  FILLER            PIC  X(0003).
  4861     05  CCANREAO PIC  X(0001).
  4862*    -------------------------------
  4863     05  FILLER            PIC  X(0003).
  4864     05  CKIND1O PIC  X(0002).
  4865*    -------------------------------
  4866     05  FILLER            PIC  X(0003).
  4867     05  CCANDT1O PIC  X(0008).
  4868*    -------------------------------
  4869     05  FILLER            PIC  X(0003).
  4870     05  CREFND1O PIC  Z(7).99-.
  4871*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  92
* EL6311.cbl
  4872     05  FILLER            PIC  X(0003).
  4873     05  CMTHD1O PIC  X(0001).
  4874*    -------------------------------
  4875     05  FILLER            PIC  X(0003).
  4876     05  CKIND2O PIC  X(0002).
  4877*    -------------------------------
  4878     05  FILLER            PIC  X(0003).
  4879     05  CCANDT2O PIC  X(0008).
  4880*    -------------------------------
  4881     05  FILLER            PIC  X(0003).
  4882     05  CREFND2O PIC  Z(7).99-.
  4883*    -------------------------------
  4884     05  FILLER            PIC  X(0003).
  4885     05  CMTHD2O PIC  X(0001).
  4886*    -------------------------------
  4887     05  FILLER            PIC  X(0003).
  4888     05  CLIVESO PIC  X(0003).
  4889*    -------------------------------
  4890     05  FILLER            PIC  X(0003).
  4891     05  CFORCEO PIC  X(0001).
  4892*    -------------------------------
  4893     05  FILLER            PIC  X(0003).
  4894     05  CBILCDO PIC  X(0001).
  4895*    -------------------------------
  4896     05  FILLER            PIC  X(0003).
  4897     05  CCRFND1O PIC  Z(7).99-.
  4898*    -------------------------------
  4899     05  FILLER            PIC  X(0003).
  4900     05  CCRFND2O PIC  Z(7).99-.
  4901*    -------------------------------
  4902     05  FILLER            PIC  X(0003).
  4903     05  CBILIT1O PIC  X(0008).
  4904*    -------------------------------
  4905     05  FILLER            PIC  X(0003).
  4906     05  CDRFND1O PIC  Z(7).99-.
  4907*    -------------------------------
  4908     05  FILLER            PIC  X(0003).
  4909     05  CBILIT2O PIC  X(0008).
  4910*    -------------------------------
  4911     05  FILLER            PIC  X(0003).
  4912     05  CDRFND2O PIC  Z(7).99-.
  4913*    -------------------------------
  4914     05  FILLER            PIC  X(0003).
  4915     05  CCANTXTO PIC  X(0005).
  4916*    -------------------------------
  4917     05  FILLER            PIC  X(0003).
  4918     05  CCANFEEO PIC  Z9.
  4919*    -------------------------------
  4920     05  FILLER            PIC  X(0003).
  4921     05  CTERM1O PIC  ZZ9.
  4922*    -------------------------------
  4923     05  FILLER            PIC  X(0003).
  4924     05  CRTERM1O PIC  ZZ9.
  4925*    -------------------------------
  4926     05  FILLER            PIC  X(0003).
  4927     05  CPREM1O PIC  ZZZZZZ9.99-.
  4928*    -------------------------------
  4929     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  93
* EL6311.cbl
  4930     05  CTERM2O PIC  ZZ9.
  4931*    -------------------------------
  4932     05  FILLER            PIC  X(0003).
  4933     05  CRTERM2O PIC  ZZ9.
  4934*    -------------------------------
  4935     05  FILLER            PIC  X(0003).
  4936     05  CPREM2O PIC  ZZZZZZ9.99-.
  4937*    -------------------------------
  4938     05  FILLER            PIC  X(0003).
  4939     05  CENTRDTO PIC  X(0008).
  4940*    -------------------------------
  4941     05  FILLER            PIC  X(0003).
  4942     05  CPAYEEO PIC  X(0006).
  4943*    -------------------------------
  4944     05  FILLER            PIC  X(0003).
  4945     05  CRFNDSWO PIC  X(0003).
  4946*    -------------------------------
  4947     05  FILLER            PIC  X(0003).
  4948     05  CLFHDGO PIC  X(0006).
  4949*    -------------------------------
  4950     05  FILLER            PIC  X(0003).
  4951     05  CAHHDGO PIC  X(0006).
  4952*    -------------------------------
  4953     05  FILLER            PIC  X(0003).
  4954     05  CENTDTO PIC  X(0008).
  4955*    -------------------------------
  4956     05  FILLER            PIC  X(0003).
  4957     05  CENTBYO PIC  X(0004).
  4958*    -------------------------------
  4959     05  FILLER            PIC  X(0003).
  4960     05  CCHGCNTO PIC  X(0003).
  4961*    -------------------------------
  4962     05  FILLER            PIC  X(0003).
  4963     05  CLFREFNO PIC  X(0006).
  4964*    -------------------------------
  4965     05  FILLER            PIC  X(0003).
  4966     05  CAHREFNO PIC  X(0006).
  4967*    -------------------------------
  4968     05  FILLER            PIC  X(0003).
  4969     05  CREINCDO PIC  X(0003).
  4970*    -------------------------------
  4971     05  FILLER            PIC  X(0003).
  4972     05  CAEFFDTO PIC  X(0008).
  4973*    -------------------------------
  4974     05  FILLER            PIC  X(0003).
  4975     05  CAEXPDTO PIC  X(0008).
  4976*    -------------------------------
  4977     05  FILLER            PIC  X(0003).
  4978     05  COMMLFO PIC  .99999.
  4979*    -------------------------------
  4980     05  FILLER            PIC  X(0003).
  4981     05  COMMAHO PIC  .99999.
  4982*    -------------------------------
  4983     05  FILLER            PIC  X(0003).
  4984     05  CERMSG1O PIC  X(0078).
  4985*    -------------------------------
  4986     05  FILLER            PIC  X(0003).
  4987     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  94
* EL6311.cbl
  4988*    -------------------------------
  4989     05  FILLER            PIC  X(0003).
  4990     05  CERMSG3O PIC  X(0078).
  4991*    -------------------------------
  4992     05  FILLER            PIC  X(0003).
  4993     05  CPFENTRO PIC  X(0002).
  4994*    -------------------------------
  4995     05  FILLER            PIC  X(0003).
  4996     05  CPF5HDRO PIC  X(0005).
  4997*    -------------------------------
  4998     05  FILLER            PIC  X(0003).
  4999     05  CPF4HDRO PIC  X(0013).
  5000*    -------------------------------
  5001     05  FILLER            PIC  X(0003).
  5002     05  CF15HDRO PIC  X(0022).
  5003*    -------------------------------
  5004 01  EL631DI REDEFINES EL631BI.
  5005     05  FILLER            PIC  X(0012).
  5006*    -------------------------------
  5007     05  DDATEL PIC S9(0004) COMP.
  5008     05  DDATEF PIC  X(0001).
  5009     05  FILLER REDEFINES DDATEF.
  5010         10  DDATEA PIC  X(0001).
  5011     05  DDATEI PIC  X(0008).
  5012*    -------------------------------
  5013     05  DTIMEL PIC S9(0004) COMP.
  5014     05  DTIMEF PIC  X(0001).
  5015     05  FILLER REDEFINES DTIMEF.
  5016         10  DTIMEA PIC  X(0001).
  5017     05  DTIMEI PIC  X(0005).
  5018*    -------------------------------
  5019     05  DHEADL PIC S9(0004) COMP.
  5020     05  DHEADF PIC  X(0001).
  5021     05  FILLER REDEFINES DHEADF.
  5022         10  DHEADA PIC  X(0001).
  5023     05  DHEADI PIC  X(0038).
  5024*    -------------------------------
  5025     05  DLDATEL PIC S9(0004) COMP.
  5026     05  DLDATEF PIC  X(0001).
  5027     05  FILLER REDEFINES DLDATEF.
  5028         10  DLDATEA PIC  X(0001).
  5029     05  DLDATEI PIC  X(0010).
  5030*    -------------------------------
  5031     05  DBATCHL PIC S9(0004) COMP.
  5032     05  DBATCHF PIC  X(0001).
  5033     05  FILLER REDEFINES DBATCHF.
  5034         10  DBATCHA PIC  X(0001).
  5035     05  DBATCHI PIC  X(0011).
  5036*    -------------------------------
  5037     05  DACCTNML PIC S9(0004) COMP.
  5038     05  DACCTNMF PIC  X(0001).
  5039     05  FILLER REDEFINES DACCTNMF.
  5040         10  DACCTNMA PIC  X(0001).
  5041     05  DACCTNMI PIC  X(0030).
  5042*    -------------------------------
  5043     05  DPROCDTL PIC S9(0004) COMP.
  5044     05  DPROCDTF PIC  X(0001).
  5045     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  95
* EL6311.cbl
  5046         10  DPROCDTA PIC  X(0001).
  5047     05  DPROCDTI PIC  X(0008).
  5048*    -------------------------------
  5049     05  DINPUTL PIC S9(0004) COMP.
  5050     05  DINPUTF PIC  X(0001).
  5051     05  FILLER REDEFINES DINPUTF.
  5052         10  DINPUTA PIC  X(0001).
  5053     05  DINPUTI PIC  X(0008).
  5054*    -------------------------------
  5055     05  DMAINDTL PIC S9(0004) COMP.
  5056     05  DMAINDTF PIC  X(0001).
  5057     05  FILLER REDEFINES DMAINDTF.
  5058         10  DMAINDTA PIC  X(0001).
  5059     05  DMAINDTI PIC  X(0008).
  5060*    -------------------------------
  5061     05  DCARRL PIC S9(0004) COMP.
  5062     05  DCARRF PIC  X(0001).
  5063     05  FILLER REDEFINES DCARRF.
  5064         10  DCARRA PIC  X(0001).
  5065     05  DCARRI PIC  X(0001).
  5066*    -------------------------------
  5067     05  DGROUPL PIC S9(0004) COMP.
  5068     05  DGROUPF PIC  X(0001).
  5069     05  FILLER REDEFINES DGROUPF.
  5070         10  DGROUPA PIC  X(0001).
  5071     05  DGROUPI PIC  X(0006).
  5072*    -------------------------------
  5073     05  DSTATEL PIC S9(0004) COMP.
  5074     05  DSTATEF PIC  X(0001).
  5075     05  FILLER REDEFINES DSTATEF.
  5076         10  DSTATEA PIC  X(0001).
  5077     05  DSTATEI PIC  X(0002).
  5078*    -------------------------------
  5079     05  DACCTL PIC S9(0004) COMP.
  5080     05  DACCTF PIC  X(0001).
  5081     05  FILLER REDEFINES DACCTF.
  5082         10  DACCTA PIC  X(0001).
  5083     05  DACCTI PIC  X(0010).
  5084*    -------------------------------
  5085     05  DRECVDTL PIC S9(0004) COMP.
  5086     05  DRECVDTF PIC  X(0001).
  5087     05  FILLER REDEFINES DRECVDTF.
  5088         10  DRECVDTA PIC  X(0001).
  5089     05  DRECVDTI PIC  X(0008).
  5090*    -------------------------------
  5091     05  DCSRL PIC S9(0004) COMP.
  5092     05  DCSRF PIC  X(0001).
  5093     05  FILLER REDEFINES DCSRF.
  5094         10  DCSRA PIC  X(0001).
  5095     05  DCSRI PIC  X(0004).
  5096*    -------------------------------
  5097     05  DREFHDGL PIC S9(0004) COMP.
  5098     05  DREFHDGF PIC  X(0001).
  5099     05  FILLER REDEFINES DREFHDGF.
  5100         10  DREFHDGA PIC  X(0001).
  5101     05  DREFHDGI PIC  X(0010).
  5102*    -------------------------------
  5103     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  96
* EL6311.cbl
  5104     05  DREFF PIC  X(0001).
  5105     05  FILLER REDEFINES DREFF.
  5106         10  DREFA PIC  X(0001).
  5107     05  DREFI PIC  X(0012).
  5108*    -------------------------------
  5109     05  DLFPHDGL PIC S9(0004) COMP.
  5110     05  DLFPHDGF PIC  X(0001).
  5111     05  FILLER REDEFINES DLFPHDGF.
  5112         10  DLFPHDGA PIC  X(0001).
  5113     05  DLFPHDGI PIC  X(0010).
  5114*    -------------------------------
  5115     05  DAHPHDGL PIC S9(0004) COMP.
  5116     05  DAHPHDGF PIC  X(0001).
  5117     05  FILLER REDEFINES DAHPHDGF.
  5118         10  DAHPHDGA PIC  X(0001).
  5119     05  DAHPHDGI PIC  X(0010).
  5120*    -------------------------------
  5121     05  DLFRHDGL PIC S9(0004) COMP.
  5122     05  DLFRHDGF PIC  X(0001).
  5123     05  FILLER REDEFINES DLFRHDGF.
  5124         10  DLFRHDGA PIC  X(0001).
  5125     05  DLFRHDGI PIC  X(0009).
  5126*    -------------------------------
  5127     05  DAHRHDGL PIC S9(0004) COMP.
  5128     05  DAHRHDGF PIC  X(0001).
  5129     05  FILLER REDEFINES DAHRHDGF.
  5130         10  DAHRHDGA PIC  X(0001).
  5131     05  DAHRHDGI PIC  X(0009).
  5132*    -------------------------------
  5133     05  DRISSL PIC S9(0004) COMP.
  5134     05  DRISSF PIC  X(0001).
  5135     05  FILLER REDEFINES DRISSF.
  5136         10  DRISSA PIC  X(0001).
  5137     05  DRISSI PIC  X(0005).
  5138*    -------------------------------
  5139     05  DRLFPRML PIC S9(0004) COMP.
  5140     05  DRLFPRMF PIC  X(0001).
  5141     05  FILLER REDEFINES DRLFPRMF.
  5142         10  DRLFPRMA PIC  X(0001).
  5143     05  DRLFPRMI PIC  S9(9)V99.
  5144*    -------------------------------
  5145     05  DRAHPRML PIC S9(0004) COMP.
  5146     05  DRAHPRMF PIC  X(0001).
  5147     05  FILLER REDEFINES DRAHPRMF.
  5148         10  DRAHPRMA PIC  X(0001).
  5149     05  DRAHPRMI PIC  S9(9)V99.
  5150*    -------------------------------
  5151     05  DRCANCL PIC S9(0004) COMP.
  5152     05  DRCANCF PIC  X(0001).
  5153     05  FILLER REDEFINES DRCANCF.
  5154         10  DRCANCA PIC  X(0001).
  5155     05  DRCANCI PIC  X(0005).
  5156*    -------------------------------
  5157     05  DRLFRFDL PIC S9(0004) COMP.
  5158     05  DRLFRFDF PIC  X(0001).
  5159     05  FILLER REDEFINES DRLFRFDF.
  5160         10  DRLFRFDA PIC  X(0001).
  5161     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  97
* EL6311.cbl
  5162*    -------------------------------
  5163     05  DRAHRFDL PIC S9(0004) COMP.
  5164     05  DRAHRFDF PIC  X(0001).
  5165     05  FILLER REDEFINES DRAHRFDF.
  5166         10  DRAHRFDA PIC  X(0001).
  5167     05  DRAHRFDI PIC  S9(9)V99.
  5168*    -------------------------------
  5169     05  DEISSL PIC S9(0004) COMP.
  5170     05  DEISSF PIC  X(0001).
  5171     05  FILLER REDEFINES DEISSF.
  5172         10  DEISSA PIC  X(0001).
  5173     05  DEISSI PIC  X(0005).
  5174*    -------------------------------
  5175     05  DELFPRML PIC S9(0004) COMP.
  5176     05  DELFPRMF PIC  X(0001).
  5177     05  FILLER REDEFINES DELFPRMF.
  5178         10  DELFPRMA PIC  X(0001).
  5179     05  DELFPRMI PIC  X(0011).
  5180*    -------------------------------
  5181     05  DEAHPRML PIC S9(0004) COMP.
  5182     05  DEAHPRMF PIC  X(0001).
  5183     05  FILLER REDEFINES DEAHPRMF.
  5184         10  DEAHPRMA PIC  X(0001).
  5185     05  DEAHPRMI PIC  X(0011).
  5186*    -------------------------------
  5187     05  DECANCL PIC S9(0004) COMP.
  5188     05  DECANCF PIC  X(0001).
  5189     05  FILLER REDEFINES DECANCF.
  5190         10  DECANCA PIC  X(0001).
  5191     05  DECANCI PIC  X(0005).
  5192*    -------------------------------
  5193     05  DELFRFDL PIC S9(0004) COMP.
  5194     05  DELFRFDF PIC  X(0001).
  5195     05  FILLER REDEFINES DELFRFDF.
  5196         10  DELFRFDA PIC  X(0001).
  5197     05  DELFRFDI PIC  X(0011).
  5198*    -------------------------------
  5199     05  DEAHRFDL PIC S9(0004) COMP.
  5200     05  DEAHRFDF PIC  X(0001).
  5201     05  FILLER REDEFINES DEAHRFDF.
  5202         10  DEAHRFDA PIC  X(0001).
  5203     05  DEAHRFDI PIC  X(0011).
  5204*    -------------------------------
  5205     05  DCISSL PIC S9(0004) COMP.
  5206     05  DCISSF PIC  X(0001).
  5207     05  FILLER REDEFINES DCISSF.
  5208         10  DCISSA PIC  X(0001).
  5209     05  DCISSI PIC  X(0005).
  5210*    -------------------------------
  5211     05  DCLFPRML PIC S9(0004) COMP.
  5212     05  DCLFPRMF PIC  X(0001).
  5213     05  FILLER REDEFINES DCLFPRMF.
  5214         10  DCLFPRMA PIC  X(0001).
  5215     05  DCLFPRMI PIC  X(0011).
  5216*    -------------------------------
  5217     05  DCAHPRML PIC S9(0004) COMP.
  5218     05  DCAHPRMF PIC  X(0001).
  5219     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  98
* EL6311.cbl
  5220         10  DCAHPRMA PIC  X(0001).
  5221     05  DCAHPRMI PIC  X(0011).
  5222*    -------------------------------
  5223     05  DCCANCL PIC S9(0004) COMP.
  5224     05  DCCANCF PIC  X(0001).
  5225     05  FILLER REDEFINES DCCANCF.
  5226         10  DCCANCA PIC  X(0001).
  5227     05  DCCANCI PIC  X(0005).
  5228*    -------------------------------
  5229     05  DCLFRFDL PIC S9(0004) COMP.
  5230     05  DCLFRFDF PIC  X(0001).
  5231     05  FILLER REDEFINES DCLFRFDF.
  5232         10  DCLFRFDA PIC  X(0001).
  5233     05  DCLFRFDI PIC  X(0011).
  5234*    -------------------------------
  5235     05  DCAHRFDL PIC S9(0004) COMP.
  5236     05  DCAHRFDF PIC  X(0001).
  5237     05  FILLER REDEFINES DCAHRFDF.
  5238         10  DCAHRFDA PIC  X(0001).
  5239     05  DCAHRFDI PIC  X(0011).
  5240*    -------------------------------
  5241     05  DOISSL PIC S9(0004) COMP.
  5242     05  DOISSF PIC  X(0001).
  5243     05  FILLER REDEFINES DOISSF.
  5244         10  DOISSA PIC  X(0001).
  5245     05  DOISSI PIC  X(0005).
  5246*    -------------------------------
  5247     05  DOLFPRML PIC S9(0004) COMP.
  5248     05  DOLFPRMF PIC  X(0001).
  5249     05  FILLER REDEFINES DOLFPRMF.
  5250         10  DOLFPRMA PIC  X(0001).
  5251     05  DOLFPRMI PIC  X(0011).
  5252*    -------------------------------
  5253     05  DOAHPRML PIC S9(0004) COMP.
  5254     05  DOAHPRMF PIC  X(0001).
  5255     05  FILLER REDEFINES DOAHPRMF.
  5256         10  DOAHPRMA PIC  X(0001).
  5257     05  DOAHPRMI PIC  X(0011).
  5258*    -------------------------------
  5259     05  DOCANCL PIC S9(0004) COMP.
  5260     05  DOCANCF PIC  X(0001).
  5261     05  FILLER REDEFINES DOCANCF.
  5262         10  DOCANCA PIC  X(0001).
  5263     05  DOCANCI PIC  X(0005).
  5264*    -------------------------------
  5265     05  DOLFRFDL PIC S9(0004) COMP.
  5266     05  DOLFRFDF PIC  X(0001).
  5267     05  FILLER REDEFINES DOLFRFDF.
  5268         10  DOLFRFDA PIC  X(0001).
  5269     05  DOLFRFDI PIC  X(0011).
  5270*    -------------------------------
  5271     05  DOAHRFDL PIC S9(0004) COMP.
  5272     05  DOAHRFDF PIC  X(0001).
  5273     05  FILLER REDEFINES DOAHRFDF.
  5274         10  DOAHRFDA PIC  X(0001).
  5275     05  DOAHRFDI PIC  X(0011).
  5276*    -------------------------------
  5277     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  99
* EL6311.cbl
  5278     05  DITOTALF PIC  X(0001).
  5279     05  FILLER REDEFINES DITOTALF.
  5280         10  DITOTALA PIC  X(0001).
  5281     05  DITOTALI PIC  X(0005).
  5282*    -------------------------------
  5283     05  DIFATALL PIC S9(0004) COMP.
  5284     05  DIFATALF PIC  X(0001).
  5285     05  FILLER REDEFINES DIFATALF.
  5286         10  DIFATALA PIC  X(0001).
  5287     05  DIFATALI PIC  X(0005).
  5288*    -------------------------------
  5289     05  DIFORCEL PIC S9(0004) COMP.
  5290     05  DIFORCEF PIC  X(0001).
  5291     05  FILLER REDEFINES DIFORCEF.
  5292         10  DIFORCEA PIC  X(0001).
  5293     05  DIFORCEI PIC  X(0005).
  5294*    -------------------------------
  5295     05  DIHOLDL PIC S9(0004) COMP.
  5296     05  DIHOLDF PIC  X(0001).
  5297     05  FILLER REDEFINES DIHOLDF.
  5298         10  DIHOLDA PIC  X(0001).
  5299     05  DIHOLDI PIC  X(0005).
  5300*    -------------------------------
  5301     05  DIAVAILL PIC S9(0004) COMP.
  5302     05  DIAVAILF PIC  X(0001).
  5303     05  FILLER REDEFINES DIAVAILF.
  5304         10  DIAVAILA PIC  X(0001).
  5305     05  DIAVAILI PIC  X(0005).
  5306*    -------------------------------
  5307     05  DIGPREML PIC S9(0004) COMP.
  5308     05  DIGPREMF PIC  X(0001).
  5309     05  FILLER REDEFINES DIGPREMF.
  5310         10  DIGPREMA PIC  X(0001).
  5311     05  DIGPREMI PIC  X(0011).
  5312*    -------------------------------
  5313     05  DIBPREML PIC S9(0004) COMP.
  5314     05  DIBPREMF PIC  X(0001).
  5315     05  FILLER REDEFINES DIBPREMF.
  5316         10  DIBPREMA PIC  X(0001).
  5317     05  DIBPREMI PIC  X(0011).
  5318*    -------------------------------
  5319     05  DCTOTALL PIC S9(0004) COMP.
  5320     05  DCTOTALF PIC  X(0001).
  5321     05  FILLER REDEFINES DCTOTALF.
  5322         10  DCTOTALA PIC  X(0001).
  5323     05  DCTOTALI PIC  X(0005).
  5324*    -------------------------------
  5325     05  DCFATALL PIC S9(0004) COMP.
  5326     05  DCFATALF PIC  X(0001).
  5327     05  FILLER REDEFINES DCFATALF.
  5328         10  DCFATALA PIC  X(0001).
  5329     05  DCFATALI PIC  X(0005).
  5330*    -------------------------------
  5331     05  DCFORCEL PIC S9(0004) COMP.
  5332     05  DCFORCEF PIC  X(0001).
  5333     05  FILLER REDEFINES DCFORCEF.
  5334         10  DCFORCEA PIC  X(0001).
  5335     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 100
* EL6311.cbl
  5336*    -------------------------------
  5337     05  DCHOLDL PIC S9(0004) COMP.
  5338     05  DCHOLDF PIC  X(0001).
  5339     05  FILLER REDEFINES DCHOLDF.
  5340         10  DCHOLDA PIC  X(0001).
  5341     05  DCHOLDI PIC  X(0005).
  5342*    -------------------------------
  5343     05  DCAVAILL PIC S9(0004) COMP.
  5344     05  DCAVAILF PIC  X(0001).
  5345     05  FILLER REDEFINES DCAVAILF.
  5346         10  DCAVAILA PIC  X(0001).
  5347     05  DCAVAILI PIC  X(0005).
  5348*    -------------------------------
  5349     05  DCGPREML PIC S9(0004) COMP.
  5350     05  DCGPREMF PIC  X(0001).
  5351     05  FILLER REDEFINES DCGPREMF.
  5352         10  DCGPREMA PIC  X(0001).
  5353     05  DCGPREMI PIC  X(0011).
  5354*    -------------------------------
  5355     05  DCBPREML PIC S9(0004) COMP.
  5356     05  DCBPREMF PIC  X(0001).
  5357     05  FILLER REDEFINES DCBPREMF.
  5358         10  DCBPREMA PIC  X(0001).
  5359     05  DCBPREMI PIC  X(0011).
  5360*    -------------------------------
  5361     05  DNTOTALL PIC S9(0004) COMP.
  5362     05  DNTOTALF PIC  X(0001).
  5363     05  FILLER REDEFINES DNTOTALF.
  5364         10  DNTOTALA PIC  X(0001).
  5365     05  DNTOTALI PIC  X(0005).
  5366*    -------------------------------
  5367     05  DNFATALL PIC S9(0004) COMP.
  5368     05  DNFATALF PIC  X(0001).
  5369     05  FILLER REDEFINES DNFATALF.
  5370         10  DNFATALA PIC  X(0001).
  5371     05  DNFATALI PIC  X(0005).
  5372*    -------------------------------
  5373     05  DNFORCEL PIC S9(0004) COMP.
  5374     05  DNFORCEF PIC  X(0001).
  5375     05  FILLER REDEFINES DNFORCEF.
  5376         10  DNFORCEA PIC  X(0001).
  5377     05  DNFORCEI PIC  X(0005).
  5378*    -------------------------------
  5379     05  DNHOLDL PIC S9(0004) COMP.
  5380     05  DNHOLDF PIC  X(0001).
  5381     05  FILLER REDEFINES DNHOLDF.
  5382         10  DNHOLDA PIC  X(0001).
  5383     05  DNHOLDI PIC  X(0005).
  5384*    -------------------------------
  5385     05  DNAVAILL PIC S9(0004) COMP.
  5386     05  DNAVAILF PIC  X(0001).
  5387     05  FILLER REDEFINES DNAVAILF.
  5388         10  DNAVAILA PIC  X(0001).
  5389     05  DNAVAILI PIC  X(0005).
  5390*    -------------------------------
  5391     05  DNGPREML PIC S9(0004) COMP.
  5392     05  DNGPREMF PIC  X(0001).
  5393     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 101
* EL6311.cbl
  5394         10  DNGPREMA PIC  X(0001).
  5395     05  DNGPREMI PIC  X(0011).
  5396*    -------------------------------
  5397     05  DNBPREML PIC S9(0004) COMP.
  5398     05  DNBPREMF PIC  X(0001).
  5399     05  FILLER REDEFINES DNBPREMF.
  5400         10  DNBPREMA PIC  X(0001).
  5401     05  DNBPREMI PIC  X(0011).
  5402*    -------------------------------
  5403     05  DERMSGL PIC S9(0004) COMP.
  5404     05  DERMSGF PIC  X(0001).
  5405     05  FILLER REDEFINES DERMSGF.
  5406         10  DERMSGA PIC  X(0001).
  5407     05  DERMSGI PIC  X(0075).
  5408*    -------------------------------
  5409     05  DPFENTRL PIC S9(0004) COMP.
  5410     05  DPFENTRF PIC  X(0001).
  5411     05  FILLER REDEFINES DPFENTRF.
  5412         10  DPFENTRA PIC  X(0001).
  5413     05  DPFENTRI PIC  9(2).
  5414 01  EL631DO REDEFINES EL631BI.
  5415     05  FILLER            PIC  X(0012).
  5416*    -------------------------------
  5417     05  FILLER            PIC  X(0003).
  5418     05  DDATEO PIC  X(0008).
  5419*    -------------------------------
  5420     05  FILLER            PIC  X(0003).
  5421     05  DTIMEO PIC  99.99.
  5422*    -------------------------------
  5423     05  FILLER            PIC  X(0003).
  5424     05  DHEADO PIC  X(0038).
  5425*    -------------------------------
  5426     05  FILLER            PIC  X(0003).
  5427     05  DLDATEO PIC  X(0010).
  5428*    -------------------------------
  5429     05  FILLER            PIC  X(0003).
  5430     05  DBATCHO PIC  X(0011).
  5431*    -------------------------------
  5432     05  FILLER            PIC  X(0003).
  5433     05  DACCTNMO PIC  X(0030).
  5434*    -------------------------------
  5435     05  FILLER            PIC  X(0003).
  5436     05  DPROCDTO PIC  X(0008).
  5437*    -------------------------------
  5438     05  FILLER            PIC  X(0003).
  5439     05  DINPUTO PIC  X(0008).
  5440*    -------------------------------
  5441     05  FILLER            PIC  X(0003).
  5442     05  DMAINDTO PIC  X(0008).
  5443*    -------------------------------
  5444     05  FILLER            PIC  X(0003).
  5445     05  DCARRO PIC  X(0001).
  5446*    -------------------------------
  5447     05  FILLER            PIC  X(0003).
  5448     05  DGROUPO PIC  X(0006).
  5449*    -------------------------------
  5450     05  FILLER            PIC  X(0003).
  5451     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 102
* EL6311.cbl
  5452*    -------------------------------
  5453     05  FILLER            PIC  X(0003).
  5454     05  DACCTO PIC  X(0010).
  5455*    -------------------------------
  5456     05  FILLER            PIC  X(0003).
  5457     05  DRECVDTO PIC  X(0008).
  5458*    -------------------------------
  5459     05  FILLER            PIC  X(0003).
  5460     05  DCSRO PIC  X(0004).
  5461*    -------------------------------
  5462     05  FILLER            PIC  X(0003).
  5463     05  DREFHDGO PIC  X(0010).
  5464*    -------------------------------
  5465     05  FILLER            PIC  X(0003).
  5466     05  DREFO PIC  X(0012).
  5467*    -------------------------------
  5468     05  FILLER            PIC  X(0003).
  5469     05  DLFPHDGO PIC  X(0010).
  5470*    -------------------------------
  5471     05  FILLER            PIC  X(0003).
  5472     05  DAHPHDGO PIC  X(0010).
  5473*    -------------------------------
  5474     05  FILLER            PIC  X(0003).
  5475     05  DLFRHDGO PIC  X(0009).
  5476*    -------------------------------
  5477     05  FILLER            PIC  X(0003).
  5478     05  DAHRHDGO PIC  X(0009).
  5479*    -------------------------------
  5480     05  FILLER            PIC  X(0003).
  5481     05  DRISSO PIC  ZZ99-.
  5482*    -------------------------------
  5483     05  FILLER            PIC  X(0003).
  5484     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5485*    -------------------------------
  5486     05  FILLER            PIC  X(0003).
  5487     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5488*    -------------------------------
  5489     05  FILLER            PIC  X(0003).
  5490     05  DRCANCO PIC  ZZ99-.
  5491*    -------------------------------
  5492     05  FILLER            PIC  X(0003).
  5493     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5494*    -------------------------------
  5495     05  FILLER            PIC  X(0003).
  5496     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5497*    -------------------------------
  5498     05  FILLER            PIC  X(0003).
  5499     05  DEISSO PIC  ZZ99-.
  5500*    -------------------------------
  5501     05  FILLER            PIC  X(0003).
  5502     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5503*    -------------------------------
  5504     05  FILLER            PIC  X(0003).
  5505     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5506*    -------------------------------
  5507     05  FILLER            PIC  X(0003).
  5508     05  DECANCO PIC  ZZ99-.
  5509*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 103
* EL6311.cbl
  5510     05  FILLER            PIC  X(0003).
  5511     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5512*    -------------------------------
  5513     05  FILLER            PIC  X(0003).
  5514     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5515*    -------------------------------
  5516     05  FILLER            PIC  X(0003).
  5517     05  DCISSO PIC  ZZ99-.
  5518*    -------------------------------
  5519     05  FILLER            PIC  X(0003).
  5520     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5521*    -------------------------------
  5522     05  FILLER            PIC  X(0003).
  5523     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5524*    -------------------------------
  5525     05  FILLER            PIC  X(0003).
  5526     05  DCCANCO PIC  ZZ99-.
  5527*    -------------------------------
  5528     05  FILLER            PIC  X(0003).
  5529     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5530*    -------------------------------
  5531     05  FILLER            PIC  X(0003).
  5532     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5533*    -------------------------------
  5534     05  FILLER            PIC  X(0003).
  5535     05  DOISSO PIC  ZZ99-.
  5536*    -------------------------------
  5537     05  FILLER            PIC  X(0003).
  5538     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5539*    -------------------------------
  5540     05  FILLER            PIC  X(0003).
  5541     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5542*    -------------------------------
  5543     05  FILLER            PIC  X(0003).
  5544     05  DOCANCO PIC  ZZ99-.
  5545*    -------------------------------
  5546     05  FILLER            PIC  X(0003).
  5547     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5548*    -------------------------------
  5549     05  FILLER            PIC  X(0003).
  5550     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5551*    -------------------------------
  5552     05  FILLER            PIC  X(0003).
  5553     05  DITOTALO PIC  ZZZ99.
  5554*    -------------------------------
  5555     05  FILLER            PIC  X(0003).
  5556     05  DIFATALO PIC  ZZZ99.
  5557*    -------------------------------
  5558     05  FILLER            PIC  X(0003).
  5559     05  DIFORCEO PIC  ZZZ99.
  5560*    -------------------------------
  5561     05  FILLER            PIC  X(0003).
  5562     05  DIHOLDO PIC  ZZZ99.
  5563*    -------------------------------
  5564     05  FILLER            PIC  X(0003).
  5565     05  DIAVAILO PIC  ZZZ99.
  5566*    -------------------------------
  5567     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 104
* EL6311.cbl
  5568     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5569*    -------------------------------
  5570     05  FILLER            PIC  X(0003).
  5571     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5572*    -------------------------------
  5573     05  FILLER            PIC  X(0003).
  5574     05  DCTOTALO PIC  ZZZ99.
  5575*    -------------------------------
  5576     05  FILLER            PIC  X(0003).
  5577     05  DCFATALO PIC  ZZZ99.
  5578*    -------------------------------
  5579     05  FILLER            PIC  X(0003).
  5580     05  DCFORCEO PIC  ZZZ99.
  5581*    -------------------------------
  5582     05  FILLER            PIC  X(0003).
  5583     05  DCHOLDO PIC  ZZZ99.
  5584*    -------------------------------
  5585     05  FILLER            PIC  X(0003).
  5586     05  DCAVAILO PIC  ZZZ99.
  5587*    -------------------------------
  5588     05  FILLER            PIC  X(0003).
  5589     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5590*    -------------------------------
  5591     05  FILLER            PIC  X(0003).
  5592     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5593*    -------------------------------
  5594     05  FILLER            PIC  X(0003).
  5595     05  DNTOTALO PIC  ---99.
  5596*    -------------------------------
  5597     05  FILLER            PIC  X(0003).
  5598     05  DNFATALO PIC  ---99.
  5599*    -------------------------------
  5600     05  FILLER            PIC  X(0003).
  5601     05  DNFORCEO PIC  ---99.
  5602*    -------------------------------
  5603     05  FILLER            PIC  X(0003).
  5604     05  DNHOLDO PIC  ---99.
  5605*    -------------------------------
  5606     05  FILLER            PIC  X(0003).
  5607     05  DNAVAILO PIC  ---99.
  5608*    -------------------------------
  5609     05  FILLER            PIC  X(0003).
  5610     05  DNGPREMO PIC  -------9.99.
  5611*    -------------------------------
  5612     05  FILLER            PIC  X(0003).
  5613     05  DNBPREMO PIC  -------9.99.
  5614*    -------------------------------
  5615     05  FILLER            PIC  X(0003).
  5616     05  DERMSGO PIC  X(0075).
  5617*    -------------------------------
  5618     05  FILLER            PIC  X(0003).
  5619     05  DPFENTRO PIC  X(0002).
  5620*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 105
* EL6311.cbl
  5622 01  MAP-B REDEFINES EL631BI.
  5623     12  FILLER                  PIC X(569).
  5624*    12  FILLER                  PIC X(512).
  5625*    12  FILLER                  PIC X(510).
  5626     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5627         16  BKIND-LEN               PIC S9(4)  COMP.
  5628         16  BKIND-ATTRB             PIC X.
  5629         16  BKIND                   PIC XX.
  5630         16  BTYPE-LEN               PIC S9(4)  COMP.
  5631         16  BTYPE-ATTRB             PIC X.
  5632         16  BTYPE                   PIC X(3).
  5633         16  BTERM-LEN               PIC S9(4)  COMP.
  5634         16  BTERM-ATTRB             PIC X.
  5635         16  BTERMI                  PIC 999.
  5636         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5637         16  BBEN-LEN                PIC S9(4)  COMP.
  5638         16  BBEN-ATTRB              PIC X.
  5639         16  BBENI                   PIC 9(10)V99.
  5640*        16  BBENI                   PIC 9(12).
  5641         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5642         16  BPREM-LEN               PIC S9(4)  COMP.
  5643         16  BPREM-ATTRB             PIC X.
  5644         16  BPREMI                  PIC S9(9)V99.
  5645*        16  BPREMI                  PIC 9(11).
  5646         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5647         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5648         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5649         16  BEXPIRE-ATTRB           PIC X.
  5650         16  BEXPIRE                 PIC X(8).
  5651         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5652         16  BCRIT-PERD-ATTRB        PIC X.
  5653         16  BCRIT-PERDI             PIC 99.
  5654         16  BCRIT-PERDO REDEFINES
  5655                         BCRIT-PERDI PIC ZZ.
  5656         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5657         16  BALT-BEN-ATTRB          PIC X.
  5658         16  BALT-BENI               PIC 9(10)V99.
  5659*        16  BALT-BENI               PIC 9(12).
  5660         16  BALT-BENO REDEFINES
  5661                           BALT-BENI PIC Z(9).ZZ.
  5662         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5663         16  BALT-PREM-ATTRB         PIC X.
  5664         16  BALT-PREMI              PIC 9(9)V99.
  5665*        16  BALT-PREMI              PIC 9(11).
  5666         16  BALT-PREMO REDEFINES
  5667                          BALT-PREMI PIC Z(7).ZZ-.
  5668         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5669         16  BBEN-CD-ATTRB           PIC X.
  5670         16  BBEN-CD                 PIC XXX.
  5671         16  BCPREM-LEN              PIC S9(4)  COMP.
  5672         16  BCPREM-ATTRB            PIC X.
  5673         16  BCPREMI                 PIC S9(9)V99.
  5674*        16  BCPREMI                 PIC X(11).
  5675         16  BCPREMO REDEFINES BCPREMI
  5676                                     PIC Z(7).99-.
  5677         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5678         16  BCALT-PREM-ATTRB        PIC X.
  5679         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 106
* EL6311.cbl
  5680         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5681         16  BBEN-ABBR-ATTRB         PIC X.
  5682         16  BBEN-ABBR               PIC X(5).
  5683         16  BDIFF-LEN               PIC S9(4)  COMP.
  5684         16  BDIFF-ATTRB             PIC X.
  5685         16  BDIFFO                  PIC Z(7).99-.
  5686         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5687         16  BBILL-LIT-ATTRB         PIC X.
  5688         16  BBILL-LIT               PIC X(8).
  5689         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5690         16  BDALT-PREM-ATTRB        PIC X.
  5691         16  BDALT-PREM              PIC Z(7).99-.
  5692
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 107
* EL6311.cbl
  5694
  5695****************************************************************
  5696*
  5697* Copyright (c) 2007 by Clerity Solutions, Inc.
  5698* All rights reserved.
  5699*
  5700****************************************************************
  5701 01  DFHEIV.
  5702   02  DFHEIV0               PIC X(35).
  5703   02  DFHEIV1               PIC X(08).
  5704   02  DFHEIV2               PIC X(08).
  5705   02  DFHEIV3               PIC X(08).
  5706   02  DFHEIV4               PIC X(06).
  5707   02  DFHEIV5               PIC X(04).
  5708   02  DFHEIV6               PIC X(04).
  5709   02  DFHEIV7               PIC X(02).
  5710   02  DFHEIV8               PIC X(02).
  5711   02  DFHEIV9               PIC X(01).
  5712   02  DFHEIV10              PIC S9(7) COMP-3.
  5713   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5714   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5715   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5716   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5717   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5718   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5719   02  DFHEIV17              PIC X(04).
  5720   02  DFHEIV18              PIC X(04).
  5721   02  DFHEIV19              PIC X(04).
  5722   02  DFHEIV20              USAGE IS POINTER.
  5723   02  DFHEIV21              USAGE IS POINTER.
  5724   02  DFHEIV22              USAGE IS POINTER.
  5725   02  DFHEIV23              USAGE IS POINTER.
  5726   02  DFHEIV24              USAGE IS POINTER.
  5727   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5728   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5729   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5730   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5731   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5732   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5733   02  FILLER                PIC X(02).
  5734   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5735   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5736   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5737   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5738   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5739 LINKAGE  SECTION.
  5740*****************************************************************
  5741*                                                               *
  5742* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5743* All rights reserved.                                          *
  5744*                                                               *
  5745*****************************************************************
  5746 01  dfheiblk.
  5747     02  eibtime          pic s9(7) comp-3.
  5748     02  eibdate          pic s9(7) comp-3.
  5749     02  eibtrnid         pic x(4).
  5750     02  eibtaskn         pic s9(7) comp-3.
  5751     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 108
* EL6311.cbl
  5752     02  dfheigdi         pic s9(4) comp.
  5753     02  eibcposn         pic s9(4) comp.
  5754     02  eibcalen         pic s9(4) comp.
  5755     02  eibaid           pic x(1).
  5756     02  eibfiller1       pic x(1).
  5757     02  eibfn            pic x(2).
  5758     02  eibfiller2       pic x(2).
  5759     02  eibrcode         pic x(6).
  5760     02  eibfiller3       pic x(2).
  5761     02  eibds            pic x(8).
  5762     02  eibreqid         pic x(8).
  5763     02  eibrsrce         pic x(8).
  5764     02  eibsync          pic x(1).
  5765     02  eibfree          pic x(1).
  5766     02  eibrecv          pic x(1).
  5767     02  eibsend          pic x(1).
  5768     02  eibatt           pic x(1).
  5769     02  eibeoc           pic x(1).
  5770     02  eibfmh           pic x(1).
  5771     02  eibcompl         pic x(1).
  5772     02  eibsig           pic x(1).
  5773     02  eibconf          pic x(1).
  5774     02  eiberr           pic x(1).
  5775     02  eibrldbk         pic x(1).
  5776     02  eiberrcd         pic x(4).
  5777     02  eibsynrb         pic x(1).
  5778     02  eibnodat         pic x(1).
  5779     02  eibfiller5       pic x(2).
  5780     02  eibresp          pic 9(09) comp.
  5781     02  eibresp2         pic 9(09) comp.
  5782     02  dfheigdj         pic s9(4) comp.
  5783     02  dfheigdk         pic s9(4) comp.
  5784 01  DFHCOMMAREA                 PIC X(1300).
  5785*                                COPY ERCPNDB.
  5786******************************************************************
  5787*                                                                *
  5788*                                                                *
  5789*                            ERCPNDB.                            *
  5790*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5791*                            VMOD=2.025                          *
  5792*                                                                *
  5793*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5794*                                                                *
  5795******************************************************************
  5796*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5797*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5798******************************************************************
  5799*                                                                *
  5800*                                                                *
  5801*   FILE TYPE = VSAM,KSDS                                        *
  5802*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5803*                                                                *
  5804*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5805*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5806*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5807*                                                 RKP=13,LEN=36  *
  5808*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5809*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 109
* EL6311.cbl
  5810*                                                RKP=49,LEN=11   *
  5811*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5812*                                      AND CHG-SEQ.)             *
  5813*                                                RKP=60,LEN=15   *
  5814*                                                                *
  5815*   LOG = NO                                                     *
  5816*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5817******************************************************************
  5818******************************************************************
  5819*                   C H A N G E   L O G
  5820*
  5821* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5822*-----------------------------------------------------------------
  5823*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5824* EFFECTIVE    NUMBER
  5825*-----------------------------------------------------------------
  5826* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5827* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5828* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5829* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5830* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5831* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5832* 032306                   PEMA  ADD BOW LOAN NUMBER
  5833* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5834* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5835* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5836* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5837* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5838* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5839* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5840* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5841******************************************************************
  5842
  5843 01  PENDING-BUSINESS.
  5844     12  PB-RECORD-ID                     PIC XX.
  5845         88  VALID-PB-ID                        VALUE 'PB'.
  5846
  5847     12  PB-CONTROL-PRIMARY.
  5848         16  PB-COMPANY-CD                PIC X.
  5849         16  PB-ENTRY-BATCH               PIC X(6).
  5850         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5851         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5852
  5853     12  PB-CONTROL-BY-ACCOUNT.
  5854         16  PB-COMPANY-CD-A1             PIC X.
  5855         16  PB-CARRIER                   PIC X.
  5856         16  PB-GROUPING.
  5857             20  PB-GROUPING-PREFIX       PIC XXX.
  5858             20  PB-GROUPING-PRIME        PIC XXX.
  5859         16  PB-STATE                     PIC XX.
  5860         16  PB-ACCOUNT.
  5861             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5862             20  PB-ACCOUNT-PRIME         PIC X(6).
  5863         16  PB-CERT-EFF-DT               PIC XX.
  5864         16  PB-CERT-NO.
  5865             20  PB-CERT-PRIME            PIC X(10).
  5866             20  PB-CERT-SFX              PIC X.
  5867         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 110
* EL6311.cbl
  5868
  5869         16  PB-RECORD-TYPE               PIC X.
  5870             88  PB-MAILING-DATA                VALUE '0'.
  5871             88  PB-ISSUE                       VALUE '1'.
  5872             88  PB-CANCELLATION                VALUE '2'.
  5873             88  PB-BATCH-TRAILER               VALUE '9'.
  5874
  5875     12  PB-CONTROL-BY-ORIG-BATCH.
  5876         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5877         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5878         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5879         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5880
  5881     12  PB-CONTROL-BY-CSR.
  5882         16  PB-CSR-COMPANY-CD            PIC X.
  5883         16  PB-CSR-ID                    PIC X(4).
  5884         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5885         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5886         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5887******************************************************************
  5888*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5889******************************************************************
  5890
  5891     12  PB-LAST-MAINT-DT                 PIC XX.
  5892     12  PB-LAST-MAINT-BY                 PIC X(4).
  5893     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5894
  5895     12  PB-RECORD-BODY                   PIC X(375).
  5896
  5897     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5898         16  PB-CERT-ORIGIN               PIC X.
  5899             88  CLASIC-CREATED-CERT         VALUE '1'.
  5900         16  PB-I-NAME.
  5901             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5902             20  PB-I-INSURED-FIRST-NAME.
  5903                 24  PB-I-INSURED-1ST-INIT PIC X.
  5904                 24  FILLER                PIC X(9).
  5905             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5906         16  PB-I-AGE                     PIC S99   COMP-3.
  5907         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5908         16  PB-I-BIRTHDAY                PIC XX.
  5909         16  PB-I-INSURED-SEX             PIC X.
  5910             88  PB-SEX-MALE     VALUE 'M'.
  5911             88  PB-SEX-FEMALE   VALUE 'F'.
  5912
  5913         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5914         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5915         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5916         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5917         16  PB-I-SKIP-CODE               PIC X.
  5918             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5919             88  PB-SKIP-JULY              VALUE '1'.
  5920             88  PB-SKIP-AUGUST            VALUE '2'.
  5921             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5922             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5923             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5924             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5925             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 111
* EL6311.cbl
  5926             88  PB-SKIP-JUNE              VALUE '8'.
  5927             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5928             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5929             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5930         16  PB-I-TERM-TYPE               PIC X.
  5931             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5932             88  PB-PAID-WEEKLY            VALUE 'W'.
  5933             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5934             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5935             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5936         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5937         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5938         16  PB-I-DATA-ENTRY-SW           PIC X.
  5939             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5940             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5941             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5942             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5943         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5944         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5945*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5946         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5947         16  FILLER                       PIC X.
  5948
  5949         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5950             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5951             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5952                                                   '90' THRU '99'.
  5953         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5954                                          PIC XX.
  5955         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5956         16  PB-I-AMOUNT-FINANCED REDEFINES
  5957                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5958         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  5959         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5960                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5961         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5962         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5963         16  PB-I-CLP-AMOUNT REDEFINES
  5964                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5965         16  PB-I-LF-CALC-FLAG            PIC X.
  5966             88 PB-COMP-LF-PREM               VALUE '?'.
  5967         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5968         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5969         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5970         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5971         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5972         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5973         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5974         16  PB-I-LF-ABBR                 PIC XXX.
  5975         16  PB-I-LF-INPUT-CD             PIC XX.
  5976
  5977         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5978             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5979             88  PB-INVALID-AH               VALUE '  ' '00'
  5980                                                   '90' THRU '99'.
  5981         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5982         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5983         16  PB-I-AH-CALC-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 112
* EL6311.cbl
  5984             88 PB-COMP-AH-PREM                  VALUE '?'.
  5985         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5986         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5987         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5988         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5989         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5990         16  PB-I-AH-ABBR                 PIC XXX.
  5991         16  PB-I-AH-INPUT-CD             PIC XXX.
  5992
  5993         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5994         16  PB-I-REIN-TABLE              PIC XXX.
  5995         16  PB-I-BUSINESS-TYPE           PIC 99.
  5996         16  PB-I-INDV-GRP-CD             PIC X.
  5997         16  PB-I-MORT-CODE.
  5998             20  PB-I-TABLE               PIC X.
  5999             20  PB-I-INTEREST            PIC XX.
  6000             20  PB-I-MORT-TYP            PIC X.
  6001         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6002         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6003         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6004         16  PB-I-INDV-GRP-OVRD           PIC X.
  6005         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6006         16  PB-I-SIG-SW                  PIC X.
  6007             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6008         16  PB-I-RATE-CLASS              PIC XX.
  6009         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6010         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6011         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6012         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6013         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6014         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6015         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6016         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6017         16  PB-I-OB-FLAG                 PIC X.
  6018             88  PB-I-OB                      VALUE 'B'.
  6019             88  PB-I-SUMMARY                 VALUE 'Z'.
  6020         16  PB-I-ENTRY-STATUS            PIC X.
  6021             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6022                                              'M' '5' '9' '2'.
  6023             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6024             88  PB-I-POLICY-PENDING          VALUE '2'.
  6025             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6026             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6027             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6028             88  PB-I-REIN-ONLY               VALUE '9'.
  6029             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6030             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6031             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6032             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6033         16  PB-I-INT-CODE                PIC X.
  6034             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6035             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6036         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6037         16  PB-I-SOC-SEC-NO              PIC X(11).
  6038         16  PB-I-MEMBER-NO               PIC X(12).
  6039         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6040*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6041         16  PB-I-OLD-LOF                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 113
* EL6311.cbl
  6042         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6043         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6044         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6045         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6046         16  PB-I-LIFE-INDICATOR          PIC X.
  6047             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6048         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6049         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6050                                          PIC S9(5)V99    COMP-3.
  6051         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6052             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6053             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6054         16  PB-I-1ST-PMT-DT              PIC XX.
  6055         16  PB-I-JOINT-INSURED.
  6056             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6057             20 PB-I-JOINT-FIRST-NAME.
  6058                24  PB-I-JOINT-FIRST-INIT PIC X.
  6059                24  FILLER                PIC X(9).
  6060             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6061*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6062         16  PB-I-BENEFICIARY-NAME.
  6063             20  PB-I-BANK-NUMBER         PIC X(10).
  6064             20  FILLER                   PIC X(15).
  6065         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6066         16  PB-I-REFERENCE               PIC X(12).
  6067         16  FILLER REDEFINES PB-I-REFERENCE.
  6068             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6069             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6070             20  PB-I-CLP-STATE           PIC XX.
  6071         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6072             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6073             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6074             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6075         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6076         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6077         16  PB-I-RESIDENT-STATE          PIC XX.
  6078         16  PB-I-RATE-CODE               PIC X(4).
  6079         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6080         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6081         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6082         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6083         16  PB-I-BANK-NOCHRGB            PIC 99.
  6084         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6085         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6086
  6087     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6088         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6089             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6090         16  PB-C-CANCEL-ORIGIN           PIC X.
  6091             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6092         16  PB-C-LF-CANCEL-DT            PIC XX.
  6093         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6094         16  PB-C-LF-CALC-REQ             PIC X.
  6095             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6096         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6097         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6098         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6099             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 114
* EL6311.cbl
  6100         16  PB-C-AH-CANCEL-DT            PIC XX.
  6101         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6102         16  PB-C-AH-CALC-REQ             PIC X.
  6103             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6104         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6105         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6106         16  PB-C-LAST-NAME               PIC X(15).
  6107         16  PB-C-REFUND-SW               PIC X.
  6108             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6109             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6110         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6111         16  PB-C-PAYEE-CODE              PIC X(6).
  6112         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6113         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6114         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6115         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6116         16  PB-C-REFERENCE               PIC X(12).
  6117         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6118         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6119         16  PB-C-POST-CARD-IND           PIC X.
  6120         16  PB-C-CANCEL-REASON           PIC X.
  6121         16  PB-C-REF-INTERFACE-SW        PIC X.
  6122         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6123         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6124         16  FILLER                       PIC X(01).
  6125*        16  FILLER                       PIC X(18).
  6126         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6127*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6128         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6129         16  PB-CANCELED-CERT-DATA.
  6130             20  PB-CI-INSURED-NAME.
  6131                 24  PB-CI-LAST-NAME      PIC X(15).
  6132                 24  PB-CI-INITIALS       PIC XX.
  6133             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6134             20  PB-CI-INSURED-SEX        PIC X.
  6135             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6136             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6137             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6138             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6139             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6140             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6141             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6142             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6143             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6144             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6145             20  PB-CI-RATE-CLASS         PIC XX.
  6146             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6147             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6148             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6149             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6150             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6151             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6152             20  PB-CI-LF-ABBR            PIC X(3).
  6153             20  PB-CI-AH-ABBR            PIC X(3).
  6154             20  PB-CI-OB-FLAG            PIC X.
  6155                 88  PB-CI-OB                VALUE 'B'.
  6156             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6157                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 115
* EL6311.cbl
  6158                                           'M' '4' '5' '9' '2'.
  6159                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6160                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6161                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6162                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6163                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6164                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6165                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6166                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6167                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6168                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6169                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6170                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6171             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6172                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6173                                           'M' '4' '5' '9' '2'.
  6174                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6175                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6176                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6177                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6178                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6179                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6180                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6181                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6182                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6183                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6184                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6185                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6186             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6187             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6188             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6189             20  PB-CI-MEMBER-NO          PIC X(12).
  6190             20  PB-CI-INT-CODE           PIC X.
  6191                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6192                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6193             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6194             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6195             20  PB-CI-COMP-EXCP-SW       PIC X.
  6196                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6197                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6198             20  PB-CI-ENTRY-STATUS       PIC X.
  6199             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6200             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6201             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6202             20  PB-CI-DEATH-DT           PIC XX.
  6203             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6204             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6205             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6206             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6207             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6208             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6209             20  PB-CI-ENTRY-DT              PIC XX.
  6210             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6211             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6212             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6213             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6214             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6215             20  PB-CI-OLD-LOF               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 116
* EL6311.cbl
  6216*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6217             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6218             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6219             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6220             20  PB-CI-INDV-GRP-CD           PIC X.
  6221             20  PB-CI-BENEFICIARY-NAME.
  6222                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6223                 24  FILLER                  PIC X(15).
  6224             20  PB-CI-NOTE-SW               PIC X.
  6225             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6226             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6227             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6228             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6229             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6230             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6231             20  PB-CI-FIRST-NAME            PIC X(10).
  6232             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6233
  6234         16  FILLER                       PIC X(13).
  6235*032306  16  FILLER                       PIC X(27).
  6236*        16  FILLER                       PIC X(46).
  6237
  6238     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6239         16  FILLER                       PIC X(10).
  6240         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6241         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6242         16  PB-M-INSURED-MID-INIT        PIC X.
  6243         16  PB-M-INSURED-AGE             PIC 99.
  6244         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6245         16  PB-M-INSURED-SEX             PIC X.
  6246         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6247         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6248         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6249         16  PB-M-INSURED-CITY-STATE.
  6250             20  PB-M-INSURED-CITY        PIC X(28).
  6251             20  PB-M-INSURED-STATE       PIC XX.
  6252         16  PB-M-INSURED-ZIP-CODE.
  6253             20  PB-M-INSURED-ZIP-PRIME.
  6254                 24  PB-M-INSURED-ZIP-1   PIC X.
  6255                     88  PB-M-CANADIAN-POST-CODE
  6256                                             VALUE 'A' THRU 'Z'.
  6257                 24  FILLER               PIC X(4).
  6258             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6259         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6260                                        PB-M-INSURED-ZIP-CODE.
  6261             20  PM-M-INS-CAN-POST1       PIC XXX.
  6262             20  PM-M-INS-CAN-POST2       PIC XXX.
  6263             20  FILLER                   PIC XXX.
  6264         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6265         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6266         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6267         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6268         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6269         16  PB-M-CRED-BENE-CITYST.
  6270             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6271             20  PB-M-CRED-BENE-STATE     PIC XX.
  6272         16  FILLER                       PIC X(92).
  6273
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 117
* EL6311.cbl
  6274     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6275         16  FILLER                       PIC X(10).
  6276         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6277         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6278         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6279         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6280         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6281         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6282         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6283         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6284         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6285         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6286         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6287         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6288         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6289         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6290         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6291         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6292         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6293         16  PB-ACCOUNT-NAME              PIC X(30).
  6294         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6295         16  PB-REFERENCE                 PIC X(12).
  6296         16  PB-B-RECEIVED-DT             PIC XX.
  6297         16  FILLER                       PIC X(234).
  6298
  6299     12  PB-RECORD-STATUS.
  6300         16  PB-CREDIT-SELECT-DT          PIC XX.
  6301         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6302         16  PB-BILLED-DT                 PIC XX.
  6303         16  PB-BILLING-STATUS            PIC X.
  6304             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6305             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6306             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6307         16  PB-RECORD-BILL               PIC X.
  6308             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6309             88  PB-RECORD-RETURNED           VALUE 'R'.
  6310             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6311             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6312             88  PB-OVERRIDE-AH               VALUE 'A'.
  6313             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6314         16  PB-BATCH-ENTRY               PIC X.
  6315             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6316             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6317             88  PB-REISSUED-CERT             VALUE 'E'.
  6318             88  PB-MONTHLY-CERT              VALUE 'M'.
  6319             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6320             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6321             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6322         16  PB-FORCE-CODE                PIC X.
  6323             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6324             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6325             88  PB-CANCEL-FORCE              VALUE '8'.
  6326             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6327             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6328             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6329             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6330             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6331             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 118
* EL6311.cbl
  6332             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6333         16  PB-FATAL-FLAG                PIC X.
  6334             88  PB-FATAL-ERRORS              VALUE 'X'.
  6335         16  PB-FORCE-ER-CD               PIC X.
  6336             88  PB-FORCE-ERRORS              VALUE 'F'.
  6337             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6338         16  PB-WARN-ER-CD                PIC X.
  6339             88  PB-WARNING-ERRORS            VALUE 'W'.
  6340         16  FILLER                       PIC X.
  6341         16  PB-OUT-BAL-CD                PIC X.
  6342             88  PB-OUT-OF-BAL                VALUE 'O'.
  6343         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6344         16  PB-AH-OVERRIDE-L1            PIC X.
  6345         16  PB-INPUT-DT                  PIC XX.
  6346         16  PB-INPUT-BY                  PIC X(4).
  6347         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6348         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6349         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6350         16  PB-LF-EARNING-METHOD         PIC X.
  6351         16  PB-AH-EARNING-METHOD         PIC X.
  6352         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6353         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6354         16  PB-REIN-CD                   PIC XXX.
  6355         16  PB-LF-REFUND-TYPE            PIC X.
  6356         16  PB-AH-REFUND-TYPE            PIC X.
  6357         16  PB-ACCT-EFF-DT               PIC XX.
  6358         16  PB-ACCT-EXP-DT               PIC XX.
  6359         16  PB-COMPANY-ID                PIC X(3).
  6360         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6361         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6362         16  PB-SV-CARRIER                PIC X.
  6363         16  PB-SV-GROUPING               PIC X(6).
  6364         16  PB-SV-STATE                  PIC XX.
  6365         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6366         16  PB-GA-BILLING-INFO.
  6367             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6368                                          PIC XX.
  6369         16  PB-SV-REMIT-TO  REDEFINES
  6370             PB-GA-BILLING-INFO           PIC X(10).
  6371         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6372         16  PB-I-LOAN-OFFICER            PIC X(5).
  6373         16  PB-I-VIN                     PIC X(17).
  6374
  6375         16  FILLER                       PIC X(04).
  6376         16  IMNET-BYPASS-SW              PIC X.
  6377
  6378******************************************************************
  6379*                COMMON EDIT ERRORS                              *
  6380******************************************************************
  6381
  6382     12  PB-COMMON-ERRORS.
  6383         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6384                                           PIC S9(4)     COMP.
  6385
  6386******************************************************************
  6387*                                COPY ELCCERT.
  6388******************************************************************
  6389*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 119
* EL6311.cbl
  6390*                            ELCCERT.                            *
  6391*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6392*                            VMOD=2.013                          *
  6393*                                                                *
  6394*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6395*                                                                *
  6396*   FILE TYPE = VSAM,KSDS                                        *
  6397*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6398*                                                                *
  6399*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6400*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6401*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6402*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6403*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6404*                                                                *
  6405*   LOG = YES                                                    *
  6406*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6407******************************************************************
  6408*                   C H A N G E   L O G
  6409*
  6410* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6411*-----------------------------------------------------------------
  6412*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6413* EFFECTIVE    NUMBER
  6414*-----------------------------------------------------------------
  6415* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6416* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6417* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6418* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6419* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6420* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6421* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6422* 032612  CR2011110200001  PEMA  AHL CHANGES
  6423******************************************************************
  6424
  6425 01  CERTIFICATE-MASTER.
  6426     12  CM-RECORD-ID                      PIC XX.
  6427         88  VALID-CM-ID                      VALUE 'CM'.
  6428
  6429     12  CM-CONTROL-PRIMARY.
  6430         16  CM-COMPANY-CD                 PIC X.
  6431         16  CM-CARRIER                    PIC X.
  6432         16  CM-GROUPING.
  6433             20  CM-GROUPING-PREFIX        PIC X(3).
  6434             20  CM-GROUPING-PRIME         PIC X(3).
  6435         16  CM-STATE                      PIC XX.
  6436         16  CM-ACCOUNT.
  6437             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6438             20  CM-ACCOUNT-PRIME          PIC X(6).
  6439         16  CM-CERT-EFF-DT                PIC XX.
  6440         16  CM-CERT-NO.
  6441             20  CM-CERT-PRIME             PIC X(10).
  6442             20  CM-CERT-SFX               PIC X.
  6443
  6444     12  CM-CONTROL-BY-NAME.
  6445         16  CM-COMPANY-CD-A1              PIC X.
  6446         16  CM-INSURED-LAST-NAME          PIC X(15).
  6447         16  CM-INSURED-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 120
* EL6311.cbl
  6448             20  CM-INSURED-INITIAL1       PIC X.
  6449             20  CM-INSURED-INITIAL2       PIC X.
  6450
  6451     12  CM-CONTROL-BY-SSN.
  6452         16  CM-COMPANY-CD-A2              PIC X.
  6453         16  CM-SOC-SEC-NO.
  6454             20  CM-SSN-STATE              PIC XX.
  6455             20  CM-SSN-ACCOUNT            PIC X(6).
  6456             20  CM-SSN-LN3.
  6457                 25  CM-INSURED-INITIALS-A2.
  6458                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6459                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6460                 25 CM-PART-LAST-NAME-A2         PIC X.
  6461
  6462     12  CM-CONTROL-BY-CERT-NO.
  6463         16  CM-COMPANY-CD-A4              PIC X.
  6464         16  CM-CERT-NO-A4                 PIC X(11).
  6465
  6466     12  CM-CONTROL-BY-MEMB.
  6467         16  CM-COMPANY-CD-A5              PIC X.
  6468         16  CM-MEMBER-NO.
  6469             20  CM-MEMB-STATE             PIC XX.
  6470             20  CM-MEMB-ACCOUNT           PIC X(6).
  6471             20  CM-MEMB-LN4.
  6472                 25  CM-INSURED-INITIALS-A5.
  6473                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6474                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6475                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6476
  6477     12  CM-INSURED-PROFILE-DATA.
  6478         16  CM-INSURED-FIRST-NAME.
  6479             20  CM-INSURED-1ST-INIT       PIC X.
  6480             20  FILLER                    PIC X(9).
  6481         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6482         16  CM-INSURED-SEX                PIC X.
  6483             88  CM-SEX-MALE                  VALUE 'M'.
  6484             88  CM-SEX-FEMAL                 VALUE 'F'.
  6485         16  CM-INSURED-JOINT-AGE          PIC 99.
  6486         16  CM-JOINT-INSURED-NAME.
  6487             20  CM-JT-LAST-NAME           PIC X(15).
  6488             20  CM-JT-FIRST-NAME.
  6489                 24  CM-JT-1ST-INIT        PIC X.
  6490                 24  FILLER                PIC X(9).
  6491             20  CM-JT-INITIAL             PIC X.
  6492
  6493     12  CM-LIFE-DATA.
  6494         16  CM-LF-BENEFIT-CD              PIC XX.
  6495         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6496         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6497         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6498         16  CM-LF-DEV-CODE                PIC XXX.
  6499         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6500         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6501         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6502         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6503         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6504         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6505         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 121
* EL6311.cbl
  6506         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6507         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6508         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6509         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6510         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6511         16  FILLER                        PIC XX.
  6512
  6513     12  CM-AH-DATA.
  6514         16  CM-AH-BENEFIT-CD              PIC XX.
  6515         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6516         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6517         16  CM-AH-DEV-CODE                PIC XXX.
  6518         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6519         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6520         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6521         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6522         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6523         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6524         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6525         16  CM-AH-PAID-THRU-DT            PIC XX.
  6526             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6527         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6528         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6529         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6530         16  FILLER                        PIC X.
  6531
  6532     12  CM-LOAN-INFORMATION.
  6533         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6534         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6535                                           PIC S9(5)V99  COMP-3.
  6536         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6537         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6538         16  CM-PAY-FREQUENCY              PIC S99.
  6539         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6540         16  CM-RATE-CLASS                 PIC XX.
  6541         16  CM-BENEFICIARY                PIC X(25).
  6542         16  CM-POLICY-FORM-NO             PIC X(12).
  6543         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6544         16  CM-LAST-ADD-ON-DT             PIC XX.
  6545         16  CM-DEDUCTIBLE-AMOUNTS.
  6546             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6547             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6548         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6549             20  CM-RESIDENT-STATE         PIC XX.
  6550             20  CM-RATE-CODE              PIC X(4).
  6551             20  FILLER                    PIC XX.
  6552         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6553             20  CM-LOAN-OFFICER           PIC X(5).
  6554             20  FILLER                    PIC XXX.
  6555         16  CM-CSR-CODE                   PIC XXX.
  6556         16  CM-UNDERWRITING-CODE          PIC X.
  6557             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6558         16  CM-POST-CARD-IND              PIC X.
  6559         16  CM-NH-INTERFACE-SW            PIC X.
  6560         16  CM-PREMIUM-TYPE               PIC X.
  6561             88  CM-SING-PRM                  VALUE '1'.
  6562             88  CM-O-B-COVERAGE              VALUE '2'.
  6563             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 122
* EL6311.cbl
  6564         16  CM-IND-GRP-TYPE               PIC X.
  6565             88  CM-INDIVIDUAL                VALUE 'I'.
  6566             88  CM-GROUP                     VALUE 'G'.
  6567         16  CM-SKIP-CODE                  PIC X.
  6568             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6569             88  SKIP-JULY                    VALUE '1'.
  6570             88  SKIP-AUGUST                  VALUE '2'.
  6571             88  SKIP-SEPTEMBER               VALUE '3'.
  6572             88  SKIP-JULY-AUG                VALUE '4'.
  6573             88  SKIP-AUG-SEPT                VALUE '5'.
  6574             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6575             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6576             88  SKIP-JUNE                    VALUE '8'.
  6577             88  SKIP-JUNE-JULY               VALUE '9'.
  6578             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6579             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6580         16  CM-PAYMENT-MODE               PIC X.
  6581             88  PAY-MONTHLY                  VALUE SPACE.
  6582             88  PAY-WEEKLY                   VALUE '1'.
  6583             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6584             88  PAY-BI-WEEKLY                VALUE '3'.
  6585             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6586         16  CM-LOAN-NUMBER                PIC X(8).
  6587         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6588         16  CM-OLD-LOF                    PIC XXX.
  6589*        16  CM-LOAN-OFFICER               PIC XXX.
  6590         16  CM-REIN-TABLE                 PIC XXX.
  6591         16  CM-SPECIAL-REIN-CODE          PIC X.
  6592         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6593         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6594         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6595
  6596     12  CM-STATUS-DATA.
  6597         16  CM-ENTRY-STATUS               PIC X.
  6598         16  CM-ENTRY-DT                   PIC XX.
  6599
  6600         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6601         16  CM-LF-CANCEL-DT               PIC XX.
  6602         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6603
  6604         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6605         16  CM-LF-DEATH-DT                PIC XX.
  6606         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6607
  6608         16  CM-LF-CURRENT-STATUS          PIC X.
  6609             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6610                                                'M' '4' '5' '9'.
  6611             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6612             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6613             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6614             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6615             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6616             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6617             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6618             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6619             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6620             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6621             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 123
* EL6311.cbl
  6622             88  CM-LF-VOIDED                 VALUE 'V'.
  6623
  6624         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6625         16  CM-AH-CANCEL-DT               PIC XX.
  6626         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6627
  6628         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6629         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6630         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6631
  6632         16  CM-AH-CURRENT-STATUS          PIC X.
  6633             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6634                                                'M' '4' '5' '9'.
  6635             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6636             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6637             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6638             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6639             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6640             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6641             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6642             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6643             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6644             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6645             88  CM-AH-DECLINED               VALUE 'D'.
  6646             88  CM-AH-VOIDED                 VALUE 'V'.
  6647
  6648         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6649             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6650             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6651             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6652         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6653
  6654         16  CM-ENTRY-BATCH                PIC X(6).
  6655         16  CM-LF-EXIT-BATCH              PIC X(6).
  6656         16  CM-AH-EXIT-BATCH              PIC X(6).
  6657         16  CM-LAST-MONTH-END             PIC XX.
  6658
  6659     12  CM-NOTE-SW                        PIC X.
  6660         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6661         88  CERT-NOTES-PRESENT               VALUE '1'.
  6662         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6663         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6664         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6665         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6666         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6667         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6668     12  CM-COMP-EXCP-SW                   PIC X.
  6669         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6670         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6671     12  CM-INSURED-ADDRESS-SW             PIC X.
  6672         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6673         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6674
  6675*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6676     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6677     12  FILLER                            PIC X.
  6678
  6679*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 124
* EL6311.cbl
  6680     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6681     12  FILLER                            PIC X.
  6682*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6683     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6684
  6685     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6686         88  CERT-ADDED-BATCH                 VALUE ' '.
  6687         88  CERT-ADDED-ONLINE                VALUE '1'.
  6688         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6689         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6690         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6691     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6692         88  CERT-AS-LOADED                   VALUE ' '.
  6693         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6694         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6695         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6696         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6697         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6698         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6699         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6700
  6701     12  CM-ACCOUNT-COMM-PCTS.
  6702         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6703         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6704
  6705     12  CM-USER-FIELD                     PIC X.
  6706     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6707     12  CM-CLP-STATE                      PIC XX.
  6708     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6709     12  CM-USER-RESERVED                  PIC XXX.
  6710     12  FILLER REDEFINES CM-USER-RESERVED.
  6711         16  CM-AH-CLASS-CD                PIC XX.
  6712         16  F                             PIC X.
  6713******************************************************************
  6714*                                COPY ERCNOTE.
  6715******************************************************************
  6716*                                                                *
  6717*                                                                *
  6718*                            ERCNOTE                             *
  6719*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6720*                            VMOD=2.003                          *
  6721*                                                                *
  6722*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6723*                                                                *
  6724*        FILE TYPE= VSAM,KSDS                                    *
  6725*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6726*                                                                *
  6727*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6728*                                                                *
  6729*        LOG = YES                                               *
  6730*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6731*                                                                *
  6732******************************************************************
  6733*                   C H A N G E   L O G
  6734*
  6735* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6736*-----------------------------------------------------------------
  6737*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 125
* EL6311.cbl
  6738* EFFECTIVE    NUMBER
  6739*-----------------------------------------------------------------
  6740* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6741*                                FILE WILL CONTAIN BILLING NOTES O
  6742******************************************************************
  6743
  6744 01  CERTIFICATE-NOTE.
  6745     12  CN-RECORD-ID                PIC  XX.
  6746         88  VALID-CN-ID                  VALUE 'CN'.
  6747
  6748     12  CN-CONTROL-PRIMARY.
  6749         16  CN-COMPANY-CD           PIC X.
  6750         16  CN-CARRIER              PIC X.
  6751         16  CN-GROUPING.
  6752             20 CN-GROUPING-PREFIX   PIC XXX.
  6753             20 CN-GROUPING-PRIME    PIC XXX.
  6754         16  CN-STATE                PIC XX.
  6755         16  CN-ACCOUNT.
  6756             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6757             20 CN-ACCOUNT-PRIME     PIC X(6).
  6758         16  CN-CERT-EFF-DT          PIC XX.
  6759         16  CN-CERT-NO.
  6760             20  CN-CERT-PRIME       PIC X(10).
  6761             20  CN-CERT-SFX         PIC X.
  6762
  6763     12  CN-BILLING-START-LINE-NO    PIC 99.
  6764     12  CN-BILLING-END-LINE-NO      PIC 99.
  6765
  6766     12  CN-LINES.
  6767         16  CN-LINE OCCURS 10       PIC X(77).
  6768
  6769     12  CN-LAST-MAINT-DT            PIC XX.
  6770     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6771     12  CN-LAST-MAINT-USER          PIC X(4).
  6772     12  FILLER                      PIC X(6).
  6773******************************************************************
  6774*                                COPY ERCPNDM.
  6775******************************************************************
  6776*                                                                *
  6777*                                                                *
  6778*                            ERCPNDM                             *
  6779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6780*                            VMOD=2.003                          *
  6781*                                                                *
  6782*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6783*                                                                *
  6784*   FILE TYPE = VSAM,KSDS                                        *
  6785*   RECORD SIZE = 374   RECFORM = FIX                            *
  6786*                                                                *
  6787*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6788*   ALTERNATE PATH    = NOT USED                                 *
  6789*                                                                *
  6790*   LOG = YES                                                    *
  6791*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6792******************************************************************
  6793*                   C H A N G E   L O G
  6794*
  6795* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 126
* EL6311.cbl
  6796*-----------------------------------------------------------------
  6797*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6798* EFFECTIVE    NUMBER
  6799*-----------------------------------------------------------------
  6800* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6801* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6802* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6803******************************************************************
  6804
  6805 01  PENDING-MAILING-DATA.
  6806     12  PM-RECORD-ID                      PIC XX.
  6807         88  VALID-MA-ID                       VALUE 'PM'.
  6808
  6809     12  PM-CONTROL-PRIMARY.
  6810         16  PM-COMPANY-CD                 PIC X.
  6811         16  PM-ENTRY-BATCH                PIC X(6).
  6812         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6813         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6814
  6815     12  FILLER                            PIC X(14).
  6816
  6817     12  PM-ACCESS-CONTROL.
  6818         16  PM-SOURCE-SYSTEM              PIC XX.
  6819             88  PM-FROM-CREDIT                VALUE 'CR'.
  6820             88  PM-FROM-VSI                   VALUE 'VS'.
  6821             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6822             88  PM-FROM-OTHER                 VALUE 'OT'.
  6823         16  PM-RECORD-ADD-DT              PIC XX.
  6824         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6825         16  PM-LAST-MAINT-DT              PIC XX.
  6826         16  PM-LAST-MAINT-BY              PIC XXXX.
  6827         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6828
  6829     12  PM-PROFILE-INFO.
  6830         16  PM-QUALIFY-CODE-1             PIC XX.
  6831         16  PM-QUALIFY-CODE-2             PIC XX.
  6832         16  PM-QUALIFY-CODE-3             PIC XX.
  6833         16  PM-QUALIFY-CODE-4             PIC XX.
  6834         16  PM-QUALIFY-CODE-5             PIC XX.
  6835
  6836         16  PM-INSURED-LAST-NAME          PIC X(15).
  6837         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6838         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6839         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6840         16  PM-INSURED-BIRTH-DT           PIC XX.
  6841         16  PM-INSURED-SEX                PIC X.
  6842             88  PM-SEX-MALE                   VALUE 'M'.
  6843             88  PM-SEX-FEMALE                 VALUE 'F'.
  6844         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6845
  6846         16  PM-ADDRESS-CORRECTED          PIC X.
  6847         16  PM-JOINT-BIRTH-DT             PIC XX.
  6848*        16  FILLER                        PIC X(12).
  6849
  6850         16  PM-ADDRESS-LINE-1             PIC X(30).
  6851         16  PM-ADDRESS-LINE-2             PIC X(30).
  6852         16  PM-CITY-STATE.
  6853             20  PM-CITY                   PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 127
* EL6311.cbl
  6854             20  PM-STATE                  PIC XX.
  6855         16  PM-ZIP.
  6856             20  PM-ZIP-CODE.
  6857                 24  PM-ZIP-1              PIC X.
  6858                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6859                 24  FILLER                PIC X(4).
  6860             20  PM-ZIP-PLUS4              PIC X(4).
  6861         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6862             20  PM-CAN-POST1              PIC XXX.
  6863             20  PM-CAN-POST2              PIC XXX.
  6864             20  FILLER                    PIC XXX.
  6865
  6866         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6867
  6868         16  FILLER                        PIC X(03).
  6869
  6870     12  PM-CRED-BENE-INFO.
  6871         16  PM-CRED-BENE-NAME             PIC X(25).
  6872         16  PM-CRED-BENE-ADDR             PIC X(30).
  6873         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6874         16  PM-CRED-BENE-CTYST.
  6875             20  PM-CRED-BENE-CITY         PIC X(28).
  6876             20  PM-CRED-BENE-STATE        PIC XX.
  6877         16  PM-CRED-BENE-ZIP.
  6878             20  PM-CB-ZIP-CODE.
  6879                 24  PM-CB-ZIP-1           PIC X.
  6880                     88  PM-CB-CANADIAN-POST-CODE
  6881                                  VALUE 'A' THRU 'Z'.
  6882                 24  FILLER                PIC X(4).
  6883             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6884         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6885             20  PM-CB-CAN-POST1           PIC XXX.
  6886             20  PM-CB-CAN-POST2           PIC XXX.
  6887             20  FILLER                    PIC XXX.
  6888     12  PM-POST-CARD-MAIL-DATA.
  6889         16  PM-MAIL-DATA OCCURS 7.
  6890             20  PM-MAIL-TYPE              PIC X.
  6891                 88  PM-12MO-MAILING           VALUE '1'.
  6892                 88  PM-EXP-MAILING            VALUE '2'.
  6893             20  PM-MAIL-STATUS            PIC X.
  6894                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6895                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6896                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6897             20  PM-MAIL-DATE              PIC XX.
  6898     12  FILLER                            PIC XX.
  6899     12  FILLER                            PIC X(12).
  6900*    12  FILLER                            PIC X(30).
  6901
  6902******************************************************************
  6903*                                COPY ERCMAIL.
  6904******************************************************************
  6905*                                                                *
  6906*                                                                *
  6907*                            ERCMAIL                             *
  6908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6909*                            VMOD=2.003                          *
  6910*                                                                *
  6911*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 128
* EL6311.cbl
  6912*                                                                *
  6913*   FILE TYPE = VSAM,KSDS                                        *
  6914*   RECORD SIZE = 374   RECFORM = FIX                            *
  6915*                                                                *
  6916*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6917*   ALTERNATE PATH    = NOT USED                                 *
  6918*                                                                *
  6919*   LOG = YES                                                    *
  6920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6921******************************************************************
  6922*                   C H A N G E   L O G
  6923*
  6924* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6925*-----------------------------------------------------------------
  6926*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6927* EFFECTIVE    NUMBER
  6928*-----------------------------------------------------------------
  6929* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6930* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6931* 111108                   PEMA  ADD CRED BENE ADDR2
  6932******************************************************************
  6933
  6934 01  MAILING-DATA.
  6935     12  MA-RECORD-ID                      PIC XX.
  6936         88  VALID-MA-ID                       VALUE 'MA'.
  6937
  6938     12  MA-CONTROL-PRIMARY.
  6939         16  MA-COMPANY-CD                 PIC X.
  6940         16  MA-CARRIER                    PIC X.
  6941         16  MA-GROUPING.
  6942             20  MA-GROUPING-PREFIX        PIC XXX.
  6943             20  MA-GROUPING-PRIME         PIC XXX.
  6944         16  MA-STATE                      PIC XX.
  6945         16  MA-ACCOUNT.
  6946             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6947             20  MA-ACCOUNT-PRIME          PIC X(6).
  6948         16  MA-CERT-EFF-DT                PIC XX.
  6949         16  MA-CERT-NO.
  6950             20  MA-CERT-PRIME             PIC X(10).
  6951             20  MA-CERT-SFX               PIC X.
  6952
  6953     12  FILLER                            PIC XX.
  6954
  6955     12  MA-ACCESS-CONTROL.
  6956         16  MA-SOURCE-SYSTEM              PIC XX.
  6957             88  MA-FROM-CREDIT                VALUE 'CR'.
  6958             88  MA-FROM-VSI                   VALUE 'VS'.
  6959             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6960             88  MA-FROM-OTHER                 VALUE 'OT'.
  6961         16  MA-RECORD-ADD-DT              PIC XX.
  6962         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6963         16  MA-LAST-MAINT-DT              PIC XX.
  6964         16  MA-LAST-MAINT-BY              PIC XXXX.
  6965         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6966
  6967     12  MA-PROFILE-INFO.
  6968         16  MA-QUALIFY-CODE-1             PIC XX.
  6969         16  MA-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 129
* EL6311.cbl
  6970         16  MA-QUALIFY-CODE-3             PIC XX.
  6971         16  MA-QUALIFY-CODE-4             PIC XX.
  6972         16  MA-QUALIFY-CODE-5             PIC XX.
  6973
  6974         16  MA-INSURED-LAST-NAME          PIC X(15).
  6975         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6976         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6977         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6978         16  MA-INSURED-BIRTH-DT           PIC XX.
  6979         16  MA-INSURED-SEX                PIC X.
  6980             88  MA-SEX-MALE                   VALUE 'M'.
  6981             88  MA-SEX-FEMALE                 VALUE 'F'.
  6982         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6983
  6984         16  MA-ADDRESS-CORRECTED          PIC X.
  6985         16  MA-JOINT-BIRTH-DT             PIC XX.
  6986*        16  FILLER                        PIC X(12).
  6987
  6988         16  MA-ADDRESS-LINE-1             PIC X(30).
  6989         16  MA-ADDRESS-LINE-2             PIC X(30).
  6990         16  MA-CITY-STATE.
  6991             20  MA-CITY                   PIC X(28).
  6992             20  MA-ADDR-STATE             PIC XX.
  6993         16  MA-ZIP.
  6994             20  MA-ZIP-CODE.
  6995                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6996                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6997                 24  FILLER                PIC X(4).
  6998             20  MA-ZIP-PLUS4              PIC X(4).
  6999         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7000             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7001             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7002             20  FILLER                    PIC X(3).
  7003
  7004         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7005
  7006         16  FILLER                        PIC XXX.
  7007*        16  FILLER                        PIC X(10).
  7008
  7009     12  MA-CRED-BENE-INFO.
  7010         16  MA-CRED-BENE-NAME                 PIC X(25).
  7011         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7012         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7013         16  MA-CRED-BENE-CTYST.
  7014             20  MA-CRED-BENE-CITY             PIC X(28).
  7015             20  MA-CRED-BENE-STATE            PIC XX.
  7016         16  MA-CRED-BENE-ZIP.
  7017             20  MA-CB-ZIP-CODE.
  7018                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7019                     88  MA-CB-CANADIAN-POST-CODE
  7020                                           VALUE 'A' THRU 'Z'.
  7021                 24  FILLER                    PIC X(4).
  7022             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7023         16  MA-CB-CANADIAN-POSTAL-CODE
  7024                            REDEFINES MA-CRED-BENE-ZIP.
  7025             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7026             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7027             20  FILLER                        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 130
* EL6311.cbl
  7028     12  MA-POST-CARD-MAIL-DATA.
  7029         16  MA-MAIL-DATA OCCURS 7.
  7030             20  MA-MAIL-TYPE              PIC X.
  7031                 88  MA-12MO-MAILING           VALUE '1'.
  7032                 88  MA-EXP-MAILING            VALUE '2'.
  7033             20  MA-MAIL-STATUS            PIC X.
  7034                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7035                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7036                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7037             20  MA-MAIL-DATE              PIC XX.
  7038     12  FILLER                            PIC XX.
  7039     12  FILLER                            PIC XX.
  7040*    12  FILLER                            PIC X(30).
  7041******************************************************************
  7042*                                COPY ERCRQST.
  7043******************************************************************
  7044*                                                                *
  7045*                                                                *
  7046*                            ERCRQST.                            *
  7047*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7048*                            VMOD=2.002                          *
  7049*                                                                *
  7050*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7051*                                                                *
  7052*   FILE TYPE = VSAM,KSDS                                        *
  7053*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7054*                                                                *
  7055*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7056*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7057*                                   ACCOUNT, REF, BATCH)         *
  7058*                                                RKP=9, LEN=38   *
  7059*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7060*                                   ACCOUNT, REF, BATCH)         *
  7061*                                                RKP=47, LEN=46  *
  7062*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7063*                                   BATCH)                       *
  7064*                                                RKP=93, LEN=24  *
  7065*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7066*                                   REF, BATCH)                  *
  7067*                                                RKP=117, LEN=35 *
  7068*   LOG = NO                                                     *
  7069*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7070******************************************************************
  7071
  7072 01  AR-REQUEST-RECORD.
  7073     12  RQ-RECORD-ID                     PIC XX.
  7074         88  VALID-RQ-ID                        VALUE 'RQ'.
  7075
  7076     12  RQ-CONTROL-PRIMARY.
  7077         16  RQ-COMPANY-CD                PIC X.
  7078         16  RQ-ENTRY-BATCH               PIC X(6).
  7079
  7080     12  RQ-CONTROL-BY-ACCT-REF.
  7081         16  RQ-COMPANY-CD-A1             PIC X.
  7082         16  RQ-CARRIER-A1                PIC X.
  7083         16  RQ-GROUPING-A1               PIC X(6).
  7084         16  RQ-STATE-A1                  PIC XX.
  7085         16  RQ-ACCOUNT-A1                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 131
* EL6311.cbl
  7086         16  RQ-REFERENCE-A1              PIC X(12).
  7087         16  RQ-BATCH-A1                  PIC X(6).
  7088
  7089     12  RQ-CONTROL-BY-FIN-RESP.
  7090         16  RQ-COMPANY-CD-A2             PIC X.
  7091         16  RQ-CARRIER-A2                PIC X.
  7092         16  RQ-GROUPING-A2               PIC X(6).
  7093         16  RQ-FIN-RESP-A2               PIC X(10).
  7094         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7095         16  RQ-REFERENCE-A2              PIC X(12).
  7096         16  RQ-BATCH-A2                  PIC X(6).
  7097
  7098     12  RQ-CONTROL-BY-ACCT-AGENT.
  7099         16  RQ-COMPANY-CD-A3             PIC X.
  7100         16  RQ-CARRIER-A3                PIC X.
  7101         16  RQ-GROUPING-A3               PIC X(6).
  7102         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7103         16  RQ-BATCH-A3                  PIC X(6).
  7104
  7105     12  RQ-CONTROL-BY-SUMMARY.
  7106         16  RQ-COMPANY-CD-A4             PIC X.
  7107         16  RQ-SUMMARY-CODE              PIC X(6).
  7108         16  RQ-ACCOUNT-A4                PIC X(10).
  7109         16  RQ-REFERENCE-A4              PIC X(12).
  7110         16  RQ-BATCH-A4                  PIC X(6).
  7111
  7112     12  RQ-REQUEST-METHOD                PIC X.
  7113         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7114         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7115         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7116         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7117     12  FILLER                           PIC X.
  7118     12  RQ-STATUS                        PIC X.
  7119         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7120         88  RQ-RESUBMIT                      VALUE 'R'.
  7121     12  RQ-PROCESSOR-ID                  PIC X(4).
  7122     12  RQ-ENTRY-DT                      PIC XX.
  7123     12  RQ-MO-END-DT                     PIC XX.
  7124     12  RQ-REQUEST-DT                    PIC XX.
  7125     12  RQ-STMT-DT                       PIC XX.
  7126     12  RQ-REVERSAL-DT                   PIC XX.
  7127     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7128     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7129
  7130     12  FILLER                           PIC X(27).
  7131
  7132******************************************************************
  7133
  7134*                                COPY ERCLOFC.
  7135******************************************************************
  7136*                                                                *
  7137*                                                                *
  7138*                            ERCLOFC                             *
  7139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7140*                            VMOD=2.003                          *
  7141*                                                                *
  7142*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7143*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 132
* EL6311.cbl
  7144*   FILE TYPE = VSAM,KSDS                                        *
  7145*   RECORD SIZE = 670   RECFORM = FIX                            *
  7146*                                                                *
  7147*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7148*                                                                *
  7149*   LOG = YES                                                    *
  7150*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7151*                                                                *
  7152******************************************************************
  7153
  7154 01  LOAN-OFFICER-MASTER.
  7155     12  LO-RECORD-ID                PIC XX.
  7156         88  VALID-LO-ID                VALUE 'LO'.
  7157
  7158     12  LO-CONTROL-PRIMARY.
  7159         16  LO-COMPANY-CD           PIC X.
  7160         16  LO-CARRIER              PIC X.
  7161         16  LO-GROUPING.
  7162             20  LO-GROUPING-PREFIX  PIC XXX.
  7163             20  LO-GROUPING-PRIME   PIC XXX.
  7164         16  LO-STATE                PIC XX.
  7165         16  LO-ACCOUNT.
  7166             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7167             20  LO-ACCOUNT-PRIME    PIC X(6).
  7168         16  LO-OFFICER-CODE         PIC X(5).
  7169
  7170     12  LO-OFFICER-NAME             PIC X(30).
  7171
  7172     12  LO-LAST-MAINT-DT            PIC XX.
  7173     12  LO-LAST-USER                PIC X(4).
  7174     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7175
  7176     12  LO-COMP-CONTROL             PIC X.
  7177             88  LO-SHOW-COMP           VALUE 'Y'.
  7178             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7179     12  LO-DETAIL-CONTROL           PIC X.
  7180             88  LO-PRINT-DETAIL        VALUE 'D'.
  7181             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7182
  7183     12  LO-SV-CARRIER               PIC X.
  7184     12  LO-SV-GROUPING              PIC X(6).
  7185     12  LO-SV-STATE                 PIC XX.
  7186
  7187     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7188     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7189
  7190     12  LO-OFFICER-INFO.
  7191         16  FILLER OCCURS 12 TIMES.
  7192             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7193             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7194             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7195             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7196             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7197             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7198             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7199             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7200     12  FILLER                      PIC X(198).
  7201******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 133
* EL6311.cbl
  7202*                                COPY ERCPYAJ.
  7203******************************************************************
  7204*                                                                *
  7205*                            ERCPYAJ                             *
  7206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7207*                            VMOD=2.015                          *
  7208*                                                                *
  7209*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7210*                                                                *
  7211*                                                                *
  7212*   FILE TYPE = VSAM,KSDS                                        *
  7213*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7214*                                                                *
  7215*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7216*       ALTERNATE PATHS = NONE                                   *
  7217*                                                                *
  7218*   LOG = YES                                                    *
  7219*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7220******************************************************************
  7221******************************************************************
  7222*                   C H A N G E   L O G
  7223*
  7224* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7225*-----------------------------------------------------------------
  7226*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7227* EFFECTIVE    NUMBER
  7228*-----------------------------------------------------------------
  7229* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7230* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7231******************************************************************
  7232
  7233 01  PENDING-PAY-ADJ.
  7234     12  PY-RECORD-ID                     PIC XX.
  7235         88  VALID-PY-ID                        VALUE 'PY'.
  7236
  7237     12  PY-CONTROL-PRIMARY.
  7238         16  PY-COMPANY-CD                PIC X.
  7239         16  PY-CARRIER                   PIC X.
  7240         16  PY-GROUPING                  PIC X(6).
  7241         16  PY-FIN-RESP                  PIC X(10).
  7242         16  PY-ACCOUNT                   PIC X(10).
  7243         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7244                                          PIC X(10).
  7245         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7246         16  PY-RECORD-TYPE               PIC X.
  7247             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7248             88  PY-DEPOSIT                   VALUE 'D'.
  7249             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7250             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7251             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7252             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7253             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7254             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7255             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7256             88  PY-FICA-ENTRY                VALUE 'F'.
  7257             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7258             88  PY-POLICY-FEE                VALUE 'W'.
  7259             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 134
* EL6311.cbl
  7260
  7261     12  PY-PYMT-TYPE                     PIC X.
  7262             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7263             88  PY-REINS-PYMT                VALUE 'R'.
  7264             88  PY-EXP-PYMT                  VALUE 'E'.
  7265
  7266     12  PY-BIL-INV                       PIC X(6).
  7267     12  PY-REF-NO                        PIC X(12).
  7268
  7269     12  PY-LAST-MAINT-DT                 PIC XX.
  7270     12  PY-LAST-MAINT-BY                 PIC X(4).
  7271     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7272
  7273     12  PY-PYADJ-RECORD.
  7274         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7275         16  PY-ENTRY-COMMENT             PIC X(30).
  7276         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7277             20  PY-GL-ACCOUNT            PIC X(10).
  7278             20  PY-GL-STATE              PIC X(02).
  7279             20  PY-GL-CANC-SW            PIC X(01).
  7280                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7281                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7282             20  PY-GL-COMMENT            PIC X(10).
  7283             20  FILLER      REDEFINES PY-GL-COMMENT.
  7284                 24  PY-GL-CHECK-NO       PIC 9(06).
  7285                 24  FILLER               PIC X(04).
  7286             20  FILLER                   PIC X(07).
  7287         16  PY-SAVE-ACCOUNT              PIC X(10).
  7288         16  PY-SAVE-TYPE                 PIC X(01).
  7289
  7290         16  PY-LETTERS.
  7291             20  PY-LETTER OCCURS 3 TIMES
  7292                           INDEXED BY PY-LET-NDX
  7293                                          PIC X(04).
  7294
  7295         16  PY-ERCOMP-TYPE               PIC X.
  7296             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7297             88  PY-GA-TYPE                   VALUE 'G'.
  7298             88  PY-BANK-TYPE                 VALUE 'B'.
  7299         16  FILLER                       PIC X(05).
  7300
  7301     12  PY-RECORD-STATUS.
  7302         16  PY-CREDIT-SELECT-DT          PIC XX.
  7303         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7304         16  PY-BILLED-DATE               PIC XX.
  7305         16  PY-REPORTED-DT               PIC XX.
  7306         16  PY-PMT-APPLIED               PIC X.
  7307             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7308             88  PY-GA-PMT                    VALUE 'G'.
  7309             88  PY-OVWRITE-PMT               VALUE 'O'.
  7310             88  PY-NON-AR-PMT                VALUE 'N'.
  7311         16  FILLER                       PIC X(5).
  7312         16  PY-INPUT-DT                  PIC XX.
  7313         16  PY-CHECK-NUMBER              PIC X(6).
  7314         16  PY-VOID-SW                   PIC X.
  7315             88  PY-CHECK-VOIDED              VALUE 'V'.
  7316         16  PY-CHECK-ORIGIN-SW           PIC X.
  7317             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 135
* EL6311.cbl
  7318             88  PY-REFUND-CHECK              VALUE 'R'.
  7319             88  PY-GA-CHECK                  VALUE 'G'.
  7320             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7321             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7322         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7323         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7324         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7325         16  PY-BILL-FLAG                 PIC X.
  7326             88  PY-BILLED                    VALUE 'B'.
  7327         16  PY-AR-FLAG                   PIC X.
  7328             88  PY-AR-CYCLE                  VALUE 'C'.
  7329             88  PY-AR-MONTH-END              VALUE 'M'.
  7330         16  PY-AR-DATE                   PIC XX.
  7331
  7332     12  PY-GL-CODES.
  7333         16  PY-GL-DB                     PIC X(14).
  7334         16  PY-GL-CR                     PIC X(14).
  7335         16  PY-GL-FLAG                   PIC X.
  7336         16  PY-GL-DATE                   PIC XX.
  7337
  7338     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7339     12  FILLER                           PIC X(3).
  7340******************************************************************
  7341*                                COPY ERCCNOT.
  7342******************************************************************
  7343*                                                                *
  7344*                            ERCCNOT                             *
  7345*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7346*                            VMOD=2.003                          *
  7347*                                                                *
  7348*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7349*                                                                *
  7350*        FILE TYPE= VSAM,KSDS                                    *
  7351*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7352*                                                                *
  7353*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7354*                                                                *
  7355*        LOG = YES                                               *
  7356*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7357*                                                                *
  7358******************************************************************
  7359*                   C H A N G E   L O G
  7360*
  7361* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7362*-----------------------------------------------------------------
  7363*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7364* EFFECTIVE    NUMBER
  7365*-----------------------------------------------------------------
  7366* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7367******************************************************************
  7368
  7369 01  CERT-NOTE-FILE.
  7370     12  CZ-RECORD-ID                PIC  XX.
  7371         88  VALID-CZ-ID                  VALUE 'CZ'.
  7372
  7373     12  CZ-CONTROL-PRIMARY.
  7374         16  CZ-COMPANY-CD           PIC X.
  7375         16  CZ-CARRIER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 136
* EL6311.cbl
  7376         16  CZ-GROUPING.
  7377             20 CZ-GROUPING-PREFIX   PIC XXX.
  7378             20 CZ-GROUPING-PRIME    PIC XXX.
  7379         16  CZ-STATE                PIC XX.
  7380         16  CZ-ACCOUNT.
  7381             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7382             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7383         16  CZ-CERT-EFF-DT          PIC XX.
  7384         16  CZ-CERT-NO.
  7385             20  CZ-CERT-PRIME       PIC X(10).
  7386             20  CZ-CERT-SFX         PIC X.
  7387         16  CZ-RECORD-TYPE          PIC X.
  7388             88  CERT-NOTE           VALUE '1'.
  7389             88  CLAIM-CERT-NOTE     VALUE '2'.
  7390         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7391
  7392     12  CZ-LAST-MAINT-DT            PIC XX.
  7393     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7394     12  CZ-LAST-MAINT-USER          PIC X(4).
  7395
  7396     12  CZ-NOTE-INFORMATION.
  7397         16  CZ-NOTE                 PIC X(63).
  7398         16  FILLER                  PIC X(39).
  7399******************************************************************
  7400*                                COPY ELCMSTR.
  7401******************************************************************
  7402*                                                                *
  7403*                            ELCMSTR.                            *
  7404*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7405*                            VMOD=2.012                          *
  7406*                                                                *
  7407*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7408*                                                                *
  7409*   FILE TYPE = VSAM,KSDS                                        *
  7410*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7411*                                                                *
  7412*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7413*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7414*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7415*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7416*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7417*                                                 RKP=75,LEN=21  *
  7418*                                                                *
  7419*   **** NOTE ****                                               *
  7420*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7421*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7422*                                                                *
  7423*   LOG = YES                                                    *
  7424*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7425******************************************************************
  7426*                   C H A N G E   L O G
  7427*
  7428* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7429*-----------------------------------------------------------------
  7430*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7431* EFFECTIVE    NUMBER
  7432*-----------------------------------------------------------------
  7433* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 137
* EL6311.cbl
  7434* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7435* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7436******************************************************************
  7437 01  CLAIM-MASTER.
  7438     12  CL-RECORD-ID                PIC XX.
  7439         88  VALID-CL-ID         VALUE 'CL'.
  7440
  7441     12  CL-CONTROL-PRIMARY.
  7442         16  CL-COMPANY-CD           PIC X.
  7443         16  CL-CARRIER              PIC X.
  7444         16  CL-CLAIM-NO             PIC X(7).
  7445         16  CL-CERT-NO.
  7446             20  CL-CERT-PRIME       PIC X(10).
  7447             20  CL-CERT-SFX         PIC X.
  7448
  7449     12  CL-CONTROL-BY-NAME.
  7450         16  CL-COMPANY-CD-A1        PIC X.
  7451         16  CL-INSURED-LAST-NAME    PIC X(15).
  7452         16  CL-INSURED-NAME.
  7453             20  CL-INSURED-1ST-NAME PIC X(12).
  7454             20  CL-INSURED-MID-INIT PIC X.
  7455
  7456     12  CL-CONTROL-BY-SSN.
  7457         16  CL-COMPANY-CD-A2        PIC X.
  7458         16  CL-SOC-SEC-NO.
  7459             20  CL-SSN-STATE        PIC XX.
  7460             20  CL-SSN-ACCOUNT      PIC X(6).
  7461             20  CL-SSN-LN3          PIC X(3).
  7462
  7463     12  CL-CONTROL-BY-CERT-NO.
  7464         16  CL-COMPANY-CD-A4        PIC X.
  7465         16  CL-CERT-NO-A4.
  7466             20  CL-CERT-A4-PRIME    PIC X(10).
  7467             20  CL-CERT-A4-SFX      PIC X.
  7468
  7469     12  CL-CONTROL-BY-CCN.
  7470         16  CL-COMPANY-CD-A5        PIC X.
  7471         16  CL-CCN-A5.
  7472             20  CL-CCN.
  7473                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7474                 24  CL-CCN-PRIME-A5 PIC X(12).
  7475             20  CL-CCN-FILLER-A5    PIC X(4).
  7476
  7477     12  CL-INSURED-PROFILE-DATA.
  7478         16  CL-INSURED-BIRTH-DT     PIC XX.
  7479         16  CL-INSURED-SEX-CD       PIC X.
  7480             88  INSURED-IS-MALE        VALUE 'M'.
  7481             88  INSURED-IS-FEMALE      VALUE 'F'.
  7482             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7483         16  CL-INSURED-OCC-CD       PIC X(6).
  7484         16  FILLER                  PIC X(5).
  7485
  7486     12  CL-PROCESSING-INFO.
  7487         16  CL-PROCESSOR-ID         PIC X(4).
  7488         16  CL-CLAIM-STATUS         PIC X.
  7489             88  CLAIM-IS-OPEN          VALUE 'O'.
  7490             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7491         16  CL-CLAIM-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 138
* EL6311.cbl
  7492*            88  AH-CLAIM               VALUE 'A'.
  7493*            88  LIFE-CLAIM             VALUE 'L'.
  7494*            88  PROPERTY-CLAIM         VALUE 'P'.
  7495*            88  IUI-CLAIM              VALUE 'I'.
  7496*            88  GAP-CLAIM              VALUE 'G'.
  7497         16  CL-CLAIM-PREM-TYPE      PIC X.
  7498             88  SINGLE-PREMIUM         VALUE '1'.
  7499             88  O-B-COVERAGE           VALUE '2'.
  7500             88  OPEN-END-COVERAGE      VALUE '3'.
  7501         16  CL-INCURRED-DT          PIC XX.
  7502         16  CL-REPORTED-DT          PIC XX.
  7503         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7504         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7505         16  CL-LAST-PMT-DT          PIC XX.
  7506         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7507         16  CL-PAID-THRU-DT         PIC XX.
  7508         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7509         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7510         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7511         16  CL-PMT-CALC-METHOD      PIC X.
  7512             88  CL-360-DAY-YR          VALUE '1'.
  7513             88  CL-365-DAY-YR          VALUE '2'.
  7514             88  CL-FULL-MONTHS         VALUE '3'.
  7515         16  CL-CAUSE-CD             PIC X(6).
  7516
  7517         16  CL-PRIME-CERT-NO.
  7518             20  CL-PRIME-CERT-PRIME PIC X(10).
  7519             20  CL-PRIME-CERT-SFX   PIC X.
  7520
  7521         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7522             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7523             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7524
  7525         16  CL-MICROFILM-NO         PIC X(10).
  7526         16  CL-PROG-FORM-TYPE       PIC X.
  7527         16  CL-LAST-ADD-ON-DT       PIC XX.
  7528
  7529         16  CL-LAST-REOPEN-DT       PIC XX.
  7530         16  CL-LAST-CLOSE-DT        PIC XX.
  7531         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7532             88  FINAL-PAID             VALUE '1'.
  7533             88  CLAIM-DENIED           VALUE '2'.
  7534             88  AUTO-CLOSE             VALUE '3'.
  7535             88  MANUAL-CLOSE           VALUE '4'.
  7536             88  BENEFITS-CHANGED       VALUE 'C'.
  7537             88  SETUP-ERRORS           VALUE 'E'.
  7538         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7539         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7540         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7541             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7542         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7543         16  FILLER                  PIC X.
  7544
  7545     12  CL-CERTIFICATE-DATA.
  7546         16  CL-CERT-ORIGIN          PIC X.
  7547             88  CERT-WAS-ONLINE        VALUE '1'.
  7548             88  CERT-WAS-CREATED       VALUE '2'.
  7549             88  COVERAGE-WAS-ADDED     VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 139
* EL6311.cbl
  7550         16  CL-CERT-KEY-DATA.
  7551             20  CL-CERT-CARRIER     PIC X.
  7552             20  CL-CERT-GROUPING    PIC X(6).
  7553             20  CL-CERT-STATE       PIC XX.
  7554             20  CL-CERT-ACCOUNT.
  7555                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7556                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7557             20  CL-CERT-EFF-DT      PIC XX.
  7558
  7559     12  CL-STATUS-CONTROLS.
  7560         16  CL-PRIORITY-CD          PIC X.
  7561             88  CONFIDENTIAL-DATA      VALUE '8'.
  7562             88  HIGHEST-PRIORITY       VALUE '9'.
  7563         16  CL-SUPV-ATTN-CD         PIC X.
  7564             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7565             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7566         16  CL-PURGED-DT            PIC XX.
  7567         16  CL-RESTORED-DT          PIC XX.
  7568         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7569         16  CL-NEXT-RESEND-DT       PIC XX.
  7570         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7571         16  CL-CRITICAL-PERIOD      PIC 99.
  7572*        16  FILLER                  PIC XX.
  7573         16  CL-LAST-MAINT-DT        PIC XX.
  7574         16  CL-LAST-MAINT-USER      PIC X(4).
  7575         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7576         16  CL-LAST-MAINT-TYPE      PIC X.
  7577             88  CLAIM-SET-UP           VALUE ' '.
  7578             88  PAYMENT-MADE           VALUE '1'.
  7579             88  LETTER-SENT            VALUE '2'.
  7580             88  MASTER-WAS-ALTERED     VALUE '3'.
  7581             88  MASTER-WAS-RESTORED    VALUE '4'.
  7582             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7583             88  FILE-CONVERTED         VALUE '6'.
  7584             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7585             88  ERROR-CORRECTION       VALUE 'E'.
  7586         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7587         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7588         16  CL-BENEFICIARY          PIC X(10).
  7589         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7590         16  CL-DENIAL-TYPE          PIC X.
  7591             88  CL-TYPE-DENIAL          VALUE '1'.
  7592             88  CL-TYPE-RESCISSION      VALUE '2'.
  7593             88  CL-TYPE-REFORMATION     VALUE '3'.
  7594             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7595             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7596         16  CL-CRIT-PER-RECURRENT   PIC X.
  7597         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7598         16  CL-RTW-DT               PIC XX.
  7599
  7600     12  CL-TRAILER-CONTROLS.
  7601         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7602             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7603             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7604             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7605         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7606         16  FILLER                  PIC XX.
  7607         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 140
* EL6311.cbl
  7608         16  CL-ADDRESS-TRAILER-CNT.
  7609             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7610                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7611             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7612                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7613             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7614                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7615             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7616                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7617             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7618                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7619             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7620                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7621             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7622                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7623
  7624     12  CL-CV-REFERENCE-NO.
  7625         16  CL-CV-REFNO-PRIME       PIC X(18).
  7626         16  CL-CV-REFNO-SFX         PIC XX.
  7627
  7628     12  CL-FILE-LOCATION            PIC X(4).
  7629
  7630     12  CL-PROCESS-ERRORS.
  7631         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7632             88  NO-FATAL-ERRORS        VALUE ZERO.
  7633         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7634             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7635
  7636     12  CL-PRODUCT-CD               PIC X.
  7637
  7638     12  CL-CURRENT-KEY-DATA.
  7639         16  CL-CURRENT-CARRIER      PIC X.
  7640         16  CL-CURRENT-GROUPING     PIC X(6).
  7641         16  CL-CURRENT-STATE        PIC XX.
  7642         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7643
  7644     12  CL-ASSOCIATES               PIC X.
  7645         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7646         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7647         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7648         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7649
  7650     12  CL-ACTIVITY-CODE            PIC 99.
  7651     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7652     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7653
  7654     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7655     12  CL-LAG-REPORT-CODE          PIC 9.
  7656     12  CL-LOAN-TYPE                PIC XX.
  7657     12  CL-LEGAL-STATE              PIC XX.
  7658
  7659     12  CL-YESNOSW                  PIC X.
  7660     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7661         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7662         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7663         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7664     12  cl-insured-claim            pic x.
  7665         88  cl-claim-on-primary         value 'P'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 141
* EL6311.cbl
  7666         88  cl-claim-on-secondary       value 'S'.
  7667     12  cl-benefit-expiration-dt    PIC XX.
  7668*                                COPY ERCENDT.
  7669******************************************************************
  7670*                                                                *
  7671*                                                                *
  7672*                            ERCENDT.                            *
  7673*                            VMOD=2.001                          *
  7674*                                                                *
  7675*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7676*                                                                *
  7677*   FILE TYPE = VSAM,KSDS                                        *
  7678*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7679*                                                                *
  7680*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7681*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7682*                                                                *
  7683*   LOG = NO                                                     *
  7684*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7685******************************************************************
  7686*-----------------------------------------------------------------
  7687*                   C H A N G E   L O G
  7688*
  7689* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7690*-----------------------------------------------------------------
  7691*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7692* EFFECTIVE    NUMBER
  7693*-----------------------------------------------------------------
  7694* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7695*                                WITH OPEN CLAIMS
  7696* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7697* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7698* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7699*-----------------------------------------------------------------
  7700 01  ENDORSEMENT-RECORD.
  7701     12  EN-RECORD-ID                PIC XX.
  7702         88  VALID-EN-ID                VALUE 'EN'.
  7703     12  EN-CONTROL-PRIMARY.
  7704         16  EN-COMPANY-CD           PIC X.
  7705         16  EN-CARRIER              PIC X.
  7706         16  EN-GROUPING             PIC X(6).
  7707         16  EN-STATE                PIC XX.
  7708         16  EN-ACCOUNT              PIC X(10).
  7709         16  EN-CERT-EFF-DT          PIC XX.
  7710         16  EN-CERT-NO.
  7711             20  EN-CERT-PRIME       PIC X(10).
  7712             20  EN-CERT-SFX         PIC X.
  7713         16  EN-REC-TYPE             PIC X.
  7714             88  EN-ISSUE               VALUE 'I'.
  7715             88  EN-CANCELLATION        VALUE 'C'.
  7716         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7717     12  EN-CONTROL-BY-ARCH-NO.
  7718         16  EN-COMPANY-CD-A1              PIC X.
  7719         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7720     12  EN-LAST-MAINT-DT            PIC XX.
  7721     12  EN-LAST-MAINT-BY            PIC X(4).
  7722     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7723     12  EN-ENDORSEMENT-RECORD       PIC X(329).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 142
* EL6311.cbl
  7724     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7725         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7726         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7727         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7728         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7729         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7730         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7731         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7732         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7733         16  EN-LF-ORIG-BENCD        PIC XX.
  7734         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7735         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7736         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7737         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7738         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7739         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7740*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7741         16  EN-ORIG-CRED-BENE       PIC X(25).
  7742         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7743         16  FILLER                  PIC X.
  7744         16  EN-AH-ORIG-BENCD        PIC XX.
  7745         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7746         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7747         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7748         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7749*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7750*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7751         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7752         16  F                       PIC X(09).
  7753         16  EN-AH-ORIG-CP           PIC 99.
  7754         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7755         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7756         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7757         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7758         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7759         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7760         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7761         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7762         16  EN-LF-NEW-BENCD         PIC XX.
  7763         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7764         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7765         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7766         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7767         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7768         16  EN-LF-NEW-EXP-DT        PIC XX.
  7769         16  EN-NEW-CRED-BENE        PIC X(25).
  7770         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7771         16  FILLER                  PIC X.
  7772         16  EN-AH-NEW-BENCD         PIC XX.
  7773         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7774         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7775         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7776         16  EN-AH-NEW-EXP-DT        PIC XX.
  7777*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7778*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7779*        16  F                       PIC X(12).
  7780         16  EN-AH-NEW-CP            PIC 99.
  7781         16  EN-SIG-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 143
* EL6311.cbl
  7782         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7783         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7784         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7785         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7786         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7787         16  FILLER                  PIC X(33).
  7788     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7789         16  EN-LF-ORIG-REF-DT       PIC XX.
  7790         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7791         16  EN-AH-ORIG-REF-DT       PIC XX.
  7792         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7793         16  EN-LF-NEW-REF-DT        PIC XX.
  7794         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7795         16  EN-AH-NEW-REF-DT        PIC XX.
  7796         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7797         16  EN-FLAG-CERT            PIC X.
  7798         16  EN-INS-LAST-NAME        PIC X(15).
  7799         16  EN-INS-FIRST-NAME       PIC X(10).
  7800         16  EN-INS-MIDDLE-INIT      PIC X.
  7801         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7802         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7803         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7804         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7805         16  FILLER                  PIC X(262).
  7806     12  EN-MONEY-SW             PIC X.
  7807     12  EN-HEALTH-APP           PIC X.
  7808     12  EN-VOUCHER-SW           PIC X.
  7809     12  EN-PAYEE                PIC X(14).
  7810     12  EN-INPUT-DT             PIC XX.
  7811     12  EN-PROCESS-DT           PIC XX.
  7812     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7813     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7814     12  EN-REASON-CODES.
  7815         16  F OCCURS 12.
  7816             20  EN-REASON-CODE  PIC X(4).
  7817     12  EN-TEMPLATE-USED        PIC X(8).
  7818     12  EN-DOCU-TYPE            PIC X.
  7819         88  EN-VERI-DOCU          VALUE 'V'.
  7820         88  EN-GCE-DOCU           VALUE 'G'.
  7821         88  EN-CANC-DOCU          VALUE 'C'.
  7822     12  EN-COMMENTS1            PIC X(13).
  7823     12  EN-COMMENTS2            PIC X(70).
  7824     12  EN-COMM-CHGBK           PIC X.
  7825         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7826         88  EN-CHG-ACCT           VALUE 'Y'.
  7827     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7828     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7829     12  EN-BATCH-NUMBER         PIC X(6).
  7830     12  EN-ACCT-SUMM            PIC X.
  7831     12  EN-CSO-SUMM             PIC X.
  7832     12  FILLER                  PIC X(13).
  7833******************************************************************
  7834*                                COPY ELCCRTT.
  7835******************************************************************
  7836*                                                                *
  7837*                            ELCCRTT.                            *
  7838*                                                                *
  7839*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 144
* EL6311.cbl
  7840*                                                                *
  7841*   FILE TYPE = VSAM,KSDS                                        *
  7842*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7843*                                                                *
  7844*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7845*                                                                *
  7846*   LOG = YES                                                    *
  7847*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7848******************************************************************
  7849*                   C H A N G E   L O G
  7850*
  7851* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7852*-----------------------------------------------------------------
  7853*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7854* EFFECTIVE    NUMBER
  7855*-----------------------------------------------------------------
  7856* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7857* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7858* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7859* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7860* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7861******************************************************************
  7862
  7863 01  CERTIFICATE-TRAILERS.
  7864     12  CS-RECORD-ID                      PIC XX.
  7865         88  VALID-CS-ID                      VALUE 'CS'.
  7866
  7867     12  CS-CONTROL-PRIMARY.
  7868         16  CS-COMPANY-CD                 PIC X.
  7869         16  CS-CARRIER                    PIC X.
  7870         16  CS-GROUPING                   PIC X(6).
  7871         16  CS-STATE                      PIC XX.
  7872         16  CS-ACCOUNT                    PIC X(10).
  7873         16  CS-CERT-EFF-DT                PIC XX.
  7874         16  CS-CERT-NO.
  7875             20  CS-CERT-PRIME             PIC X(10).
  7876             20  CS-CERT-SFX               PIC X.
  7877         16  CS-TRAILER-TYPE               PIC X.
  7878             88  COMM-TRLR           VALUE 'A'.
  7879             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7880             88  CERT-DATA-TRLR      VALUE 'C'.
  7881
  7882     12  CS-DATA-AREA                      PIC X(516).
  7883
  7884     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7885         16  CS-BANK-COMMISSION-AREA.
  7886             20  CS-BANK-COMMS       OCCURS 10.
  7887                 24  CS-AGT                PIC X(10).
  7888                 24  CS-COM-TYP            PIC X.
  7889                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7890                 24  CS-RECALC-LV-INDIC    PIC X.
  7891                 24  FILLER                PIC X(10).
  7892         16  FILLER                        PIC X(256).
  7893
  7894     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7895****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7896****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7897         16  CS-MB-CLAIM-DATA OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 145
* EL6311.cbl
  7898             20  FILLER OCCURS 10.
  7899                 24  CS-CLAIM-TYPE         PIC X.
  7900                     88  CS-AH-CLM           VALUE 'A'.
  7901                     88  CS-IU-CLM           VALUE 'I'.
  7902                     88  CS-GP-CLM           VALUE 'G'.
  7903                     88  CS-LF-CLM           VALUE 'L'.
  7904                     88  CS-PR-CLM           VALUE 'P'.
  7905                 24  CS-BANK               PIC S999 COMP-3.
  7906                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7907                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7908                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7909         16  FILLER                        PIC X(216).
  7910     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7911         16  CS-VIN-NUMBER                 PIC X(17).
  7912         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7913         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7914         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7915         16  FILLER                        PIC X(496).
  7916******************************************************************
  7917*                                COPY ERCCHEK.
  7918******************************************************************
  7919*                                                                *
  7920*                                                                *
  7921*                            ERCCHEK                             *
  7922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7923*                            VMOD=2.008                          *
  7924*                                                                *
  7925*   FILE DESCRIPTION = CHECK RECORDS                             *
  7926*                                                                *
  7927*   FILE TYPE = VSAM,KSDS                                        *
  7928*   RECORD SIZE = 600    RECFORM = FIXED                         *
  7929*                                                                *
  7930*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  7931*       ALTERNATE INDEX = NONE                                   *
  7932*                                                                *
  7933*   LOG = YES                                                    *
  7934*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7935******************************************************************
  7936*                   C H A N G E   L O G
  7937*
  7938* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7939*-----------------------------------------------------------------
  7940*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7941* EFFECTIVE    NUMBER
  7942*-----------------------------------------------------------------
  7943* 021414    2003053000001  PEMA  changes for auto chk request
  7944******************************************************************
  7945 01  CHECK-RECORDS.
  7946     12  CH-RECORD-ID                      PIC XX.
  7947         88  VALID-CH-ID                      VALUE 'CH'.
  7948
  7949     12  CH-CONTROL-PRIMARY.
  7950         16  CH-COMPANY-CD                 PIC X.
  7951         16  CH-CARRIER                    PIC X.
  7952         16  CH-GROUPING                   PIC X(6).
  7953         16  CH-STATE                      PIC XX.
  7954         16  CH-ACCOUNT                    PIC X(10).
  7955         16  CH-CERT-EFF-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 146
* EL6311.cbl
  7956         16  CH-CERT-NO.
  7957             20  CH-CERT-PRIME             PIC X(10).
  7958             20  CH-CERT-SFX               PIC X.
  7959         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  7960
  7961     12  CH-RECORDED-DT                    PIC XX.
  7962     12  CH-RECORDED-BY                    PIC X(4).
  7963     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  7964
  7965     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  7966     12  CH-CHECK-NO                       PIC X(7).
  7967     12  CH-REASON-FOR-CHECK               PIC X(25).
  7968     12  CH-CHECK-WRITTEN-DT               PIC XX.
  7969     12  FILLER                            PIC X.
  7970
  7971     12  CH-PAYEE-INFO.
  7972         16  CH-PAYEE-NAME-1               PIC X(30).
  7973         16  CH-PAYEE-NAME-2               PIC X(30).
  7974         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  7975         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  7976         16  CH-PAYEE-CITY-ST.
  7977             20  CH-PAYEE-CITY             PIC X(28).
  7978             20  CH-PAYEE-STATE            PIC XX.
  7979         16  CH-PAYEE-ZIP-CODE.
  7980             20  CH-PAYEE-ZIP.
  7981                 24  CH-ZIP-PRI-1ST        PIC X.
  7982                     88  CH-CANADIAN-POST-CODE
  7983                                           VALUES 'A' THRU 'Z'.
  7984                 24  FILLER                PIC X(4).
  7985             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  7986         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  7987             20  CH-CAN-POSTAL-1           PIC XXX.
  7988             20  CH-CAN-POSTAL-2           PIC XXX.
  7989             20  FILLER                    PIC XXX.
  7990
  7991     12  CH-CHECK-STUB-TEXT.
  7992         16  CH-STUB-LINE-1                PIC X(30).
  7993         16  CH-TEXT-LINE-1                PIC X(50).
  7994         16  CH-TEXT-LINE-2                PIC X(50).
  7995         16  CH-TEXT-LINE-3                PIC X(40).
  7996     12  CH-RETURN-TO                      PIC X(30).
  7997
  7998     12  CH-COMPENSATION-CONTROL.
  7999         16  CH-COMP-CARRIER               PIC X.
  8000         16  CH-COMP-GROUPING              PIC X(6).
  8001         16  CH-COMP-FIN-RESP              PIC X(10).
  8002         16  CH-COMP-ACCOUNT               PIC X(10).
  8003
  8004     12  CH-CREDIT-SELECT-DT               PIC XX.
  8005     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8006     12  CH-PAYEE-CODE                     PIC X(6).
  8007
  8008     12  CH-VOID-DATA.
  8009         20  CH-VOID-DT                    PIC XX.
  8010         20  CH-VOID-BY                    PIC X(4).
  8011         20  CH-VOID-REASON                PIC X(25).
  8012
  8013     12  CH-APPROVAL-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 147
* EL6311.cbl
  8014         20  CH-APPROVAL-DT                PIC XX.
  8015         20  CH-APPROVAL-STATUS            PIC X.
  8016             88  CH-IN-LIMBO                  VALUE ' '.
  8017             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8018             88  CH-APPROVED                  VALUE 'A'.
  8019             88  CH-DENIED                    VALUE 'D'.
  8020         20  CH-APPROVED-BY                PIC XXXX.
  8021     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8022             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8023     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8024
  8025     12  ch-released-dt                    pic xx.
  8026     12  ch-check-cashed-dt                pic xx.
  8027     12  FILLER                            PIC X.
  8028*    12  CH-CHECK-REFERENCE                PIC X(12).
  8029     12  CH-CHECK-ORIGIN-SW                PIC X.
  8030             88  CH-REFUND-CHECK              VALUE 'R'.
  8031             88  CH-MAINT-CHECK               VALUE 'M'.
  8032
  8033     12  CH-CANC-DT                        PIC XX.
  8034     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8035     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8036
  8037     12  CH-INSURED-NAME                   PIC X(28).
  8038
  8039     12  ch-released-by                    pic x(4).
  8040     12  ch-csr                            pic x(4).
  8041     12  ch-deduct-commission              pic x.
  8042         88  ch-deduct-comm                  value 'Y'.
  8043         88  ch-do-not-deduct-comm           value 'N'.
  8044
  8045     12  FILLER                            PIC X(11).
  8046*    12  CH-LETTER-TABLE.
  8047*        16  CH-LETTERS OCCURS 3 TIMES
  8048*                       INDEXED BY CH-LT-NDX
  8049*                                          PIC X(04).
  8050
  8051     12  FILLER                            PIC X(07).
  8052
  8053 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8054                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8055                          PENDING-MAILING-DATA MAILING-DATA
  8056                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8057                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8058                          CLAIM-MASTER ENDORSEMENT-RECORD
  8059                          CERTIFICATE-TRAILERS CHECK-RECORDS.
  8060 0000-DFHEXIT SECTION.
  8061     MOVE '9#                    $   ' TO DFHEIV0.
  8062     MOVE 'EL6311' TO DFHEIV1.
  8063     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8064
  8065     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8066     MOVE EIBTRMID               TO QID-TERM.
  8067     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8068     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8069     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8070     MOVE 2                      TO EMI-SWITCH2.
  8071
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 148
* EL6311.cbl
  8072     IF EIBCALEN = 0
  8073         GO TO 8800-UNAUTHORIZED-ACCESS.
  8074
  8075     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8076     MOVE '5'                   TO DC-OPTION-CODE.
  8077     PERFORM 9700-DATE-LINK.
  8078     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8079     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8080
  8081     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8082     MOVE SPACE                  TO DC-OPTION-CODE.
  8083     PERFORM 9700-DATE-LINK.
  8084     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8085     MOVE LOW-VALUES             TO EL631BI.
  8086
  8087
  8088* EXEC CICS HANDLE CONDITION
  8089*        PGMIDERR  (9600-PGMID-ERROR)
  8090*        ERROR     (9990-ABEND)
  8091*        INVREQ    (9990-ABEND)
  8092*        QIDERR    (0010-MAIN-LOGIC)
  8093*    END-EXEC.
  8094*    MOVE '"$L.8N                ! " #00008083' TO DFHEIV0
  8095     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8097     MOVE X'2220233030303038303833' TO DFHEIV0(25:11)
  8098     CALL 'kxdfhei1' USING DFHEIV0
  8099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8100
  8101
  8102     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8103         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8104             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8105             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8106             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8107             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8108             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8109             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8110             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8111             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8112
  8113             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8114                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8115
  8116             ELSE
  8117                 NEXT SENTENCE
  8118
  8119         ELSE
  8120             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8121             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8122             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8123             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8124             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8125             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8126             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8127             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8128             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8129             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 149
* EL6311.cbl
  8130             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8131             GO TO 3900-RE-DISPLAY-RECORD
  8132     ELSE
  8133         GO TO 0020-MAIN-LOGIC.
  8134
  8135 0010-MAIN-LOGIC.
  8136     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8137                                    WS-FIRST-ENTRY-SW.
  8138
  8139     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8140
  8141     MOVE LOW-VALUES             TO EC-NEW-CERT
  8142                                    EC-NEW-STATE.
  8143
  8144     IF PI-DISPLAY-ORIGINAL-BATCH
  8145         NEXT SENTENCE
  8146     ELSE
  8147         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8148             GO TO 5000-BROWSE-BATCH-HEADERS.
  8149
  8150     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8151         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8152
  8153     IF PI-CSR-BROWSE
  8154        GO TO 4200-BROWSE-CSR-FORWARD.
  8155
  8156     IF PI-FILE-BROWSE
  8157         GO TO 4300-BROWSE-FILE-FORWARD.
  8158
  8159     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8160
  8161 0020-MAIN-LOGIC.
  8162     IF EIBAID = DFHCLEAR
  8163         GO TO 9400-CLEAR.
  8164
  8165     MOVE LOW-VALUES             TO EC-NEW-CERT
  8166                                    EC-NEW-STATE.
  8167
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 150
* EL6311.cbl
  8169
  8170******************************************************************
  8171*                                                                *
  8172*              R E C E I V E   M A P                             *
  8173*                                                                *
  8174******************************************************************
  8175
  8176 0200-RECEIVE.
  8177     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8178         MOVE ER-0008            TO EMI-ERROR
  8179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8180         IF PI-MAP-NAME = EL631B
  8181             MOVE -1                 TO BMAINTL
  8182             GO TO 8200-SEND-DATAONLY
  8183         ELSE
  8184             IF PI-MAP-NAME = EL631C
  8185                 MOVE -1                 TO CMAINTL
  8186                 GO TO 8200-SEND-DATAONLY
  8187             ELSE
  8188                 IF PI-MAP-NAME = EL631D
  8189                     MOVE -1                 TO DPFENTRL
  8190                     GO TO 8200-SEND-DATAONLY.
  8191
  8192
  8193* EXEC CICS RECEIVE
  8194*        MAP      (PI-MAP-NAME)
  8195*        MAPSET   (MAPSET-EL6311S)
  8196*        INTO     (EL631BI)
  8197*    END-EXEC.
  8198     MOVE LENGTH OF
  8199      EL631BI
  8200       TO DFHEIV11
  8201*    MOVE '8"T I  L              ''   #00008180' TO DFHEIV0
  8202     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8203     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8204     MOVE X'2020233030303038313830' TO DFHEIV0(25:11)
  8205     CALL 'kxdfhei1' USING DFHEIV0,
  8206           PI-MAP-NAME,
  8207           EL631BI,
  8208           DFHEIV11,
  8209           MAPSET-EL6311S,
  8210           DFHEIV99,
  8211           DFHEIV99
  8212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8213
  8214
  8215******************************************************************
  8216*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8217******************************************************************
  8218
  8219     IF BTYPE-LEN (1) EQUAL +3
  8220        IF BTYPE (1) EQUAL ALL ' '
  8221            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8222
  8223     IF BTYPE-LEN (2) EQUAL +3
  8224        IF BTYPE (2) EQUAL ALL ' '
  8225            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8226
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 151
* EL6311.cbl
  8227     INSPECT EL631BI CONVERTING '_' TO ' '.
  8228
  8229     IF PI-MAP-NAME = EL631B
  8230         IF BPFENTRL GREATER THAN ZEROS
  8231             IF EIBAID NOT = DFHENTER
  8232                 MOVE ER-0004       TO EMI-ERROR
  8233                 MOVE -1            TO BPFENTRL
  8234                 MOVE AL-UNBOF      TO BPFENTRA
  8235                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8236                 GO TO 8200-SEND-DATAONLY
  8237             ELSE
  8238                 IF BPFENTRI NUMERIC AND
  8239                   (BPFENTRI GREATER 0 AND LESS 25)
  8240                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8241                 ELSE
  8242                     MOVE ER-0029  TO EMI-ERROR
  8243                     MOVE AL-UNBON TO BPFENTRA
  8244                     MOVE -1       TO BPFENTRL
  8245                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8246                     GO TO 8200-SEND-DATAONLY
  8247         ELSE
  8248             NEXT SENTENCE
  8249     ELSE
  8250         IF PI-MAP-NAME = EL631C
  8251            IF CPFENTRL GREATER THAN ZEROS
  8252                IF EIBAID NOT = DFHENTER
  8253                 MOVE ER-0004         TO EMI-ERROR
  8254                 MOVE -1              TO CPFENTRL
  8255                 MOVE AL-UNBOF        TO CPFENTRA
  8256                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8257                 GO TO 8200-SEND-DATAONLY
  8258             ELSE
  8259                 IF CPFENTRI NUMERIC AND
  8260                   (CPFENTRI GREATER 0 AND LESS 25)
  8261                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8262                 ELSE
  8263                     MOVE ER-0029      TO EMI-ERROR
  8264                     MOVE AL-UNBON     TO CPFENTRA
  8265                     MOVE -1           TO CPFENTRL
  8266                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8267                     GO TO 8200-SEND-DATAONLY
  8268         ELSE
  8269             NEXT SENTENCE
  8270     ELSE
  8271     IF PI-MAP-NAME = EL631D
  8272         IF DPFENTRL GREATER THAN ZEROS
  8273             IF EIBAID NOT = DFHENTER
  8274                 MOVE ER-0004         TO EMI-ERROR
  8275                 MOVE -1              TO DPFENTRL
  8276                 MOVE AL-UNBOF        TO DPFENTRA
  8277                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8278                 GO TO 8200-SEND-DATAONLY
  8279             ELSE
  8280                 IF DPFENTRI NUMERIC AND
  8281                   (DPFENTRI GREATER 0 AND LESS 25)
  8282                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8283                 ELSE
  8284                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 152
* EL6311.cbl
  8285                     MOVE AL-UNBON     TO DPFENTRA
  8286                     MOVE -1           TO DPFENTRL
  8287                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8288                     GO TO 8200-SEND-DATAONLY.
  8289
  8290     IF EIBAID = DFHPF23
  8291         GO TO 8810-PF23.
  8292
  8293     IF EIBAID = DFHPF24
  8294         GO TO 9200-RETURN-MAIN-MENU.
  8295
  8296     IF EIBAID = DFHPF12
  8297         GO TO 9500-PF12.
  8298
  8299     IF PI-MAP-NAME = EL631B
  8300        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8301
  8302     IF PI-MAP-NAME = EL631C
  8303        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8304
  8305     IF PI-MAP-NAME = EL631D
  8306        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8307
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 153
* EL6311.cbl
  8309
  8310******************************************************************
  8311*                                                                *
  8312*      ISSUE SCREEN PF KEY CHECKING                              *
  8313*                                                                *
  8314******************************************************************
  8315
  8316******************************************************************
  8317*                                                                *
  8318*      PF KEY FUNCTIONS:                                         *
  8319*                                                                *
  8320*      PF1  = BROWSE FORWARD                                     *
  8321*      PF2  = BROWSE BACKWARD                                    *
  8322*      PF3  = CERTIFICATE LOOKUP                                 *
  8323*      PF4  = DISPLAY BATCH HEADER                               *
  8324*      PF5  = ADD ISSUE  SCREEN                                  *
  8325*      PF6  = ADD CANCEL SCREEN                                  *
  8326*      PF7  = CERTIFICATE DISPLAY                                *
  8327*      PF8  = CERTIFICATE NOTES                                  *
  8328*      PF9  = EDIT CONTROL                                       *
  8329*      PF10 = DISPLAY LETTER SCREEN                              *
  8330*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8331*      PF12 = HELP SCREEN                                        *
  8332*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8333*      PF14 = ACCOUNT MASTER                                     *
  8334*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8335*      PF16 = DISPLAY LETTER REVIEW                              *
  8336*                                                                *
  8337******************************************************************
  8338
  8339 0300-CHECK-ISSUE-PF-KEYS.
  8340     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8341        MOVE ER-2337            TO EMI-ERROR
  8342        MOVE -1                  TO BMAINTL
  8343        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8344        GO TO 8200-SEND-DATAONLY.
  8345
  8346     IF EIBAID = DFHPF1
  8347        MOVE '0'                TO PI-EDIT-SW
  8348        IF PI-PRIMARY-BROWSE
  8349           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8350        ELSE
  8351           IF PI-PRIMARY-WITH-SELECT
  8352              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8353           ELSE
  8354              IF PI-FILE-BROWSE
  8355                 GO TO 4300-BROWSE-FILE-FORWARD
  8356              ELSE
  8357                 IF PI-CSR-BROWSE
  8358                    GO TO 4200-BROWSE-CSR-FORWARD
  8359                 ELSE
  8360                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8361
  8362     IF EIBAID = DFHPF2
  8363        MOVE '0'                TO PI-EDIT-SW
  8364        IF PI-PRIMARY-BROWSE
  8365           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8366        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 154
* EL6311.cbl
  8367           IF PI-PRIMARY-WITH-SELECT
  8368              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8369           ELSE
  8370              IF PI-FILE-BROWSE
  8371                 GO TO 4800-BROWSE-FILE-BACKWARD
  8372              ELSE
  8373                 IF PI-CSR-BROWSE
  8374                    GO TO 4900-BROWSE-CSR-BACKWARD
  8375                 ELSE
  8376                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8377
  8378     IF EIBAID = DFHPF3
  8379        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8380        MOVE XCTL-EL127         TO PGM-NAME
  8381        GO TO 9300-XCTL.
  8382
  8383     IF (EIBAID = DFHPF15 OR DFHPF6)
  8384        AND (CSR-EDIT-SESSION)
  8385*       AND (FATAL-OR-UNFORCED)
  8386        AND (FATAL-ERRORS)
  8387        MOVE ER-1819             TO EMI-ERROR
  8388        MOVE -1                  TO BMAINTL
  8389        MOVE AL-UANON            TO BMAINTA
  8390        PERFORM 9900-ERROR-FORMAT
  8391                                 THRU 9900-EXIT
  8392        GO TO 8200-SEND-DATAONLY
  8393     END-IF
  8394     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8395      OR (EIBAID = DFHPF10)
  8396        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8397        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8398        IF (RESP-NORMAL)
  8399           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8400              AM-CONTROL-PRIMARY (1:20))
  8401            IF AM-NAME NOT GREATER THAN SPACES OR
  8402               AM-ADDRS NOT GREATER THAN SPACES  OR
  8403               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8404               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8405               AM-ZIP NOT GREATER THAN SPACES
  8406               MOVE ER-3834             TO EMI-ERROR
  8407               MOVE -1                  TO BMAINTL
  8408               MOVE AL-UANON            TO BMAINTA
  8409               PERFORM 9900-ERROR-FORMAT
  8410                                 THRU 9900-EXIT
  8411               GO TO 8200-SEND-DATAONLY
  8412            END-IF
  8413        ELSE
  8414           MOVE ER-1609             TO EMI-ERROR
  8415           MOVE -1                  TO BMAINTL
  8416           MOVE AL-UANON            TO BMAINTA
  8417           PERFORM 9900-ERROR-FORMAT
  8418                                THRU 9900-EXIT
  8419           GO TO 8200-SEND-DATAONLY
  8420        END-IF
  8421
  8422        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8423        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8424        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 155
* EL6311.cbl
  8425            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8426               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8427               MA-CITY NOT GREATER THAN SPACES OR
  8428               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8429               MA-ZIP-CODE NOT GREATER THAN SPACES
  8430               MOVE ER-3835             TO EMI-ERROR
  8431               MOVE -1                  TO BMAINTL
  8432               MOVE AL-UANON            TO BMAINTA
  8433               PERFORM 9900-ERROR-FORMAT
  8434                                 THRU 9900-EXIT
  8435               GO TO 8200-SEND-DATAONLY
  8436            END-IF
  8437        ELSE
  8438           MOVE ER-3000             TO EMI-ERROR
  8439           MOVE -1                  TO BMAINTL
  8440           MOVE AL-UANON            TO BMAINTA
  8441           PERFORM 9900-ERROR-FORMAT
  8442                                THRU 9900-EXIT
  8443           GO TO 8200-SEND-DATAONLY
  8444        END-IF
  8445
  8446     END-IF
  8447     IF (EIBAID = DFHPF15)
  8448        AND (CSR-EDIT-SESSION)
  8449        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8450        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8451        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8452        MOVE PI-SV-STATE         TO PI-STATE
  8453        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8454        MOVE BCERTNOI            TO PI-CERT-PRIME
  8455        MOVE BSUFIXI             TO PI-CERT-SFX
  8456        MOVE BEFFDTI             TO DEEDIT-FIELD
  8457        PERFORM 8600-DEEDIT
  8458        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8459        MOVE '4'                 TO DC-OPTION-CODE
  8460        PERFORM 9700-DATE-LINK
  8461        IF DATE-CONVERSION-ERROR
  8462           MOVE ER-0348          TO EMI-ERROR
  8463           MOVE -1               TO BEFFDTL
  8464           MOVE AL-UABON         TO BEFFDTA
  8465           PERFORM 9900-ERROR-FORMAT
  8466                                 THRU 9900-EXIT
  8467           GO TO 8200-SEND-DATAONLY
  8468        ELSE
  8469           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8470           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8471           MOVE XCTL-EL6315      TO PGM-NAME
  8472           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8473           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8474           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8475           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8476           GO TO 9300-XCTL
  8477        END-IF
  8478     END-IF
  8479
  8480     IF EIBAID = DFHPF4
  8481        MOVE '0'                TO PI-EDIT-SW
  8482        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 156
* EL6311.cbl
  8483           NEXT SENTENCE
  8484        ELSE
  8485           GO TO 7200-DISPLAY-BATCHES.
  8486
  8487     IF EIBAID = DFHPF5
  8488        MOVE ER-0029                TO EMI-ERROR
  8489        MOVE -1                     TO BPFENTRL
  8490        MOVE AL-UNBON               TO BPFENTRA
  8491        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8492        GO TO 8200-SEND-DATAONLY.
  8493*        MOVE '0'                TO PI-EDIT-SW
  8494*        IF PI-DISPLAY-ORIGINAL-BATCH
  8495*           NEXT SENTENCE
  8496*        ELSE
  8497*           MOVE EL631B              TO PI-MAP-NAME
  8498*           MOVE LOW-VALUES          TO EL631BI
  8499*           MOVE 'A'                 TO BMAINTO
  8500*           MOVE AL-UANON            TO BMAINTA
  8501*           MOVE -1                  TO BMAINTL
  8502*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8503*           GO TO 8100-SEND-INITIAL-MAP.
  8504
  8505     IF EIBAID = DFHPF6
  8506        IF NOT CSR-EDIT-SESSION
  8507           MOVE ER-0029                TO EMI-ERROR
  8508           MOVE -1                     TO BPFENTRL
  8509           MOVE AL-UNBON               TO BPFENTRA
  8510           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8511           GO TO 8200-SEND-DATAONLY
  8512*           MOVE '0'              TO PI-EDIT-SW
  8513*           IF PI-DISPLAY-ORIGINAL-BATCH
  8514*              NEXT SENTENCE
  8515*           ELSE
  8516*              MOVE EL631C        TO PI-MAP-NAME
  8517*              MOVE LOW-VALUES    TO EL631CI
  8518*              MOVE 'A'           TO CMAINTO
  8519*              MOVE AL-UANON      TO CMAINTA
  8520*              MOVE -1            TO CMAINTL
  8521*              MOVE '6'           TO PI-MAINT-FUNCTION
  8522*              GO TO 8100-SEND-INITIAL-MAP
  8523*           END-IF
  8524        ELSE
  8525           PERFORM 5100-PROCESS-POL-RESC
  8526                                 THRU 5100-EXIT
  8527           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8528           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8529                                    PI-PREV-SEQ-NO
  8530           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8531*                                    WS-CANCEL-LETTER-SW
  8532                                    PI-ALL-ISSUES-SW
  8533                                    PI-ALL-CANCELS-SW
  8534           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8535        END-IF
  8536     END-IF
  8537     IF EIBAID = DFHPF7
  8538        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8539        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8540        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 157
* EL6311.cbl
  8541        MOVE PI-SV-STATE            TO PI-STATE
  8542        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8543        MOVE BCERTNOI               TO PI-CERT-PRIME
  8544        MOVE BSUFIXI                TO PI-CERT-SFX
  8545        MOVE BEFFDTI                TO DEEDIT-FIELD
  8546        PERFORM 8600-DEEDIT
  8547        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8548        MOVE '4'                    TO DC-OPTION-CODE
  8549        PERFORM 9700-DATE-LINK
  8550        IF DATE-CONVERSION-ERROR
  8551           MOVE ER-0348            TO EMI-ERROR
  8552           MOVE -1                  TO BEFFDTL
  8553           MOVE AL-UABON            TO BEFFDTA
  8554           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8555           GO TO 8200-SEND-DATAONLY
  8556        ELSE
  8557           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8558           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8559           MOVE XCTL-EL1273        TO PGM-NAME
  8560           GO TO 9300-XCTL.
  8561
  8562     IF EIBAID = DFHPF8
  8563        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8564        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8565        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8566        MOVE PI-SV-STATE            TO PI-STATE
  8567        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8568        MOVE BCERTNOI               TO PI-CERT-PRIME
  8569        MOVE BSUFIXI                TO PI-CERT-SFX
  8570        MOVE BEFFDTI                TO DEEDIT-FIELD
  8571        PERFORM 8600-DEEDIT
  8572        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8573        MOVE '4'                    TO DC-OPTION-CODE
  8574        PERFORM 9700-DATE-LINK
  8575        IF DATE-CONVERSION-ERROR
  8576           MOVE ER-0348            TO EMI-ERROR
  8577           MOVE -1                  TO BEFFDTL
  8578           MOVE AL-UABON            TO BEFFDTA
  8579           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8580           GO TO 8200-SEND-DATAONLY
  8581        ELSE
  8582           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8583           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8584           IF PI-COMPANY-ID = 'DMD'
  8585               MOVE XCTL-EL401DMD      TO PGM-NAME
  8586             ELSE
  8587               MOVE XCTL-EL1279        TO PGM-NAME
  8588           END-IF
  8589           GO TO 9300-XCTL.
  8590
  8591     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8592        MOVE XCTL-EL6312         TO PGM-NAME
  8593
  8594* EXEC CICS XCTL
  8595*           PROGRAM   (PGM-NAME)
  8596*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8597*           LENGTH    (WS-COMM-LENGTH)
  8598*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 158
* EL6311.cbl
  8599*    MOVE '.$C                   %   #00008564' TO DFHEIV0
  8600     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8601     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8602     MOVE X'2020233030303038353634' TO DFHEIV0(25:11)
  8603     CALL 'kxdfhei1' USING DFHEIV0,
  8604           PGM-NAME,
  8605           PROGRAM-INTERFACE-BLOCK,
  8606           WS-COMM-LENGTH,
  8607           DFHEIV99
  8608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8609     ELSE
  8610        MOVE '0'                 TO  PI-EDIT-SW.
  8611
  8612     IF  EIBAID = DFHPF10
  8613         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8614         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8615         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8616                                    PI-1042-WA
  8617         MOVE 4                  TO PI-689-DATA-SOURCE
  8618         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8619         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8620         MOVE PI-SV-STATE        TO PI-689-STATE
  8621         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8622         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8623         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8624         MOVE PI-PB-ALT-CHG-SEQ-NO
  8625                                 TO PI-689-ALT-SEQ-NO
  8626         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8627         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8628         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8629         MOVE +0                 TO PI-689-CONTROL
  8630         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8631                                    PI-689-EXP-DATE
  8632                                    PI-689-RESP-PERSON
  8633                                    PI-689-TYPE
  8634                                    PI-689-FOLLOW-UP-EDIT
  8635                                    PI-689-RESEND1-EDIT
  8636                                    PI-689-SEQ-EDIT
  8637                                    PI-689-BCSEQ-EDIT
  8638                                    PI-689-LBL-OVERRIDE
  8639         MOVE W-LETTER-COMMUNICATION-AREAS
  8640                                 TO PI-PROGRAM-WORK-AREA
  8641         MOVE XCTL-EL689         TO PGM-NAME
  8642         GO TO 9300-XCTL.
  8643
  8644     IF  EIBAID = DFHPF16
  8645         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8646         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8647         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8648                                    PI-1042-WA
  8649         MOVE 4                  TO PI-689-DATA-SOURCE
  8650         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8651         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8652         MOVE PI-SV-STATE        TO PI-689-STATE
  8653         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8654         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8655         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8656         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 159
* EL6311.cbl
  8657                                 TO PI-689-ALT-SEQ-NO
  8658         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8659         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8660         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8661         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8662         MOVE W-LETTER-COMMUNICATION-AREAS
  8663                                 TO PI-PROGRAM-WORK-AREA
  8664         MOVE XCTL-EL690         TO PGM-NAME
  8665         GO TO 9300-XCTL.
  8666
  8667     IF EIBAID = DFHPF13
  8668         MOVE XCTL-EL6313        TO PGM-NAME
  8669         GO TO 9300-XCTL.
  8670
  8671     IF EIBAID = DFHPF17
  8672        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8673        IF (PB-I-LOAN-APR > ZEROS)
  8674           and (pb-i-loan-apr < 99.9999)
  8675           AND (PB-I-BENEFICIARY-NAME NOT
  8676              = SPACES AND LOW-VALUES)
  8677
  8678           MOVE LINK-ELVADS          TO PGM-NAME
  8679
  8680* EXEC CICS LINK
  8681*              PROGRAM    (PGM-NAME)
  8682*              COMMAREA   (WS-PASS-AREA)
  8683*              LENGTH     (WS-PASS-AREA-LENGTH)
  8684*          END-EXEC
  8685*    MOVE '."C                   (   #00008639' TO DFHEIV0
  8686     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8688     MOVE X'2020233030303038363339' TO DFHEIV0(25:11)
  8689     CALL 'kxdfhei1' USING DFHEIV0,
  8690           PGM-NAME,
  8691           WS-PASS-AREA,
  8692           WS-PASS-AREA-LENGTH,
  8693           DFHEIV99,
  8694           DFHEIV99,
  8695           DFHEIV99,
  8696           DFHEIV99
  8697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8698
  8699           MOVE 0000             TO EMI-ERROR
  8700           MOVE -1               TO BMAINTL
  8701           PERFORM 9900-ERROR-FORMAT
  8702                                 THRU 9900-EXIT
  8703           GO TO 8200-SEND-DATAONLY
  8704        ELSE
  8705           MOVE ER-0877            TO EMI-ERROR
  8706           MOVE -1                  TO BEFFDTL
  8707           MOVE AL-UABON            TO BEFFDTA
  8708           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8709           GO TO 8200-SEND-DATAONLY
  8710        END-IF
  8711     END-IF
  8712     IF EIBAID = DFHPF14
  8713        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8714        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 160
* EL6311.cbl
  8715        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8716        MOVE PI-SV-STATE            TO PI-CR-STATE
  8717        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8718        MOVE SPACE                  TO PI-EDIT-SW
  8719        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8720        MOVE XCTL-EL650             TO PGM-NAME
  8721        GO TO 9300-XCTL.
  8722
  8723     IF EIBAID = DFHPF15
  8724        IF PI-COMPANY-ID  =  'HER'
  8725            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8726            MOVE XCTL-EL680         TO PGM-NAME
  8727            GO TO 9300-XCTL.
  8728
  8729     IF EIBAID = DFHENTER OR DFHPF11
  8730        GO TO 1000-ISSUE-MAINLINE.
  8731
  8732     MOVE ER-0029                TO EMI-ERROR
  8733     MOVE -1                     TO BPFENTRL
  8734     MOVE AL-UNBON               TO BPFENTRA
  8735     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8736     GO TO 8200-SEND-DATAONLY.
  8737
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 161
* EL6311.cbl
  8739
  8740******************************************************************
  8741*                                                                *
  8742*      CANCEL SCREEN PF KEY CHECKING                             *
  8743*                                                                *
  8744******************************************************************
  8745
  8746******************************************************************
  8747*                                                                *
  8748*      PF KEY FUNCTIONS:                                         *
  8749*                                                                *
  8750*      PF1  = BROWSE FORWARD                                     *
  8751*      PF2  = BROWSE BACKWARD                                    *
  8752*      PF3  = CERTIFICATE LOOKUP                                 *
  8753*      PF4  = DISPLAY BATCH HEADER                               *
  8754*      PF5  = ADD ISSUE SCREEN                                   *
  8755*      PF6  = ADD CANCEL SCREEN                                  *
  8756*      PF7  = CERTIFICATE DISPLAY                                *
  8757*      PF8  = CERTIFICATE NOTES                                  *
  8758*      PF9  = EDIT CONTROL                                       *
  8759*      PF10 = DISPLAY LETTER SCREEN                              *
  8760*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8761*      PF12 = DISPLAY HELP SCREEN                                *
  8762*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8763*      PF14 = ACCOUNT MASTER                                     *
  8764*      PF16 = LETTER REVIEW                                      *
  8765*                                                                *
  8766******************************************************************
  8767
  8768 0400-CHECK-CANCEL-PF-KEYS.
  8769     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8770        MOVE ER-2337             TO EMI-ERROR
  8771        MOVE -1                  TO CMAINTL
  8772        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8773        GO TO 8200-SEND-DATAONLY.
  8774
  8775     IF EIBAID = DFHPF1
  8776        MOVE '0'                TO PI-EDIT-SW
  8777        IF PI-PRIMARY-BROWSE
  8778           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8779        ELSE
  8780           IF PI-PRIMARY-WITH-SELECT
  8781              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8782           ELSE
  8783              IF PI-FILE-BROWSE
  8784                 GO TO 4300-BROWSE-FILE-FORWARD
  8785              ELSE
  8786                 IF PI-CSR-BROWSE
  8787                    GO TO 4200-BROWSE-CSR-FORWARD
  8788                 ELSE
  8789                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8790
  8791     IF EIBAID = DFHPF2
  8792        MOVE '0'                TO PI-EDIT-SW
  8793        IF PI-PRIMARY-BROWSE
  8794           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8795        ELSE
  8796           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 162
* EL6311.cbl
  8797              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8798           ELSE
  8799              IF PI-FILE-BROWSE
  8800                 GO TO 4800-BROWSE-FILE-BACKWARD
  8801              ELSE
  8802                 IF PI-CSR-BROWSE
  8803                    GO TO 4900-BROWSE-CSR-BACKWARD
  8804                 ELSE
  8805                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8806
  8807     IF EIBAID = DFHPF3
  8808        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8809        MOVE XCTL-EL127         TO PGM-NAME
  8810        GO TO 9300-XCTL.
  8811
  8812     IF (EIBAID = DFHPF15 OR DFHPF17)
  8813        AND (CSR-EDIT-SESSION)
  8814*       AND (FATAL-OR-UNFORCED)
  8815        AND (FATAL-ERRORS)
  8816        MOVE ER-1819             TO EMI-ERROR
  8817        MOVE -1                  TO CMAINTL
  8818        MOVE AL-UANON            TO CMAINTA
  8819        PERFORM 9900-ERROR-FORMAT
  8820                                 THRU 9900-EXIT
  8821        GO TO 8200-SEND-DATAONLY
  8822     END-IF
  8823     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8824       AND (CSR-EDIT-SESSION)
  8825        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8826        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8827        IF (RESP-NORMAL)
  8828           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8829              AM-CONTROL-PRIMARY (1:20))
  8830            IF AM-NAME NOT GREATER THAN SPACES OR
  8831               AM-ADDRS NOT GREATER THAN SPACES  OR
  8832               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8833               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8834               AM-ZIP NOT GREATER THAN SPACES
  8835               MOVE ER-3834             TO EMI-ERROR
  8836               MOVE -1                  TO BMAINTL
  8837               MOVE AL-UANON            TO BMAINTA
  8838               PERFORM 9900-ERROR-FORMAT
  8839                                 THRU 9900-EXIT
  8840               GO TO 8200-SEND-DATAONLY
  8841            END-IF
  8842        ELSE
  8843           MOVE ER-1609             TO EMI-ERROR
  8844           MOVE -1                  TO BMAINTL
  8845           MOVE AL-UANON            TO BMAINTA
  8846           PERFORM 9900-ERROR-FORMAT
  8847                                THRU 9900-EXIT
  8848           GO TO 8200-SEND-DATAONLY
  8849        END-IF
  8850
  8851        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8852        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8853        IF (ERMAIL-FOUND)
  8854            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 163
* EL6311.cbl
  8855               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8856               MA-CITY NOT GREATER THAN SPACES OR
  8857               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8858               MA-ZIP-CODE NOT GREATER THAN SPACES
  8859               MOVE ER-3835             TO EMI-ERROR
  8860               MOVE -1                  TO BMAINTL
  8861               MOVE AL-UANON            TO BMAINTA
  8862               PERFORM 9900-ERROR-FORMAT
  8863                                 THRU 9900-EXIT
  8864               GO TO 8200-SEND-DATAONLY
  8865            END-IF
  8866        ELSE
  8867           MOVE ER-3000             TO EMI-ERROR
  8868           MOVE -1                  TO BMAINTL
  8869           MOVE AL-UANON            TO BMAINTA
  8870           PERFORM 9900-ERROR-FORMAT
  8871                                THRU 9900-EXIT
  8872           GO TO 8200-SEND-DATAONLY
  8873        END-IF
  8874
  8875     END-IF
  8876     IF (EIBAID = DFHPF15 OR DFHPF17)
  8877        AND (CSR-EDIT-SESSION)
  8878        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8879        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8880        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8881        MOVE PI-SV-STATE         TO PI-STATE
  8882        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8883        MOVE CCERTNOI            TO PI-CERT-PRIME
  8884        MOVE CSUFIXI             TO PI-CERT-SFX
  8885        MOVE CEFFDTI             TO DEEDIT-FIELD
  8886        PERFORM 8600-DEEDIT
  8887        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8888        MOVE '4'                 TO DC-OPTION-CODE
  8889        PERFORM 9700-DATE-LINK
  8890        IF DATE-CONVERSION-ERROR
  8891           MOVE ER-0348          TO EMI-ERROR
  8892           MOVE -1               TO CEFFDTL
  8893           MOVE AL-UABON         TO CEFFDTA
  8894           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8895           GO TO 8200-SEND-DATAONLY
  8896        ELSE
  8897           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8898           PERFORM 6000-CREATE-TEMP-STORAGE
  8899                                 THRU 6000-EXIT
  8900           IF EIBAID = DFHPF17
  8901               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8902                                  THRU 6400-EXIT
  8903               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8904                                 '2' AND '3' AND '4'
  8905                  MOVE ER-3831     TO  EMI-ERROR
  8906                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8907                  GO TO 8200-SEND-DATAONLY
  8908               END-IF
  8909               MOVE 'Y'          TO PI-CLM-RESC-IND
  8910           ELSE
  8911               MOVE 'N'          TO PI-CLM-RESC-IND
  8912           END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 164
* EL6311.cbl
  8913           MOVE XCTL-EL6316      TO PGM-NAME
  8914           MOVE '2'              TO PI-ISS-CAN-SW
  8915           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8916           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8917           GO TO 9300-XCTL
  8918        END-IF
  8919     END-IF
  8920
  8921     IF EIBAID = DFHPF4
  8922        MOVE '0'                TO PI-EDIT-SW
  8923        IF PI-DISPLAY-ORIGINAL-BATCH
  8924           NEXT SENTENCE
  8925        ELSE
  8926           GO TO 7200-DISPLAY-BATCHES.
  8927
  8928     IF EIBAID = DFHPF5
  8929        MOVE ER-0029                TO EMI-ERROR
  8930        MOVE -1                     TO BPFENTRL
  8931        MOVE AL-UNBON               TO BPFENTRA
  8932        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8933        GO TO 8200-SEND-DATAONLY.
  8934*        MOVE '0'                TO PI-EDIT-SW
  8935*        IF PI-DISPLAY-ORIGINAL-BATCH
  8936*           NEXT SENTENCE
  8937*        ELSE
  8938*           MOVE EL631B              TO PI-MAP-NAME
  8939*           MOVE LOW-VALUES          TO EL631BI
  8940*           MOVE 'A'                 TO BMAINTO
  8941*           MOVE AL-UANON            TO BMAINTA
  8942*           MOVE -1                  TO BMAINTL
  8943*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8944*           GO TO 8100-SEND-INITIAL-MAP.
  8945
  8946     IF EIBAID = DFHPF6
  8947        MOVE ER-0029                TO EMI-ERROR
  8948        MOVE -1                     TO BPFENTRL
  8949        MOVE AL-UNBON               TO BPFENTRA
  8950        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8951        GO TO 8200-SEND-DATAONLY.
  8952*        MOVE '0'                TO PI-EDIT-SW
  8953*        IF PI-DISPLAY-ORIGINAL-BATCH
  8954*           NEXT SENTENCE
  8955*        ELSE
  8956*           MOVE EL631C              TO PI-MAP-NAME
  8957*           MOVE LOW-VALUES          TO EL631CI
  8958*           MOVE 'A'                 TO CMAINTO
  8959*           MOVE AL-UANON            TO CMAINTA
  8960*           MOVE -1                  TO CMAINTL
  8961*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8962*           GO TO 8100-SEND-INITIAL-MAP.
  8963
  8964     IF EIBAID = DFHPF7
  8965        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8966        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8967        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8968        MOVE PI-SV-STATE            TO PI-STATE
  8969        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8970        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 165
* EL6311.cbl
  8971        MOVE CSUFIXI                TO PI-CERT-SFX
  8972        MOVE CEFFDTI                TO DEEDIT-FIELD
  8973        PERFORM 8600-DEEDIT
  8974        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8975        MOVE '4'                    TO DC-OPTION-CODE
  8976        PERFORM 9700-DATE-LINK
  8977        IF DATE-CONVERSION-ERROR
  8978           MOVE ER-0348            TO EMI-ERROR
  8979           MOVE -1                  TO BEFFDTL
  8980           MOVE AL-UABON            TO BEFFDTA
  8981           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8982           GO TO 8200-SEND-DATAONLY
  8983        ELSE
  8984           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8985           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8986           MOVE XCTL-EL1273        TO PGM-NAME
  8987           GO TO 9300-XCTL.
  8988
  8989     IF EIBAID = DFHPF8
  8990        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8991        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8992        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8993        MOVE PI-SV-STATE            TO PI-STATE
  8994        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8995        MOVE CCERTNOI               TO PI-CERT-PRIME
  8996        MOVE CSUFIXI                TO PI-CERT-SFX
  8997        MOVE CEFFDTI                TO DEEDIT-FIELD
  8998        PERFORM 8600-DEEDIT
  8999        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9000        MOVE '4'                    TO DC-OPTION-CODE
  9001        PERFORM 9700-DATE-LINK
  9002        IF DATE-CONVERSION-ERROR
  9003           MOVE ER-0348             TO EMI-ERROR
  9004           MOVE -1                  TO BEFFDTL
  9005           MOVE AL-UABON            TO BEFFDTA
  9006           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9007           GO TO 8200-SEND-DATAONLY
  9008        ELSE
  9009           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9010           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9011           IF PI-COMPANY-ID = 'DMD'
  9012               MOVE XCTL-EL401DMD      TO PGM-NAME
  9013             ELSE
  9014               MOVE XCTL-EL1279        TO PGM-NAME
  9015           END-IF
  9016           GO TO 9300-XCTL.
  9017
  9018     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9019        MOVE XCTL-EL6312     TO PGM-NAME
  9020
  9021* EXEC CICS XCTL
  9022*           PROGRAM  (PGM-NAME)
  9023*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9024*           LENGTH   (WS-COMM-LENGTH)
  9025*       END-EXEC
  9026*    MOVE '.$C                   %   #00008966' TO DFHEIV0
  9027     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9028     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 166
* EL6311.cbl
  9029     MOVE X'2020233030303038393636' TO DFHEIV0(25:11)
  9030     CALL 'kxdfhei1' USING DFHEIV0,
  9031           PGM-NAME,
  9032           PROGRAM-INTERFACE-BLOCK,
  9033           WS-COMM-LENGTH,
  9034           DFHEIV99
  9035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9036     ELSE
  9037        MOVE '0'                 TO  PI-EDIT-SW.
  9038
  9039     IF EIBAID = DFHPF10
  9040         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9041         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9042         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9043         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9044                                    PI-1042-WA
  9045         MOVE 4                  TO PI-689-DATA-SOURCE
  9046         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9047         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9048         MOVE PI-SV-STATE        TO PI-689-STATE
  9049         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9050         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9051         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9052         MOVE PI-PB-ALT-CHG-SEQ-NO
  9053                                 TO PI-689-ALT-SEQ-NO
  9054         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9055         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9056         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9057         MOVE +0                 TO PI-689-CONTROL
  9058         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9059                                    PI-689-EXP-DATE
  9060                                    PI-689-RESP-PERSON
  9061                                    PI-689-TYPE
  9062                                    PI-689-FOLLOW-UP-EDIT
  9063                                    PI-689-RESEND1-EDIT
  9064                                    PI-689-SEQ-EDIT
  9065                                    PI-689-BCSEQ-EDIT
  9066                                    PI-689-LBL-OVERRIDE
  9067         MOVE W-LETTER-COMMUNICATION-AREAS
  9068                                 TO PI-PROGRAM-WORK-AREA
  9069         MOVE XCTL-EL689         TO PGM-NAME
  9070         GO TO 9300-XCTL.
  9071
  9072     IF  EIBAID = DFHPF16
  9073         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9074         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9075         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9076                                    PI-1042-WA
  9077         MOVE 4                  TO PI-689-DATA-SOURCE
  9078         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9079         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9080         MOVE PI-SV-STATE        TO PI-689-STATE
  9081         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9082         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9083         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9084         MOVE PI-PB-ALT-CHG-SEQ-NO
  9085                                 TO PI-689-ALT-SEQ-NO
  9086         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 167
* EL6311.cbl
  9087         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9088         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9089         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9090         MOVE W-LETTER-COMMUNICATION-AREAS
  9091                                 TO PI-PROGRAM-WORK-AREA
  9092         MOVE XCTL-EL690         TO PGM-NAME
  9093         GO TO 9300-XCTL.
  9094     IF (EIBAID = DFHPF13)
  9095        if (not fatal-errors)
  9096           and (not unforced-errors)
  9097           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9098           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9099           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9100           MOVE PI-SV-STATE      TO PI-STATE
  9101           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9102           MOVE CCERTNOI         TO PI-CERT-PRIME
  9103           MOVE CSUFIXI          TO PI-CERT-SFX
  9104           MOVE CEFFDTI          TO DEEDIT-FIELD
  9105           PERFORM 8600-DEEDIT
  9106           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9107           MOVE '4'              TO DC-OPTION-CODE
  9108           PERFORM 9700-DATE-LINK
  9109           IF DATE-CONVERSION-ERROR
  9110              MOVE ER-0348       TO EMI-ERROR
  9111              MOVE -1            TO CEFFDTL
  9112              MOVE AL-UABON      TO CEFFDTA
  9113              PERFORM 9900-ERROR-FORMAT
  9114                                 THRU 9900-EXIT
  9115              GO TO 8200-SEND-DATAONLY
  9116           ELSE
  9117              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9118              MOVE AL-UANON      TO CEFFDTA
  9119              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9120              PERFORM 6000-CREATE-TEMP-STORAGE
  9121                                 THRU 6000-EXIT
  9122              MOVE XCTL-EL677    TO PGM-NAME
  9123              GO TO 9300-XCTL
  9124           end-if
  9125        else
  9126           MOVE ER-3444          TO EMI-ERROR
  9127           MOVE -1               TO CPFENTRL
  9128           MOVE AL-UNBON         TO CPFENTRA
  9129           PERFORM 9900-ERROR-FORMAT
  9130                                 THRU 9900-EXIT
  9131           GO TO 8200-SEND-DATAONLY
  9132        end-if
  9133     end-if
  9134
  9135     IF EIBAID = DFHPF14
  9136        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9137        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9138        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9139        MOVE PI-SV-STATE            TO PI-CR-STATE
  9140        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9141        MOVE SPACE                  TO PI-EDIT-SW
  9142        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9143        MOVE XCTL-EL650             TO PGM-NAME
  9144        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 168
* EL6311.cbl
  9145
  9146     IF EIBAID = DFHENTER OR DFHPF11
  9147        GO TO 2000-CANCEL-MAINLINE.
  9148
  9149     MOVE ER-0029                TO EMI-ERROR.
  9150     MOVE -1                     TO CPFENTRL.
  9151     MOVE AL-UNBON               TO CPFENTRA.
  9152     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9153     GO TO 8200-SEND-DATAONLY.
  9154
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 169
* EL6311.cbl
  9156
  9157******************************************************************
  9158*                                                                *
  9159*      BATCH SCREEN PF KEY CHECKING                              *
  9160*                                                                *
  9161******************************************************************
  9162
  9163******************************************************************
  9164*                                                                *
  9165*      PF KEY FUNCTIONS:                                         *
  9166*                                                                *
  9167*      PF1 = BROWSE FORWARD                                      *
  9168*      PF2 = BROWSE BACKWARD                                     *
  9169*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9170*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9171*                                                                *
  9172*                                                                *
  9173******************************************************************
  9174
  9175 0500-CHECK-BATCH-PF-KEYS.
  9176     IF EIBAID = DFHPF1
  9177        MOVE '0'                TO PI-EDIT-SW
  9178        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9179           GO TO 5000-BROWSE-BATCH-HEADERS
  9180        ELSE
  9181           IF PI-GOOD-BROWSE
  9182              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9183                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9184              ELSE
  9185                 IF PI-FILE-BROWSE
  9186                    GO TO 4300-BROWSE-FILE-FORWARD
  9187                 ELSE
  9188                    IF PI-CSR-BROWSE
  9189                       GO TO 4200-BROWSE-CSR-FORWARD
  9190                    ELSE
  9191                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9192           ELSE
  9193              GO TO 0800-BROWSE-ERROR.
  9194
  9195     IF EIBAID = DFHPF2
  9196        MOVE '0'                TO PI-EDIT-SW
  9197        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9198           GO TO 5500-BROWSE-BATCH-BACKWARD
  9199        ELSE
  9200           IF PI-GOOD-BROWSE
  9201              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9202                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9203              ELSE
  9204                 IF PI-FILE-BROWSE
  9205                    GO TO 4800-BROWSE-FILE-BACKWARD
  9206                 ELSE
  9207                    IF PI-CSR-BROWSE
  9208                       GO TO 4900-BROWSE-CSR-BACKWARD
  9209                    ELSE
  9210                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9211           ELSE
  9212              GO TO 0800-BROWSE-ERROR.
  9213
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 170
* EL6311.cbl
  9214     IF EIBAID = DFHPF3
  9215        GO TO 3000-BATCH-MAINLINE.
  9216
  9217     IF  EIBAID = DFHPF4
  9218        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9219        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9220        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9221        MOVE PI-SV-STATE            TO PI-CR-STATE
  9222        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9223                                       PI-CR-FIN-RESP
  9224        MOVE 'A'                    TO PI-CR-TYPE
  9225        MOVE SPACE                  TO PI-EDIT-SW
  9226        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9227        MOVE XCTL-EL640             TO PGM-NAME
  9228        GO TO 9300-XCTL.
  9229
  9230     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9231       AND
  9232        (EIBAID = DFHENTER)
  9233           GO TO 3500-EDIT-BATCH-DATA.
  9234
  9235     IF EIBAID = DFHENTER
  9236        GO TO 3500-EDIT-BATCH-DATA.
  9237
  9238     MOVE ER-0029             TO EMI-ERROR.
  9239     MOVE -1                  TO DPFENTRL.
  9240     MOVE AL-UNBON            TO DPFENTRA.
  9241     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9242     GO TO 8200-SEND-DATAONLY.
  9243
  9244 0800-BROWSE-ERROR.
  9245     MOVE ER-2258                TO EMI-ERROR.
  9246     MOVE -1                     TO DPFENTRL.
  9247     MOVE AL-UNBON               TO DPFENTRA.
  9248     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9249     GO TO 8200-SEND-DATAONLY.
  9250
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 171
* EL6311.cbl
  9252
  9253******************************************************************
  9254*                                                                *
  9255*                I S S U E   M A I N L I N E                     *
  9256*                                                                *
  9257******************************************************************
  9258
  9259 1000-ISSUE-MAINLINE.
  9260     IF PI-DISPLAY-ORIGINAL-BATCH
  9261        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9262           MOVE ER-0023             TO EMI-ERROR
  9263           MOVE -1                  TO BMAINTL
  9264           MOVE AL-UABON            TO BMAINTA
  9265           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9266           GO TO 8200-SEND-DATAONLY
  9267        ELSE
  9268           NEXT SENTENCE
  9269     ELSE
  9270        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9271           MOVE ER-0023             TO EMI-ERROR
  9272           MOVE -1                  TO BMAINTL
  9273           MOVE AL-UABON            TO BMAINTA
  9274           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9275           GO TO 8200-SEND-DATAONLY.
  9276
  9277     IF BMAINTI = 'S'
  9278        GO TO 1100-SHOW-REQUEST.
  9279
  9280     IF NOT MODIFY-CAP
  9281         MOVE 'UPDATE'       TO SM-READ
  9282         PERFORM 9995-SECURITY-VIOLATION
  9283         MOVE ER-0070        TO EMI-ERROR
  9284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9285         GO TO 8100-SEND-INITIAL-MAP.
  9286
  9287     IF BMAINTL GREATER THAN ZEROS
  9288        IF PI-PF5-FUNCTION
  9289           IF BMAINTI NOT = 'A'
  9290              MOVE AL-UABON  TO BMAINTA
  9291              MOVE -1        TO BMAINTL
  9292              MOVE ER-2260   TO EMI-ERROR
  9293              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9294              GO TO 8200-SEND-DATAONLY.
  9295
  9296     IF BCERTNOL = ZEROS
  9297       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9298         NEXT SENTENCE
  9299     ELSE
  9300         IF BCERTNOL NOT = ZEROS
  9301             MOVE AL-UANON       TO BCERTNOA
  9302         ELSE
  9303             MOVE -1             TO BCERTNOL
  9304             MOVE  1             TO SET-CURSOR-SW
  9305             MOVE ER-2218        TO EMI-ERROR
  9306             MOVE AL-UABON       TO BCERTNOA
  9307             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9308
  9309     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 172
* EL6311.cbl
  9310         MOVE AL-UANON       TO BSUFIXA
  9311     ELSE
  9312         MOVE AL-SANOF       TO BSUFIXA.
  9313
  9314     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9315        NEXT SENTENCE
  9316     ELSE
  9317        IF BEFFDTL NOT = ZEROS
  9318           MOVE AL-UNNON             TO BEFFDTA
  9319           MOVE BEFFDTI              TO DEEDIT-FIELD
  9320           PERFORM 8600-DEEDIT
  9321           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9322           MOVE 4                    TO DC-OPTION-CODE
  9323           PERFORM 9700-DATE-LINK
  9324           IF NO-CONVERSION-ERROR
  9325              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9326              ELSE
  9327              MOVE -1                TO BEFFDTL
  9328              MOVE  1                TO SET-CURSOR-SW
  9329              MOVE ER-2226           TO EMI-ERROR
  9330              MOVE AL-UNBON          TO BEFFDTA
  9331              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9332           ELSE
  9333              MOVE -1                TO BEFFDTL
  9334              MOVE  1                TO SET-CURSOR-SW
  9335              MOVE ER-2220           TO EMI-ERROR
  9336              MOVE AL-UNBON          TO BEFFDTA
  9337              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9338
  9339     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9340
  9341     IF BCERTNOL NOT = ZEROS
  9342        MOVE BCERTNOI                TO WS-NEW-PRIME
  9343     ELSE
  9344        MOVE SPACES                  TO WS-NEW-PRIME.
  9345
  9346     IF BSUFIXL NOT = ZEROS
  9347        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9348     ELSE
  9349        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9350
  9351     IF BEFFDTL NOT = ZEROS
  9352        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9353     ELSE
  9354        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9355
  9356     IF BMAINTI = 'A' OR 'K' OR 'S'
  9357        NEXT SENTENCE
  9358     ELSE
  9359        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9360        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9361           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9362           WS-PB-RECORD-TYPE NOT = '1'
  9363           IF BMAINTI = 'C'
  9364               MOVE ER-2287          TO EMI-ERROR
  9365               MOVE -1               TO BCERTNOL
  9366               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9367               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 173
* EL6311.cbl
  9368               GO TO 8200-SEND-DATAONLY
  9369             ELSE
  9370               MOVE ER-2260          TO EMI-ERROR
  9371               MOVE -1               TO BCERTNOL
  9372               MOVE AL-UABON         TO BCERTNOA
  9373               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9374               GO TO 8200-SEND-DATAONLY.
  9375
  9376     IF BMAINTI = 'D'
  9377         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9378
  9379*    IF BMICRNOL  NOT =  ZEROS
  9380*        IF BMICRNOI  NUMERIC
  9381*            MOVE AL-UNNON       TO  BMICRNOA
  9382*        ELSE
  9383*            MOVE -1             TO  BMICRNOL
  9384*            MOVE 1              TO  SET-CURSOR-SW
  9385*            MOVE AL-UNBON       TO  BMICRNOA
  9386*            MOVE ER-2701        TO  EMI-ERROR
  9387*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9388     IF BVINL NOT = ZEROS
  9389        MOVE AL-UANON            TO BVINA
  9390     END-IF
  9391     IF B1STNML NOT = ZEROS
  9392         MOVE AL-UANON                TO B1STNMA.
  9393
  9394     IF BINITL  NOT = ZEROS
  9395        MOVE AL-UANON                TO BINITA.
  9396
  9397     IF BSEXL NOT = ZEROS
  9398        IF BSEXI = 'M' OR 'F'
  9399           MOVE AL-UANON             TO BSEXA
  9400        ELSE
  9401           MOVE -1               TO BSEXL
  9402           MOVE ER-2629          TO EMI-ERROR
  9403           MOVE AL-UABON         TO BSEXA
  9404           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9405
  9406     IF BAGEL NOT = ZEROS
  9407         IF BAGEI NUMERIC
  9408             MOVE BAGEI              TO WS-BAGE
  9409             MOVE AL-UNNON           TO BAGEA
  9410         ELSE
  9411             MOVE -1                 TO BAGEL
  9412             MOVE  1                 TO SET-CURSOR-SW
  9413             MOVE ER-2223            TO EMI-ERROR
  9414             MOVE AL-UNBON           TO BAGEA
  9415             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9416
  9417     IF BLSTNML NOT = ZERO  OR
  9418        B1STNML NOT = ZERO  OR
  9419        BINITL NOT = ZERO
  9420         IF BAGEL = ZEROS
  9421             MOVE -1                 TO BAGEL
  9422             MOVE  1                 TO SET-CURSOR-SW
  9423             MOVE ER-3269            TO EMI-ERROR
  9424             MOVE AL-UNBON           TO BAGEA
  9425             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 174
* EL6311.cbl
  9426         END-IF
  9427     END-IF.
  9428
  9429     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9430
  9431     IF (BBIRTHL GREATER THAN +0) AND
  9432        (BBIRTHI NOT EQUAL SPACES)
  9433        NEXT SENTENCE
  9434     ELSE
  9435        GO TO 1010-CHECK-AGE.
  9436
  9437     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9438     PERFORM 8600-DEEDIT.
  9439     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9440     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9441     MOVE AL-UNNON               TO BBIRTHA.
  9442     MOVE '4'                    TO DC-OPTION-CODE.
  9443     PERFORM 9700-DATE-LINK.
  9444     IF DATE-CONVERSION-ERROR
  9445        MOVE -1                  TO BBIRTHL
  9446        MOVE  1                  TO SET-CURSOR-SW
  9447        MOVE ER-2228             TO EMI-ERROR
  9448        MOVE AL-UNBON            TO BBIRTHA
  9449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9450        GO TO 1010-CHECK-AGE.
  9451
  9452     IF (NO-CONVERSION-ERROR) AND
  9453        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9454        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9455        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9456        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9457                                    WS-CONVERTED-BIRTH
  9458        MOVE AL-UANON            TO BBIRTHA
  9459     ELSE
  9460        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9461        MOVE AL-UANON            TO BBIRTHA.
  9462
  9463 1010-CHECK-AGE.
  9464
  9465*    IF BAGEL = ZERO
  9466*       IF BBIRTHL GREATER THAN ZERO
  9467*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9468
  9469     IF B1STPMTL NOT = ZEROS
  9470        IF B1STPMTI = SPACES
  9471           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9472        ELSE
  9473           MOVE B1STPMTI             TO DEEDIT-FIELD
  9474           PERFORM 8600-DEEDIT
  9475           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9476           MOVE AL-UNNON             TO B1STPMTA
  9477           MOVE 4                    TO DC-OPTION-CODE
  9478           PERFORM 9700-DATE-LINK
  9479           IF NO-CONVERSION-ERROR
  9480              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9481              MOVE AL-UANON          TO B1STPMTA
  9482           ELSE
  9483              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 175
* EL6311.cbl
  9484              MOVE  1                TO SET-CURSOR-SW
  9485              MOVE ER-2200           TO EMI-ERROR
  9486              MOVE AL-UNBON          TO B1STPMTA
  9487              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9488
  9489     IF BDAYSL NOT = ZEROS
  9490         IF BDAYSI NUMERIC
  9491             MOVE AL-UNNON           TO BDAYSA
  9492         ELSE
  9493             MOVE -1                 TO BDAYSL
  9494             MOVE ER-2530            TO EMI-ERROR
  9495             MOVE AL-UNBON           TO BDAYSA
  9496             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9497
  9498     IF BLNTRML NOT = ZEROS
  9499         IF BLNTRMI NUMERIC
  9500             MOVE AL-UNNON       TO BLNTRMA
  9501         ELSE
  9502             MOVE -1             TO BLNTRML
  9503             MOVE ER-2533        TO EMI-ERROR
  9504             MOVE AL-UNBON       TO BLNTRMA
  9505             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9506
  9507**   IF PI-COMPANY-ID = 'DMD'
  9508     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9509        NEXT SENTENCE
  9510     ELSE
  9511         IF BLNOFCRL NOT = ZEROS
  9512            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9513            IF LOAN-OFFICER-FOUND
  9514                MOVE AL-UANON        TO BLNOFCRA
  9515             ELSE
  9516                 MOVE SPACE          TO WS-LOAN-OFFICER
  9517                 MOVE -1             TO BLNOFCRL
  9518                 MOVE  1             TO SET-CURSOR-SW
  9519                 MOVE ER-3006        TO EMI-ERROR
  9520                 MOVE AL-UNBON       TO BLNOFCRA
  9521                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9522
  9523     IF BFREQL NOT = ZEROS
  9524         IF BFREQI NUMERIC
  9525             MOVE AL-UNNON       TO BFREQA
  9526         ELSE
  9527             MOVE -1             TO BFREQL
  9528             MOVE  1             TO SET-CURSOR-SW
  9529             MOVE ER-2223        TO EMI-ERROR
  9530             MOVE AL-UNBON       TO BFREQA
  9531             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9532
  9533     IF BMODEL NOT = ZEROS
  9534         MOVE BMODEI             TO WS-MODE-CODE
  9535                                    PI-BMODE
  9536         IF WS-MODE-CODE-VALID
  9537             MOVE AL-UANON       TO BMODEA
  9538         ELSE
  9539             MOVE -1             TO BMODEL
  9540             MOVE ER-2591        TO EMI-ERROR
  9541             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 176
* EL6311.cbl
  9542             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9543
  9544     IF BPMTSL NOT = ZEROS
  9545         IF BPMTSI NUMERIC
  9546             MOVE AL-UNNON           TO BPMTSA
  9547             MOVE BPMTSI             TO PI-BPMTS
  9548         ELSE
  9549             MOVE -1                 TO BPMTSL
  9550             MOVE ER-2592            TO EMI-ERROR
  9551             MOVE AL-UNBON           TO BPMTSA
  9552             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9553
  9554     IF BPMTAMTL NOT = ZEROS
  9555
  9556* EXEC CICS BIF DEEDIT
  9557*            FIELD  (BPMTAMTI)
  9558*            LENGTH (9)
  9559*       END-EXEC
  9560     MOVE 9
  9561       TO DFHEIV11
  9562*    MOVE '@"L                   #   #00009490' TO DFHEIV0
  9563     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9564     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9565     MOVE X'2020233030303039343930' TO DFHEIV0(25:11)
  9566     CALL 'kxdfhei1' USING DFHEIV0,
  9567           BPMTAMTI,
  9568           DFHEIV11
  9569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9570        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9571*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9572*        PERFORM 8600-DEEDIT
  9573*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9574
  9575*    IF BAPRL NOT = ZEROS
  9576*        EXEC CICS BIF DEEDIT
  9577*            FIELD  (BAPRI)
  9578*            LENGTH (7)
  9579*        END-EXEC
  9580*        MOVE BAPRI              TO WS-BAPR.
  9581
  9582     IF BAPRL > 0
  9583        MOVE +0                  TO  WS-BAPR
  9584        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9585           (WS-SUB > 7)
  9586           OR (BAPRI (WS-SUB:1) NUMERIC)
  9587           OR (BAPRI (WS-SUB:1) = '.')
  9588        END-PERFORM
  9589        IF WS-SUB > 7
  9590           MOVE ER-2471       TO EMI-ERROR
  9591           MOVE -1            TO BAPRL
  9592           MOVE AL-UNBON      TO BAPRA
  9593           PERFORM 9900-ERROR-FORMAT
  9594                                 THRU 9900-EXIT
  9595        ELSE
  9596           IF BAPRI (WS-SUB:1) NUMERIC
  9597              MOVE WS-SUB           TO WS-BEG
  9598              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9599                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 177
* EL6311.cbl
  9600                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9601              END-PERFORM
  9602              COMPUTE WS-END = WS-SUB - WS-BEG
  9603              MOVE BAPRI (WS-BEG:WS-END)
  9604                                 TO WS-APR-WHOLE-NUM
  9605           END-IF
  9606           IF BAPRI (WS-SUB:1) = '.'
  9607              COMPUTE WS-BEG = WS-SUB + 1
  9608              IF (WS-BEG < 8)
  9609                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9610                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9611                    (WS-SUB > 7)
  9612                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9613                 END-PERFORM
  9614                 COMPUTE WS-END = WS-SUB - WS-BEG
  9615                 MOVE BAPRI (WS-BEG:WS-END)
  9616                                 TO WS-APR-DEC (1:WS-END)
  9617              END-IF
  9618           END-IF
  9619           MOVE AL-UNNON      TO BAPRA
  9620           MOVE WS-BAPR       TO BAPRO
  9621        END-IF
  9622     END-IF
  9623*     IF BAPRL NOT = ZEROS
  9624*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9625*        PERFORM 8600-DEEDIT
  9626*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9627
  9628     IF BLIVESL NOT = ZEROS
  9629        MOVE BLIVESI             TO DEEDIT-FIELD
  9630        PERFORM 8600-DEEDIT
  9631        IF DEEDIT-FIELD-V0 NUMERIC
  9632           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9633           MOVE AL-UNNON         TO BLIVESA
  9634        ELSE
  9635           MOVE -1               TO BLIVESL
  9636           MOVE AL-UNBON         TO BLIVESA
  9637           MOVE ER-2223          TO EMI-ERROR
  9638           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9639
  9640*DMD CUSTOM CODING*************START
  9641*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9642     IF PI-COMPANY-ID NOT = 'DMD'
  9643         MOVE ZEROS               TO BBILLEDL
  9644         GO TO 1010-EDIT-CONT.
  9645
  9646     IF BBILLEDL NOT = ZEROS
  9647        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9648        MOVE 'Y'                 TO WS-NUMERIC-SW
  9649        MOVE +1                  TO WS-CSO-SUB
  9650        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9651        IF CSO-NUMERIC-FIELD
  9652
  9653* EXEC CICS BIF DEEDIT
  9654*              FIELD  (BBILLEDI)
  9655*              LENGTH (9)
  9656*          END-EXEC
  9657     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 178
* EL6311.cbl
  9658       TO DFHEIV11
  9659*    MOVE '@"L                   #   #00009576' TO DFHEIV0
  9660     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9661     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9662     MOVE X'2020233030303039353736' TO DFHEIV0(25:11)
  9663     CALL 'kxdfhei1' USING DFHEIV0,
  9664           BBILLEDI,
  9665           DFHEIV11
  9666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9667           MOVE BBILLEDI         TO WS-BILLED
  9668           MOVE AL-UNNON         TO BBILLEDA
  9669        ELSE
  9670           MOVE -1               TO BBILLEDL
  9671           MOVE AL-UNBON         TO BBILLEDA
  9672           MOVE ER-2547          TO EMI-ERROR
  9673           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9674     ELSE
  9675        IF BMAINTI EQUAL 'A'
  9676           MOVE -1               TO BBILLEDL
  9677           MOVE AL-UNBON         TO BBILLEDA
  9678           MOVE ER-8148          TO EMI-ERROR
  9679           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9680
  9681 1010-EDIT-CONT.
  9682
  9683     IF BFORCEL  NOT = ZEROS
  9684         IF FORCE-CAP
  9685            MOVE AL-UANON            TO BFORCEA
  9686         ELSE
  9687            MOVE ER-2945             TO EMI-ERROR
  9688            MOVE AL-UABON            TO BFORCEA
  9689            MOVE -1                  TO BFORCEL
  9690            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9691
  9692     IF BENTRYL NOT = ZEROS
  9693        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9694                         'D' AND 'V' AND 'U' AND 'M'
  9695           MOVE ER-2224              TO EMI-ERROR
  9696           MOVE AL-UABON             TO BENTRYA
  9697           MOVE -1                   TO BENTRYL
  9698           MOVE  1                   TO SET-CURSOR-SW
  9699           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9700        ELSE
  9701           MOVE AL-UANON             TO BENTRYA.
  9702
  9703     IF BUNWRITL NOT = ZEROS
  9704        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9705           MOVE ER-7574              TO EMI-ERROR
  9706           MOVE AL-UABON             TO BUNWRITA
  9707           MOVE -1                   TO BUNWRITL
  9708           MOVE  1                   TO SET-CURSOR-SW
  9709           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9710        ELSE
  9711           MOVE AL-UANON             TO BUNWRITA.
  9712
  9713     IF BREINL  NOT = ZEROS
  9714         MOVE AL-UANON               TO BREINA.
  9715
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 179
* EL6311.cbl
  9716     IF BBILCDL NOT = ZEROS
  9717        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9718                             AND 'A' AND 'B' AND 'E'
  9719           MOVE ER-2225              TO EMI-ERROR
  9720           MOVE AL-UABON             TO BBILCDA
  9721           MOVE -1                   TO BBILCDL
  9722           MOVE  1                   TO SET-CURSOR-SW
  9723           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9724        ELSE
  9725           MOVE AL-UANON             TO BBILCDA.
  9726
  9727     IF BSKPCDL NOT = ZEROS
  9728         MOVE AL-UANON               TO BSKPCDA.
  9729
  9730     IF BINDGRPL NOT = ZEROS
  9731         MOVE AL-UANON               TO BINDGRPA.
  9732
  9733     IF BSIGL   NOT = ZEROS
  9734         MOVE AL-UANON               TO BSIGA.
  9735
  9736     IF BRTCLSL NOT = ZEROS
  9737         MOVE AL-UANON               TO BRTCLSA.
  9738
  9739     IF BMEMBERL NOT = ZEROS
  9740         MOVE AL-UANON               TO BMEMBERA.
  9741
  9742     MOVE +0                         TO WS-SUB1.
  9743
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 180
* EL6311.cbl
  9745
  9746******************************************************************
  9747*                                                                *
  9748*           E D I T   I S S U E   C O V E R A G E S              *
  9749*                                                                *
  9750******************************************************************
  9751
  9752 1020-EDIT-COVERAGES.
  9753     ADD +1                      TO WS-SUB1.
  9754
  9755     IF WS-SUB1 GREATER +2
  9756        GO TO 1025-EDIT-COMPLETE.
  9757
  9758     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9759       IF (BMODEL   GREATER ZERO  OR
  9760            BPMTSL   GREATER ZERO  OR
  9761            BPMTAMTL GREATER ZERO)
  9762          AND
  9763            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9764               GO TO 1021-CONT-EDIT.
  9765
  9766     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9767        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9768        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9769        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9770        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9771        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9772        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9773        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9774        NEXT SENTENCE
  9775         ELSE
  9776            GO TO 1020-EDIT-COVERAGES.
  9777
  9778 1021-CONT-EDIT.
  9779
  9780     IF BMAINTI = 'A'
  9781        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9782           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9783        ELSE
  9784           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9785           MOVE ER-7404          TO EMI-ERROR
  9786           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9787           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9788     ELSE
  9789        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9790           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9791
  9792     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9793        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9794        PERFORM 8600-DEEDIT
  9795        IF DEEDIT-FIELD-V0 NUMERIC
  9796           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9797        ELSE
  9798           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9799
  9800     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9801*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9802        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 181
* EL6311.cbl
  9803           BPMTSL  GREATER THAN ZEROS
  9804           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9805
  9806     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9807         IF BMODEL   GREATER THAN ZEROS  OR
  9808            BPMTSL   GREATER THAN ZEROS  OR
  9809            BPMTAMTL GREATER THAN ZEROS
  9810             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9811
  9812     IF BMAINTI = ('C' OR 'K')
  9813        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9814           NEXT SENTENCE
  9815        ELSE
  9816           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9817           PERFORM 8600-DEEDIT
  9818           IF DEEDIT-FIELD-V0 NUMERIC
  9819              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9820              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9821                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9822              ELSE
  9823                    MOVE ER-2241      TO EMI-ERROR
  9824                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9825                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9826                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9827           ELSE
  9828              MOVE ER-2223          TO EMI-ERROR
  9829              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9830              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9831              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9832     ELSE
  9833        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9834            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9835            PERFORM 8600-DEEDIT
  9836            IF DEEDIT-FIELD-V0      NUMERIC
  9837               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9838                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9839                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9840               ELSE
  9841                  MOVE ER-2241         TO EMI-ERROR
  9842                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9843                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9844                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9845            ELSE
  9846              MOVE ER-2223             TO EMI-ERROR
  9847              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9848              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9849              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9850        ELSE
  9851            MOVE ER-2240               TO EMI-ERROR
  9852            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9853            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9854*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9855*        IF BMODEL  GREATER THAN ZEROS  AND
  9856*           BPMTSL  GREATER THAN ZEROS
  9857*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9858
  9859     IF BBEN-LEN (WS-SUB1) = ZEROS
  9860        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 182
* EL6311.cbl
  9861           NEXT SENTENCE
  9862     ELSE
  9863        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9864           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9865
  9866* EXEC CICS BIF DEEDIT
  9867*              FIELD  (BBENI (WS-SUB1))
  9868*              LENGTH (12)
  9869*          END-EXEC
  9870     MOVE 12
  9871       TO DFHEIV11
  9872*    MOVE '@"L                   #   #00009778' TO DFHEIV0
  9873     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9874     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9875     MOVE X'2020233030303039373738' TO DFHEIV0(25:11)
  9876     CALL 'kxdfhei1' USING DFHEIV0,
  9877           BBENI(WS-SUB1),
  9878           DFHEIV11
  9879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9880           IF BBENI (WS-SUB1)  NUMERIC
  9881              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9882                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9883*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9884*          PERFORM 8600-DEEDIT
  9885*          IF DEEDIT-FIELD-V2  NUMERIC
  9886*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9887*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9888              ELSE
  9889                 MOVE ER-7632    TO EMI-ERROR
  9890                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9891                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9892                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9893           ELSE
  9894              MOVE ER-2223         TO EMI-ERROR
  9895              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9896              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9897              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9898        ELSE
  9899           MOVE ER-7632    TO EMI-ERROR
  9900           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9901           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9902           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9903
  9904     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9905        AND (BMAINTI = ('C' OR 'K'))
  9906        CONTINUE
  9907     ELSE
  9908        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9909           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9910           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9911              FOR ALL '.'
  9912           IF WS-TALLY > 1
  9913              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9914                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9915              END-PERFORM
  9916              IF A1 < 9
  9917                 ADD 3 TO A1
  9918                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 183
* EL6311.cbl
  9919              END-IF
  9920           ELSE
  9921              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9922                (A1 > 11)
  9923                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9924                  LOW-VALUES OR SPACES)
  9925              END-PERFORM
  9926              IF A1 > 1 AND < 12
  9927                 MOVE SPACES
  9928                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9929              END-IF
  9930           END-IF
  9931
  9932* EXEC CICS BIF DEEDIT
  9933*              FIELD  (BPREMI (WS-SUB1))
  9934*              LENGTH (11)
  9935*          END-EXEC
  9936     MOVE 11
  9937       TO DFHEIV11
  9938*    MOVE '@"L                   #   #00009833' TO DFHEIV0
  9939     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9940     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9941     MOVE X'2020233030303039383333' TO DFHEIV0(25:11)
  9942     CALL 'kxdfhei1' USING DFHEIV0,
  9943           BPREMI(WS-SUB1),
  9944           DFHEIV11
  9945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9946           IF BPREMI (WS-SUB1) NUMERIC
  9947              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9948                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9949*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9950*          PERFORM 8600-DEEDIT
  9951*          IF DEEDIT-FIELD-V2  NUMERIC
  9952*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9953*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9954              ELSE
  9955                 IF PI-COMPANY-ID NOT = 'DCC'
  9956                    MOVE ER-7633    TO EMI-ERROR
  9957                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9958                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9959                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9960                 END-IF
  9961              END-IF
  9962           ELSE
  9963              MOVE ER-2223         TO EMI-ERROR
  9964              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9965              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9966              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9967           END-IF
  9968        ELSE
  9969           IF PI-COMPANY-ID NOT = 'DCC'
  9970              MOVE ER-7633         TO EMI-ERROR
  9971              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9972              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9973              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9974           END-IF
  9975        END-IF
  9976     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 184
* EL6311.cbl
  9977
  9978     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9979        NEXT SENTENCE
  9980     ELSE
  9981        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9982
  9983* EXEC CICS BIF DEEDIT
  9984*           FIELD  (BCPREMI (WS-SUB1))
  9985*           LENGTH (11)
  9986*       END-EXEC
  9987     MOVE 11
  9988       TO DFHEIV11
  9989*    MOVE '@"L                   #   #00009873' TO DFHEIV0
  9990     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9991     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9992     MOVE X'2020233030303039383733' TO DFHEIV0(25:11)
  9993     CALL 'kxdfhei1' USING DFHEIV0,
  9994           BCPREMI(WS-SUB1),
  9995           DFHEIV11
  9996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9997        IF BCPREMI (WS-SUB1) NUMERIC
  9998           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9999*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10000*       PERFORM 8600-DEEDIT
 10001*       IF DEEDIT-FIELD-V2  NUMERIC
 10002*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10003        ELSE
 10004           MOVE ER-2223         TO EMI-ERROR
 10005           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10006           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10007           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10008
 10009     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10010        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10011        PERFORM 8600-DEEDIT
 10012        IF DEEDIT-FIELD-V0 NUMERIC
 10013           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10014           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10015         ELSE
 10016           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10017           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10018           MOVE ER-2223              TO EMI-ERROR
 10019           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10020
 10021     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10022        IF BEXPIRE   (WS-SUB1) = SPACES
 10023           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10024        ELSE
 10025           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10026           PERFORM 8600-DEEDIT
 10027           IF DEEDIT-FIELD-V0        NUMERIC
 10028              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10029              MOVE 4                TO DC-OPTION-CODE
 10030              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10031              PERFORM 9700-DATE-LINK
 10032              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10033                                                        (WS-SUB1)
 10034              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 185
* EL6311.cbl
 10035                 NEXT SENTENCE
 10036              ELSE
 10037                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10038                 MOVE ER-2531    TO EMI-ERROR
 10039                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10040                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10041           ELSE
 10042             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10043             MOVE ER-2532        TO EMI-ERROR
 10044             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10045             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10046
 10047     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10048        NEXT SENTENCE
 10049     ELSE
 10050
 10051* EXEC CICS BIF DEEDIT
 10052*           FIELD  (BALT-BENI (WS-SUB1))
 10053*           LENGTH (12)
 10054*       END-EXEC
 10055     MOVE 12
 10056       TO DFHEIV11
 10057*    MOVE '@"L                   #   #00009930' TO DFHEIV0
 10058     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10059     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10060     MOVE X'2020233030303039393330' TO DFHEIV0(25:11)
 10061     CALL 'kxdfhei1' USING DFHEIV0,
 10062           BALT-BENI(WS-SUB1),
 10063           DFHEIV11
 10064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10065        IF BALT-BENI (WS-SUB1) NUMERIC
 10066           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10067*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10068*       PERFORM 8600-DEEDIT
 10069*       IF DEEDIT-FIELD-V0 NUMERIC
 10070*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10071        ELSE
 10072           MOVE ER-2223         TO EMI-ERROR
 10073           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10074           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10075           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10076
 10077     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10078        NEXT SENTENCE
 10079     ELSE
 10080
 10081* EXEC CICS BIF DEEDIT
 10082*           FIELD  (BALT-PREMI (WS-SUB1))
 10083*           LENGTH (11)
 10084*       END-EXEC
 10085     MOVE 11
 10086       TO DFHEIV11
 10087*    MOVE '@"L                   #   #00009949' TO DFHEIV0
 10088     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10089     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10090     MOVE X'2020233030303039393439' TO DFHEIV0(25:11)
 10091     CALL 'kxdfhei1' USING DFHEIV0,
 10092           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 186
* EL6311.cbl
 10093           DFHEIV11
 10094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10095        IF BALT-PREMI (WS-SUB1) NUMERIC
 10096           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10097*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10098*       PERFORM 8600-DEEDIT
 10099*       IF DEEDIT-FIELD-V0 NUMERIC
 10100*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10101        ELSE
 10102           MOVE ER-2223         TO EMI-ERROR
 10103           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10104           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10105           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10106
 10107      GO TO 1020-EDIT-COVERAGES.
 10108
 10109 1025-EDIT-COMPLETE.
 10110     IF PI-COMPANY-ID  =  'DMD'
 10111        MOVE LOW-VALUES             TO BNCERTI
 10112                                       BNSTATI.
 10113
 10114     IF EMI-ERROR = ZEROS
 10115         NEXT SENTENCE
 10116     ELSE
 10117         GO TO 8200-SEND-DATAONLY.
 10118
 10119     IF BMAINTI = 'A'
 10120         GO TO 1200-ADD-ISSUE-ROUTINE.
 10121
 10122     IF BMAINTI = 'C'
 10123         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10124
 10125     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10126
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 187
* EL6311.cbl
 10128
 10129 1030-EDIT-FOR-NUMERICS.
 10130     IF WS-CSO-SUB EQUAL 10
 10131        GO TO 1030-EDIT-EXIT.
 10132
 10133     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10134        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10135        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10136           ADD +1               TO WS-CSO-SUB
 10137           GO TO 1030-EDIT-FOR-NUMERICS.
 10138
 10139     MOVE 'N'                   TO WS-NUMERIC-SW.
 10140
 10141 1030-EDIT-EXIT.
 10142******************************************************************
 10143*                                                                *
 10144*                 C A L C U L A T E   A G E                      *
 10145*                                                                *
 10146******************************************************************
 10147
 10148
 10149 1095-CALC-AGE.
 10150
 10151     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10152     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10153     MOVE 1                  TO DC-OPTION-CODE.
 10154     PERFORM 9700-DATE-LINK
 10155     IF NO-CONVERSION-ERROR
 10156         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10157         MOVE WS-BAGE            TO BAGEI
 10158         MOVE +2                 TO BAGEL
 10159         MOVE AL-UNNON TO BAGEA.
 10160
 10161 1099-EXIT.
 10162     EXIT.
 10163
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 188
* EL6311.cbl
 10165
 10166******************************************************************
 10167*                                                                *
 10168*                   S H O W   I S S U E                          *
 10169*                                                                *
 10170******************************************************************
 10171
 10172 1100-SHOW-REQUEST.
 10173     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10174
 10175     IF BCERTNOL = ZEROS AND
 10176        BEFFDTL  = ZEROS
 10177        MOVE -1                  TO BMAINTL
 10178        GO TO 8200-SEND-DATAONLY.
 10179
 10180     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10181
 10182     IF BSUFIXL NOT = ZEROS
 10183        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10184     ELSE
 10185        MOVE SPACE               TO WS-NEW-SUFFIX.
 10186
 10187     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10188     PERFORM 8600-DEEDIT.
 10189     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10190     MOVE '4'                    TO DC-OPTION-CODE.
 10191     PERFORM 9700-DATE-LINK.
 10192     IF DATE-CONVERSION-ERROR
 10193        MOVE ER-0348             TO EMI-ERROR
 10194        MOVE -1                  TO BEFFDTL
 10195        MOVE AL-UABON            TO BEFFDTA
 10196        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10197        GO TO 8200-SEND-DATAONLY
 10198     ELSE
 10199        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10200        MOVE AL-UANON            TO BEFFDTA
 10201        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10202
 10203     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10204
 10205     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10206        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10207          MOVE 'Y'                    TO WS-SHOW-SW
 10208          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10209             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10210           ELSE
 10211             IF PI-FILE-BROWSE
 10212                GO TO 4300-BROWSE-FILE-FORWARD
 10213              ELSE
 10214                IF PI-CSR-BROWSE
 10215                   GO TO 4200-BROWSE-CSR-FORWARD
 10216                ELSE
 10217                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10218        ELSE
 10219           GO TO 3900-RE-DISPLAY-RECORD.
 10220
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 189
* EL6311.cbl
 10222
 10223******************************************************************
 10224*                                                                *
 10225*            A D D   I S S U E   R O U T I N E                   *
 10226*                                                                *
 10227******************************************************************
 10228
 10229***************************************************************
 10230*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10231*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10232*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10233*     4. LINK TO THE EDIT ROUTINE.                            *
 10234*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10235*     6. WRITE THE NEW ISSUE RECORD.                          *
 10236*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10237*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10238*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10239*        ELSE                                                 *
 10240*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10241***************************************************************
 10242
 10243 1200-ADD-ISSUE-ROUTINE.
 10244     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10245
 10246
 10247* EXEC CICS GETMAIN
 10248*        SET     (ADDRESS OF PENDING-BUSINESS)
 10249*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10250*    END-EXEC.
 10251*    MOVE '," L                  $   #00010104' TO DFHEIV0
 10252     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10253     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10254     MOVE X'2020233030303130313034' TO DFHEIV0(25:11)
 10255     CALL 'kxdfhei1' USING DFHEIV0,
 10256           DFHEIV20,
 10257           ERPNDB-RECORD-LENGTH,
 10258           DFHEIV99
 10259     SET ADDRESS OF PENDING-BUSINESS TO
 10260         DFHEIV20
 10261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10262
 10263
 10264
 10265* EXEC CICS HANDLE CONDITION
 10266*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10267*    END-EXEC.
 10268*    MOVE '"$I                   ! # #00010109' TO DFHEIV0
 10269     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10271     MOVE X'2320233030303130313039' TO DFHEIV0(25:11)
 10272     CALL 'kxdfhei1' USING DFHEIV0
 10273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10274
 10275
 10276     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10277     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10278     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10279
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 190
* EL6311.cbl
 10280
 10281* EXEC CICS READ
 10282*        INTO    (PENDING-BUSINESS)
 10283*        DATASET (FILE-ID-ERPNDB)
 10284*        RIDFLD  (ERPNDB-KEY)
 10285*    END-EXEC.
 10286     MOVE LENGTH OF
 10287      PENDING-BUSINESS
 10288       TO DFHEIV11
 10289*    MOVE '&"IL       E          (   #00010117' TO DFHEIV0
 10290     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10291     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10292     MOVE X'2020233030303130313137' TO DFHEIV0(25:11)
 10293     CALL 'kxdfhei1' USING DFHEIV0,
 10294           FILE-ID-ERPNDB,
 10295           PENDING-BUSINESS,
 10296           DFHEIV11,
 10297           ERPNDB-KEY,
 10298           DFHEIV99,
 10299           DFHEIV99,
 10300           DFHEIV99
 10301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10302
 10303
 10304     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10305
 10306     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10307     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10308     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10309     MOVE SPACES                 TO PENDING-BUSINESS.
 10310     MOVE 'PB'                   TO PB-RECORD-ID.
 10311     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10312     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10313     MOVE SPACES                 TO PB-CERT-SFX.
 10314     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10315     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10316                                    PB-ALT-CHG-SEQ-NO.
 10317
 10318     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10319     MOVE '1'                    TO PB-RECORD-TYPE.
 10320
 10321     IF BSUFIXL NOT = ZEROS
 10322        MOVE BSUFIXI             TO PB-CERT-SFX.
 10323
 10324     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10325
 10326     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10327     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10328
 10329     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10330                                    PB-I-LF-PREM-CALC
 10331                                    PB-I-LF-ALT-PREM-CALC
 10332                                    PB-I-LF-RATE
 10333                                    PB-I-LF-ALT-RATE
 10334                                    PB-I-LF-REI-RATE
 10335                                    PB-I-LF-ALT-REI-RATE
 10336                                    PB-I-RATE-DEV-PCT-LF
 10337                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 191
* EL6311.cbl
 10338                                    PB-I-AH-RATE
 10339                                    PB-I-AH-REI-RATE
 10340                                    PB-I-AH-RATE-TRM
 10341                                    PB-I-RATE-DEV-PCT-AH
 10342                                    PB-I-BUSINESS-TYPE
 10343                                    PB-I-LIFE-COMMISSION
 10344                                    PB-I-JOINT-COMMISSION
 10345                                    PB-I-JOINT-AGE
 10346                                    PB-I-AH-COMMISSION
 10347                                    PB-I-CURR-SEQ
 10348                                    PB-CHG-COUNT
 10349                                    PB-LF-BILLED-AMTS
 10350                                    PB-AH-BILLED-AMTS
 10351                                    PB-CALC-TOLERANCE
 10352                                    PB-I-EXTENTION-DAYS
 10353*                                   PB-I-MICROFILM-NO
 10354                                    PB-I-TERM-IN-DAYS.
 10355
 10356     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10357                                    PB-I-LF-EXPIRE-DT
 10358                                    PB-I-AH-EXPIRE-DT
 10359                                    PB-BILLED-DT
 10360                                    PB-ACCT-EFF-DT
 10361                                    PB-ACCT-EXP-DT
 10362                                    PB-I-1ST-PMT-DT.
 10363
 10364     MOVE 'X'                    TO PB-FATAL-FLAG.
 10365
 10366     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10367
 10368     IF BLSTNML GREATER THAN ZEROS
 10369         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10370
 10371*    IF BMICRNOL  GREATER  ZEROS
 10372*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10373*    ELSE
 10374*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10375     IF BVINL > ZEROS
 10376        MOVE BVINI               TO PB-I-VIN
 10377     END-IF
 10378     IF B1STNML GREATER THAN ZEROS
 10379         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10380
 10381     IF BINITL  GREATER THAN ZEROS
 10382         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10383
 10384     IF BBIRTHL GREATER THAN ZERO
 10385         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10386     ELSE
 10387         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10388
 10389     IF B1STPMTL GREATER THAN ZERO
 10390         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10391     ELSE
 10392         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10393
 10394     IF BAGEL    GREATER THAN ZEROS
 10395         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 192
* EL6311.cbl
 10396        ELSE
 10397         MOVE ZEROS              TO PB-I-AGE.
 10398
 10399     IF BSEXL    GREATER THAN ZEROS
 10400         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10401
 10402     IF BTERM-LEN (1) GREATER THAN ZEROS
 10403        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10404     ELSE
 10405        MOVE ZEROS               TO PB-I-LF-TERM.
 10406
 10407     IF BTERM-LEN (2) GREATER THAN ZEROS
 10408        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10409     ELSE
 10410        MOVE ZEROS               TO PB-I-AH-TERM.
 10411
 10412     IF BLNTRML       GREATER THAN ZEROS
 10413         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10414        ELSE
 10415         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10416
 10417     IF BFREQL        GREATER THAN ZEROS
 10418         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10419        ELSE
 10420         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10421
 10422     IF BSKPCDL       GREATER THAN ZEROS
 10423         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10424
 10425     IF BMODEL        GREATER THAN ZEROS
 10426         MOVE BMODEI             TO PB-I-TERM-TYPE
 10427                                    PI-BMODE.
 10428
 10429     IF BPMTSL        GREATER THAN ZEROS
 10430         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10431                                    PI-BPMTS
 10432        ELSE
 10433         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10434                                    PI-BPMTS.
 10435
 10436     IF BPMTAMTL      GREATER THAN ZEROS
 10437         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10438        ELSE
 10439         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10440
 10441     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10442        IF BTYPE  (1)   NOT = ZEROS
 10443           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10444                                    PI-BTYPE (1)
 10445           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10446           MOVE SPACES           TO PB-I-LF-ABBR
 10447        ELSE
 10448           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10449                                    PB-I-LF-ABBR
 10450           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10451     ELSE
 10452        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10453                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 193
* EL6311.cbl
 10454        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10455
 10456     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10457         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10458     ELSE
 10459         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10460
 10461     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10462         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10463     ELSE
 10464         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10465
 10466     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10467         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10468            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10469            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10470         ELSE
 10471            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10472*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10473*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10474         END-IF
 10475     ELSE
 10476         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10477
 10478     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10479         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10480
 10481     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10482         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10483         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10484     ELSE
 10485         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10486
 10487     IF  BALT-PREM-LEN     (2) > ZEROS
 10488         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10489     ELSE
 10490         MOVE ZEROS            TO PB-I-TOT-FEES.
 10491
 10492     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10493        IF BTYPE      (2)   NOT = ZEROS
 10494           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10495                                  PI-BTYPE (2)
 10496           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10497           MOVE SPACES         TO PB-I-AH-ABBR
 10498        ELSE
 10499           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10500                                  PB-I-AH-ABBR
 10501           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10502     ELSE
 10503        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10504                                  PB-I-AH-ABBR
 10505        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10506
 10507     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10508         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10509     ELSE
 10510         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10511
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 194
* EL6311.cbl
 10512     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10513         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10514            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10515            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10516         ELSE
 10517            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10518*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10519*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10520         END-IF
 10521     ELSE
 10522         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10523
 10524     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10525         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10526
 10527     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10528        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10529     ELSE
 10530        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10531
 10532     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10533        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10534     ELSE
 10535        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10536
 10537     IF BINDGRPL  GREATER THAN ZEROS
 10538         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10539
 10540     IF BRTCLSL   GREATER THAN ZEROS
 10541         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10542
 10543     IF BSIGL     GREATER THAN ZEROS
 10544         MOVE BSIGI              TO PB-I-SIG-SW.
 10545     IF BAPRL > ZEROS
 10546         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10547     ELSE
 10548        if pi-company-id = 'CID'
 10549           move +99.9999         to pb-i-loan-apr
 10550        else
 10551           MOVE ZEROS            TO PB-I-LOAN-APR
 10552        end-if
 10553     end-if
 10554     IF BMEMBERL  GREATER THAN ZEROS
 10555         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10556
 10557     IF BLNOFCRL  GREATER THAN ZEROS
 10558         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10559
 10560     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10561        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10562     ELSE
 10563        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10564
 10565     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10566        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10567     ELSE
 10568        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10569
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 195
* EL6311.cbl
 10570     IF BDAYSL   GREATER THAN ZEROS
 10571        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10572                                    PB-I-EXTENTION-DAYS
 10573     ELSE
 10574        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10575                                    PB-I-EXTENTION-DAYS.
 10576
 10577     IF BDAYSL GREATER THAN ZEROS
 10578        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10579
 10580     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10581        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10582           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10583
 10584     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10585        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10586           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10587
 10588     IF B1STPMTL GREATER THAN ZEROS
 10589        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10590
 10591     IF PB-EXT-DAYS-PROCESSING
 10592        IF PB-I-EXTENTION-DAYS = ZEROS
 10593           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10594
 10595     IF PB-EXPIRE-DT-PROCESSING
 10596        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10597           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10598             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10599
 10600     IF PB-1ST-PMT-DT-PROCESSING
 10601        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10602           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10603
 10604     IF BREINL GREATER THAN ZEROS
 10605        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10606
 10607     IF BENTRYL NOT = ZEROS
 10608        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10609        IF PI-COMPANY-ID = 'CID'
 10610           AND (PB-BATCH-ENTRY = 'P')
 10611           AND (PB-STATE = 'VA')
 10612           PERFORM 1500-UPDATE-ERNOTE
 10613                                 THRU 1500-EXIT
 10614        END-IF
 10615     END-IF
 10616     IF BUNWRITL NOT = ZEROS
 10617        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10618
 10619     IF BFORCEL NOT = ZEROS
 10620        MOVE BFORCEI             TO PB-FORCE-CODE.
 10621
 10622     IF BBILCDL NOT = ZEROS
 10623        MOVE BBILCDI             TO PB-RECORD-BILL.
 10624
 10625     IF BLIVESL GREATER THAN ZEROS
 10626        MOVE WS-BLIVES           TO PB-I-LIVES
 10627     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 196
* EL6311.cbl
 10628        MOVE ZEROS               TO PB-I-LIVES.
 10629
 10630     IF BBILLEDL GREATER THAN ZEROS
 10631        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10632     ELSE
 10633        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10634
 10635*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10636
 10637 1260-WRITE-PB-RECORD.
 10638     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10639                                    PB-INPUT-BY.
 10640     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10641     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10642                                    PB-INPUT-DT.
 10643
 10644     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10645     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10646                                    PB-CONTROL-BY-ORIG-BATCH.
 10647
 10648
 10649     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10650     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10651     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10652     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10653     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10654
 10655     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10656
 10657     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10658
 10659     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10660     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10661     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10662
 10663     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10664     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10665
 10666 1275-WRITE-PENDING-BUSINESS.
 10667     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10668     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10669     MOVE 'A'                    TO JP-RECORD-TYPE.
 10670     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10671
 10672
 10673* EXEC CICS HANDLE CONDITION
 10674*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10675*    END-EXEC.
 10676*    MOVE '"$%                   ! $ #00010491' TO DFHEIV0
 10677     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10679     MOVE X'2420233030303130343931' TO DFHEIV0(25:11)
 10680     CALL 'kxdfhei1' USING DFHEIV0
 10681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10682
 10683
 10684
 10685* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 197
* EL6311.cbl
 10686*        DATASET (FILE-ID-ERPNDB)
 10687*        FROM    (PENDING-BUSINESS)
 10688*        RIDFLD  (PB-CONTROL-PRIMARY)
 10689*    END-EXEC.
 10690     MOVE LENGTH OF
 10691      PENDING-BUSINESS
 10692       TO DFHEIV11
 10693*    MOVE '&$ L                  ''   #00010495' TO DFHEIV0
 10694     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10695     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10696     MOVE X'2020233030303130343935' TO DFHEIV0(25:11)
 10697     CALL 'kxdfhei1' USING DFHEIV0,
 10698           FILE-ID-ERPNDB,
 10699           PENDING-BUSINESS,
 10700           DFHEIV11,
 10701           PB-CONTROL-PRIMARY,
 10702           DFHEIV99,
 10703           DFHEIV99
 10704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10705
 10706
 10707     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10708
 10709     PERFORM 8400-LOG-JOURNAL-RECORD.
 10710
 10711******************************************************************
 10712*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10713******************************************************************
 10714     display ' made it to add orig cert '
 10715     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10716     MOVE ' '                    TO WS-ERMAIL-SW
 10717
 10718* EXEC CICS READ
 10719*       DATASET   (FILE-ID-ERMAIL)
 10720*       SET       (ADDRESS OF MAILING-DATA)
 10721*       RIDFLD    (ERMAIL-KEY)
 10722*       RESP      (WS-RESPONSE)
 10723*    END-EXEC
 10724*    MOVE '&"S        E          (  N#00010511' TO DFHEIV0
 10725     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10726     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10727     MOVE X'204E233030303130353131' TO DFHEIV0(25:11)
 10728     CALL 'kxdfhei1' USING DFHEIV0,
 10729           FILE-ID-ERMAIL,
 10730           DFHEIV20,
 10731           DFHEIV99,
 10732           ERMAIL-KEY,
 10733           DFHEIV99,
 10734           DFHEIV99,
 10735           DFHEIV99
 10736     SET ADDRESS OF MAILING-DATA TO
 10737         DFHEIV20
 10738     MOVE EIBRESP  TO WS-RESPONSE
 10739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10740     IF RESP-NORMAL
 10741        SET ERMAIL-FOUND TO TRUE
 10742     END-IF
 10743
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 198
* EL6311.cbl
 10744     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10745     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10746     MOVE 'OC'                   TO OC-RECORD-ID
 10747     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10748                                 TO OC-CONTROL-PRIMARY (1:33)
 10749     MOVE 'I'                    TO OC-RECORD-TYPE
 10750     MOVE +4096                  TO OC-KEY-SEQ-NO
 10751     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10752     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10753     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10754     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10755     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10756     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10757     MOVE PB-I-AGE               TO OC-INS-AGE
 10758     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10759     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10760     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10761     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10762     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10763     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10764     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10765     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10766     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10767     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10768     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10769     IF PB-I-JOINT-COMMISSION > +0
 10770         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10771     ELSE
 10772         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10773     END-IF
 10774     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10775     MOVE +0                     TO OC-LF-CANCEL-AMT
 10776                                    OC-LF-ITD-CANCEL-AMT
 10777     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10778     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10779     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10780     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10781     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10782     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10783     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10784     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10785     MOVE +0                     TO OC-AH-CANCEL-AMT
 10786                                    OC-AH-ITD-CANCEL-AMT
 10787     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10788     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10789     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10790     IF ERMAIL-FOUND
 10791        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10792     END-IF
 10793     IF NOT CERT-TRL-REC-NOT-FOUND
 10794        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10795                           OC-INS-AGE-DEFAULT-FLAG
 10796        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10797                           OC-JNT-AGE-DEFAULT-FLAG
 10798     END-IF
 10799     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10800     .
 10801 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 199
* EL6311.cbl
 10802
 10803* EXEC CICS WRITE
 10804*       DATASET   ('ELCRTO')
 10805*       FROM      (ORIGINAL-CERTIFICATE)
 10806*       RIDFLD    (OC-CONTROL-PRIMARY)
 10807*       RESP      (WS-RESPONSE)
 10808*    END-EXEC
 10809     MOVE LENGTH OF
 10810      ORIGINAL-CERTIFICATE
 10811       TO DFHEIV11
 10812     MOVE 'ELCRTO' TO DFHEIV1
 10813*    MOVE '&$ L                  ''  N#00010579' TO DFHEIV0
 10814     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10815     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10816     MOVE X'204E233030303130353739' TO DFHEIV0(25:11)
 10817     CALL 'kxdfhei1' USING DFHEIV0,
 10818           DFHEIV1,
 10819           ORIGINAL-CERTIFICATE,
 10820           DFHEIV11,
 10821           OC-CONTROL-PRIMARY,
 10822           DFHEIV99,
 10823           DFHEIV99
 10824     MOVE EIBRESP  TO WS-RESPONSE
 10825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10826     display ' just wrote 1275 ' ws-response
 10827     IF RESP-DUPKEY
 10828        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10829        GO TO 1275-WRITE-ELCRTO
 10830     ELSE
 10831        IF NOT RESP-NORMAL
 10832           MOVE -1               TO BMAINTL
 10833           MOVE ER-7450          TO EMI-ERROR
 10834           PERFORM 9900-ERROR-FORMAT
 10835                                 THRU 9900-EXIT
 10836           GO TO 8200-SEND-DATAONLY
 10837        END-IF
 10838     END-IF
 10839******************************************************************
 10840*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10841******************************************************************
 10842
 10843
 10844* EXEC CICS READ
 10845*        INTO    (PENDING-BUSINESS)
 10846*        DATASET (FILE-ID-ERPNDB)
 10847*        RIDFLD  (ERPNDB-KEY)
 10848*        UPDATE
 10849*    END-EXEC.
 10850     MOVE LENGTH OF
 10851      PENDING-BUSINESS
 10852       TO DFHEIV11
 10853*    MOVE '&"IL       EU         (   #00010602' TO DFHEIV0
 10854     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10855     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10856     MOVE X'2020233030303130363032' TO DFHEIV0(25:11)
 10857     CALL 'kxdfhei1' USING DFHEIV0,
 10858           FILE-ID-ERPNDB,
 10859           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 200
* EL6311.cbl
 10860           DFHEIV11,
 10861           ERPNDB-KEY,
 10862           DFHEIV99,
 10863           DFHEIV99,
 10864           DFHEIV99
 10865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10866
 10867
 10868     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10869     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10870     MOVE 'B'                    TO JP-RECORD-TYPE.
 10871     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10872
 10873     PERFORM 8400-LOG-JOURNAL-RECORD.
 10874
 10875     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10876
 10877
 10878* EXEC CICS REWRITE
 10879*        DATASET (FILE-ID-ERPNDB)
 10880*        FROM    (PENDING-BUSINESS)
 10881*    END-EXEC.
 10882     MOVE LENGTH OF
 10883      PENDING-BUSINESS
 10884       TO DFHEIV11
 10885*    MOVE '&& L                  %   #00010618' TO DFHEIV0
 10886     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10887     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10888     MOVE X'2020233030303130363138' TO DFHEIV0(25:11)
 10889     CALL 'kxdfhei1' USING DFHEIV0,
 10890           FILE-ID-ERPNDB,
 10891           PENDING-BUSINESS,
 10892           DFHEIV11,
 10893           DFHEIV99
 10894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10895
 10896
 10897     MOVE 'C'                    TO JP-RECORD-TYPE.
 10898     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10899
 10900     PERFORM 8400-LOG-JOURNAL-RECORD.
 10901
 10902     IF WS-ERRORS-PRESENT
 10903         GO TO 3900-RE-DISPLAY-RECORD.
 10904
 10905     MOVE ZEROS                  TO EMI-ERROR.
 10906     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10907     MOVE LOW-VALUES             TO EL631BI.
 10908     MOVE  -1                    TO BMAINTL.
 10909     GO TO 8100-SEND-INITIAL-MAP.
 10910
 10911 1280-BATCH-HDR-NOT-FOUND.
 10912     MOVE -1                     TO BMAINTL.
 10913     MOVE ER-7450                TO EMI-ERROR.
 10914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10915     GO TO 8200-SEND-DATAONLY.
 10916
 10917 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 201
* EL6311.cbl
 10918
 10919******************************************************************
 10920*                                                                *
 10921*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10922*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10923*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10924*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10925*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10926*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10927*                                                                *
 10928******************************************************************
 10929
 10930     IF LCP-ONCTR-01 =  0
 10931         ADD 1 TO LCP-ONCTR-01
 10932        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10933
 10934     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10935
 10936     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10937         NEXT SENTENCE
 10938     ELSE
 10939         ADD +1 TO PB-BATCH-SEQ-NO
 10940                   PB-CSR-BATCH-SEQ-NO
 10941         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10942         GO TO 1275-WRITE-PENDING-BUSINESS.
 10943
 10944     MOVE -1                     TO BCERTNOL.
 10945     MOVE AL-UABON               TO BCERTNOA.
 10946     MOVE AL-UNBON               TO BEFFDTA.
 10947
 10948     MOVE 1                      TO EMI-SUB
 10949                                    EMI-SWITCH1
 10950                                    EMI-SWITCH-AREA-1
 10951                                    EMI-SWITCH-AREA-2.
 10952
 10953     MOVE SPACES                 TO EMI-ERROR-LINES.
 10954
 10955
 10956* EXEC CICS SYNCPOINT ROLLBACK
 10957*    END-EXEC.
 10958*    MOVE '6"R                   !   #00010681' TO DFHEIV0
 10959     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10960     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10961     MOVE X'2020233030303130363831' TO DFHEIV0(25:11)
 10962     CALL 'kxdfhei1' USING DFHEIV0
 10963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10964
 10965
 10966     MOVE ER-2247                TO EMI-ERROR.
 10967     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10968     GO TO 8200-SEND-DATAONLY.
 10969
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 202
* EL6311.cbl
 10971
 10972
 10973 1295-READ-CERT-TRAILER.
 10974
 10975
 10976* EXEC CICS GETMAIN
 10977*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10978*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10979*        INITIMG (GETMAIN-SPACE)
 10980*    END-EXEC
 10981*    MOVE ',"IL                  $   #00010693' TO DFHEIV0
 10982     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10983     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10984     MOVE X'2020233030303130363933' TO DFHEIV0(25:11)
 10985     CALL 'kxdfhei1' USING DFHEIV0,
 10986           DFHEIV20,
 10987           ELCRTT-RECORD-LENGTH,
 10988           GETMAIN-SPACE
 10989     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10990         DFHEIV20
 10991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10992
 10993     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10994     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10995     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10996
 10997
 10998* EXEC CICS HANDLE CONDITION
 10999*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11000*    END-EXEC.
 11001*    MOVE '"$I                   ! % #00010703' TO DFHEIV0
 11002     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11003     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11004     MOVE X'2520233030303130373033' TO DFHEIV0(25:11)
 11005     CALL 'kxdfhei1' USING DFHEIV0
 11006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11007
 11008
 11009
 11010* EXEC CICS READ
 11011*        DATASET  (CRTT-ID)
 11012*        RIDFLD   (ELCRTT-KEY)
 11013*        INTO     (CERTIFICATE-TRAILERS)
 11014*    END-EXEC.
 11015     MOVE LENGTH OF
 11016      CERTIFICATE-TRAILERS
 11017       TO DFHEIV11
 11018*    MOVE '&"IL       E          (   #00010707' TO DFHEIV0
 11019     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11021     MOVE X'2020233030303130373037' TO DFHEIV0(25:11)
 11022     CALL 'kxdfhei1' USING DFHEIV0,
 11023           CRTT-ID,
 11024           CERTIFICATE-TRAILERS,
 11025           DFHEIV11,
 11026           ELCRTT-KEY,
 11027           DFHEIV99,
 11028           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 203
* EL6311.cbl
 11029           DFHEIV99
 11030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11031
 11032
 11033     GO TO 1295-EXIT.
 11034
 11035 1295-CERT-TRL-REC-NOTFND.
 11036     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11037
 11038 1295-EXIT.
 11039     EXIT.
 11040
 11041******************************************************************
 11042*                                                                *
 11043*          C H A N G E   I S S U E   R O U T I N E               *
 11044*                                                                *
 11045******************************************************************
 11046
 11047***************************************************************
 11048*                                                             *
 11049*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11050*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11051*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11052*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11053*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11054*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11055*     5. LINK TO THE EDIT ROUTINE.                            *
 11056*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11057*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11058*              THE EDIT ROUTINE.                              *
 11059*     7. REWRITE THE NEW ISSUE                                *
 11060*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11061*                                                             *
 11062***************************************************************
 11063
 11064 1300-CHANGE-ISSUE-ROUTINE.
 11065     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11066
 11067     IF BCHGL NOT = ZEROS
 11068        MOVE ER-2196             TO EMI-ERROR
 11069        MOVE AL-UABON            TO BMAINTA
 11070        MOVE -1                  TO BMAINTL
 11071        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11072        GO TO 8200-SEND-DATAONLY.
 11073
 11074     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11075
 11076     IF BSUFIXL NOT = ZEROS
 11077        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11078     ELSE
 11079        MOVE SPACE               TO WS-NEW-SUFFIX.
 11080
 11081     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11082     PERFORM 8600-DEEDIT.
 11083     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11084     MOVE '4'                    TO DC-OPTION-CODE.
 11085     PERFORM 9700-DATE-LINK.
 11086     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 204
* EL6311.cbl
 11087        MOVE ER-0348             TO EMI-ERROR
 11088        MOVE -1                  TO BEFFDTL
 11089        MOVE AL-UABON            TO BEFFDTA
 11090        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11091        GO TO 8200-SEND-DATAONLY
 11092     ELSE
 11093        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11094        MOVE AL-UANON            TO BEFFDTA
 11095        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11096
 11097 1325-PROCESS-ISSUE-CHANGES.
 11098
 11099* EXEC CICS HANDLE CONDITION
 11100*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11101*    END-EXEC.
 11102*    MOVE '"$I                   ! & #00010778' TO DFHEIV0
 11103     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11105     MOVE X'2620233030303130373738' TO DFHEIV0(25:11)
 11106     CALL 'kxdfhei1' USING DFHEIV0
 11107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11108
 11109
 11110     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11111     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11112     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11113
 11114
 11115* EXEC CICS GETMAIN
 11116*        SET      (ADDRESS OF PENDING-BUSINESS)
 11117*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11118*        INITIMG  (GETMAIN-SPACE)
 11119*     END-EXEC.
 11120*    MOVE ',"IL                  $   #00010786' TO DFHEIV0
 11121     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11122     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11123     MOVE X'2020233030303130373836' TO DFHEIV0(25:11)
 11124     CALL 'kxdfhei1' USING DFHEIV0,
 11125           DFHEIV20,
 11126           ERPNDB-RECORD-LENGTH,
 11127           GETMAIN-SPACE
 11128     SET ADDRESS OF PENDING-BUSINESS TO
 11129         DFHEIV20
 11130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11131
 11132
 11133
 11134* EXEC CICS READ
 11135*        INTO    (PENDING-BUSINESS)
 11136*        DATASET (FILE-ID-ERPNDB)
 11137*        RIDFLD  (ERPNDB-KEY)
 11138*    END-EXEC.
 11139     MOVE LENGTH OF
 11140      PENDING-BUSINESS
 11141       TO DFHEIV11
 11142*    MOVE '&"IL       E          (   #00010792' TO DFHEIV0
 11143     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11144     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 205
* EL6311.cbl
 11145     MOVE X'2020233030303130373932' TO DFHEIV0(25:11)
 11146     CALL 'kxdfhei1' USING DFHEIV0,
 11147           FILE-ID-ERPNDB,
 11148           PENDING-BUSINESS,
 11149           DFHEIV11,
 11150           ERPNDB-KEY,
 11151           DFHEIV99,
 11152           DFHEIV99,
 11153           DFHEIV99
 11154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11155
 11156
 11157     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11158
 11159
 11160* EXEC CICS HANDLE CONDITION
 11161*         NOTFND     (1385-REC-NOT-FOUND)
 11162*    END-EXEC.
 11163*    MOVE '"$I                   ! '' #00010800' TO DFHEIV0
 11164     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11166     MOVE X'2720233030303130383030' TO DFHEIV0(25:11)
 11167     CALL 'kxdfhei1' USING DFHEIV0
 11168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11169
 11170
 11171**********************************************************
 11172*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11173*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11174**********************************************************
 11175
 11176
 11177* EXEC CICS READ
 11178*        DATASET (FILE-ID-ERPNDB)
 11179*        INTO    (PENDING-BUSINESS)
 11180*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11181*    END-EXEC.
 11182     MOVE LENGTH OF
 11183      PENDING-BUSINESS
 11184       TO DFHEIV11
 11185*    MOVE '&"IL       E          (   #00010809' TO DFHEIV0
 11186     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11188     MOVE X'2020233030303130383039' TO DFHEIV0(25:11)
 11189     CALL 'kxdfhei1' USING DFHEIV0,
 11190           FILE-ID-ERPNDB,
 11191           PENDING-BUSINESS,
 11192           DFHEIV11,
 11193           PI-PREV-CONTROL-PRIMARY,
 11194           DFHEIV99,
 11195           DFHEIV99,
 11196           DFHEIV99
 11197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11198
 11199
 11200********** DO NOT ALLOW CHANGES IF THRU A/R
 11201     IF BMAINTI = 'C'
 11202         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 206
* EL6311.cbl
 11203             MOVE ER-4005          TO EMI-ERROR
 11204             MOVE -1               TO BMAINTL
 11205             MOVE AL-UABON         TO BMAINTA
 11206             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11207             GO TO 8200-SEND-DATAONLY.
 11208**********
 11209
 11210     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11211        MOVE -1                 TO BMAINTL
 11212        MOVE ER-2197            TO EMI-ERROR
 11213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11214        GO TO 8200-SEND-DATAONLY.
 11215
 11216     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11217        MOVE ER-2196             TO EMI-ERROR
 11218        MOVE AL-UABON            TO BMAINTA
 11219        MOVE -1                  TO BMAINTL
 11220        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11221        GO TO 8200-SEND-DATAONLY.
 11222
 11223     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11224
 11225     IF PB-BILLED-DT = LOW-VALUES AND
 11226        PB-CHG-COUNT = ZEROS
 11227        NEXT SENTENCE
 11228     ELSE
 11229        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11230            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11231           OR
 11232           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11233            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11234           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11235
 11236
 11237* EXEC CICS READ
 11238*        DATASET (FILE-ID-ERPNDB)
 11239*        INTO    (PENDING-BUSINESS)
 11240*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11241*        UPDATE
 11242*    END-EXEC.
 11243     MOVE LENGTH OF
 11244      PENDING-BUSINESS
 11245       TO DFHEIV11
 11246*    MOVE '&"IL       EU         (   #00010851' TO DFHEIV0
 11247     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11248     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11249     MOVE X'2020233030303130383531' TO DFHEIV0(25:11)
 11250     CALL 'kxdfhei1' USING DFHEIV0,
 11251           FILE-ID-ERPNDB,
 11252           PENDING-BUSINESS,
 11253           DFHEIV11,
 11254           PI-PREV-CONTROL-PRIMARY,
 11255           DFHEIV99,
 11256           DFHEIV99,
 11257           DFHEIV99
 11258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11259
 11260
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 207
* EL6311.cbl
 11261     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11262     MOVE 'B'                    TO JP-RECORD-TYPE
 11263     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11264     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11265
 11266     PERFORM 8400-LOG-JOURNAL-RECORD.
 11267
 11268     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11269        PB-CHG-COUNT NOT = ZEROS
 11270        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11271            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11272           OR
 11273           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11274            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11275            MOVE LOW-VALUES             TO PB-BILLED-DT
 11276            ADD +1                      TO PB-CHG-COUNT.
 11277
 11278     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11279     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11280     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11281     MOVE '5'                    TO DC-OPTION-CODE.
 11282     PERFORM 9700-DATE-LINK
 11283     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11284
 11285*    IF BMICRNOL  GREATER  ZEROS
 11286*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11287
 11288     IF BVINL > ZEROS
 11289        MOVE BVINI               TO PB-I-VIN
 11290     END-IF
 11291     IF (BFORCEL NOT = ZEROS)
 11292        AND (PB-COMPANY-ID = 'DCC')
 11293        AND (BFORCEI = ' ')
 11294        AND (PB-FORCE-CODE = 'O')
 11295        COMPUTE PB-I-AH-PREMIUM-AMT =
 11296           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11297        PERFORM 1800-REMOVE-CERT-NOTES
 11298                                 THRU 1800-EXIT
 11299        PERFORM 1900-DELETE-ERPYAJ
 11300                                 THRU 1900-EXIT
 11301        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11302     END-IF
 11303     IF (BFORCEL NOT = ZEROS)
 11304        AND (PB-COMPANY-ID = 'DCC')
 11305        AND (BFORCEI = 'O')
 11306        AND (PB-FORCE-CODE NOT = 'O')
 11307        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11308           PB-I-AH-PREM-CALC
 11309        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11310        MOVE SPACE               TO DC-OPTION-CODE
 11311        PERFORM 9700-DATE-LINK
 11312        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11313        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11314        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11315        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11316        PERFORM 1500-UPDATE-ERNOTE
 11317                                 THRU 1500-EXIT
 11318        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 208
* EL6311.cbl
 11319                                 THRU 1600-EXIT
 11320     END-IF
 11321     IF BLSTNML  GREATER THAN ZEROS
 11322         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11323
 11324     IF B1STNML  GREATER THAN ZEROS
 11325         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11326
 11327     IF BINITL   GREATER THAN ZEROS
 11328         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11329
 11330     IF BBIRTHL  GREATER THAN ZERO
 11331         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11332
 11333     IF B1STPMTL GREATER THAN ZERO
 11334         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11335
 11336     IF BAGEL    GREATER THAN ZEROS
 11337         MOVE BAGEI              TO PB-I-AGE.
 11338
 11339     MOVE 'N'                    TO WS-INS-AGE-SET
 11340                                    WS-JNT-AGE-SET.
 11341     IF BAGEL    GREATER THAN ZEROS
 11342        MOVE 'Y'                TO WS-INS-AGE-SET
 11343        IF BAGEI = ZERO AND
 11344             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11345           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11346           MOVE 'AGE*'          TO BAGEDEFO
 11347        ELSE
 11348           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11349           MOVE 'AGE '          TO BAGEDEFO
 11350        END-IF
 11351        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11352     END-IF.
 11353
 11354     IF BSEXL    GREATER THAN ZEROS
 11355         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11356
 11357     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11358        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11359
 11360     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11361        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11362
 11363     IF BLNTRML  GREATER THAN ZEROS
 11364         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11365
 11366     IF BFREQL   GREATER THAN ZEROS
 11367         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11368
 11369     IF BSKPCDL  GREATER THAN ZEROS
 11370         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11371
 11372     IF BMODEL   GREATER THAN ZEROS
 11373         MOVE BMODEI             TO PB-I-TERM-TYPE
 11374                                    PI-BMODE.
 11375
 11376     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 209
* EL6311.cbl
 11377         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11378                                    PI-BPMTS.
 11379
 11380     IF BPMTAMTL GREATER THAN ZEROS
 11381         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11382
 11383     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11384         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11385
 11386     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11387         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11388
 11389     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11390
 11391     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11392         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11393            SUBTRACT PB-I-LF-PREMIUM-AMT
 11394                     FROM WS-B-LF-ISS-PRM-ENTERED
 11395            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11396            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11397            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11398         ELSE
 11399            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11400*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11401*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11402         END-IF
 11403     END-IF.
 11404
 11405     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11406            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11407                     FROM WS-B-LF-ISS-PRM-ENTERED
 11408         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11409         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11410
 11411     IF  BALT-PREM-LEN     (2)  > ZEROS
 11412         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11413
 11414     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11415         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11416
 11417     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11418         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11419            SUBTRACT PB-I-AH-PREMIUM-AMT
 11420                     FROM WS-B-AH-ISS-PRM-ENTERED
 11421            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11422            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11423            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11424         ELSE
 11425            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11426*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11427*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11428         END-IF
 11429     END-IF
 11430
 11431     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11432        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11433
 11434     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 210
* EL6311.cbl
 11435        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11436
 11437     IF BINDGRPL            GREATER THAN ZEROS
 11438         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11439
 11440     IF BRTCLSL             GREATER THAN ZEROS
 11441         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11442
 11443     IF BSIGL               GREATER THAN ZEROS
 11444         MOVE BSIGI              TO PB-I-SIG-SW.
 11445
 11446     IF BAPRL               GREATER THAN ZEROS
 11447         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11448
 11449     IF BMEMBERL            GREATER THAN ZEROS
 11450         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11451
 11452     IF BLNOFCRL            GREATER THAN ZEROS
 11453         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11454
 11455     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11456        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11457
 11458     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11459        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11460
 11461     IF BDAYSL              GREATER THAN ZEROS
 11462        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11463                                    PB-I-EXTENTION-DAYS.
 11464
 11465     IF BDAYSL GREATER THAN ZEROS
 11466        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11467
 11468     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11469        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11470           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11471
 11472     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11473        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11474           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11475
 11476     IF B1STPMTL GREATER THAN ZEROS
 11477        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11478
 11479     IF PB-EXT-DAYS-PROCESSING
 11480        IF PB-I-EXTENTION-DAYS = ZEROS
 11481           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11482
 11483     IF PB-EXPIRE-DT-PROCESSING
 11484        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11485           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11486             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11487
 11488     IF PB-1ST-PMT-DT-PROCESSING
 11489        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11490           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11491
 11492     IF BREINL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 211
* EL6311.cbl
 11493        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11494
 11495     IF BFORCEL NOT = ZEROS
 11496        MOVE BFORCEI             TO PB-FORCE-CODE.
 11497     IF (BENTRYL NOT = ZEROS)
 11498        AND (PB-COMPANY-ID = 'CID')
 11499        AND (PB-STATE = 'VA')
 11500        AND (BENTRYI NOT = 'P')
 11501        AND (PB-BATCH-ENTRY = 'P')
 11502        PERFORM 1800-REMOVE-CERT-NOTES
 11503                                 THRU 1800-EXIT
 11504     END-IF
 11505     IF BENTRYL NOT = ZEROS
 11506        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11507        IF PI-COMPANY-ID = 'CID'
 11508           AND (PB-BATCH-ENTRY = 'P')
 11509           AND (PB-STATE = 'VA')
 11510           PERFORM 1500-UPDATE-ERNOTE
 11511                                 THRU 1500-EXIT
 11512        END-IF
 11513     END-IF
 11514
 11515     IF BUNWRITL NOT = ZEROS
 11516        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11517
 11518     IF BBILCDL NOT = ZEROS
 11519        MOVE BBILCDI             TO PB-RECORD-BILL.
 11520
 11521     IF BLIVESL GREATER THAN ZEROS
 11522        MOVE WS-BLIVES           TO PB-I-LIVES.
 11523
 11524
 11525*DMD CUSTOM CODING*************START
 11526     IF PI-COMPANY-ID NOT = 'DMD'
 11527         MOVE ZEROS               TO BBILLEDL.
 11528*DMD CUSTOM CODING*************END
 11529
 11530     IF BBILLEDL GREATER THAN ZEROS
 11531        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11532
 11533
 11534*****************************************************************
 11535*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11536*****************************************************************
 11537
 11538     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11539        IF BTYPE  (1)   = ZEROS OR SPACES
 11540           IF REMOVE-LF-COVERAGE
 11541               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11542                                        PI-BTYPE (1)
 11543               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11544                                        WS-B-LF-ISS-PRM-ENTERED
 11545               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11546                                        WS-B-LF-ISS-PRM-ENTERED
 11547               SUBTRACT PB-I-LF-PREM-CALC FROM
 11548                                        WS-B-LF-ISS-PRM-COMPUTED
 11549               MOVE ZEROS            TO PB-I-LF-TERM
 11550                                        PB-I-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 212
* EL6311.cbl
 11551                                        PB-I-LF-PREMIUM-AMT
 11552                                        PB-I-LF-BENEFIT-CD
 11553                                        PB-I-LF-PREM-CALC
 11554                                        PB-I-LF-CRIT-PER
 11555                                        PB-I-LF-ALT-BENEFIT-AMT
 11556                                        PB-I-LF-ALT-PREMIUM-AMT
 11557               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11558           ELSE
 11559               NEXT SENTENCE
 11560        ELSE
 11561           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11562                                    PI-BTYPE (1).
 11563     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11564        IF BTYPE  (2)   = ZEROS OR SPACES
 11565           IF  REMOVE-AH-COVERAGE
 11566               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11567                                        PI-BTYPE (2)
 11568               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11569                                        WS-B-AH-ISS-PRM-ENTERED
 11570               SUBTRACT PB-I-AH-PREM-CALC FROM
 11571                                        WS-B-AH-ISS-PRM-COMPUTED
 11572               MOVE ZEROS            TO PB-I-AH-TERM
 11573                                        PB-I-AH-BENEFIT-AMT
 11574                                        PB-I-AH-PREMIUM-AMT
 11575                                        PB-I-AH-BENEFIT-CD
 11576                                        PB-I-AH-PREM-CALC
 11577                                        PB-I-AH-CRIT-PER
 11578               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11579           ELSE
 11580               NEXT SENTENCE
 11581        ELSE
 11582           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11583                                    PI-BTYPE (2).
 11584 1360-REWRITE-PB-RECORD.
 11585     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11586
 11587     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11588     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11589
 11590     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11591
 11592     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11593     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11594
 11595     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11596         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11597
 11598     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11599         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11600
 11601     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11602
 11603     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11604
 11605     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11606
 11607     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11608     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 213
* EL6311.cbl
 11609     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11610
 11611     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11612     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11613
 11614 1375-REWRITE-PB-RECORD.
 11615     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11616     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11617     MOVE 'C'                    TO JP-RECORD-TYPE.
 11618     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11619
 11620
 11621* EXEC CICS REWRITE
 11622*        DATASET (FILE-ID-ERPNDB)
 11623*        FROM    (PENDING-BUSINESS)
 11624*    END-EXEC.
 11625     MOVE LENGTH OF
 11626      PENDING-BUSINESS
 11627       TO DFHEIV11
 11628*    MOVE '&& L                  %   #00011217' TO DFHEIV0
 11629     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11630     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11631     MOVE X'2020233030303131323137' TO DFHEIV0(25:11)
 11632     CALL 'kxdfhei1' USING DFHEIV0,
 11633           FILE-ID-ERPNDB,
 11634           PENDING-BUSINESS,
 11635           DFHEIV11,
 11636           DFHEIV99
 11637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11638
 11639
 11640     PERFORM 8400-LOG-JOURNAL-RECORD.
 11641******************************************************************
 11642*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11643******************************************************************
 11644     display ' made it to update orig cert '
 11645     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11646     MOVE ' '                    TO WS-ERMAIL-SW
 11647
 11648* EXEC CICS READ
 11649*       DATASET   (FILE-ID-ERMAIL)
 11650*       SET       (ADDRESS OF MAILING-DATA)
 11651*       RIDFLD    (ERMAIL-KEY)
 11652*       RESP      (WS-RESPONSE)
 11653*    END-EXEC
 11654*    MOVE '&"S        E          (  N#00011229' TO DFHEIV0
 11655     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11657     MOVE X'204E233030303131323239' TO DFHEIV0(25:11)
 11658     CALL 'kxdfhei1' USING DFHEIV0,
 11659           FILE-ID-ERMAIL,
 11660           DFHEIV20,
 11661           DFHEIV99,
 11662           ERMAIL-KEY,
 11663           DFHEIV99,
 11664           DFHEIV99,
 11665           DFHEIV99
 11666     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 214
* EL6311.cbl
 11667         DFHEIV20
 11668     MOVE EIBRESP  TO WS-RESPONSE
 11669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11670     IF RESP-NORMAL
 11671        SET ERMAIL-FOUND TO TRUE
 11672     END-IF
 11673
 11674     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11675     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11676                                 TO ELCRTO-KEY
 11677     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11678     MOVE +0                     TO ELCRTO-SEQ-NO
 11679
 11680* EXEC CICS READ
 11681*       DATASET   ('ELCRTO')
 11682*       INTO      (ORIGINAL-CERTIFICATE)
 11683*       RIDFLD    (ELCRTO-KEY)
 11684*       GTEQ
 11685*       RESP      (WS-RESPONSE)
 11686*    END-EXEC
 11687     MOVE LENGTH OF
 11688      ORIGINAL-CERTIFICATE
 11689       TO DFHEIV11
 11690     MOVE 'ELCRTO' TO DFHEIV1
 11691*    MOVE '&"IL       G          (  N#00011244' TO DFHEIV0
 11692     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11693     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11694     MOVE X'204E233030303131323434' TO DFHEIV0(25:11)
 11695     CALL 'kxdfhei1' USING DFHEIV0,
 11696           DFHEIV1,
 11697           ORIGINAL-CERTIFICATE,
 11698           DFHEIV11,
 11699           ELCRTO-KEY,
 11700           DFHEIV99,
 11701           DFHEIV99,
 11702           DFHEIV99
 11703     MOVE EIBRESP  TO WS-RESPONSE
 11704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11705     display ' just read gteq ' ws-response
 11706     IF RESP-NORMAL
 11707        AND (OC-CONTROL-PRIMARY (1:33) =
 11708                 PB-CONTROL-BY-ACCOUNT (1:33))
 11709        AND (OC-RECORD-TYPE = 'I')
 11710        display ' resp norm, key =, type i '
 11711        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11712           display ' end proc blank '
 11713           display ' csr edit session ' PI-CSR-SESSION-SW
 11714           IF NOT CSR-EDIT-SESSION
 11715
 11716* EXEC CICS READ
 11717*                DATASET   ('ELCRTO')
 11718*                INTO      (ORIGINAL-CERTIFICATE)
 11719*                RIDFLD    (OC-CONTROL-PRIMARY)
 11720*                UPDATE
 11721*                RESP      (WS-RESPONSE)
 11722*             END-EXEC
 11723     MOVE LENGTH OF
 11724      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 215
* EL6311.cbl
 11725       TO DFHEIV11
 11726     MOVE 'ELCRTO' TO DFHEIV1
 11727*    MOVE '&"IL       EU         (  N#00011261' TO DFHEIV0
 11728     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11729     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11730     MOVE X'204E233030303131323631' TO DFHEIV0(25:11)
 11731     CALL 'kxdfhei1' USING DFHEIV0,
 11732           DFHEIV1,
 11733           ORIGINAL-CERTIFICATE,
 11734           DFHEIV11,
 11735           OC-CONTROL-PRIMARY,
 11736           DFHEIV99,
 11737           DFHEIV99,
 11738           DFHEIV99
 11739     MOVE EIBRESP  TO WS-RESPONSE
 11740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11741              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11742              IF RESP-NORMAL
 11743                 display ' good read upd '
 11744                 MOVE PB-I-INSURED-LAST-NAME TO
 11745                         OC-INS-LAST-NAME
 11746                 MOVE PB-I-INSURED-FIRST-NAME TO
 11747                         OC-INS-FIRST-NAME
 11748                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11749                         OC-INS-MIDDLE-INIT
 11750                 MOVE PB-I-AGE         TO OC-INS-AGE
 11751                 MOVE PB-I-JOINT-LAST-NAME   TO
 11752                         OC-JNT-LAST-NAME
 11753                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11754                         OC-JNT-FIRST-NAME
 11755                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11756                         OC-JNT-MIDDLE-INIT
 11757                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11758                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11759                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11760                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11761                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11762                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11763                         OC-LF-ALT-BEN-AMT
 11764                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11765                         OC-LF-ALT-PRM-AMT
 11766                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11767                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11768                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11769                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11770                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11771                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11772                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11773                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11774                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11775                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11776                 IF OC-CANCEL-TRAN-IND = 'N'
 11777                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11778                    MOVE +0            TO OC-LF-CANCEL-AMT
 11779                                          OC-LF-ITD-CANCEL-AMT
 11780                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11781                    MOVE +0            TO OC-AH-CANCEL-AMT
 11782                                          OC-AH-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 216
* EL6311.cbl
 11783                 END-IF
 11784                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11785                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11786                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11787                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11788                 IF ERMAIL-FOUND
 11789                    MOVE MA-CRED-BENE-NAME
 11790                                 TO OC-CRED-BENE-NAME
 11791                 END-IF
 11792                 IF NOT CERT-TRL-REC-NOT-FOUND
 11793                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11794                           OC-INS-AGE-DEFAULT-FLAG
 11795                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11796                           OC-JNT-AGE-DEFAULT-FLAG
 11797                 END-IF
 11798
 11799* EXEC CICS REWRITE
 11800*                   DATASET   ('ELCRTO')
 11801*                   FROM      (ORIGINAL-CERTIFICATE)
 11802*                   RESP      (WS-RESPONSE)
 11803*                END-EXEC
 11804     MOVE LENGTH OF
 11805      ORIGINAL-CERTIFICATE
 11806       TO DFHEIV11
 11807     MOVE 'ELCRTO' TO DFHEIV1
 11808*    MOVE '&& L                  %  N#00011325' TO DFHEIV0
 11809     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11810     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11811     MOVE X'204E233030303131333235' TO DFHEIV0(25:11)
 11812     CALL 'kxdfhei1' USING DFHEIV0,
 11813           DFHEIV1,
 11814           ORIGINAL-CERTIFICATE,
 11815           DFHEIV11,
 11816           DFHEIV99
 11817     MOVE EIBRESP  TO WS-RESPONSE
 11818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11819                 display ' just rewrote ' ws-response
 11820              END-IF
 11821           END-IF
 11822        ELSE
 11823           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11824           MOVE 'OC'             TO OC-RECORD-ID
 11825           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11826           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11827           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11828           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11829           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11830           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11831           MOVE PB-I-AGE         TO OC-INS-AGE
 11832           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11833           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11834           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11835           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11836           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11837           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11838           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11839           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11840           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 217
* EL6311.cbl
 11841           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11842           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11843           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11844           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11845           MOVE +0               TO OC-LF-CANCEL-AMT
 11846                                    OC-LF-ITD-CANCEL-AMT
 11847           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11848           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11849           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11850           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11851           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11852           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11853           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11854           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11855           MOVE +0               TO OC-AH-CANCEL-AMT
 11856                                    OC-AH-ITD-CANCEL-AMT
 11857           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11858           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11859           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11860           IF ERMAIL-FOUND
 11861              MOVE MA-CRED-BENE-NAME
 11862                                 TO OC-CRED-BENE-NAME
 11863           END-IF
 11864           IF NOT CERT-TRL-REC-NOT-FOUND
 11865              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11866                           OC-INS-AGE-DEFAULT-FLAG
 11867              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11868                           OC-JNT-AGE-DEFAULT-FLAG
 11869           END-IF
 11870           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11871
 11872* EXEC CICS WRITE
 11873*             DATASET   ('ELCRTO')
 11874*             FROM      (ORIGINAL-CERTIFICATE)
 11875*             RIDFLD    (OC-CONTROL-PRIMARY)
 11876*             RESP      (WS-RESPONSE)
 11877*          END-EXEC
 11878     MOVE LENGTH OF
 11879      ORIGINAL-CERTIFICATE
 11880       TO DFHEIV11
 11881     MOVE 'ELCRTO' TO DFHEIV1
 11882*    MOVE '&$ L                  ''  N#00011382' TO DFHEIV0
 11883     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11884     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11885     MOVE X'204E233030303131333832' TO DFHEIV0(25:11)
 11886     CALL 'kxdfhei1' USING DFHEIV0,
 11887           DFHEIV1,
 11888           ORIGINAL-CERTIFICATE,
 11889           DFHEIV11,
 11890           OC-CONTROL-PRIMARY,
 11891           DFHEIV99,
 11892           DFHEIV99
 11893     MOVE EIBRESP  TO WS-RESPONSE
 11894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11895        END-IF
 11896     ELSE
 11897        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11898        MOVE 'OC'                TO OC-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 218
* EL6311.cbl
 11899        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11900                                 TO OC-CONTROL-PRIMARY (1:33)
 11901        MOVE 'I'                 TO OC-RECORD-TYPE
 11902        MOVE +4096               TO OC-KEY-SEQ-NO
 11903        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11904        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11905        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11906        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11907        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11908        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11909        MOVE PB-I-AGE            TO OC-INS-AGE
 11910        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11911        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11912        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11913        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11914        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11915        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11916        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11917        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11918        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11919        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11920        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11921        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11922        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11923        MOVE +0                  TO OC-LF-CANCEL-AMT
 11924                                    OC-LF-ITD-CANCEL-AMT
 11925        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11926        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11927        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11928        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11929        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11930        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11931        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11932        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11933        MOVE +0                  TO OC-AH-CANCEL-AMT
 11934                                    OC-AH-ITD-CANCEL-AMT
 11935        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11936        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11937        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11938        IF ERMAIL-FOUND
 11939           MOVE MA-CRED-BENE-NAME
 11940                                 TO OC-CRED-BENE-NAME
 11941        END-IF
 11942        IF NOT CERT-TRL-REC-NOT-FOUND
 11943           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11944                           OC-INS-AGE-DEFAULT-FLAG
 11945           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11946                           OC-JNT-AGE-DEFAULT-FLAG
 11947        END-IF
 11948        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11949
 11950* EXEC CICS WRITE
 11951*          DATASET   ('ELCRTO')
 11952*          FROM      (ORIGINAL-CERTIFICATE)
 11953*          RIDFLD    (OC-CONTROL-PRIMARY)
 11954*          RESP      (WS-RESPONSE)
 11955*       END-EXEC
 11956     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 219
* EL6311.cbl
 11957      ORIGINAL-CERTIFICATE
 11958       TO DFHEIV11
 11959     MOVE 'ELCRTO' TO DFHEIV1
 11960*    MOVE '&$ L                  ''  N#00011442' TO DFHEIV0
 11961     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11962     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11963     MOVE X'204E233030303131343432' TO DFHEIV0(25:11)
 11964     CALL 'kxdfhei1' USING DFHEIV0,
 11965           DFHEIV1,
 11966           ORIGINAL-CERTIFICATE,
 11967           DFHEIV11,
 11968           OC-CONTROL-PRIMARY,
 11969           DFHEIV99,
 11970           DFHEIV99
 11971     MOVE EIBRESP  TO WS-RESPONSE
 11972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11973     END-IF
 11974******************************************************************
 11975*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11976******************************************************************
 11977
 11978     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11979     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11980
 11981
 11982* EXEC CICS READ
 11983*        INTO    (PENDING-BUSINESS)
 11984*        DATASET (FILE-ID-ERPNDB)
 11985*        RIDFLD  (ERPNDB-KEY)
 11986*        UPDATE
 11987*    END-EXEC.
 11988     MOVE LENGTH OF
 11989      PENDING-BUSINESS
 11990       TO DFHEIV11
 11991*    MOVE '&"IL       EU         (   #00011456' TO DFHEIV0
 11992     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11993     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11994     MOVE X'2020233030303131343536' TO DFHEIV0(25:11)
 11995     CALL 'kxdfhei1' USING DFHEIV0,
 11996           FILE-ID-ERPNDB,
 11997           PENDING-BUSINESS,
 11998           DFHEIV11,
 11999           ERPNDB-KEY,
 12000           DFHEIV99,
 12001           DFHEIV99,
 12002           DFHEIV99
 12003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12004
 12005
 12006     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12007     MOVE 'B'                    TO JP-RECORD-TYPE.
 12008     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12009
 12010     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12011
 12012     PERFORM 8400-LOG-JOURNAL-RECORD.
 12013
 12014     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 220
* EL6311.cbl
 12015
 12016     MOVE 'C'                    TO JP-RECORD-TYPE.
 12017     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12018
 12019
 12020* EXEC CICS REWRITE
 12021*        DATASET    (FILE-ID-ERPNDB)
 12022*        FROM       (PENDING-BUSINESS)
 12023*    END-EXEC.
 12024     MOVE LENGTH OF
 12025      PENDING-BUSINESS
 12026       TO DFHEIV11
 12027*    MOVE '&& L                  %   #00011476' TO DFHEIV0
 12028     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12029     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12030     MOVE X'2020233030303131343736' TO DFHEIV0(25:11)
 12031     CALL 'kxdfhei1' USING DFHEIV0,
 12032           FILE-ID-ERPNDB,
 12033           PENDING-BUSINESS,
 12034           DFHEIV11,
 12035           DFHEIV99
 12036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12037
 12038
 12039     PERFORM 8400-LOG-JOURNAL-RECORD.
 12040
 12041     IF WS-ERRORS-PRESENT
 12042        GO TO 3900-RE-DISPLAY-RECORD.
 12043
 12044     MOVE ZEROS                  TO EMI-ERROR.
 12045     MOVE -1                     TO BMAINTL.
 12046     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12047     GO TO 3900-RE-DISPLAY-RECORD.
 12048
 12049 1380-BATCH-HDR-NOT-FOUND.
 12050     MOVE -1                     TO BMAINTL.
 12051     MOVE ER-7450                TO EMI-ERROR.
 12052     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12053     GO TO 8200-SEND-DATAONLY.
 12054
 12055 1385-REC-NOT-FOUND.
 12056     MOVE -1                     TO BMAINTL.
 12057     MOVE ER-7451                TO EMI-ERROR.
 12058     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12059     GO TO 8200-SEND-DATAONLY.
 12060
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 221
* EL6311.cbl
 12062
 12063 1386-UPDATE-AGE-FLAGS.
 12064
 12065
 12066* EXEC CICS GETMAIN
 12067*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12068*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12069*        INITIMG (GETMAIN-SPACE)
 12070*    END-EXEC
 12071*    MOVE ',"IL                  $   #00011507' TO DFHEIV0
 12072     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12073     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12074     MOVE X'2020233030303131353037' TO DFHEIV0(25:11)
 12075     CALL 'kxdfhei1' USING DFHEIV0,
 12076           DFHEIV20,
 12077           ELCRTT-RECORD-LENGTH,
 12078           GETMAIN-SPACE
 12079     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12080         DFHEIV20
 12081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12082
 12083
 12084* EXEC CICS HANDLE CONDITION
 12085*        NOTFND   (1386-NOTFND)
 12086*    END-EXEC.
 12087*    MOVE '"$I                   ! ( #00011513' TO DFHEIV0
 12088     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12089     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12090     MOVE X'2820233030303131353133' TO DFHEIV0(25:11)
 12091     CALL 'kxdfhei1' USING DFHEIV0
 12092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12093
 12094
 12095     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12096     MOVE 'C'                TO ELCRTT-REC-TYPE
 12097
 12098
 12099* EXEC CICS READ
 12100*        UPDATE
 12101*        DATASET  (CRTT-ID)
 12102*        RIDFLD   (ELCRTT-KEY)
 12103*        INTO     (CERTIFICATE-TRAILERS)
 12104*    END-EXEC.
 12105     MOVE LENGTH OF
 12106      CERTIFICATE-TRAILERS
 12107       TO DFHEIV11
 12108*    MOVE '&"IL       EU         (   #00011520' TO DFHEIV0
 12109     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12110     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12111     MOVE X'2020233030303131353230' TO DFHEIV0(25:11)
 12112     CALL 'kxdfhei1' USING DFHEIV0,
 12113           CRTT-ID,
 12114           CERTIFICATE-TRAILERS,
 12115           DFHEIV11,
 12116           ELCRTT-KEY,
 12117           DFHEIV99,
 12118           DFHEIV99,
 12119           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 222
* EL6311.cbl
 12120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12121
 12122
 12123     IF WS-INS-AGE-SET = 'Y'
 12124        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12125     END-IF
 12126     IF WS-JNT-AGE-SET = 'Y'
 12127        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12128     END-IF
 12129
 12130
 12131* EXEC CICS REWRITE
 12132*       DATASET  (CRTT-ID)
 12133*       FROM     (CERTIFICATE-TRAILERS)
 12134*    END-EXEC.
 12135     MOVE LENGTH OF
 12136      CERTIFICATE-TRAILERS
 12137       TO DFHEIV11
 12138*    MOVE '&& L                  %   #00011534' TO DFHEIV0
 12139     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12140     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12141     MOVE X'2020233030303131353334' TO DFHEIV0(25:11)
 12142     CALL 'kxdfhei1' USING DFHEIV0,
 12143           CRTT-ID,
 12144           CERTIFICATE-TRAILERS,
 12145           DFHEIV11,
 12146           DFHEIV99
 12147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12148
 12149
 12150     GO TO 1386-EXIT.
 12151
 12152 1386-NOTFND.
 12153
 12154     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12155     MOVE 'CS'         TO CS-RECORD-ID.
 12156     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12157     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12158     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12159     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12160     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12161
 12162* EXEC CICS WRITE
 12163*       DATASET  (CRTT-ID)
 12164*       RIDFLD   (ELCRTT-KEY)
 12165*       FROM     (CERTIFICATE-TRAILERS)
 12166*    END-EXEC.
 12167     MOVE LENGTH OF
 12168      CERTIFICATE-TRAILERS
 12169       TO DFHEIV11
 12170*    MOVE '&$ L                  ''   #00011550' TO DFHEIV0
 12171     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12172     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12173     MOVE X'2020233030303131353530' TO DFHEIV0(25:11)
 12174     CALL 'kxdfhei1' USING DFHEIV0,
 12175           CRTT-ID,
 12176           CERTIFICATE-TRAILERS,
 12177           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 223
* EL6311.cbl
 12178           ELCRTT-KEY,
 12179           DFHEIV99,
 12180           DFHEIV99
 12181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12182
 12183
 12184 1386-EXIT.
 12185     EXIT.
 12186
 12187 1390-UPDATE-ERPNDM.
 12188
 12189
 12190* EXEC CICS HANDLE CONDITION
 12191*        NOTFND (1399-EXIT)
 12192*    END-EXEC.
 12193*    MOVE '"$I                   ! ) #00011561' TO DFHEIV0
 12194     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12196     MOVE X'2920233030303131353631' TO DFHEIV0(25:11)
 12197     CALL 'kxdfhei1' USING DFHEIV0
 12198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12199
 12200
 12201     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12202
 12203
 12204* EXEC CICS READ
 12205*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12206*        DATASET (FILE-ID-ERPNDM)
 12207*        RIDFLD  (ERPNDM-KEY)
 12208*        UPDATE
 12209*    END-EXEC.
 12210*    MOVE '&"S        EU         (   #00011567' TO DFHEIV0
 12211     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12212     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12213     MOVE X'2020233030303131353637' TO DFHEIV0(25:11)
 12214     CALL 'kxdfhei1' USING DFHEIV0,
 12215           FILE-ID-ERPNDM,
 12216           DFHEIV20,
 12217           DFHEIV99,
 12218           ERPNDM-KEY,
 12219           DFHEIV99,
 12220           DFHEIV99,
 12221           DFHEIV99
 12222     SET ADDRESS OF PENDING-MAILING-DATA TO
 12223         DFHEIV20
 12224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12225
 12226
 12227     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12228     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12229     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12230
 12231     IF BLSTNML GREATER THAN ZEROS
 12232         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12233
 12234     IF B1STNML GREATER  THAN ZEROS
 12235         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 224
* EL6311.cbl
 12236
 12237     IF BINITL GREATER THAN ZEROS
 12238         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12239
 12240     IF BAGEL GREATER THAN ZEROS
 12241         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12242
 12243     IF BBIRTHL GREATER THAN ZEROS
 12244         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12245
 12246     IF BSEXL GREATER THAN ZEROS
 12247         MOVE  BSEXI             TO PM-INSURED-SEX.
 12248
 12249
 12250* EXEC CICS REWRITE
 12251*        DATASET (FILE-ID-ERPNDM)
 12252*        FROM    (PENDING-MAILING-DATA)
 12253*    END-EXEC.
 12254     MOVE LENGTH OF
 12255      PENDING-MAILING-DATA
 12256       TO DFHEIV11
 12257*    MOVE '&& L                  %   #00011596' TO DFHEIV0
 12258     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12259     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12260     MOVE X'2020233030303131353936' TO DFHEIV0(25:11)
 12261     CALL 'kxdfhei1' USING DFHEIV0,
 12262           FILE-ID-ERPNDM,
 12263           PENDING-MAILING-DATA,
 12264           DFHEIV11,
 12265           DFHEIV99
 12266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12267
 12268
 12269 1399-EXIT.
 12270     EXIT.
 12271
 12272******************************************************************
 12273*                                                                *
 12274*          D E L E T E   I S S U E   R O U T I N E               *
 12275*                                                                *
 12276******************************************************************
 12277
 12278 1400-DELETE-ISSUE-ROUTINE.
 12279     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12280
 12281     IF BCHGL NOT = ZEROS
 12282        MOVE ER-2196             TO EMI-ERROR
 12283        MOVE AL-UABON            TO BMAINTA
 12284        MOVE -1                  TO BMAINTL
 12285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12286        GO TO 8200-SEND-DATAONLY.
 12287
 12288
 12289* EXEC CICS HANDLE CONDITION
 12290*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12291*    END-EXEC.
 12292*    MOVE '"$I                   ! * #00011620' TO DFHEIV0
 12293     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 225
* EL6311.cbl
 12294     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12295     MOVE X'2A20233030303131363230' TO DFHEIV0(25:11)
 12296     CALL 'kxdfhei1' USING DFHEIV0
 12297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12298
 12299
 12300     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12301     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12302     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12303
 12304
 12305* EXEC CICS READ
 12306*        SET     (ADDRESS OF PENDING-BUSINESS)
 12307*        DATASET (FILE-ID-ERPNDB)
 12308*        RIDFLD  (ERPNDB-KEY)
 12309*    END-EXEC.
 12310*    MOVE '&"S        E          (   #00011628' TO DFHEIV0
 12311     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12312     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12313     MOVE X'2020233030303131363238' TO DFHEIV0(25:11)
 12314     CALL 'kxdfhei1' USING DFHEIV0,
 12315           FILE-ID-ERPNDB,
 12316           DFHEIV20,
 12317           DFHEIV99,
 12318           ERPNDB-KEY,
 12319           DFHEIV99,
 12320           DFHEIV99,
 12321           DFHEIV99
 12322     SET ADDRESS OF PENDING-BUSINESS TO
 12323         DFHEIV20
 12324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12325
 12326
 12327     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12328
 12329     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12330
 12331     IF BSUFIXL NOT = ZEROS
 12332        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12333     ELSE
 12334        MOVE SPACE               TO WS-NEW-SUFFIX.
 12335
 12336     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12337     PERFORM 8600-DEEDIT.
 12338     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12339     MOVE '4'                    TO DC-OPTION-CODE.
 12340     PERFORM 9700-DATE-LINK.
 12341     IF DATE-CONVERSION-ERROR
 12342        MOVE ER-0348             TO EMI-ERROR
 12343        MOVE -1                  TO BEFFDTL
 12344        MOVE AL-UABON            TO BEFFDTA
 12345        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12346        GO TO 8200-SEND-DATAONLY
 12347     ELSE
 12348        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12349        MOVE AL-UANON            TO BEFFDTA
 12350        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12351
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 226
* EL6311.cbl
 12352
 12353* EXEC CICS HANDLE CONDITION
 12354*         NOTFND    (1490-RECORD-NOT-FOUND)
 12355*    END-EXEC.
 12356*    MOVE '"$I                   ! + #00011659' TO DFHEIV0
 12357     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12359     MOVE X'2B20233030303131363539' TO DFHEIV0(25:11)
 12360     CALL 'kxdfhei1' USING DFHEIV0
 12361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12362
 12363
 12364
 12365* EXEC CICS READ
 12366*        SET     (ADDRESS OF PENDING-BUSINESS)
 12367*        DATASET (FILE-ID-ERPNDB)
 12368*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12369*        UPDATE
 12370*    END-EXEC.
 12371*    MOVE '&"S        EU         (   #00011663' TO DFHEIV0
 12372     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12373     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12374     MOVE X'2020233030303131363633' TO DFHEIV0(25:11)
 12375     CALL 'kxdfhei1' USING DFHEIV0,
 12376           FILE-ID-ERPNDB,
 12377           DFHEIV20,
 12378           DFHEIV99,
 12379           PI-PREV-CONTROL-PRIMARY,
 12380           DFHEIV99,
 12381           DFHEIV99,
 12382           DFHEIV99
 12383     SET ADDRESS OF PENDING-BUSINESS TO
 12384         DFHEIV20
 12385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12386
 12387
 12388     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12389        MOVE -1                 TO BMAINTL
 12390        MOVE ER-2197            TO EMI-ERROR
 12391        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12392        GO TO 8200-SEND-DATAONLY.
 12393
 12394     IF PB-BILLED-DT NOT = LOW-VALUES
 12395        MOVE -1                 TO BMAINTL
 12396        MOVE ER-2129            TO EMI-ERROR
 12397        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12398        GO TO 8200-SEND-DATAONLY.
 12399
 12400     IF PB-CHG-COUNT NOT = ZEROS
 12401        MOVE ER-2336            TO EMI-ERROR
 12402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12403        MOVE AL-UABON            TO BMAINTA
 12404        MOVE -1                  TO BMAINTL
 12405        GO TO 8200-SEND-DATAONLY.
 12406
 12407     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12408        PB-CHG-COUNT NOT = ZEROS
 12409        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 227
* EL6311.cbl
 12410        MOVE AL-UABON            TO BMAINTA
 12411        MOVE -1                  TO BMAINTL
 12412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12413        GO TO 8200-SEND-DATAONLY.
 12414******************************************************************
 12415*                                                                *
 12416*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12417*                                                                *
 12418******************************************************************
 12419     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12420     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12421     MOVE +0                     TO ELCRTO-SEQ-NO
 12422
 12423* EXEC CICS READ
 12424*       DATASET   ('ELCRTO')
 12425*       INTO      (ORIGINAL-CERTIFICATE)
 12426*       RIDFLD    (ELCRTO-KEY)
 12427*       GTEQ
 12428*       RESP      (WS-RESPONSE)
 12429*    END-EXEC
 12430     MOVE LENGTH OF
 12431      ORIGINAL-CERTIFICATE
 12432       TO DFHEIV11
 12433     MOVE 'ELCRTO' TO DFHEIV1
 12434*    MOVE '&"IL       G          (  N#00011704' TO DFHEIV0
 12435     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12437     MOVE X'204E233030303131373034' TO DFHEIV0(25:11)
 12438     CALL 'kxdfhei1' USING DFHEIV0,
 12439           DFHEIV1,
 12440           ORIGINAL-CERTIFICATE,
 12441           DFHEIV11,
 12442           ELCRTO-KEY,
 12443           DFHEIV99,
 12444           DFHEIV99,
 12445           DFHEIV99
 12446     MOVE EIBRESP  TO WS-RESPONSE
 12447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12448     IF RESP-NORMAL
 12449        AND (OC-CONTROL-PRIMARY (1:33) =
 12450                 PB-CONTROL-BY-ACCOUNT (1:33))
 12451        AND (OC-RECORD-TYPE = 'I')
 12452
 12453* EXEC CICS READ
 12454*          DATASET   ('ELCRTO')
 12455*          INTO      (ORIGINAL-CERTIFICATE)
 12456*          RIDFLD    (ELCRTO-KEY)
 12457*          UPDATE
 12458*          RESP      (WS-RESPONSE)
 12459*       END-EXEC
 12460     MOVE LENGTH OF
 12461      ORIGINAL-CERTIFICATE
 12462       TO DFHEIV11
 12463     MOVE 'ELCRTO' TO DFHEIV1
 12464*    MOVE '&"IL       EU         (  N#00011715' TO DFHEIV0
 12465     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12466     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12467     MOVE X'204E233030303131373135' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 228
* EL6311.cbl
 12468     CALL 'kxdfhei1' USING DFHEIV0,
 12469           DFHEIV1,
 12470           ORIGINAL-CERTIFICATE,
 12471           DFHEIV11,
 12472           ELCRTO-KEY,
 12473           DFHEIV99,
 12474           DFHEIV99,
 12475           DFHEIV99
 12476     MOVE EIBRESP  TO WS-RESPONSE
 12477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12478        IF RESP-NORMAL
 12479
 12480* EXEC CICS DELETE
 12481*             DATASET   ('ELCRTO')
 12482*          END-EXEC
 12483     MOVE 'ELCRTO' TO DFHEIV1
 12484*    MOVE '&(                    &   #00011723' TO DFHEIV0
 12485     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12486     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12487     MOVE X'2020233030303131373233' TO DFHEIV0(25:11)
 12488     CALL 'kxdfhei1' USING DFHEIV0,
 12489           DFHEIV1,
 12490           DFHEIV99,
 12491           DFHEIV99,
 12492           DFHEIV99,
 12493           DFHEIV99
 12494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12495        END-IF
 12496     END-IF
 12497******************************************************************
 12498*                                                                *
 12499*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12500*                                                                *
 12501******************************************************************
 12502
 12503* EXEC CICS HANDLE CONDITION
 12504*        NOTFND    (1405-DELETE-CERTIFICATE)
 12505*    END-EXEC.
 12506*    MOVE '"$I                   ! , #00011733' TO DFHEIV0
 12507     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12509     MOVE X'2C20233030303131373333' TO DFHEIV0(25:11)
 12510     CALL 'kxdfhei1' USING DFHEIV0
 12511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12512
 12513
 12514
 12515* EXEC CICS READ
 12516*        EQUAL
 12517*        DATASET   (FILE-ID-ERPNDM)
 12518*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12519*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12520*        UPDATE
 12521*    END-EXEC.
 12522*    MOVE '&"S        EU         (   #00011737' TO DFHEIV0
 12523     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12524     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12525     MOVE X'2020233030303131373337' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 229
* EL6311.cbl
 12526     CALL 'kxdfhei1' USING DFHEIV0,
 12527           FILE-ID-ERPNDM,
 12528           DFHEIV20,
 12529           DFHEIV99,
 12530           PI-PREV-CONTROL-PRIMARY,
 12531           DFHEIV99,
 12532           DFHEIV99,
 12533           DFHEIV99
 12534     SET ADDRESS OF PENDING-MAILING-DATA TO
 12535         DFHEIV20
 12536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12537
 12538
 12539     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12540     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12541     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12542
 12543     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12544
 12545
 12546* EXEC CICS DELETE
 12547*        DATASET   (FILE-ID-ERPNDM)
 12548*    END-EXEC.
 12549*    MOVE '&(                    &   #00011751' TO DFHEIV0
 12550     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12551     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12552     MOVE X'2020233030303131373531' TO DFHEIV0(25:11)
 12553     CALL 'kxdfhei1' USING DFHEIV0,
 12554           FILE-ID-ERPNDM,
 12555           DFHEIV99,
 12556           DFHEIV99,
 12557           DFHEIV99,
 12558           DFHEIV99
 12559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12560
 12561
 12562******************************************************************
 12563*                PROCESS   CERTIFICATE                           *
 12564******************************************************************
 12565
 12566 1405-DELETE-CERTIFICATE.
 12567
 12568* EXEC CICS HANDLE CONDITION
 12569*         NOTFND  (1420-CONTINUE-DELETE)
 12570*    END-EXEC.
 12571*    MOVE '"$I                   ! - #00011760' TO DFHEIV0
 12572     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12574     MOVE X'2D20233030303131373630' TO DFHEIV0(25:11)
 12575     CALL 'kxdfhei1' USING DFHEIV0
 12576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12577
 12578
 12579     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12580     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12581     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12582     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12583
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 230
* EL6311.cbl
 12584
 12585* EXEC CICS READ
 12586*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12587*        DATASET (FILE-ID-ELCERT)
 12588*        RIDFLD  (ELCERT-KEY)
 12589*        UPDATE
 12590*    END-EXEC.
 12591*    MOVE '&"S        EU         (   #00011769' TO DFHEIV0
 12592     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12593     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12594     MOVE X'2020233030303131373639' TO DFHEIV0(25:11)
 12595     CALL 'kxdfhei1' USING DFHEIV0,
 12596           FILE-ID-ELCERT,
 12597           DFHEIV20,
 12598           DFHEIV99,
 12599           ELCERT-KEY,
 12600           DFHEIV99,
 12601           DFHEIV99,
 12602           DFHEIV99
 12603     SET ADDRESS OF CERTIFICATE-MASTER TO
 12604         DFHEIV20
 12605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12606
 12607
 12608     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12609
 12610     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12611     MOVE 'B'                    TO JP-RECORD-TYPE
 12612     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12613
 12614     PERFORM 8400-LOG-JOURNAL-RECORD.
 12615
 12616     IF CERT-NOTES-ARE-NOT-PRESENT
 12617        MOVE ' '                 TO WS-CERT-NOTE-SW
 12618     ELSE
 12619        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12620
 12621     IF INSURED-ADDR-PRESENT
 12622        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12623
 12624******************************************************************
 12625******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12626******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12627******************************************************************
 12628******************************************************************
 12629
 12630     IF CERT-ADDED-BATCH AND
 12631        (NOT NO-CLAIM-ATTACHED
 12632         OR
 12633         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12634        GO TO 1410-REWRITE-CERT.
 12635
 12636******************************************************************
 12637******************************************************************
 12638
 12639     IF CERT-ADDED-BATCH  AND
 12640        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12641        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 231
* EL6311.cbl
 12642
 12643     IF NO-CLAIM-ATTACHED
 12644        NEXT SENTENCE
 12645     ELSE
 12646        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12647        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12648        GO TO 1410-REWRITE-CERT.
 12649
 12650     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12651     MOVE 'D'                      TO JP-RECORD-TYPE.
 12652     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12653
 12654
 12655* EXEC CICS DELETE
 12656*         DATASET    (FILE-ID-ELCERT)
 12657*    END-EXEC.
 12658*    MOVE '&(                    &   #00011822' TO DFHEIV0
 12659     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12660     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12661     MOVE X'2020233030303131383232' TO DFHEIV0(25:11)
 12662     CALL 'kxdfhei1' USING DFHEIV0,
 12663           FILE-ID-ELCERT,
 12664           DFHEIV99,
 12665           DFHEIV99,
 12666           DFHEIV99,
 12667           DFHEIV99
 12668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12669
 12670
 12671     PERFORM 8400-LOG-JOURNAL-RECORD.
 12672
 12673******************************************************************
 12674*                                                                *
 12675*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12676*                                                                *
 12677******************************************************************
 12678
 12679     IF  CERT-NOTES-ARE-PRESENT
 12680         NEXT SENTENCE
 12681     ELSE
 12682         GO TO 1407-DELETE-MAILING.
 12683
 12684
 12685* EXEC CICS HANDLE CONDITION
 12686*         NOTFND  (1406-DELETE-ERNOTE)
 12687*    END-EXEC.
 12688*    MOVE '"$I                   ! . #00011839' TO DFHEIV0
 12689     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12691     MOVE X'2E20233030303131383339' TO DFHEIV0(25:11)
 12692     CALL 'kxdfhei1' USING DFHEIV0
 12693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12694
 12695
 12696     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12697     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12698     MOVE 0                     TO ERCNOT-SEQUENCE.
 12699
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 232
* EL6311.cbl
 12700 1406-DELETE-ERCNOT-LOOP.
 12701
 12702
 12703* EXEC CICS READ
 12704*        GTEQ
 12705*        DATASET   (FILE-ID-ERCNOT)
 12706*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12707*        RIDFLD    (ERCNOT-KEY)
 12708*    END-EXEC.
 12709*    MOVE '&"S        G          (   #00011849' TO DFHEIV0
 12710     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12712     MOVE X'2020233030303131383439' TO DFHEIV0(25:11)
 12713     CALL 'kxdfhei1' USING DFHEIV0,
 12714           FILE-ID-ERCNOT,
 12715           DFHEIV20,
 12716           DFHEIV99,
 12717           ERCNOT-KEY,
 12718           DFHEIV99,
 12719           DFHEIV99,
 12720           DFHEIV99
 12721     SET ADDRESS OF CERT-NOTE-FILE TO
 12722         DFHEIV20
 12723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12724
 12725
 12726     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12727     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12728         GO TO 1406-DELETE-ERNOTE
 12729     END-IF.
 12730
 12731     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12732     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12733     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12734
 12735     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12736
 12737
 12738* EXEC CICS DELETE
 12739*        DATASET   (FILE-ID-ERCNOT)
 12740*        RIDFLD    (ERCNOT-KEY)
 12741*        END-EXEC.
 12742*    MOVE '&(  R                 &   #00011867' TO DFHEIV0
 12743     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12744     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12745     MOVE X'2020233030303131383637' TO DFHEIV0(25:11)
 12746     CALL 'kxdfhei1' USING DFHEIV0,
 12747           FILE-ID-ERCNOT,
 12748           ERCNOT-KEY,
 12749           DFHEIV99,
 12750           DFHEIV99,
 12751           DFHEIV99
 12752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12753
 12754
 12755     PERFORM 8400-LOG-JOURNAL-RECORD.
 12756
 12757     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 233
* EL6311.cbl
 12758
 12759 1406-DELETE-ERNOTE.
 12760
 12761
 12762* EXEC CICS HANDLE CONDITION
 12763*         NOTFND  (1407-DELETE-MAILING)
 12764*    END-EXEC.
 12765*    MOVE '"$I                   ! / #00011878' TO DFHEIV0
 12766     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12768     MOVE X'2F20233030303131383738' TO DFHEIV0(25:11)
 12769     CALL 'kxdfhei1' USING DFHEIV0
 12770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12771
 12772
 12773
 12774* EXEC CICS READ
 12775*        EQUAL
 12776*        DATASET   (FILE-ID-ERNOTE)
 12777*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12778*        RIDFLD    (ELCERT-KEY)
 12779*        UPDATE
 12780*    END-EXEC.
 12781*    MOVE '&"S        EU         (   #00011882' TO DFHEIV0
 12782     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12783     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12784     MOVE X'2020233030303131383832' TO DFHEIV0(25:11)
 12785     CALL 'kxdfhei1' USING DFHEIV0,
 12786           FILE-ID-ERNOTE,
 12787           DFHEIV20,
 12788           DFHEIV99,
 12789           ELCERT-KEY,
 12790           DFHEIV99,
 12791           DFHEIV99,
 12792           DFHEIV99
 12793     SET ADDRESS OF CERTIFICATE-NOTE TO
 12794         DFHEIV20
 12795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12796
 12797
 12798     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12799     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12800     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12801
 12802     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12803
 12804
 12805* EXEC CICS DELETE
 12806*        DATASET   (FILE-ID-ERNOTE)
 12807*        END-EXEC.
 12808*    MOVE '&(                    &   #00011896' TO DFHEIV0
 12809     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12810     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12811     MOVE X'2020233030303131383936' TO DFHEIV0(25:11)
 12812     CALL 'kxdfhei1' USING DFHEIV0,
 12813           FILE-ID-ERNOTE,
 12814           DFHEIV99,
 12815           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 234
* EL6311.cbl
 12816           DFHEIV99,
 12817           DFHEIV99
 12818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12819
 12820
 12821     PERFORM 8400-LOG-JOURNAL-RECORD.
 12822
 12823******************************************************************
 12824*                                                                *
 12825*                DELETE MAILING ADDRESS RECORDS                  *
 12826*                                                                *
 12827******************************************************************
 12828
 12829 1407-DELETE-MAILING.
 12830     IF CERT-ADDRESS-PRESENT
 12831        NEXT SENTENCE
 12832     ELSE
 12833        GO TO 1420-CONTINUE-DELETE.
 12834
 12835
 12836* EXEC CICS HANDLE CONDITION
 12837*         NOTFND  (1420-CONTINUE-DELETE)
 12838*    END-EXEC.
 12839*    MOVE '"$I                   ! 0 #00011914' TO DFHEIV0
 12840     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12842     MOVE X'3020233030303131393134' TO DFHEIV0(25:11)
 12843     CALL 'kxdfhei1' USING DFHEIV0
 12844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12845
 12846
 12847
 12848* EXEC CICS READ
 12849*        EQUAL
 12850*        DATASET   (FILE-ID-ERMAIL)
 12851*        SET       (ADDRESS OF MAILING-DATA)
 12852*        RIDFLD    (ELCERT-KEY)
 12853*        UPDATE
 12854*    END-EXEC.
 12855*    MOVE '&"S        EU         (   #00011918' TO DFHEIV0
 12856     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12857     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12858     MOVE X'2020233030303131393138' TO DFHEIV0(25:11)
 12859     CALL 'kxdfhei1' USING DFHEIV0,
 12860           FILE-ID-ERMAIL,
 12861           DFHEIV20,
 12862           DFHEIV99,
 12863           ELCERT-KEY,
 12864           DFHEIV99,
 12865           DFHEIV99,
 12866           DFHEIV99
 12867     SET ADDRESS OF MAILING-DATA TO
 12868         DFHEIV20
 12869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12870
 12871
 12872     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12873     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 235
* EL6311.cbl
 12874     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12875
 12876     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12877
 12878
 12879* EXEC CICS DELETE
 12880*        DATASET   (FILE-ID-ERMAIL)
 12881*    END-EXEC.
 12882*    MOVE '&(                    &   #00011932' TO DFHEIV0
 12883     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12884     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12885     MOVE X'2020233030303131393332' TO DFHEIV0(25:11)
 12886     CALL 'kxdfhei1' USING DFHEIV0,
 12887           FILE-ID-ERMAIL,
 12888           DFHEIV99,
 12889           DFHEIV99,
 12890           DFHEIV99,
 12891           DFHEIV99
 12892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12893
 12894
 12895     GO TO 1420-CONTINUE-DELETE.
 12896
 12897 1410-REWRITE-CERT.
 12898     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12899     MOVE 'C'                      TO JP-RECORD-TYPE.
 12900     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12901     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12902
 12903
 12904* EXEC CICS REWRITE
 12905*         DATASET    (FILE-ID-ELCERT)
 12906*         FROM       (CERTIFICATE-MASTER)
 12907*         END-EXEC.
 12908     MOVE LENGTH OF
 12909      CERTIFICATE-MASTER
 12910       TO DFHEIV11
 12911*    MOVE '&& L                  %   #00011944' TO DFHEIV0
 12912     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12913     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12914     MOVE X'2020233030303131393434' TO DFHEIV0(25:11)
 12915     CALL 'kxdfhei1' USING DFHEIV0,
 12916           FILE-ID-ELCERT,
 12917           CERTIFICATE-MASTER,
 12918           DFHEIV11,
 12919           DFHEIV99
 12920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12921
 12922
 12923     PERFORM 8400-LOG-JOURNAL-RECORD.
 12924
 12925 1420-CONTINUE-DELETE.
 12926     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12927     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12928
 12929     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12930     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12931
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 236
* EL6311.cbl
 12932     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12933
 12934 1450-DELETE-PB-RECORD.
 12935     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12936     MOVE 'D'                      TO JP-RECORD-TYPE
 12937     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12938
 12939
 12940* EXEC CICS DELETE
 12941*        DATASET    (FILE-ID-ERPNDB)
 12942*    END-EXEC.
 12943*    MOVE '&(                    &   #00011965' TO DFHEIV0
 12944     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12945     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12946     MOVE X'2020233030303131393635' TO DFHEIV0(25:11)
 12947     CALL 'kxdfhei1' USING DFHEIV0,
 12948           FILE-ID-ERPNDB,
 12949           DFHEIV99,
 12950           DFHEIV99,
 12951           DFHEIV99,
 12952           DFHEIV99
 12953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12954
 12955
 12956     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12957
 12958     PERFORM 8400-LOG-JOURNAL-RECORD.
 12959
 12960     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12961     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12962     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12963
 12964
 12965* EXEC CICS HANDLE CONDITION
 12966*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12967*    END-EXEC.
 12968*    MOVE '"$I                   ! 1 #00011977' TO DFHEIV0
 12969     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12970     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12971     MOVE X'3120233030303131393737' TO DFHEIV0(25:11)
 12972     CALL 'kxdfhei1' USING DFHEIV0
 12973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12974
 12975
 12976
 12977* EXEC CICS READ
 12978*        SET     (ADDRESS OF PENDING-BUSINESS)
 12979*        DATASET (FILE-ID-ERPNDB)
 12980*        RIDFLD  (ERPNDB-KEY)
 12981*        UPDATE
 12982*    END-EXEC.
 12983*    MOVE '&"S        EU         (   #00011981' TO DFHEIV0
 12984     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12985     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12986     MOVE X'2020233030303131393831' TO DFHEIV0(25:11)
 12987     CALL 'kxdfhei1' USING DFHEIV0,
 12988           FILE-ID-ERPNDB,
 12989           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 237
* EL6311.cbl
 12990           DFHEIV99,
 12991           ERPNDB-KEY,
 12992           DFHEIV99,
 12993           DFHEIV99,
 12994           DFHEIV99
 12995     SET ADDRESS OF PENDING-BUSINESS TO
 12996         DFHEIV20
 12997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12998
 12999
 13000     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13001
 13002     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13003
 13004     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13005        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13006        MOVE 'D'                   TO JP-RECORD-TYPE
 13007        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13008
 13009* EXEC CICS DELETE
 13010*            DATASET    (FILE-ID-ERPNDB)
 13011*       END-EXEC
 13012*    MOVE '&(                    &   #00011996' TO DFHEIV0
 13013     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13014     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13015     MOVE X'2020233030303131393936' TO DFHEIV0(25:11)
 13016     CALL 'kxdfhei1' USING DFHEIV0,
 13017           FILE-ID-ERPNDB,
 13018           DFHEIV99,
 13019           DFHEIV99,
 13020           DFHEIV99,
 13021           DFHEIV99
 13022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13023        PERFORM 8400-LOG-JOURNAL-RECORD
 13024     ELSE
 13025        MOVE 'B'                 TO JP-RECORD-TYPE
 13026        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13027        PERFORM 8400-LOG-JOURNAL-RECORD
 13028        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13029        MOVE 'C'                 TO JP-RECORD-TYPE
 13030        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13031
 13032* EXEC CICS REWRITE
 13033*            DATASET    (FILE-ID-ERPNDB)
 13034*            FROM       (PENDING-BUSINESS)
 13035*       END-EXEC
 13036     MOVE LENGTH OF
 13037      PENDING-BUSINESS
 13038       TO DFHEIV11
 13039*    MOVE '&& L                  %   #00012007' TO DFHEIV0
 13040     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13041     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13042     MOVE X'2020233030303132303037' TO DFHEIV0(25:11)
 13043     CALL 'kxdfhei1' USING DFHEIV0,
 13044           FILE-ID-ERPNDB,
 13045           PENDING-BUSINESS,
 13046           DFHEIV11,
 13047           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 238
* EL6311.cbl
 13048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13049        PERFORM 8400-LOG-JOURNAL-RECORD.
 13050
 13051******************************************************************
 13052*                                                                *
 13053*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13054*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13055*                                                                *
 13056******************************************************************
 13057
 13058     IF NOT PI-AR-PROCESSING
 13059        GO TO 1475-DELETE-FINISHED.
 13060
 13061     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13062        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13063        NEXT SENTENCE
 13064     ELSE
 13065        GO TO 1475-DELETE-FINISHED.
 13066
 13067
 13068* EXEC CICS HANDLE CONDITION
 13069*         NOTFND    (1475-DELETE-FINISHED)
 13070*         END-EXEC.
 13071*    MOVE '"$I                   ! 2 #00012029' TO DFHEIV0
 13072     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13074     MOVE X'3220233030303132303239' TO DFHEIV0(25:11)
 13075     CALL 'kxdfhei1' USING DFHEIV0
 13076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13077
 13078
 13079     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13080     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13081
 13082
 13083* EXEC CICS READ
 13084*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13085*        DATASET (FILE-ID-ERRQST)
 13086*        RIDFLD  (ERRQST-KEY)
 13087*        UPDATE
 13088*    END-EXEC.
 13089*    MOVE '&"S        EU         (   #00012036' TO DFHEIV0
 13090     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13091     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13092     MOVE X'2020233030303132303336' TO DFHEIV0(25:11)
 13093     CALL 'kxdfhei1' USING DFHEIV0,
 13094           FILE-ID-ERRQST,
 13095           DFHEIV20,
 13096           DFHEIV99,
 13097           ERRQST-KEY,
 13098           DFHEIV99,
 13099           DFHEIV99,
 13100           DFHEIV99
 13101     SET ADDRESS OF AR-REQUEST-RECORD TO
 13102         DFHEIV20
 13103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13104
 13105
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 239
* EL6311.cbl
 13106     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13107
 13108     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13109
 13110     MOVE 'D'                      TO JP-RECORD-TYPE.
 13111     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13112
 13113
 13114* EXEC CICS DELETE
 13115*         DATASET    (FILE-ID-ERRQST)
 13116*    END-EXEC.
 13117*    MOVE '&(                    &   #00012050' TO DFHEIV0
 13118     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13119     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13120     MOVE X'2020233030303132303530' TO DFHEIV0(25:11)
 13121     CALL 'kxdfhei1' USING DFHEIV0,
 13122           FILE-ID-ERRQST,
 13123           DFHEIV99,
 13124           DFHEIV99,
 13125           DFHEIV99,
 13126           DFHEIV99
 13127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13128
 13129
 13130     PERFORM 8400-LOG-JOURNAL-RECORD.
 13131
 13132 1475-DELETE-FINISHED.
 13133     MOVE ZEROS                  TO EMI-ERROR.
 13134     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13135     MOVE LOW-VALUES             TO EL631BI.
 13136     MOVE -1                     TO BMAINTL.
 13137     GO TO 8100-SEND-INITIAL-MAP.
 13138
 13139 1480-BATCH-HDR-NOT-FOUND.
 13140     MOVE -1                     TO BMAINTL.
 13141     MOVE ER-7450                TO EMI-ERROR.
 13142     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13143     GO TO 8200-SEND-DATAONLY.
 13144
 13145 1490-RECORD-NOT-FOUND.
 13146     MOVE -1                     TO BMAINTL.
 13147     MOVE ER-7451                TO EMI-ERROR.
 13148     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13149     GO TO 8200-SEND-DATAONLY.
 13150
 13151******************************************************************
 13152*            O V E R   C H A R G E   P R O C E S S I N G         *
 13153******************************************************************
 13154 1500-UPDATE-ERNOTE.
 13155     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13156     MOVE 'A'                    TO WS-NOTE-SW
 13157     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13158     .
 13159 1500-EXIT.
 13160     EXIT.
 13161 1510-ADD-ERNOTE-REC.
 13162
 13163* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 240
* EL6311.cbl
 13164*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13165*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13166*        INITIMG (GETMAIN-SPACE)
 13167*    END-EXEC
 13168*    MOVE ',"IL                  $   #00012086' TO DFHEIV0
 13169     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13170     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13171     MOVE X'2020233030303132303836' TO DFHEIV0(25:11)
 13172     CALL 'kxdfhei1' USING DFHEIV0,
 13173           DFHEIV20,
 13174           ERNOTE-RECORD-LENGTH,
 13175           GETMAIN-SPACE
 13176     SET ADDRESS OF CERTIFICATE-NOTE TO
 13177         DFHEIV20
 13178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13179     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13180                                 TO ERNOTE-KEY
 13181
 13182* EXEC CICS READ
 13183*       DATASET    (FILE-ID-ERNOTE)
 13184*       RIDFLD     (ERNOTE-KEY)
 13185*       INTO       (CERTIFICATE-NOTE)
 13186*       RESP       (WS-RESPONSE)
 13187*       UPDATE
 13188*    END-EXEC
 13189     MOVE LENGTH OF
 13190      CERTIFICATE-NOTE
 13191       TO DFHEIV11
 13192*    MOVE '&"IL       EU         (  N#00012093' TO DFHEIV0
 13193     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13194     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13195     MOVE X'204E233030303132303933' TO DFHEIV0(25:11)
 13196     CALL 'kxdfhei1' USING DFHEIV0,
 13197           FILE-ID-ERNOTE,
 13198           CERTIFICATE-NOTE,
 13199           DFHEIV11,
 13200           ERNOTE-KEY,
 13201           DFHEIV99,
 13202           DFHEIV99,
 13203           DFHEIV99
 13204     MOVE EIBRESP  TO WS-RESPONSE
 13205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13206     IF RESP-NORMAL
 13207        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13208           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13209        END-IF
 13210        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13211           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13212        END-IF
 13213        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13214           (N1 > +10)
 13215           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13216           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13217        END-PERFORM
 13218        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13219          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13220
 13221* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 241
* EL6311.cbl
 13222*            DATASET    (FILE-ID-ERNOTE)
 13223*          END-EXEC
 13224*    MOVE '&*                    #   #00012114' TO DFHEIV0
 13225     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13226     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13227     MOVE X'2020233030303132313134' TO DFHEIV0(25:11)
 13228     CALL 'kxdfhei1' USING DFHEIV0,
 13229           FILE-ID-ERNOTE,
 13230           DFHEIV99
 13231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13232        ELSE
 13233          PERFORM VARYING N1 FROM +1 BY +1
 13234           UNTIL (N1 > +10)
 13235           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13236          END-PERFORM
 13237          IF (N1 < +11)
 13238            IF N1 >= CN-BILLING-START-LINE-NO AND
 13239              N1 <= CN-BILLING-END-LINE-NO
 13240              IF PI-COMPANY-ID = 'DCC'
 13241                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13242              ELSE
 13243                 MOVE WS-VA-NO-COMM-MESS
 13244                                    TO CN-LINE (N1)
 13245              END-IF
 13246            ELSE
 13247              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13248               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13249                IF PI-COMPANY-ID = 'DCC'
 13250                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13251                ELSE
 13252                  MOVE WS-VA-NO-COMM-MESS
 13253                                    TO CN-LINE (N1)
 13254                END-IF
 13255                MOVE N1             TO CN-BILLING-END-LINE-NO
 13256              ELSE
 13257                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13258                  IF PI-COMPANY-ID = 'DCC'
 13259                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13260                  ELSE
 13261                     MOVE WS-VA-NO-COMM-MESS
 13262                                    TO CN-LINE (N1)
 13263                  END-IF
 13264                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13265                                      CN-BILLING-START-LINE-NO
 13266                ELSE
 13267                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13268                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13269                     IF PI-COMPANY-ID = 'DCC'
 13270                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13271                     ELSE
 13272                       MOVE WS-VA-NO-COMM-MESS
 13273                                    TO CN-LINE (N1)
 13274                     END-IF
 13275                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13276                  ELSE
 13277                     PERFORM 1700-SQUEEZE-IT-IN
 13278                                 THRU 1700-EXIT
 13279                  END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 242
* EL6311.cbl
 13280                END-IF
 13281              END-IF
 13282            END-IF
 13283            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13284            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13285            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13286
 13287* EXEC CICS REWRITE
 13288*              DATASET    (FILE-ID-ERNOTE)
 13289*              FROM       (CERTIFICATE-NOTE)
 13290*              RESP       (WS-RESPONSE)
 13291*           END-EXEC
 13292     MOVE LENGTH OF
 13293      CERTIFICATE-NOTE
 13294       TO DFHEIV11
 13295*    MOVE '&& L                  %  N#00012171' TO DFHEIV0
 13296     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13297     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13298     MOVE X'204E233030303132313731' TO DFHEIV0(25:11)
 13299     CALL 'kxdfhei1' USING DFHEIV0,
 13300           FILE-ID-ERNOTE,
 13301           CERTIFICATE-NOTE,
 13302           DFHEIV11,
 13303           DFHEIV99
 13304     MOVE EIBRESP  TO WS-RESPONSE
 13305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13306          END-IF
 13307        END-IF
 13308     ELSE
 13309        MOVE SPACES              TO CERTIFICATE-NOTE
 13310        MOVE 'CN'                TO CN-RECORD-ID
 13311        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13312                                 TO CN-CONTROL-PRIMARY
 13313                                    ERNOTE-KEY
 13314        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13315                                    CN-BILLING-END-LINE-NO
 13316        IF PI-COMPANY-ID = 'DCC'
 13317           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13318        ELSE
 13319           MOVE WS-VA-NO-COMM-MESS
 13320                                 TO CN-LINE (1)
 13321        END-IF
 13322        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13323        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13324        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13325
 13326* EXEC CICS WRITE
 13327*          DATASET    (FILE-ID-ERNOTE)
 13328*          FROM       (CERTIFICATE-NOTE)
 13329*          RIDFLD     (ERNOTE-KEY)
 13330*          RESP       (WS-RESPONSE)
 13331*       END-EXEC
 13332     MOVE LENGTH OF
 13333      CERTIFICATE-NOTE
 13334       TO DFHEIV11
 13335*    MOVE '&$ L                  ''  N#00012195' TO DFHEIV0
 13336     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13337     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 243
* EL6311.cbl
 13338     MOVE X'204E233030303132313935' TO DFHEIV0(25:11)
 13339     CALL 'kxdfhei1' USING DFHEIV0,
 13340           FILE-ID-ERNOTE,
 13341           CERTIFICATE-NOTE,
 13342           DFHEIV11,
 13343           ERNOTE-KEY,
 13344           DFHEIV99,
 13345           DFHEIV99
 13346     MOVE EIBRESP  TO WS-RESPONSE
 13347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13348     END-IF
 13349     .
 13350 1510-EXIT.
 13351     EXIT.
 13352 1520-UPDATE-ELCERT.
 13353     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13354                                 TO ELCERT-KEY
 13355
 13356* EXEC CICS READ
 13357*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13358*        DATASET (FILE-ID-ELCERT)
 13359*        RIDFLD  (ELCERT-KEY)
 13360*        UPDATE
 13361*        RESP    (WS-RESPONSE)
 13362*    END-EXEC
 13363*    MOVE '&"S        EU         (  N#00012208' TO DFHEIV0
 13364     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13365     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13366     MOVE X'204E233030303132323038' TO DFHEIV0(25:11)
 13367     CALL 'kxdfhei1' USING DFHEIV0,
 13368           FILE-ID-ELCERT,
 13369           DFHEIV20,
 13370           DFHEIV99,
 13371           ELCERT-KEY,
 13372           DFHEIV99,
 13373           DFHEIV99,
 13374           DFHEIV99
 13375     SET ADDRESS OF CERTIFICATE-MASTER TO
 13376         DFHEIV20
 13377     MOVE EIBRESP  TO WS-RESPONSE
 13378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13379     IF RESP-NORMAL
 13380        IF WS-NOTE-SW = 'A'
 13381           IF CM-NOTE-SW = ' '
 13382              MOVE '2'             TO CM-NOTE-SW
 13383           ELSE
 13384             IF CM-NOTE-SW = '1'
 13385                MOVE '3'           TO CM-NOTE-SW
 13386             ELSE
 13387               IF CM-NOTE-SW = '4'
 13388                  MOVE '6'         TO CM-NOTE-SW
 13389               ELSE
 13390                 IF CM-NOTE-SW = '5'
 13391                    MOVE '7'       TO CM-NOTE-SW
 13392                 END-IF
 13393               END-IF
 13394             END-IF
 13395           END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 244
* EL6311.cbl
 13396        ELSE
 13397           IF CM-NOTE-SW = '2'
 13398              MOVE ' '             TO CM-NOTE-SW
 13399           ELSE
 13400             IF CM-NOTE-SW = '3'
 13401                MOVE '1'           TO CM-NOTE-SW
 13402             ELSE
 13403               IF CM-NOTE-SW = '6'
 13404                  MOVE '4'         TO CM-NOTE-SW
 13405               ELSE
 13406                 IF CM-NOTE-SW = '7'
 13407                    MOVE '5'       TO CM-NOTE-SW
 13408                 END-IF
 13409               END-IF
 13410             END-IF
 13411           END-IF
 13412        END-IF
 13413
 13414* EXEC CICS REWRITE
 13415*          DATASET    (FILE-ID-ELCERT)
 13416*          FROM       (CERTIFICATE-MASTER)
 13417*          RESP       (WS-RESPONSE)
 13418*       END-EXEC
 13419     MOVE LENGTH OF
 13420      CERTIFICATE-MASTER
 13421       TO DFHEIV11
 13422*    MOVE '&& L                  %  N#00012249' TO DFHEIV0
 13423     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13424     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13425     MOVE X'204E233030303132323439' TO DFHEIV0(25:11)
 13426     CALL 'kxdfhei1' USING DFHEIV0,
 13427           FILE-ID-ELCERT,
 13428           CERTIFICATE-MASTER,
 13429           DFHEIV11,
 13430           DFHEIV99
 13431     MOVE EIBRESP  TO WS-RESPONSE
 13432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13433        IF RESP-NORMAL
 13434           CONTINUE
 13435        ELSE
 13436           MOVE WS-RESPONSE TO EMI-ERROR
 13437           PERFORM 9900-ERROR-FORMAT
 13438                                 THRU 9900-EXIT
 13439           GO TO 8200-SEND-DATAONLY
 13440        END-IF
 13441     ELSE
 13442        MOVE -1                  TO BMAINTL
 13443        MOVE 0249                TO EMI-ERROR
 13444        PERFORM 9900-ERROR-FORMAT
 13445                                 THRU 9900-EXIT
 13446        GO TO 8200-SEND-DATAONLY
 13447     END-IF
 13448     .
 13449 1520-EXIT.
 13450     EXIT.
 13451 1600-UPDATE-ERPYAJ.
 13452     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13453                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 245
* EL6311.cbl
 13454     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13455                                 THRU 1620-EXIT
 13456     .
 13457 1600-EXIT.
 13458     EXIT.
 13459 1610-ADD-ERPYAJ-BANK-REC.
 13460
 13461* EXEC CICS GETMAIN
 13462*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13463*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13464*        INITIMG (GETMAIN-SPACE)
 13465*    END-EXEC
 13466*    MOVE ',"IL                  $   #00012281' TO DFHEIV0
 13467     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13468     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13469     MOVE X'2020233030303132323831' TO DFHEIV0(25:11)
 13470     CALL 'kxdfhei1' USING DFHEIV0,
 13471           DFHEIV20,
 13472           ERPYAJ-RECORD-LENGTH,
 13473           GETMAIN-SPACE
 13474     SET ADDRESS OF PENDING-PAY-ADJ TO
 13475         DFHEIV20
 13476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13477     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13478     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13479     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13480     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13481     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13482     MOVE +10                    TO ERPYAJ-SEQ-NO
 13483     MOVE 'R'                    TO ERPYAJ-TYPE
 13484     IF REVERSAL
 13485        MOVE 'C'                 TO ERPYAJ-TYPE
 13486     END-IF
 13487     MOVE SPACES                 TO PENDING-PAY-ADJ
 13488     MOVE 'PY'                   TO PY-RECORD-ID
 13489     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13490     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13491     IF REVERSAL
 13492        MOVE PB-I-DCC-OVER-CHG-AMT
 13493                                 TO PY-ENTRY-AMT
 13494     END-IF
 13495     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13496                                    PY-INPUT-DT
 13497*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13498*                                   PY-INPUT-DT
 13499     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13500     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13501     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13502     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13503     IF PB-CARRIER = '2'
 13504        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13505     ELSE
 13506        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13507     END-IF
 13508     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13509                                    PY-BILLED-DATE
 13510                                    PY-AR-DATE
 13511                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 246
* EL6311.cbl
 13512                                    PY-CHECK-WRITTEN-DT
 13513     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13514                                    PY-CHECK-QUE-SEQUENCE
 13515     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13516     PERFORM WITH TEST AFTER
 13517        UNTIL (NOT RESP-DUPKEY)
 13518           AND (NOT RESP-DUPREC)
 13519
 13520* EXEC CICS WRITE
 13521*          DATASET    (FILE-ID-ERPYAJ)
 13522*          FROM       (PENDING-PAY-ADJ)
 13523*          RIDFLD     (ERPYAJ-KEY)
 13524*          RESP       (WS-RESPONSE)
 13525*       END-EXEC
 13526     MOVE LENGTH OF
 13527      PENDING-PAY-ADJ
 13528       TO DFHEIV11
 13529*    MOVE '&$ L                  ''  N#00012328' TO DFHEIV0
 13530     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13531     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13532     MOVE X'204E233030303132333238' TO DFHEIV0(25:11)
 13533     CALL 'kxdfhei1' USING DFHEIV0,
 13534           FILE-ID-ERPYAJ,
 13535           PENDING-PAY-ADJ,
 13536           DFHEIV11,
 13537           ERPYAJ-KEY,
 13538           DFHEIV99,
 13539           DFHEIV99
 13540     MOVE EIBRESP  TO WS-RESPONSE
 13541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13542        IF RESP-DUPKEY OR RESP-DUPREC
 13543           ADD +1                TO ERPYAJ-SEQ-NO
 13544           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13545        END-IF
 13546     END-PERFORM
 13547     .
 13548 1610-EXIT.
 13549     EXIT.
 13550 1620-ADD-ERPYAJ-DLR-REC.
 13551     MOVE 'C'                    TO ERPYAJ-TYPE
 13552     IF REVERSAL
 13553        MOVE 'R'                 TO ERPYAJ-TYPE
 13554     END-IF
 13555     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13556                                    ERPYAJ-ACCOUNT
 13557     ADD +1                      TO ERPYAJ-SEQ-NO
 13558     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13559     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13560     IF PB-CARRIER = '2'
 13561        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13562     ELSE
 13563        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13564     END-IF
 13565     PERFORM WITH TEST AFTER
 13566        UNTIL (NOT RESP-DUPKEY)
 13567           AND (NOT RESP-DUPREC)
 13568
 13569* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 247
* EL6311.cbl
 13570*          DATASET    (FILE-ID-ERPYAJ)
 13571*          FROM       (PENDING-PAY-ADJ)
 13572*          RIDFLD     (ERPYAJ-KEY)
 13573*          RESP       (WS-RESPONSE)
 13574*       END-EXEC
 13575     MOVE LENGTH OF
 13576      PENDING-PAY-ADJ
 13577       TO DFHEIV11
 13578*    MOVE '&$ L                  ''  N#00012360' TO DFHEIV0
 13579     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13580     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13581     MOVE X'204E233030303132333630' TO DFHEIV0(25:11)
 13582     CALL 'kxdfhei1' USING DFHEIV0,
 13583           FILE-ID-ERPYAJ,
 13584           PENDING-PAY-ADJ,
 13585           DFHEIV11,
 13586           ERPYAJ-KEY,
 13587           DFHEIV99,
 13588           DFHEIV99
 13589     MOVE EIBRESP  TO WS-RESPONSE
 13590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13591        IF RESP-DUPKEY OR RESP-DUPREC
 13592           ADD +1                TO ERPYAJ-SEQ-NO
 13593           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13594        END-IF
 13595     END-PERFORM
 13596     .
 13597 1620-EXIT.
 13598     EXIT.
 13599 1700-SQUEEZE-IT-IN.
 13600     IF (N1 > CN-BILLING-END-LINE-NO)
 13601        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13602           N1 = +1
 13603           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13604           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13605              IF PI-COMPANY-ID = 'DCC'
 13606                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13607              ELSE
 13608                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13609              END-IF
 13610              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13611              MOVE +2 TO N1
 13612           END-IF
 13613        END-PERFORM
 13614     ELSE
 13615        IF (N1 < CN-BILLING-START-LINE-NO)
 13616           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13617              N1 = +10
 13618              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13619              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13620                 IF PI-COMPANY-ID = 'DCC'
 13621                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13622                 ELSE
 13623                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13624                 END-IF
 13625                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13626                 MOVE +9 TO N1
 13627              END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 248
* EL6311.cbl
 13628           END-PERFORM
 13629        END-IF
 13630     END-IF
 13631     .
 13632 1700-EXIT.
 13633     EXIT.
 13634 1800-REMOVE-CERT-NOTES.
 13635     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13636                                 TO ERNOTE-KEY
 13637
 13638* EXEC CICS READ
 13639*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13640*       DATASET    (FILE-ID-ERNOTE)
 13641*       RIDFLD     (ERNOTE-KEY)
 13642*       RESP       (WS-RESPONSE)
 13643*       UPDATE
 13644*    END-EXEC
 13645*    MOVE '&"S        EU         (  N#00012412' TO DFHEIV0
 13646     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13647     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13648     MOVE X'204E233030303132343132' TO DFHEIV0(25:11)
 13649     CALL 'kxdfhei1' USING DFHEIV0,
 13650           FILE-ID-ERNOTE,
 13651           DFHEIV20,
 13652           DFHEIV99,
 13653           ERNOTE-KEY,
 13654           DFHEIV99,
 13655           DFHEIV99,
 13656           DFHEIV99
 13657     SET ADDRESS OF CERTIFICATE-NOTE TO
 13658         DFHEIV20
 13659     MOVE EIBRESP  TO WS-RESPONSE
 13660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13661     IF RESP-NORMAL
 13662        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13663           (N1 > +10)
 13664           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13665           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13666        END-PERFORM
 13667        IF N1 < +11
 13668           MOVE SPACES              TO CN-LINE (N1)
 13669           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13670              N1 <= CN-BILLING-END-LINE-NO
 13671              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13672              IF CN-BILLING-END-LINE-NO <
 13673                               CN-BILLING-START-LINE-NO
 13674                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13675                                     CN-BILLING-START-LINE-NO
 13676              END-IF
 13677              PERFORM 1820-SQUEEZE-ERNOTE
 13678                                  THRU 1820-EXIT
 13679           END-IF
 13680           IF CN-LINES = SPACES
 13681
 13682* EXEC CICS DELETE
 13683*                DATASET    (FILE-ID-ERNOTE)
 13684*                RESP       (WS-RESPONSE)
 13685*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 249
* EL6311.cbl
 13686*    MOVE '&(                    &  N#00012439' TO DFHEIV0
 13687     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13688     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13689     MOVE X'204E233030303132343339' TO DFHEIV0(25:11)
 13690     CALL 'kxdfhei1' USING DFHEIV0,
 13691           FILE-ID-ERNOTE,
 13692           DFHEIV99,
 13693           DFHEIV99,
 13694           DFHEIV99,
 13695           DFHEIV99
 13696     MOVE EIBRESP  TO WS-RESPONSE
 13697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13698              IF RESP-NORMAL
 13699                 MOVE 'D'        TO WS-NOTE-SW
 13700                 PERFORM 1520-UPDATE-ELCERT
 13701                                 THRU 1520-EXIT
 13702              END-IF
 13703           ELSE
 13704
 13705* EXEC CICS REWRITE
 13706*                DATASET    (FILE-ID-ERNOTE)
 13707*                FROM       (CERTIFICATE-NOTE)
 13708*                RESP       (WS-RESPONSE)
 13709*             END-EXEC
 13710     MOVE LENGTH OF
 13711      CERTIFICATE-NOTE
 13712       TO DFHEIV11
 13713*    MOVE '&& L                  %  N#00012449' TO DFHEIV0
 13714     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13715     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13716     MOVE X'204E233030303132343439' TO DFHEIV0(25:11)
 13717     CALL 'kxdfhei1' USING DFHEIV0,
 13718           FILE-ID-ERNOTE,
 13719           CERTIFICATE-NOTE,
 13720           DFHEIV11,
 13721           DFHEIV99
 13722     MOVE EIBRESP  TO WS-RESPONSE
 13723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13724           END-IF
 13725        END-IF
 13726     END-IF
 13727     .
 13728 1800-EXIT.
 13729     EXIT.
 13730 1820-SQUEEZE-ERNOTE.
 13731     MOVE CN-BILLING-START-LINE-NO TO N2
 13732     IF N2 = 0
 13733         MOVE +1                 TO N2
 13734     END-IF
 13735     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13736        (N1 > +9)
 13737        IF CN-LINE (N1) = SPACES
 13738           MOVE CN-LINE (N1 + +1)
 13739                                 TO CN-LINE (N1)
 13740           MOVE SPACES           TO CN-LINE (N1 + +1)
 13741        END-IF
 13742     END-PERFORM
 13743     .
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 250
* EL6311.cbl
 13744 1820-EXIT.
 13745     EXIT.
 13746 1900-DELETE-ERPYAJ.
 13747     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13748     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13749     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13750     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13751     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13752     MOVE +10                    TO ERPYAJ-SEQ-NO
 13753     MOVE 'R'                    TO ERPYAJ-TYPE
 13754     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13755
 13756* EXEC CICS STARTBR
 13757*       DATASET    (FILE-ID-ERPYAJ)
 13758*       RIDFLD     (ERPYAJ-KEY)
 13759*       RESP       (WS-RESPONSE)
 13760*    END-EXEC
 13761     MOVE 0
 13762       TO DFHEIV11
 13763*    MOVE '&,         G          &  N#00012485' TO DFHEIV0
 13764     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13765     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13766     MOVE X'204E233030303132343835' TO DFHEIV0(25:11)
 13767     CALL 'kxdfhei1' USING DFHEIV0,
 13768           FILE-ID-ERPYAJ,
 13769           ERPYAJ-KEY,
 13770           DFHEIV99,
 13771           DFHEIV11,
 13772           DFHEIV99
 13773     MOVE EIBRESP  TO WS-RESPONSE
 13774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13775     IF RESP-NORMAL
 13776        CONTINUE
 13777     ELSE
 13778        GO TO 1900-GET-DEALER
 13779     END-IF
 13780     .
 13781 1900-READNEXT-ERPYAJ-B.
 13782*  GET THE BANK ERPYAJ RECORD
 13783
 13784* EXEC CICS READNEXT
 13785*       DATASET    (FILE-ID-ERPYAJ)
 13786*       RIDFLD     (ERPYAJ-KEY)
 13787*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13788*       RESP       (WS-RESPONSE)
 13789*    END-EXEC
 13790     MOVE 0
 13791       TO DFHEIV11
 13792*    MOVE '&.S                   )  N#00012498' TO DFHEIV0
 13793     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13794     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13795     MOVE X'204E233030303132343938' TO DFHEIV0(25:11)
 13796     CALL 'kxdfhei1' USING DFHEIV0,
 13797           FILE-ID-ERPYAJ,
 13798           DFHEIV20,
 13799           DFHEIV99,
 13800           ERPYAJ-KEY,
 13801           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 251
* EL6311.cbl
 13802           DFHEIV11,
 13803           DFHEIV99,
 13804           DFHEIV99
 13805     SET ADDRESS OF PENDING-PAY-ADJ TO
 13806         DFHEIV20
 13807     MOVE EIBRESP  TO WS-RESPONSE
 13808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13809     IF RESP-NORMAL
 13810        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13811           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13812              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13813                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13814
 13815* EXEC CICS READ
 13816*                   DATASET    (FILE-ID-ERPYAJ)
 13817*                   RIDFLD     (ERPYAJ-KEY)
 13818*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13819*                   RESP       (WS-RESPONSE)
 13820*                   UPDATE
 13821*                END-EXEC
 13822*    MOVE '&"S        EU         (  N#00012509' TO DFHEIV0
 13823     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13824     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13825     MOVE X'204E233030303132353039' TO DFHEIV0(25:11)
 13826     CALL 'kxdfhei1' USING DFHEIV0,
 13827           FILE-ID-ERPYAJ,
 13828           DFHEIV20,
 13829           DFHEIV99,
 13830           ERPYAJ-KEY,
 13831           DFHEIV99,
 13832           DFHEIV99,
 13833           DFHEIV99
 13834     SET ADDRESS OF PENDING-PAY-ADJ TO
 13835         DFHEIV20
 13836     MOVE EIBRESP  TO WS-RESPONSE
 13837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13838                 IF RESP-NORMAL
 13839
 13840* EXEC CICS DELETE
 13841*                      DATASET   (FILE-ID-ERPYAJ)
 13842*                      RESP      (WS-RESPONSE)
 13843*                   END-EXEC
 13844*    MOVE '&(                    &  N#00012517' TO DFHEIV0
 13845     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13846     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13847     MOVE X'204E233030303132353137' TO DFHEIV0(25:11)
 13848     CALL 'kxdfhei1' USING DFHEIV0,
 13849           FILE-ID-ERPYAJ,
 13850           DFHEIV99,
 13851           DFHEIV99,
 13852           DFHEIV99,
 13853           DFHEIV99
 13854     MOVE EIBRESP  TO WS-RESPONSE
 13855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13856                 END-IF
 13857              ELSE
 13858                 SET REVERSAL    TO TRUE
 13859                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 252
* EL6311.cbl
 13860                                 THRU 1600-EXIT
 13861                 GO TO 1900-EXIT
 13862              END-IF
 13863           ELSE
 13864              GO TO 1900-READNEXT-ERPYAJ-B
 13865           END-IF
 13866        END-IF
 13867
 13868* EXEC CICS ENDBR
 13869*          DATASET   (FILE-ID-ERPYAJ)
 13870*       END-EXEC
 13871     MOVE 0
 13872       TO DFHEIV11
 13873*    MOVE '&2                    $   #00012532' TO DFHEIV0
 13874     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13875     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13876     MOVE X'2020233030303132353332' TO DFHEIV0(25:11)
 13877     CALL 'kxdfhei1' USING DFHEIV0,
 13878           FILE-ID-ERPYAJ,
 13879           DFHEIV11,
 13880           DFHEIV99
 13881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13882     END-IF
 13883     .
 13884 1900-GET-DEALER.
 13885     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13886     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13887     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13888     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13889     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13890     MOVE +10                    TO ERPYAJ-SEQ-NO
 13891     MOVE 'C'                    TO ERPYAJ-TYPE
 13892     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13893
 13894* EXEC CICS STARTBR
 13895*       DATASET    (FILE-ID-ERPYAJ)
 13896*       RIDFLD     (ERPYAJ-KEY)
 13897*       RESP       (WS-RESPONSE)
 13898*    END-EXEC
 13899     MOVE 0
 13900       TO DFHEIV11
 13901*    MOVE '&,         G          &  N#00012546' TO DFHEIV0
 13902     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13903     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13904     MOVE X'204E233030303132353436' TO DFHEIV0(25:11)
 13905     CALL 'kxdfhei1' USING DFHEIV0,
 13906           FILE-ID-ERPYAJ,
 13907           ERPYAJ-KEY,
 13908           DFHEIV99,
 13909           DFHEIV11,
 13910           DFHEIV99
 13911     MOVE EIBRESP  TO WS-RESPONSE
 13912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13913     IF RESP-NORMAL
 13914        CONTINUE
 13915     ELSE
 13916        GO TO 1900-EXIT
 13917     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 253
* EL6311.cbl
 13918     .
 13919 1900-READNEXT-ERPYAJ-D.
 13920*  GET THE DEALER ERPYAJ RECORD
 13921
 13922* EXEC CICS READNEXT
 13923*       DATASET    (FILE-ID-ERPYAJ)
 13924*       RIDFLD     (ERPYAJ-KEY)
 13925*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13926*       RESP       (WS-RESPONSE)
 13927*    END-EXEC
 13928     MOVE 0
 13929       TO DFHEIV11
 13930*    MOVE '&.S                   )  N#00012559' TO DFHEIV0
 13931     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13932     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13933     MOVE X'204E233030303132353539' TO DFHEIV0(25:11)
 13934     CALL 'kxdfhei1' USING DFHEIV0,
 13935           FILE-ID-ERPYAJ,
 13936           DFHEIV20,
 13937           DFHEIV99,
 13938           ERPYAJ-KEY,
 13939           DFHEIV99,
 13940           DFHEIV11,
 13941           DFHEIV99,
 13942           DFHEIV99
 13943     SET ADDRESS OF PENDING-PAY-ADJ TO
 13944         DFHEIV20
 13945     MOVE EIBRESP  TO WS-RESPONSE
 13946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13947     IF RESP-NORMAL
 13948        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13949           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13950              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13951                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13952
 13953* EXEC CICS READ
 13954*                   DATASET    (FILE-ID-ERPYAJ)
 13955*                   RIDFLD     (ERPYAJ-KEY)
 13956*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13957*                   RESP       (WS-RESPONSE)
 13958*                   UPDATE
 13959*                END-EXEC
 13960*    MOVE '&"S        EU         (  N#00012570' TO DFHEIV0
 13961     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13962     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13963     MOVE X'204E233030303132353730' TO DFHEIV0(25:11)
 13964     CALL 'kxdfhei1' USING DFHEIV0,
 13965           FILE-ID-ERPYAJ,
 13966           DFHEIV20,
 13967           DFHEIV99,
 13968           ERPYAJ-KEY,
 13969           DFHEIV99,
 13970           DFHEIV99,
 13971           DFHEIV99
 13972     SET ADDRESS OF PENDING-PAY-ADJ TO
 13973         DFHEIV20
 13974     MOVE EIBRESP  TO WS-RESPONSE
 13975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 254
* EL6311.cbl
 13976                 IF RESP-NORMAL
 13977
 13978* EXEC CICS DELETE
 13979*                      DATASET   (FILE-ID-ERPYAJ)
 13980*                      RESP      (WS-RESPONSE)
 13981*                   END-EXEC
 13982*    MOVE '&(                    &  N#00012578' TO DFHEIV0
 13983     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13984     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13985     MOVE X'204E233030303132353738' TO DFHEIV0(25:11)
 13986     CALL 'kxdfhei1' USING DFHEIV0,
 13987           FILE-ID-ERPYAJ,
 13988           DFHEIV99,
 13989           DFHEIV99,
 13990           DFHEIV99,
 13991           DFHEIV99
 13992     MOVE EIBRESP  TO WS-RESPONSE
 13993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13994                 END-IF
 13995              ELSE
 13996                 SET REVERSAL    TO TRUE
 13997              END-IF
 13998           ELSE
 13999              GO TO 1900-READNEXT-ERPYAJ-D
 14000           END-IF
 14001        END-IF
 14002
 14003* EXEC CICS ENDBR
 14004*          DATASET   (FILE-ID-ERPYAJ)
 14005*       END-EXEC
 14006     MOVE 0
 14007       TO DFHEIV11
 14008*    MOVE '&2                    $   #00012590' TO DFHEIV0
 14009     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14010     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14011     MOVE X'2020233030303132353930' TO DFHEIV0(25:11)
 14012     CALL 'kxdfhei1' USING DFHEIV0,
 14013           FILE-ID-ERPYAJ,
 14014           DFHEIV11,
 14015           DFHEIV99
 14016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14017     END-IF
 14018     .
 14019 1900-EXIT.
 14020     EXIT.
 14021******************************************************************
 14022*            C A N C E L   M A I N L I N E                       *
 14023******************************************************************
 14024
 14025 2000-CANCEL-MAINLINE.
 14026     IF PI-DISPLAY-ORIGINAL-BATCH
 14027        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14028           MOVE ER-0023             TO EMI-ERROR
 14029           MOVE -1                  TO CMAINTL
 14030           MOVE AL-UABON            TO CMAINTA
 14031           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14032           GO TO 8200-SEND-DATAONLY
 14033        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 255
* EL6311.cbl
 14034           NEXT SENTENCE
 14035     ELSE
 14036        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14037           MOVE ER-0023             TO EMI-ERROR
 14038           MOVE -1                  TO CMAINTL
 14039           MOVE AL-UABON            TO CMAINTA
 14040           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14041           GO TO 8200-SEND-DATAONLY.
 14042
 14043     IF CMAINTI = 'S'
 14044        GO TO 2100-SHOW-REQUEST.
 14045
 14046     IF NOT MODIFY-CAP
 14047         MOVE 'UPDATE'       TO SM-READ
 14048         PERFORM 9995-SECURITY-VIOLATION
 14049         MOVE ER-0070        TO EMI-ERROR
 14050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14051         GO TO 8100-SEND-INITIAL-MAP.
 14052
 14053     IF CMAINTL GREATER THAN ZEROS
 14054        IF PI-PF6-FUNCTION
 14055           IF CMAINTI NOT = 'A'
 14056              MOVE AL-UABON  TO CMAINTA
 14057              MOVE -1        TO CMAINTL
 14058              MOVE ER-2260   TO EMI-ERROR
 14059              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14060              GO TO 8200-SEND-DATAONLY.
 14061
 14062     IF CCERTNOL = ZEROS
 14063       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14064         NEXT SENTENCE
 14065     ELSE
 14066         IF CCERTNOL NOT = ZEROS
 14067             MOVE AL-UANON       TO CCERTNOA
 14068         ELSE
 14069             MOVE -1             TO CCERTNOL
 14070             MOVE  1             TO SET-CURSOR-SW
 14071             MOVE ER-2218       TO EMI-ERROR
 14072             MOVE AL-UABON       TO CCERTNOA
 14073             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14074
 14075     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14076        NEXT SENTENCE
 14077     ELSE
 14078        IF CEFFDTL NOT = ZEROS
 14079           MOVE AL-UNNON         TO CEFFDTA
 14080           MOVE CEFFDTI TO DEEDIT-FIELD
 14081           PERFORM 8600-DEEDIT
 14082           MOVE 4                TO DC-OPTION-CODE
 14083           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14084           PERFORM 9700-DATE-LINK
 14085           IF NO-CONVERSION-ERROR
 14086              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14087              ELSE
 14088              MOVE -1            TO CEFFDTL
 14089              MOVE  1            TO SET-CURSOR-SW
 14090              MOVE ER-2226      TO EMI-ERROR
 14091              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 256
* EL6311.cbl
 14092              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14093          ELSE
 14094          MOVE -1                 TO CEFFDTL
 14095          MOVE  1                 TO SET-CURSOR-SW
 14096          MOVE ER-2220            TO EMI-ERROR
 14097          MOVE AL-UNBON           TO CEFFDTA
 14098          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14099
 14100     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14101
 14102     IF CCERTNOL NOT = ZEROS
 14103        MOVE CCERTNOI                TO WS-NEW-PRIME
 14104     ELSE
 14105        MOVE SPACES                  TO WS-NEW-PRIME.
 14106
 14107     IF CSUFIXL NOT = ZEROS
 14108        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14109     ELSE
 14110        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14111
 14112     IF CEFFDTL NOT = ZEROS
 14113        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14114     ELSE
 14115        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14116
 14117     IF CMAINTI = 'A' OR 'K' OR 'S'
 14118        NEXT SENTENCE
 14119     ELSE
 14120        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14121        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14122           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14123           WS-PB-RECORD-TYPE NOT = '2'
 14124           IF CMAINTI = 'C'
 14125              MOVE ER-2287          TO EMI-ERROR
 14126              MOVE -1               TO CCERTNOL
 14127              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14128              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14129              GO TO 8200-SEND-DATAONLY
 14130             ELSE
 14131              MOVE ER-2260          TO EMI-ERROR
 14132              MOVE -1               TO CCERTNOL
 14133              MOVE AL-UABON         TO CCERTNOA
 14134              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14135              GO TO 8200-SEND-DATAONLY.
 14136
 14137     IF CMAINTI = 'D'
 14138        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14139
 14140     IF CLSTNML GREATER THAN ZEROS
 14141         MOVE AL-UANON           TO CLSTNMA.
 14142
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 257
* EL6311.cbl
 14144
 14145******************************************************************
 14146*                                                                *
 14147*           E D I T   C A N C E L   C O V E R A G E S            *
 14148*                                                                *
 14149******************************************************************
 14150
 14151 2015-EDIT-COVERAGES.
 14152     IF CCANDT1L      GREATER THAN ZEROS OR
 14153        CREFND1L      GREATER THAN ZEROS OR
 14154        CCANDT2L      GREATER THAN ZEROS OR
 14155        CREFND2L      GREATER THAN ZEROS OR
 14156        CMTHD1L       GREATER THAN ZEROS OR
 14157        CMTHD2L       GREATER THAN ZEROS OR
 14158        CLIVESL       GREATER THAN ZEROS OR
 14159        CPAYEEL       GREATER THAN ZEROS OR
 14160        CFORCEL       GREATER THAN ZEROS OR
 14161        CBILCDL       GREATER THAN ZEROS OR
 14162        CCANREAL      GREATER THAN ZEROS
 14163            NEXT SENTENCE
 14164         ELSE
 14165            GO TO 2030-EDIT-COMPLETE.
 14166
 14167     IF CCANDT1L = ZEROS
 14168        AND (CMAINTI = 'C' OR 'K')
 14169        NEXT SENTENCE
 14170     ELSE
 14171        IF CCANDT1L      GREATER THAN ZEROS
 14172            MOVE AL-UNNON            TO CCANDT1A
 14173            IF CCANDT1I = SPACES
 14174               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14175            ELSE
 14176               MOVE CCANDT1I            TO DEEDIT-FIELD
 14177               PERFORM 8600-DEEDIT
 14178               IF DEEDIT-FIELD-V0   NUMERIC
 14179                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14180                  MOVE 4                TO DC-OPTION-CODE
 14181                  PERFORM 9700-DATE-LINK
 14182                  IF NO-CONVERSION-ERROR
 14183                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14184                  ELSE
 14185                      MOVE -1        TO CCANDT1L
 14186                      MOVE ER-2227   TO EMI-ERROR
 14187                      MOVE AL-UNBON  TO CCANDT1A
 14188                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14189               ELSE
 14190                  MOVE -1         TO CCANDT1L
 14191                  MOVE ER-2223    TO EMI-ERROR
 14192                  MOVE AL-UNBON   TO CCANDT1A
 14193                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14194        ELSE
 14195            IF CREFND1L GREATER THAN ZEROS
 14196               MOVE -1             TO CCANDT1L
 14197               MOVE ER-2222        TO EMI-ERROR
 14198               MOVE AL-UNBOF       TO CCANDT1A
 14199               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14200
 14201     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 258
* EL6311.cbl
 14202        AND (CMAINTI = 'C' OR 'K')
 14203         NEXT SENTENCE
 14204     ELSE
 14205         IF CREFND1L NOT = ZEROS
 14206            MOVE AL-UNNON        TO CREFND1A
 14207
 14208* EXEC CICS BIF DEEDIT
 14209*               FIELD  (CREFND1I)
 14210*               LENGTH (11)
 14211*           END-EXEC
 14212     MOVE 11
 14213       TO DFHEIV11
 14214*    MOVE '@"L                   #   #00012783' TO DFHEIV0
 14215     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14216     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14217     MOVE X'2020233030303132373833' TO DFHEIV0(25:11)
 14218     CALL 'kxdfhei1' USING DFHEIV0,
 14219           CREFND1I,
 14220           DFHEIV11
 14221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14222            MOVE CREFND1I        TO WS-CREFND1
 14223*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14224*           PERFORM 8600-DEEDIT
 14225*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14226            IF WS-CREFND1  = ZEROS
 14227               AND CMAINTI = 'A'
 14228             MOVE ER-2437        TO EMI-ERROR
 14229             MOVE -1             TO CREFND1L
 14230             MOVE AL-UNBON       TO CREFND1A
 14231             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14232
 14233     IF CCANREAL > +0
 14234        MOVE AL-UANON            TO CCANREAA
 14235        IF CCANREAI = 'R' OR ' '
 14236           CONTINUE
 14237        ELSE
 14238           MOVE ER-9841        TO EMI-ERROR
 14239           MOVE -1             TO CCANREAL
 14240           MOVE AL-UABON       TO CCANREAA
 14241           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14242        END-IF
 14243     END-IF
 14244     IF CMTHD1L EQUAL +0
 14245        NEXT SENTENCE
 14246     ELSE
 14247        IF CMTHD1L NOT = +0
 14248           MOVE AL-UNNON        TO CMTHD1A
 14249           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14250                         OR '5' OR '6' OR '8' OR '9'
 14251                         OR 'R' OR ' '
 14252              NEXT SENTENCE
 14253           ELSE
 14254              MOVE ER-0582        TO EMI-ERROR
 14255              MOVE -1             TO CMTHD1L
 14256              MOVE AL-UNBON       TO CMTHD1A
 14257              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14258
 14259     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 259
* EL6311.cbl
 14260        AND (CMAINTI = 'C' OR 'K')
 14261         NEXT SENTENCE
 14262     ELSE
 14263         IF CCANDT2L  GREATER THAN ZEROS
 14264             MOVE AL-UNNON       TO CCANDT2A
 14265             IF CCANDT2I = SPACES
 14266                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14267             ELSE
 14268                MOVE CCANDT2I       TO DEEDIT-FIELD
 14269                PERFORM 8600-DEEDIT
 14270                IF DEEDIT-FIELD-V0   NUMERIC
 14271                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14272                   MOVE 4                TO DC-OPTION-CODE
 14273                   PERFORM 9700-DATE-LINK
 14274                   IF NO-CONVERSION-ERROR
 14275                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14276                   ELSE
 14277                      MOVE -1       TO CCANDT2L
 14278                      MOVE ER-2227  TO EMI-ERROR
 14279                      MOVE AL-UNBON TO CCANDT2A
 14280                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14281                ELSE
 14282                   MOVE -1         TO CCANDT2L
 14283                   MOVE ER-2223    TO EMI-ERROR
 14284                   MOVE AL-UNBON   TO CCANDT2A
 14285                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14286         ELSE
 14287            IF CREFND2L GREATER THAN ZEROS
 14288               MOVE -1             TO CCANDT2L
 14289               MOVE ER-2222        TO EMI-ERROR
 14290               MOVE AL-UNBOF       TO CCANDT2A
 14291               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14292
 14293     IF CREFND2L = ZEROS
 14294        AND (CMAINTI = 'C' OR 'K')
 14295         NEXT SENTENCE
 14296     ELSE
 14297         IF CREFND2L NOT = ZEROS
 14298            MOVE AL-UNNON        TO CREFND2A
 14299
 14300* EXEC CICS BIF DEEDIT
 14301*               FIELD  (CREFND2I)
 14302*               LENGTH (11)
 14303*           END-EXEC
 14304     MOVE 11
 14305       TO DFHEIV11
 14306*    MOVE '@"L                   #   #00012864' TO DFHEIV0
 14307     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14308     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14309     MOVE X'2020233030303132383634' TO DFHEIV0(25:11)
 14310     CALL 'kxdfhei1' USING DFHEIV0,
 14311           CREFND2I,
 14312           DFHEIV11
 14313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14314            MOVE CREFND2I        TO WS-CREFND2
 14315*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14316*           PERFORM 8600-DEEDIT
 14317*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 260
* EL6311.cbl
 14318            IF WS-CREFND2  = ZEROS
 14319               AND CMAINTI = 'A'
 14320             MOVE ER-2437        TO EMI-ERROR
 14321             MOVE -1             TO CREFND2L
 14322             MOVE AL-UNBON       TO CREFND2A
 14323             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14324
 14325     IF CMTHD2L EQUAL +0
 14326        NEXT SENTENCE
 14327     ELSE
 14328        IF CMTHD2L NOT = +0
 14329           MOVE AL-UNNON        TO CMTHD2A
 14330           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14331                         OR '5' OR '6' OR '8' OR '9'
 14332                         OR ' ' OR 'R'
 14333              NEXT SENTENCE
 14334           ELSE
 14335              MOVE ER-0582        TO EMI-ERROR
 14336              MOVE -1             TO CMTHD2L
 14337              MOVE AL-UNBON       TO CMTHD2A
 14338              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14339
 14340     IF CLIVESL GREATER THAN ZEROS
 14341         MOVE CLIVESI            TO DEEDIT-FIELD
 14342         PERFORM 8600-DEEDIT
 14343         IF DEEDIT-FIELD-V0 NUMERIC
 14344             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14345             MOVE AL-UNNON       TO CLIVESA
 14346         ELSE
 14347             MOVE -1             TO CLIVESL
 14348             MOVE AL-UNBON       TO CLIVESA
 14349             MOVE ER-2223        TO EMI-ERROR
 14350             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14351
 14352     IF CFORCEL  NOT = ZEROS
 14353         IF FORCE-CAP
 14354            MOVE AL-UANON            TO CFORCEA
 14355         ELSE
 14356            MOVE ER-2945             TO EMI-ERROR
 14357            MOVE AL-UABON            TO CFORCEA
 14358            MOVE -1                  TO CFORCEL
 14359            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14360
 14361     IF CPAYEEL GREATER THAN ZEROS
 14362        MOVE AL-UANON            TO CPAYEEA.
 14363
 14364     IF CBILCDL NOT = ZEROS
 14365        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14366                             AND 'A' AND 'B' AND 'E'
 14367           MOVE ER-2225              TO EMI-ERROR
 14368           MOVE AL-UABON             TO CBILCDA
 14369           MOVE -1                   TO CBILCDL
 14370           MOVE  1                   TO SET-CURSOR-SW
 14371           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14372        ELSE
 14373           MOVE AL-UANON             TO CBILCDA.
 14374
 14375 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 261
* EL6311.cbl
 14376     IF EMI-ERROR = ZEROS
 14377         NEXT SENTENCE
 14378     ELSE
 14379         GO TO 8200-SEND-DATAONLY.
 14380
 14381     IF CMAINTI = 'A'
 14382        GO TO 2200-ADD-CANCEL-ROUTINE.
 14383
 14384     IF CMAINTI = 'C'
 14385        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14386
 14387     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14388
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 262
* EL6311.cbl
 14390
 14391******************************************************************
 14392*                                                                *
 14393*                   S H O W   C A N C E L                        *
 14394*                                                                *
 14395******************************************************************
 14396
 14397 2100-SHOW-REQUEST.
 14398     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14399
 14400     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14401        MOVE -1                  TO CMAINTL
 14402        GO TO 8200-SEND-DATAONLY.
 14403
 14404     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14405
 14406     IF CSUFIXL NOT = ZEROS
 14407        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14408       ELSE
 14409        MOVE SPACE            TO WS-NEW-SUFFIX.
 14410
 14411     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14412     PERFORM 8600-DEEDIT.
 14413     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14414     MOVE '4'                    TO DC-OPTION-CODE.
 14415     PERFORM 9700-DATE-LINK.
 14416     IF DATE-CONVERSION-ERROR
 14417        MOVE ER-0348             TO EMI-ERROR
 14418        MOVE -1                  TO CEFFDTL
 14419        MOVE AL-UABON            TO CEFFDTA
 14420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14421        GO TO 8200-SEND-DATAONLY
 14422     ELSE
 14423        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14424        MOVE AL-UANON            TO CEFFDTA
 14425        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14426
 14427     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14428
 14429     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14430        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14431        MOVE 'Y'                    TO WS-SHOW-SW
 14432        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14433           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14434        ELSE
 14435           IF PI-FILE-BROWSE
 14436              GO TO 4300-BROWSE-FILE-FORWARD
 14437           ELSE
 14438              IF PI-CSR-BROWSE
 14439                 GO TO 4200-BROWSE-CSR-FORWARD
 14440              ELSE
 14441                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14442     ELSE
 14443        GO TO 3900-RE-DISPLAY-RECORD.
 14444
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 263
* EL6311.cbl
 14446
 14447
 14448******************************************************************
 14449*                                                                *
 14450*            A D D   C A N C E L   R O U T I N E                 *
 14451*                                                                *
 14452******************************************************************
 14453
 14454 2200-ADD-CANCEL-ROUTINE.
 14455     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14456
 14457
 14458* EXEC CICS GETMAIN
 14459*        SET     (ADDRESS OF PENDING-BUSINESS)
 14460*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14461*    END-EXEC.
 14462*    MOVE '," L                  $   #00013011' TO DFHEIV0
 14463     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14464     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14465     MOVE X'2020233030303133303131' TO DFHEIV0(25:11)
 14466     CALL 'kxdfhei1' USING DFHEIV0,
 14467           DFHEIV20,
 14468           ERPNDB-RECORD-LENGTH,
 14469           DFHEIV99
 14470     SET ADDRESS OF PENDING-BUSINESS TO
 14471         DFHEIV20
 14472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14473
 14474
 14475
 14476* EXEC CICS HANDLE CONDITION
 14477*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14478*    END-EXEC.
 14479*    MOVE '"$I                   ! 3 #00013016' TO DFHEIV0
 14480     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14482     MOVE X'3320233030303133303136' TO DFHEIV0(25:11)
 14483     CALL 'kxdfhei1' USING DFHEIV0
 14484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14485
 14486
 14487     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14488     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14489     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14490
 14491
 14492* EXEC CICS READ
 14493*        INTO    (PENDING-BUSINESS)
 14494*        DATASET (FILE-ID-ERPNDB)
 14495*        RIDFLD  (ERPNDB-KEY)
 14496*    END-EXEC.
 14497     MOVE LENGTH OF
 14498      PENDING-BUSINESS
 14499       TO DFHEIV11
 14500*    MOVE '&"IL       E          (   #00013024' TO DFHEIV0
 14501     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14502     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14503     MOVE X'2020233030303133303234' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 264
* EL6311.cbl
 14504     CALL 'kxdfhei1' USING DFHEIV0,
 14505           FILE-ID-ERPNDB,
 14506           PENDING-BUSINESS,
 14507           DFHEIV11,
 14508           ERPNDB-KEY,
 14509           DFHEIV99,
 14510           DFHEIV99,
 14511           DFHEIV99
 14512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14513
 14514
 14515     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14516
 14517     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14518     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14519     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14520     MOVE SPACES                 TO PENDING-BUSINESS.
 14521     MOVE 'PB'                   TO PB-RECORD-ID.
 14522     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14523     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14524     MOVE SPACES                 TO PB-CERT-SFX.
 14525     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14526     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14527                                    PB-ALT-CHG-SEQ-NO.
 14528
 14529     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14530     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14531     MOVE '2'                    TO PB-RECORD-TYPE.
 14532
 14533     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14534     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14535
 14536
 14537     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14538                                    PB-ALT-CHG-SEQ-NO
 14539                                    PB-C-LF-REF-CALC
 14540                                    PB-C-AH-REF-CALC
 14541                                    PB-C-LF-RFND-CLP
 14542                                    PB-C-AH-RFND-CLP
 14543                                    PB-CI-INSURED-AGE
 14544                                    PB-CI-LF-TERM
 14545                                    PB-CI-AH-TERM
 14546                                    PB-CI-LF-BENEFIT-CD
 14547                                    PB-CI-LF-BENEFIT-AMT
 14548                                    PB-CI-LF-ALT-BENEFIT-AMT
 14549                                    PB-CI-LF-PREMIUM-AMT
 14550                                    PB-CI-LF-ALT-PREMIUM-AMT
 14551                                    PB-CI-AH-BENEFIT-CD
 14552                                    PB-CI-AH-BENEFIT-AMT
 14553                                    PB-CI-AH-PREMIUM-AMT
 14554                                    PB-CI-PAY-FREQUENCY
 14555                                    PB-CI-LOAN-APR
 14556                                    PB-CI-LOAN-TERM
 14557                                    PB-CI-LIFE-COMMISSION
 14558                                    PB-CI-AH-COMMISSION
 14559                                    PB-CI-CURR-SEQ
 14560                                    PB-CI-AH-CANCEL-AMT
 14561                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 265
* EL6311.cbl
 14562                                    PB-CI-RATE-DEV-PCT-LF
 14563                                    PB-CI-RATE-DEV-PCT-AH
 14564                                    PB-CI-EXTENTION-DAYS
 14565                                    PB-CI-TERM-IN-DAYS
 14566                                    PB-CI-LIVES
 14567                                    PB-CI-LF-CRIT-PER
 14568                                    PB-CI-AH-CRIT-PER
 14569                                    PB-C-LF-REM-TERM
 14570                                    PB-C-AH-REM-TERM
 14571                                    PB-CHG-COUNT
 14572                                    PB-LF-BILLED-AMTS
 14573                                    PB-AH-BILLED-AMTS
 14574                                    PB-C-NH-INT-ON-REFS
 14575*                                   PB-C-MICROFILM-NO
 14576                                    PB-CALC-TOLERANCE.
 14577
 14578     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14579                                    PB-CI-AH-SETTLEMENT-DT
 14580                                    PB-CI-DEATH-DT
 14581                                    PB-CI-LF-PRIOR-CANCEL-DT
 14582                                    PB-CI-AH-PRIOR-CANCEL-DT
 14583                                    PB-CI-ENTRY-DT
 14584                                    PB-CI-LF-EXPIRE-DT
 14585                                    PB-CI-AH-EXPIRE-DT
 14586                                    PB-CI-LOAN-1ST-PMT-DT
 14587                                    PB-C-LF-CANCEL-DT
 14588                                    PB-C-AH-CANCEL-DT
 14589                                    PB-CREDIT-ACCEPT-DT
 14590                                    PB-BILLED-DT
 14591                                    PB-ACCT-EFF-DT
 14592                                    PB-ACCT-EXP-DT.
 14593
 14594     MOVE 'X'                    TO PB-FATAL-FLAG.
 14595
 14596     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14597
 14598     IF CSUFIXL     GREATER THAN ZEROS
 14599        MOVE CSUFIXI             TO PB-CERT-SFX.
 14600
 14601*    IF CMICRNOL  GREATER  ZEROS
 14602*        IF CMICRNOI  NUMERIC
 14603*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14604*            MOVE AL-UNNON       TO  CMICRNOA
 14605*        ELSE
 14606*            MOVE -1             TO  CMICRNOL
 14607*            MOVE AL-UNBON       TO  CMICRNOA
 14608*            MOVE ER-2701        TO  EMI-ERROR
 14609*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14610
 14611     IF CLSTNML     GREATER THAN ZEROS
 14612        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14613
 14614     IF CCANREAL > ZEROS
 14615        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14616     END-IF
 14617     IF CPCYNL > ZEROS
 14618        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14619     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 266
* EL6311.cbl
 14620     IF CCANDT1L    GREATER THAN ZEROS
 14621        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14622
 14623     IF CCANDT2L    GREATER THAN ZEROS
 14624        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14625
 14626     IF CMTHD1L    GREATER THAN +0
 14627        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14628
 14629     IF CMTHD2L    GREATER THAN +0
 14630        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14631
 14632     IF CREFND1L    GREATER THAN ZEROS
 14633        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14634        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14635     ELSE
 14636        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14637
 14638     IF CREFND2L    GREATER THAN ZEROS
 14639        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14640        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14641     ELSE
 14642        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14643
 14644     IF CLIVESL     GREATER THAN ZEROS
 14645        MOVE WS-CLIVES           TO PB-C-LIVES
 14646     ELSE
 14647        MOVE ZEROS               TO PB-C-LIVES.
 14648
 14649     IF CPAYEEL     GREATER THAN ZEROS
 14650        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14651
 14652     IF CFORCEL     GREATER THAN ZEROS
 14653        MOVE CFORCEI             TO PB-FORCE-CODE.
 14654
 14655     IF CBILCDL     GREATER THAN ZEROS
 14656        MOVE CBILCDI             TO PB-RECORD-BILL.
 14657
 14658*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14659
 14660 2260-WRITE-PB-RECORD.
 14661     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14662                                    PB-INPUT-BY.
 14663     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14664     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14665                                    PB-INPUT-DT.
 14666
 14667     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14668     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14669                                    PB-CONTROL-BY-ORIG-BATCH.
 14670
 14671     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14672     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14673     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14674     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14675     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14676
 14677     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 267
* EL6311.cbl
 14678
 14679     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14680
 14681     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14682     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14683     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14684
 14685     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14686     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14687
 14688 2275-WRITE-PENDING-BUSINESS.
 14689     MOVE 'A'                    TO JP-RECORD-TYPE.
 14690     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14691     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14692     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14693
 14694
 14695* EXEC CICS HANDLE CONDITION
 14696*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14697*    END-EXEC.
 14698*    MOVE '"$%                   ! 4 #00013209' TO DFHEIV0
 14699     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14701     MOVE X'3420233030303133323039' TO DFHEIV0(25:11)
 14702     CALL 'kxdfhei1' USING DFHEIV0
 14703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14704
 14705
 14706
 14707* EXEC CICS WRITE
 14708*        DATASET (FILE-ID-ERPNDB)
 14709*        FROM    (PENDING-BUSINESS)
 14710*        RIDFLD  (PB-CONTROL-PRIMARY)
 14711*    END-EXEC.
 14712     MOVE LENGTH OF
 14713      PENDING-BUSINESS
 14714       TO DFHEIV11
 14715*    MOVE '&$ L                  ''   #00013213' TO DFHEIV0
 14716     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14717     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14718     MOVE X'2020233030303133323133' TO DFHEIV0(25:11)
 14719     CALL 'kxdfhei1' USING DFHEIV0,
 14720           FILE-ID-ERPNDB,
 14721           PENDING-BUSINESS,
 14722           DFHEIV11,
 14723           PB-CONTROL-PRIMARY,
 14724           DFHEIV99,
 14725           DFHEIV99
 14726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14727
 14728
 14729     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14730
 14731     PERFORM 8400-LOG-JOURNAL-RECORD.
 14732
 14733******************************************************************
 14734*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14735******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 268
* EL6311.cbl
 14736
 14737     display ' made it to add orig CANCEL cert '
 14738     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14739     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14740     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14741     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14742
 14743
 14744* EXEC CICS READ
 14745*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14746*        DATASET (FILE-ID-ELCERT)
 14747*        RIDFLD  (ELCERT-KEY)
 14748*        RESP    (WS-RESPONSE)
 14749*    END-EXEC.
 14750*    MOVE '&"S        E          (  N#00013233' TO DFHEIV0
 14751     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14752     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14753     MOVE X'204E233030303133323333' TO DFHEIV0(25:11)
 14754     CALL 'kxdfhei1' USING DFHEIV0,
 14755           FILE-ID-ELCERT,
 14756           DFHEIV20,
 14757           DFHEIV99,
 14758           ELCERT-KEY,
 14759           DFHEIV99,
 14760           DFHEIV99,
 14761           DFHEIV99
 14762     SET ADDRESS OF CERTIFICATE-MASTER TO
 14763         DFHEIV20
 14764     MOVE EIBRESP  TO WS-RESPONSE
 14765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14766
 14767
 14768     IF NOT RESP-NORMAL
 14769        GO TO 2276-BYPASS-CRTO
 14770     END-IF
 14771
 14772     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14773     MOVE ' '                    TO WS-ERMAIL-SW
 14774
 14775
 14776* EXEC CICS READ
 14777*       DATASET   (FILE-ID-ERMAIL)
 14778*       SET       (ADDRESS OF MAILING-DATA)
 14779*       RIDFLD    (ERMAIL-KEY)
 14780*       RESP      (WS-RESPONSE)
 14781*    END-EXEC
 14782*    MOVE '&"S        E          (  N#00013247' TO DFHEIV0
 14783     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14785     MOVE X'204E233030303133323437' TO DFHEIV0(25:11)
 14786     CALL 'kxdfhei1' USING DFHEIV0,
 14787           FILE-ID-ERMAIL,
 14788           DFHEIV20,
 14789           DFHEIV99,
 14790           ERMAIL-KEY,
 14791           DFHEIV99,
 14792           DFHEIV99,
 14793           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 269
* EL6311.cbl
 14794     SET ADDRESS OF MAILING-DATA TO
 14795         DFHEIV20
 14796     MOVE EIBRESP  TO WS-RESPONSE
 14797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14798
 14799     IF RESP-NORMAL
 14800        SET ERMAIL-FOUND TO TRUE
 14801     END-IF
 14802
 14803     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14804
 14805     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14806     MOVE 'OC'                   TO OC-RECORD-ID
 14807     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14808                                 TO OC-CONTROL-PRIMARY (1:33)
 14809     MOVE 'I'                    TO OC-RECORD-TYPE
 14810     MOVE +4096                  TO OC-KEY-SEQ-NO
 14811     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14812     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14813     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14814
 14815     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14816     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14817     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14818     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14819     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14820     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14821     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14822     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14823     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14824     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14825     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14826     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14827     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14828     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14829     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14830     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14831     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14832     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14833     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14834     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14835     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14836     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14837     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14838     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14839     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14840     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14841     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14842     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14843     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14844     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14845     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14846     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14847
 14848     IF ERMAIL-FOUND
 14849        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14850     END-IF
 14851     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 270
* EL6311.cbl
 14852        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14853                           OC-INS-AGE-DEFAULT-FLAG
 14854        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14855                           OC-JNT-AGE-DEFAULT-FLAG
 14856     END-IF
 14857     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14858     .
 14859 2275-WRITE-ELCRTO.
 14860
 14861
 14862* EXEC CICS WRITE
 14863*       DATASET   ('ELCRTO')
 14864*       FROM      (ORIGINAL-CERTIFICATE)
 14865*       RIDFLD    (OC-CONTROL-PRIMARY)
 14866*       RESP      (WS-RESPONSE)
 14867*    END-EXEC
 14868     MOVE LENGTH OF
 14869      ORIGINAL-CERTIFICATE
 14870       TO DFHEIV11
 14871     MOVE 'ELCRTO' TO DFHEIV1
 14872*    MOVE '&$ L                  ''  N#00013316' TO DFHEIV0
 14873     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14874     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14875     MOVE X'204E233030303133333136' TO DFHEIV0(25:11)
 14876     CALL 'kxdfhei1' USING DFHEIV0,
 14877           DFHEIV1,
 14878           ORIGINAL-CERTIFICATE,
 14879           DFHEIV11,
 14880           OC-CONTROL-PRIMARY,
 14881           DFHEIV99,
 14882           DFHEIV99
 14883     MOVE EIBRESP  TO WS-RESPONSE
 14884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14885
 14886     display ' just wrote 2275 ' ws-response
 14887     IF RESP-DUPKEY
 14888        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14889        GO TO 2275-WRITE-ELCRTO
 14890     ELSE
 14891        IF NOT RESP-NORMAL
 14892           MOVE -1               TO BMAINTL
 14893           MOVE ER-7450          TO EMI-ERROR
 14894           PERFORM 9900-ERROR-FORMAT
 14895                                 THRU 9900-EXIT
 14896           GO TO 8200-SEND-DATAONLY
 14897        END-IF
 14898     END-IF.
 14899
 14900 2276-BYPASS-CRTO.
 14901******************************************************************
 14902*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14903******************************************************************
 14904
 14905
 14906* EXEC CICS READ
 14907*        INTO    (PENDING-BUSINESS)
 14908*        DATASET (FILE-ID-ERPNDB)
 14909*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 271
* EL6311.cbl
 14910*        UPDATE
 14911*    END-EXEC.
 14912     MOVE LENGTH OF
 14913      PENDING-BUSINESS
 14914       TO DFHEIV11
 14915*    MOVE '&"IL       EU         (   #00013342' TO DFHEIV0
 14916     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14917     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14918     MOVE X'2020233030303133333432' TO DFHEIV0(25:11)
 14919     CALL 'kxdfhei1' USING DFHEIV0,
 14920           FILE-ID-ERPNDB,
 14921           PENDING-BUSINESS,
 14922           DFHEIV11,
 14923           ERPNDB-KEY,
 14924           DFHEIV99,
 14925           DFHEIV99,
 14926           DFHEIV99
 14927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14928
 14929
 14930     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14931     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14932     MOVE 'B'                    TO JP-RECORD-TYPE.
 14933     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14934
 14935     PERFORM 8400-LOG-JOURNAL-RECORD.
 14936
 14937     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14938
 14939
 14940* EXEC CICS REWRITE
 14941*        DATASET (FILE-ID-ERPNDB)
 14942*        FROM    (PENDING-BUSINESS)
 14943*    END-EXEC.
 14944     MOVE LENGTH OF
 14945      PENDING-BUSINESS
 14946       TO DFHEIV11
 14947*    MOVE '&& L                  %   #00013358' TO DFHEIV0
 14948     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14949     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14950     MOVE X'2020233030303133333538' TO DFHEIV0(25:11)
 14951     CALL 'kxdfhei1' USING DFHEIV0,
 14952           FILE-ID-ERPNDB,
 14953           PENDING-BUSINESS,
 14954           DFHEIV11,
 14955           DFHEIV99
 14956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14957
 14958
 14959     MOVE 'C'                    TO JP-RECORD-TYPE.
 14960     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14961
 14962     PERFORM 8400-LOG-JOURNAL-RECORD.
 14963
 14964     IF WS-ERRORS-PRESENT
 14965        GO TO 3900-RE-DISPLAY-RECORD.
 14966
 14967     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 272
* EL6311.cbl
 14968     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14969     MOVE LOW-VALUES             TO EL631CI.
 14970     MOVE  -1                    TO CMAINTL.
 14971     GO TO 8100-SEND-INITIAL-MAP.
 14972
 14973 2280-BATCH-HDR-NOT-FOUND.
 14974     MOVE -1                     TO BMAINTL.
 14975     MOVE ER-7450                TO EMI-ERROR.
 14976     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14977     GO TO 8200-SEND-DATAONLY.
 14978
 14979 2290-DUPLICATE-ALT-INDEX.
 14980
 14981******************************************************************
 14982*                                                                *
 14983*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14984*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14985*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14986*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14987*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14988*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14989*                                                                *
 14990******************************************************************
 14991
 14992     IF LCP-ONCTR-02 =  0
 14993         ADD 1 TO LCP-ONCTR-02
 14994        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14995
 14996     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14997
 14998     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14999         NEXT SENTENCE
 15000     ELSE
 15001         ADD +1 TO PB-BATCH-SEQ-NO
 15002                   PB-CSR-BATCH-SEQ-NO
 15003         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15004         GO TO 2275-WRITE-PENDING-BUSINESS.
 15005
 15006     MOVE -1                     TO CCERTNOL.
 15007     MOVE AL-UABON               TO CCERTNOA.
 15008     MOVE AL-UNBON               TO CEFFDTA.
 15009
 15010     MOVE 1                      TO EMI-SUB
 15011                                    EMI-SWITCH1
 15012                                    EMI-SWITCH-AREA-1
 15013                                    EMI-SWITCH-AREA-2.
 15014
 15015     MOVE SPACES                 TO EMI-ERROR-LINES.
 15016
 15017
 15018* EXEC CICS SYNCPOINT ROLLBACK
 15019*    END-EXEC.
 15020*    MOVE '6"R                   !   #00013421' TO DFHEIV0
 15021     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15022     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15023     MOVE X'2020233030303133343231' TO DFHEIV0(25:11)
 15024     CALL 'kxdfhei1' USING DFHEIV0
 15025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 273
* EL6311.cbl
 15026
 15027
 15028     MOVE ER-2247                TO EMI-ERROR.
 15029     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15030     GO TO 8200-SEND-DATAONLY.
 15031
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 274
* EL6311.cbl
 15033
 15034******************************************************************
 15035*                                                                *
 15036*          C H A N G E   C A N C E L   R O U T I N E             *
 15037*                                                                *
 15038******************************************************************
 15039
 15040***************************************************************
 15041*                                                             *
 15042*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15043*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15044*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15045*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15046*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15047*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15048*     5. LINK TO THE EDIT ROUTINE.                            *
 15049*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15050*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15051*              THE EDIT ROUTINE.                              *
 15052*     7. REWRITE THE NEW ISSUE                                *
 15053*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15054*                                                             *
 15055***************************************************************
 15056 2300-CHANGE-CANCEL-ROUTINE.
 15057     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15058
 15059     IF CCHGL NOT = ZEROS
 15060        MOVE ER-2196             TO EMI-ERROR
 15061        MOVE AL-UABON            TO CMAINTA
 15062        MOVE -1                  TO CMAINTL
 15063        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15064        GO TO 8200-SEND-DATAONLY.
 15065
 15066     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15067
 15068     IF CSUFIXL NOT = ZEROS
 15069        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15070     ELSE
 15071        MOVE SPACE               TO WS-NEW-SUFFIX.
 15072
 15073     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15074     PERFORM 8600-DEEDIT.
 15075     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15076     MOVE '4'                    TO DC-OPTION-CODE.
 15077
 15078     PERFORM 9700-DATE-LINK.
 15079
 15080     IF DATE-CONVERSION-ERROR
 15081        MOVE ER-0348             TO EMI-ERROR
 15082        MOVE -1                  TO CEFFDTL
 15083        MOVE AL-UABON            TO CEFFDTA
 15084        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15085        GO TO 8200-SEND-DATAONLY
 15086     ELSE
 15087        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15088        MOVE AL-UANON            TO CEFFDTA
 15089        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15090
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 275
* EL6311.cbl
 15091 2325-PROCESS-CANCEL-CHANGES.
 15092
 15093* EXEC CICS HANDLE CONDITION
 15094*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15095*    END-EXEC.
 15096*    MOVE '"$I                   ! 5 #00013488' TO DFHEIV0
 15097     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15099     MOVE X'3520233030303133343838' TO DFHEIV0(25:11)
 15100     CALL 'kxdfhei1' USING DFHEIV0
 15101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15102
 15103
 15104     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15105     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15106     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15107
 15108
 15109* EXEC CICS GETMAIN
 15110*        SET      (ADDRESS OF PENDING-BUSINESS)
 15111*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15112*        INITIMG  (GETMAIN-SPACE)
 15113*     END-EXEC.
 15114*    MOVE ',"IL                  $   #00013496' TO DFHEIV0
 15115     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15116     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15117     MOVE X'2020233030303133343936' TO DFHEIV0(25:11)
 15118     CALL 'kxdfhei1' USING DFHEIV0,
 15119           DFHEIV20,
 15120           ERPNDB-RECORD-LENGTH,
 15121           GETMAIN-SPACE
 15122     SET ADDRESS OF PENDING-BUSINESS TO
 15123         DFHEIV20
 15124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15125
 15126
 15127
 15128* EXEC CICS READ
 15129*        INTO    (PENDING-BUSINESS)
 15130*        DATASET (FILE-ID-ERPNDB)
 15131*        RIDFLD  (ERPNDB-KEY)
 15132*    END-EXEC.
 15133     MOVE LENGTH OF
 15134      PENDING-BUSINESS
 15135       TO DFHEIV11
 15136*    MOVE '&"IL       E          (   #00013502' TO DFHEIV0
 15137     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15139     MOVE X'2020233030303133353032' TO DFHEIV0(25:11)
 15140     CALL 'kxdfhei1' USING DFHEIV0,
 15141           FILE-ID-ERPNDB,
 15142           PENDING-BUSINESS,
 15143           DFHEIV11,
 15144           ERPNDB-KEY,
 15145           DFHEIV99,
 15146           DFHEIV99,
 15147           DFHEIV99
 15148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 276
* EL6311.cbl
 15149
 15150
 15151     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15152
 15153
 15154* EXEC CICS HANDLE CONDITION
 15155*         NOTFND     (2385-REC-NOT-FOUND)
 15156*    END-EXEC.
 15157*    MOVE '"$I                   ! 6 #00013510' TO DFHEIV0
 15158     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15160     MOVE X'3620233030303133353130' TO DFHEIV0(25:11)
 15161     CALL 'kxdfhei1' USING DFHEIV0
 15162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15163
 15164
 15165**********************************************************
 15166*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15167*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15168**********************************************************
 15169
 15170
 15171* EXEC CICS READ
 15172*        DATASET (FILE-ID-ERPNDB)
 15173*        INTO    (PENDING-BUSINESS)
 15174*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15175*    END-EXEC.
 15176     MOVE LENGTH OF
 15177      PENDING-BUSINESS
 15178       TO DFHEIV11
 15179*    MOVE '&"IL       E          (   #00013519' TO DFHEIV0
 15180     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15181     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15182     MOVE X'2020233030303133353139' TO DFHEIV0(25:11)
 15183     CALL 'kxdfhei1' USING DFHEIV0,
 15184           FILE-ID-ERPNDB,
 15185           PENDING-BUSINESS,
 15186           DFHEIV11,
 15187           PI-PREV-CONTROL-PRIMARY,
 15188           DFHEIV99,
 15189           DFHEIV99,
 15190           DFHEIV99
 15191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15192
 15193
 15194********** DO NOT ALLOW CHANGES IF THRU A/R
 15195     IF BMAINTI = 'C'
 15196         IF PB-EL860-INTERNAL-PROCESS
 15197             MOVE ER-4005          TO EMI-ERROR
 15198             MOVE -1               TO BMAINTL
 15199             MOVE AL-UABON         TO BMAINTA
 15200             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15201             GO TO 8200-SEND-DATAONLY.
 15202**********
 15203
 15204     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15205        MOVE -1                 TO CMAINTL
 15206        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 277
* EL6311.cbl
 15207        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15208        GO TO 8200-SEND-DATAONLY.
 15209
 15210     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15211        MOVE ER-2196             TO EMI-ERROR
 15212        MOVE AL-UABON            TO CMAINTA
 15213        MOVE -1                  TO CMAINTL
 15214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15215        GO TO 8200-SEND-DATAONLY.
 15216     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15217
 15218     IF PB-BILLED-DT = LOW-VALUES AND
 15219        PB-CHG-COUNT = ZEROS
 15220        NEXT SENTENCE
 15221     ELSE
 15222        IF (CREFND1L GREATER THAN ZEROS AND
 15223            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15224           OR
 15225           (CREFND2L GREATER THAN ZEROS AND
 15226            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15227           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15228     if ((crefnd1l <> zeros)
 15229        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15230                      or
 15231        ((crefnd2l <> zeros)
 15232        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15233        continue
 15234     else
 15235        go to 2330-continue-change
 15236     end-if
 15237
 15238     move ' '                    to ws-stop-sw
 15239                                    ws-check-sw
 15240                                    ws-proc-check-sw
 15241                                    ws-chek-browse-sw
 15242
 15243     perform 2500-browse-checks  thru 2500-exit
 15244
 15245     if i-have-processed-checks
 15246        or i-have-checks
 15247        continue
 15248     else
 15249        go to 2330-continue-change
 15250     end-if
 15251
 15252     display ' pb lf can ' pb-c-lf-cancel-amt
 15253     display ' ws lf can ' ws-crefnd1
 15254     if crefnd1l <> zeros
 15255        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15256        move ws-crefnd1 to ws-new-ref-total
 15257     else
 15258        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15259     end-if
 15260     display ' pb ah can ' pb-c-ah-cancel-amt
 15261     display ' ws ah can ' ws-crefnd2
 15262     display ' chk amts  ' ws-check-amts
 15263     if crefnd2l <> zeros
 15264        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 278
* EL6311.cbl
 15265        compute ws-new-ref-total = ws-new-ref-total +
 15266           ws-crefnd2
 15267     else
 15268        compute ws-new-ref-total = ws-new-ref-total +
 15269           pb-c-ah-cancel-amt
 15270     end-if
 15271
 15272     if zeros = (ws-lf-diff + ws-ah-diff)
 15273        move er-3449             to emi-error
 15274        perform 9900-error-format thru 9900-exit
 15275        go to 2330-continue-change
 15276     end-if
 15277
 15278     if ws-new-ref-total < ws-check-amts
 15279        move er-3447             to emi-error
 15280        perform 9900-error-format thru 9900-exit
 15281        move al-uabon            to cmainta
 15282        move -1                  to cmaintl
 15283        go to 8200-send-dataonly
 15284     end-if
 15285
 15286     if ws-new-ref-total > ws-check-amts
 15287        move er-3448             to emi-error
 15288        move al-uabon            to crefnd1a
 15289                                    crefnd2a
 15290        perform 9900-error-format thru 9900-exit
 15291     end-if
 15292
 15293*     if (ws-lf-diff + ws-ah-diff) < zeros
 15294*        move er-3447             to emi-error
 15295*        perform 9900-error-format thru 9900-exit
 15296*        move al-uabon            to cmainta
 15297*        move -1                  to cmaintl
 15298*        go to 8200-send-dataonly
 15299*     end-if
 15300     .
 15301 2330-continue-change.
 15302
 15303
 15304* EXEC CICS READ
 15305*        DATASET (FILE-ID-ERPNDB)
 15306*        INTO    (PENDING-BUSINESS)
 15307*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15308*        UPDATE
 15309*    END-EXEC.
 15310     MOVE LENGTH OF
 15311      PENDING-BUSINESS
 15312       TO DFHEIV11
 15313*    MOVE '&"IL       EU         (   #00013634' TO DFHEIV0
 15314     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15315     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15316     MOVE X'2020233030303133363334' TO DFHEIV0(25:11)
 15317     CALL 'kxdfhei1' USING DFHEIV0,
 15318           FILE-ID-ERPNDB,
 15319           PENDING-BUSINESS,
 15320           DFHEIV11,
 15321           PI-PREV-CONTROL-PRIMARY,
 15322           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 279
* EL6311.cbl
 15323           DFHEIV99,
 15324           DFHEIV99
 15325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15326
 15327
 15328     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15329     MOVE 'B'                    TO JP-RECORD-TYPE
 15330     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15331     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15332
 15333     PERFORM 8400-LOG-JOURNAL-RECORD.
 15334
 15335     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15336          PB-CHG-COUNT NOT = ZEROS
 15337        IF (CREFND1L GREATER THAN ZEROS AND
 15338            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15339           OR
 15340           (CREFND2L GREATER THAN ZEROS AND
 15341            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15342            ADD +1                      TO PB-CHG-COUNT
 15343            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15344
 15345*    IF CMICRNOL  GREATER  ZEROS
 15346*        IF CMICRNOI  NUMERIC
 15347*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15348*            MOVE AL-UNNON       TO  CMICRNOA
 15349*        ELSE
 15350*            MOVE -1             TO  CMICRNOL
 15351*            MOVE AL-UNBON       TO  CMICRNOA
 15352*            MOVE ER-2701        TO  EMI-ERROR
 15353*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15354
 15355     IF CSUFIXL GREATER THAN ZEROS
 15356        MOVE CSUFIXI             TO PB-CERT-SFX.
 15357
 15358     IF CLSTNML GREATER THAN ZEROS
 15359         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15360
 15361     IF CCANREAL > ZEROS
 15362        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15363     END-IF
 15364     IF CPCYNL > ZEROS
 15365        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15366     END-IF
 15367     IF CCANDT1L    GREATER THAN ZEROS
 15368        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15369
 15370     IF CCANDT2L    GREATER THAN ZEROS
 15371        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15372
 15373     IF CMTHD1L    GREATER THAN +0
 15374        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15375
 15376     IF CMTHD2L    GREATER THAN +0
 15377        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15378
 15379     IF CREFND1L    GREATER THAN ZEROS
 15380        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 280
* EL6311.cbl
 15381        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15382        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15383        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15384
 15385     IF CREFND2L    GREATER THAN ZEROS
 15386        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15387        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15388        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15389        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15390
 15391     IF CLIVESL     GREATER THAN ZEROS
 15392        MOVE WS-CLIVES           TO PB-C-LIVES.
 15393
 15394     IF CPAYEEL     GREATER THAN ZEROS
 15395        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15396
 15397     IF CFORCEL     GREATER THAN ZEROS
 15398        MOVE CFORCEI             TO PB-FORCE-CODE.
 15399
 15400     IF CBILCDL     GREATER THAN ZEROS
 15401        MOVE CBILCDI             TO PB-RECORD-BILL.
 15402
 15403 2360-REWRITE-PB-RECORD.
 15404     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15405     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15406     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15407     MOVE 'C'                    TO JP-RECORD-TYPE.
 15408     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15409     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15410     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15411
 15412     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15413
 15414     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15415     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15416
 15417     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15418
 15419     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15420
 15421     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15422     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15423     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15424
 15425     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15426     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15427
 15428 2375-REWRITE-PENDING-BUSINESS.
 15429     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15430     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15431     MOVE 'C'                    TO JP-RECORD-TYPE.
 15432     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15433
 15434
 15435* EXEC CICS REWRITE
 15436*        DATASET (FILE-ID-ERPNDB)
 15437*        FROM    (PENDING-BUSINESS)
 15438*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 281
* EL6311.cbl
 15439     MOVE LENGTH OF
 15440      PENDING-BUSINESS
 15441       TO DFHEIV11
 15442*    MOVE '&& L                  %   #00013747' TO DFHEIV0
 15443     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15444     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15445     MOVE X'2020233030303133373437' TO DFHEIV0(25:11)
 15446     CALL 'kxdfhei1' USING DFHEIV0,
 15447           FILE-ID-ERPNDB,
 15448           PENDING-BUSINESS,
 15449           DFHEIV11,
 15450           DFHEIV99
 15451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15452
 15453
 15454     PERFORM 8400-LOG-JOURNAL-RECORD.
 15455
 15456******************************************************************
 15457*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15458******************************************************************
 15459
 15460     display ' made it to update orig cancel cert '
 15461
 15462     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15463     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15464     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15465     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15466
 15467
 15468* EXEC CICS READ
 15469*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15470*        DATASET (FILE-ID-ELCERT)
 15471*        RIDFLD  (ELCERT-KEY)
 15472*        RESP    (WS-RESPONSE)
 15473*    END-EXEC.
 15474*    MOVE '&"S        E          (  N#00013765' TO DFHEIV0
 15475     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15476     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15477     MOVE X'204E233030303133373635' TO DFHEIV0(25:11)
 15478     CALL 'kxdfhei1' USING DFHEIV0,
 15479           FILE-ID-ELCERT,
 15480           DFHEIV20,
 15481           DFHEIV99,
 15482           ELCERT-KEY,
 15483           DFHEIV99,
 15484           DFHEIV99,
 15485           DFHEIV99
 15486     SET ADDRESS OF CERTIFICATE-MASTER TO
 15487         DFHEIV20
 15488     MOVE EIBRESP  TO WS-RESPONSE
 15489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15490
 15491
 15492     IF NOT RESP-NORMAL
 15493        GO TO 2376-BYPASS-CRTO
 15494     END-IF
 15495
 15496
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 282
* EL6311.cbl
 15497     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15498     MOVE ' '                    TO WS-ERMAIL-SW
 15499
 15500
 15501* EXEC CICS READ
 15502*       DATASET   (FILE-ID-ERMAIL)
 15503*       SET       (ADDRESS OF MAILING-DATA)
 15504*       RIDFLD    (ERMAIL-KEY)
 15505*       RESP      (WS-RESPONSE)
 15506*    END-EXEC
 15507*    MOVE '&"S        E          (  N#00013780' TO DFHEIV0
 15508     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15510     MOVE X'204E233030303133373830' TO DFHEIV0(25:11)
 15511     CALL 'kxdfhei1' USING DFHEIV0,
 15512           FILE-ID-ERMAIL,
 15513           DFHEIV20,
 15514           DFHEIV99,
 15515           ERMAIL-KEY,
 15516           DFHEIV99,
 15517           DFHEIV99,
 15518           DFHEIV99
 15519     SET ADDRESS OF MAILING-DATA TO
 15520         DFHEIV20
 15521     MOVE EIBRESP  TO WS-RESPONSE
 15522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15523
 15524     IF RESP-NORMAL
 15525        SET ERMAIL-FOUND TO TRUE
 15526     END-IF
 15527
 15528     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15529
 15530     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15531                                 TO ELCRTO-KEY
 15532     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15533     MOVE +0                     TO ELCRTO-SEQ-NO
 15534
 15535
 15536* EXEC CICS READ
 15537*       DATASET   ('ELCRTO')
 15538*       INTO      (ORIGINAL-CERTIFICATE)
 15539*       RIDFLD    (ELCRTO-KEY)
 15540*       GTEQ
 15541*       RESP      (WS-RESPONSE)
 15542*    END-EXEC
 15543     MOVE LENGTH OF
 15544      ORIGINAL-CERTIFICATE
 15545       TO DFHEIV11
 15546     MOVE 'ELCRTO' TO DFHEIV1
 15547*    MOVE '&"IL       G          (  N#00013798' TO DFHEIV0
 15548     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15549     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15550     MOVE X'204E233030303133373938' TO DFHEIV0(25:11)
 15551     CALL 'kxdfhei1' USING DFHEIV0,
 15552           DFHEIV1,
 15553           ORIGINAL-CERTIFICATE,
 15554           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 283
* EL6311.cbl
 15555           ELCRTO-KEY,
 15556           DFHEIV99,
 15557           DFHEIV99,
 15558           DFHEIV99
 15559     MOVE EIBRESP  TO WS-RESPONSE
 15560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15561
 15562     display ' just read gteq ' ws-response
 15563     IF RESP-NORMAL
 15564        AND (OC-CONTROL-PRIMARY (1:33) =
 15565                 PB-CONTROL-BY-ACCOUNT (1:33))
 15566        AND (OC-RECORD-TYPE = 'I')
 15567        display ' resp norm, key =, type i '
 15568        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15569           display ' end proc blank '
 15570           display ' csr edit session ' PI-CSR-SESSION-SW
 15571           IF NOT CSR-EDIT-SESSION
 15572
 15573* EXEC CICS READ
 15574*                DATASET   ('ELCRTO')
 15575*                INTO      (ORIGINAL-CERTIFICATE)
 15576*                RIDFLD    (OC-CONTROL-PRIMARY)
 15577*                UPDATE
 15578*                RESP      (WS-RESPONSE)
 15579*             END-EXEC
 15580     MOVE LENGTH OF
 15581      ORIGINAL-CERTIFICATE
 15582       TO DFHEIV11
 15583     MOVE 'ELCRTO' TO DFHEIV1
 15584*    MOVE '&"IL       EU         (  N#00013816' TO DFHEIV0
 15585     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15586     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15587     MOVE X'204E233030303133383136' TO DFHEIV0(25:11)
 15588     CALL 'kxdfhei1' USING DFHEIV0,
 15589           DFHEIV1,
 15590           ORIGINAL-CERTIFICATE,
 15591           DFHEIV11,
 15592           OC-CONTROL-PRIMARY,
 15593           DFHEIV99,
 15594           DFHEIV99,
 15595           DFHEIV99
 15596     MOVE EIBRESP  TO WS-RESPONSE
 15597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15598              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15599              IF RESP-NORMAL
 15600                 display ' good read upd '
 15601                 IF OC-ISSUE-TRAN-IND = 'N'
 15602                    MOVE CM-INSURED-LAST-NAME   TO
 15603                         OC-INS-LAST-NAME
 15604                    MOVE CM-INSURED-FIRST-NAME  TO
 15605                         OC-INS-FIRST-NAME
 15606                    MOVE CM-INSURED-INITIAL2    TO
 15607                         OC-INS-MIDDLE-INIT
 15608                    MOVE CM-INSURED-ISSUE-AGE   TO
 15609                         OC-INS-AGE
 15610                    MOVE CM-JT-LAST-NAME        TO
 15611                         OC-JNT-LAST-NAME
 15612                    MOVE CM-JT-FIRST-NAME       TO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 284
* EL6311.cbl
 15613                         OC-JNT-FIRST-NAME
 15614                    MOVE CM-JT-INITIAL          TO
 15615                         OC-JNT-MIDDLE-INIT
 15616                    MOVE CM-INSURED-JOINT-AGE   TO
 15617                         OC-JNT-AGE
 15618                    MOVE CM-LF-BENEFIT-CD       TO
 15619                         OC-LF-BENCD
 15620                    MOVE CM-LF-ORIG-TERM        TO
 15621                         OC-LF-TERM
 15622                    MOVE CM-LF-BENEFIT-AMT      TO
 15623                         OC-LF-BEN-AMT
 15624                    MOVE CM-LF-PREMIUM-AMT      TO
 15625                         OC-LF-PRM-AMT
 15626                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15627                         OC-LF-ALT-BEN-AMT
 15628                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15629                         OC-LF-ALT-PRM-AMT
 15630                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15631                         OC-LF-EXP-DT
 15632                    MOVE CM-LIFE-COMM-PCT       TO
 15633                         OC-LF-COMM-PCT
 15634                    MOVE CM-AH-BENEFIT-CD       TO
 15635                         OC-AH-BENCD
 15636                    MOVE CM-AH-ORIG-TERM        TO
 15637                         OC-AH-TERM
 15638                    MOVE CM-AH-BENEFIT-AMT      TO
 15639                         OC-AH-BEN-AMT
 15640                    MOVE CM-AH-PREMIUM-AMT      TO
 15641                         OC-AH-PRM-AMT
 15642                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15643                         OC-AH-EXP-DT
 15644                    MOVE CM-AH-COMM-PCT         TO
 15645                         OC-AH-COMM-PCT
 15646                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15647                         OC-AH-CP
 15648                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15649                         OC-1ST-PMT-DT
 15650                 END-IF
 15651                 MOVE PB-C-LF-CANCEL-DT      TO
 15652                         OC-LF-CANCEL-DT
 15653                 MOVE PB-C-LF-CANCEL-AMT     TO
 15654                         OC-LF-CANCEL-AMT
 15655                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15656                         OC-LF-ITD-CANCEL-AMT
 15657                 MOVE PB-C-AH-CANCEL-DT      TO
 15658                         OC-AH-CANCEL-DT
 15659                 MOVE PB-C-AH-CANCEL-AMT     TO
 15660                         OC-AH-CANCEL-AMT
 15661                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15662                         OC-AH-ITD-CANCEL-AMT
 15663                 MOVE 'Y'                    TO
 15664                         OC-CANCEL-TRAN-IND
 15665                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15666                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15667                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15668                 IF ERMAIL-FOUND
 15669                    MOVE MA-CRED-BENE-NAME
 15670                                 TO OC-CRED-BENE-NAME
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 285
* EL6311.cbl
 15671                 END-IF
 15672                 IF NOT CERT-TRL-REC-NOT-FOUND
 15673                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15674                           OC-INS-AGE-DEFAULT-FLAG
 15675                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15676                           OC-JNT-AGE-DEFAULT-FLAG
 15677                 END-IF
 15678
 15679* EXEC CICS REWRITE
 15680*                   DATASET   ('ELCRTO')
 15681*                   FROM      (ORIGINAL-CERTIFICATE)
 15682*                   RESP      (WS-RESPONSE)
 15683*                END-EXEC
 15684     MOVE LENGTH OF
 15685      ORIGINAL-CERTIFICATE
 15686       TO DFHEIV11
 15687     MOVE 'ELCRTO' TO DFHEIV1
 15688*    MOVE '&& L                  %  N#00013903' TO DFHEIV0
 15689     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15690     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15691     MOVE X'204E233030303133393033' TO DFHEIV0(25:11)
 15692     CALL 'kxdfhei1' USING DFHEIV0,
 15693           DFHEIV1,
 15694           ORIGINAL-CERTIFICATE,
 15695           DFHEIV11,
 15696           DFHEIV99
 15697     MOVE EIBRESP  TO WS-RESPONSE
 15698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15699                 display ' just rewrote ' ws-response
 15700              END-IF
 15701           END-IF
 15702        ELSE
 15703           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15704           MOVE 'OC'             TO OC-RECORD-ID
 15705           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15706           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15707           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15708           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15709           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15710           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15711           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15712           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15713           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15714           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15715           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15716           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15717           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15718           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15719           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15720           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15721           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15722           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15723           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15724           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15725           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15726           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15727           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15728           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 286
* EL6311.cbl
 15729           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15730           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15731           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15732           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15733           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15734           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15735           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15736           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15737           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15738           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15739           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15740           IF ERMAIL-FOUND
 15741              MOVE MA-CRED-BENE-NAME
 15742                                 TO OC-CRED-BENE-NAME
 15743           END-IF
 15744           IF NOT CERT-TRL-REC-NOT-FOUND
 15745              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15746                           OC-INS-AGE-DEFAULT-FLAG
 15747              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15748                           OC-JNT-AGE-DEFAULT-FLAG
 15749           END-IF
 15750           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15751
 15752* EXEC CICS WRITE
 15753*             DATASET   ('ELCRTO')
 15754*             FROM      (ORIGINAL-CERTIFICATE)
 15755*             RIDFLD    (OC-CONTROL-PRIMARY)
 15756*             RESP      (WS-RESPONSE)
 15757*          END-EXEC
 15758     MOVE LENGTH OF
 15759      ORIGINAL-CERTIFICATE
 15760       TO DFHEIV11
 15761     MOVE 'ELCRTO' TO DFHEIV1
 15762*    MOVE '&$ L                  ''  N#00013960' TO DFHEIV0
 15763     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15764     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15765     MOVE X'204E233030303133393630' TO DFHEIV0(25:11)
 15766     CALL 'kxdfhei1' USING DFHEIV0,
 15767           DFHEIV1,
 15768           ORIGINAL-CERTIFICATE,
 15769           DFHEIV11,
 15770           OC-CONTROL-PRIMARY,
 15771           DFHEIV99,
 15772           DFHEIV99
 15773     MOVE EIBRESP  TO WS-RESPONSE
 15774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15775        END-IF
 15776     ELSE
 15777        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15778        MOVE 'OC'                TO OC-RECORD-ID
 15779        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15780                                 TO OC-CONTROL-PRIMARY (1:33)
 15781        MOVE 'I'                 TO OC-RECORD-TYPE
 15782        MOVE +4096               TO OC-KEY-SEQ-NO
 15783        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15784        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15785        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15786        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 287
* EL6311.cbl
 15787        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15788        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15789        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15790        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15791        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15792        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15793        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15794        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15795        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15796        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15797        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15798        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15799        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15800        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15801        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15802        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15803        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15804        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15805        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15806        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15807        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15808        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15809        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15810        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15811        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15812        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15813        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15814        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15815        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15816        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15817        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15818        IF ERMAIL-FOUND
 15819           MOVE MA-CRED-BENE-NAME
 15820                                 TO OC-CRED-BENE-NAME
 15821        END-IF
 15822        IF NOT CERT-TRL-REC-NOT-FOUND
 15823           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15824                           OC-INS-AGE-DEFAULT-FLAG
 15825           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15826                           OC-JNT-AGE-DEFAULT-FLAG
 15827        END-IF
 15828        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15829
 15830
 15831* EXEC CICS WRITE
 15832*          DATASET   ('ELCRTO')
 15833*          FROM      (ORIGINAL-CERTIFICATE)
 15834*          RIDFLD    (OC-CONTROL-PRIMARY)
 15835*          RESP      (WS-RESPONSE)
 15836*       END-EXEC
 15837     MOVE LENGTH OF
 15838      ORIGINAL-CERTIFICATE
 15839       TO DFHEIV11
 15840     MOVE 'ELCRTO' TO DFHEIV1
 15841*    MOVE '&$ L                  ''  N#00014021' TO DFHEIV0
 15842     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15843     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15844     MOVE X'204E233030303134303231' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 288
* EL6311.cbl
 15845     CALL 'kxdfhei1' USING DFHEIV0,
 15846           DFHEIV1,
 15847           ORIGINAL-CERTIFICATE,
 15848           DFHEIV11,
 15849           OC-CONTROL-PRIMARY,
 15850           DFHEIV99,
 15851           DFHEIV99
 15852     MOVE EIBRESP  TO WS-RESPONSE
 15853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15854     END-IF.
 15855
 15856 2376-BYPASS-CRTO.
 15857******************************************************************
 15858*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15859******************************************************************
 15860
 15861
 15862* EXEC CICS HANDLE CONDITION
 15863*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15864*    END-EXEC.
 15865*    MOVE '"$I                   ! 7 #00014034' TO DFHEIV0
 15866     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15868     MOVE X'3720233030303134303334' TO DFHEIV0(25:11)
 15869     CALL 'kxdfhei1' USING DFHEIV0
 15870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15871
 15872
 15873
 15874* EXEC CICS READ
 15875*        INTO    (PENDING-BUSINESS)
 15876*        DATASET (FILE-ID-ERPNDB)
 15877*        RIDFLD  (ERPNDB-KEY)
 15878*        UPDATE
 15879*    END-EXEC.
 15880     MOVE LENGTH OF
 15881      PENDING-BUSINESS
 15882       TO DFHEIV11
 15883*    MOVE '&"IL       EU         (   #00014038' TO DFHEIV0
 15884     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15885     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15886     MOVE X'2020233030303134303338' TO DFHEIV0(25:11)
 15887     CALL 'kxdfhei1' USING DFHEIV0,
 15888           FILE-ID-ERPNDB,
 15889           PENDING-BUSINESS,
 15890           DFHEIV11,
 15891           ERPNDB-KEY,
 15892           DFHEIV99,
 15893           DFHEIV99,
 15894           DFHEIV99
 15895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15896
 15897
 15898     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15899     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15900     MOVE 'B'                    TO JP-RECORD-TYPE.
 15901     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15902
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 289
* EL6311.cbl
 15903     PERFORM 8400-LOG-JOURNAL-RECORD.
 15904
 15905     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15906
 15907
 15908* EXEC CICS REWRITE
 15909*        DATASET (FILE-ID-ERPNDB)
 15910*        FROM    (PENDING-BUSINESS)
 15911*    END-EXEC.
 15912     MOVE LENGTH OF
 15913      PENDING-BUSINESS
 15914       TO DFHEIV11
 15915*    MOVE '&& L                  %   #00014054' TO DFHEIV0
 15916     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15917     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15918     MOVE X'2020233030303134303534' TO DFHEIV0(25:11)
 15919     CALL 'kxdfhei1' USING DFHEIV0,
 15920           FILE-ID-ERPNDB,
 15921           PENDING-BUSINESS,
 15922           DFHEIV11,
 15923           DFHEIV99
 15924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15925
 15926
 15927     MOVE 'C'                    TO JP-RECORD-TYPE.
 15928     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15929
 15930     PERFORM 8400-LOG-JOURNAL-RECORD.
 15931
 15932     IF WS-ERRORS-PRESENT
 15933         GO TO 3900-RE-DISPLAY-RECORD.
 15934
 15935     MOVE ZEROS                  TO EMI-ERROR
 15936     MOVE -1                     TO CMAINTL
 15937     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15938     GO TO 3900-RE-DISPLAY-RECORD.
 15939
 15940 2380-BATCH-HDR-NOT-FOUND.
 15941     MOVE -1                     TO BMAINTL.
 15942     MOVE ER-7450                TO EMI-ERROR.
 15943     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15944     GO TO 8200-SEND-DATAONLY.
 15945
 15946 2385-REC-NOT-FOUND.
 15947     MOVE -1                     TO BMAINTL.
 15948     MOVE ER-7451                TO EMI-ERROR.
 15949     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15950     GO TO 8200-SEND-DATAONLY.
 15951
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 290
* EL6311.cbl
 15953
 15954******************************************************************
 15955*                                                                *
 15956*          D E L E T E   C A N C E L   R O U T I N E             *
 15957*                                                                *
 15958******************************************************************
 15959
 15960 2400-DELETE-CANCEL-ROUTINE.
 15961     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15962
 15963     IF CCHGL NOT = ZEROS
 15964        MOVE ER-2196             TO EMI-ERROR
 15965        MOVE AL-UABON            TO CMAINTA
 15966        MOVE -1                  TO CMAINTL
 15967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15968        GO TO 8200-SEND-DATAONLY.
 15969
 15970
 15971* EXEC CICS HANDLE CONDITION
 15972*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15973*    END-EXEC.
 15974*    MOVE '"$I                   ! 8 #00014102' TO DFHEIV0
 15975     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15976     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15977     MOVE X'3820233030303134313032' TO DFHEIV0(25:11)
 15978     CALL 'kxdfhei1' USING DFHEIV0
 15979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15980
 15981
 15982     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15983     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15984     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15985
 15986
 15987* EXEC CICS READ
 15988*        SET     (ADDRESS OF PENDING-BUSINESS)
 15989*        DATASET (FILE-ID-ERPNDB)
 15990*        RIDFLD  (ERPNDB-KEY)
 15991*    END-EXEC.
 15992*    MOVE '&"S        E          (   #00014110' TO DFHEIV0
 15993     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15995     MOVE X'2020233030303134313130' TO DFHEIV0(25:11)
 15996     CALL 'kxdfhei1' USING DFHEIV0,
 15997           FILE-ID-ERPNDB,
 15998           DFHEIV20,
 15999           DFHEIV99,
 16000           ERPNDB-KEY,
 16001           DFHEIV99,
 16002           DFHEIV99,
 16003           DFHEIV99
 16004     SET ADDRESS OF PENDING-BUSINESS TO
 16005         DFHEIV20
 16006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16007
 16008
 16009     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16010
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 291
* EL6311.cbl
 16011     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16012
 16013     IF CSUFIXL NOT = ZEROS
 16014        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16015     ELSE
 16016        MOVE SPACE               TO WS-NEW-SUFFIX.
 16017
 16018     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16019
 16020     PERFORM 8600-DEEDIT.
 16021     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16022     MOVE '4'                    TO DC-OPTION-CODE.
 16023     PERFORM 9700-DATE-LINK.
 16024
 16025     IF DATE-CONVERSION-ERROR
 16026        MOVE ER-0348             TO EMI-ERROR
 16027        MOVE -1                  TO CEFFDTL
 16028        MOVE AL-UABON            TO CEFFDTA
 16029        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16030        GO TO 8200-SEND-DATAONLY
 16031     ELSE
 16032        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16033        MOVE AL-UANON            TO CEFFDTA
 16034        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16035
 16036
 16037* EXEC CICS HANDLE CONDITION
 16038*         NOTFND    (2490-RECORD-NOT-FOUND)
 16039*    END-EXEC.
 16040*    MOVE '"$I                   ! 9 #00014143' TO DFHEIV0
 16041     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16042     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16043     MOVE X'3920233030303134313433' TO DFHEIV0(25:11)
 16044     CALL 'kxdfhei1' USING DFHEIV0
 16045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16046
 16047
 16048
 16049* EXEC CICS READ
 16050*        SET     (ADDRESS OF PENDING-BUSINESS)
 16051*        DATASET (FILE-ID-ERPNDB)
 16052*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16053*        UPDATE
 16054*    END-EXEC.
 16055*    MOVE '&"S        EU         (   #00014147' TO DFHEIV0
 16056     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16057     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16058     MOVE X'2020233030303134313437' TO DFHEIV0(25:11)
 16059     CALL 'kxdfhei1' USING DFHEIV0,
 16060           FILE-ID-ERPNDB,
 16061           DFHEIV20,
 16062           DFHEIV99,
 16063           PI-PREV-CONTROL-PRIMARY,
 16064           DFHEIV99,
 16065           DFHEIV99,
 16066           DFHEIV99
 16067     SET ADDRESS OF PENDING-BUSINESS TO
 16068         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 292
* EL6311.cbl
 16069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16070
 16071
 16072     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16073        MOVE -1                 TO CMAINTL
 16074        MOVE ER-2197            TO EMI-ERROR
 16075        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16076        GO TO 8200-SEND-DATAONLY.
 16077
 16078     IF PB-BILLED-DT NOT = LOW-VALUES
 16079        MOVE -1                 TO CMAINTL
 16080        MOVE ER-2129            TO EMI-ERROR
 16081        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16082        GO TO 8200-SEND-DATAONLY.
 16083
 16084     IF PB-CHG-COUNT NOT = ZEROS
 16085        MOVE ER-2336            TO EMI-ERROR
 16086        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16087        MOVE AL-UABON            TO CMAINTA
 16088        MOVE -1                  TO CMAINTL
 16089        GO TO 8200-SEND-DATAONLY.
 16090
 16091     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16092        PB-CHG-COUNT NOT = ZEROS
 16093        MOVE ER-2196             TO EMI-ERROR
 16094        MOVE AL-UABON            TO CMAINTA
 16095        MOVE -1                  TO CMAINTL
 16096        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16097        GO TO 8200-SEND-DATAONLY.
 16098
 16099     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16100        MOVE ER-2900 TO EMI-ERROR
 16101        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16102        MOVE AL-UABON         TO CMAINTA
 16103        MOVE -1               TO CMAINTL
 16104        GO TO 8200-SEND-DATAONLY.
 16105     move ' '                    to ws-stop-sw
 16106                                    ws-check-sw
 16107                                    ws-proc-check-sw
 16108                                    ws-chek-browse-sw
 16109
 16110     perform 2500-browse-checks  thru 2500-exit
 16111     if i-have-processed-checks
 16112        move er-3446             to emi-error
 16113        perform 9900-error-format thru 9900-exit
 16114        move al-uabon            to cmainta
 16115        move -1                  to cmaintl
 16116        go to 8200-send-dataonly
 16117     end-if
 16118
 16119* EXEC CICS HANDLE CONDITION
 16120*         NOTFND  (2475-CONTINUE-DELETE)
 16121*    END-EXEC
 16122*    MOVE '"$I                   ! : #00014200' TO DFHEIV0
 16123     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16124     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16125     MOVE X'3A20233030303134323030' TO DFHEIV0(25:11)
 16126     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 293
* EL6311.cbl
 16127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16128
 16129     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16130     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16131     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16132     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16133
 16134
 16135* EXEC CICS READ
 16136*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16137*        DATASET (FILE-ID-ELCERT)
 16138*        RIDFLD  (ELCERT-KEY)
 16139*        UPDATE
 16140*    END-EXEC.
 16141*    MOVE '&"S        EU         (   #00014209' TO DFHEIV0
 16142     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16143     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16144     MOVE X'2020233030303134323039' TO DFHEIV0(25:11)
 16145     CALL 'kxdfhei1' USING DFHEIV0,
 16146           FILE-ID-ELCERT,
 16147           DFHEIV20,
 16148           DFHEIV99,
 16149           ELCERT-KEY,
 16150           DFHEIV99,
 16151           DFHEIV99,
 16152           DFHEIV99
 16153     SET ADDRESS OF CERTIFICATE-MASTER TO
 16154         DFHEIV20
 16155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16156
 16157
 16158     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16159
 16160     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16161     MOVE 'B'                    TO JP-RECORD-TYPE.
 16162     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16163     PERFORM 8400-LOG-JOURNAL-RECORD.
 16164
 16165     IF PB-CI-LIVES NOT NUMERIC
 16166         MOVE ZERO                    TO PB-CI-LIVES.
 16167
 16168     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16169        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16170           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16171           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16172           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16173                                            CM-LF-CANCEL-DT
 16174           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16175        ELSE
 16176           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16177           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16178           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16179           MOVE PB-CI-LIVES              TO CM-LIVES.
 16180
 16181     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16182        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16183           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16184               MOVE CM-LF-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 294
* EL6311.cbl
 16185                                        TO CM-LF-CURRENT-STATUS
 16186               MOVE SPACE
 16187                                        TO CM-LF-STATUS-AT-CANCEL
 16188           ELSE
 16189               MOVE PB-CI-LF-POLICY-STATUS
 16190                                        TO CM-LF-CURRENT-STATUS
 16191        ELSE
 16192           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16193
 16194
 16195     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16196        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16197           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16198           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16199           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16200                                            CM-AH-CANCEL-DT
 16201           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16202        ELSE
 16203           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16204           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16205           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16206           MOVE PB-CI-LIVES              TO CM-LIVES.
 16207
 16208     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16209        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16210           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16211               MOVE CM-AH-STATUS-AT-CANCEL
 16212                                        TO CM-AH-CURRENT-STATUS
 16213               MOVE SPACE
 16214                                        TO CM-AH-STATUS-AT-CANCEL
 16215           ELSE
 16216               MOVE PB-CI-AH-POLICY-STATUS
 16217                                        TO CM-AH-CURRENT-STATUS
 16218        ELSE
 16219           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16220
 16221 2450-REWRITE-CERT.
 16222     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16223     MOVE 'C'                      TO JP-RECORD-TYPE.
 16224     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16225
 16226
 16227* EXEC CICS REWRITE
 16228*        DATASET  (FILE-ID-ELCERT)
 16229*        FROM     (CERTIFICATE-MASTER)
 16230*    END-EXEC.
 16231     MOVE LENGTH OF
 16232      CERTIFICATE-MASTER
 16233       TO DFHEIV11
 16234*    MOVE '&& L                  %   #00014284' TO DFHEIV0
 16235     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16236     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16237     MOVE X'2020233030303134323834' TO DFHEIV0(25:11)
 16238     CALL 'kxdfhei1' USING DFHEIV0,
 16239           FILE-ID-ELCERT,
 16240           CERTIFICATE-MASTER,
 16241           DFHEIV11,
 16242           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 295
* EL6311.cbl
 16243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16244
 16245
 16246     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16247
 16248     PERFORM 8400-LOG-JOURNAL-RECORD.
 16249
 16250     move ' '                    to ws-stop-sw
 16251                                    ws-proc-check-sw
 16252
 16253     if i-have-checks
 16254        perform until i-say-stop
 16255           perform 2510-startbr-erchek
 16256                                 thru 2510-exit
 16257           if resp-normal
 16258              perform 2520-readnext-erchek
 16259                                 thru 2520-exit
 16260           end-if
 16261           if (not resp-normal)
 16262              or (pb-control-by-account (1:33) not =
 16263                 ch-control-primary (1:33))
 16264                 set i-say-stop to true
 16265           else
 16266              perform 2530-readupd-erchek
 16267                                 thru 2530-exit
 16268              if resp-normal
 16269                 perform 2540-delete-erchek
 16270                                 thru 2540-exit
 16271              end-if
 16272              if ws-chek-browse-sw = 'Y'
 16273                 perform 2525-endbr-erchek
 16274                                 thru 2525-exit
 16275                 move ' '        to ws-chek-browse-sw
 16276              end-if
 16277           end-if
 16278        end-perform
 16279     end-if
 16280
 16281     if ws-chek-browse-sw = 'Y'
 16282        perform 2525-endbr-erchek thru 2525-exit
 16283     end-if
 16284     .
 16285 2475-CONTINUE-DELETE.
 16286     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16287     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16288
 16289     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16290     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16291
 16292     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16293
 16294     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16295     MOVE 'D'                    TO JP-RECORD-TYPE
 16296     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16297
 16298
 16299* EXEC CICS DELETE
 16300*        DATASET    (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 296
* EL6311.cbl
 16301*    END-EXEC.
 16302*    MOVE '&(                    &   #00014341' TO DFHEIV0
 16303     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16304     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16305     MOVE X'2020233030303134333431' TO DFHEIV0(25:11)
 16306     CALL 'kxdfhei1' USING DFHEIV0,
 16307           FILE-ID-ERPNDB,
 16308           DFHEIV99,
 16309           DFHEIV99,
 16310           DFHEIV99,
 16311           DFHEIV99
 16312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16313
 16314
 16315     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16316
 16317     PERFORM 8400-LOG-JOURNAL-RECORD.
 16318
 16319     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16320     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16321
 16322
 16323* EXEC CICS HANDLE CONDITION
 16324*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16325*    END-EXEC.
 16326*    MOVE '"$I                   ! ; #00014352' TO DFHEIV0
 16327     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16329     MOVE X'3B20233030303134333532' TO DFHEIV0(25:11)
 16330     CALL 'kxdfhei1' USING DFHEIV0
 16331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16332
 16333
 16334
 16335* EXEC CICS READ
 16336*        SET     (ADDRESS OF PENDING-BUSINESS)
 16337*        DATASET (FILE-ID-ERPNDB)
 16338*        RIDFLD  (ERPNDB-KEY)
 16339*        UPDATE
 16340*    END-EXEC.
 16341*    MOVE '&"S        EU         (   #00014356' TO DFHEIV0
 16342     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16343     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16344     MOVE X'2020233030303134333536' TO DFHEIV0(25:11)
 16345     CALL 'kxdfhei1' USING DFHEIV0,
 16346           FILE-ID-ERPNDB,
 16347           DFHEIV20,
 16348           DFHEIV99,
 16349           ERPNDB-KEY,
 16350           DFHEIV99,
 16351           DFHEIV99,
 16352           DFHEIV99
 16353     SET ADDRESS OF PENDING-BUSINESS TO
 16354         DFHEIV20
 16355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16356
 16357
 16358     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 297
* EL6311.cbl
 16359     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16360
 16361     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16362        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16363        MOVE 'D'                 TO JP-RECORD-TYPE
 16364        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16365
 16366* EXEC CICS DELETE
 16367*            DATASET    (FILE-ID-ERPNDB)
 16368*       END-EXEC
 16369*    MOVE '&(                    &   #00014370' TO DFHEIV0
 16370     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16371     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16372     MOVE X'2020233030303134333730' TO DFHEIV0(25:11)
 16373     CALL 'kxdfhei1' USING DFHEIV0,
 16374           FILE-ID-ERPNDB,
 16375           DFHEIV99,
 16376           DFHEIV99,
 16377           DFHEIV99,
 16378           DFHEIV99
 16379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16380        PERFORM 8400-LOG-JOURNAL-RECORD
 16381     ELSE
 16382        MOVE 'B'                 TO JP-RECORD-TYPE
 16383        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16384        PERFORM 8400-LOG-JOURNAL-RECORD
 16385        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16386        MOVE 'C'                 TO JP-RECORD-TYPE
 16387        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16388
 16389* EXEC CICS REWRITE
 16390*            DATASET    (FILE-ID-ERPNDB)
 16391*            FROM       (PENDING-BUSINESS)
 16392*       END-EXEC
 16393     MOVE LENGTH OF
 16394      PENDING-BUSINESS
 16395       TO DFHEIV11
 16396*    MOVE '&& L                  %   #00014381' TO DFHEIV0
 16397     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16398     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16399     MOVE X'2020233030303134333831' TO DFHEIV0(25:11)
 16400     CALL 'kxdfhei1' USING DFHEIV0,
 16401           FILE-ID-ERPNDB,
 16402           PENDING-BUSINESS,
 16403           DFHEIV11,
 16404           DFHEIV99
 16405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16406        PERFORM 8400-LOG-JOURNAL-RECORD.
 16407
 16408******************************************************************
 16409*                                                                *
 16410*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16411*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16412*                                                                *
 16413******************************************************************
 16414
 16415     IF NOT PI-AR-PROCESSING
 16416        GO TO 2480-DELETE-FINISHED.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 298
* EL6311.cbl
 16417
 16418     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16419        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16420        NEXT SENTENCE
 16421     ELSE
 16422        GO TO 2480-DELETE-FINISHED.
 16423
 16424
 16425* EXEC CICS HANDLE CONDITION
 16426*         NOTFND    (2480-DELETE-FINISHED)
 16427*    END-EXEC.
 16428*    MOVE '"$I                   ! < #00014403' TO DFHEIV0
 16429     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16431     MOVE X'3C20233030303134343033' TO DFHEIV0(25:11)
 16432     CALL 'kxdfhei1' USING DFHEIV0
 16433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16434
 16435
 16436     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16437     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16438
 16439
 16440* EXEC CICS READ
 16441*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16442*        DATASET (FILE-ID-ERRQST)
 16443*        RIDFLD  (ERRQST-KEY)
 16444*        UPDATE
 16445*    END-EXEC.
 16446*    MOVE '&"S        EU         (   #00014410' TO DFHEIV0
 16447     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16448     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16449     MOVE X'2020233030303134343130' TO DFHEIV0(25:11)
 16450     CALL 'kxdfhei1' USING DFHEIV0,
 16451           FILE-ID-ERRQST,
 16452           DFHEIV20,
 16453           DFHEIV99,
 16454           ERRQST-KEY,
 16455           DFHEIV99,
 16456           DFHEIV99,
 16457           DFHEIV99
 16458     SET ADDRESS OF AR-REQUEST-RECORD TO
 16459         DFHEIV20
 16460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16461
 16462
 16463     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16464
 16465     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16466
 16467     MOVE 'D'                      TO JP-RECORD-TYPE.
 16468     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16469
 16470
 16471* EXEC CICS DELETE
 16472*         DATASET    (FILE-ID-ERRQST)
 16473*    END-EXEC.
 16474*    MOVE '&(                    &   #00014424' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 299
* EL6311.cbl
 16475     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16476     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16477     MOVE X'2020233030303134343234' TO DFHEIV0(25:11)
 16478     CALL 'kxdfhei1' USING DFHEIV0,
 16479           FILE-ID-ERRQST,
 16480           DFHEIV99,
 16481           DFHEIV99,
 16482           DFHEIV99,
 16483           DFHEIV99
 16484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16485
 16486
 16487     PERFORM 8400-LOG-JOURNAL-RECORD.
 16488
 16489 2480-DELETE-FINISHED.
 16490     MOVE ZEROS                  TO EMI-ERROR.
 16491     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16492     MOVE LOW-VALUES             TO EL631CI.
 16493     MOVE -1                     TO CMAINTL.
 16494     GO TO 8100-SEND-INITIAL-MAP.
 16495
 16496 2485-BATCH-HDR-NOT-FOUND.
 16497     MOVE -1                     TO CMAINTL
 16498     MOVE AL-UABON               TO CMAINTA.
 16499     MOVE ER-7450                TO EMI-ERROR.
 16500     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16501     GO TO 8200-SEND-DATAONLY.
 16502
 16503 2490-RECORD-NOT-FOUND.
 16504     MOVE -1                     TO CMAINTL
 16505     MOVE AL-UABON               TO CMAINTA.
 16506     MOVE ER-7451                TO EMI-ERROR.
 16507     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16508     GO TO 8200-SEND-DATAONLY.
 16509***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16510***                                                            ***
 16511***     2500  B R O W S E   C H E C K S                        ***
 16512***  We perform this routine from 2 different places.          ***
 16513***  1. If the user changes the refund amount on a cancel, we  ***
 16514***    want to.........                                        ***
 16515***    a. determine if prior checks have been processed        ***
 16516***    b. If the amt is larger, display message instructing    ***
 16517***     them to create another check to make up the difference.***
 16518***    c. If the amt is less, do not allow the change and      ***
 16519***     display a FATAL error suggesting they deal with check  ***
 16520***     records befor continuing.                              ***
 16521***  2. If the user wants to delete a cancel record we......   ***
 16522***    a. browse through all the checks and if there is a      ***
 16523***     processed check, send FATAL message.                   ***
 16524***    b. If there is a non-released check, then delete that   ***
 16525***     check after you delete the pending cancel record.      ***
 16526***                                                            ***
 16527***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16528
 16529 2500-browse-checks.
 16530
 16531     perform 2510-startbr-erchek thru 2510-exit
 16532
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 300
* EL6311.cbl
 16533     if not resp-normal
 16534        go to 2500-exit
 16535     end-if
 16536
 16537     perform until i-say-stop
 16538        perform 2520-readnext-erchek
 16539                                 thru 2520-exit
 16540        if (not resp-normal)
 16541           or (pb-control-by-account (1:33) not =
 16542              ch-control-primary (1:33))
 16543              set i-say-stop to true
 16544        else
 16545           if (ch-approval-status) = ' '
 16546              and (ch-void-dt = low-values)
 16547              and (ch-released-dt = low-values)
 16548              set i-have-checks to true
 16549           else
 16550              set i-have-processed-checks to true
 16551           end-if
 16552           if ch-credit-accept-dt = low-values
 16553              and ch-void-dt = low-values
 16554              and ch-approval-status = ' ' OR 'P' OR 'A'
 16555              compute ws-check-amts = ws-check-amts +
 16556                 ch-amount-paid
 16557           end-if
 16558        end-if
 16559     end-perform
 16560
 16561     if ws-chek-browse-sw = 'Y'
 16562        perform 2525-endbr-erchek thru 2525-exit
 16563     end-if
 16564
 16565    .
 16566 2500-exit.
 16567     exit.
 16568
 16569 2510-startbr-erchek.
 16570
 16571     move pb-control-by-account  to erchek-key
 16572     move +0                     to chek-record-seq
 16573
 16574
 16575* exec cics startbr
 16576*       dataset   ('ERCHEK')
 16577*       ridfld    (erchek-key)
 16578*       gteq
 16579*       resp      (ws-response)
 16580*    end-exec
 16581     MOVE 'ERCHEK' TO DFHEIV1
 16582     MOVE 0
 16583       TO DFHEIV11
 16584*    MOVE '&,         G          &  N#00014515' TO DFHEIV0
 16585     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16586     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16587     MOVE X'204E233030303134353135' TO DFHEIV0(25:11)
 16588     CALL 'kxdfhei1' USING DFHEIV0,
 16589           DFHEIV1,
 16590           erchek-key,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 301
* EL6311.cbl
 16591           DFHEIV99,
 16592           DFHEIV11,
 16593           DFHEIV99
 16594     MOVE EIBRESP  TO ws-response
 16595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16596
 16597     IF RESP-NORMAL
 16598        move 'Y'                 to ws-chek-browse-sw
 16599     end-if
 16600
 16601     .
 16602 2510-exit.
 16603     exit.
 16604
 16605 2520-readnext-erchek.
 16606
 16607
 16608* EXEC CICS READNEXT
 16609*       SET     (ADDRESS OF CHECK-RECORDS)
 16610*       DATASET ('ERCHEK')
 16611*       RIDFLD  (ERCHEK-KEY)
 16612*       RESP    (WS-RESPONSE)
 16613*    END-EXEC
 16614     MOVE 'ERCHEK' TO DFHEIV1
 16615     MOVE 0
 16616       TO DFHEIV11
 16617*    MOVE '&.S                   )  N#00014532' TO DFHEIV0
 16618     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16619     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16620     MOVE X'204E233030303134353332' TO DFHEIV0(25:11)
 16621     CALL 'kxdfhei1' USING DFHEIV0,
 16622           DFHEIV1,
 16623           DFHEIV20,
 16624           DFHEIV99,
 16625           ERCHEK-KEY,
 16626           DFHEIV99,
 16627           DFHEIV11,
 16628           DFHEIV99,
 16629           DFHEIV99
 16630     SET ADDRESS OF CHECK-RECORDS TO
 16631         DFHEIV20
 16632     MOVE EIBRESP  TO WS-RESPONSE
 16633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16634
 16635     .
 16636 2520-exit.
 16637     exit.
 16638
 16639 2525-endbr-erchek.
 16640
 16641
 16642* exec cics endbr
 16643*       dataset  ('ERCHEK')
 16644*    end-exec
 16645     MOVE 'ERCHEK' TO DFHEIV1
 16646     MOVE 0
 16647       TO DFHEIV11
 16648*    MOVE '&2                    $   #00014545' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 302
* EL6311.cbl
 16649     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16650     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16651     MOVE X'2020233030303134353435' TO DFHEIV0(25:11)
 16652     CALL 'kxdfhei1' USING DFHEIV0,
 16653           DFHEIV1,
 16654           DFHEIV11,
 16655           DFHEIV99
 16656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16657
 16658     .
 16659 2525-exit.
 16660     exit.
 16661
 16662 2530-readupd-erchek.
 16663
 16664
 16665* EXEC CICS READ
 16666*       UPDATE
 16667*       SET     (ADDRESS OF CHECK-RECORDS)
 16668*       DATASET ('ERCHEK')
 16669*       RIDFLD  (ERCHEK-KEY)
 16670*       RESP    (WS-RESPONSE)
 16671*    END-EXEC
 16672     MOVE 'ERCHEK' TO DFHEIV1
 16673*    MOVE '&"S        EU         (  N#00014555' TO DFHEIV0
 16674     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16675     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16676     MOVE X'204E233030303134353535' TO DFHEIV0(25:11)
 16677     CALL 'kxdfhei1' USING DFHEIV0,
 16678           DFHEIV1,
 16679           DFHEIV20,
 16680           DFHEIV99,
 16681           ERCHEK-KEY,
 16682           DFHEIV99,
 16683           DFHEIV99,
 16684           DFHEIV99
 16685     SET ADDRESS OF CHECK-RECORDS TO
 16686         DFHEIV20
 16687     MOVE EIBRESP  TO WS-RESPONSE
 16688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16689
 16690     .
 16691 2530-exit.
 16692     exit.
 16693
 16694 2540-delete-erchek.
 16695
 16696
 16697* EXEC CICS DELETE
 16698*       DATASET ('ERCHEK')
 16699*       RESP    (WS-RESPONSE)
 16700*    END-EXEC
 16701     MOVE 'ERCHEK' TO DFHEIV1
 16702*    MOVE '&(                    &  N#00014569' TO DFHEIV0
 16703     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16704     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16705     MOVE X'204E233030303134353639' TO DFHEIV0(25:11)
 16706     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 303
* EL6311.cbl
 16707           DFHEIV1,
 16708           DFHEIV99,
 16709           DFHEIV99,
 16710           DFHEIV99,
 16711           DFHEIV99
 16712     MOVE EIBRESP  TO WS-RESPONSE
 16713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16714
 16715     .
 16716 2540-exit.
 16717     exit.
 16718***************************************************************
 16719*                                                             *
 16720*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16721*                                                             *
 16722***************************************************************
 16723
 16724***************************************************************
 16725*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16726*     AN ALREADY BILLED RECORD.                               *
 16727***************************************************************
 16728
 16729 2700-BUILD-CORRECTION-RECORD.
 16730     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16731     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16732     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16733     MOVE '5'                    TO DC-OPTION-CODE.
 16734     PERFORM 9700-DATE-LINK.
 16735     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16736
 16737     IF PB-CHG-COUNT = ZEROS
 16738        MOVE +1                  TO WS-SEQ-SAVE
 16739     ELSE
 16740        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16741
 16742     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16743     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16744
 16745     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16746
 16747     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16748     MOVE 'A'                    TO JP-RECORD-TYPE.
 16749     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16750
 16751
 16752* EXEC CICS WRITE
 16753*        DATASET    (FILE-ID-ERPNDB)
 16754*        FROM       (PENDING-BUSINESS)
 16755*        RIDFLD     (PB-CONTROL-PRIMARY)
 16756*    END-EXEC.
 16757     MOVE LENGTH OF
 16758      PENDING-BUSINESS
 16759       TO DFHEIV11
 16760*    MOVE '&$ L                  ''   #00014610' TO DFHEIV0
 16761     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16762     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16763     MOVE X'2020233030303134363130' TO DFHEIV0(25:11)
 16764     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 304
* EL6311.cbl
 16765           FILE-ID-ERPNDB,
 16766           PENDING-BUSINESS,
 16767           DFHEIV11,
 16768           PB-CONTROL-PRIMARY,
 16769           DFHEIV99,
 16770           DFHEIV99
 16771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16772
 16773
 16774     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16775
 16776     PERFORM 8400-LOG-JOURNAL-RECORD.
 16777
 16778 2799-EXIT.
 16779      EXIT.
 16780
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 305
* EL6311.cbl
 16782
 16783******************************************************************
 16784*                                                                *
 16785*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16786*                                                                *
 16787******************************************************************
 16788
 16789 2800-REWRITE-ISSUE-CERT-KEY.
 16790     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16791
 16792     IF  BCERTNOL GREATER THAN ZEROS
 16793         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16794
 16795     IF  BSUFIXL  GREATER THAN ZEROS
 16796         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16797
 16798     IF  BEFFDTL  GREATER THAN ZEROS
 16799         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16800
 16801 2810-READ-BY-ACCOUNT.
 16802
 16803* EXEC CICS HANDLE CONDITION
 16804*         NOTFND    (2820-PROCESS-REWRITE)
 16805*    END-EXEC.
 16806*    MOVE '"$I                   ! = #00014644' TO DFHEIV0
 16807     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16808     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16809     MOVE X'3D20233030303134363434' TO DFHEIV0(25:11)
 16810     CALL 'kxdfhei1' USING DFHEIV0
 16811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16812
 16813
 16814
 16815* EXEC CICS READ
 16816*        SET     (ADDRESS OF PENDING-BUSINESS)
 16817*        DATASET (FILE-ID-ERPNDB2)
 16818*        RIDFLD  (ERPNDB-ALT-KEY)
 16819*    END-EXEC.
 16820*    MOVE '&"S        E          (   #00014648' TO DFHEIV0
 16821     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16823     MOVE X'2020233030303134363438' TO DFHEIV0(25:11)
 16824     CALL 'kxdfhei1' USING DFHEIV0,
 16825           FILE-ID-ERPNDB2,
 16826           DFHEIV20,
 16827           DFHEIV99,
 16828           ERPNDB-ALT-KEY,
 16829           DFHEIV99,
 16830           DFHEIV99,
 16831           DFHEIV99
 16832     SET ADDRESS OF PENDING-BUSINESS TO
 16833         DFHEIV20
 16834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16835
 16836
 16837     GO TO 2890-DUPLICATE-RECORD.
 16838
 16839  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 306
* EL6311.cbl
 16840
 16841* EXEC CICS HANDLE CONDITION
 16842*         NOTFND    (2885-RECORD-MISSING)
 16843*    END-EXEC.
 16844*    MOVE '"$I                   ! > #00014657' TO DFHEIV0
 16845     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16847     MOVE X'3E20233030303134363537' TO DFHEIV0(25:11)
 16848     CALL 'kxdfhei1' USING DFHEIV0
 16849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16850
 16851
 16852     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16853
 16854
 16855* EXEC CICS READ
 16856*        SET     (ADDRESS OF PENDING-BUSINESS)
 16857*        DATASET (FILE-ID-ERPNDB)
 16858*        RIDFLD  (ERPNDB-KEY)
 16859*        UPDATE
 16860*    END-EXEC.
 16861*    MOVE '&"S        EU         (   #00014663' TO DFHEIV0
 16862     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16863     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16864     MOVE X'2020233030303134363633' TO DFHEIV0(25:11)
 16865     CALL 'kxdfhei1' USING DFHEIV0,
 16866           FILE-ID-ERPNDB,
 16867           DFHEIV20,
 16868           DFHEIV99,
 16869           ERPNDB-KEY,
 16870           DFHEIV99,
 16871           DFHEIV99,
 16872           DFHEIV99
 16873     SET ADDRESS OF PENDING-BUSINESS TO
 16874         DFHEIV20
 16875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16876
 16877
 16878     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16879     MOVE 'D'                    TO JP-RECORD-TYPE.
 16880     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16881     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16882
 16883     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16884
 16885     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16886     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16887     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16888
 16889
 16890* EXEC CICS DELETE
 16891*        DATASET    (FILE-ID-ERPNDB)
 16892*    END-EXEC.
 16893*    MOVE '&(                    &   #00014681' TO DFHEIV0
 16894     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16895     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16896     MOVE X'2020233030303134363831' TO DFHEIV0(25:11)
 16897     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 307
* EL6311.cbl
 16898           FILE-ID-ERPNDB,
 16899           DFHEIV99,
 16900           DFHEIV99,
 16901           DFHEIV99,
 16902           DFHEIV99
 16903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16904
 16905
 16906     PERFORM 8400-LOG-JOURNAL-RECORD.
 16907
 16908
 16909* EXEC CICS GETMAIN
 16910*        SET      (ADDRESS OF PENDING-BUSINESS)
 16911*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16912*        INITIMG  (GETMAIN-SPACE)
 16913*    END-EXEC.
 16914*    MOVE ',"IL                  $   #00014687' TO DFHEIV0
 16915     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16916     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16917     MOVE X'2020233030303134363837' TO DFHEIV0(25:11)
 16918     CALL 'kxdfhei1' USING DFHEIV0,
 16919           DFHEIV20,
 16920           ERPNDB-RECORD-LENGTH,
 16921           GETMAIN-SPACE
 16922     SET ADDRESS OF PENDING-BUSINESS TO
 16923         DFHEIV20
 16924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16925
 16926
 16927     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16928
 16929
 16930* EXEC CICS HANDLE CONDITION
 16931*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16932*    END-EXEC.
 16933*    MOVE '"$I                   ! ? #00014695' TO DFHEIV0
 16934     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16936     MOVE X'3F20233030303134363935' TO DFHEIV0(25:11)
 16937     CALL 'kxdfhei1' USING DFHEIV0
 16938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16939
 16940
 16941
 16942* EXEC CICS READ
 16943*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16944*        DATASET (FILE-ID-ELCERT)
 16945*        RIDFLD  (ELCERT-KEY)
 16946*        UPDATE
 16947*    END-EXEC.
 16948*    MOVE '&"S        EU         (   #00014699' TO DFHEIV0
 16949     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16950     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16951     MOVE X'2020233030303134363939' TO DFHEIV0(25:11)
 16952     CALL 'kxdfhei1' USING DFHEIV0,
 16953           FILE-ID-ELCERT,
 16954           DFHEIV20,
 16955           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 308
* EL6311.cbl
 16956           ELCERT-KEY,
 16957           DFHEIV99,
 16958           DFHEIV99,
 16959           DFHEIV99
 16960     SET ADDRESS OF CERTIFICATE-MASTER TO
 16961         DFHEIV20
 16962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16963
 16964
 16965     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16966     MOVE 'B'                    TO JP-RECORD-TYPE
 16967     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16968     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16969
 16970     IF INSURED-ADDR-PRESENT
 16971        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16972
 16973     IF CERT-NOTES-ARE-NOT-PRESENT
 16974        MOVE SPACE               TO WS-CERT-NOTE-SW
 16975     ELSE
 16976        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16977
 16978     IF CERT-ADDED-BATCH      OR
 16979        CERT-AND-CLAIM-ONLINE OR
 16980        CERT-WAS-CREATED-FOR-CLAIM
 16981        NEXT SENTENCE
 16982     ELSE
 16983        GO TO 2825-DELETE-CERTIFICATE.
 16984
 16985     PERFORM 8400-LOG-JOURNAL-RECORD.
 16986
 16987*********************************************************
 16988** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16989     IF CERT-ADDED-BATCH
 16990         GO TO 2822-REWRITE-ELCERT.
 16991*********************************************************
 16992
 16993     IF NO-CLAIM-ATTACHED
 16994        NEXT SENTENCE
 16995     ELSE
 16996        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16997        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16998
 16999 2822-REWRITE-ELCERT.
 17000     MOVE 'C'                    TO JP-RECORD-TYPE
 17001     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17002
 17003     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17004
 17005
 17006* EXEC CICS REWRITE
 17007*         DATASET    (FILE-ID-ELCERT)
 17008*         FROM       (CERTIFICATE-MASTER)
 17009*    END-EXEC.
 17010     MOVE LENGTH OF
 17011      CERTIFICATE-MASTER
 17012       TO DFHEIV11
 17013*    MOVE '&& L                  %   #00014746' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 309
* EL6311.cbl
 17014     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17015     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17016     MOVE X'2020233030303134373436' TO DFHEIV0(25:11)
 17017     CALL 'kxdfhei1' USING DFHEIV0,
 17018           FILE-ID-ELCERT,
 17019           CERTIFICATE-MASTER,
 17020           DFHEIV11,
 17021           DFHEIV99
 17022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17023
 17024
 17025     PERFORM 8400-LOG-JOURNAL-RECORD.
 17026
 17027     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17028
 17029 2825-DELETE-CERTIFICATE.
 17030     MOVE 'D'                      TO JP-RECORD-TYPE.
 17031     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17032
 17033     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17034
 17035
 17036* EXEC CICS DELETE
 17037*         DATASET    (FILE-ID-ELCERT)
 17038*    END-EXEC.
 17039*    MOVE '&(                    &   #00014761' TO DFHEIV0
 17040     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17041     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17042     MOVE X'2020233030303134373631' TO DFHEIV0(25:11)
 17043     CALL 'kxdfhei1' USING DFHEIV0,
 17044           FILE-ID-ELCERT,
 17045           DFHEIV99,
 17046           DFHEIV99,
 17047           DFHEIV99,
 17048           DFHEIV99
 17049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17050
 17051
 17052     PERFORM 8400-LOG-JOURNAL-RECORD.
 17053
 17054******************************************************************
 17055*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17056******************************************************************
 17057
 17058     IF CERT-NOTES-ARE-PRESENT
 17059        NEXT SENTENCE
 17060     ELSE
 17061        GO TO 2827-DELETE-MAILING.
 17062
 17063
 17064* EXEC CICS HANDLE CONDITION
 17065*         NOTFND  (2827-DELETE-MAILING)
 17066*    END-EXEC.
 17067*    MOVE '"$I                   ! @ #00014776' TO DFHEIV0
 17068     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17069     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17070     MOVE X'4020233030303134373736' TO DFHEIV0(25:11)
 17071     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 310
* EL6311.cbl
 17072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17073
 17074
 17075
 17076* EXEC CICS READ
 17077*        EQUAL
 17078*        DATASET   (FILE-ID-ERNOTE)
 17079*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17080*        RIDFLD    (ELCERT-KEY)
 17081*        UPDATE
 17082*    END-EXEC.
 17083*    MOVE '&"S        EU         (   #00014780' TO DFHEIV0
 17084     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17085     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17086     MOVE X'2020233030303134373830' TO DFHEIV0(25:11)
 17087     CALL 'kxdfhei1' USING DFHEIV0,
 17088           FILE-ID-ERNOTE,
 17089           DFHEIV20,
 17090           DFHEIV99,
 17091           ELCERT-KEY,
 17092           DFHEIV99,
 17093           DFHEIV99,
 17094           DFHEIV99
 17095     SET ADDRESS OF CERTIFICATE-NOTE TO
 17096         DFHEIV20
 17097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17098
 17099
 17100     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17101     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17102     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17103
 17104     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17105
 17106
 17107* EXEC CICS DELETE
 17108*        DATASET   (FILE-ID-ERNOTE)
 17109*    END-EXEC.
 17110*    MOVE '&(                    &   #00014794' TO DFHEIV0
 17111     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17112     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17113     MOVE X'2020233030303134373934' TO DFHEIV0(25:11)
 17114     CALL 'kxdfhei1' USING DFHEIV0,
 17115           FILE-ID-ERNOTE,
 17116           DFHEIV99,
 17117           DFHEIV99,
 17118           DFHEIV99,
 17119           DFHEIV99
 17120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17121
 17122
 17123     PERFORM 8400-LOG-JOURNAL-RECORD.
 17124
 17125******************************************************************
 17126*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17127******************************************************************
 17128
 17129 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 311
* EL6311.cbl
 17130     IF CERT-ADDRESS-PRESENT
 17131        NEXT SENTENCE
 17132     ELSE
 17133        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17134
 17135
 17136* EXEC CICS HANDLE CONDITION
 17137*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17138*    END-EXEC.
 17139*    MOVE '"$I                   ! A #00014810' TO DFHEIV0
 17140     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17142     MOVE X'4120233030303134383130' TO DFHEIV0(25:11)
 17143     CALL 'kxdfhei1' USING DFHEIV0
 17144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17145
 17146
 17147     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17148
 17149
 17150* EXEC CICS READ
 17151*        EQUAL
 17152*        DATASET   (FILE-ID-ERMAIL)
 17153*        SET       (ADDRESS OF MAILING-DATA)
 17154*        RIDFLD    (ERMAIL-KEY)
 17155*        UPDATE
 17156*    END-EXEC.
 17157*    MOVE '&"S        EU         (   #00014816' TO DFHEIV0
 17158     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17159     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17160     MOVE X'2020233030303134383136' TO DFHEIV0(25:11)
 17161     CALL 'kxdfhei1' USING DFHEIV0,
 17162           FILE-ID-ERMAIL,
 17163           DFHEIV20,
 17164           DFHEIV99,
 17165           ERMAIL-KEY,
 17166           DFHEIV99,
 17167           DFHEIV99,
 17168           DFHEIV99
 17169     SET ADDRESS OF MAILING-DATA TO
 17170         DFHEIV20
 17171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17172
 17173
 17174     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17175     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17176     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17177
 17178     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17179
 17180
 17181* EXEC CICS DELETE
 17182*        DATASET   (FILE-ID-ERMAIL)
 17183*    END-EXEC.
 17184*    MOVE '&(                    &   #00014830' TO DFHEIV0
 17185     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17186     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17187     MOVE X'2020233030303134383330' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 312
* EL6311.cbl
 17188     CALL 'kxdfhei1' USING DFHEIV0,
 17189           FILE-ID-ERMAIL,
 17190           DFHEIV99,
 17191           DFHEIV99,
 17192           DFHEIV99,
 17193           DFHEIV99
 17194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17195
 17196
 17197     PERFORM 8400-LOG-JOURNAL-RECORD.
 17198
 17199 2830-BUILD-NEW-ISSUE-RECORD.
 17200     MOVE SPACES                 TO ELCERT-KEY.
 17201
 17202     IF  BCERTNOL GREATER THAN ZEROS
 17203         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17204
 17205     IF  BSUFIXL  GREATER THAN ZEROS
 17206         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17207
 17208     IF BEFFDTL GREATER THAN ZEROS
 17209        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17210
 17211 2870-WRITE-PENDING-BUSINESS.
 17212     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17213     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17214     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17215     MOVE '5'                    TO DC-OPTION-CODE.
 17216     PERFORM 9700-DATE-LINK.
 17217     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17218
 17219     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17220
 17221     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17222     MOVE 'A'                    TO JP-RECORD-TYPE.
 17223     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17224
 17225
 17226* EXEC CICS WRITE
 17227*        DATASET  (FILE-ID-ERPNDB)
 17228*        FROM     (PENDING-BUSINESS)
 17229*        RIDFLD   (PB-CONTROL-PRIMARY)
 17230*    END-EXEC.
 17231     MOVE LENGTH OF
 17232      PENDING-BUSINESS
 17233       TO DFHEIV11
 17234*    MOVE '&$ L                  ''   #00014862' TO DFHEIV0
 17235     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17236     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17237     MOVE X'2020233030303134383632' TO DFHEIV0(25:11)
 17238     CALL 'kxdfhei1' USING DFHEIV0,
 17239           FILE-ID-ERPNDB,
 17240           PENDING-BUSINESS,
 17241           DFHEIV11,
 17242           PB-CONTROL-PRIMARY,
 17243           DFHEIV99,
 17244           DFHEIV99
 17245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 313
* EL6311.cbl
 17246
 17247
 17248     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17249
 17250     PERFORM 8400-LOG-JOURNAL-RECORD.
 17251
 17252     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17253
 17254 2885-RECORD-MISSING.
 17255     MOVE -1                     TO BMAINTL
 17256     MOVE AL-UABON               TO BMAINTA
 17257     MOVE ER-2902                TO EMI-ERROR.
 17258     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17259     GO TO 8200-SEND-DATAONLY.
 17260
 17261 2890-DUPLICATE-RECORD.
 17262     MOVE -1                     TO BMAINTL.
 17263     MOVE AL-UABON               TO BCERTNOA.
 17264     MOVE AL-UNBON               TO BEFFDTA.
 17265     MOVE SPACE                  TO BMAINTI.
 17266
 17267     MOVE 1                      TO EMI-SUB
 17268                                    EMI-SWITCH1
 17269                                    EMI-SWITCH-AREA-1
 17270                                    EMI-SWITCH-AREA-2.
 17271
 17272     MOVE SPACES                 TO EMI-ERROR-LINES.
 17273
 17274
 17275* EXEC CICS SYNCPOINT ROLLBACK
 17276*    END-EXEC.
 17277*    MOVE '6"R                   !   #00014894' TO DFHEIV0
 17278     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17280     MOVE X'2020233030303134383934' TO DFHEIV0(25:11)
 17281     CALL 'kxdfhei1' USING DFHEIV0
 17282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17283
 17284
 17285     MOVE ER-2247                TO EMI-ERROR.
 17286     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17287     GO TO 8200-SEND-DATAONLY.
 17288
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 314
* EL6311.cbl
 17290
 17291******************************************************************
 17292*                                                                *
 17293*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17294*                                                                *
 17295******************************************************************
 17296
 17297 2900-REWRITE-CAN-CERT-KEY.
 17298     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17299
 17300     IF  CCERTNOL GREATER THAN ZEROS
 17301         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17302
 17303     IF  CSUFIXL  GREATER THAN ZEROS
 17304         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17305
 17306     IF  CEFFDTL  GREATER THAN ZEROS
 17307         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17308
 17309 2910-READ-BY-ACCOUNT.
 17310
 17311* EXEC CICS HANDLE CONDITION
 17312*         NOTFND    (2920-PROCESS-REWRITE)
 17313*    END-EXEC.
 17314*    MOVE '"$I                   ! B #00014922' TO DFHEIV0
 17315     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17317     MOVE X'4220233030303134393232' TO DFHEIV0(25:11)
 17318     CALL 'kxdfhei1' USING DFHEIV0
 17319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17320
 17321
 17322
 17323* EXEC CICS READ
 17324*        SET     (ADDRESS OF PENDING-BUSINESS)
 17325*        DATASET (FILE-ID-ERPNDB2)
 17326*        RIDFLD  (ERPNDB-ALT-KEY)
 17327*    END-EXEC.
 17328*    MOVE '&"S        E          (   #00014926' TO DFHEIV0
 17329     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17330     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17331     MOVE X'2020233030303134393236' TO DFHEIV0(25:11)
 17332     CALL 'kxdfhei1' USING DFHEIV0,
 17333           FILE-ID-ERPNDB2,
 17334           DFHEIV20,
 17335           DFHEIV99,
 17336           ERPNDB-ALT-KEY,
 17337           DFHEIV99,
 17338           DFHEIV99,
 17339           DFHEIV99
 17340     SET ADDRESS OF PENDING-BUSINESS TO
 17341         DFHEIV20
 17342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17343
 17344
 17345     GO TO 2990-DUPLICATE-RECORD.
 17346
 17347  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 315
* EL6311.cbl
 17348
 17349* EXEC CICS HANDLE CONDITION
 17350*         NOTFND    (2985-RECORD-MISSING)
 17351*    END-EXEC.
 17352*    MOVE '"$I                   ! C #00014935' TO DFHEIV0
 17353     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17355     MOVE X'4320233030303134393335' TO DFHEIV0(25:11)
 17356     CALL 'kxdfhei1' USING DFHEIV0
 17357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17358
 17359
 17360     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17361
 17362
 17363* EXEC CICS READ
 17364*        SET     (ADDRESS OF PENDING-BUSINESS)
 17365*        DATASET (FILE-ID-ERPNDB)
 17366*        RIDFLD  (ERPNDB-KEY)
 17367*        UPDATE
 17368*    END-EXEC.
 17369*    MOVE '&"S        EU         (   #00014941' TO DFHEIV0
 17370     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17371     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17372     MOVE X'2020233030303134393431' TO DFHEIV0(25:11)
 17373     CALL 'kxdfhei1' USING DFHEIV0,
 17374           FILE-ID-ERPNDB,
 17375           DFHEIV20,
 17376           DFHEIV99,
 17377           ERPNDB-KEY,
 17378           DFHEIV99,
 17379           DFHEIV99,
 17380           DFHEIV99
 17381     SET ADDRESS OF PENDING-BUSINESS TO
 17382         DFHEIV20
 17383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17384
 17385
 17386     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17387     MOVE 'D'                    TO JP-RECORD-TYPE.
 17388     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17389     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17390
 17391     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17392
 17393     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17394     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17395     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17396
 17397
 17398* EXEC CICS DELETE
 17399*        DATASET    (FILE-ID-ERPNDB)
 17400*    END-EXEC.
 17401*    MOVE '&(                    &   #00014959' TO DFHEIV0
 17402     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17403     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17404     MOVE X'2020233030303134393539' TO DFHEIV0(25:11)
 17405     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 316
* EL6311.cbl
 17406           FILE-ID-ERPNDB,
 17407           DFHEIV99,
 17408           DFHEIV99,
 17409           DFHEIV99,
 17410           DFHEIV99
 17411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17412
 17413
 17414     PERFORM 8400-LOG-JOURNAL-RECORD.
 17415
 17416
 17417* EXEC CICS GETMAIN
 17418*        SET      (ADDRESS OF PENDING-BUSINESS)
 17419*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17420*        INITIMG  (GETMAIN-SPACE)
 17421*    END-EXEC.
 17422*    MOVE ',"IL                  $   #00014965' TO DFHEIV0
 17423     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17424     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17425     MOVE X'2020233030303134393635' TO DFHEIV0(25:11)
 17426     CALL 'kxdfhei1' USING DFHEIV0,
 17427           DFHEIV20,
 17428           ERPNDB-RECORD-LENGTH,
 17429           GETMAIN-SPACE
 17430     SET ADDRESS OF PENDING-BUSINESS TO
 17431         DFHEIV20
 17432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17433
 17434
 17435     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17436
 17437 2950-PROCESS-CANCELS.
 17438
 17439
 17440* EXEC CICS HANDLE CONDITION
 17441*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17442*    END-EXEC.
 17443*    MOVE '"$I                   ! D #00014975' TO DFHEIV0
 17444     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17446     MOVE X'4420233030303134393735' TO DFHEIV0(25:11)
 17447     CALL 'kxdfhei1' USING DFHEIV0
 17448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17449
 17450
 17451
 17452* EXEC CICS READ
 17453*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17454*        DATASET (FILE-ID-ELCERT)
 17455*        RIDFLD  (ELCERT-KEY)
 17456*        UPDATE
 17457*    END-EXEC.
 17458*    MOVE '&"S        EU         (   #00014979' TO DFHEIV0
 17459     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17461     MOVE X'2020233030303134393739' TO DFHEIV0(25:11)
 17462     CALL 'kxdfhei1' USING DFHEIV0,
 17463           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 317
* EL6311.cbl
 17464           DFHEIV20,
 17465           DFHEIV99,
 17466           ELCERT-KEY,
 17467           DFHEIV99,
 17468           DFHEIV99,
 17469           DFHEIV99
 17470     SET ADDRESS OF CERTIFICATE-MASTER TO
 17471         DFHEIV20
 17472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17473
 17474
 17475     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17476
 17477     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17478     MOVE 'B'                      TO JP-RECORD-TYPE.
 17479     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17480     PERFORM 8400-LOG-JOURNAL-RECORD.
 17481
 17482     IF PB-CI-LIVES NOT NUMERIC
 17483         MOVE ZERO                    TO PB-CI-LIVES.
 17484
 17485     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17486        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17487        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17488        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17489                                         CM-LF-CANCEL-DT
 17490     ELSE
 17491        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17492        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17493        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17494        MOVE PB-CI-LIVES              TO CM-LIVES.
 17495
 17496     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17497        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17498            MOVE CM-LF-STATUS-AT-CANCEL
 17499                                     TO CM-LF-CURRENT-STATUS
 17500            MOVE SPACE
 17501                                     TO CM-LF-STATUS-AT-CANCEL
 17502        ELSE
 17503            MOVE PB-CI-LF-POLICY-STATUS
 17504                                     TO CM-LF-CURRENT-STATUS
 17505     ELSE
 17506        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17507
 17508     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17509        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17510        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17511        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17512                                         CM-AH-CANCEL-DT
 17513     ELSE
 17514        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17515        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17516        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17517        MOVE PB-CI-LIVES              TO CM-LIVES.
 17518
 17519     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17520        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17521            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 318
* EL6311.cbl
 17522                                     TO CM-AH-CURRENT-STATUS
 17523            MOVE SPACE
 17524                                     TO CM-AH-STATUS-AT-CANCEL
 17525        ELSE
 17526            MOVE PB-CI-AH-POLICY-STATUS
 17527                                     TO CM-AH-CURRENT-STATUS
 17528     ELSE
 17529        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17530
 17531 2975-REWRITE-CERT.
 17532     MOVE 'C'                      TO JP-RECORD-TYPE.
 17533     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17534
 17535
 17536* EXEC CICS REWRITE
 17537*        DATASET    (FILE-ID-ELCERT)
 17538*        FROM       (CERTIFICATE-MASTER)
 17539*    END-EXEC.
 17540     MOVE LENGTH OF
 17541      CERTIFICATE-MASTER
 17542       TO DFHEIV11
 17543*    MOVE '&& L                  %   #00015046' TO DFHEIV0
 17544     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17545     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17546     MOVE X'2020233030303135303436' TO DFHEIV0(25:11)
 17547     CALL 'kxdfhei1' USING DFHEIV0,
 17548           FILE-ID-ELCERT,
 17549           CERTIFICATE-MASTER,
 17550           DFHEIV11,
 17551           DFHEIV99
 17552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17553
 17554
 17555     PERFORM 8400-LOG-JOURNAL-RECORD.
 17556
 17557 2960-BUILD-NEW-CANCEL-RECORD.
 17558     IF  CCERTNOL GREATER THAN ZEROS
 17559         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17560
 17561     IF  CSUFIXL  GREATER THAN ZEROS
 17562         MOVE CSUFIXI             TO PB-CERT-SFX.
 17563
 17564     IF  CEFFDTL  GREATER  THAN ZEROS
 17565         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17566
 17567 2970-WRITE-PENDING-BUSINESS.
 17568     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17569     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17570     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17571     MOVE '5'                    TO DC-OPTION-CODE.
 17572     PERFORM 9700-DATE-LINK.
 17573     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17574
 17575     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17576
 17577     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17578                                    PB-CI-INSURED-SEX
 17579                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 319
* EL6311.cbl
 17580                                    PB-CI-AH-BENEFIT-CD
 17581                                    PB-CI-RATE-CLASS
 17582                                    PB-CI-RATE-DEV-LF
 17583                                    PB-CI-RATE-DEV-AH
 17584                                    PB-CI-LF-ABBR
 17585                                    PB-CI-AH-ABBR
 17586                                    PB-CI-OB-FLAG
 17587                                    PB-CI-LF-POLICY-STATUS
 17588                                    PB-CI-AH-POLICY-STATUS
 17589                                    PB-CI-INDV-GRP-CD
 17590                                    PB-CI-BENEFICIARY-NAME
 17591                                    PB-CI-NOTE-SW
 17592                                    PB-CI-SOC-SEC-NO
 17593                                    PB-CI-MEMBER-NO
 17594                                    PB-CI-INT-CODE
 17595                                    PB-CI-COMP-EXCP-SW
 17596                                    PB-CI-ENTRY-STATUS
 17597                                    PB-CI-CREDIT-INTERFACE-SW-1
 17598                                    PB-CI-CREDIT-INTERFACE-SW-2
 17599                                    PB-CI-ENTRY-BATCH.
 17600
 17601     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17602                                    PB-CI-AH-SETTLEMENT-DT
 17603                                    PB-CI-DEATH-DT
 17604                                    PB-CI-LF-PRIOR-CANCEL-DT
 17605                                    PB-CI-AH-PRIOR-CANCEL-DT
 17606                                    PB-CI-LOAN-1ST-PMT-DT
 17607                                    PB-CI-ENTRY-DT
 17608                                    PB-CI-LF-EXPIRE-DT
 17609                                    PB-CI-AH-EXPIRE-DT.
 17610
 17611     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17612                                    PB-CI-LF-TERM
 17613                                    PB-CI-LF-BENEFIT-AMT
 17614                                    PB-CI-LF-ALT-BENEFIT-AMT
 17615                                    PB-CI-LF-PREMIUM-AMT
 17616                                    PB-CI-LF-ALT-PREMIUM-AMT
 17617                                    PB-CI-AH-TERM
 17618                                    PB-CI-AH-BENEFIT-AMT
 17619                                    PB-CI-AH-PREMIUM-AMT
 17620                                    PB-CI-RATE-DEV-PCT-LF
 17621                                    PB-CI-RATE-DEV-PCT-AH
 17622                                    PB-CI-LIFE-COMMISSION
 17623                                    PB-CI-AH-COMMISSION
 17624                                    PB-CI-PAY-FREQUENCY
 17625                                    PB-CI-LOAN-APR
 17626                                    PB-CI-LOAN-TERM
 17627                                    PB-CI-CURR-SEQ
 17628                                    PB-CI-AH-CANCEL-AMT
 17629                                    PB-CI-LF-CANCEL-AMT
 17630                                    PB-CI-EXTENTION-DAYS
 17631                                    PB-CI-TERM-IN-DAYS
 17632                                    PB-CI-LOAN-OFFICER
 17633                                    PB-CI-LIVES
 17634                                    PB-CI-LF-CRIT-PER
 17635                                    PB-CI-AH-CRIT-PER
 17636                                    PB-C-LF-REM-TERM
 17637                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 320
* EL6311.cbl
 17638
 17639     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17640     MOVE 'A'                    TO JP-RECORD-TYPE.
 17641     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17642
 17643
 17644* EXEC CICS HANDLE CONDITION
 17645*        DUPREC   (2990-DUPLICATE-RECORD)
 17646*    END-EXEC.
 17647*    MOVE '"$%                   ! E #00015139' TO DFHEIV0
 17648     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17650     MOVE X'4520233030303135313339' TO DFHEIV0(25:11)
 17651     CALL 'kxdfhei1' USING DFHEIV0
 17652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17653
 17654
 17655
 17656* EXEC CICS WRITE
 17657*        DATASET  (FILE-ID-ERPNDB)
 17658*        FROM     (PENDING-BUSINESS)
 17659*        RIDFLD   (PB-CONTROL-PRIMARY)
 17660*    END-EXEC.
 17661     MOVE LENGTH OF
 17662      PENDING-BUSINESS
 17663       TO DFHEIV11
 17664*    MOVE '&$ L                  ''   #00015143' TO DFHEIV0
 17665     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17666     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17667     MOVE X'2020233030303135313433' TO DFHEIV0(25:11)
 17668     CALL 'kxdfhei1' USING DFHEIV0,
 17669           FILE-ID-ERPNDB,
 17670           PENDING-BUSINESS,
 17671           DFHEIV11,
 17672           PB-CONTROL-PRIMARY,
 17673           DFHEIV99,
 17674           DFHEIV99
 17675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17676
 17677
 17678     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17679
 17680     PERFORM 8400-LOG-JOURNAL-RECORD.
 17681
 17682     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17683
 17684 2985-RECORD-MISSING.
 17685     MOVE -1                     TO CMAINTL
 17686     MOVE AL-UABON               TO CMAINTA.
 17687
 17688     MOVE ER-2902                TO EMI-ERROR.
 17689     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17690     GO TO 8200-SEND-DATAONLY.
 17691
 17692 2990-DUPLICATE-RECORD.
 17693     MOVE SPACE                  TO CMAINTI.
 17694     MOVE -1                     TO CMAINTL.
 17695     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 321
* EL6311.cbl
 17696     MOVE AL-UNBON               TO CEFFDTA.
 17697
 17698     MOVE 1                      TO EMI-SUB
 17699                                    EMI-SWITCH1
 17700                                    EMI-SWITCH-AREA-1
 17701                                    EMI-SWITCH-AREA-2.
 17702     MOVE SPACES                 TO EMI-ERROR-LINES.
 17703
 17704
 17705* EXEC CICS SYNCPOINT ROLLBACK
 17706*    END-EXEC.
 17707*    MOVE '6"R                   !   #00015175' TO DFHEIV0
 17708     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17709     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17710     MOVE X'2020233030303135313735' TO DFHEIV0(25:11)
 17711     CALL 'kxdfhei1' USING DFHEIV0
 17712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17713
 17714
 17715     MOVE ER-2247                TO EMI-ERROR.
 17716     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17717     GO TO 8200-SEND-DATAONLY.
 17718
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 322
* EL6311.cbl
 17720
 17721***************************************************************
 17722*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17723*     PREMIUM FOR A SINGLE BATCH.                             *
 17724*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17725***************************************************************
 17726
 17727 3000-BATCH-MAINLINE.
 17728     IF PI-PREV-KEY NOT = SPACES
 17729         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17730     ELSE
 17731         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17732
 17733     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17734
 17735 3010-READNEXT.
 17736
 17737* EXEC CICS READ
 17738*         DATASET    (FILE-ID-ERPNDB)
 17739*         SET        (ADDRESS OF PENDING-BUSINESS)
 17740*         RIDFLD     (ERPNDB-KEY)
 17741*         GTEQ
 17742*    END-EXEC.
 17743*    MOVE '&"S        G          (   #00015199' TO DFHEIV0
 17744     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17745     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17746     MOVE X'2020233030303135313939' TO DFHEIV0(25:11)
 17747     CALL 'kxdfhei1' USING DFHEIV0,
 17748           FILE-ID-ERPNDB,
 17749           DFHEIV20,
 17750           DFHEIV99,
 17751           ERPNDB-KEY,
 17752           DFHEIV99,
 17753           DFHEIV99,
 17754           DFHEIV99
 17755     SET ADDRESS OF PENDING-BUSINESS TO
 17756         DFHEIV20
 17757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17758
 17759
 17760     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17761        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17762          GO TO 3030-END-BATCH.
 17763
 17764     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17765
 17766     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17767        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17768          GO TO 3020-BUMP-SEQ.
 17769
 17770     IF PB-ISSUE
 17771        ADD +1                   TO WS-ISS-TOTAL-CNT
 17772        IF PB-FATAL-ERRORS
 17773           ADD +1                      TO WS-ISS-FATAL-CNT
 17774           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17775           GO TO 3020-BUMP-SEQ
 17776        ELSE
 17777           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 323
* EL6311.cbl
 17778              ADD +1                      TO WS-ISS-FORCE-CNT
 17779              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17780              GO TO 3020-BUMP-SEQ
 17781           ELSE
 17782              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17783                 ADD +1                      TO WS-ISS-HOLD-CNT
 17784                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17785                 GO TO 3020-BUMP-SEQ
 17786              ELSE
 17787                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17788                     THRU  3299-EXIT
 17789                 GO TO 3020-BUMP-SEQ.
 17790
 17791     IF PB-CANCELLATION
 17792        ADD +1                   TO WS-CAN-TOTAL-CNT
 17793        IF PB-FATAL-ERRORS
 17794           ADD +1                 TO WS-CAN-FATAL-CNT
 17795           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17796           GO TO 3020-BUMP-SEQ
 17797        ELSE
 17798           IF PB-UNFORCED-ERRORS
 17799              ADD +1                 TO WS-CAN-FORCE-CNT
 17800              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17801              GO TO 3020-BUMP-SEQ
 17802           ELSE
 17803              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17804                 ADD +1                 TO WS-CAN-HOLD-CNT
 17805                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17806                 GO TO 3020-BUMP-SEQ
 17807              ELSE
 17808                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17809                     THRU  3499-EXIT
 17810                 GO TO 3020-BUMP-SEQ.
 17811
 17812     IF PB-BATCH-TRAILER
 17813         GO TO 3030-END-BATCH.
 17814
 17815 3020-BUMP-SEQ.
 17816     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17817     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17818     GO TO 3010-READNEXT.
 17819
 17820 3030-END-BATCH.
 17821     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17822     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17823     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17824     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17825
 17826     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17827                                          - WS-ISS-FORCE-CNT
 17828                                          - WS-ISS-HOLD-CNT).
 17829
 17830     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17831     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17832
 17833     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17834     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17835     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 324
* EL6311.cbl
 17836     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17837     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17838                                          - WS-CAN-FORCE-CNT
 17839                                          - WS-CAN-HOLD-CNT).
 17840     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17841     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17842
 17843     COMPUTE WS-NET-TOTAL-CNT
 17844         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17845     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17846     COMPUTE WS-NET-FATAL-CNT
 17847         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17848     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17849     COMPUTE WS-NET-FORCE-CNT
 17850         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17851     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17852     COMPUTE WS-NET-HOLD-CNT
 17853         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17854     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17855
 17856     COMPUTE WS-NET-AVAIL-CNT
 17857          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17858                              - WS-ISS-FORCE-CNT
 17859                              - WS-ISS-HOLD-CNT)
 17860          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17861                              - WS-CAN-FORCE-CNT
 17862                              - WS-CAN-HOLD-CNT).
 17863     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17864
 17865     COMPUTE WS-NET-GOOD-PREM
 17866         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17867     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17868     COMPUTE WS-NET-BAD-PREM
 17869         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17870     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17871
 17872     MOVE 0000                   TO EMI-ERROR.
 17873     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17874     MOVE -1                     TO DPFENTRL.
 17875     GO TO 8200-SEND-DATAONLY.
 17876
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 325
* EL6311.cbl
 17878
 17879******************************************************************
 17880*                                                                *
 17881*           A D D    B A D   I S S U E   P R E M I U M           *
 17882*                                                                *
 17883******************************************************************
 17884
 17885 3100-ADD-BAD-ISSUE-PREM.
 17886     IF PB-OVERRIDE-LIFE
 17887       OR PB-OVERRIDE-BOTH
 17888           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17889           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17890       ELSE
 17891           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17892           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17893
 17894     IF PB-OVERRIDE-AH
 17895       OR PB-OVERRIDE-BOTH
 17896           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17897       ELSE
 17898           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17899
 17900 3199-EXIT.
 17901     EXIT.
 17902
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 326
* EL6311.cbl
 17904
 17905******************************************************************
 17906*                                                                *
 17907*       A D D   G O O D   I S S U E   P R E M I U M              *
 17908*                                                                *
 17909******************************************************************
 17910
 17911 3200-ADD-GOOD-ISSUE-PREM.
 17912     IF PB-OVERRIDE-LIFE
 17913       OR PB-OVERRIDE-BOTH
 17914           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17915           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17916       ELSE
 17917           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17918           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17919
 17920     IF PB-OVERRIDE-AH
 17921       OR PB-OVERRIDE-BOTH
 17922           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17923       ELSE
 17924           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17925
 17926 3299-EXIT.
 17927     EXIT.
 17928
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 327
* EL6311.cbl
 17930
 17931
 17932******************************************************************
 17933*                                                                *
 17934*        A D D   B A D   C A N C E L   P R E M I U M             *
 17935*                                                                *
 17936******************************************************************
 17937
 17938 3300-ADD-BAD-CANCEL-PREM.
 17939     IF PB-OVERRIDE-LIFE
 17940       OR PB-OVERRIDE-BOTH
 17941           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17942       ELSE
 17943           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17944
 17945     IF PB-OVERRIDE-AH
 17946       OR PB-OVERRIDE-BOTH
 17947           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17948       ELSE
 17949           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17950
 17951 3399-EXIT.
 17952     EXIT.
 17953
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 328
* EL6311.cbl
 17955
 17956******************************************************************
 17957*                                                                *
 17958*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17959*                                                                *
 17960******************************************************************
 17961
 17962 3400-ADD-GOOD-CANCEL-PREM.
 17963     IF PB-OVERRIDE-LIFE
 17964       OR PB-OVERRIDE-BOTH
 17965           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17966       ELSE
 17967           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17968
 17969     IF PB-OVERRIDE-AH
 17970       OR PB-OVERRIDE-BOTH
 17971           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17972       ELSE
 17973           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17974
 17975 3499-EXIT.
 17976     EXIT.
 17977
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 329
* EL6311.cbl
 17979
 17980******************************************************************
 17981*                                                                *
 17982*           E D I T   B A T C H   D A T A                        *
 17983*                                                                *
 17984******************************************************************
 17985
 17986 3500-EDIT-BATCH-DATA.
 17987     IF PI-PREV-KEY NOT = SPACES
 17988        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17989     ELSE
 17990        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17991
 17992     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17993     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17994
 17995
 17996* EXEC CICS HANDLE CONDITION
 17997*         NOTFND      (3590-NOT-FOUND)
 17998*    END-EXEC.
 17999*    MOVE '"$I                   ! F #00015441' TO DFHEIV0
 18000     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18001     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18002     MOVE X'4620233030303135343431' TO DFHEIV0(25:11)
 18003     CALL 'kxdfhei1' USING DFHEIV0
 18004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18005
 18006
 18007     IF DRISSL   GREATER THAN ZEROS OR
 18008        DRISSL   GREATER THAN ZEROS OR
 18009        DRLFPRML GREATER THAN ZEROS OR
 18010        DRAHPRML GREATER THAN ZEROS OR
 18011        DRCANCL  GREATER THAN ZEROS OR
 18012        DRLFRFDL GREATER THAN ZEROS OR
 18013        DRAHRFDL GREATER THAN ZEROS
 18014              NEXT SENTENCE
 18015          ELSE
 18016              MOVE ER-3224    TO EMI-ERROR
 18017              MOVE -1         TO DPFENTRL
 18018              MOVE AL-UNBON   TO DPFENTRA
 18019              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18020              GO TO 8200-SEND-DATAONLY.
 18021
 18022     IF NOT MODIFY-CAP
 18023         MOVE 'UPDATE'       TO SM-READ
 18024         PERFORM 9995-SECURITY-VIOLATION
 18025         MOVE ER-0070        TO EMI-ERROR
 18026         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18027         GO TO 8100-SEND-INITIAL-MAP.
 18028
 18029        IF DRISSL GREATER THAN ZEROS
 18030           MOVE AL-UNNON         TO DRISSA
 18031           MOVE DRISSI           TO DEEDIT-FIELD
 18032           PERFORM 8600-DEEDIT
 18033           IF DEEDIT-FIELD-V0  NUMERIC
 18034              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18035           ELSE
 18036              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 330
* EL6311.cbl
 18037              MOVE -1         TO DRISSL
 18038              MOVE AL-UNBON   TO DRISSA
 18039              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18040
 18041        IF DRLFPRML GREATER THAN ZEROS
 18042           MOVE AL-UNNON         TO DRLFPRMA
 18043
 18044* EXEC CICS BIF DEEDIT
 18045*              FIELD  (DRLFPRMI)
 18046*              LENGTH (11)
 18047*          END-EXEC
 18048     MOVE 11
 18049       TO DFHEIV11
 18050*    MOVE '@"L                   #   #00015481' TO DFHEIV0
 18051     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18052     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18053     MOVE X'2020233030303135343831' TO DFHEIV0(25:11)
 18054     CALL 'kxdfhei1' USING DFHEIV0,
 18055           DRLFPRMI,
 18056           DFHEIV11
 18057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18058           IF DRLFPRMI NUMERIC
 18059              MOVE DRLFPRMI   TO WS-DRLFPRM
 18060*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18061*          PERFORM 8600-DEEDIT
 18062*          IF DEEDIT-FIELD-V2  NUMERIC
 18063*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18064           ELSE
 18065              MOVE ER-2223    TO EMI-ERROR
 18066              MOVE -1         TO DRLFPRML
 18067              MOVE AL-UNBON   TO DRLFPRMA
 18068              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18069
 18070        IF DRAHPRML GREATER THAN ZEROS
 18071           MOVE AL-UNNON         TO DRAHPRMA
 18072
 18073* EXEC CICS BIF DEEDIT
 18074*              FIELD  (DRAHPRMI)
 18075*              LENGTH (11)
 18076*          END-EXEC
 18077     MOVE 11
 18078       TO DFHEIV11
 18079*    MOVE '@"L                   #   #00015499' TO DFHEIV0
 18080     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18081     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18082     MOVE X'2020233030303135343939' TO DFHEIV0(25:11)
 18083     CALL 'kxdfhei1' USING DFHEIV0,
 18084           DRAHPRMI,
 18085           DFHEIV11
 18086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18087           IF DRAHPRMI NUMERIC
 18088              MOVE DRAHPRMI   TO WS-DRAHPRM
 18089*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18090*          PERFORM 8600-DEEDIT
 18091*          IF DEEDIT-FIELD-V2  NUMERIC
 18092*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18093           ELSE
 18094              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 331
* EL6311.cbl
 18095              MOVE -1         TO DRAHPRML
 18096              MOVE AL-UNBON   TO DRAHPRMA
 18097              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18098
 18099        IF DRCANCL GREATER THAN ZEROS
 18100           MOVE AL-UNNON         TO DRCANCA
 18101           MOVE DRCANCI          TO DEEDIT-FIELD
 18102           PERFORM 8600-DEEDIT
 18103           IF DEEDIT-FIELD-V0  NUMERIC
 18104              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18105           ELSE
 18106              MOVE ER-2223    TO EMI-ERROR
 18107              MOVE -1         TO DRCANCL
 18108              MOVE AL-UNBON   TO DRCANCL
 18109              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18110
 18111        IF DRLFRFDL GREATER THAN ZEROS
 18112           MOVE AL-UNNON         TO DRLFRFDA
 18113
 18114* EXEC CICS BIF DEEDIT
 18115*              FIELD  (DRLFRFDI)
 18116*              LENGTH (11)
 18117*          END-EXEC
 18118     MOVE 11
 18119       TO DFHEIV11
 18120*    MOVE '@"L                   #   #00015529' TO DFHEIV0
 18121     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18122     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18123     MOVE X'2020233030303135353239' TO DFHEIV0(25:11)
 18124     CALL 'kxdfhei1' USING DFHEIV0,
 18125           DRLFRFDI,
 18126           DFHEIV11
 18127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18128           IF DRLFRFDI NUMERIC
 18129              MOVE DRLFRFDI   TO WS-DRLFRFD
 18130*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18131*          PERFORM 8600-DEEDIT
 18132*          IF DEEDIT-FIELD-V2  NUMERIC
 18133*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18134           ELSE
 18135              MOVE ER-2223    TO EMI-ERROR
 18136              MOVE -1         TO DRLFRFDL
 18137              MOVE AL-UNBON   TO DRLFRFDA
 18138              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18139
 18140        IF DRAHRFDL GREATER THAN ZEROS
 18141           MOVE AL-UNNON         TO DRAHRFDA
 18142
 18143* EXEC CICS BIF DEEDIT
 18144*              FIELD  (DRAHRFDI)
 18145*              LENGTH (11)
 18146*          END-EXEC
 18147     MOVE 11
 18148       TO DFHEIV11
 18149*    MOVE '@"L                   #   #00015547' TO DFHEIV0
 18150     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18151     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18152     MOVE X'2020233030303135353437' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 332
* EL6311.cbl
 18153     CALL 'kxdfhei1' USING DFHEIV0,
 18154           DRAHRFDI,
 18155           DFHEIV11
 18156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18157           IF DRAHRFDI NUMERIC
 18158              MOVE DRAHRFDI   TO WS-DRAHRFD
 18159*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18160*          PERFORM 8600-DEEDIT
 18161*          IF DEEDIT-FIELD-V2  NUMERIC
 18162*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18163           ELSE
 18164              MOVE ER-2223    TO EMI-ERROR
 18165              MOVE -1         TO DRAHRFDL
 18166              MOVE AL-UNBON   TO DRAHRFDA
 18167              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18168
 18169     IF EMI-ERROR = ZEROS
 18170        GO 3600-UPDATE-BATCH-HEADER.
 18171
 18172     GO TO 8200-SEND-DATAONLY.
 18173
 18174 3590-NOT-FOUND.
 18175     MOVE ER-2192                TO EMI-ERROR.
 18176     MOVE -1                     TO DPFENTRL.
 18177     MOVE AL-UNBON               TO DPFENTRA.
 18178     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18179     GO TO 8200-SEND-DATAONLY.
 18180
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 333
* EL6311.cbl
 18182
 18183******************************************************************
 18184*                                                                *
 18185*           U P D A T E   B A T C H   H E A D E R                *
 18186*                                                                *
 18187******************************************************************
 18188
 18189 3600-UPDATE-BATCH-HEADER.
 18190
 18191* EXEC CICS HANDLE CONDITION
 18192*         NOTFND      (3690-NOT-FOUND)
 18193*    END-EXEC.
 18194*    MOVE '"$I                   ! G #00015584' TO DFHEIV0
 18195     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18197     MOVE X'4720233030303135353834' TO DFHEIV0(25:11)
 18198     CALL 'kxdfhei1' USING DFHEIV0
 18199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18200
 18201
 18202
 18203* EXEC CICS READ
 18204*        DATASET (FILE-ID-ERPNDB)
 18205*        RIDFLD  (ERPNDB-KEY)
 18206*        SET     (ADDRESS OF PENDING-BUSINESS)
 18207*        UPDATE
 18208*    END-EXEC.
 18209*    MOVE '&"S        EU         (   #00015588' TO DFHEIV0
 18210     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18211     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18212     MOVE X'2020233030303135353838' TO DFHEIV0(25:11)
 18213     CALL 'kxdfhei1' USING DFHEIV0,
 18214           FILE-ID-ERPNDB,
 18215           DFHEIV20,
 18216           DFHEIV99,
 18217           ERPNDB-KEY,
 18218           DFHEIV99,
 18219           DFHEIV99,
 18220           DFHEIV99
 18221     SET ADDRESS OF PENDING-BUSINESS TO
 18222         DFHEIV20
 18223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18224
 18225
 18226     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18227     MOVE 'B'                    TO JP-RECORD-TYPE.
 18228     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18229
 18230     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18231
 18232     PERFORM 8400-LOG-JOURNAL-RECORD.
 18233
 18234     IF DRISSL GREATER THAN ZEROS
 18235        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18236
 18237     IF DRCANCL GREATER THAN ZEROS
 18238        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18239
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 334
* EL6311.cbl
 18240
 18241     IF DRLFPRML GREATER THAN ZEROS
 18242        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18243
 18244     IF DRAHPRML GREATER THAN ZEROS
 18245        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18246
 18247     IF DRLFRFDL GREATER THAN ZEROS
 18248        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18249
 18250     IF DRAHRFDL GREATER THAN ZEROS
 18251        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18252
 18253 3670-REWRITE-BATCH-HEADER.
 18254     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18255        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18256        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18257        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18258        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18259        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18260        MOVE SPACE               TO PB-OUT-BAL-CD
 18261     ELSE
 18262        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18263
 18264     MOVE 'C'                    TO JP-RECORD-TYPE.
 18265     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18266
 18267
 18268* EXEC CICS REWRITE
 18269*         DATASET      (FILE-ID-ERPNDB)
 18270*         FROM         (PENDING-BUSINESS)
 18271*    END-EXEC.
 18272     MOVE LENGTH OF
 18273      PENDING-BUSINESS
 18274       TO DFHEIV11
 18275*    MOVE '&& L                  %   #00015636' TO DFHEIV0
 18276     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18277     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18278     MOVE X'2020233030303135363336' TO DFHEIV0(25:11)
 18279     CALL 'kxdfhei1' USING DFHEIV0,
 18280           FILE-ID-ERPNDB,
 18281           PENDING-BUSINESS,
 18282           DFHEIV11,
 18283           DFHEIV99
 18284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18285
 18286
 18287     PERFORM 8400-LOG-JOURNAL-RECORD.
 18288
 18289     GO TO 7200-DISPLAY-BATCHES.
 18290
 18291 3690-NOT-FOUND.
 18292     MOVE ER-2192                TO EMI-ERROR.
 18293     MOVE -1                     TO DPFENTRL.
 18294     MOVE AL-UNBON               TO DPFENTRA.
 18295     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18296     GO TO 8200-SEND-DATAONLY.
 18297
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 335
* EL6311.cbl
 18299
 18300******************************************************************
 18301*                                                                *
 18302*           R E - D I S P L A Y   R E C O R D                    *
 18303*                                                                *
 18304******************************************************************
 18305
 18306 3900-RE-DISPLAY-RECORD.
 18307
 18308* EXEC CICS HANDLE CONDITION
 18309*         NOTFND   (3990-NOT-FOUND)
 18310*    END-EXEC.
 18311*    MOVE '"$I                   ! H #00015661' TO DFHEIV0
 18312     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18314     MOVE X'4820233030303135363631' TO DFHEIV0(25:11)
 18315     CALL 'kxdfhei1' USING DFHEIV0
 18316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18317
 18318
 18319     IF PI-DISPLAY-ORIGINAL-BATCH
 18320         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18321     ELSE
 18322         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18323
 18324
 18325* EXEC CICS READ
 18326*         DATASET   (FILE-ID)
 18327*         RIDFLD    (PI-PREV-KEY)
 18328*         SET       (ADDRESS OF PENDING-BUSINESS)
 18329*    END-EXEC.
 18330*    MOVE '&"S        E          (   #00015670' TO DFHEIV0
 18331     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18332     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18333     MOVE X'2020233030303135363730' TO DFHEIV0(25:11)
 18334     CALL 'kxdfhei1' USING DFHEIV0,
 18335           FILE-ID,
 18336           DFHEIV20,
 18337           DFHEIV99,
 18338           PI-PREV-KEY,
 18339           DFHEIV99,
 18340           DFHEIV99,
 18341           DFHEIV99
 18342     SET ADDRESS OF PENDING-BUSINESS TO
 18343         DFHEIV20
 18344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18345
 18346
 18347     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18348
 18349     IF PB-ISSUE
 18350         GO TO 7000-DISPLAY-ISSUES.
 18351
 18352     IF PB-CANCELLATION
 18353         GO TO 7100-DISPLAY-CANCELS.
 18354
 18355     IF PB-BATCH-TRAILER
 18356         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 336
* EL6311.cbl
 18357
 18358 3990-NOT-FOUND.
 18359     MOVE LOW-VALUES             TO EL631BI.
 18360
 18361     IF PI-MAP-NAME = EL631B
 18362         MOVE -1                  TO BMAINTL
 18363     ELSE
 18364         MOVE -1                  TO CMAINTL.
 18365
 18366     GO TO 8100-SEND-INITIAL-MAP.
 18367
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 337
* EL6311.cbl
 18369
 18370***************************************************************
 18371*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18372*                                                             *
 18373*      1. START BROWSE WITH                                   *
 18374*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18375*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18376*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18377*                                                             *
 18378*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18379*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18380*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18381*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18382*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18383*               AND IS IT TO BE DISPLAYED.                    *
 18384*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18385*               DISPLAYED.                                    *
 18386*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18387*               DISPLAYED.                                    *
 18388*                                                             *
 18389*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18390*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18391***************************************************************
 18392
 18393 4000-BROWSE-DETAIL-FORWARD.
 18394     IF FIRST-TIME
 18395        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18396     ELSE
 18397        IF SHOW-RECORD
 18398           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18399           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18400           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18401           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18402           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18403        ELSE
 18404           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18405
 18406
 18407* EXEC CICS HANDLE CONDITION
 18408*         NOTFND   (4050-END-RECORDS)
 18409*         ENDFILE  (4050-END-RECORDS)
 18410*    END-EXEC.
 18411*    MOVE '"$I''                  ! I #00015735' TO DFHEIV0
 18412     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18414     MOVE X'4920233030303135373335' TO DFHEIV0(25:11)
 18415     CALL 'kxdfhei1' USING DFHEIV0
 18416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18417
 18418
 18419
 18420* EXEC CICS STARTBR
 18421*         DATASET   (FILE-ID-ERPNDB2)
 18422*         RIDFLD    (ERPNDB-ALT-KEY)
 18423*    END-EXEC.
 18424     MOVE 0
 18425       TO DFHEIV11
 18426*    MOVE '&,         G          &   #00015740' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 338
* EL6311.cbl
 18427     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18428     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18429     MOVE X'2020233030303135373430' TO DFHEIV0(25:11)
 18430     CALL 'kxdfhei1' USING DFHEIV0,
 18431           FILE-ID-ERPNDB2,
 18432           ERPNDB-ALT-KEY,
 18433           DFHEIV99,
 18434           DFHEIV11,
 18435           DFHEIV99
 18436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18437
 18438
 18439     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18440
 18441     IF FIRST-TIME OR SHOW-RECORD
 18442        MOVE SPACE               TO WS-FIRST-TIME-SW
 18443        GO TO 4005-READ-NEXT-RECORD.
 18444
 18445
 18446* EXEC CICS READNEXT
 18447*         DATASET    (FILE-ID-ERPNDB2)
 18448*         SET        (ADDRESS OF PENDING-BUSINESS)
 18449*         RIDFLD     (ERPNDB-ALT-KEY)
 18450*    END-EXEC.
 18451     MOVE 0
 18452       TO DFHEIV11
 18453*    MOVE '&.S                   )   #00015751' TO DFHEIV0
 18454     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18455     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18456     MOVE X'2020233030303135373531' TO DFHEIV0(25:11)
 18457     CALL 'kxdfhei1' USING DFHEIV0,
 18458           FILE-ID-ERPNDB2,
 18459           DFHEIV20,
 18460           DFHEIV99,
 18461           ERPNDB-ALT-KEY,
 18462           DFHEIV99,
 18463           DFHEIV11,
 18464           DFHEIV99,
 18465           DFHEIV99
 18466     SET ADDRESS OF PENDING-BUSINESS TO
 18467         DFHEIV20
 18468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18469
 18470
 18471 4005-READ-NEXT-RECORD.
 18472
 18473* EXEC CICS READNEXT
 18474*         DATASET    (FILE-ID-ERPNDB2)
 18475*         SET        (ADDRESS OF PENDING-BUSINESS)
 18476*         RIDFLD     (ERPNDB-ALT-KEY)
 18477*    END-EXEC.
 18478     MOVE 0
 18479       TO DFHEIV11
 18480*    MOVE '&.S                   )   #00015758' TO DFHEIV0
 18481     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18482     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18483     MOVE X'2020233030303135373538' TO DFHEIV0(25:11)
 18484     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 339
* EL6311.cbl
 18485           FILE-ID-ERPNDB2,
 18486           DFHEIV20,
 18487           DFHEIV99,
 18488           ERPNDB-ALT-KEY,
 18489           DFHEIV99,
 18490           DFHEIV11,
 18491           DFHEIV99,
 18492           DFHEIV99
 18493     SET ADDRESS OF PENDING-BUSINESS TO
 18494         DFHEIV20
 18495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18496
 18497
 18498     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18499
 18500     IF WS-BATCH-PREFIX = '#CL'
 18501        GO TO 4005-READ-NEXT-RECORD.
 18502
 18503     IF SHOW-RECORD
 18504        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18505           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18506           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18507           PB-STATE         NOT = PI-PB-STATE          OR
 18508           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18509           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18510           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18511           GO TO 4050-END-RECORDS
 18512        ELSE
 18513           GO TO 4010-CHECK-REC-TYPE.
 18514
 18515     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18516        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18517        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18518        PB-STATE            NOT = PI-PB-STATE          OR
 18519        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18520        GO TO 4050-END-RECORDS.
 18521
 18522     IF PB-BATCH-TRAILER
 18523        GO TO 4005-READ-NEXT-RECORD.
 18524
 18525     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18526        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18527           GO TO 4005-READ-NEXT-RECORD
 18528        ELSE
 18529           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18530              GO TO 4010-CHECK-REC-TYPE
 18531           ELSE
 18532              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18533                 GO TO 4010-CHECK-REC-TYPE
 18534              ELSE
 18535                 GO TO 4005-READ-NEXT-RECORD.
 18536
 18537     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18538        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18539           GO TO 4005-READ-NEXT-RECORD.
 18540
 18541 4010-CHECK-REC-TYPE.
 18542     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 340
* EL6311.cbl
 18543         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18544             NEXT SENTENCE
 18545         ELSE
 18546             GO TO 4005-READ-NEXT-RECORD.
 18547
 18548     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18549         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18550             NEXT SENTENCE
 18551        ELSE
 18552             GO TO 4005-READ-NEXT-RECORD.
 18553
 18554     IF NOT DISPLAY-CHANGE-RECORDS AND
 18555            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18556        GO TO 4005-READ-NEXT-RECORD.
 18557
 18558     IF DISPLAY-HOLD-RECORDS AND
 18559        NOT PB-RECORD-ON-HOLD
 18560          GO TO 4005-READ-NEXT-RECORD.
 18561
 18562     IF PB-ISSUE
 18563        IF DISPLAY-CHK-REQ-RECORDS
 18564            GO TO 4005-READ-NEXT-RECORD.
 18565
 18566     IF PB-ISSUE
 18567        IF ISSUE-WITH-WARNING
 18568           IF PB-WARNING-ERRORS
 18569              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18570                  GO TO 4005-READ-NEXT-RECORD
 18571              ELSE
 18572                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18573                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18574                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18575                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18576                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18577                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18578                 GO TO 7000-DISPLAY-ISSUES
 18579           ELSE
 18580              GO TO 4005-READ-NEXT-RECORD.
 18581
 18582     IF PB-ISSUE
 18583        IF (ISSUES-IN-ERROR AND
 18584            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18585            ALL-ISSUES
 18586            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18587            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18588            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18589            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18590            MOVE PB-SV-STATE            TO PI-SV-STATE
 18591            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18592            GO TO 7000-DISPLAY-ISSUES
 18593        ELSE
 18594            GO TO 4005-READ-NEXT-RECORD.
 18595
 18596     IF PB-CANCELLATION
 18597        IF DISPLAY-CHK-REQ-RECORDS
 18598           IF PB-C-REFUND-REQUESTED
 18599              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18600              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 341
* EL6311.cbl
 18601              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18602              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18603              MOVE PB-SV-STATE            TO PI-SV-STATE
 18604              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18605              GO TO 7100-DISPLAY-CANCELS
 18606           ELSE
 18607               GO TO 4005-READ-NEXT-RECORD.
 18608
 18609     IF PB-CANCELLATION
 18610        IF CANCEL-WITH-WARNING
 18611           IF PB-WARNING-ERRORS
 18612              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18613                  GO TO 4005-READ-NEXT-RECORD
 18614              ELSE
 18615                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18616                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18617                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18618                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18619                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18620                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18621                 GO TO 7100-DISPLAY-CANCELS
 18622           ELSE
 18623              GO TO 4005-READ-NEXT-RECORD.
 18624
 18625     IF PB-CANCELLATION
 18626        IF (CANCEL-IN-ERROR  AND
 18627            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18628            ALL-CANCELS
 18629            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18630            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18631            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18632            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18633            MOVE PB-SV-STATE            TO PI-SV-STATE
 18634            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18635            GO TO 7100-DISPLAY-CANCELS.
 18636
 18637     GO TO 4005-READ-NEXT-RECORD.
 18638
 18639 4050-END-RECORDS.
 18640******************************************************************
 18641*                                                                *
 18642*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18643*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18644*         PROGRAM.                                               *
 18645*                                                                *
 18646******************************************************************
 18647
 18648     IF BROWSE-STARTED
 18649        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18650
 18651* EXEC CICS ENDBR
 18652*            DATASET  (FILE-ID-ERPNDB2)
 18653*       END-EXEC.
 18654     MOVE 0
 18655       TO DFHEIV11
 18656*    MOVE '&2                    $   #00015916' TO DFHEIV0
 18657     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18658     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 342
* EL6311.cbl
 18659     MOVE X'2020233030303135393136' TO DFHEIV0(25:11)
 18660     CALL 'kxdfhei1' USING DFHEIV0,
 18661           FILE-ID-ERPNDB2,
 18662           DFHEIV11,
 18663           DFHEIV99
 18664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18665
 18666
 18667     IF  EIBTRNID NOT = TRANS-EXB1
 18668         IF PENDING-BUS-RECS-FOUND
 18669             NEXT SENTENCE
 18670           ELSE
 18671             MOVE '9'            TO PI-BROWSE-SW
 18672             GO TO 9400-CLEAR.
 18673
 18674     IF SHOW-RECORD
 18675        MOVE ER-2253            TO EMI-ERROR
 18676       ELSE
 18677        MOVE ER-2254            TO EMI-ERROR.
 18678
 18679     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18680
 18681     IF PI-MAP-NAME = SPACES
 18682        MOVE -1                  TO DPFENTRL
 18683        MOVE EL631D               TO PI-MAP-NAME
 18684        GO TO 8100-SEND-INITIAL-MAP.
 18685
 18686     IF PI-MAP-NAME = EL631B
 18687        MOVE -1                  TO BMAINTL
 18688     ELSE
 18689        IF PI-MAP-NAME = EL631C
 18690           MOVE -1               TO CMAINTL
 18691        ELSE
 18692           MOVE -1               TO DPFENTRL.
 18693
 18694     GO TO 8200-SEND-DATAONLY.
 18695
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 343
* EL6311.cbl
 18697
 18698***************************************************************
 18699*                                                             *
 18700*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18701*                                                             *
 18702*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18703*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18704*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18705*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18706*                                                             *
 18707*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18708*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18709*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18710*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18711*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18712*                AND IS IT TO BE DISPLAYED.                   *
 18713*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18714*                DISPLAYED.                                   *
 18715*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18716*                DISPLAYED.                                   *
 18717*                                                             *
 18718*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18719*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18720*                                                             *
 18721*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18722*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18723*                THEY ARE NOT TO BE DISPLAYED.                *
 18724*                                                             *
 18725***************************************************************
 18726
 18727 4100-BROWSE-PRIMARY-FORWARD.
 18728     IF FIRST-TIME  OR SHOW-RECORD
 18729        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18730        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18731        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18732     ELSE
 18733        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18734        IF ERPNDB-BATCH-SEQ-NO = +9999
 18735           GO TO 4150-END-BATCH
 18736        ELSE
 18737           IF DISPLAY-CHANGE-RECORDS
 18738              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18739           ELSE
 18740              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18741              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18742
 18743     IF FIRST-TIME
 18744         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18745            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18746              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18747
 18748
 18749* EXEC CICS HANDLE CONDITION
 18750*         ENDFILE  (4150-END-BATCH)
 18751*    END-EXEC.
 18752*    MOVE '"$''                   ! J #00016001' TO DFHEIV0
 18753     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18754     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 344
* EL6311.cbl
 18755     MOVE X'4A20233030303136303031' TO DFHEIV0(25:11)
 18756     CALL 'kxdfhei1' USING DFHEIV0
 18757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18758
 18759
 18760 4105-READ-NEXT.
 18761
 18762* EXEC CICS HANDLE CONDITION
 18763*         NOTFND    (4150-END-BATCH)
 18764*    END-EXEC.
 18765*    MOVE '"$I                   ! K #00016006' TO DFHEIV0
 18766     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18768     MOVE X'4B20233030303136303036' TO DFHEIV0(25:11)
 18769     CALL 'kxdfhei1' USING DFHEIV0
 18770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18771
 18772
 18773     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18774
 18775     IF PI-DISPLAY-ORIGINAL-BATCH
 18776        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18777     ELSE
 18778        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18779
 18780
 18781* EXEC CICS READ
 18782*         DATASET   (FILE-ID)
 18783*         SET       (ADDRESS OF PENDING-BUSINESS)
 18784*         RIDFLD    (ERPNDB-KEY)
 18785*         GTEQ
 18786*    END-EXEC.
 18787*    MOVE '&"S        G          (   #00016017' TO DFHEIV0
 18788     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18789     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18790     MOVE X'2020233030303136303137' TO DFHEIV0(25:11)
 18791     CALL 'kxdfhei1' USING DFHEIV0,
 18792           FILE-ID,
 18793           DFHEIV20,
 18794           DFHEIV99,
 18795           ERPNDB-KEY,
 18796           DFHEIV99,
 18797           DFHEIV99,
 18798           DFHEIV99
 18799     SET ADDRESS OF PENDING-BUSINESS TO
 18800         DFHEIV20
 18801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18802
 18803
 18804     IF PI-DISPLAY-ORIGINAL-BATCH
 18805        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18806           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18807           GO TO 4150-END-BATCH
 18808        ELSE
 18809           IF PB-BATCH-TRAILER
 18810              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18811              GO TO 4105-READ-NEXT
 18812           ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 345
* EL6311.cbl
 18813              NEXT SENTENCE
 18814     ELSE
 18815        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18816           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18817           GO TO 4150-END-BATCH.
 18818
 18819     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18820
 18821     IF WS-BATCH-PREFIX = '#CL'
 18822         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18823         GO TO 4105-READ-NEXT.
 18824
 18825     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18826     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18827     MOVE PB-STATE               TO PI-PB-STATE.
 18828     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18829
 18830     IF PB-BATCH-TRAILER
 18831        IF SHOW-RECORD
 18832           GO TO 4150-END-BATCH
 18833        ELSE
 18834           MOVE ER-2251         TO EMI-ERROR
 18835           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18836           MOVE 1               TO PI-BROWSE-TYPE
 18837           GO TO 7200-DISPLAY-BATCHES.
 18838
 18839     IF SHOW-RECORD
 18840           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18841              GO TO 4110-BUMP-SEQ
 18842           ELSE
 18843              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18844                 GO TO 4110-BUMP-SEQ
 18845              ELSE
 18846                 GO TO 4107-CHECK-REC-TYPE.
 18847
 18848     IF NOT  PI-PRIMARY-WITH-SELECT
 18849        GO TO 4107-CHECK-REC-TYPE.
 18850
 18851     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18852        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18853           GO TO 4110-BUMP-SEQ
 18854        ELSE
 18855           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18856              GO TO 4107-CHECK-REC-TYPE
 18857           ELSE
 18858              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18859                 GO TO 4107-CHECK-REC-TYPE
 18860              ELSE
 18861                 GO TO 4110-BUMP-SEQ.
 18862
 18863     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18864        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18865           GO TO 4110-BUMP-SEQ.
 18866
 18867 4107-CHECK-REC-TYPE.
 18868     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18869         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18870             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 346
* EL6311.cbl
 18871           ELSE
 18872             GO TO 4110-BUMP-SEQ.
 18873
 18874     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18875         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18876             NEXT SENTENCE
 18877           ELSE
 18878             GO TO 4110-BUMP-SEQ.
 18879
 18880     IF NOT DISPLAY-CHANGE-RECORDS AND
 18881        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18882           GO TO 4110-BUMP-SEQ.
 18883
 18884     IF DISPLAY-HOLD-RECORDS AND
 18885        NOT PB-RECORD-ON-HOLD
 18886          GO TO 4110-BUMP-SEQ.
 18887
 18888     IF PB-ISSUE
 18889        IF DISPLAY-CHK-REQ-RECORDS
 18890            GO TO 4110-BUMP-SEQ.
 18891
 18892     IF PB-ISSUE
 18893        IF ISSUE-WITH-WARNING
 18894           IF PB-WARNING-ERRORS
 18895              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18896                  GO TO 4110-BUMP-SEQ
 18897              ELSE
 18898                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18899                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18900                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18901                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18902                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18903                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18904                 GO TO 7000-DISPLAY-ISSUES
 18905        ELSE
 18906            GO TO 4110-BUMP-SEQ.
 18907
 18908     IF PB-ISSUE
 18909        IF (ISSUES-IN-ERROR AND
 18910            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18911            ALL-ISSUES
 18912            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18913            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18914            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18915            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18916            MOVE PB-SV-STATE            TO PI-SV-STATE
 18917            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18918            GO TO 7000-DISPLAY-ISSUES
 18919        ELSE
 18920            GO TO 4110-BUMP-SEQ.
 18921
 18922     IF PB-CANCELLATION
 18923        IF DISPLAY-CHK-REQ-RECORDS
 18924           IF PB-C-REFUND-REQUESTED
 18925              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18926              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18927              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18928              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 347
* EL6311.cbl
 18929              MOVE PB-SV-STATE            TO PI-SV-STATE
 18930              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18931              GO TO 7100-DISPLAY-CANCELS
 18932           ELSE
 18933              GO TO 4110-BUMP-SEQ.
 18934
 18935     IF PB-CANCELLATION
 18936        IF CANCEL-WITH-WARNING
 18937           IF PB-WARNING-ERRORS
 18938              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18939                  GO TO 4110-BUMP-SEQ
 18940              ELSE
 18941                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18942                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18943                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18944                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18945                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18946                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18947                 GO TO 7100-DISPLAY-CANCELS
 18948           ELSE
 18949              GO TO 4110-BUMP-SEQ.
 18950
 18951     IF PB-CANCELLATION
 18952        IF (CANCEL-IN-ERROR  AND
 18953            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18954            ALL-CANCELS
 18955            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18956            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18957            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18958            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18959            MOVE PB-SV-STATE            TO PI-SV-STATE
 18960            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18961            GO TO 7100-DISPLAY-CANCELS.
 18962
 18963 4110-BUMP-SEQ.
 18964     IF NOT DISPLAY-CHANGE-RECORDS
 18965        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18966        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18967     ELSE
 18968        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18969           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18970           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18971        ELSE
 18972           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18973           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18974
 18975     GO TO 4105-READ-NEXT.
 18976
 18977 4150-END-BATCH.
 18978******************************************************************
 18979*                                                                *
 18980*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18981*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18982*         PROGRAM.                                               *
 18983*                                                                *
 18984******************************************************************
 18985
 18986     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 348
* EL6311.cbl
 18987         IF PENDING-BUS-RECS-FOUND
 18988             NEXT SENTENCE
 18989           ELSE
 18990             MOVE '9'            TO PI-BROWSE-SW
 18991             GO TO 9400-CLEAR.
 18992
 18993     IF SHOW-RECORD
 18994        MOVE ER-2253             TO EMI-ERROR
 18995     ELSE
 18996        MOVE ER-2251             TO EMI-ERROR.
 18997
 18998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18999
 19000     IF PI-MAP-NAME = SPACES
 19001        MOVE -1                  TO BMAINTL
 19002        MOVE EL631B              TO PI-MAP-NAME
 19003        GO TO 8100-SEND-INITIAL-MAP.
 19004
 19005     IF PI-MAP-NAME = EL631B
 19006        MOVE -1                  TO BMAINTL
 19007     ELSE
 19008        IF PI-MAP-NAME = EL631C
 19009           MOVE -1               TO CMAINTL
 19010        ELSE
 19011           MOVE -1               TO DPFENTRL.
 19012
 19013     GO TO 8200-SEND-DATAONLY.
 19014
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 349
* EL6311.cbl
 19016
 19017***************************************************************
 19018*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19019*                                                             *
 19020*      1. START BROWSE WITH                                   *
 19021*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19022*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19023*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19024*                                                             *
 19025*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19026*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19027*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19028*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19029*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19030*               AND IS IT TO BE DISPLAYED.                    *
 19031*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19032*               DISPLAYED.                                    *
 19033*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19034*               DISPLAYED.                                    *
 19035*                                                             *
 19036*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19037*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19038***************************************************************
 19039
 19040 4200-BROWSE-CSR-FORWARD.
 19041
 19042     IF FIRST-TIME
 19043        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19044     ELSE
 19045        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19046
 19047
 19048* EXEC CICS HANDLE CONDITION
 19049*         NOTFND   (4250-END-RECORDS)
 19050*         ENDFILE  (4250-END-RECORDS)
 19051*    END-EXEC.
 19052*    MOVE '"$I''                  ! L #00016267' TO DFHEIV0
 19053     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19054     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19055     MOVE X'4C20233030303136323637' TO DFHEIV0(25:11)
 19056     CALL 'kxdfhei1' USING DFHEIV0
 19057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19058
 19059
 19060
 19061* EXEC CICS STARTBR
 19062*         DATASET   (FILE-ID-ERPNDB4)
 19063*         RIDFLD    (ERPNDB-CSR-KEY)
 19064*    END-EXEC.
 19065     MOVE 0
 19066       TO DFHEIV11
 19067*    MOVE '&,         G          &   #00016272' TO DFHEIV0
 19068     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19069     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19070     MOVE X'2020233030303136323732' TO DFHEIV0(25:11)
 19071     CALL 'kxdfhei1' USING DFHEIV0,
 19072           FILE-ID-ERPNDB4,
 19073           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 350
* EL6311.cbl
 19074           DFHEIV99,
 19075           DFHEIV11,
 19076           DFHEIV99
 19077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19078
 19079
 19080     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19081
 19082     IF FIRST-TIME
 19083        MOVE SPACE               TO WS-FIRST-TIME-SW
 19084        GO TO 4205-READ-NEXT-RECORD.
 19085
 19086
 19087* EXEC CICS READNEXT
 19088*         DATASET    (FILE-ID-ERPNDB4)
 19089*         SET        (ADDRESS OF PENDING-BUSINESS)
 19090*         RIDFLD     (ERPNDB-CSR-KEY)
 19091*    END-EXEC.
 19092     MOVE 0
 19093       TO DFHEIV11
 19094*    MOVE '&.S                   )   #00016283' TO DFHEIV0
 19095     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19096     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19097     MOVE X'2020233030303136323833' TO DFHEIV0(25:11)
 19098     CALL 'kxdfhei1' USING DFHEIV0,
 19099           FILE-ID-ERPNDB4,
 19100           DFHEIV20,
 19101           DFHEIV99,
 19102           ERPNDB-CSR-KEY,
 19103           DFHEIV99,
 19104           DFHEIV11,
 19105           DFHEIV99,
 19106           DFHEIV99
 19107     SET ADDRESS OF PENDING-BUSINESS TO
 19108         DFHEIV20
 19109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19110
 19111
 19112 4205-READ-NEXT-RECORD.
 19113
 19114
 19115* EXEC CICS READNEXT
 19116*         DATASET    (FILE-ID-ERPNDB4)
 19117*         SET        (ADDRESS OF PENDING-BUSINESS)
 19118*         RIDFLD     (ERPNDB-CSR-KEY)
 19119*    END-EXEC.
 19120     MOVE 0
 19121       TO DFHEIV11
 19122*    MOVE '&.S                   )   #00016291' TO DFHEIV0
 19123     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19124     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19125     MOVE X'2020233030303136323931' TO DFHEIV0(25:11)
 19126     CALL 'kxdfhei1' USING DFHEIV0,
 19127           FILE-ID-ERPNDB4,
 19128           DFHEIV20,
 19129           DFHEIV99,
 19130           ERPNDB-CSR-KEY,
 19131           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 351
* EL6311.cbl
 19132           DFHEIV11,
 19133           DFHEIV99,
 19134           DFHEIV99
 19135     SET ADDRESS OF PENDING-BUSINESS TO
 19136         DFHEIV20
 19137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19138
 19139
 19140     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19141
 19142     IF WS-BATCH-PREFIX = '#CL'
 19143        GO TO 4205-READ-NEXT-RECORD.
 19144
 19145     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19146        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19147        GO TO 4250-END-RECORDS.
 19148
 19149     IF PB-BATCH-TRAILER
 19150        GO TO 4205-READ-NEXT-RECORD.
 19151
 19152     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19153        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19154           GO TO 4205-READ-NEXT-RECORD
 19155        ELSE
 19156           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19157              GO TO 4210-CHECK-REC-TYPE
 19158           ELSE
 19159              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19160                 GO TO 4210-CHECK-REC-TYPE
 19161              ELSE
 19162                 GO TO 4205-READ-NEXT-RECORD.
 19163
 19164     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19165        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19166           GO TO 4205-READ-NEXT-RECORD.
 19167
 19168 4210-CHECK-REC-TYPE.
 19169     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19170         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19171             NEXT SENTENCE
 19172         ELSE
 19173             GO TO 4205-READ-NEXT-RECORD.
 19174
 19175     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19176         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19177             NEXT SENTENCE
 19178        ELSE
 19179             GO TO 4205-READ-NEXT-RECORD.
 19180
 19181     IF NOT DISPLAY-CHANGE-RECORDS AND
 19182            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19183        GO TO 4205-READ-NEXT-RECORD.
 19184
 19185     IF DISPLAY-HOLD-RECORDS AND
 19186        NOT PB-RECORD-ON-HOLD
 19187          GO TO 4205-READ-NEXT-RECORD.
 19188
 19189     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 352
* EL6311.cbl
 19190        IF DISPLAY-CHK-REQ-RECORDS
 19191            GO TO 4205-READ-NEXT-RECORD.
 19192
 19193     IF PB-ISSUE
 19194        IF ISSUE-WITH-WARNING
 19195           IF PB-WARNING-ERRORS
 19196              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19197                  GO TO 4205-READ-NEXT-RECORD
 19198              ELSE
 19199                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19200                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19201                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19202                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19203                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19204                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19205                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19206                 GO TO 7000-DISPLAY-ISSUES
 19207           ELSE
 19208              GO TO 4205-READ-NEXT-RECORD.
 19209
 19210     IF PB-ISSUE
 19211        IF (ISSUES-IN-ERROR AND
 19212            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19213            ALL-ISSUES
 19214            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19215            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19216            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19217            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19218            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19219            MOVE PB-SV-STATE            TO PI-SV-STATE
 19220            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19221            GO TO 7000-DISPLAY-ISSUES
 19222        ELSE
 19223            GO TO 4205-READ-NEXT-RECORD.
 19224
 19225     IF PB-CANCELLATION
 19226        IF DISPLAY-CHK-REQ-RECORDS
 19227           IF PB-C-REFUND-REQUESTED
 19228              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19229              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19230              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19231              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19232              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19233              MOVE PB-SV-STATE            TO PI-SV-STATE
 19234              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19235              GO TO 7100-DISPLAY-CANCELS
 19236           ELSE
 19237               GO TO 4205-READ-NEXT-RECORD.
 19238
 19239     IF PB-CANCELLATION
 19240        IF CANCEL-WITH-WARNING
 19241           IF PB-WARNING-ERRORS
 19242              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19243                  GO TO 4205-READ-NEXT-RECORD
 19244              ELSE
 19245                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19246                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19247                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 353
* EL6311.cbl
 19248                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19249                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19250                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19251                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19252                 GO TO 7100-DISPLAY-CANCELS
 19253           ELSE
 19254              GO TO 4205-READ-NEXT-RECORD.
 19255
 19256     IF PB-CANCELLATION
 19257        IF (CANCEL-IN-ERROR  AND
 19258            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19259            ALL-CANCELS
 19260            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19261            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19262            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19263            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19264            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19265            MOVE PB-SV-STATE            TO PI-SV-STATE
 19266            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19267            GO TO 7100-DISPLAY-CANCELS.
 19268
 19269     GO TO 4205-READ-NEXT-RECORD.
 19270
 19271 4250-END-RECORDS.
 19272******************************************************************
 19273*                                                                *
 19274*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19275*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19276*         PROGRAM.                                               *
 19277*                                                                *
 19278******************************************************************
 19279
 19280     IF BROWSE-STARTED
 19281        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19282
 19283* EXEC CICS ENDBR
 19284*            DATASET  (FILE-ID-ERPNDB4)
 19285*       END-EXEC.
 19286     MOVE 0
 19287       TO DFHEIV11
 19288*    MOVE '&2                    $   #00016439' TO DFHEIV0
 19289     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19290     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19291     MOVE X'2020233030303136343339' TO DFHEIV0(25:11)
 19292     CALL 'kxdfhei1' USING DFHEIV0,
 19293           FILE-ID-ERPNDB4,
 19294           DFHEIV11,
 19295           DFHEIV99
 19296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19297
 19298
 19299     IF  EIBTRNID NOT = TRANS-EXB1
 19300         IF PENDING-BUS-RECS-FOUND
 19301             NEXT SENTENCE
 19302           ELSE
 19303             MOVE '9'            TO PI-BROWSE-SW
 19304             GO TO 9400-CLEAR.
 19305
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 354
* EL6311.cbl
 19306     IF SHOW-RECORD
 19307        MOVE ER-2253            TO EMI-ERROR
 19308       ELSE
 19309        MOVE ER-2254            TO EMI-ERROR.
 19310
 19311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19312
 19313     IF PI-MAP-NAME = SPACES
 19314        MOVE -1                  TO DPFENTRL
 19315        MOVE EL631D               TO PI-MAP-NAME
 19316        GO TO 8100-SEND-INITIAL-MAP.
 19317
 19318     IF PI-MAP-NAME = EL631B
 19319        MOVE -1                  TO BMAINTL
 19320     ELSE
 19321        IF PI-MAP-NAME = EL631C
 19322           MOVE -1               TO CMAINTL
 19323        ELSE
 19324           MOVE -1               TO DPFENTRL.
 19325
 19326     GO TO 8200-SEND-DATAONLY.
 19327
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 355
* EL6311.cbl
 19329
 19330***************************************************************
 19331*                                                             *
 19332*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19333*                                                             *
 19334*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19335*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19336*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19337*                                                             *
 19338*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19339*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19340*          A. IS IT WITHIN THE SAME COMPANY                   *
 19341*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19342*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19343*                AND IS IT TO BE DISPLAYED.                   *
 19344*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19345*                DISPLAYED.                                   *
 19346*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19347*                DISPLAYED.                                   *
 19348*                                                             *
 19349*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19350*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19351*                                                             *
 19352*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19353*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19354*                THEY ARE NOT TO BE DISPLAYED.                *
 19355*                                                             *
 19356***************************************************************
 19357
 19358 4300-BROWSE-FILE-FORWARD.
 19359     IF FIRST-TIME OR SHOW-RECORD
 19360        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19361        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19362        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19363     ELSE
 19364        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19365        IF ERPNDB-BATCH-SEQ-NO = +9999
 19366           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19367        ELSE
 19368           IF DISPLAY-CHANGE-RECORDS
 19369              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19370           ELSE
 19371              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19372              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19373
 19374
 19375* EXEC CICS HANDLE CONDITION
 19376*         ENDFILE  (4350-END-BATCH)
 19377*         NOTFND   (4350-END-BATCH)
 19378*    END-EXEC.
 19379*    MOVE '"$''I                  ! M #00016518' TO DFHEIV0
 19380     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19381     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19382     MOVE X'4D20233030303136353138' TO DFHEIV0(25:11)
 19383     CALL 'kxdfhei1' USING DFHEIV0
 19384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19385
 19386
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 356
* EL6311.cbl
 19387 4305-READ-NEXT.
 19388     IF PI-DISPLAY-ORIGINAL-BATCH
 19389        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19390     ELSE
 19391        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19392
 19393
 19394* EXEC CICS READ
 19395*         DATASET   (FILE-ID)
 19396*         SET       (ADDRESS OF PENDING-BUSINESS)
 19397*         RIDFLD    (ERPNDB-KEY)
 19398*         GTEQ
 19399*    END-EXEC.
 19400*    MOVE '&"S        G          (   #00016529' TO DFHEIV0
 19401     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19403     MOVE X'2020233030303136353239' TO DFHEIV0(25:11)
 19404     CALL 'kxdfhei1' USING DFHEIV0,
 19405           FILE-ID,
 19406           DFHEIV20,
 19407           DFHEIV99,
 19408           ERPNDB-KEY,
 19409           DFHEIV99,
 19410           DFHEIV99,
 19411           DFHEIV99
 19412     SET ADDRESS OF PENDING-BUSINESS TO
 19413         DFHEIV20
 19414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19415
 19416
 19417     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19418        GO TO 4350-END-BATCH.
 19419
 19420     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19421                                    WS-BATCH-NO.
 19422
 19423     IF  WS-BATCH-PREFIX = '#CL'
 19424         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19425         GO TO 4305-READ-NEXT.
 19426
 19427     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19428     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19429     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19430     MOVE PB-STATE               TO PI-PB-STATE.
 19431     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19432
 19433     IF PB-BATCH-TRAILER
 19434        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19435        GO TO 4305-READ-NEXT.
 19436
 19437     IF SHOW-RECORD
 19438           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19439              GO TO 4310-BUMP-SEQ
 19440           ELSE
 19441              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19442                 GO TO 4310-BUMP-SEQ
 19443              ELSE
 19444                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 357
* EL6311.cbl
 19445
 19446     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19447        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19448           GO TO 4310-BUMP-SEQ
 19449        ELSE
 19450           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19451              GO TO 4307-CHECK-REC-TYPE
 19452           ELSE
 19453              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19454                 GO TO 4307-CHECK-REC-TYPE
 19455              ELSE
 19456                 GO TO 4310-BUMP-SEQ.
 19457
 19458     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19459        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19460           GO TO 4310-BUMP-SEQ.
 19461
 19462 4307-CHECK-REC-TYPE.
 19463     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19464         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19465             NEXT SENTENCE
 19466         ELSE
 19467             GO TO 4310-BUMP-SEQ.
 19468
 19469     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19470         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19471             NEXT SENTENCE
 19472        ELSE
 19473             GO TO 4310-BUMP-SEQ.
 19474
 19475     IF NOT DISPLAY-CHANGE-RECORDS AND
 19476            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19477        GO TO 4310-BUMP-SEQ.
 19478
 19479     IF DISPLAY-HOLD-RECORDS AND
 19480        NOT PB-RECORD-ON-HOLD
 19481          GO TO 4310-BUMP-SEQ.
 19482
 19483     IF PB-ISSUE
 19484        IF DISPLAY-CHK-REQ-RECORDS
 19485           GO TO 4310-BUMP-SEQ.
 19486
 19487     IF PB-ISSUE
 19488        IF ISSUE-WITH-WARNING
 19489           IF PB-WARNING-ERRORS
 19490              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19491                  GO TO 4310-BUMP-SEQ
 19492              ELSE
 19493                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19494                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19495                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19496                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19497                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19498                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19499                 GO TO 7000-DISPLAY-ISSUES
 19500           ELSE
 19501              GO TO 4310-BUMP-SEQ.
 19502
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 358
* EL6311.cbl
 19503     IF PB-ISSUE
 19504        IF (ISSUES-IN-ERROR AND
 19505            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19506            ALL-ISSUES
 19507            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19508            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19509            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19510            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19511            MOVE PB-SV-STATE            TO PI-SV-STATE
 19512            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19513            GO TO 7000-DISPLAY-ISSUES
 19514        ELSE
 19515            GO TO 4310-BUMP-SEQ.
 19516
 19517     IF PB-CANCELLATION
 19518        IF DISPLAY-CHK-REQ-RECORDS
 19519           IF PB-C-REFUND-REQUESTED
 19520              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19521              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19522              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19523              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19524              MOVE PB-SV-STATE            TO PI-SV-STATE
 19525              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19526              GO TO 7100-DISPLAY-CANCELS
 19527           ELSE
 19528              GO TO 4310-BUMP-SEQ.
 19529
 19530     IF PB-CANCELLATION
 19531        IF CANCEL-WITH-WARNING
 19532           IF PB-WARNING-ERRORS
 19533              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19534                  GO TO 4310-BUMP-SEQ
 19535              ELSE
 19536                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19537                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19538                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19539                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19540                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19541                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19542                 GO TO 7100-DISPLAY-CANCELS
 19543           ELSE
 19544              GO TO 4310-BUMP-SEQ.
 19545
 19546     IF PB-CANCELLATION
 19547        IF (CANCEL-IN-ERROR  AND
 19548            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19549            ALL-CANCELS
 19550            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19551            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19552            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19553            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19554            MOVE PB-SV-STATE            TO PI-SV-STATE
 19555            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19556            GO TO 7100-DISPLAY-CANCELS.
 19557
 19558 4310-BUMP-SEQ.
 19559     IF NOT DISPLAY-CHANGE-RECORDS
 19560        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 359
* EL6311.cbl
 19561        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19562     ELSE
 19563        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19564           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19565           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19566        ELSE
 19567           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19568           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19569
 19570     GO TO 4305-READ-NEXT.
 19571
 19572 4350-END-BATCH.
 19573
 19574******************************************************************
 19575*                                                                *
 19576*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19577*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19578*         PROGRAM.                                               *
 19579*                                                                *
 19580******************************************************************
 19581
 19582     IF  EIBTRNID NOT = TRANS-EXB1
 19583         IF PENDING-BUS-RECS-FOUND
 19584             NEXT SENTENCE
 19585           ELSE
 19586             MOVE '9'            TO PI-BROWSE-SW
 19587             GO TO 9400-CLEAR.
 19588
 19589     IF SHOW-RECORD
 19590        MOVE ER-2253            TO EMI-ERROR
 19591     ELSE
 19592        MOVE ER-2251            TO EMI-ERROR.
 19593
 19594     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19595
 19596     IF PI-MAP-NAME = SPACES
 19597        MOVE -1                  TO BMAINTL
 19598        MOVE EL631B               TO PI-MAP-NAME
 19599        GO TO 8100-SEND-INITIAL-MAP.
 19600
 19601     IF PI-MAP-NAME = EL631B
 19602        MOVE -1                  TO BMAINTL
 19603     ELSE
 19604        IF PI-MAP-NAME = EL631C
 19605           MOVE -1               TO CMAINTL
 19606        ELSE
 19607           MOVE -1               TO DPFENTRL.
 19608
 19609     GO TO 8200-SEND-DATAONLY.
 19610
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 360
* EL6311.cbl
 19612
 19613******************************************************************
 19614*                                                                *
 19615*        B R O W S E   D E T A I L   B A C K W A R D             *
 19616*                                                                *
 19617******************************************************************
 19618
 19619 4500-BROWSE-DETAIL-BACKWARD.
 19620
 19621     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19622
 19623
 19624* EXEC CICS HANDLE CONDITION
 19625*         NOTFND   (4570-NOT-FOUND)
 19626*         ENDFILE  (4550-END-RECORDS)
 19627*    END-EXEC
 19628*    MOVE '"$I''                  ! N #00016742' TO DFHEIV0
 19629     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19630     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19631     MOVE X'4E20233030303136373432' TO DFHEIV0(25:11)
 19632     CALL 'kxdfhei1' USING DFHEIV0
 19633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19634
 19635
 19636* EXEC CICS STARTBR
 19637*         DATASET   (FILE-ID-ERPNDB2)
 19638*         RIDFLD    (ERPNDB-ALT-KEY)
 19639*    END-EXEC.
 19640     MOVE 0
 19641       TO DFHEIV11
 19642*    MOVE '&,         G          &   #00016747' TO DFHEIV0
 19643     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19644     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19645     MOVE X'2020233030303136373437' TO DFHEIV0(25:11)
 19646     CALL 'kxdfhei1' USING DFHEIV0,
 19647           FILE-ID-ERPNDB2,
 19648           ERPNDB-ALT-KEY,
 19649           DFHEIV99,
 19650           DFHEIV11,
 19651           DFHEIV99
 19652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19653
 19654
 19655     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19656                                    WS-FIRST-TIME-SW.
 19657
 19658 4505-READ-PREV-RECORD.
 19659
 19660* EXEC CICS READPREV
 19661*         DATASET    (FILE-ID-ERPNDB2)
 19662*         SET        (ADDRESS OF PENDING-BUSINESS)
 19663*         RIDFLD     (ERPNDB-ALT-KEY)
 19664*    END-EXEC.
 19665     MOVE 0
 19666       TO DFHEIV11
 19667*    MOVE '&0S                   )   #00016756' TO DFHEIV0
 19668     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19669     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 361
* EL6311.cbl
 19670     MOVE X'2020233030303136373536' TO DFHEIV0(25:11)
 19671     CALL 'kxdfhei1' USING DFHEIV0,
 19672           FILE-ID-ERPNDB2,
 19673           DFHEIV20,
 19674           DFHEIV99,
 19675           ERPNDB-ALT-KEY,
 19676           DFHEIV99,
 19677           DFHEIV11,
 19678           DFHEIV99,
 19679           DFHEIV99
 19680     SET ADDRESS OF PENDING-BUSINESS TO
 19681         DFHEIV20
 19682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19683
 19684
 19685     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19686
 19687     IF WS-BATCH-PREFIX = '#CL'
 19688         GO TO 4505-READ-PREV-RECORD.
 19689
 19690     IF FIRST-TIME
 19691         MOVE SPACE               TO WS-FIRST-TIME-SW
 19692         GO TO 4505-READ-PREV-RECORD.
 19693
 19694     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19695        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19696        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19697        PB-STATE         NOT = PI-PB-STATE    OR
 19698        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19699          GO TO 4550-END-RECORDS.
 19700
 19701
 19702     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19703
 19704     IF PB-BATCH-TRAILER
 19705        GO TO 4505-READ-PREV-RECORD.
 19706
 19707     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19708
 19709     IF  WS-BATCH-PREFIX = '#CL'
 19710         GO TO 4505-READ-PREV-RECORD.
 19711
 19712     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19713        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19714           GO TO 4505-READ-PREV-RECORD
 19715        ELSE
 19716           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19717              GO TO 4510-CHECK-REC-TYPE
 19718           ELSE
 19719              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19720                 GO TO 4510-CHECK-REC-TYPE
 19721              ELSE
 19722                 GO TO 4505-READ-PREV-RECORD.
 19723
 19724     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19725        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19726           GO TO 4505-READ-PREV-RECORD.
 19727
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 362
* EL6311.cbl
 19728 4510-CHECK-REC-TYPE.
 19729     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19730         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19731             NEXT SENTENCE
 19732         ELSE
 19733             GO TO 4505-READ-PREV-RECORD.
 19734
 19735     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19736         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19737             NEXT SENTENCE
 19738        ELSE
 19739             GO TO 4505-READ-PREV-RECORD.
 19740
 19741     IF NOT DISPLAY-CHANGE-RECORDS AND
 19742            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19743        GO TO 4505-READ-PREV-RECORD.
 19744
 19745     IF DISPLAY-HOLD-RECORDS AND
 19746        NOT PB-RECORD-ON-HOLD
 19747          GO TO 4505-READ-PREV-RECORD.
 19748
 19749     IF PB-ISSUE
 19750        IF DISPLAY-CHK-REQ-RECORDS
 19751           GO TO 4505-READ-PREV-RECORD.
 19752
 19753     IF PB-ISSUE
 19754        IF ISSUE-WITH-WARNING
 19755           IF PB-WARNING-ERRORS
 19756              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19757                  GO TO 4505-READ-PREV-RECORD
 19758              ELSE
 19759                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19760                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19761                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19762                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19763                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19764                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19765                 GO TO 7000-DISPLAY-ISSUES
 19766           ELSE
 19767              GO TO 4505-READ-PREV-RECORD.
 19768
 19769     IF PB-ISSUE
 19770        IF (ISSUES-IN-ERROR AND
 19771            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19772            ALL-ISSUES
 19773            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19774            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19775            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19776            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19777            MOVE PB-SV-STATE            TO PI-SV-STATE
 19778            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19779            GO TO 7000-DISPLAY-ISSUES
 19780        ELSE
 19781            GO TO 4505-READ-PREV-RECORD.
 19782
 19783     IF PB-CANCELLATION
 19784        IF DISPLAY-CHK-REQ-RECORDS
 19785           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 363
* EL6311.cbl
 19786              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19787              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19788              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19789              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19790              MOVE PB-SV-STATE            TO PI-SV-STATE
 19791              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19792              GO TO 7100-DISPLAY-CANCELS
 19793           ELSE
 19794              GO TO 4505-READ-PREV-RECORD.
 19795
 19796     IF PB-CANCELLATION
 19797        IF CANCEL-WITH-WARNING
 19798           IF PB-WARNING-ERRORS
 19799              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19800                  GO TO 4505-READ-PREV-RECORD
 19801              ELSE
 19802                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19803                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19804                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19805                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19806                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19807                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19808                 GO TO 7100-DISPLAY-CANCELS
 19809           ELSE
 19810              GO TO 4505-READ-PREV-RECORD.
 19811
 19812     IF PB-CANCELLATION
 19813        IF (CANCEL-IN-ERROR  AND
 19814            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19815            ALL-CANCELS
 19816            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19817            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19818            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19819            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19820            MOVE PB-SV-STATE            TO PI-SV-STATE
 19821            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19822            GO TO 7100-DISPLAY-CANCELS.
 19823
 19824     GO TO 4505-READ-PREV-RECORD.
 19825
 19826 4550-END-RECORDS.
 19827     IF PI-MAP-NAME = EL631B
 19828        MOVE -1                  TO BMAINTL
 19829     ELSE
 19830        IF PI-MAP-NAME = EL631C
 19831           MOVE -1               TO CMAINTL
 19832        ELSE
 19833           MOVE -1               TO DPFENTRL.
 19834
 19835     MOVE ER-2255               TO EMI-ERROR.
 19836     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19837     GO TO 8200-SEND-DATAONLY.
 19838
 19839 4570-NOT-FOUND.
 19840
 19841******************************************************************
 19842*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19843******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 364
* EL6311.cbl
 19844
 19845
 19846* EXEC CICS RESETBR
 19847*         DATASET    (FILE-ID-ERPNDB2)
 19848*         RIDFLD     (ERPNDB-ALT-KEY)
 19849*    END-EXEC.
 19850     MOVE 0
 19851       TO DFHEIV11
 19852*    MOVE '&4         G          &   #00016922' TO DFHEIV0
 19853     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19854     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19855     MOVE X'2020233030303136393232' TO DFHEIV0(25:11)
 19856     CALL 'kxdfhei1' USING DFHEIV0,
 19857           FILE-ID-ERPNDB2,
 19858           ERPNDB-ALT-KEY,
 19859           DFHEIV99,
 19860           DFHEIV11,
 19861           DFHEIV99
 19862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19863
 19864
 19865
 19866* EXEC CICS READNEXT
 19867*         DATASET    (FILE-ID-ERPNDB2)
 19868*         SET        (ADDRESS OF PENDING-BUSINESS)
 19869*         RIDFLD     (ERPNDB-ALT-KEY)
 19870*    END-EXEC.
 19871     MOVE 0
 19872       TO DFHEIV11
 19873*    MOVE '&.S                   )   #00016927' TO DFHEIV0
 19874     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19875     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19876     MOVE X'2020233030303136393237' TO DFHEIV0(25:11)
 19877     CALL 'kxdfhei1' USING DFHEIV0,
 19878           FILE-ID-ERPNDB2,
 19879           DFHEIV20,
 19880           DFHEIV99,
 19881           ERPNDB-ALT-KEY,
 19882           DFHEIV99,
 19883           DFHEIV11,
 19884           DFHEIV99,
 19885           DFHEIV99
 19886     SET ADDRESS OF PENDING-BUSINESS TO
 19887         DFHEIV20
 19888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19889
 19890
 19891
 19892* EXEC CICS READPREV
 19893*         DATASET    (FILE-ID-ERPNDB2)
 19894*         SET        (ADDRESS OF PENDING-BUSINESS)
 19895*         RIDFLD     (ERPNDB-ALT-KEY)
 19896*    END-EXEC.
 19897     MOVE 0
 19898       TO DFHEIV11
 19899*    MOVE '&0S                   )   #00016933' TO DFHEIV0
 19900     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19901     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 365
* EL6311.cbl
 19902     MOVE X'2020233030303136393333' TO DFHEIV0(25:11)
 19903     CALL 'kxdfhei1' USING DFHEIV0,
 19904           FILE-ID-ERPNDB2,
 19905           DFHEIV20,
 19906           DFHEIV99,
 19907           ERPNDB-ALT-KEY,
 19908           DFHEIV99,
 19909           DFHEIV11,
 19910           DFHEIV99,
 19911           DFHEIV99
 19912     SET ADDRESS OF PENDING-BUSINESS TO
 19913         DFHEIV20
 19914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19915
 19916
 19917 4580-READ-PREV-RECORD.
 19918
 19919* EXEC CICS READPREV
 19920*         DATASET    (FILE-ID-ERPNDB2)
 19921*         SET        (ADDRESS OF PENDING-BUSINESS)
 19922*         RIDFLD     (ERPNDB-ALT-KEY)
 19923*    END-EXEC.
 19924     MOVE 0
 19925       TO DFHEIV11
 19926*    MOVE '&0S                   )   #00016940' TO DFHEIV0
 19927     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19928     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19929     MOVE X'2020233030303136393430' TO DFHEIV0(25:11)
 19930     CALL 'kxdfhei1' USING DFHEIV0,
 19931           FILE-ID-ERPNDB2,
 19932           DFHEIV20,
 19933           DFHEIV99,
 19934           ERPNDB-ALT-KEY,
 19935           DFHEIV99,
 19936           DFHEIV11,
 19937           DFHEIV99,
 19938           DFHEIV99
 19939     SET ADDRESS OF PENDING-BUSINESS TO
 19940         DFHEIV20
 19941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19942
 19943
 19944     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19945
 19946     IF WS-BATCH-PREFIX = '#CL'
 19947        GO TO 4580-READ-PREV-RECORD.
 19948
 19949     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19950     GO TO 4505-READ-PREV-RECORD.
 19951
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 366
* EL6311.cbl
 19953
 19954******************************************************************
 19955*                                                                *
 19956*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19957*                                                                *
 19958******************************************************************
 19959
 19960 4600-BROWSE-PRIMARY-BACKWARD.
 19961        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19962
 19963     IF ERPNDB-BATCH-SEQ-NO = +9999
 19964        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19965
 19966        IF ERPNDB-BATCH-SEQ-NO = +0000
 19967           GO TO 4650-END-BATCH
 19968        ELSE
 19969           IF PI-MAP-NAME NOT = EL631D
 19970              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19971                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19972              ELSE
 19973                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19974                 IF DISPLAY-CHANGE-RECORDS
 19975                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19976                 ELSE
 19977                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19978
 19979
 19980* EXEC CICS HANDLE CONDITION
 19981*         NOTFND    (4680-NOT-FOUND)
 19982*         ENDFILE   (4680-NOT-FOUND)
 19983*    END-EXEC.
 19984*    MOVE '"$I''                  ! O #00016981' TO DFHEIV0
 19985     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19986     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19987     MOVE X'4F20233030303136393831' TO DFHEIV0(25:11)
 19988     CALL 'kxdfhei1' USING DFHEIV0
 19989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19990
 19991
 19992 4605-READ-NEXT.
 19993     IF ERPNDB-BATCH-SEQ-NO = +0000
 19994        GO TO 4650-END-BATCH.
 19995
 19996     IF PI-DISPLAY-ORIGINAL-BATCH
 19997        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19998     ELSE
 19999        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20000
 20001
 20002* EXEC CICS READ
 20003*         DATASET   (FILE-ID)
 20004*         SET       (ADDRESS OF PENDING-BUSINESS)
 20005*         RIDFLD    (ERPNDB-KEY)
 20006*    END-EXEC.
 20007*    MOVE '&"S        E          (   #00016995' TO DFHEIV0
 20008     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20010     MOVE X'2020233030303136393935' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 367
* EL6311.cbl
 20011     CALL 'kxdfhei1' USING DFHEIV0,
 20012           FILE-ID,
 20013           DFHEIV20,
 20014           DFHEIV99,
 20015           ERPNDB-KEY,
 20016           DFHEIV99,
 20017           DFHEIV99,
 20018           DFHEIV99
 20019     SET ADDRESS OF PENDING-BUSINESS TO
 20020         DFHEIV20
 20021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20022
 20023
 20024     IF NOT  PI-PRIMARY-WITH-SELECT
 20025        GO TO 4607-CHECK-REC-TYPE.
 20026
 20027     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20028
 20029     IF  WS-BATCH-PREFIX = '#CL'
 20030         GO TO 4610-BUMP-SEQ.
 20031
 20032     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20033        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20034           GO TO 4610-BUMP-SEQ
 20035        ELSE
 20036           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20037              GO TO 4607-CHECK-REC-TYPE
 20038           ELSE
 20039              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20040                 GO TO 4607-CHECK-REC-TYPE
 20041              ELSE
 20042                 GO TO 4610-BUMP-SEQ.
 20043
 20044     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20045        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20046           GO TO 4610-BUMP-SEQ.
 20047
 20048 4607-CHECK-REC-TYPE.
 20049     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20050         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20051             NEXT SENTENCE
 20052         ELSE
 20053             GO TO 4610-BUMP-SEQ.
 20054
 20055     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20056         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20057             NEXT SENTENCE
 20058        ELSE
 20059             GO TO 4610-BUMP-SEQ.
 20060
 20061     IF NOT DISPLAY-CHANGE-RECORDS AND
 20062            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20063        GO TO 4610-BUMP-SEQ.
 20064
 20065     IF DISPLAY-HOLD-RECORDS AND
 20066        NOT PB-RECORD-ON-HOLD
 20067          GO TO 4610-BUMP-SEQ.
 20068
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 368
* EL6311.cbl
 20069     IF PB-ISSUE
 20070        IF DISPLAY-CHK-REQ-RECORDS
 20071           GO TO 4610-BUMP-SEQ.
 20072
 20073     IF PB-ISSUE
 20074        IF ISSUE-WITH-WARNING
 20075           IF PB-WARNING-ERRORS
 20076              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20077                  GO TO 4610-BUMP-SEQ
 20078              ELSE
 20079                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20080                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20081                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20082                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20083                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20084                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20085                 GO TO 7000-DISPLAY-ISSUES
 20086           ELSE
 20087              GO TO 4610-BUMP-SEQ.
 20088
 20089     IF PB-ISSUE
 20090        IF (ISSUES-IN-ERROR AND
 20091            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20092            ALL-ISSUES
 20093            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20094            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20095            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20096            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20097            MOVE PB-SV-STATE            TO PI-SV-STATE
 20098            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20099            GO TO 7000-DISPLAY-ISSUES
 20100        ELSE
 20101            GO TO 4610-BUMP-SEQ.
 20102
 20103     IF PB-CANCELLATION
 20104        IF DISPLAY-CHK-REQ-RECORDS
 20105           IF PB-C-REFUND-REQUESTED
 20106              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20107              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20108              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20109              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20110              MOVE PB-SV-STATE            TO PI-SV-STATE
 20111              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20112              GO TO 7100-DISPLAY-CANCELS
 20113           ELSE
 20114              GO TO 4610-BUMP-SEQ.
 20115
 20116     IF PB-CANCELLATION
 20117        IF CANCEL-WITH-WARNING
 20118           IF PB-WARNING-ERRORS
 20119              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20120                  GO TO 4610-BUMP-SEQ
 20121              ELSE
 20122                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20123                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20124                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20125                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20126                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 369
* EL6311.cbl
 20127                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20128                 GO TO 7100-DISPLAY-CANCELS
 20129           ELSE
 20130              GO TO 4610-BUMP-SEQ.
 20131
 20132     IF PB-CANCELLATION
 20133        IF (CANCEL-IN-ERROR  AND
 20134            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20135            ALL-CANCELS
 20136            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20137            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20138            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20139            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20140            MOVE PB-SV-STATE            TO PI-SV-STATE
 20141            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20142            GO TO 7100-DISPLAY-CANCELS.
 20143
 20144 4610-BUMP-SEQ.
 20145     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20146        GO TO 4650-END-BATCH.
 20147
 20148     IF DISPLAY-CHANGE-RECORDS
 20149        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20150           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20151        ELSE
 20152           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20153           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20154        ELSE
 20155           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20156           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20157
 20158        GO TO 4605-READ-NEXT.
 20159
 20160 4650-END-BATCH.
 20161     IF PI-MAP-NAME = EL631B
 20162        MOVE -1                  TO BMAINTL
 20163     ELSE
 20164        IF PI-MAP-NAME = EL631C
 20165           MOVE -1               TO CMAINTL
 20166        ELSE
 20167           MOVE -1               TO DPFENTRL.
 20168
 20169     MOVE ER-2252               TO EMI-ERROR.
 20170     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20171     GO TO 8200-SEND-DATAONLY.
 20172
 20173 4680-NOT-FOUND.
 20174     IF DISPLAY-CHANGE-RECORDS
 20175        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20176           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20177        ELSE
 20178           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20179           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20180     ELSE
 20181        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20182
 20183     GO TO 4605-READ-NEXT.
 20184
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 370
* EL6311.cbl
 20186
 20187******************************************************************
 20188*                                                                *
 20189*        B R O W S E   F I L E   B A C K W A R D S               *
 20190*                                                                *
 20191******************************************************************
 20192
 20193 4800-BROWSE-FILE-BACKWARD.
 20194
 20195* EXEC CICS HANDLE CONDITION
 20196*         NOTFND   (4860-NOT-FOUND)
 20197*         ENDFILE  (4850-END-RECORDS)
 20198*    END-EXEC.
 20199*    MOVE '"$I''                  ! P #00017171' TO DFHEIV0
 20200     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20202     MOVE X'5020233030303137313731' TO DFHEIV0(25:11)
 20203     CALL 'kxdfhei1' USING DFHEIV0
 20204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20205
 20206
 20207     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20208
 20209     IF PI-DISPLAY-ORIGINAL-BATCH
 20210        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20211     ELSE
 20212        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20213
 20214
 20215* EXEC CICS STARTBR
 20216*         DATASET   (FILE-ID)
 20217*         RIDFLD    (ERPNDB-KEY)
 20218*    END-EXEC.
 20219     MOVE 0
 20220       TO DFHEIV11
 20221*    MOVE '&,         G          &   #00017183' TO DFHEIV0
 20222     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20223     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20224     MOVE X'2020233030303137313833' TO DFHEIV0(25:11)
 20225     CALL 'kxdfhei1' USING DFHEIV0,
 20226           FILE-ID,
 20227           ERPNDB-KEY,
 20228           DFHEIV99,
 20229           DFHEIV11,
 20230           DFHEIV99
 20231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20232
 20233
 20234     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20235
 20236
 20237* EXEC CICS READPREV
 20238*         DATASET    (FILE-ID-ERPNDB)
 20239*         SET        (ADDRESS OF PENDING-BUSINESS)
 20240*         RIDFLD     (ERPNDB-KEY)
 20241*    END-EXEC.
 20242     MOVE 0
 20243       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 371
* EL6311.cbl
 20244*    MOVE '&0S                   )   #00017190' TO DFHEIV0
 20245     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20246     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20247     MOVE X'2020233030303137313930' TO DFHEIV0(25:11)
 20248     CALL 'kxdfhei1' USING DFHEIV0,
 20249           FILE-ID-ERPNDB,
 20250           DFHEIV20,
 20251           DFHEIV99,
 20252           ERPNDB-KEY,
 20253           DFHEIV99,
 20254           DFHEIV11,
 20255           DFHEIV99,
 20256           DFHEIV99
 20257     SET ADDRESS OF PENDING-BUSINESS TO
 20258         DFHEIV20
 20259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20260
 20261
 20262 4810-READ-PREV-RECORD.
 20263
 20264* EXEC CICS READPREV
 20265*         DATASET    (FILE-ID-ERPNDB)
 20266*         SET        (ADDRESS OF PENDING-BUSINESS)
 20267*         RIDFLD     (ERPNDB-KEY)
 20268*    END-EXEC.
 20269     MOVE 0
 20270       TO DFHEIV11
 20271*    MOVE '&0S                   )   #00017197' TO DFHEIV0
 20272     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20273     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20274     MOVE X'2020233030303137313937' TO DFHEIV0(25:11)
 20275     CALL 'kxdfhei1' USING DFHEIV0,
 20276           FILE-ID-ERPNDB,
 20277           DFHEIV20,
 20278           DFHEIV99,
 20279           ERPNDB-KEY,
 20280           DFHEIV99,
 20281           DFHEIV11,
 20282           DFHEIV99,
 20283           DFHEIV99
 20284     SET ADDRESS OF PENDING-BUSINESS TO
 20285         DFHEIV20
 20286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20287
 20288
 20289     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20290        GO TO 4850-END-RECORDS.
 20291
 20292     IF PB-BATCH-TRAILER
 20293        GO TO 4810-READ-PREV-RECORD.
 20294
 20295     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20296
 20297     IF  WS-BATCH-PREFIX = '#CL'
 20298         GO TO 4810-READ-PREV-RECORD.
 20299
 20300     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20301        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 372
* EL6311.cbl
 20302           GO TO 4810-READ-PREV-RECORD
 20303        ELSE
 20304           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20305              GO TO 4820-CHECK-REC-TYPE
 20306           ELSE
 20307              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20308                 GO TO 4820-CHECK-REC-TYPE
 20309              ELSE
 20310                 GO TO 4810-READ-PREV-RECORD.
 20311
 20312     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20313        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20314           GO TO 4810-READ-PREV-RECORD.
 20315
 20316 4820-CHECK-REC-TYPE.
 20317     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20318         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20319             NEXT SENTENCE
 20320         ELSE
 20321             GO TO 4810-READ-PREV-RECORD.
 20322
 20323     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20324         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20325             NEXT SENTENCE
 20326        ELSE
 20327             GO TO 4810-READ-PREV-RECORD.
 20328
 20329     IF NOT DISPLAY-CHANGE-RECORDS AND
 20330            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20331        GO TO 4810-READ-PREV-RECORD.
 20332
 20333     IF DISPLAY-HOLD-RECORDS AND
 20334        NOT PB-RECORD-ON-HOLD
 20335          GO TO 4810-READ-PREV-RECORD.
 20336
 20337     IF PB-ISSUE
 20338        IF DISPLAY-CHK-REQ-RECORDS
 20339           GO TO 4810-READ-PREV-RECORD.
 20340
 20341     IF PB-ISSUE
 20342        IF ISSUE-WITH-WARNING
 20343           IF PB-WARNING-ERRORS
 20344              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20345                  GO TO 4810-READ-PREV-RECORD
 20346              ELSE
 20347                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20348                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20349                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20350                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20351                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20352                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20353                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20354                 GO TO 7000-DISPLAY-ISSUES
 20355           ELSE
 20356              GO TO 4810-READ-PREV-RECORD.
 20357
 20358     IF PB-ISSUE
 20359        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 373
* EL6311.cbl
 20360            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20361            ALL-ISSUES
 20362            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20363            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20364            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20365            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20366            MOVE PB-SV-STATE            TO PI-SV-STATE
 20367            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20368            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20369            GO TO 7000-DISPLAY-ISSUES
 20370        ELSE
 20371            GO TO 4810-READ-PREV-RECORD.
 20372
 20373     IF PB-CANCELLATION
 20374        IF DISPLAY-CHK-REQ-RECORDS
 20375           IF PB-C-REFUND-REQUESTED
 20376              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20377              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20378              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20379              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20380              MOVE PB-SV-STATE            TO PI-SV-STATE
 20381              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20382              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20383              GO TO 7100-DISPLAY-CANCELS
 20384           ELSE
 20385              GO TO 4810-READ-PREV-RECORD.
 20386
 20387     IF PB-CANCELLATION
 20388        IF CANCEL-WITH-WARNING
 20389           IF PB-WARNING-ERRORS
 20390              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20391                  GO TO 4810-READ-PREV-RECORD
 20392              ELSE
 20393                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20394                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20395                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20396                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20397                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20398                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20399                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20400                 GO TO 7100-DISPLAY-CANCELS
 20401           ELSE
 20402              GO TO 4810-READ-PREV-RECORD.
 20403
 20404     IF PB-CANCELLATION
 20405        IF (CANCEL-IN-ERROR  AND
 20406            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20407            ALL-CANCELS
 20408            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20409            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20410            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20411            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20412            MOVE PB-SV-STATE            TO PI-SV-STATE
 20413            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20414            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20415            GO TO 7100-DISPLAY-CANCELS.
 20416
 20417     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 374
* EL6311.cbl
 20418
 20419 4850-END-RECORDS.
 20420     MOVE ER-2252                TO EMI-ERROR.
 20421     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20422
 20423     IF PI-MAP-NAME = EL631B
 20424        MOVE -1                  TO BPFENTRL
 20425     ELSE
 20426        MOVE -1                  TO CPFENTRL.
 20427
 20428     GO TO 8200-SEND-DATAONLY.
 20429
 20430 4860-NOT-FOUND.
 20431
 20432******************************************************************
 20433*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20434******************************************************************
 20435
 20436
 20437* EXEC CICS RESETBR
 20438*         DATASET    (FILE-ID-ERPNDB)
 20439*         RIDFLD     (ERPNDB-KEY)
 20440*     END-EXEC.
 20441     MOVE 0
 20442       TO DFHEIV11
 20443*    MOVE '&4         G          &   #00017350' TO DFHEIV0
 20444     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20445     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20446     MOVE X'2020233030303137333530' TO DFHEIV0(25:11)
 20447     CALL 'kxdfhei1' USING DFHEIV0,
 20448           FILE-ID-ERPNDB,
 20449           ERPNDB-KEY,
 20450           DFHEIV99,
 20451           DFHEIV11,
 20452           DFHEIV99
 20453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20454
 20455
 20456
 20457* EXEC CICS READNEXT
 20458*         DATASET    (FILE-ID-ERPNDB)
 20459*         SET        (ADDRESS OF PENDING-BUSINESS)
 20460*         RIDFLD     (ERPNDB-KEY)
 20461*    END-EXEC.
 20462     MOVE 0
 20463       TO DFHEIV11
 20464*    MOVE '&.S                   )   #00017355' TO DFHEIV0
 20465     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20466     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20467     MOVE X'2020233030303137333535' TO DFHEIV0(25:11)
 20468     CALL 'kxdfhei1' USING DFHEIV0,
 20469           FILE-ID-ERPNDB,
 20470           DFHEIV20,
 20471           DFHEIV99,
 20472           ERPNDB-KEY,
 20473           DFHEIV99,
 20474           DFHEIV11,
 20475           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 375
* EL6311.cbl
 20476           DFHEIV99
 20477     SET ADDRESS OF PENDING-BUSINESS TO
 20478         DFHEIV20
 20479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20480
 20481
 20482
 20483* EXEC CICS READPREV
 20484*         DATASET    (FILE-ID-ERPNDB)
 20485*         SET        (ADDRESS OF PENDING-BUSINESS)
 20486*         RIDFLD     (ERPNDB-KEY)
 20487*    END-EXEC.
 20488     MOVE 0
 20489       TO DFHEIV11
 20490*    MOVE '&0S                   )   #00017361' TO DFHEIV0
 20491     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20492     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20493     MOVE X'2020233030303137333631' TO DFHEIV0(25:11)
 20494     CALL 'kxdfhei1' USING DFHEIV0,
 20495           FILE-ID-ERPNDB,
 20496           DFHEIV20,
 20497           DFHEIV99,
 20498           ERPNDB-KEY,
 20499           DFHEIV99,
 20500           DFHEIV11,
 20501           DFHEIV99,
 20502           DFHEIV99
 20503     SET ADDRESS OF PENDING-BUSINESS TO
 20504         DFHEIV20
 20505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20506
 20507
 20508     GO TO 4810-READ-PREV-RECORD.
 20509
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 376
* EL6311.cbl
 20511
 20512******************************************************************
 20513*                                                                *
 20514*           B R O W S E   C S R   B A C K W A R D                *
 20515*                                                                *
 20516******************************************************************
 20517
 20518 4900-BROWSE-CSR-BACKWARD.
 20519
 20520     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20521
 20522
 20523* EXEC CICS HANDLE CONDITION
 20524*         NOTFND   (4970-NOT-FOUND)
 20525*         ENDFILE  (4950-END-RECORDS)
 20526*    END-EXEC
 20527*    MOVE '"$I''                  ! Q #00017381' TO DFHEIV0
 20528     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20530     MOVE X'5120233030303137333831' TO DFHEIV0(25:11)
 20531     CALL 'kxdfhei1' USING DFHEIV0
 20532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20533
 20534
 20535* EXEC CICS STARTBR
 20536*         DATASET   (FILE-ID-ERPNDB4)
 20537*         RIDFLD    (ERPNDB-CSR-KEY)
 20538*    END-EXEC.
 20539     MOVE 0
 20540       TO DFHEIV11
 20541*    MOVE '&,         G          &   #00017386' TO DFHEIV0
 20542     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20543     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20544     MOVE X'2020233030303137333836' TO DFHEIV0(25:11)
 20545     CALL 'kxdfhei1' USING DFHEIV0,
 20546           FILE-ID-ERPNDB4,
 20547           ERPNDB-CSR-KEY,
 20548           DFHEIV99,
 20549           DFHEIV11,
 20550           DFHEIV99
 20551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20552
 20553
 20554     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20555                                    WS-FIRST-TIME-SW.
 20556
 20557 4905-READ-PREV-RECORD.
 20558
 20559* EXEC CICS READPREV
 20560*         DATASET    (FILE-ID-ERPNDB4)
 20561*         SET        (ADDRESS OF PENDING-BUSINESS)
 20562*         RIDFLD     (ERPNDB-CSR-KEY)
 20563*    END-EXEC.
 20564     MOVE 0
 20565       TO DFHEIV11
 20566*    MOVE '&0S                   )   #00017395' TO DFHEIV0
 20567     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20568     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 377
* EL6311.cbl
 20569     MOVE X'2020233030303137333935' TO DFHEIV0(25:11)
 20570     CALL 'kxdfhei1' USING DFHEIV0,
 20571           FILE-ID-ERPNDB4,
 20572           DFHEIV20,
 20573           DFHEIV99,
 20574           ERPNDB-CSR-KEY,
 20575           DFHEIV99,
 20576           DFHEIV11,
 20577           DFHEIV99,
 20578           DFHEIV99
 20579     SET ADDRESS OF PENDING-BUSINESS TO
 20580         DFHEIV20
 20581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20582
 20583
 20584     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20585
 20586     IF WS-BATCH-PREFIX = '#CL'
 20587         GO TO 4905-READ-PREV-RECORD.
 20588
 20589     IF FIRST-TIME
 20590         MOVE SPACE               TO WS-FIRST-TIME-SW
 20591         GO TO 4905-READ-PREV-RECORD.
 20592
 20593     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20594        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20595        GO TO 4950-END-RECORDS.
 20596
 20597     IF PB-BATCH-TRAILER
 20598        GO TO 4905-READ-PREV-RECORD.
 20599
 20600     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20601
 20602     IF  WS-BATCH-PREFIX = '#CL'
 20603         GO TO 4905-READ-PREV-RECORD.
 20604
 20605     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20606        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20607           GO TO 4905-READ-PREV-RECORD
 20608        ELSE
 20609           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20610              GO TO 4910-CHECK-REC-TYPE
 20611           ELSE
 20612              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20613                 GO TO 4910-CHECK-REC-TYPE
 20614              ELSE
 20615                 GO TO 4905-READ-PREV-RECORD.
 20616
 20617     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20618        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20619           GO TO 4905-READ-PREV-RECORD.
 20620
 20621 4910-CHECK-REC-TYPE.
 20622     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20623         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20624             NEXT SENTENCE
 20625         ELSE
 20626             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 378
* EL6311.cbl
 20627
 20628     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20629         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20630             NEXT SENTENCE
 20631        ELSE
 20632             GO TO 4905-READ-PREV-RECORD.
 20633
 20634     IF NOT DISPLAY-CHANGE-RECORDS AND
 20635            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20636        GO TO 4905-READ-PREV-RECORD.
 20637
 20638     IF DISPLAY-HOLD-RECORDS AND
 20639        NOT PB-RECORD-ON-HOLD
 20640          GO TO 4905-READ-PREV-RECORD.
 20641
 20642     IF PB-ISSUE
 20643        IF DISPLAY-CHK-REQ-RECORDS
 20644           GO TO 4905-READ-PREV-RECORD.
 20645
 20646     IF PB-ISSUE
 20647        IF ISSUE-WITH-WARNING
 20648           IF PB-WARNING-ERRORS
 20649              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20650                  GO TO 4505-READ-PREV-RECORD
 20651              ELSE
 20652                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20653                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20654                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20655                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20656                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20657                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20658                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20659                 GO TO 7000-DISPLAY-ISSUES
 20660           ELSE
 20661              GO TO 4905-READ-PREV-RECORD.
 20662
 20663     IF PB-ISSUE
 20664        IF (ISSUES-IN-ERROR AND
 20665            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20666            ALL-ISSUES
 20667            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20668            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20669            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20670            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20671            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20672            MOVE PB-SV-STATE            TO PI-SV-STATE
 20673            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20674            GO TO 7000-DISPLAY-ISSUES
 20675        ELSE
 20676            GO TO 4905-READ-PREV-RECORD.
 20677
 20678     IF PB-CANCELLATION
 20679        IF DISPLAY-CHK-REQ-RECORDS
 20680           IF PB-C-REFUND-REQUESTED
 20681              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20682              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20683              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20684              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 379
* EL6311.cbl
 20685              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20686              MOVE PB-SV-STATE            TO PI-SV-STATE
 20687              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20688              GO TO 7100-DISPLAY-CANCELS
 20689           ELSE
 20690              GO TO 4905-READ-PREV-RECORD.
 20691
 20692     IF PB-CANCELLATION
 20693        IF CANCEL-WITH-WARNING
 20694           IF PB-WARNING-ERRORS
 20695              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20696                  GO TO 4505-READ-PREV-RECORD
 20697              ELSE
 20698                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20699                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20700                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20701                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20702                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20703                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20704                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20705                 GO TO 7100-DISPLAY-CANCELS
 20706           ELSE
 20707              GO TO 4905-READ-PREV-RECORD.
 20708
 20709     IF PB-CANCELLATION
 20710        IF (CANCEL-IN-ERROR  AND
 20711            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20712            ALL-CANCELS
 20713            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20714            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20715            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20716            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20717            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20718            MOVE PB-SV-STATE            TO PI-SV-STATE
 20719            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20720            GO TO 7100-DISPLAY-CANCELS.
 20721
 20722     GO TO 4905-READ-PREV-RECORD.
 20723
 20724 4950-END-RECORDS.
 20725     IF PI-MAP-NAME = EL631B
 20726        MOVE -1                  TO BMAINTL
 20727     ELSE
 20728        IF PI-MAP-NAME = EL631C
 20729           MOVE -1               TO CMAINTL
 20730        ELSE
 20731           MOVE -1               TO DPFENTRL.
 20732
 20733     MOVE ER-2255               TO EMI-ERROR.
 20734     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20735     GO TO 8200-SEND-DATAONLY.
 20736
 20737 4970-NOT-FOUND.
 20738
 20739******************************************************************
 20740*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20741******************************************************************
 20742
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 380
* EL6311.cbl
 20743
 20744* EXEC CICS RESETBR
 20745*         DATASET    (FILE-ID-ERPNDB4)
 20746*         RIDFLD     (ERPNDB-CSR-KEY)
 20747*    END-EXEC.
 20748     MOVE 0
 20749       TO DFHEIV11
 20750*    MOVE '&4         G          &   #00017560' TO DFHEIV0
 20751     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20752     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20753     MOVE X'2020233030303137353630' TO DFHEIV0(25:11)
 20754     CALL 'kxdfhei1' USING DFHEIV0,
 20755           FILE-ID-ERPNDB4,
 20756           ERPNDB-CSR-KEY,
 20757           DFHEIV99,
 20758           DFHEIV11,
 20759           DFHEIV99
 20760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20761
 20762
 20763
 20764* EXEC CICS READNEXT
 20765*         DATASET    (FILE-ID-ERPNDB4)
 20766*         SET        (ADDRESS OF PENDING-BUSINESS)
 20767*         RIDFLD     (ERPNDB-CSR-KEY)
 20768*    END-EXEC.
 20769     MOVE 0
 20770       TO DFHEIV11
 20771*    MOVE '&.S                   )   #00017565' TO DFHEIV0
 20772     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20773     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20774     MOVE X'2020233030303137353635' TO DFHEIV0(25:11)
 20775     CALL 'kxdfhei1' USING DFHEIV0,
 20776           FILE-ID-ERPNDB4,
 20777           DFHEIV20,
 20778           DFHEIV99,
 20779           ERPNDB-CSR-KEY,
 20780           DFHEIV99,
 20781           DFHEIV11,
 20782           DFHEIV99,
 20783           DFHEIV99
 20784     SET ADDRESS OF PENDING-BUSINESS TO
 20785         DFHEIV20
 20786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20787
 20788
 20789
 20790* EXEC CICS READPREV
 20791*         DATASET    (FILE-ID-ERPNDB4)
 20792*         SET        (ADDRESS OF PENDING-BUSINESS)
 20793*         RIDFLD     (ERPNDB-CSR-KEY)
 20794*    END-EXEC.
 20795     MOVE 0
 20796       TO DFHEIV11
 20797*    MOVE '&0S                   )   #00017571' TO DFHEIV0
 20798     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20799     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20800     MOVE X'2020233030303137353731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 381
* EL6311.cbl
 20801     CALL 'kxdfhei1' USING DFHEIV0,
 20802           FILE-ID-ERPNDB4,
 20803           DFHEIV20,
 20804           DFHEIV99,
 20805           ERPNDB-CSR-KEY,
 20806           DFHEIV99,
 20807           DFHEIV11,
 20808           DFHEIV99,
 20809           DFHEIV99
 20810     SET ADDRESS OF PENDING-BUSINESS TO
 20811         DFHEIV20
 20812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20813
 20814
 20815 4980-READ-PREV-RECORD.
 20816
 20817* EXEC CICS READPREV
 20818*         DATASET    (FILE-ID-ERPNDB4)
 20819*         SET        (ADDRESS OF PENDING-BUSINESS)
 20820*         RIDFLD     (ERPNDB-CSR-KEY)
 20821*    END-EXEC.
 20822     MOVE 0
 20823       TO DFHEIV11
 20824*    MOVE '&0S                   )   #00017578' TO DFHEIV0
 20825     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20826     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20827     MOVE X'2020233030303137353738' TO DFHEIV0(25:11)
 20828     CALL 'kxdfhei1' USING DFHEIV0,
 20829           FILE-ID-ERPNDB4,
 20830           DFHEIV20,
 20831           DFHEIV99,
 20832           ERPNDB-CSR-KEY,
 20833           DFHEIV99,
 20834           DFHEIV11,
 20835           DFHEIV99,
 20836           DFHEIV99
 20837     SET ADDRESS OF PENDING-BUSINESS TO
 20838         DFHEIV20
 20839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20840
 20841
 20842     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20843
 20844     IF WS-BATCH-PREFIX = '#CL'
 20845        GO TO 4980-READ-PREV-RECORD.
 20846
 20847     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20848     GO TO 4905-READ-PREV-RECORD.
 20849
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 382
* EL6311.cbl
 20851
 20852
 20853******************************************************************
 20854*                                                                *
 20855*        B R O W S E   B A T C H   H E A D E R S                 *
 20856*                                                                *
 20857******************************************************************
 20858
 20859 5000-BROWSE-BATCH-HEADERS.
 20860
 20861     IF EIBTRNID NOT = TRANS-EXB1
 20862        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20863        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20864        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20865        GO TO 5010-READ-NEXT-RECORD.
 20866
 20867     IF EIBAID = DFHPF4
 20868        MOVE '0'                TO PI-EDIT-SW
 20869        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20870        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20871        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20872        GO TO 5010-READ-NEXT-RECORD.
 20873
 20874     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20875     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20876     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20877
 20878
 20879* EXEC CICS HANDLE CONDITION
 20880*         ENDFILE  (5050-NOT-FOUND)
 20881*    END-EXEC.
 20882*    MOVE '"$''                   ! R #00017620' TO DFHEIV0
 20883     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20885     MOVE X'5220233030303137363230' TO DFHEIV0(25:11)
 20886     CALL 'kxdfhei1' USING DFHEIV0
 20887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20888
 20889
 20890 5010-READ-NEXT-RECORD.
 20891
 20892* EXEC CICS HANDLE CONDITION
 20893*         NOTFND    (5050-NOT-FOUND)
 20894*    END-EXEC.
 20895*    MOVE '"$I                   ! S #00017625' TO DFHEIV0
 20896     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20898     MOVE X'5320233030303137363235' TO DFHEIV0(25:11)
 20899     CALL 'kxdfhei1' USING DFHEIV0
 20900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20901
 20902
 20903
 20904* EXEC CICS READ
 20905*         DATASET   (FILE-ID-ERPNDB)
 20906*         SET       (ADDRESS OF PENDING-BUSINESS)
 20907*         RIDFLD    (ERPNDB-KEY)
 20908*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 383
* EL6311.cbl
 20909*    END-EXEC.
 20910*    MOVE '&"S        G          (   #00017629' TO DFHEIV0
 20911     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20912     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20913     MOVE X'2020233030303137363239' TO DFHEIV0(25:11)
 20914     CALL 'kxdfhei1' USING DFHEIV0,
 20915           FILE-ID-ERPNDB,
 20916           DFHEIV20,
 20917           DFHEIV99,
 20918           ERPNDB-KEY,
 20919           DFHEIV99,
 20920           DFHEIV99,
 20921           DFHEIV99
 20922     SET ADDRESS OF PENDING-BUSINESS TO
 20923         DFHEIV20
 20924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20925
 20926
 20927     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20928         GO TO 5050-NOT-FOUND.
 20929
 20930     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20931
 20932     IF WS-BATCH-PREFIX = '#CL'
 20933         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20934         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20935         GO TO 5010-READ-NEXT-RECORD.
 20936
 20937     IF NOT PB-BATCH-TRAILER
 20938         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20939         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20940         GO TO 5010-READ-NEXT-RECORD.
 20941
 20942     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20943         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20944             NEXT SENTENCE
 20945         ELSE
 20946             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20947             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20948             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20949             GO TO 5010-READ-NEXT-RECORD.
 20950
 20951     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20952         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20953             NEXT SENTENCE
 20954        ELSE
 20955             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20956             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20957             GO TO 5010-READ-NEXT-RECORD.
 20958
 20959     IF EIBAID = DFHPF4
 20960        MOVE '0'                TO PI-EDIT-SW
 20961        GO TO 7200-DISPLAY-BATCHES.
 20962
 20963     IF PI-CSR-BROWSE
 20964        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20965           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20966           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 384
* EL6311.cbl
 20967           GO TO 5010-READ-NEXT-RECORD.
 20968
 20969     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20970       IF PI-PB-CARRIER    = SPACES AND
 20971          PI-PB-GROUPING   = SPACES AND
 20972          PI-PB-STATE      = SPACES AND
 20973          PI-PB-ACCOUNT    = SPACES
 20974            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20975            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20976            GO TO 7200-DISPLAY-BATCHES
 20977         ELSE
 20978           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20979              PI-PB-GROUPING   = PB-GROUPING AND
 20980              PI-PB-STATE      = PB-STATE    AND
 20981              PI-PB-ACCOUNT    = PB-ACCOUNT
 20982              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20983              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20984              GO TO 7200-DISPLAY-BATCHES.
 20985
 20986     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20987     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20988
 20989
 20990* EXEC CICS HANDLE CONDITION
 20991*         NOTFND    (5050-NOT-FOUND)
 20992*    END-EXEC.
 20993*    MOVE '"$I                   ! T #00017698' TO DFHEIV0
 20994     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20996     MOVE X'5420233030303137363938' TO DFHEIV0(25:11)
 20997     CALL 'kxdfhei1' USING DFHEIV0
 20998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20999
 21000
 21001
 21002* EXEC CICS READ
 21003*         DATASET   (FILE-ID-ERPNDB)
 21004*         SET       (ADDRESS OF PENDING-BUSINESS)
 21005*         RIDFLD    (ERPNDB-KEY)
 21006*         GTEQ
 21007*    END-EXEC.
 21008*    MOVE '&"S        G          (   #00017702' TO DFHEIV0
 21009     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21010     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21011     MOVE X'2020233030303137373032' TO DFHEIV0(25:11)
 21012     CALL 'kxdfhei1' USING DFHEIV0,
 21013           FILE-ID-ERPNDB,
 21014           DFHEIV20,
 21015           DFHEIV99,
 21016           ERPNDB-KEY,
 21017           DFHEIV99,
 21018           DFHEIV99,
 21019           DFHEIV99
 21020     SET ADDRESS OF PENDING-BUSINESS TO
 21021         DFHEIV20
 21022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21023
 21024
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 385
* EL6311.cbl
 21025     GO TO 5010-READ-NEXT-RECORD.
 21026
 21027 5050-NOT-FOUND.
 21028
 21029******************************************************************
 21030*                                                                *
 21031*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21032*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21033*         PROGRAM.                                               *
 21034*                                                                *
 21035******************************************************************
 21036
 21037     IF EIBTRNID NOT = TRANS-EXB1
 21038        IF PENDING-BUS-RECS-FOUND
 21039            NEXT SENTENCE
 21040          ELSE
 21041            MOVE '9'            TO PI-BROWSE-SW
 21042            GO TO 9400-CLEAR.
 21043
 21044     MOVE ER-2256                TO EMI-ERROR.
 21045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21046
 21047     IF PI-MAP-NAME = SPACES
 21048        MOVE EL631D              TO PI-MAP-NAME
 21049        MOVE -1                  TO DPFENTRL
 21050        GO TO 8100-SEND-INITIAL-MAP.
 21051
 21052     IF PI-MAP-NAME = EL631B
 21053        MOVE -1                  TO BMAINTL
 21054     ELSE
 21055        IF PI-MAP-NAME = EL631C
 21056           MOVE -1               TO CMAINTL
 21057        ELSE
 21058           MOVE -1               TO DPFENTRL
 21059           GO TO 8200-SEND-DATAONLY.
 21060
 21061     GO TO 8100-SEND-INITIAL-MAP.
 21062
 21063     .
 21064 5100-PROCESS-POL-RESC.
 21065     MOVE ZEROS                  TO CG-LF-BENCD
 21066                                    CG-AH-BENCD
 21067                                    CG-LF-CAN-AMT
 21068                                    CG-AH-CAN-AMT
 21069     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21070                                    CG-AH-CAN-DT
 21071     MOVE SPACES                 TO CG-BATCH-NO
 21072     MOVE '4'                    TO CG-OPTION-CODE
 21073     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21074     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21075     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21076     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21077     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21078     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21079     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21080     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21081     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21082     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 386
* EL6311.cbl
 21083     MOVE PI-PREV-ALT-KEY (1:33)
 21084                                 TO CG-CERT-KEY
 21085     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21086     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21087                                    CG-AH-CAN-AMT
 21088     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21089                                    CG-AH-CAN-DT
 21090     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21091     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21092      display 'about to cancel ' cg-cert-key
 21093
 21094* EXEC CICS LINK
 21095*        PROGRAM  ('ELCANC')
 21096*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21097*    END-EXEC
 21098     MOVE LENGTH OF
 21099      CANCEL-GEN-PASS-AREA
 21100       TO DFHEIV11
 21101     MOVE 'ELCANC' TO DFHEIV1
 21102*    MOVE '."C                   (   #00017777' TO DFHEIV0
 21103     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21104     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21105     MOVE X'2020233030303137373737' TO DFHEIV0(25:11)
 21106     CALL 'kxdfhei1' USING DFHEIV0,
 21107           DFHEIV1,
 21108           CANCEL-GEN-PASS-AREA,
 21109           DFHEIV11,
 21110           DFHEIV99,
 21111           DFHEIV99,
 21112           DFHEIV99,
 21113           DFHEIV99
 21114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21115     IF CG-SUCCESS
 21116        CONTINUE
 21117     ELSE
 21118        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21119        MOVE '3'                 TO EMI-SWITCH1
 21120        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21121        EVALUATE TRUE
 21122           WHEN CG-DATE-ERROR
 21123             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21124           WHEN CG-CERT-NOT-FOUND
 21125             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21126           WHEN CG-AMOUNT-ERROR
 21127             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21128           WHEN CG-OPTION-ERROR
 21129             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21130           WHEN CG-PREV-CAN
 21131             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21132           WHEN CG-INVALID-DATA
 21133             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21134           WHEN CG-NO-ACCT-MSTR
 21135             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21136           WHEN CG-SFX-A-EXIST
 21137             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21138           WHEN CG-MISC-ERROR
 21139             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21140           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 387
* EL6311.cbl
 21141             MOVE ' ERROR - ELCANC - RETURN '
 21142                                 TO EMI-ERROR-TEXT (1) (12:25)
 21143        END-EVALUATE
 21144        GO TO 8200-SEND-DATAONLY
 21145     END-IF
 21146     .
 21147 5100-EXIT.
 21148     EXIT.
 21149
 21150******************************************************************
 21151*                                                                *
 21152*        B R O W S E   B A T C H   B A C K W A R D S             *
 21153*                                                                *
 21154******************************************************************
 21155
 21156 5500-BROWSE-BATCH-BACKWARD.
 21157
 21158* EXEC CICS HANDLE CONDITION
 21159*         NOTFND   (5550-END-RECORDS)
 21160*         ENDFILE  (5550-END-RECORDS)
 21161*    END-EXEC.
 21162*    MOVE '"$I''                  ! U #00017823' TO DFHEIV0
 21163     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21165     MOVE X'5520233030303137383233' TO DFHEIV0(25:11)
 21166     CALL 'kxdfhei1' USING DFHEIV0
 21167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21168
 21169
 21170 5505-START-BROWSE.
 21171     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21172     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21173     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21174
 21175
 21176* EXEC CICS STARTBR
 21177*         DATASET   (FILE-ID-ERPNDB)
 21178*         RIDFLD    (ERPNDB-ALT-KEY)
 21179*    END-EXEC.
 21180     MOVE 0
 21181       TO DFHEIV11
 21182*    MOVE '&,         G          &   #00017833' TO DFHEIV0
 21183     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21184     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21185     MOVE X'2020233030303137383333' TO DFHEIV0(25:11)
 21186     CALL 'kxdfhei1' USING DFHEIV0,
 21187           FILE-ID-ERPNDB,
 21188           ERPNDB-ALT-KEY,
 21189           DFHEIV99,
 21190           DFHEIV11,
 21191           DFHEIV99
 21192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21193
 21194
 21195     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21196
 21197
 21198* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 388
* EL6311.cbl
 21199*         DATASET    (FILE-ID-ERPNDB)
 21200*         SET        (ADDRESS OF PENDING-BUSINESS)
 21201*         RIDFLD     (ERPNDB-KEY)
 21202*    END-EXEC.
 21203     MOVE 0
 21204       TO DFHEIV11
 21205*    MOVE '&.S                   )   #00017840' TO DFHEIV0
 21206     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21207     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21208     MOVE X'2020233030303137383430' TO DFHEIV0(25:11)
 21209     CALL 'kxdfhei1' USING DFHEIV0,
 21210           FILE-ID-ERPNDB,
 21211           DFHEIV20,
 21212           DFHEIV99,
 21213           ERPNDB-KEY,
 21214           DFHEIV99,
 21215           DFHEIV11,
 21216           DFHEIV99,
 21217           DFHEIV99
 21218     SET ADDRESS OF PENDING-BUSINESS TO
 21219         DFHEIV20
 21220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21221
 21222
 21223
 21224* EXEC CICS READPREV
 21225*         DATASET    (FILE-ID-ERPNDB)
 21226*         SET        (ADDRESS OF PENDING-BUSINESS)
 21227*         RIDFLD     (ERPNDB-KEY)
 21228*    END-EXEC.
 21229     MOVE 0
 21230       TO DFHEIV11
 21231*    MOVE '&0S                   )   #00017846' TO DFHEIV0
 21232     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21233     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21234     MOVE X'2020233030303137383436' TO DFHEIV0(25:11)
 21235     CALL 'kxdfhei1' USING DFHEIV0,
 21236           FILE-ID-ERPNDB,
 21237           DFHEIV20,
 21238           DFHEIV99,
 21239           ERPNDB-KEY,
 21240           DFHEIV99,
 21241           DFHEIV11,
 21242           DFHEIV99,
 21243           DFHEIV99
 21244     SET ADDRESS OF PENDING-BUSINESS TO
 21245         DFHEIV20
 21246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21247
 21248
 21249
 21250* EXEC CICS READPREV
 21251*         DATASET    (FILE-ID-ERPNDB)
 21252*         SET        (ADDRESS OF PENDING-BUSINESS)
 21253*         RIDFLD     (ERPNDB-KEY)
 21254*    END-EXEC.
 21255     MOVE 0
 21256       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 389
* EL6311.cbl
 21257*    MOVE '&0S                   )   #00017852' TO DFHEIV0
 21258     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21259     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21260     MOVE X'2020233030303137383532' TO DFHEIV0(25:11)
 21261     CALL 'kxdfhei1' USING DFHEIV0,
 21262           FILE-ID-ERPNDB,
 21263           DFHEIV20,
 21264           DFHEIV99,
 21265           ERPNDB-KEY,
 21266           DFHEIV99,
 21267           DFHEIV11,
 21268           DFHEIV99,
 21269           DFHEIV99
 21270     SET ADDRESS OF PENDING-BUSINESS TO
 21271         DFHEIV20
 21272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21273
 21274
 21275     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21276        GO TO 5550-END-RECORDS.
 21277
 21278     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21279
 21280     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21281
 21282     IF  WS-BATCH-PREFIX = '#CL'
 21283             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21284
 21285* EXEC CICS ENDBR
 21286*                 DATASET  (FILE-ID-ERPNDB)
 21287*            END-EXEC
 21288     MOVE 0
 21289       TO DFHEIV11
 21290*    MOVE '&2                    $   #00017867' TO DFHEIV0
 21291     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21292     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21293     MOVE X'2020233030303137383637' TO DFHEIV0(25:11)
 21294     CALL 'kxdfhei1' USING DFHEIV0,
 21295           FILE-ID-ERPNDB,
 21296           DFHEIV11,
 21297           DFHEIV99
 21298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21299         GO TO 5505-START-BROWSE.
 21300
 21301     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21302         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21303             NEXT SENTENCE
 21304         ELSE
 21305             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21306
 21307* EXEC CICS ENDBR
 21308*                 DATASET  (FILE-ID-ERPNDB)
 21309*            END-EXEC
 21310     MOVE 0
 21311       TO DFHEIV11
 21312*    MOVE '&2                    $   #00017877' TO DFHEIV0
 21313     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21314     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 390
* EL6311.cbl
 21315     MOVE X'2020233030303137383737' TO DFHEIV0(25:11)
 21316     CALL 'kxdfhei1' USING DFHEIV0,
 21317           FILE-ID-ERPNDB,
 21318           DFHEIV11,
 21319           DFHEIV99
 21320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21321             GO TO 5505-START-BROWSE.
 21322
 21323
 21324     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21325         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21326             NEXT SENTENCE
 21327        ELSE
 21328             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21329
 21330* EXEC CICS ENDBR
 21331*                 DATASET  (FILE-ID-ERPNDB)
 21332*            END-EXEC
 21333     MOVE 0
 21334       TO DFHEIV11
 21335*    MOVE '&2                    $   #00017888' TO DFHEIV0
 21336     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21337     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21338     MOVE X'2020233030303137383838' TO DFHEIV0(25:11)
 21339     CALL 'kxdfhei1' USING DFHEIV0,
 21340           FILE-ID-ERPNDB,
 21341           DFHEIV11,
 21342           DFHEIV99
 21343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21344             GO TO 5505-START-BROWSE.
 21345
 21346     IF NOT PB-BATCH-TRAILER
 21347        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21348
 21349* EXEC CICS ENDBR
 21350*            DATASET  (FILE-ID-ERPNDB)
 21351*       END-EXEC
 21352     MOVE 0
 21353       TO DFHEIV11
 21354*    MOVE '&2                    $   #00017895' TO DFHEIV0
 21355     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21356     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21357     MOVE X'2020233030303137383935' TO DFHEIV0(25:11)
 21358     CALL 'kxdfhei1' USING DFHEIV0,
 21359           FILE-ID-ERPNDB,
 21360           DFHEIV11,
 21361           DFHEIV99
 21362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21363        GO TO 5505-START-BROWSE.
 21364
 21365     IF PI-CSR-BROWSE
 21366        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21367           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21368
 21369* EXEC CICS ENDBR
 21370*               DATASET  (FILE-ID-ERPNDB)
 21371*          END-EXEC
 21372     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 391
* EL6311.cbl
 21373       TO DFHEIV11
 21374*    MOVE '&2                    $   #00017903' TO DFHEIV0
 21375     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21376     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21377     MOVE X'2020233030303137393033' TO DFHEIV0(25:11)
 21378     CALL 'kxdfhei1' USING DFHEIV0,
 21379           FILE-ID-ERPNDB,
 21380           DFHEIV11,
 21381           DFHEIV99
 21382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21383           GO TO 5505-START-BROWSE.
 21384
 21385     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21386        IF PI-PB-CARRIER    = SPACES AND
 21387           PI-PB-GROUPING   = SPACES AND
 21388           PI-PB-STATE      = SPACES AND
 21389           PI-PB-ACCOUNT    = SPACES
 21390             GO TO 7200-DISPLAY-BATCHES
 21391          ELSE
 21392            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21393               PI-PB-GROUPING   = PB-GROUPING AND
 21394               PI-PB-STATE      = PB-STATE    AND
 21395               PI-PB-ACCOUNT    = PB-ACCOUNT
 21396                 GO TO 7200-DISPLAY-BATCHES.
 21397
 21398     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21399
 21400
 21401* EXEC CICS ENDBR
 21402*         DATASET  (FILE-ID-ERPNDB)
 21403*    END-EXEC.
 21404     MOVE 0
 21405       TO DFHEIV11
 21406*    MOVE '&2                    $   #00017923' TO DFHEIV0
 21407     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21408     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21409     MOVE X'2020233030303137393233' TO DFHEIV0(25:11)
 21410     CALL 'kxdfhei1' USING DFHEIV0,
 21411           FILE-ID-ERPNDB,
 21412           DFHEIV11,
 21413           DFHEIV99
 21414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21415
 21416
 21417     GO TO 5505-START-BROWSE.
 21418
 21419 5550-END-RECORDS.
 21420     MOVE ER-2257                TO EMI-ERROR.
 21421     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21422     MOVE -1                     TO DPFENTRL.
 21423
 21424     GO TO 8200-SEND-DATAONLY.
 21425
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 392
* EL6311.cbl
 21427
 21428******************************************************************
 21429*                                                                *
 21430*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21431*                                                                *
 21432******************************************************************
 21433
 21434 6000-CREATE-TEMP-STORAGE.
 21435
 21436
 21437* EXEC CICS HANDLE CONDITION
 21438*        QIDERR  (6050-QID-ERROR)
 21439*    END-EXEC.
 21440*    MOVE '"$N                   ! V #00017946' TO DFHEIV0
 21441     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21443     MOVE X'5620233030303137393436' TO DFHEIV0(25:11)
 21444     CALL 'kxdfhei1' USING DFHEIV0
 21445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21446
 21447
 21448
 21449* EXEC CICS WRITEQ TS
 21450*        QUEUE    (QID)
 21451*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21452*        LENGTH   (WS-COMM-LENGTH)
 21453*        ITEM     (W-ONE)
 21454*    END-EXEC.
 21455*    MOVE '*" I                  ''   #00017950' TO DFHEIV0
 21456     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21457     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21458     MOVE X'2020233030303137393530' TO DFHEIV0(25:11)
 21459     CALL 'kxdfhei1' USING DFHEIV0,
 21460           QID,
 21461           PROGRAM-INTERFACE-BLOCK,
 21462           WS-COMM-LENGTH,
 21463           W-ONE,
 21464           DFHEIV99,
 21465           DFHEIV99
 21466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21467
 21468
 21469 6000-EXIT.
 21470      EXIT.
 21471
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 393
* EL6311.cbl
 21473
 21474******************************************************************
 21475*                                                                *
 21476*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21477*                                                                *
 21478******************************************************************
 21479
 21480 6050-RECOVER-TEMP-STORAGE.
 21481     IF PGM-NAME = XCTL-EL6312
 21482        GO TO 6050-EXIT.
 21483
 21484     IF PGM-NAME = XCTL-EL6313
 21485        GO TO 6050-EXIT.
 21486
 21487     IF PGM-NAME = XCTL-EL6315
 21488         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21489     END-IF
 21490
 21491     IF PGM-NAME = XCTL-EL6316
 21492         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21493     END-IF
 21494
 21495
 21496* EXEC CICS HANDLE CONDITION
 21497*        QIDERR  (6050-QID-ERROR)
 21498*    END-EXEC.
 21499*    MOVE '"$N                   ! W #00017983' TO DFHEIV0
 21500     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21502     MOVE X'5720233030303137393833' TO DFHEIV0(25:11)
 21503     CALL 'kxdfhei1' USING DFHEIV0
 21504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21505
 21506
 21507
 21508* EXEC CICS READQ TS
 21509*         QUEUE   (QID)
 21510*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21511*         LENGTH  (WS-COMM-LENGTH)
 21512*         ITEM    (W-ONE)
 21513*     END-EXEC.
 21514*    MOVE '*$II   L              ''   #00017987' TO DFHEIV0
 21515     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21516     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21517     MOVE X'2020233030303137393837' TO DFHEIV0(25:11)
 21518     CALL 'kxdfhei1' USING DFHEIV0,
 21519           QID,
 21520           PROGRAM-INTERFACE-BLOCK,
 21521           WS-COMM-LENGTH,
 21522           W-ONE,
 21523           DFHEIV99,
 21524           DFHEIV99
 21525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21526
 21527
 21528 6050-DELETE-TEMP-STORAGE.
 21529
 21530
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 394
* EL6311.cbl
 21531* EXEC CICS DELETEQ TS
 21532*        QUEUE   (QID)
 21533*    END-EXEC.
 21534*    MOVE '*&                    #   #00017996' TO DFHEIV0
 21535     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21536     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21537     MOVE X'2020233030303137393936' TO DFHEIV0(25:11)
 21538     CALL 'kxdfhei1' USING DFHEIV0,
 21539           QID,
 21540           DFHEIV99
 21541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21542
 21543
 21544     GO TO 6050-EXIT.
 21545
 21546 6050-QID-ERROR.
 21547     MOVE ER-0033                TO EMI-ERROR
 21548     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21549
 21550 6050-EXIT.
 21551      EXIT.
 21552
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 395
* EL6311.cbl
 21554
 21555******************************************************************
 21556*                                                                *
 21557*            T E R M   C O N V E R S I O N                       *
 21558*                                                                *
 21559******************************************************************
 21560
 21561 6100-TERM-CONVERSION.
 21562
 21563     IF PI-BPMTS = ZERO
 21564         GO TO 6199-EXIT.
 21565
 21566     IF PI-BMODE = ' ' OR 'M'
 21567         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21568         GO TO 6105-ROUND-TERM.
 21569
 21570     IF PI-BMODE = 'S'
 21571         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21572         GO TO 6105-ROUND-TERM.
 21573
 21574     IF PI-BMODE = 'W'
 21575         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21576         GO TO 6105-ROUND-TERM.
 21577
 21578     IF PI-BMODE = 'B'
 21579         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21580         GO TO 6105-ROUND-TERM.
 21581
 21582     IF PI-BMODE = 'T'
 21583         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21584
 21585 6105-ROUND-TERM.
 21586
 21587     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21588         ADD +1                  TO WS-CALC-TERM-WHOLE
 21589         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21590
 21591     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21592         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21593
 21594     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21595         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21596                                      WS-BTERM    (WS-SUB1)
 21597         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21598
 21599     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21600         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21601             MOVE -1               TO BMODEL
 21602             MOVE ER-2593          TO EMI-ERROR
 21603             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21604             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21605
 21606 6124-CHECK-BENEFIT.
 21607
 21608     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21609        GO TO 6126-COMPUTE-BENEFIT.
 21610
 21611     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 396
* EL6311.cbl
 21612
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 397
* EL6311.cbl
 21614******************************************************************
 21615**         COMPUTE TERM AND BENEFIT
 21616******************************************************************
 21617 6125-COMPUTE-TERM-BENEFIT.
 21618
 21619     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21620        PI-BPMTAMT = ZERO
 21621         GO TO 6199-EXIT.
 21622
 21623     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21624                                     WS-BTERM  (WS-SUB1).
 21625     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21626
 21627 6126-COMPUTE-BENEFIT.
 21628
 21629     IF PI-BMODE = 'M' OR  ' '
 21630         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21631
 21632     IF PI-BMODE = 'W'
 21633         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21634
 21635     IF PI-BMODE = 'S'
 21636         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21637
 21638     IF PI-BMODE = 'B'
 21639         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21640
 21641     IF PI-BMODE = 'T'
 21642         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21643
 21644     IF WS-SUB1 = +1
 21645        COMPUTE WS-BBEN (WS-SUB1) =
 21646                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21647
 21648     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21649     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21650     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21651
 21652 6199-EXIT.
 21653     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 398
* EL6311.cbl
 21655
 21656******************************************************************
 21657*                                                                *
 21658*             D I S P L A Y   I S S U E S                        *
 21659*                                                                *
 21660******************************************************************
 21661
 21662 6200-CREATE-VADS.
 21663     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21664     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21665     MOVE SPACES                 TO WS-PASS-VADS-REC
 21666
 21667* EXEC CICS GETMAIN
 21668*       SET      (ADDRESS OF PENDING-BUSINESS)
 21669*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21670*       INITIMG  (GETMAIN-SPACE)
 21671*       RESP     (WS-RESPONSE)
 21672*    END-EXEC
 21673*    MOVE ',"IL                  $  N#00018122' TO DFHEIV0
 21674     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21675     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21676     MOVE X'204E233030303138313232' TO DFHEIV0(25:11)
 21677     CALL 'kxdfhei1' USING DFHEIV0,
 21678           DFHEIV20,
 21679           ERPNDB-RECORD-LENGTH,
 21680           GETMAIN-SPACE
 21681     SET ADDRESS OF PENDING-BUSINESS TO
 21682         DFHEIV20
 21683     MOVE EIBRESP  TO WS-RESPONSE
 21684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21685
 21686* EXEC CICS READ
 21687*       INTO    (PENDING-BUSINESS)
 21688*       DATASET (FILE-ID-ERPNDB)
 21689*       RIDFLD  (ERPNDB-KEY)
 21690*       RESP    (WS-RESPONSE)
 21691*    END-EXEC
 21692     MOVE LENGTH OF
 21693      PENDING-BUSINESS
 21694       TO DFHEIV11
 21695*    MOVE '&"IL       E          (  N#00018128' TO DFHEIV0
 21696     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21697     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21698     MOVE X'204E233030303138313238' TO DFHEIV0(25:11)
 21699     CALL 'kxdfhei1' USING DFHEIV0,
 21700           FILE-ID-ERPNDB,
 21701           PENDING-BUSINESS,
 21702           DFHEIV11,
 21703           ERPNDB-KEY,
 21704           DFHEIV99,
 21705           DFHEIV99,
 21706           DFHEIV99
 21707     MOVE EIBRESP  TO WS-RESPONSE
 21708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21709     IF RESP-NORMAL
 21710        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21711        IF (RESP-NORMAL)
 21712           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 399
* EL6311.cbl
 21713              AM-CONTROL-PRIMARY (1:20))
 21714           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21715        ELSE
 21716           MOVE 'ACCOUNT NOT FOUND'
 21717                                 TO VD-ACCOUNT-NAME
 21718        END-IF
 21719        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21720                                    TO M1
 21721        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21722        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21723           (A2 > M1)
 21724           OR (WS-WORK-FIELD (A2:1) = '*')
 21725           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21726           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21727        END-PERFORM
 21728        IF A2 > M1
 21729           CONTINUE
 21730        ELSE
 21731           MOVE WS-WORK-FIELD (1:A2 - 1)
 21732                                    TO VD-ACCOUNT-NAME
 21733        END-IF
 21734        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21735        MOVE PB-CARRIER          TO VD-CARRIER
 21736        MOVE PB-GROUPING         TO VD-GROUPING
 21737        MOVE PB-STATE            TO VD-STATE
 21738        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21739        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21740        MOVE PB-CERT-NO          TO VD-CERT-NO
 21741        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21742        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21743        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21744        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21745        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21746        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21747        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21748        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21749        MOVE PB-CSR-ID           TO VD-CSR-ID
 21750        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21751        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21752        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21753        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21754        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21755        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21756        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21757        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21758        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21759        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21760        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21761        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21762        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21763     END-IF
 21764     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21765
 21766
 21767* EXEC CICS GETMAIN
 21768*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21769*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21770*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 400
* EL6311.cbl
 21771*       RESP     (WS-RESPONSE)
 21772*    END-EXEC
 21773*    MOVE ',"IL                  $  N#00018191' TO DFHEIV0
 21774     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21775     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21776     MOVE X'204E233030303138313931' TO DFHEIV0(25:11)
 21777     CALL 'kxdfhei1' USING DFHEIV0,
 21778           DFHEIV20,
 21779           ERPNDM-RECORD-LENGTH,
 21780           GETMAIN-SPACE
 21781     SET ADDRESS OF PENDING-MAILING-DATA TO
 21782         DFHEIV20
 21783     MOVE EIBRESP  TO WS-RESPONSE
 21784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21785
 21786
 21787* EXEC CICS READ
 21788*       INTO    (PENDING-MAILING-DATA)
 21789*       DATASET (FILE-ID-ERPNDM)
 21790*       RIDFLD  (ERPNDM-KEY)
 21791*       RESP    (WS-RESPONSE)
 21792*    END-EXEC
 21793     MOVE LENGTH OF
 21794      PENDING-MAILING-DATA
 21795       TO DFHEIV11
 21796*    MOVE '&"IL       E          (  N#00018198' TO DFHEIV0
 21797     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21798     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21799     MOVE X'204E233030303138313938' TO DFHEIV0(25:11)
 21800     CALL 'kxdfhei1' USING DFHEIV0,
 21801           FILE-ID-ERPNDM,
 21802           PENDING-MAILING-DATA,
 21803           DFHEIV11,
 21804           ERPNDM-KEY,
 21805           DFHEIV99,
 21806           DFHEIV99,
 21807           DFHEIV99
 21808     MOVE EIBRESP  TO WS-RESPONSE
 21809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21810
 21811     IF RESP-NORMAL
 21812        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21813        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21814        MOVE PM-CITY              TO VD-INSURED-CITY
 21815        MOVE PM-STATE             TO VD-INSURED-STATE
 21816        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21817     END-IF
 21818
 21819     MOVE 'VAC1'                  TO VD-LETTER-ID
 21820     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21821     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21822     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21823     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21824     MOVE +0                      TO VD-ARCHIVE-NO
 21825     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21826     .
 21827 6200-EXIT.
 21828     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 401
* EL6311.cbl
 21829 6210-READ-ERACCT.
 21830     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21831     MOVE LOW-VALUES             TO ERACCT-FILL
 21832
 21833* EXEC CICS READ
 21834*         DATASET   ('ERACCT')
 21835*         INTO      (ACCOUNT-MASTER)
 21836*         RIDFLD    (ERACCT-KEY)
 21837*         GTEQ
 21838*         RESP      (WS-RESPONSE)
 21839*    END-EXEC
 21840     MOVE LENGTH OF
 21841      ACCOUNT-MASTER
 21842       TO DFHEIV11
 21843     MOVE 'ERACCT' TO DFHEIV1
 21844*    MOVE '&"IL       G          (  N#00018226' TO DFHEIV0
 21845     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21846     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21847     MOVE X'204E233030303138323236' TO DFHEIV0(25:11)
 21848     CALL 'kxdfhei1' USING DFHEIV0,
 21849           DFHEIV1,
 21850           ACCOUNT-MASTER,
 21851           DFHEIV11,
 21852           ERACCT-KEY,
 21853           DFHEIV99,
 21854           DFHEIV99,
 21855           DFHEIV99
 21856     MOVE EIBRESP  TO WS-RESPONSE
 21857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21858     .
 21859 6210-EXIT.
 21860     EXIT.
 21861
 21862 6220-READ-ERMAIL.
 21863
 21864     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21865     MOVE ' '                    TO WS-ERMAIL-SW
 21866
 21867
 21868* EXEC CICS READ
 21869*       DATASET   (FILE-ID-ERMAIL)
 21870*       SET       (ADDRESS OF MAILING-DATA)
 21871*       RIDFLD    (ERMAIL-KEY)
 21872*       RESP      (WS-RESPONSE)
 21873*    END-EXEC
 21874*    MOVE '&"S        E          (  N#00018242' TO DFHEIV0
 21875     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21877     MOVE X'204E233030303138323432' TO DFHEIV0(25:11)
 21878     CALL 'kxdfhei1' USING DFHEIV0,
 21879           FILE-ID-ERMAIL,
 21880           DFHEIV20,
 21881           DFHEIV99,
 21882           ERMAIL-KEY,
 21883           DFHEIV99,
 21884           DFHEIV99,
 21885           DFHEIV99
 21886     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 402
* EL6311.cbl
 21887         DFHEIV20
 21888     MOVE EIBRESP  TO WS-RESPONSE
 21889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21890
 21891     IF RESP-NORMAL
 21892        SET ERMAIL-FOUND TO TRUE
 21893     END-IF
 21894     .
 21895 6220-EXIT.
 21896     EXIT.
 21897
 21898 6400-CHECK-FOR-RES-REF-CLAIM.
 21899     display 'made it to 6400- for ' pi-cert-no
 21900     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21901
 21902     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21903                                    W-CL-COMP-CD.
 21904     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21905                                    W-CL-CERT-NO.
 21906     MOVE SPACES                 TO MSTR-CERT-SFX.
 21907
 21908
 21909* EXEC CICS HANDLE CONDITION
 21910*        NOTFND  (6400-CONTINUE)
 21911*        ENDFILE (6400-CONTINUE)
 21912*    END-EXEC.
 21913*    MOVE '"$I''                  ! X #00018266' TO DFHEIV0
 21914     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21916     MOVE X'5820233030303138323636' TO DFHEIV0(25:11)
 21917     CALL 'kxdfhei1' USING DFHEIV0
 21918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21919
 21920
 21921
 21922* EXEC CICS IGNORE CONDITION
 21923*        DUPKEY
 21924*    END-EXEC.
 21925*    MOVE '"*$                   !   #00018271' TO DFHEIV0
 21926     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21927     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21928     MOVE X'2020233030303138323731' TO DFHEIV0(25:11)
 21929     CALL 'kxdfhei1' USING DFHEIV0
 21930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21931
 21932
 21933
 21934* EXEC CICS STARTBR
 21935*        DATASET   (CLMS-ID)
 21936*        RIDFLD    (ELMSTR-KEY)
 21937*        GENERIC   EQUAL
 21938*        KEYLENGTH (ELMSTR-LENGTH)
 21939*    END-EXEC.
 21940     MOVE 0
 21941       TO DFHEIV11
 21942*    MOVE '&,   KG    E          &   #00018275' TO DFHEIV0
 21943     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21944     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 403
* EL6311.cbl
 21945     MOVE X'2020233030303138323735' TO DFHEIV0(25:11)
 21946     CALL 'kxdfhei1' USING DFHEIV0,
 21947           CLMS-ID,
 21948           ELMSTR-KEY,
 21949           ELMSTR-LENGTH,
 21950           DFHEIV11,
 21951           DFHEIV99
 21952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21953
 21954
 21955     display 'browse started'
 21956     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21957
 21958 6400-NEXT-CLAIM.
 21959
 21960
 21961* EXEC CICS READNEXT
 21962*        DATASET   (CLMS-ID)
 21963*        RIDFLD    (ELMSTR-KEY)
 21964*        SET       (ADDRESS OF CLAIM-MASTER)
 21965*    END-EXEC.
 21966     MOVE 0
 21967       TO DFHEIV11
 21968*    MOVE '&.S                   )   #00018287' TO DFHEIV0
 21969     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21970     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21971     MOVE X'2020233030303138323837' TO DFHEIV0(25:11)
 21972     CALL 'kxdfhei1' USING DFHEIV0,
 21973           CLMS-ID,
 21974           DFHEIV20,
 21975           DFHEIV99,
 21976           ELMSTR-KEY,
 21977           DFHEIV99,
 21978           DFHEIV11,
 21979           DFHEIV99,
 21980           DFHEIV99
 21981     SET ADDRESS OF CLAIM-MASTER TO
 21982         DFHEIV20
 21983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21984
 21985
 21986     display 'read claim for ' mstr-cert-no
 21987     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21988        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21989         GO TO 6400-CONTINUE
 21990     END-IF.
 21991
 21992     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21993        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21994        PI-STATE       NOT = CL-CERT-STATE     OR
 21995        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21996        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21997         GO TO 6400-NEXT-CLAIM
 21998     END-IF.
 21999
 22000     display 'found claim ' cl-claim-no
 22001        ' with denial type ' cl-denial-type
 22002     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 404
* EL6311.cbl
 22003         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22004         GO TO 6400-CONTINUE
 22005     END-IF.
 22006
 22007     GO TO 6400-NEXT-CLAIM.
 22008
 22009 6400-CONTINUE.
 22010
 22011     IF WS-BROWSE-STARTED-SW = 'Y'
 22012
 22013* EXEC CICS ENDBR
 22014*            DATASET   (CLMS-ID)
 22015*        END-EXEC
 22016     MOVE 0
 22017       TO DFHEIV11
 22018*    MOVE '&2                    $   #00018319' TO DFHEIV0
 22019     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22020     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22021     MOVE X'2020233030303138333139' TO DFHEIV0(25:11)
 22022     CALL 'kxdfhei1' USING DFHEIV0,
 22023           CLMS-ID,
 22024           DFHEIV11,
 22025           DFHEIV99
 22026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22027         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22028     END-IF.
 22029
 22030 6400-EXIT.
 22031     EXIT.
 22032
 22033 7000-DISPLAY-ISSUES.
 22034
 22035     IF PI-DISPLAY-ORIGINAL-BATCH
 22036        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22037        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22038     ELSE
 22039        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22040
 22041     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22042
 22043     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22044     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22045
 22046     MOVE LOW-VALUES                 TO EL631BI.
 22047     MOVE ZEROS                      TO PI-BPMTAMT
 22048                                        PI-BPMTS.
 22049     MOVE SPACE                      TO PI-BMODE
 22050                                        PI-BTYPE (1)
 22051                                        PI-BTYPE (2).
 22052     MOVE EL631B                     TO PI-MAP-NAME.
 22053     MOVE 'Y'                        TO PI-BROWSE-SW.
 22054     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22055                                        PI-HIGH-SEQ-NO.
 22056
 22057     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22058        MOVE AL-SABOF                TO BCHGTA
 22059        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22060        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 405
* EL6311.cbl
 22061     ELSE
 22062        MOVE AL-SADOF                TO BCHGTA
 22063                                        BCHGA
 22064        MOVE PB-CHG-COUNT            TO BCHGO.
 22065
 22066     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22067     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22068     MOVE WS-HR-MINS                 TO BMANTATO.
 22069
 22070     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22071        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22072        MOVE SPACE                   TO DC-OPTION-CODE
 22073        PERFORM 9700-DATE-LINK
 22074        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22075        MOVE 'INACTIVE'              TO BMOENDTO
 22076     ELSE
 22077        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22078        MOVE SPACE                   TO DC-OPTION-CODE
 22079        PERFORM 9700-DATE-LINK
 22080        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22081        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22082        MOVE SPACE                   TO DC-OPTION-CODE
 22083        PERFORM 9700-DATE-LINK
 22084        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22085
 22086*    MOVE PB-I-REFERENCE             TO BREFO.
 22087
 22088*    IF PI-COMPANY-ID EQUAL 'HER'
 22089*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22090*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22091*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22092*                MOVE WS-MEMBER-NO-1-8
 22093*                                TO  BMICRNOO.
 22094
 22095*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22096*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22097*            MOVE PB-I-MICROFILM-NO
 22098*                                TO  BMICRNOO.
 22099     IF PB-I-VIN NOT = SPACES
 22100        MOVE PB-I-VIN            TO BVINO
 22101     END-IF
 22102
 22103     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22104     MOVE PB-CERT-SFX                TO BSUFIXO.
 22105     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22106     MOVE SPACE                      TO DC-OPTION-CODE.
 22107     PERFORM 9700-DATE-LINK.
 22108     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22109
 22110     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22111     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22112     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22113     MOVE PB-I-INSURED-SEX           TO BSEXO
 22114
 22115     IF PB-I-AGE NOT = ZEROS
 22116         MOVE PB-I-AGE               TO BAGEO.
 22117
 22118     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 406
* EL6311.cbl
 22119                                 TO ELCERT-KEY
 22120     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22121     IF NOT CERT-TRL-REC-NOT-FOUND
 22122         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22123             MOVE 'AGE*'             TO BAGEDEFO
 22124         ELSE
 22125             MOVE 'AGE '             TO BAGEDEFO
 22126         END-IF
 22127     ELSE
 22128         MOVE 'AGE '             TO BAGEDEFO
 22129     END-IF
 22130
 22131     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22132         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22133         MOVE SPACE                  TO DC-OPTION-CODE
 22134         PERFORM 9700-DATE-LINK
 22135         IF NO-CONVERSION-ERROR
 22136            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22137
 22138     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22139         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22140         MOVE SPACE                  TO DC-OPTION-CODE
 22141         PERFORM 9700-DATE-LINK
 22142         IF NO-CONVERSION-ERROR
 22143            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22144
 22145     IF PB-I-EXTENTION-DAYS NUMERIC
 22146        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22147           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22148        ELSE
 22149           IF PB-I-TERM-IN-DAYS NUMERIC
 22150              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22151                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22152
 22153     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22154        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22155
 22156     MOVE PB-FORCE-CODE              TO BFORCEO.
 22157     MOVE PB-I-TERM-TYPE             TO BMODEO
 22158                                        PI-BMODE.
 22159
 22160     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22161        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22162
 22163     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22164         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22165                                        PI-BPMTS.
 22166
 22167     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22168         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22169           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22170                                        PI-BPMTAMT.
 22171
 22172     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22173     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22174     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22175     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22176     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 407
* EL6311.cbl
 22177     MOVE PB-I-SIG-SW                TO BSIGO.
 22178     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22179     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22180     MOVE PB-RECORD-BILL             TO BBILCDO.
 22181     MOVE PB-FORCE-CODE              TO BFORCEO.
 22182
 22183     IF (PB-I-LIVES NUMERIC)
 22184        AND (PB-I-LIVES > ZEROS)
 22185        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22186        IF (RESP-NORMAL)
 22187           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22188           CONTINUE
 22189        ELSE
 22190           MOVE PB-I-LIVES       TO BLIVESO
 22191        END-IF
 22192     END-IF
 22193
 22194     IF PB-I-NUM-BILLED NUMERIC AND
 22195        PB-I-NUM-BILLED GREATER THAN ZEROS
 22196        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22197*    ELSE
 22198*       MOVE ZEROS                   TO BBILLEDO.
 22199
 22200     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22201
 22202     IF PB-I-LOAN-APR NOT = +99.9999
 22203        MOVE PB-I-LOAN-APR           TO BAPRO.
 22204
 22205     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22206        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22207
 22208     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22209        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22210           MOVE AL-SANOF                TO BORIGHDA
 22211           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22212           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22213
 22214     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22215
 22216     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22217        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22218
 22219     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22220        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22221                                        PI-BTYPE (1).
 22222
 22223     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22224        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22225
 22226     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22227        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22228
 22229     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22230        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22231
 22232     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22233        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22234
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 408
* EL6311.cbl
 22235     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22236        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22237
 22238     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22239         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22240         MOVE SPACE                  TO DC-OPTION-CODE
 22241         PERFORM 9700-DATE-LINK
 22242         IF NO-CONVERSION-ERROR
 22243            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22244
 22245     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22246        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22247        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22248        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22249        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22250                 GIVING BDIFFO (1)
 22251     ELSE
 22252        MOVE SPACES                  TO BBEN-CD     (1)
 22253                                        BBEN-ABBR   (1).
 22254
 22255     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22256        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22257        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22258                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22259
 22260     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22261       IF PB-RECORD-ON-HOLD
 22262          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22263
 22264     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22265       IF PB-RECORD-RETURNED
 22266          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22267
 22268     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22269        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22270             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22271
 22272     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22273
 22274     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22275        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22276
 22277     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22278        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22279                                        PI-BTYPE (2).
 22280
 22281     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22282        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22283
 22284     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22285        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22286
 22287     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22288        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22289
 22290     IF PB-I-TOT-FEES NOT NUMERIC
 22291        MOVE ZEROS               TO PB-I-TOT-FEES
 22292     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 409
* EL6311.cbl
 22293     IF PB-I-TOT-FEES > ZEROS
 22294        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22295
 22296     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22297         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22298         MOVE SPACE                  TO DC-OPTION-CODE
 22299         PERFORM 9700-DATE-LINK
 22300         IF NO-CONVERSION-ERROR
 22301            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22302
 22303     IF PB-I-TOT-FEES > ZEROS
 22304        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22305        SUBTRACT PB-I-TOT-FEES FROM
 22306                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22307
 22308     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22309        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22310        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22311        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22312        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22313                 GIVING BDIFFO (2)
 22314     ELSE
 22315        MOVE SPACES                  TO BBEN-CD     (2)
 22316                                        BBEN-ABBR   (2).
 22317
 22318     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22319       IF PB-RECORD-ON-HOLD
 22320          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22321
 22322     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22323       IF PB-RECORD-RETURNED
 22324          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22325
 22326     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22327        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22328             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22329
 22330     MOVE PB-CSR-ID                  TO BCSRO.
 22331
 22332     IF PI-COMPANY-ID  =  'DMD'
 22333        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22334            NEXT SENTENCE
 22335        ELSE
 22336            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22337               MOVE 'NEW CERT'       TO BNCERTLI
 22338               MOVE EC-NEW-CERT      TO BNCERTO.
 22339
 22340     IF PI-COMPANY-ID  =  'DMD'
 22341        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22342            NEXT SENTENCE
 22343        ELSE
 22344           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22345               MOVE 'NEW STATE'      TO BNSTATLI
 22346               MOVE EC-NEW-STATE     TO BNSTATO.
 22347
 22348 7000-CONTINUE.
 22349     MOVE 'C'                        TO BMAINTI.
 22350     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 410
* EL6311.cbl
 22351
 22352     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22353        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22354
 22355     IF PI-6315-FINALIZED = 'Y'   AND
 22356        PB-UNFORCED-ERRORS
 22357          MOVE -1                TO BFORCEL
 22358          MOVE  1                TO SET-CURSOR-SW
 22359     END-IF
 22360
 22361     IF NO-CURSOR-SET
 22362        MOVE -1                      TO BMAINTL.
 22363
 22364     GO TO 8100-SEND-INITIAL-MAP.
 22365
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 411
* EL6311.cbl
 22367
 22368******************************************************************
 22369*                                                                *
 22370*             D I S P L A Y   C A N C E L S                      *
 22371*                                                                *
 22372******************************************************************
 22373
 22374 7100-DISPLAY-CANCELS.
 22375     IF PI-DISPLAY-ORIGINAL-BATCH
 22376        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22377        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22378     ELSE
 22379        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22380
 22381     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22382
 22383     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22384     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22385
 22386     MOVE LOW-VALUES                 TO EL631CI.
 22387     MOVE EL631C                     TO PI-MAP-NAME.
 22388     MOVE 'Y'                        TO PI-BROWSE-SW.
 22389     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22390                                        PI-HIGH-SEQ-NO.
 22391
 22392     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22393        MOVE AL-SABOF                TO CCHGTA
 22394        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22395        MOVE AL-SANON                TO CCHGA
 22396      ELSE
 22397        MOVE AL-SADOF                TO CCHGTA
 22398                                        CCHGA
 22399        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22400
 22401*    MOVE PB-C-REFERENCE             TO CREFO.
 22402
 22403*    IF PB-C-MICROFILM-NO IS NUMERIC
 22404*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22405*          MOVE PB-C-MICROFILM-NO
 22406*                                TO CMICRNOO
 22407*          MOVE AL-UNNON         TO CMICRNOA
 22408*       END-IF
 22409*    END-IF
 22410     IF PB-C-NH-INT-ON-REFS NUMERIC
 22411        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22412           MOVE PB-C-NH-INT-ON-REFS
 22413                                 TO CNHINTO
 22414           MOVE AL-SANOF         TO CNHINTA
 22415        END-IF
 22416     END-IF
 22417     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22418     MOVE PB-CERT-SFX                TO CSUFIXO.
 22419     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22420     MOVE SPACE                      TO DC-OPTION-CODE.
 22421     PERFORM 9700-DATE-LINK.
 22422     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22423
 22424     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 412
* EL6311.cbl
 22425        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22426        MOVE SPACE                   TO DC-OPTION-CODE
 22427        PERFORM 9700-DATE-LINK
 22428        IF NO-CONVERSION-ERROR
 22429           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22430
 22431     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22432        NEXT SENTENCE
 22433     ELSE
 22434        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22435
 22436     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22437        NEXT SENTENCE
 22438     ELSE
 22439        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22440
 22441     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22442        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22443        MOVE SPACE                   TO DC-OPTION-CODE
 22444        PERFORM 9700-DATE-LINK
 22445        IF NO-CONVERSION-ERROR
 22446           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22447
 22448     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22449         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22450
 22451     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22452         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22453
 22454     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22455        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22456        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22457                 GIVING CDRFND1O.
 22458
 22459     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22460        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22461        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22462                 GIVING CDRFND2O.
 22463
 22464     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22465       IF PB-RECORD-ON-HOLD
 22466          MOVE 'ON HOLD'             TO CBILIT1O.
 22467
 22468     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22469       IF PB-RECORD-RETURNED
 22470          MOVE 'RETURNED'            TO CBILIT1O.
 22471
 22472     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22473        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22474             MOVE 'OVERRIDE'         TO CBILIT1O.
 22475
 22476     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22477       IF PB-RECORD-ON-HOLD
 22478          MOVE 'ON HOLD'             TO CBILIT2O.
 22479
 22480     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22481       IF PB-RECORD-RETURNED
 22482          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 413
* EL6311.cbl
 22483
 22484     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22485        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22486             MOVE 'OVERRIDE'         TO CBILIT2O.
 22487
 22488     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22489     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22490     IF PB-C-POST-CARD-IND = 'Y'
 22491        MOVE 'Y'                     TO CPCYNO
 22492     ELSE
 22493        MOVE 'N'                     TO CPCYNO
 22494     END-IF
 22495     MOVE PB-FORCE-CODE              TO CFORCEO.
 22496     MOVE PB-RECORD-BILL             TO CBILCDO.
 22497     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22498     MOVE SPACES                     TO CINITSO.
 22499     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22500         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22501     ELSE
 22502         MOVE PB-CI-INITIALS         TO CINITSO
 22503     END-IF.
 22504
 22505     IF PB-CI-CANCEL-FEE NUMERIC
 22506        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22507        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22508     ELSE
 22509        MOVE ZEROES                  TO W-CANCEL-FEE.
 22510
 22511     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22512
 22513     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22514        ADD PB-CI-LF-PREMIUM-AMT
 22515             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22516
 22517     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22518        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22519
 22520     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22521     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22522     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22523     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22524
 22525     IF PB-C-LIVES NUMERIC
 22526        MOVE PB-C-LIVES              TO CLIVESO.
 22527
 22528     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22529        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22530
 22531     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22532        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22533        MOVE SPACE                   TO DC-OPTION-CODE
 22534        PERFORM 9700-DATE-LINK
 22535        IF NO-CONVERSION-ERROR
 22536           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22537
 22538     IF  PB-C-REFUND-CREATED
 22539         MOVE 'YES'                  TO CRFNDSWO
 22540     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 414
* EL6311.cbl
 22541         IF PB-C-REFUND-REQUESTED
 22542            MOVE 'REQ'               TO CRFNDSWO
 22543         ELSE
 22544            MOVE 'NO'                TO CRFNDSWO.
 22545
 22546     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22547     MOVE SPACE                      TO DC-OPTION-CODE.
 22548     PERFORM 9700-DATE-LINK.
 22549     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22550     MOVE PB-INPUT-BY                TO CENTBYO.
 22551
 22552     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22553        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22554        MOVE SPACE                   TO DC-OPTION-CODE
 22555        PERFORM 9700-DATE-LINK
 22556        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22557        MOVE 'INACTIVE'              TO CMOENDTO
 22558     ELSE
 22559        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22560        MOVE SPACE                   TO DC-OPTION-CODE
 22561        PERFORM 9700-DATE-LINK
 22562        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22563        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22564        MOVE SPACE                   TO DC-OPTION-CODE
 22565        PERFORM 9700-DATE-LINK
 22566        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22567
 22568     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22569
 22570     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22571     MOVE WS-HR-MINS                 TO CMANTATO.
 22572
 22573     EVALUATE PB-LF-REFUND-TYPE
 22574        WHEN '1'
 22575           MOVE 'RULE78'            TO CLFREFNO
 22576        WHEN '2'
 22577           MOVE 'PRORAT'            TO CLFREFNO
 22578        WHEN '3'
 22579           MOVE 'CALIF'             TO CLFREFNO
 22580        WHEN '4'
 22581           MOVE 'IRREG'             TO CLFREFNO
 22582        WHEN '5'
 22583           MOVE 'NETPAY'            TO CLFREFNO
 22584        WHEN '6'
 22585           MOVE 'ATCP'              TO CLFREFNO
 22586        WHEN '7'
 22587           MOVE 'UTAH'              TO CLFREFNO
 22588        WHEN '8'
 22589           MOVE 'MEAN'              TO CLFREFNO
 22590        WHEN '9'
 22591           MOVE 'SUM '              TO CLFREFNO
 22592        WHEN 'B'
 22593           MOVE 'BALN'              TO CLFREFNO
 22594     END-EVALUATE.
 22595
 22596     EVALUATE TRUE
 22597        WHEN PB-AH-REFUND-TYPE =  '1'
 22598           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 415
* EL6311.cbl
 22599        WHEN PB-AH-REFUND-TYPE =  '2'
 22600           MOVE 'PRORAT'            TO CAHREFNO
 22601        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22602           MOVE 'CALIF'             TO CAHREFNO
 22603        WHEN PB-AH-REFUND-TYPE =  '4'
 22604           MOVE 'IRREG'             TO CAHREFNO
 22605        WHEN PB-AH-REFUND-TYPE =  '5'
 22606           MOVE 'NETPAY'            TO CAHREFNO
 22607        WHEN PB-AH-REFUND-TYPE =  '6'
 22608           MOVE 'ATCP'              TO CAHREFNO
 22609        WHEN PB-AH-REFUND-TYPE =  '7'
 22610           MOVE 'UTAH'              TO CAHREFNO
 22611        WHEN PB-AH-REFUND-TYPE =  '8'
 22612           MOVE 'MEAN'              TO CAHREFNO
 22613        WHEN PB-AH-REFUND-TYPE =  '9'
 22614           MOVE 'SUM '              TO CAHREFNO
 22615        WHEN PB-AH-REFUND-TYPE =  'B'
 22616           MOVE 'BALN'              TO CAHREFNO
 22617     END-EVALUATE.
 22618
 22619     MOVE PB-REIN-CD                 TO CREINCDO.
 22620
 22621     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22622        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22623        MOVE SPACE                   TO DC-OPTION-CODE
 22624        PERFORM 9700-DATE-LINK
 22625        IF NO-CONVERSION-ERROR
 22626           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22627
 22628     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22629        MOVE 999999                  TO WS-EXP-DT-EDIT
 22630        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22631        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22632     ELSE
 22633        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22634           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22635           MOVE SPACE                   TO DC-OPTION-CODE
 22636           PERFORM 9700-DATE-LINK
 22637           IF NO-CONVERSION-ERROR
 22638              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22639
 22640     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22641        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22642           MOVE AL-SANOF                TO CORIGHDA
 22643           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22644           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22645
 22646     MOVE PB-CSR-ID              TO CCSRO.
 22647
 22648     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22649     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22650
 22651     MOVE 'C'                    TO CMAINTI.
 22652     MOVE AL-UANON               TO CMAINTA.
 22653
 22654     IF PI-6316-FINALIZED = 'Y'  AND
 22655        PB-UNFORCED-ERRORS
 22656          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 416
* EL6311.cbl
 22657          MOVE  1                TO SET-CURSOR-SW
 22658     END-IF
 22659
 22660     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22661        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22662
 22663     IF NO-CURSOR-SET
 22664        MOVE -1                  TO CMAINTL.
 22665
 22666     GO TO 8100-SEND-INITIAL-MAP.
 22667
 22668
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 417
* EL6311.cbl
 22670***************************************************************
 22671*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22672*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22673***************************************************************
 22674
 22675 7200-DISPLAY-BATCHES.
 22676     MOVE EL631D                 TO PI-MAP-NAME.
 22677     MOVE LOW-VALUES             TO EL631DI.
 22678
 22679     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22680
 22681
 22682* EXEC CICS HANDLE CONDITION
 22683*         NOTFND   (3690-NOT-FOUND)
 22684*    END-EXEC.
 22685*    MOVE '"$I                   ! Y #00018976' TO DFHEIV0
 22686     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22687     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22688     MOVE X'5920233030303138393736' TO DFHEIV0(25:11)
 22689     CALL 'kxdfhei1' USING DFHEIV0
 22690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22691
 22692
 22693     IF PI-DISPLAY-SCREEN
 22694        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22695     ELSE
 22696        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22697
 22698     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22699     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22700
 22701
 22702* EXEC CICS READ
 22703*         DATASET   (FILE-ID-ERPNDB)
 22704*         RIDFLD    (ERPNDB-KEY)
 22705*         SET       (ADDRESS OF PENDING-BUSINESS)
 22706*    END-EXEC.
 22707*    MOVE '&"S        E          (   #00018988' TO DFHEIV0
 22708     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22709     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22710     MOVE X'2020233030303138393838' TO DFHEIV0(25:11)
 22711     CALL 'kxdfhei1' USING DFHEIV0,
 22712           FILE-ID-ERPNDB,
 22713           DFHEIV20,
 22714           DFHEIV99,
 22715           ERPNDB-KEY,
 22716           DFHEIV99,
 22717           DFHEIV99,
 22718           DFHEIV99
 22719     SET ADDRESS OF PENDING-BUSINESS TO
 22720         DFHEIV20
 22721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22722
 22723
 22724     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22725     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22726     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22727     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 418
* EL6311.cbl
 22728     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22729
 22730     MOVE EL631D                 TO PI-MAP-NAME.
 22731     MOVE LOW-VALUES             TO EL631DI.
 22732     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22733
 22734*    IF PI-AR-PROCESSING
 22735*       MOVE PB-REFERENCE        TO DREFO.
 22736
 22737     MOVE PB-CSR-ID              TO DCSRO.
 22738
 22739     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22740        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22741        MOVE SPACE               TO DC-OPTION-CODE
 22742        PERFORM 9700-DATE-LINK
 22743        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22744        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22745        MOVE 'INACTIVE'          TO DLDATEO
 22746     ELSE
 22747        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22748        MOVE SPACE               TO DC-OPTION-CODE
 22749        PERFORM 9700-DATE-LINK
 22750        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22751
 22752     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22753     MOVE SPACE                  TO DC-OPTION-CODE.
 22754     PERFORM 9700-DATE-LINK.
 22755     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22756
 22757     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22758        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22759     ELSE
 22760        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22761        MOVE SPACE               TO DC-OPTION-CODE
 22762        PERFORM 9700-DATE-LINK
 22763        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22764
 22765     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22766     MOVE SPACE                  TO DC-OPTION-CODE.
 22767     PERFORM 9700-DATE-LINK.
 22768     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22769
 22770     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22771     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22772
 22773     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22774        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22775                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22776
 22777     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22778     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22779     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22780
 22781     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22782        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22783                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22784
 22785     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 419
* EL6311.cbl
 22786     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22787     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22788
 22789     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22790        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22791                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22792
 22793     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22794     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22795
 22796     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22797        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22798                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22799
 22800     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22801     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22802     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22803
 22804     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22805        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22806                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22807
 22808     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22809     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22810     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22811
 22812     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22813        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22814                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22815
 22816     MOVE -1                     TO DPFENTRL.
 22817     GO TO 8100-SEND-INITIAL-MAP.
 22818
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 420
* EL6311.cbl
 22820
 22821***************************************************************
 22822*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22823*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22824*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22825*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22826*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22827*     ARE THEN SET ACCORDINGLY.                               *
 22828*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22829*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22830*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22831***************************************************************
 22832
 22833******************************************************************
 22834*                                                                *
 22835*            E R R O R   A N A L Y S I S                         *
 22836*                                                                *
 22837******************************************************************
 22838
 22839******************************************************************
 22840*                                                                *
 22841*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22842*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22843*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22844*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22845*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22846*                                                                *
 22847*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22848*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22849*                                                                *
 22850******************************************************************
 22851
 22852 7300-FORMAT-ERRORS.
 22853     MOVE ' '                    TO PI-ERRORS-SW
 22854     IF PB-COMMON-ERRORS = LOW-VALUES
 22855        IF PB-FATAL-ERRORS
 22856           MOVE ER-2695          TO EMI-ERROR
 22857           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22858           GO TO 7399-EXIT.
 22859
 22860     MOVE +0                     TO WS-SUB4.
 22861
 22862 7310-ERROR-LOOP.
 22863
 22864     ADD +1                      TO WS-SUB4.
 22865
 22866     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22867        GO TO 7350-SET-ERROR-FLAGS.
 22868
 22869     IF PI-COMPANY-ID = 'UCL'
 22870         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22871             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22872             MOVE ' '                   TO DC-OPTION-CODE
 22873             PERFORM 9700-DATE-LINK
 22874             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22875
 22876     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22877     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 421
* EL6311.cbl
 22878     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22879
 22880     GO TO 7310-ERROR-LOOP.
 22881
 22882
 22883 7350-SET-ERROR-FLAGS.
 22884
 22885     IF EMI-FATAL-CTR NOT = ZEROS
 22886        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22887        MOVE 'X'                 TO PB-FATAL-FLAG
 22888                                    PI-ERRORS-SW
 22889        GO TO 7355-SET-ERROR-FLAGS.
 22890
 22891     move ' ' to pi-unforced-sw
 22892     IF EMI-FORCABLE-CTR NOT = ZEROS
 22893        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22894        IF PB-ISSUE
 22895           IF PB-ISSUE-FORCE
 22896              MOVE 'F'           TO PB-FORCE-ER-CD
 22897              MOVE ER-2600       TO EMI-ERROR
 22898              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22899             ELSE
 22900              MOVE 'X'           TO PB-FORCE-ER-CD
 22901*                                   PI-ERRORS-SW
 22902          ELSE
 22903           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22904              MOVE 'F'           TO PB-FORCE-ER-CD
 22905                                    pi-unforced-sw
 22906              MOVE ER-2600       TO EMI-ERROR
 22907              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22908             ELSE
 22909              MOVE 'X'           TO PB-FORCE-ER-CD
 22910                                    pi-unforced-sw.
 22911*                                   PI-ERRORS-SW.
 22912
 22913     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22914     IF PB-ISSUE
 22915         MOVE 'I'                TO ENDT-RECORD-TYPE
 22916     ELSE
 22917         MOVE 'C'                TO ENDT-RECORD-TYPE
 22918     END-IF
 22919     MOVE +0                     TO ENDT-SEQ-NO
 22920
 22921
 22922* EXEC CICS READ
 22923*        DATASET   (FILE-ID-ERENDT)
 22924*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22925*        RIDFLD    (ERENDT-KEY)
 22926*        RESP      (WS-RESPONSE)
 22927*        GTEQ
 22928*    END-EXEC
 22929*    MOVE '&"S        G          (  N#00019191' TO DFHEIV0
 22930     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22931     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22932     MOVE X'204E233030303139313931' TO DFHEIV0(25:11)
 22933     CALL 'kxdfhei1' USING DFHEIV0,
 22934           FILE-ID-ERENDT,
 22935           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 422
* EL6311.cbl
 22936           DFHEIV99,
 22937           ERENDT-KEY,
 22938           DFHEIV99,
 22939           DFHEIV99,
 22940           DFHEIV99
 22941     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22942         DFHEIV20
 22943     MOVE EIBRESP  TO WS-RESPONSE
 22944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22945
 22946     IF RESP-NORMAL
 22947        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22948        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22949            MOVE ER-0280          TO EMI-ERROR
 22950            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22951            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22952            EVALUATE TRUE
 22953              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22954                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22955              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22956                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22957              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22958                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22959            END-EVALUATE
 22960        END-IF
 22961     END-IF
 22962
 22963
 22964
 22965     IF FIRST-ENTRY OR
 22966        EIBAID = DFHPF1 OR DFHPF2
 22967        MOVE '0'                TO PI-EDIT-SW
 22968        GO TO 7399-EXIT.
 22969
 22970 7355-SET-ERROR-FLAGS.
 22971
 22972     IF EMI-WARNING-CTR NOT = ZEROS
 22973        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22974        MOVE 'W'                 TO PB-WARN-ER-CD.
 22975
 22976     IF PB-UNFORCED-ERRORS OR
 22977        PB-FATAL-ERRORS    OR
 22978        PB-RECORD-ON-HOLD  OR
 22979        PB-RECORD-RETURNED OR
 22980        PB-CANCELLATION
 22981          NEXT SENTENCE
 22982        ELSE
 22983          GO TO 7399-EXIT.
 22984
 22985
 22986* EXEC CICS  HANDLE CONDITION
 22987*           NOTFND   (7399-EXIT)
 22988*    END-EXEC.
 22989*    MOVE '"$I                   ! Z #00019238' TO DFHEIV0
 22990     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22992     MOVE X'5A20233030303139323338' TO DFHEIV0(25:11)
 22993     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 423
* EL6311.cbl
 22994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22995
 22996
 22997     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22998     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22999     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23000     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23001
 23002
 23003* EXEC CICS READ
 23004*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23005*        DATASET (FILE-ID-ELCERT)
 23006*        RIDFLD  (ELCERT-KEY)
 23007*        UPDATE
 23008*    END-EXEC.
 23009*    MOVE '&"S        EU         (   #00019247' TO DFHEIV0
 23010     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23011     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23012     MOVE X'2020233030303139323437' TO DFHEIV0(25:11)
 23013     CALL 'kxdfhei1' USING DFHEIV0,
 23014           FILE-ID-ELCERT,
 23015           DFHEIV20,
 23016           DFHEIV99,
 23017           ELCERT-KEY,
 23018           DFHEIV99,
 23019           DFHEIV99,
 23020           DFHEIV99
 23021     SET ADDRESS OF CERTIFICATE-MASTER TO
 23022         DFHEIV20
 23023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23024
 23025
 23026
 23027     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23028     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23029
 23030     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23031        GO TO 7360-REWRITE-CERT-MASTER.
 23032
 23033     IF PB-ISSUE
 23034        IF PB-RECORD-RETURNED
 23035            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23036            GO TO 7360-REWRITE-CERT-MASTER
 23037        ELSE
 23038            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23039            GO TO 7360-REWRITE-CERT-MASTER.
 23040
 23041     IF PB-RECORD-RETURNED
 23042         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23043         GO TO 7360-REWRITE-CERT-MASTER.
 23044
 23045     IF (PB-C-LF-CANCEL-VOIDED)
 23046        or (pb-c-ah-cancel-voided)
 23047        IF (PB-UNFORCED-ERRORS OR
 23048            PB-FATAL-ERRORS    OR
 23049            PB-RECORD-ON-HOLD)
 23050            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23051            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 424
* EL6311.cbl
 23052        ELSE
 23053            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23054            GO TO 7360-REWRITE-CERT-MASTER.
 23055
 23056     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23057                            OR PB-RECORD-ON-HOLD)
 23058        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23059     ELSE
 23060        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23061
 23062 7360-REWRITE-CERT-MASTER.
 23063
 23064     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23065        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23066
 23067* EXEC CICS UNLOCK
 23068*            DATASET    (FILE-ID-ELCERT)
 23069*       END-EXEC
 23070*    MOVE '&*                    #   #00019294' TO DFHEIV0
 23071     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23072     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23073     MOVE X'2020233030303139323934' TO DFHEIV0(25:11)
 23074     CALL 'kxdfhei1' USING DFHEIV0,
 23075           FILE-ID-ELCERT,
 23076           DFHEIV99
 23077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23078        GO TO 7399-EXIT.
 23079
 23080
 23081* EXEC CICS REWRITE
 23082*         DATASET    (FILE-ID-ELCERT)
 23083*         FROM       (CERTIFICATE-MASTER)
 23084*    END-EXEC.
 23085     MOVE LENGTH OF
 23086      CERTIFICATE-MASTER
 23087       TO DFHEIV11
 23088*    MOVE '&& L                  %   #00019299' TO DFHEIV0
 23089     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23090     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23091     MOVE X'2020233030303139323939' TO DFHEIV0(25:11)
 23092     CALL 'kxdfhei1' USING DFHEIV0,
 23093           FILE-ID-ELCERT,
 23094           CERTIFICATE-MASTER,
 23095           DFHEIV11,
 23096           DFHEIV99
 23097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23098
 23099
 23100 7399-EXIT.
 23101      EXIT.
 23102
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 425
* EL6311.cbl
 23104
 23105*************************************************************
 23106*                                                           *
 23107*              S E T   A T T R I B U T E S                  *
 23108*                                                           *
 23109*************************************************************
 23110
 23111 7400-SET-ATTRIBUTES.
 23112
 23113     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23114        GO TO 7499-EXIT.
 23115
 23116**2601**
 23117
 23118     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23119        IF PB-ISSUE
 23120           MOVE AL-UABON         TO BEFFDTA
 23121           GO TO 7499-EXIT
 23122         ELSE
 23123           MOVE AL-UABON         TO CEFFDTA
 23124           GO TO 7499-EXIT.
 23125
 23126**2604**
 23127
 23128     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23129        IF PB-ISSUE
 23130           MOVE AL-UABON         TO BTYPE1A
 23131           MOVE -1               TO BTYPE1L
 23132           MOVE  1               TO SET-CURSOR-SW
 23133           GO TO 7499-EXIT.
 23134
 23135**2605**
 23136
 23137     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23138        IF PB-ISSUE
 23139           MOVE AL-UABON         TO BTYPE2A
 23140           MOVE -1               TO BTYPE2L
 23141           MOVE  1               TO SET-CURSOR-SW
 23142           GO TO 7499-EXIT.
 23143
 23144**2606**
 23145
 23146     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23147        IF PB-ISSUE
 23148           MOVE AL-UABON         TO BSIGA
 23149           MOVE -1               TO BSIGL
 23150           MOVE  1               TO SET-CURSOR-SW
 23151           GO TO 7499-EXIT.
 23152
 23153**2607**
 23154
 23155     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23156        IF PB-ISSUE
 23157           MOVE AL-UABON         TO BSIGA
 23158           MOVE -1               TO BSIGL
 23159           MOVE  1               TO SET-CURSOR-SW
 23160           GO TO 7499-EXIT.
 23161
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 426
* EL6311.cbl
 23162**2615**
 23163
 23164     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23165        IF PB-ISSUE
 23166           MOVE AL-UABOF         TO BREINA
 23167           MOVE -1               TO BREINL
 23168           GO TO 7499-EXIT.
 23169
 23170**2622**
 23171
 23172     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23173        IF PB-ISSUE
 23174           MOVE AL-UABON         TO BEFFDTA
 23175           GO TO 7499-EXIT
 23176        ELSE
 23177           MOVE AL-UABON         TO CEFFDTA
 23178           GO TO 7499-EXIT.
 23179
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 427
* EL6311.cbl
 23181
 23182*************************************************************
 23183*                                                           *
 23184*              I S S U E   E R R O R S                      *
 23185*                                                           *
 23186*************************************************************
 23187
 23188 7420-ISSUE-ERRORS.
 23189
 23190**2626**
 23191
 23192     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23193        MOVE AL-UABON            TO BCERTNOA
 23194        GO TO 7499-EXIT.
 23195
 23196**2627**
 23197
 23198     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23199        MOVE AL-UNBON            TO BAGEA
 23200        MOVE -1                  TO BAGEL
 23201        MOVE  1                  TO SET-CURSOR-SW
 23202        GO TO 7499-EXIT.
 23203
 23204**2628**
 23205
 23206     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23207        MOVE AL-UNBON            TO BAGEA
 23208        MOVE -1                  TO BAGEL
 23209        MOVE  1                  TO SET-CURSOR-SW
 23210        GO TO 7499-EXIT.
 23211
 23212**2629**
 23213
 23214     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23215        MOVE AL-UABON            TO BSEXA
 23216        MOVE -1                  TO BSEXL
 23217        MOVE  1                  TO SET-CURSOR-SW
 23218        GO TO 7499-EXIT.
 23219
 23220**2630**
 23221
 23222     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23223        MOVE -1                  TO BTYPE1L
 23224        MOVE  1                  TO SET-CURSOR-SW
 23225        GO TO 7499-EXIT.
 23226
 23227**2631**
 23228
 23229     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23230        MOVE -1                  TO BTYPE1L
 23231        MOVE  1                  TO SET-CURSOR-SW
 23232        GO TO 7499-EXIT.
 23233
 23234**2632**
 23235
 23236     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23237        MOVE AL-UNBON            TO BBEN1A
 23238        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 428
* EL6311.cbl
 23239        MOVE  1                  TO SET-CURSOR-SW
 23240        GO TO 7499-EXIT.
 23241
 23242**2633**
 23243
 23244     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23245        MOVE AL-UNBON            TO BPREM1A
 23246        MOVE -1                  TO BPREM1L
 23247        MOVE  1                  TO SET-CURSOR-SW
 23248        GO TO 7499-EXIT.
 23249
 23250**2634**
 23251
 23252     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23253        MOVE -1                  TO BTYPE2L
 23254        MOVE  1                  TO SET-CURSOR-SW
 23255        GO TO 7499-EXIT.
 23256
 23257**2635**
 23258
 23259     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23260        MOVE AL-UNBON            TO BBEN2A
 23261        MOVE -1                  TO BBEN2L
 23262        MOVE  1                  TO SET-CURSOR-SW
 23263        GO TO 7499-EXIT.
 23264
 23265**2636**
 23266
 23267     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23268        MOVE AL-UNBON            TO BPREM2A
 23269        MOVE -1                  TO BPREM2L
 23270        MOVE  1                  TO SET-CURSOR-SW
 23271        GO TO 7499-EXIT.
 23272
 23273**2639**
 23274
 23275     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23276        MOVE AL-UNBON            TO BBEN1A
 23277        MOVE -1                  TO BBEN1L
 23278        MOVE  1                  TO SET-CURSOR-SW
 23279        GO TO 7499-EXIT.
 23280
 23281**2640**
 23282
 23283     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23284        MOVE AL-UNBON            TO BBEN2A
 23285        MOVE -1                  TO BBEN2L
 23286        MOVE  1                  TO SET-CURSOR-SW
 23287        GO TO 7499-EXIT.
 23288
 23289**2647**
 23290
 23291     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23292        MOVE AL-UNBON            TO BTERM1A
 23293        MOVE -1                  TO BTERM1L
 23294        MOVE  1                  TO SET-CURSOR-SW
 23295        GO TO 7499-EXIT.
 23296
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 429
* EL6311.cbl
 23297**2648**
 23298
 23299     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23300        MOVE AL-UNBON            TO BLNTRMA
 23301        MOVE -1                  TO BLNTRML
 23302        MOVE  1                  TO SET-CURSOR-SW
 23303        GO TO 7499-EXIT.
 23304
 23305**2649**
 23306
 23307     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23308        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23309            MOVE AL-UNBON            TO BPREM1A
 23310            MOVE -1                  TO BPREM1L
 23311            MOVE  1                  TO SET-CURSOR-SW
 23312            GO TO 7499-EXIT
 23313     ELSE
 23314        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23315           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23316            MOVE AL-UNBON            TO BPREM2A
 23317            MOVE -1                  TO BPREM2L
 23318            MOVE  1                  TO SET-CURSOR-SW
 23319            GO TO 7499-EXIT.
 23320
 23321**2650**
 23322
 23323     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23324        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23325            MOVE AL-UNBON        TO BPREM1A
 23326            MOVE -1              TO BPREM1L
 23327            MOVE  1              TO SET-CURSOR-SW
 23328            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23329                MOVE AL-UNBON        TO BPREM2A
 23330                MOVE -1              TO BPREM2L
 23331                MOVE  1              TO SET-CURSOR-SW
 23332                GO TO 7499-EXIT
 23333            ELSE
 23334                GO TO 7499-EXIT
 23335        ELSE
 23336            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23337                MOVE AL-UNBON        TO BPREM2A
 23338                MOVE -1              TO BPREM2L
 23339                MOVE  1              TO SET-CURSOR-SW
 23340                GO TO 7499-EXIT
 23341            ELSE
 23342                GO TO 7499-EXIT.
 23343
 23344**2651**
 23345
 23346     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23347        MOVE AL-UABON            TO BSIGA
 23348        MOVE -1                  TO BSIGL
 23349        MOVE  1                  TO SET-CURSOR-SW
 23350        GO TO 7499-EXIT.
 23351
 23352**2653**
 23353
 23354     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 430
* EL6311.cbl
 23355        MOVE AL-UABON            TO BFREQA
 23356        MOVE -1                  TO BFREQL
 23357        MOVE  1                  TO SET-CURSOR-SW
 23358        GO TO 7499-EXIT.
 23359
 23360**2654**
 23361
 23362     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23363        MOVE AL-UABON            TO BFREQA
 23364        MOVE -1                  TO BFREQL
 23365        MOVE  1                  TO SET-CURSOR-SW
 23366        GO TO 7499-EXIT.
 23367
 23368**2655**
 23369
 23370     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23371        MOVE AL-UABON            TO BFREQA
 23372        MOVE -1                  TO BFREQL
 23373        MOVE  1                  TO SET-CURSOR-SW
 23374        GO TO 7499-EXIT.
 23375
 23376**2656**
 23377
 23378     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23379        MOVE AL-UNBON            TO BAPRA
 23380        MOVE -1                  TO BAPRL
 23381        MOVE  1                  TO SET-CURSOR-SW
 23382        GO TO 7499-EXIT.
 23383
 23384**2657**
 23385
 23386     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23387        MOVE AL-UNBON            TO BAPRA
 23388        MOVE -1                  TO BAPRL
 23389        MOVE  1                  TO SET-CURSOR-SW
 23390        GO TO 7499-EXIT.
 23391
 23392**2658**
 23393
 23394     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23395        MOVE AL-UNBON            TO BTERM2A
 23396        MOVE -1                  TO BTERM2L
 23397        MOVE  1                  TO SET-CURSOR-SW
 23398        GO TO 7499-EXIT.
 23399
 23400**2660**
 23401
 23402     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23403        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23404        MOVE -1                  TO BLSTNML
 23405        MOVE  1                  TO SET-CURSOR-SW
 23406        GO TO 7499-EXIT.
 23407
 23408
 23409**2662**
 23410
 23411     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23412        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 431
* EL6311.cbl
 23413        MOVE -1                  TO BAGEL
 23414        MOVE  1                  TO SET-CURSOR-SW
 23415        GO TO 7499-EXIT.
 23416
 23417**2663**
 23418
 23419     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23420        MOVE AL-UNBON            TO BAGEA
 23421        MOVE -1                  TO BAGEL
 23422        MOVE  1                  TO SET-CURSOR-SW
 23423        GO TO 7499-EXIT.
 23424
 23425**2664**
 23426
 23427     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23428        MOVE AL-UABON            TO BREINA
 23429        MOVE -1                  TO BREINL
 23430        MOVE  1                  TO SET-CURSOR-SW
 23431        GO TO 7499-EXIT.
 23432
 23433**2667**
 23434
 23435     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23436        MOVE AL-UNBON            TO BBEN2A
 23437        MOVE -1                  TO BBEN2L
 23438        MOVE  1                  TO SET-CURSOR-SW
 23439        GO TO 7499-EXIT.
 23440
 23441**2668**
 23442
 23443     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23444        MOVE AL-UABON            TO BEFFDTA
 23445        GO TO 7499-EXIT.
 23446
 23447**2669**
 23448
 23449     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23450       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23451       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23452        MOVE AL-UNBON            TO BAGEA
 23453        MOVE -1                  TO BAGEL
 23454        MOVE  1                  TO SET-CURSOR-SW
 23455        GO TO 7499-EXIT.
 23456
 23457**2670**
 23458
 23459     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23460        MOVE AL-UABON            TO BFORCEA
 23461        MOVE -1                  TO BFORCEL
 23462        MOVE  1                  TO SET-CURSOR-SW
 23463        GO TO 7499-EXIT.
 23464
 23465**2671**
 23466
 23467     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23468        MOVE AL-UABON            TO BEFFDTA
 23469        GO TO 7499-EXIT.
 23470
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 432
* EL6311.cbl
 23471**2672**
 23472
 23473     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23474        MOVE AL-UABON            TO BEFFDTA
 23475        GO TO 7499-EXIT.
 23476
 23477**2673**
 23478
 23479     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23480        MOVE AL-UABON            TO BEFFDTA
 23481        GO TO 7499-EXIT.
 23482
 23483**2674**
 23484
 23485     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23486        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23487        MOVE -1                  TO BTYPE1L
 23488        MOVE  1                  TO SET-CURSOR-SW
 23489        GO TO 7499-EXIT.
 23490
 23491**2677**
 23492
 23493     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23494        MOVE AL-UNBON            TO BTERM1A
 23495        MOVE -1                  TO BTERM1L
 23496        MOVE  1                  TO SET-CURSOR-SW
 23497        GO TO 7499-EXIT.
 23498
 23499**2678**
 23500
 23501     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23502        MOVE AL-UNBON            TO BTERM2A
 23503        MOVE -1                  TO BTERM2L
 23504        MOVE  1                  TO SET-CURSOR-SW
 23505        GO TO 7499-EXIT.
 23506
 23507**2679**
 23508
 23509     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23510        MOVE AL-UABON            TO BTYPE1A
 23511        MOVE -1                  TO BTYPE1L
 23512        MOVE  1                  TO SET-CURSOR-SW
 23513        GO TO 7499-EXIT.
 23514
 23515**2680**
 23516
 23517     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23518        MOVE AL-UABOF            TO B1STPMTA
 23519        MOVE -1                  TO B1STPMTL
 23520        MOVE  1                  TO SET-CURSOR-SW
 23521        GO TO 7499-EXIT.
 23522
 23523**2681**
 23524
 23525     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23526        MOVE AL-UABON            TO BDAYSA
 23527        MOVE -1                  TO BDAYSL
 23528        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 433
* EL6311.cbl
 23529        GO TO 7499-EXIT.
 23530
 23531**2682**
 23532
 23533     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23534        MOVE AL-UABON            TO BTERM1A
 23535        MOVE -1                  TO BTERM1L
 23536        MOVE  1                  TO SET-CURSOR-SW
 23537        GO TO 7499-EXIT.
 23538
 23539**2683**
 23540
 23541     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23542        MOVE AL-UABON            TO BSKPCDA
 23543        MOVE -1                  TO BSKPCDL
 23544        MOVE  1                  TO SET-CURSOR-SW
 23545        GO TO 7499-EXIT.
 23546
 23547**2684**
 23548
 23549     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23550        MOVE AL-UABON            TO BTYPE2A
 23551        MOVE -1                  TO BTYPE2L
 23552        MOVE  1                  TO SET-CURSOR-SW
 23553        GO TO 7499-EXIT.
 23554
 23555**2686**
 23556
 23557     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23558        MOVE AL-UABON            TO BTYPE2A
 23559        MOVE -1                  TO BTYPE2L
 23560        MOVE  1                  TO SET-CURSOR-SW
 23561        GO TO 7499-EXIT.
 23562
 23563**2689**
 23564
 23565     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23566        MOVE AL-UABON            TO BSIGA
 23567        MOVE -1                  TO BSIGL
 23568        MOVE  1                  TO SET-CURSOR-SW
 23569        GO TO 7499-EXIT.
 23570
 23571**2690**
 23572
 23573     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23574        MOVE AL-UABOF            TO BLNOFCRA
 23575        MOVE -1                  TO BLNOFCRL
 23576        MOVE  1                  TO SET-CURSOR-SW
 23577        GO TO 7499-EXIT.
 23578
 23579**2693**
 23580
 23581     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23582        MOVE AL-UABOF            TO BLNOFCRA
 23583        MOVE AL-UNBON            TO BBEN1A
 23584        MOVE -1                  TO BBEN1L
 23585        MOVE  1                  TO SET-CURSOR-SW
 23586        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 434
* EL6311.cbl
 23587
 23588**2720**
 23589
 23590     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23591        MOVE AL-UNBON            TO BBEN1A
 23592        MOVE -1                  TO BBEN1L
 23593        MOVE  1                  TO SET-CURSOR-SW
 23594        GO TO 7499-EXIT.
 23595
 23596**2709**
 23597
 23598*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23599*       MOVE AL-UNBON            TO BBEN1A
 23600*       MOVE -1                  TO BBEN1L
 23601*       MOVE  1                  TO SET-CURSOR-SW
 23602*       GO TO 7499-EXIT.
 23603
 23604*************************************************************
 23605*                                                           *
 23606*            C A N C E L   E R R O R S                      *
 23607*                                                           *
 23608*************************************************************
 23609
 23610**2726**
 23611
 23612     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23613        MOVE AL-UABON            TO CCERTNOA
 23614        GO TO 7499-EXIT.
 23615
 23616**2728**
 23617
 23618     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23619        MOVE AL-UABON            TO CCERTNOA
 23620        GO TO 7499-EXIT.
 23621
 23622**2729**
 23623
 23624     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23625        MOVE AL-UABON            TO CCERTNOA
 23626        GO TO 7499-EXIT.
 23627
 23628**2730**
 23629
 23630     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23631        MOVE AL-UABON            TO CCERTNOA
 23632        GO TO 7499-EXIT.
 23633
 23634**2731**
 23635
 23636     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23637        MOVE AL-UABON            TO CCANDT1A
 23638        MOVE -1                  TO CCANDT1L
 23639        MOVE  1                  TO SET-CURSOR-SW
 23640        GO TO 7499-EXIT.
 23641
 23642**2732**
 23643
 23644     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 435
* EL6311.cbl
 23645        MOVE AL-UABON            TO CCANDT1A
 23646        MOVE -1                  TO CCANDT1L
 23647        MOVE  1                  TO SET-CURSOR-SW
 23648        GO TO 7499-EXIT.
 23649
 23650**2733**
 23651
 23652     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23653        MOVE AL-UABON            TO CCANDT1A
 23654        MOVE -1                  TO CCANDT1L
 23655        MOVE  1                  TO SET-CURSOR-SW
 23656        GO TO 7499-EXIT.
 23657
 23658**2734**
 23659
 23660     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23661        MOVE AL-UNBON            TO CREFND1A
 23662        MOVE -1                  TO CREFND1L
 23663        MOVE  1                  TO SET-CURSOR-SW
 23664        GO TO 7499-EXIT.
 23665
 23666**2735**
 23667
 23668     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23669        MOVE AL-UABON            TO CCANDT2A
 23670        MOVE -1                  TO CCANDT2L
 23671        MOVE  1                  TO SET-CURSOR-SW
 23672        GO TO 7499-EXIT.
 23673
 23674**2736**
 23675
 23676     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23677        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23678            MOVE AL-UNBON        TO CREFND1A
 23679            MOVE -1              TO CREFND1L
 23680            MOVE  1              TO SET-CURSOR-SW
 23681            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23682                MOVE AL-UNBON        TO CREFND2A
 23683                MOVE -1              TO CREFND2L
 23684                MOVE  1              TO SET-CURSOR-SW
 23685                GO TO 7499-EXIT
 23686            ELSE
 23687                GO TO 7499-EXIT
 23688        ELSE
 23689            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23690                MOVE AL-UNBON        TO CREFND2A
 23691                MOVE -1              TO CREFND2L
 23692                MOVE  1              TO SET-CURSOR-SW
 23693                GO TO 7499-EXIT
 23694            ELSE
 23695                GO TO 7499-EXIT.
 23696
 23697**2738**
 23698
 23699     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23700        MOVE -1                  TO CREFND2L
 23701        MOVE  1                  TO SET-CURSOR-SW
 23702        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 436
* EL6311.cbl
 23703
 23704**2739**
 23705
 23706     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23707        MOVE -1                  TO CREFND1L
 23708        MOVE  1                  TO SET-CURSOR-SW
 23709        GO TO 7499-EXIT.
 23710
 23711**2741**
 23712
 23713     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23714        MOVE -1                  TO CREFND1L
 23715        MOVE  1                  TO SET-CURSOR-SW
 23716        GO TO 7499-EXIT.
 23717
 23718**2743**
 23719
 23720     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23721        MOVE AL-UNBON            TO CCANDT1A
 23722        MOVE -1                  TO CCANDT1L
 23723        MOVE  1                  TO SET-CURSOR-SW
 23724        GO TO 7499-EXIT.
 23725
 23726**2744**
 23727
 23728     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23729        MOVE AL-UNBON            TO CCANDT2A
 23730        MOVE -1                  TO CCANDT2L
 23731        MOVE  1                  TO SET-CURSOR-SW
 23732        GO TO 7499-EXIT.
 23733
 23734**2747**
 23735
 23736     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23737        MOVE AL-UABON            TO CLSTNMA
 23738        MOVE -1                  TO CLSTNML
 23739        MOVE  1                  TO SET-CURSOR-SW
 23740        GO TO 7499-EXIT.
 23741
 23742**2749**
 23743
 23744     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23745        MOVE AL-UABON            TO CFORCEA
 23746        MOVE -1                  TO CFORCEL
 23747        MOVE  1                  TO SET-CURSOR-SW
 23748        GO TO 7499-EXIT.
 23749
 23750**2753**
 23751
 23752     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23753        MOVE AL-UNBON            TO CCANDT1A
 23754        MOVE -1                  TO CCANDT1L
 23755        MOVE  1                  TO SET-CURSOR-SW
 23756        GO TO 7499-EXIT.
 23757
 23758**2755**
 23759
 23760     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 437
* EL6311.cbl
 23761        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23762            MOVE AL-UNBON        TO CREFND1A
 23763            MOVE -1              TO CREFND1L
 23764            MOVE  1              TO SET-CURSOR-SW
 23765            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23766                MOVE AL-UNBON        TO CREFND2A
 23767                MOVE -1              TO CREFND2L
 23768                MOVE  1              TO SET-CURSOR-SW
 23769                GO TO 7499-EXIT
 23770            ELSE
 23771                GO TO 7499-EXIT
 23772        ELSE
 23773            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23774                MOVE AL-UNBON        TO CREFND2A
 23775                MOVE -1              TO CREFND2L
 23776                MOVE  1              TO SET-CURSOR-SW
 23777            ELSE
 23778                GO TO 7499-EXIT.
 23779
 23780**2757**
 23781
 23782     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23783        MOVE AL-UNBON            TO CLIVESA
 23784        MOVE -1                  TO CLIVESL
 23785        MOVE  1                  TO SET-CURSOR-SW
 23786        GO TO 7499-EXIT.
 23787
 23788**2771**
 23789
 23790     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23791        MOVE AL-UABON            TO CCANDT2A
 23792        MOVE -1                  TO CCANDT2L
 23793        MOVE  1                  TO SET-CURSOR-SW
 23794        GO TO 7499-EXIT.
 23795
 23796**2774**
 23797
 23798     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23799        MOVE AL-UABON            TO CCANDT1A
 23800        MOVE -1                  TO CCANDT1L
 23801        MOVE  1                  TO SET-CURSOR-SW
 23802        GO TO 7499-EXIT.
 23803
 23804**2775**
 23805
 23806     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23807        MOVE AL-UABON            TO CCANDT2A
 23808        MOVE -1                  TO CCANDT2L
 23809        MOVE  1                  TO SET-CURSOR-SW
 23810        GO TO 7499-EXIT.
 23811
 23812**2776**
 23813
 23814     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23815        MOVE AL-UABON            TO CCANDT1A
 23816        MOVE -1                  TO CCANDT1L
 23817        MOVE  1                  TO SET-CURSOR-SW
 23818        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 438
* EL6311.cbl
 23819
 23820
 23821**2777**
 23822
 23823     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23824        MOVE AL-UABON            TO CCANDT2A
 23825        MOVE -1                  TO CCANDT2L
 23826        MOVE  1                  TO SET-CURSOR-SW
 23827        GO TO 7499-EXIT.
 23828
 23829**2794**
 23830
 23831     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23832        MOVE AL-UABON            TO CFORCEA
 23833        MOVE -1                  TO CFORCEL
 23834        MOVE  1                  TO SET-CURSOR-SW
 23835        GO TO 7499-EXIT.
 23836
 23837**2799**
 23838
 23839     IF PI-COMPANY-ID = 'UCL'
 23840         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23841             MOVE AL-UNBON            TO BEFFDTA
 23842             MOVE -1                  TO BEFFDTL
 23843             MOVE  1                  TO SET-CURSOR-SW
 23844             GO TO 7499-EXIT.
 23845
 23846 7499-EXIT.
 23847      EXIT.
 23848
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 439
* EL6311.cbl
 23850
 23851 7500-READ-ERLOFC.
 23852     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23853                                     ERLOFC-KEY.
 23854
 23855     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23856
 23857     IF ST-ACCNT-CNTL
 23858         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23859
 23860     IF CARR-GROUP-ST-ACCNT-CNTL
 23861         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23862         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23863         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23864
 23865     IF CARR-ST-ACCNT-CNTL
 23866         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23867         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23868
 23869     IF CARR-ACCNT-CNTL
 23870         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23871
 23872     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23873
 23874     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23875
 23876
 23877* EXEC CICS HANDLE CONDITION
 23878*        NOTFND   (7550-OFFICER-NOTFND)
 23879*    END-EXEC.
 23880*    MOVE '"$I                   ! [ #00020080' TO DFHEIV0
 23881     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23883     MOVE X'5B20233030303230303830' TO DFHEIV0(25:11)
 23884     CALL 'kxdfhei1' USING DFHEIV0
 23885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23886
 23887
 23888
 23889* EXEC CICS READ
 23890*        DATASET   (FILE-ID-ERLOFC)
 23891*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23892*        RIDFLD    (ERLOFC-KEY)
 23893*        EQUAL
 23894*    END-EXEC.
 23895*    MOVE '&"S        E          (   #00020084' TO DFHEIV0
 23896     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23898     MOVE X'2020233030303230303834' TO DFHEIV0(25:11)
 23899     CALL 'kxdfhei1' USING DFHEIV0,
 23900           FILE-ID-ERLOFC,
 23901           DFHEIV20,
 23902           DFHEIV99,
 23903           ERLOFC-KEY,
 23904           DFHEIV99,
 23905           DFHEIV99,
 23906           DFHEIV99
 23907     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 440
* EL6311.cbl
 23908         DFHEIV20
 23909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23910
 23911
 23912     GO TO 7599-EXIT.
 23913
 23914 7550-OFFICER-NOTFND.
 23915     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23916
 23917 7599-EXIT.
 23918      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 441
* EL6311.cbl
 23920******************************************************************
 23921*                                                                *
 23922*            S  E N D    I N I T I A L   M A P                   *
 23923*                                                                *
 23924******************************************************************
 23925
 23926 8100-SEND-INITIAL-MAP.
 23927     MOVE EIBTIME                TO TIME-IN.
 23928
 23929     IF EIBAID = DFHPF11
 23930        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23931        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23932
 23933
 23934     IF PI-COMPANY-ID = CLIENT-GIC
 23935        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23936                                       BCPREM-ATTRB (2).
 23937
 23938     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23939                         CLIENT-PEM OR
 23940                         CLIENT-CSO)
 23941        AND PI-DISPLAY-ORIGINAL-BATCH
 23942          IF PI-MAP-NAME = EL631B
 23943             MOVE AL-SADOF               TO BPF5HDRA
 23944                                            BPF4HDRA
 23945          ELSE
 23946             IF PI-MAP-NAME = EL631C
 23947                MOVE AL-SADOF            TO CPF5HDRA
 23948                                            CPF4HDRA.
 23949
 23950     IF PI-MAP-NAME = EL631B
 23951        MOVE AL-SADOF               TO BPF5HDRA
 23952     ELSE
 23953        MOVE AL-SADOF               TO CPF5HDRA
 23954     END-IF
 23955
 23956*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23957     IF PI-MAP-NAME = EL631B
 23958          IF PI-COMPANY-ID NOT = 'DMD'
 23959             MOVE AL-SANOF            TO BBILLEDA
 23960             MOVE AL-SADOF            TO DMDBILA.
 23961*DMD CUSTOM CODING*************END
 23962
 23963     IF PI-PROCESSOR-ID = 'LGXX'
 23964        IF PI-MAP-NAME = EL631B
 23965           MOVE AL-SABOF                    TO BREFHDGA
 23966           MOVE AL-SANOF                    TO BREFA
 23967        ELSE
 23968           IF PI-MAP-NAME = EL631C
 23969              MOVE AL-SABOF                 TO CREFHDGA
 23970              MOVE AL-SANOF                 TO CREFA.
 23971
 23972*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23973     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23974        NEXT SENTENCE
 23975     ELSE
 23976        IF PI-MAP-NAME = EL631C
 23977           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 442
* EL6311.cbl
 23978                                       CCANFEEA.
 23979
 23980     IF PI-MAP-NAME = EL631D
 23981        IF PI-AR-PROCESSING
 23982           MOVE AL-SANOF            TO DREFHDGA
 23983        ELSE
 23984           MOVE AL-SADOF            TO DREFHDGA.
 23985
 23986     IF (PI-COMPANY-ID NOT = 'DCC')
 23987        AND (PI-MAP-NAME = EL631B)
 23988        MOVE AL-SADOF            TO BVINHA
 23989                                    BVINA
 23990     END-IF
 23991     IF PI-MAP-NAME = EL631B
 23992        IF CSR-EDIT-SESSION
 23993           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23994                                 TO BHEADO
 23995           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23996        ELSE
 23997           MOVE AL-SADOF         TO BF15HDRA
 23998           MOVE '4=B-HDR      '  TO BPF4HDRO
 23999        END-IF
 24000        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24001        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24002        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24003        MOVE WS-CURRENT-DT          TO BDATEO
 24004        MOVE TIME-OUT               TO BTIMEO
 24005        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24006        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24007        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24008        IF   WS-DISPLAY-SCREEN
 24009             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24010             MOVE PB-SV-CARRIER     TO BCARRO
 24011             MOVE PB-SV-GROUPING    TO BGROUPO
 24012             MOVE PB-SV-STATE       TO BSTATEO
 24013             MOVE PB-ACCOUNT        TO BACCTO
 24014        ELSE
 24015             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24016     ELSE
 24017        IF PI-MAP-NAME = EL631C
 24018           MOVE '4=B-HDR      '     TO CPF4HDRO
 24019           IF CSR-EDIT-SESSION
 24020              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24021                                 TO CHEADO
 24022           ELSE
 24023              MOVE AL-SADOF      TO CF15HDRA
 24024           END-IF
 24025           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24026           MOVE WS-CURRENT-DT          TO CDATEO
 24027           MOVE TIME-OUT               TO CTIMEO
 24028           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24029           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24030           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24031           MOVE WS-C-HDG               TO CLFHDGO
 24032           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24033           MOVE WS-C-HDG               TO CAHHDGO
 24034           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24035           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 443
* EL6311.cbl
 24036           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24037           IF   WS-DISPLAY-SCREEN
 24038                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24039                MOVE PB-SV-CARRIER     TO CCARRO
 24040                MOVE PB-SV-GROUPING    TO CGROUPO
 24041                MOVE PB-SV-STATE       TO CSTATEO
 24042                MOVE PB-ACCOUNT        TO CACCTO
 24043           ELSE
 24044                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24045        ELSE
 24046           MOVE WS-CURRENT-DT          TO DDATEO
 24047           MOVE TIME-OUT               TO DTIMEO
 24048           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24049                                          WS-REFUND-HDG-OVERRIDE
 24050           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24051           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24052           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24053                                          WS-REFUND-HDG-OVERRIDE
 24054           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24055           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24056           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24057           IF CSR-EDIT-SESSION
 24058              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24059                                 TO DHEADO
 24060           END-IF
 24061           IF  WS-DISPLAY-SCREEN
 24062               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24063               MOVE PB-CARRIER         TO DCARRO
 24064               MOVE PB-GROUPING        TO DGROUPO
 24065               MOVE PB-STATE           TO DSTATEO
 24066               MOVE PB-ACCOUNT         TO DACCTO
 24067               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24068           ELSE
 24069               MOVE EL631D             TO PI-MAP-NAME
 24070               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24071               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24072
 24073     MOVE SPACE                        TO WS-DISPLAY-SW.
 24074
 24075
 24076* EXEC CICS SEND
 24077*        MAP      (PI-MAP-NAME)
 24078*        MAPSET   (MAPSET-EL6311S)
 24079*        FROM     (EL631BI)
 24080*        ERASE
 24081*        CURSOR
 24082*    END-EXEC.
 24083     MOVE LENGTH OF
 24084      EL631BI
 24085       TO DFHEIV12
 24086     MOVE -1
 24087       TO DFHEIV11
 24088*    MOVE '8$     CT  E    H L F ,   #00020254' TO DFHEIV0
 24089     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 24090     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24091     MOVE X'2020233030303230323534' TO DFHEIV0(25:11)
 24092     CALL 'kxdfhei1' USING DFHEIV0,
 24093           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 444
* EL6311.cbl
 24094           EL631BI,
 24095           DFHEIV12,
 24096           MAPSET-EL6311S,
 24097           DFHEIV99,
 24098           DFHEIV99,
 24099           DFHEIV99,
 24100           DFHEIV11,
 24101           DFHEIV99,
 24102           DFHEIV99,
 24103           DFHEIV99
 24104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24105
 24106
 24107     GO TO 9100-RETURN-TRAN.
 24108
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 445
* EL6311.cbl
 24110
 24111******************************************************************
 24112*                                                                *
 24113*              S E N D    D A T A O N L Y                        *
 24114*                                                                *
 24115******************************************************************
 24116
 24117 8200-SEND-DATAONLY.
 24118     MOVE EIBTIME                TO TIME-IN.
 24119
 24120     IF PI-COMPANY-ID = CLIENT-GIC
 24121        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24122                                       BCPREM-ATTRB (2).
 24123
 24124     IF PI-MAP-NAME = EL631B
 24125        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24126        MOVE WS-CURRENT-DT          TO BDATEO
 24127        MOVE TIME-OUT               TO BTIMEO
 24128        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24129        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24130        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24131        MOVE SPACES                 TO BPFENTRO
 24132        MOVE AL-UANOF               TO BPFENTRA
 24133
 24134*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24135        IF PI-COMPANY-ID NOT = 'DMD'
 24136             MOVE AL-SANOF            TO BBILLEDA
 24137             MOVE AL-SADOF            TO DMDBILA
 24138         ELSE
 24139            NEXT SENTENCE
 24140*DMD CUSTOM CODING*************END
 24141     ELSE
 24142        IF PI-MAP-NAME = EL631C
 24143           MOVE WS-CURRENT-DT          TO CDATEO
 24144           MOVE TIME-OUT               TO CTIMEO
 24145           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24146           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24147           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24148           MOVE SPACES                 TO CPFENTRO
 24149           MOVE AL-UANOF               TO CPFENTRA
 24150        ELSE
 24151           MOVE WS-CURRENT-DT          TO DDATEO
 24152           MOVE TIME-OUT               TO DTIMEO
 24153           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24154
 24155
 24156* EXEC CICS SEND
 24157*        MAP      (PI-MAP-NAME)
 24158*        MAPSET   (MAPSET-EL6311S)
 24159*        FROM     (EL631BI)
 24160*        DATAONLY
 24161*        CURSOR
 24162*    END-EXEC.
 24163     MOVE LENGTH OF
 24164      EL631BI
 24165       TO DFHEIV12
 24166     MOVE -1
 24167       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 446
* EL6311.cbl
 24168*    MOVE '8$D    CT       H L F ,   #00020310' TO DFHEIV0
 24169     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24170     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24171     MOVE X'2020233030303230333130' TO DFHEIV0(25:11)
 24172     CALL 'kxdfhei1' USING DFHEIV0,
 24173           PI-MAP-NAME,
 24174           EL631BI,
 24175           DFHEIV12,
 24176           MAPSET-EL6311S,
 24177           DFHEIV99,
 24178           DFHEIV99,
 24179           DFHEIV99,
 24180           DFHEIV11,
 24181           DFHEIV99,
 24182           DFHEIV99,
 24183           DFHEIV99
 24184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24185
 24186
 24187     GO TO 9100-RETURN-TRAN.
 24188
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 447
* EL6311.cbl
 24190
 24191******************************************************************
 24192*                                                                *
 24193*           U T I L I T Y   R O U T I N E S                      *
 24194*                                                                *
 24195******************************************************************
 24196
 24197 8300-SEND-TEXT.
 24198
 24199* EXEC CICS SEND TEXT
 24200*        FROM     (LOGOFF-TEXT)
 24201*        LENGTH   (LOGOFF-LENGTH)
 24202*        ERASE
 24203*        FREEKB
 24204*    END-EXEC.
 24205*    MOVE '8&      T  E F  H   F -   #00020329' TO DFHEIV0
 24206     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24207     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24208     MOVE X'2020233030303230333239' TO DFHEIV0(25:11)
 24209     CALL 'kxdfhei1' USING DFHEIV0,
 24210           LOGOFF-TEXT,
 24211           LOGOFF-LENGTH,
 24212           DFHEIV99,
 24213           DFHEIV99,
 24214           DFHEIV99,
 24215           DFHEIV99,
 24216           DFHEIV99,
 24217           DFHEIV99,
 24218           DFHEIV99,
 24219           DFHEIV99,
 24220           DFHEIV99,
 24221           DFHEIV99
 24222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24223
 24224
 24225
 24226* EXEC CICS RETURN
 24227*    END-EXEC.
 24228*    MOVE '.(                    ''   #00020336' TO DFHEIV0
 24229     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24230     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24231     MOVE X'2020233030303230333336' TO DFHEIV0(25:11)
 24232     CALL 'kxdfhei1' USING DFHEIV0,
 24233           DFHEIV99,
 24234           DFHEIV99,
 24235           DFHEIV99,
 24236           DFHEIV99,
 24237           DFHEIV99,
 24238           DFHEIV99
 24239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24240
 24241
 24242 8400-LOG-JOURNAL-RECORD.
 24243     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24244     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24245
 24246*    EXEC CICS JOURNAL
 24247*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 448
* EL6311.cbl
 24248*        JTYPEID     ('EL')
 24249*        FROM        (JOURNAL-RECORD)
 24250*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24251*    END-EXEC.
 24252
 24253 8600-DEEDIT.
 24254
 24255* EXEC CICS BIF DEEDIT
 24256*         FIELD   (DEEDIT-FIELD)
 24257*         LENGTH  (15)
 24258*    END-EXEC.
 24259     MOVE 15
 24260       TO DFHEIV11
 24261*    MOVE '@"L                   #   #00020351' TO DFHEIV0
 24262     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24263     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24264     MOVE X'2020233030303230333531' TO DFHEIV0(25:11)
 24265     CALL 'kxdfhei1' USING DFHEIV0,
 24266           DEEDIT-FIELD,
 24267           DFHEIV11
 24268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24269
 24270
 24271 8800-UNAUTHORIZED-ACCESS.
 24272     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24273     GO TO 8300-SEND-TEXT.
 24274
 24275 8810-PF23.
 24276     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24277     MOVE XCTL-EL005             TO PGM-NAME.
 24278     GO TO 9300-XCTL.
 24279
 24280 9100-RETURN-TRAN.
 24281     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24282
 24283     IF  PI-MAP-NAME =  EL631B
 24284         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24285
 24286     IF  PI-MAP-NAME =  EL631C
 24287         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24288
 24289     IF  PI-MAP-NAME =  EL631D
 24290         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24291
 24292
 24293* EXEC CICS RETURN
 24294*        TRANSID    (TRANS-EXB1)
 24295*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24296*        LENGTH     (1300)
 24297*    END-EXEC.
 24298     MOVE 1300
 24299       TO DFHEIV11
 24300*    MOVE '.(CT                  ''   #00020377' TO DFHEIV0
 24301     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24302     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24303     MOVE X'2020233030303230333737' TO DFHEIV0(25:11)
 24304     CALL 'kxdfhei1' USING DFHEIV0,
 24305           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 449
* EL6311.cbl
 24306           PROGRAM-INTERFACE-BLOCK,
 24307           DFHEIV11,
 24308           DFHEIV99,
 24309           DFHEIV99,
 24310           DFHEIV99
 24311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24312
 24313
 24314 9200-RETURN-MAIN-MENU.
 24315     MOVE XCTL-EL626             TO PGM-NAME.
 24316     GO TO 9300-XCTL.
 24317
 24318 9300-XCTL.
 24319
 24320* EXEC CICS XCTL
 24321*        PROGRAM    (PGM-NAME)
 24322*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24323*        LENGTH     (PI-COMM-LENGTH)
 24324*    END-EXEC.
 24325*    MOVE '.$C                   %   #00020388' TO DFHEIV0
 24326     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24327     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24328     MOVE X'2020233030303230333838' TO DFHEIV0(25:11)
 24329     CALL 'kxdfhei1' USING DFHEIV0,
 24330           PGM-NAME,
 24331           PROGRAM-INTERFACE-BLOCK,
 24332           PI-COMM-LENGTH,
 24333           DFHEIV99
 24334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24335
 24336
 24337 9400-CLEAR.
 24338     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24339     GO TO 9300-XCTL.
 24340
 24341 9500-PF12.
 24342     MOVE XCTL-EL010             TO PGM-NAME.
 24343     GO TO 9300-XCTL.
 24344
 24345 9600-PGMID-ERROR.
 24346
 24347* EXEC CICS HANDLE CONDITION
 24348*        PGMIDERR    (8300-SEND-TEXT)
 24349*    END-EXEC.
 24350*    MOVE '"$L                   ! \ #00020403' TO DFHEIV0
 24351     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24353     MOVE X'5C20233030303230343033' TO DFHEIV0(25:11)
 24354     CALL 'kxdfhei1' USING DFHEIV0
 24355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24356
 24357
 24358     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24359     MOVE ' '                    TO PI-ENTRY-CD-1.
 24360     MOVE XCTL-EL005             TO PGM-NAME.
 24361     MOVE PGM-NAME               TO LOGOFF-PGM.
 24362     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24363     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 450
* EL6311.cbl
 24364
 24365 9700-DATE-LINK.
 24366     MOVE LINK-ELDATCV           TO PGM-NAME.
 24367
 24368* EXEC CICS LINK
 24369*        PROGRAM    (PGM-NAME)
 24370*        COMMAREA   (DATE-CONVERSION-DATA)
 24371*        LENGTH     (DC-COMM-LENGTH)
 24372*    END-EXEC.
 24373*    MOVE '."C                   (   #00020416' TO DFHEIV0
 24374     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24375     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24376     MOVE X'2020233030303230343136' TO DFHEIV0(25:11)
 24377     CALL 'kxdfhei1' USING DFHEIV0,
 24378           PGM-NAME,
 24379           DATE-CONVERSION-DATA,
 24380           DC-COMM-LENGTH,
 24381           DFHEIV99,
 24382           DFHEIV99,
 24383           DFHEIV99,
 24384           DFHEIV99
 24385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24386
 24387
 24388 9800-LINK-PENDING-EDIT.
 24389     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24390     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24391
 24392     MOVE LINK-EL050             TO PGM-NAME
 24393     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24394     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24395                                    WK-CO-TOL-CLAIM
 24396                                    WK-CO-TOL-PREM
 24397                                    WK-CO-TOL-REFUND
 24398                                    WK-CO-TOL-PREM-PCT
 24399                                    WK-CO-TOL-REFUND-PCT
 24400                                    WK-REFUND-OVS-AMT
 24401                                    WK-REFUND-OVS-PCT
 24402                                    WK-ACCT-ADDR
 24403                                    WK-LIFE-EDIT-ADDR
 24404                                    WK-AH-EDIT-ADDR
 24405                                    WK-LIFE-BEN-ADDR
 24406                                    WK-AH-BEN-ADDR
 24407                                    WK-STATE-ADDR
 24408                                    WK-PLAN-ADDR
 24409                                    WK-FORM-ADDR
 24410     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24411
 24412     MOVE '6'                    TO WK-ENTRY-SW.
 24413
 24414     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24415
 24416     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24417                                    EC-AM-EXPIRATION-DT
 24418                                    EC-AM-EFFECTIVE-DT
 24419                                    EC-CM-LF-CANCEL-DT
 24420                                    EC-CM-AH-CANCEL-DT
 24421                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 451
* EL6311.cbl
 24422
 24423     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24424                                    EC-CO-TOL-REFUND
 24425                                    EC-CO-MIN-AGE
 24426                                    EC-CO-MIN-PREMIUM
 24427                                    EC-CO-MIN-TERM
 24428                                    EC-CO-MAX-TERM
 24429                                    EC-ST-TOL-PREM
 24430                                    EC-ST-TOL-REFUND
 24431                                    EC-AM-LF-TOL-PREM
 24432                                    EC-AM-AH-TOL-PREM
 24433                                    EC-AM-LF-MAX-ATT-AGE
 24434                                    EC-AM-LF-MAX-AGE
 24435                                    EC-AM-LF-MAX-TERM
 24436                                    EC-AM-LF-MAX-TOT-BEN
 24437                                    EC-AM-AH-MAX-ATT-AGE
 24438                                    EC-AM-AH-MAX-AGE
 24439                                    EC-AM-AH-MAX-TERM
 24440                                    EC-AM-AH-MAX-TOT-BEN
 24441                                    EC-AM-AH-MAX-MON-BEN
 24442                                    EC-RT-LF-MAX-ATT-AGE
 24443                                    EC-RT-LF-MAX-AGE
 24444                                    EC-RT-LF-MAX-TERM
 24445                                    EC-RT-LF-MAX-TOT-BEN
 24446                                    EC-RT-AH-MAX-ATT-AGE
 24447                                    EC-RT-AH-MAX-AGE
 24448                                    EC-RT-AH-MAX-TERM
 24449                                    EC-RT-AH-MAX-TOT-BEN
 24450                                    EC-RT-AH-MAX-MON-BEN
 24451                                    EC-RT-AH-RATE
 24452                                    EC-RT-LF-RATE
 24453                                    EC-RT-LF-NSP-RATE
 24454                                    EC-RT-AH-NSP-RATE
 24455                                    EC-CM-LF-PRIOR-REFUND
 24456                                    EC-CM-AH-PRIOR-REFUND.
 24457
 24458     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24459                                    EC-ST-TOL-PREM-PCT
 24460                                    EC-AM-LF-TOL-REFUND
 24461                                    EC-AM-LF-DEV-PERCENT
 24462                                    EC-CO-TOL-REFUND-PCT
 24463                                    EC-ST-TOL-REFUND-PCT
 24464                                    EC-AM-AH-TOL-REFUND
 24465                                    EC-AM-AH-DEV-PERCENT.
 24466
 24467
 24468* EXEC CICS LINK
 24469*         PROGRAM   (PGM-NAME)
 24470*         COMMAREA  (PASSED-RECORD)
 24471*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24472*    END-EXEC.
 24473*    MOVE '."C                   (   #00020501' TO DFHEIV0
 24474     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24476     MOVE X'2020233030303230353031' TO DFHEIV0(25:11)
 24477     CALL 'kxdfhei1' USING DFHEIV0,
 24478           PGM-NAME,
 24479           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 452
* EL6311.cbl
 24480           WS-EDIT-PASS-LENGTH,
 24481           DFHEIV99,
 24482           DFHEIV99,
 24483           DFHEIV99,
 24484           DFHEIV99
 24485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24486
 24487
 24488     MOVE '1'                    TO PI-EDIT-SW.
 24489     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24490
 24491     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24492
 24493     IF PI-COMPANY-ID = 'UCL'
 24494         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24495
 24496     IF VALID-PB-ID
 24497        GO TO 9800-EXIT.
 24498
 24499     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24500
 24501     IF PI-MAP-NAME = EL631B
 24502        MOVE -1                  TO BMAINTL
 24503       ELSE
 24504        MOVE -1                  TO CMAINTL.
 24505
 24506     GO TO 8200-SEND-DATAONLY.
 24507
 24508 9800-EXIT.
 24509      EXIT.
 24510
 24511 9900-ERROR-FORMAT.
 24512
 24513     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24514
 24515     IF NOT EMI-ERRORS-COMPLETE
 24516         MOVE LINK-EL001         TO PGM-NAME
 24517
 24518* EXEC CICS LINK
 24519*            PROGRAM    (PGM-NAME)
 24520*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24521*            LENGTH     (EMI-COMM-LENGTH)
 24522*        END-EXEC.
 24523*    MOVE '."C                   (   #00020536' TO DFHEIV0
 24524     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24526     MOVE X'2020233030303230353336' TO DFHEIV0(25:11)
 24527     CALL 'kxdfhei1' USING DFHEIV0,
 24528           PGM-NAME,
 24529           ERROR-MESSAGE-INTERFACE-BLOCK,
 24530           EMI-COMM-LENGTH,
 24531           DFHEIV99,
 24532           DFHEIV99,
 24533           DFHEIV99,
 24534           DFHEIV99
 24535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24536
 24537
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 453
* EL6311.cbl
 24538 9900-EXIT.
 24539     EXIT.
 24540
 24541 9990-ABEND.
 24542     MOVE LINK-EL004             TO PGM-NAME.
 24543     MOVE DFHEIBLK               TO EMI-LINE1.
 24544
 24545* EXEC CICS LINK
 24546*        PROGRAM   (PGM-NAME)
 24547*        COMMAREA  (EMI-LINE1)
 24548*        LENGTH    (72)
 24549*    END-EXEC.
 24550     MOVE 72
 24551       TO DFHEIV11
 24552*    MOVE '."C                   (   #00020548' TO DFHEIV0
 24553     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24555     MOVE X'2020233030303230353438' TO DFHEIV0(25:11)
 24556     CALL 'kxdfhei1' USING DFHEIV0,
 24557           PGM-NAME,
 24558           EMI-LINE1,
 24559           DFHEIV11,
 24560           DFHEIV99,
 24561           DFHEIV99,
 24562           DFHEIV99,
 24563           DFHEIV99
 24564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24565
 24566
 24567     IF PI-MAP-NAME = EL631B
 24568        MOVE -1                  TO BMAINTL
 24569       ELSE
 24570        MOVE -1                  TO CMAINTL.
 24571
 24572     IF EIBTRNID NOT = TRANS-EXB1
 24573        GO TO 8100-SEND-INITIAL-MAP
 24574       ELSE
 24575        GO TO 8200-SEND-DATAONLY.
 24576
 24577 9995-SECURITY-VIOLATION.
 24578*                            COPY ELCSCTP.
 24579******************************************************************
 24580*                                                                *
 24581*                            ELCSCTP                             *
 24582*                            VMOD=2.001                          *
 24583*                                                                *
 24584*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24585******************************************************************
 24586
 24587
 24588     MOVE EIBDATE          TO SM-JUL-DATE.
 24589     MOVE EIBTRMID         TO SM-TERMID.
 24590     MOVE THIS-PGM         TO SM-PGM.
 24591     MOVE EIBTIME          TO TIME-IN.
 24592     MOVE TIME-OUT         TO SM-TIME.
 24593     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24594
 24595
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 454
* EL6311.cbl
 24596* EXEC CICS LINK
 24597*         PROGRAM  ('EL003')
 24598*         COMMAREA (SECURITY-MESSAGE)
 24599*         LENGTH   (80)
 24600*    END-EXEC.
 24601     MOVE 'EL003' TO DFHEIV1
 24602     MOVE 80
 24603       TO DFHEIV11
 24604*    MOVE '."C                   (   #00020582' TO DFHEIV0
 24605     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24606     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24607     MOVE X'2020233030303230353832' TO DFHEIV0(25:11)
 24608     CALL 'kxdfhei1' USING DFHEIV0,
 24609           DFHEIV1,
 24610           SECURITY-MESSAGE,
 24611           DFHEIV11,
 24612           DFHEIV99,
 24613           DFHEIV99,
 24614           DFHEIV99,
 24615           DFHEIV99
 24616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24617
 24618
 24619******************************************************************
 24620
 24621
 24622 9999-DFHBACK SECTION.
 24623     MOVE '9%                    "   ' TO DFHEIV0
 24624     MOVE 'EL6311' TO DFHEIV1
 24625     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24626     GOBACK.
 24627 9999-DFHEXIT.
 24628     IF DFHEIGDJ EQUAL 0001
 24629         NEXT SENTENCE
 24630     ELSE IF DFHEIGDJ EQUAL 2
 24631         GO TO 9600-PGMID-ERROR,
 24632               9990-ABEND,
 24633               9990-ABEND,
 24634               0010-MAIN-LOGIC
 24635         DEPENDING ON DFHEIGDI
 24636     ELSE IF DFHEIGDJ EQUAL 3
 24637         GO TO 1280-BATCH-HDR-NOT-FOUND
 24638         DEPENDING ON DFHEIGDI
 24639     ELSE IF DFHEIGDJ EQUAL 4
 24640         GO TO 1290-DUPLICATE-ALT-INDEX
 24641         DEPENDING ON DFHEIGDI
 24642     ELSE IF DFHEIGDJ EQUAL 5
 24643         GO TO 1295-CERT-TRL-REC-NOTFND
 24644         DEPENDING ON DFHEIGDI
 24645     ELSE IF DFHEIGDJ EQUAL 6
 24646         GO TO 1380-BATCH-HDR-NOT-FOUND
 24647         DEPENDING ON DFHEIGDI
 24648     ELSE IF DFHEIGDJ EQUAL 7
 24649         GO TO 1385-REC-NOT-FOUND
 24650         DEPENDING ON DFHEIGDI
 24651     ELSE IF DFHEIGDJ EQUAL 8
 24652         GO TO 1386-NOTFND
 24653         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 455
* EL6311.cbl
 24654     ELSE IF DFHEIGDJ EQUAL 9
 24655         GO TO 1399-EXIT
 24656         DEPENDING ON DFHEIGDI
 24657     ELSE IF DFHEIGDJ EQUAL 10
 24658         GO TO 1480-BATCH-HDR-NOT-FOUND
 24659         DEPENDING ON DFHEIGDI
 24660     ELSE IF DFHEIGDJ EQUAL 11
 24661         GO TO 1490-RECORD-NOT-FOUND
 24662         DEPENDING ON DFHEIGDI
 24663     ELSE IF DFHEIGDJ EQUAL 12
 24664         GO TO 1405-DELETE-CERTIFICATE
 24665         DEPENDING ON DFHEIGDI
 24666     ELSE IF DFHEIGDJ EQUAL 13
 24667         GO TO 1420-CONTINUE-DELETE
 24668         DEPENDING ON DFHEIGDI
 24669     ELSE IF DFHEIGDJ EQUAL 14
 24670         GO TO 1406-DELETE-ERNOTE
 24671         DEPENDING ON DFHEIGDI
 24672     ELSE IF DFHEIGDJ EQUAL 15
 24673         GO TO 1407-DELETE-MAILING
 24674         DEPENDING ON DFHEIGDI
 24675     ELSE IF DFHEIGDJ EQUAL 16
 24676         GO TO 1420-CONTINUE-DELETE
 24677         DEPENDING ON DFHEIGDI
 24678     ELSE IF DFHEIGDJ EQUAL 17
 24679         GO TO 1480-BATCH-HDR-NOT-FOUND
 24680         DEPENDING ON DFHEIGDI
 24681     ELSE IF DFHEIGDJ EQUAL 18
 24682         GO TO 1475-DELETE-FINISHED
 24683         DEPENDING ON DFHEIGDI
 24684     ELSE IF DFHEIGDJ EQUAL 19
 24685         GO TO 2280-BATCH-HDR-NOT-FOUND
 24686         DEPENDING ON DFHEIGDI
 24687     ELSE IF DFHEIGDJ EQUAL 20
 24688         GO TO 2290-DUPLICATE-ALT-INDEX
 24689         DEPENDING ON DFHEIGDI
 24690     ELSE IF DFHEIGDJ EQUAL 21
 24691         GO TO 2380-BATCH-HDR-NOT-FOUND
 24692         DEPENDING ON DFHEIGDI
 24693     ELSE IF DFHEIGDJ EQUAL 22
 24694         GO TO 2385-REC-NOT-FOUND
 24695         DEPENDING ON DFHEIGDI
 24696     ELSE IF DFHEIGDJ EQUAL 23
 24697         GO TO 2380-BATCH-HDR-NOT-FOUND
 24698         DEPENDING ON DFHEIGDI
 24699     ELSE IF DFHEIGDJ EQUAL 24
 24700         GO TO 2485-BATCH-HDR-NOT-FOUND
 24701         DEPENDING ON DFHEIGDI
 24702     ELSE IF DFHEIGDJ EQUAL 25
 24703         GO TO 2490-RECORD-NOT-FOUND
 24704         DEPENDING ON DFHEIGDI
 24705     ELSE IF DFHEIGDJ EQUAL 26
 24706         GO TO 2475-CONTINUE-DELETE
 24707         DEPENDING ON DFHEIGDI
 24708     ELSE IF DFHEIGDJ EQUAL 27
 24709         GO TO 2485-BATCH-HDR-NOT-FOUND
 24710         DEPENDING ON DFHEIGDI
 24711     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 456
* EL6311.cbl
 24712         GO TO 2480-DELETE-FINISHED
 24713         DEPENDING ON DFHEIGDI
 24714     ELSE IF DFHEIGDJ EQUAL 29
 24715         GO TO 2820-PROCESS-REWRITE
 24716         DEPENDING ON DFHEIGDI
 24717     ELSE IF DFHEIGDJ EQUAL 30
 24718         GO TO 2885-RECORD-MISSING
 24719         DEPENDING ON DFHEIGDI
 24720     ELSE IF DFHEIGDJ EQUAL 31
 24721         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24722         DEPENDING ON DFHEIGDI
 24723     ELSE IF DFHEIGDJ EQUAL 32
 24724         GO TO 2827-DELETE-MAILING
 24725         DEPENDING ON DFHEIGDI
 24726     ELSE IF DFHEIGDJ EQUAL 33
 24727         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24728         DEPENDING ON DFHEIGDI
 24729     ELSE IF DFHEIGDJ EQUAL 34
 24730         GO TO 2920-PROCESS-REWRITE
 24731         DEPENDING ON DFHEIGDI
 24732     ELSE IF DFHEIGDJ EQUAL 35
 24733         GO TO 2985-RECORD-MISSING
 24734         DEPENDING ON DFHEIGDI
 24735     ELSE IF DFHEIGDJ EQUAL 36
 24736         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24737         DEPENDING ON DFHEIGDI
 24738     ELSE IF DFHEIGDJ EQUAL 37
 24739         GO TO 2990-DUPLICATE-RECORD
 24740         DEPENDING ON DFHEIGDI
 24741     ELSE IF DFHEIGDJ EQUAL 38
 24742         GO TO 3590-NOT-FOUND
 24743         DEPENDING ON DFHEIGDI
 24744     ELSE IF DFHEIGDJ EQUAL 39
 24745         GO TO 3690-NOT-FOUND
 24746         DEPENDING ON DFHEIGDI
 24747     ELSE IF DFHEIGDJ EQUAL 40
 24748         GO TO 3990-NOT-FOUND
 24749         DEPENDING ON DFHEIGDI
 24750     ELSE IF DFHEIGDJ EQUAL 41
 24751         GO TO 4050-END-RECORDS,
 24752               4050-END-RECORDS
 24753         DEPENDING ON DFHEIGDI
 24754     ELSE IF DFHEIGDJ EQUAL 42
 24755         GO TO 4150-END-BATCH
 24756         DEPENDING ON DFHEIGDI
 24757     ELSE IF DFHEIGDJ EQUAL 43
 24758         GO TO 4150-END-BATCH
 24759         DEPENDING ON DFHEIGDI
 24760     ELSE IF DFHEIGDJ EQUAL 44
 24761         GO TO 4250-END-RECORDS,
 24762               4250-END-RECORDS
 24763         DEPENDING ON DFHEIGDI
 24764     ELSE IF DFHEIGDJ EQUAL 45
 24765         GO TO 4350-END-BATCH,
 24766               4350-END-BATCH
 24767         DEPENDING ON DFHEIGDI
 24768     ELSE IF DFHEIGDJ EQUAL 46
 24769         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page 457
* EL6311.cbl
 24770               4550-END-RECORDS
 24771         DEPENDING ON DFHEIGDI
 24772     ELSE IF DFHEIGDJ EQUAL 47
 24773         GO TO 4680-NOT-FOUND,
 24774               4680-NOT-FOUND
 24775         DEPENDING ON DFHEIGDI
 24776     ELSE IF DFHEIGDJ EQUAL 48
 24777         GO TO 4860-NOT-FOUND,
 24778               4850-END-RECORDS
 24779         DEPENDING ON DFHEIGDI
 24780     ELSE IF DFHEIGDJ EQUAL 49
 24781         GO TO 4970-NOT-FOUND,
 24782               4950-END-RECORDS
 24783         DEPENDING ON DFHEIGDI
 24784     ELSE IF DFHEIGDJ EQUAL 50
 24785         GO TO 5050-NOT-FOUND
 24786         DEPENDING ON DFHEIGDI
 24787     ELSE IF DFHEIGDJ EQUAL 51
 24788         GO TO 5050-NOT-FOUND
 24789         DEPENDING ON DFHEIGDI
 24790     ELSE IF DFHEIGDJ EQUAL 52
 24791         GO TO 5050-NOT-FOUND
 24792         DEPENDING ON DFHEIGDI
 24793     ELSE IF DFHEIGDJ EQUAL 53
 24794         GO TO 5550-END-RECORDS,
 24795               5550-END-RECORDS
 24796         DEPENDING ON DFHEIGDI
 24797     ELSE IF DFHEIGDJ EQUAL 54
 24798         GO TO 6050-QID-ERROR
 24799         DEPENDING ON DFHEIGDI
 24800     ELSE IF DFHEIGDJ EQUAL 55
 24801         GO TO 6050-QID-ERROR
 24802         DEPENDING ON DFHEIGDI
 24803     ELSE IF DFHEIGDJ EQUAL 56
 24804         GO TO 6400-CONTINUE,
 24805               6400-CONTINUE
 24806         DEPENDING ON DFHEIGDI
 24807     ELSE IF DFHEIGDJ EQUAL 57
 24808         GO TO 3690-NOT-FOUND
 24809         DEPENDING ON DFHEIGDI
 24810     ELSE IF DFHEIGDJ EQUAL 58
 24811         GO TO 7399-EXIT
 24812         DEPENDING ON DFHEIGDI
 24813     ELSE IF DFHEIGDJ EQUAL 59
 24814         GO TO 7550-OFFICER-NOTFND
 24815         DEPENDING ON DFHEIGDI
 24816     ELSE IF DFHEIGDJ EQUAL 60
 24817         GO TO 8300-SEND-TEXT
 24818         DEPENDING ON DFHEIGDI.
 24819     MOVE '9%                    "   ' TO DFHEIV0
 24820     MOVE 'EL6311' TO DFHEIV1
 24821     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24822     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14900     Code:       98424
