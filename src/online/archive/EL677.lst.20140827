* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34******************************************************************
    35 ENVIRONMENT DIVISION.
    36
    37 DATA DIVISION.
    38 WORKING-STORAGE SECTION.
    39 01  DFH-START PIC X(04).
    40 77  FILLER  PIC X(32)  VALUE '********************************'.
    41 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    42 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    43 77  s1                          pic s999 comp-3 value +0.
    44 77  s2                          pic s999 comp-3 value +0.
    45 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    46 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    47 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    48 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    49 77  ws-browse-sw                pic x value spaces.
    50     88  i-say-when                 value 'Y'.
    51 77  ws-delete-sw                pic x value ' '.
    52     88  row-deleted                 value 'Y'.
    53 77  ws-sql-code                 pic s9(7) value zeros.
    54 77  ws-dis-sql-code             pic -9999999 value zeros.
    55 77  ws-match-sw                 pic x  value ' '.
    56     88  found-a-match             value 'Y'.
    57 77  ws-commit-sw                pic x value ' '.
    58     88  tbl-commited                value 'Y'.
    59 01  P pointer.
    60 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    61 01  var-ptr pointer.
    62 01  env-var-len                 pic 9(4)  binary.
    63 01  rc                          pic 9(9)  binary.
    64
    65 01  WS-KIXSYS.
    66     05  WS-KIX-FIL1             PIC X(10).
    67     05  WS-KIX-APPS             PIC X(10).
    68     05  WS-KIX-ENV              PIC X(10).
    69     05  WS-KIX-MYENV            PIC X(10).
    70     05  WS-KIX-SYS              PIC X(10).
*   71 EXEC SQL
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page   3
* EL677.cbl
*   72    INCLUDE SQLDA
*   73 END-EXEC
    74 01 SQLDA sync.
    75    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    76    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    77    05 SQLN                  PIC S9(4) COMP-5 value 0.
    78    05 SQLD                  PIC S9(4) COMP-5 value 0.
    79    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    80       10 SQLTYPE            PIC S9(4) COMP-5.
    81       10 SQLLEN             PIC S9(4) COMP-5.
    82$IF P64 SET
    83X      *> For 64-bit environments, ensure that SQLDATA is
    84X      *> aligned on an 8-byte boundary.
    85X      10 FILLER             PIC S9(9) COMP-5.
    86$END
    87       10 SQLDATA            USAGE POINTER.
    88       10 SQLIND             USAGE POINTER.
    89       10 SQLNAME.
    90          15 SQLNAMEL        PIC S9(4) COMP-5.
    91          15 SQLNAMEC        PIC X(30).
    92
    93* Values for SQLTYPE
    94
    95 78  ESQL-DATE-CHAR              VALUE 384.
    96 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    97 78  ESQL-DATE-REC               VALUE 386.
    98 78  ESQL-DATE-REC-NULL          VALUE 387.
    99 78  ESQL-TIME-CHAR              VALUE 388.
   100 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   101 78  ESQL-TIME-REC               VALUE 390.
   102 78  ESQL-TIME-REC-NULL          VALUE 391.
   103 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   104 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   105 78  ESQL-TIMESTAMP-REC          VALUE 394.
   106 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   107 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   108 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   109 78  ESQL-TS-OFFSET-REC          VALUE 398.
   110 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   111 78  ESQL-LONGVARBINARY          VALUE 404.
   112 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   113 78  ESQL-LONGVARCHAR            VALUE 408.
   114 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   115 78  ESQL-BINARY                 VALUE 444.
   116 78  ESQL-BINARY-NULL            VALUE 445.
   117 78  ESQL-VARBINARY              VALUE 446.
   118 78  ESQL-VARBINARY-NULL         VALUE 447.
   119 78  ESQL-VARCHAR                VALUE 448.
   120 78  ESQL-VARCHAR-NULL           VALUE 449.
   121
   122 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   123 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   124
   125 78  ESQL-CHAR                   VALUE 452.
   126 78  ESQL-CHAR-NULL              VALUE 453.
   127
   128 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   129 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130
   131 78  ESQL-DOUBLE                 VALUE 480.
   132 78  ESQL-DOUBLE-NULL            VALUE 481.
   133 78  ESQL-REAL                   VALUE 482.
   134 78  ESQL-REAL-NULL              VALUE 483.
   135 78  ESQL-DECIMAL                VALUE 484.
   136 78  ESQL-DECIMAL-NULL           VALUE 485.
   137 78  ESQL-INTEGER                VALUE 496.
   138 78  ESQL-INTEGER-NULL           VALUE 497.
   139 78  ESQL-SMALLINT               VALUE 500.
   140 78  ESQL-SMALLINT-NULL          VALUE 501.
   141 78  ESQL-TINYINT                VALUE 502.
   142 78  ESQL-TINYINT-NULL           VALUE 503.
*  143 EXEC SQL
*  144    INCLUDE SQLCA
*  145 END-EXEC
   146 01 SQLCA.
   147     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   148     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   149     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   150     05  SQLERRM.
   151         49  SQLERRML    PIC S9(4) COMP-5.
   152         49  SQLERRMC    PIC X(70).
   153     05  SQLERRP         PIC X(8).
   154     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   155     05  SQLWARN.
   156         10  SQLWARN0    PIC X.
   157         10  SQLWARN1    PIC X.
   158         10  SQLWARN2    PIC X.
   159         10  SQLWARN3    PIC X.
   160         10  SQLWARN4    PIC X.
   161         10  SQLWARN5    PIC X.
   162         10  SQLWARN6    PIC X.
   163         10  SQLWARN7    PIC X.
   164     05  SQLEXT.
   165         10  SQLWARN8    PIC X.
   166         10  SQLWARN9    PIC X.
   167         10  SQLWARN10   PIC X.
   168         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   169     05  SQLSTATE    PIC X(5).
   170 EXEC SQL
   171    BEGIN DECLARE SECTION
   172 END-EXEC
   173 01  ws-paid-bank-work-area.
   174     05  ws-pb-compid            pic x(9).
   175     05  ws-pb-check-no          pic x(10).
   176     05  ws-pb-bad-check-no      pic x(10).
   177     05  ws-check-amount         pic x(10).
   178 01  Paid-Bank-Info.
   179     05  pb-check-no             pic 9(10).
   180     05  pb-tran-type            pic x.
   181     05  pb-bank-acct-desc       pic x(50).
   182     05  pb-amount               pic x(12).
   183     05  pb-paid-date            pic x(25).
   184 01  ws-key-stuff.
   185     05  ws-compid               pic xxx.
   186     05  ws-carrier              pic x.
   187     05  ws-grouping             pic x(6).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page   5
* EL677.cbl
   188     05  ws-state                pic xx.
   189     05  ws-account              pic x(10).
   190     05  ws-eff-date             pic x(10).
   191     05  ws-certificate          pic x(10).
   192     05  ws-cert-sfx             pic x.
   193     05  ws-seq-no               pic 999.
   194     05  ws-type                 pic x.
   195 01  sqlcmd                      pic x(1024).
   196 01  WS-MOE-DATE                 pic x(10).
   197 01  svr                         pic x(32).
   198 01  usr                         pic x(32).
   199 01  pass                        pic x(32).
   200 01  usr-pass                    pic x(64).
   201 01  ws-disp-code                pic s9(11).
   202***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   203***                                                            ***
   204***  These indicators are used to determine if a variable      ***
   205***  is passed nulls from sql. The indicator will be -1        ***
   206***  if the value on sql is nulls and +0 if the value is       ***
   207***  something other than nulls. Here is an example on how     ***
   208***  to use the indicator variables.                           ***
   209***                                                            ***
   210***     EXEC SQL                                               ***
   211***        fetch checkapp into                                 ***
   212***           :db-app-status :nu-app-status,                   ***
   213***           :db-app-by     :nu-app-by,                       ***
   214***           :db-app-date   :nu-app-date,                     ***
   215***           :db-app-batch  :nu-app-batch                     ***
   216***     END-EXEC                                               ***
   217***                                                            ***
   218***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   219 01  indicator-vaiables-for-nulls.
   220     05  nu-app-status           pic s9(4) comp value +0.
   221     05  nu-app-by               pic s9(4) comp value +0.
   222     05  nu-app-date             pic s9(4) comp value +0.
   223     05  nu-app-batch            pic s9(4) comp value +0.
   224     05  nu-fincar               pic s9(4) comp value +0.
   225 01  daily-check-request-rec.
   226     05  db-compid               pic xxx.
   227     05  db-carrier              pic x.
   228     05  db-grouping             pic x(6).
   229     05  db-state                pic xx.
   230     05  db-account              pic x(10).
   231     05  db-effdate              pic x(10).
   232     05  db-certificate          pic x(10).
   233     05  db-cert-sfx             pic x.
   234     05  db-seq-no               pic 999.
   235     05  db-type                 pic x.
   236     05  db-amount-n             pic 9(7).99.
   237     05  db-amount redefines db-amount-n
   238                                 pic x(10).
   239     05  db-checkno              pic x(15).
   240     05  db-checkdate            pic x(10).
   241     05  db-checkstatus          pic 9(5).
   242     05  db-releasebatch         pic 9(5).
   243     05  db-releasedt            pic x(10).
   244     05  db-releaseby            pic x(4).
   245     05  db-payeename1           pic x(30).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page   6
* EL677.cbl
   246     05  db-payeename2           pic x(30).
   247     05  db-payeeaddr1           pic x(30).
   248     05  db-payeeaddr2           pic x(30).
   249     05  db-payeecity            pic x(30).
   250     05  db-payeest              pic xx.
   251     05  db-payeezip             pic x(10).
   252     05  db-fincar               pic x.
   253     05  db-fingrp               pic x(6).
   254     05  db-finresp              pic x(10).
   255     05  db-finacct              pic x(10).
   256     05  db-preparer             pic x(4).
   257     05  db-app-status           pic x(9).
   258     05  dp-app-status-n redefines db-app-status
   259                                 pic 9(9).
   260     05  db-app-by               pic x(20).
   261     05  db-app-date             pic x(30).
   262     05  db-app-batch            pic x(10).
   263     05  db-return-to            pic x(30).
   264     05  db-insured-name         pic x(30).
   265 EXEC SQL
   266    END DECLARE SECTION
   267 END-EXEC
   268*                            COPY ELCSCTM.
   269******************************************************************
   270*                                                                *
   271*                                                                *
   272*                            ELCSCTM                             *
   273*                            VMOD=2.001                          *
   274*                                                                *
   275*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   276*                                                                *
   277******************************************************************
   278 01  SECURITY-MESSAGE.
   279     12  FILLER                          PIC X(30)
   280            VALUE '** LOGIC SECURITY VIOLATION -'.
   281     12  SM-READ                         PIC X(6).
   282     12  FILLER                          PIC X(5)
   283            VALUE ' PGM='.
   284     12  SM-PGM                          PIC X(6).
   285     12  FILLER                          PIC X(5)
   286            VALUE ' OPR='.
   287     12  SM-PROCESSOR-ID                 PIC X(4).
   288     12  FILLER                          PIC X(6)
   289            VALUE ' TERM='.
   290     12  SM-TERMID                       PIC X(4).
   291     12  FILLER                          PIC XX   VALUE SPACE.
   292     12  SM-JUL-DATE                     PIC 9(5).
   293     12  FILLER                          PIC X    VALUE SPACE.
   294     12  SM-TIME                         PIC 99.99.
   295
   296*                            COPY ELCSCRTY.
   297******************************************************************
   298*                                                                *
   299*                                                                *
   300*                            ELCSCRTY                            *
   301*                            VMOD=2.001                          *
   302*                                                                *
   303*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page   7
* EL677.cbl
   304*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   305*        SAVED IN PI-SECURITY-ADDRESS.                           *
   306*                                                                *
   307******************************************************************
   308 01  SECURITY-CONTROL.
   309     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   310     12  FILLER                       PIC XX    VALUE 'SC'.
   311     12  SC-CREDIT-CODES.
   312         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   313             20  SC-CREDIT-DISPLAY    PIC X.
   314             20  SC-CREDIT-UPDATE     PIC X.
   315     12  SC-CLAIMS-CODES.
   316         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   317             20  SC-CLAIMS-DISPLAY    PIC X.
   318             20  SC-CLAIMS-UPDATE     PIC X.
   319 01  ws-dummy-erchek             pic x(600).
   320 01  filler.
   321     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   322     05  WS-CHECK-AMT-TMPX REDEFINES
   323         WS-CHECK-AMT-TMP        PIC X(10).
   324     05  ws-ind                     pic s9(4) comp value +0.
   325     05  ws-ind-red redefines ws-ind pic xx.
   326     05  ws-display-ind             pic s9(7) value zeros.
   327 01  ws-compare-erchek-key          pic x(33) value low-values.
   328 01  ws-eracct-sw                   pic x value ' '.
   329     88  eracct-found                 value 'Y'.
   330 01  ws-eracct-start-sw             pic x value ' '.
   331     88  eracct-start                 value 'Y'.
   332 01  WS-DATE-AREA.
   333     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   334     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   335     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   336
   337 01  ws-work-amt-alpha           pic x(10).
   338 01  ws-work-amt-num redefines ws-work-amt-alpha
   339                                 pic 9(8)v99.
   340 01  ws-user-defined.
   341     05  ws-user-reason         pic xxx.
   342     05  ws-user-cert-no        pic x(11).
   343     05  ws-user-name           pic x(28).
   344 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   345 01  STANDARD-AREAS.
   346     12  ws-connect-sw               pic x  value ' '.
   347         88  connected-to-db             value 'Y'.
   348     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   349     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   350     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   351     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   352     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   353     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   354     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   355     12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.
   356     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   357     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   358     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   359     12  TIME-OUT-R  REDEFINES TIME-IN.
   360         16  FILLER                  PIC X.
   361         16  TIME-OUT                PIC 99V99.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page   8
* EL677.cbl
   362         16  FILLER                  PIC XX.
   363     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   364     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   365     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   366     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   367     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   368     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   369     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   370     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   371     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   372     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   373     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   374     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   375     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   376     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   377     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   378     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   379     12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.
   380     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   381     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   382     12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
   383     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   384     12  QID.
   385         16  QID-TERM                PIC X(4)    VALUE SPACES.
   386         16  FILLER                  PIC X(4)    VALUE '677A'.
   387
   388 01  WORK-AREAS.
   389     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   390     12  WS-AM-WK REDEFINES WS-AM-WORK.
   391         16  WS-AM-NUM               PIC S9(7)V99.
   392         16  WS-AM-SIGN              PIC X.
   393     12  WS-CHECK-WORK.
   394         16  FILLER                  PIC X        VALUE SPACE.
   395         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   396     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   397     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   398     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   399     12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.
   400     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   401     12  WS-SV-CARRIER               PIC X       VALUE SPACES.
   402     12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.
   403     12  WS-SV-STATE                 PIC XX      VALUE SPACES.
   404     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   405     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   406     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   407         WS-DT-DEEDIT-FIELD.
   408         16  FILLER                  PIC X(4).
   409         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   410     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   411     12  WS-DEEDIT-FIELD-V0          REDEFINES
   412         WS-DEEDIT-FIELD-A           PIC S9(15).
   413
   414     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   415     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   416         88 WS-CERT-FOUND                        VALUE 'Y'.
   417         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   418     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   419         88 WS-PNDB-FOUND                        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page   9
* EL677.cbl
   420         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   421     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   422         88  WS-PROCESS-CERT                     VALUE 'Y'.
   423     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   424         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   425     12  WS-PY-ENTRY-COMMENT.
   426         16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.
   427         16  FILLER                  PIC X(13)   VALUE
   428            ' MISC. CHECK '.
   429         16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.
   430         16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.
   431     12  WS-PY-REF-COMMENT.
   432         16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.
   433         16  FILLER                  PIC X(13)   VALUE
   434            ' REFUND PYMT '.
   435         16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.
   436         16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.
   437     12  WS-PY-END-COMMENT.
   438         16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.
   439         16  FILLER                  PIC X(13)   VALUE
   440            ' ENDORSEMENT '.
   441         16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.
   442         16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.
   443     12  WS-PY-DED-COMMENT.
   444         16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.
   445         16  FILLER                  PIC X(13)   VALUE
   446            ' STAT DEDUCT '.
   447         16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.
   448         16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.
   449     12  WS-PY-ADDL-COMMENT.
   450         16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.
   451         16  FILLER                  PIC X(13)   VALUE
   452            ' ADDL CHARGE '.
   453         16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.
   454         16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.
   455     12  WS-PY-REVERSAL-COMMENT.
   456         16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.
   457         16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE
   458            ' VOID REFUND '.
   459         16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.
   460         16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.
   461     12  WS-TMS-ENTRY-COMMENT.
   462         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   463         16  FILLER                  PIC XX      VALUE SPACES.
   464         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   465     12  WS-ZIP-CODE.
   466         16  WS-ZIP-PRIME.
   467             20  WS-ZIP-PRI-1ST      PIC X.
   468                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   469             20  FILLER              PIC X(4).
   470         16  WS-ZIP-PLUS4            PIC X(4).
   471     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   472         16  WS-CAN-POST1-1          PIC XXX.
   473         16  WS-CAN-POST1-2.
   474             20  WS-CAN-POST-4TH     PIC X.
   475             20  FILLER              PIC XX.
   476         16  FILLER                  PIC XXX.
   477     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  10
* EL677.cbl
   478         16  WS-CAN-POST2-1          PIC XXX.
   479         16  FILLER                  PIC X.
   480         16  WS-CAN-POST2-2          PIC XXX.
   481         16  FILLER                  PIC XX.
   482
   483*                                    COPY ELCNWA.
   484*****************************************************************
   485*                                                               *
   486*                                                               *
   487*                            ELCNWA.                            *
   488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   489*                            VMOD=2.003                         *
   490*                                                               *
   491*            M O V E   N A M E   W O R K   A R E A.             *
   492*                                                               *
   493*****************************************************************.
   494
   495 01  WS-NAME-WORK-AREA.
   496     05  WS-INSURED-LAST-NAME        PIC X(15).
   497     05  WS-INSURED-1ST-NAME         PIC X(12).
   498     05  WS-INSURED-MID-INIT         PIC X.
   499
   500     05  WS-NAME-WORK.
   501         10  WS-NW                   PIC X
   502             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   503
   504     05  WS-NAME-WORK2.
   505         10  WS-NW2                  PIC X
   506             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   507                                        NWA-INDEX0.
   508
   509     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   510                                     COMP-3.
   511
   512 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   513     88  RESP-NORMAL                    VALUE +0.
   514     88  resp-file-notfnd               value +12.
   515     88  RESP-NOTFND                    VALUE +13.
   516     88  resp-duprec                    value +14.
   517     88  resp-dupkey                    value +15.
   518     88  resp-invreq                    value +16.
   519     88  RESP-NOTOPEN                   VALUE +19.
   520     88  RESP-ENDFILE                   VALUE +20.
   521     88  resp-lengtherr                 value +22.
   522 01  ACCESS-KEYS.
   523     12  ELCNTL-KEY.
   524         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   525         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   526         16 ELCNTL-ACCESS.
   527             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   528             20  FILLER              PIC X       VALUE SPACES.
   529             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   530         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   531
   532     12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
   533
   534     12  ERACCT-KEY.
   535         16  ERACCT-CO               PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  11
* EL677.cbl
   536         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   537         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   538         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   539         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   540         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   541         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   542
   543     12  SAVE-ERACCT-KEY.
   544         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   545         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   546         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   547         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   548         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   549         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   550         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   551
   552     12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
   553
   554     12  ERCOMP-KEY.
   555         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   556         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   557         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   558         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   559         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   560         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   561
   562     12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
   563
   564     12  ELCERT-KEY.
   565         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   566         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   567         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   568         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   569         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   570         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   571         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   572         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   573
   574     12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
   575
   576     12  ERPNDB-PRIMARY-KEY.
   577         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   578         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   579         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   580         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   581
   582     12  ERPNDB-ALT-KEY.
   583         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   584         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   585         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   586         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   587         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   588         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   589         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   590         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   591         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   592         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   593
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  12
* EL677.cbl
   594     12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
   595
   596     12  ERPNDM-PRIMARY-KEY.
   597         16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.
   598         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   599         16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   600         16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   601
   602     12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
   603
   604     12  ERCHEK-KEY.
   605         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   606         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   607         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   608         16  CHEK-STATE              PIC XX      VALUE SPACES.
   609         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   610         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   611         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   612         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   613         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   614
   615     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   616     12  ERPYAJ-KEY.
   617         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   618         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   619         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   620         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   621         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   622         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   623         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   624
   625     12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
   626
   627 01  ERROR-NUMBERS.
   628     12  ER-0000                     PIC X(4)    VALUE '0000'.
   629     12  ER-0004                     PIC X(4)    VALUE '0004'.
   630     12  ER-0008                     PIC X(4)    VALUE '0008'.
   631     12  ER-0013                     PIC X(4)    VALUE '0013'.
   632     12  ER-0022                     PIC X(4)    VALUE '0022'.
   633     12  ER-0023                     PIC X(4)    VALUE '0023'.
   634     12  ER-0026                     PIC X(4)    VALUE '0026'.
   635     12  ER-0029                     PIC X(4)    VALUE '0029'.
   636     12  ER-0070                     PIC X(4)    VALUE '0070'.
   637     12  ER-0194                     PIC X(4)    VALUE '0194'.
   638     12  ER-0195                     PIC X(4)    VALUE '0195'.
   639     12  ER-0196                     PIC X(4)    VALUE '0196'.
   640     12  ER-0197                     PIC X(4)    VALUE '0197'.
   641     12  ER-0203                     PIC X(4)    VALUE '0203'.
   642     12  ER-0215                     PIC X(4)    VALUE '0215'.
   643     12  ER-0216                     PIC X(4)    VALUE '0216'.
   644     12  ER-0433                     PIC X(4)    VALUE '0433'.
   645     12  ER-0565                     PIC X(4)    VALUE '0565'.
   646     12  ER-1159                     PIC X(4)    VALUE '1159'.
   647     12  ER-1162                     PIC X(4)    VALUE '1162'.
   648     12  ER-2056                     PIC X(4)    VALUE '2056'.
   649     12  ER-2208                     PIC X(4)    VALUE '2208'.
   650     12  ER-2209                     PIC X(4)    VALUE '2209'.
   651     12  ER-2210                     PIC X(4)    VALUE '2210'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  13
* EL677.cbl
   652     12  ER-2230                     PIC X(4)    VALUE '2230'.
   653     12  ER-2237                     PIC X(4)    VALUE '2237'.
   654     12  ER-2238                     PIC X(4)    VALUE '2238'.
   655     12  ER-2294                     PIC X(4)    VALUE '2294'.
   656     12  ER-2394                     PIC X(4)    VALUE '2394'.
   657     12  ER-2438                     PIC X(4)    VALUE '2438'.
   658     12  ER-2439                     PIC X(4)    VALUE '2439'.
   659     12  ER-2583                     PIC X(4)    VALUE '2583'.
   660     12  ER-2600                     PIC X(4)    VALUE '2600'.
   661     12  ER-2726                     PIC X(4)    VALUE '2726'.
   662     12  ER-2905                     PIC X(4)    VALUE '2905'.
   663     12  ER-2906                     PIC X(4)    VALUE '2906'.
   664     12  ER-2907                     PIC X(4)    VALUE '2907'.
   665     12  ER-2908                     PIC X(4)    VALUE '2908'.
   666     12  ER-2909                     PIC X(4)    VALUE '2909'.
   667     12  ER-3044                     PIC X(4)    VALUE '3044'.
   668     12  ER-3046                     PIC X(4)    VALUE '3046'.
   669     12  ER-3047                     PIC X(4)    VALUE '3047'.
   670     12  ER-3445                     PIC X(4)    VALUE '3445'.
   671     12  er-3450                     pic x(4)    value '3450'.
   672     12  er-3451                     pic x(4)    value '3451'.
   673     12  er-3452                     pic x(4)    value '3452'.
   674     12  er-3453                     pic x(4)    value '3453'.
   675     12  er-3454                     pic x(4)    value '3454'.
   676     12  er-3455                     pic x(4)    value '3455'.
   677     12  ER-7389                     PIC X(4)    VALUE '7389'.
   678*                                    COPY ELCLOGOF.
   679******************************************************************
   680*                                                                *
   681*                                                                *
   682*                            ELCLOGOF.                           *
   683*                            VMOD=2.001                          *
   684*                                                                *
   685*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   686*                                                                *
   687******************************************************************
   688 01  CLASIC-LOGOFF.
   689     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   690     12  LOGOFF-TEXT.
   691         16  FILLER          PIC X(5)    VALUE SPACES.
   692         16  LOGOFF-MSG.
   693             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   694             20  FILLER      PIC X       VALUE SPACES.
   695             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   696         16  FILLER          PIC X(80)
   697           VALUE '* YOU ARE NOW LOGGED OFF'.
   698         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   699         16  FILLER          PIC X       VALUE QUOTE.
   700         16  LOGOFF-SYS-MSG  PIC X(17)
   701           VALUE 'S CLAS-IC SYSTEM '.
   702     12  TEXT-MESSAGES.
   703         16  UNACCESS-MSG    PIC X(29)
   704             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   705         16  PGMIDERR-MSG    PIC X(17)
   706             VALUE 'PROGRAM NOT FOUND'.
   707*                                    COPY ELCDATE.
   708******************************************************************
   709*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  14
* EL677.cbl
   710*                                                                *
   711*                            ELCDATE.                            *
   712*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   713*                            VMOD=2.003
   714*                                                                *
   715*                                                                *
   716*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   717*                 LENGTH = 200                                   *
   718******************************************************************
   719
   720 01  DATE-CONVERSION-DATA.
   721     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   722     12  DC-OPTION-CODE                PIC X.
   723         88  BIN-TO-GREG                VALUE ' '.
   724         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   725         88  EDIT-GREG-TO-BIN           VALUE '2'.
   726         88  YMD-GREG-TO-BIN            VALUE '3'.
   727         88  MDY-GREG-TO-BIN            VALUE '4'.
   728         88  JULIAN-TO-BIN              VALUE '5'.
   729         88  BIN-PLUS-ELAPSED           VALUE '6'.
   730         88  FIND-CENTURY               VALUE '7'.
   731         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   732         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   733         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   734         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   735         88  JULIAN-TO-BIN-3            VALUE 'C'.
   736         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   737         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   738         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   739         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   740         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   741         88  CHECK-LEAP-YEAR            VALUE 'H'.
   742         88  BIN-3-TO-GREG              VALUE 'I'.
   743         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   744         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   745         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   746         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   747         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   748         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   749         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   750         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   751         88  THREE-CHARACTER-BIN
   752                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   753         88  GREGORIAN-TO-BIN
   754                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   755         88  BIN-TO-GREGORIAN
   756                  VALUES ' ' '1' 'I' '8' 'G'.
   757         88  JULIAN-TO-BINARY
   758                  VALUES '5' 'C' 'E' 'F'.
   759     12  DC-ERROR-CODE                 PIC X.
   760         88  NO-CONVERSION-ERROR        VALUE ' '.
   761         88  DATE-CONVERSION-ERROR
   762                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   763         88  DATE-IS-ZERO               VALUE '1'.
   764         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   765         88  DATE-IS-INVALID            VALUE '3'.
   766         88  DATE1-GREATER-DATE2        VALUE '4'.
   767         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  15
* EL677.cbl
   768         88  DATE-INVALID-OPTION        VALUE '9'.
   769         88  INVALID-CENTURY            VALUE 'A'.
   770         88  ONLY-CENTURY               VALUE 'B'.
   771         88  ONLY-LEAP-YEAR             VALUE 'C'.
   772         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   773     12  DC-END-OF-MONTH               PIC X.
   774         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   775     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   776         88  USE-NORMAL-PROCESS         VALUE ' '.
   777         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   778         88  ADJUST-UP-100-YRS          VALUE '2'.
   779     12  FILLER                        PIC X.
   780     12  DC-CONVERSION-DATES.
   781         16  DC-BIN-DATE-1             PIC XX.
   782         16  DC-BIN-DATE-2             PIC XX.
   783         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   784         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   785                       DC-GREG-DATE-1-EDIT.
   786             20  DC-EDIT1-MONTH        PIC 99.
   787             20  SLASH1-1              PIC X.
   788             20  DC-EDIT1-DAY          PIC 99.
   789             20  SLASH1-2              PIC X.
   790             20  DC-EDIT1-YEAR         PIC 99.
   791         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   792         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   793                     DC-GREG-DATE-2-EDIT.
   794             20  DC-EDIT2-MONTH        PIC 99.
   795             20  SLASH2-1              PIC X.
   796             20  DC-EDIT2-DAY          PIC 99.
   797             20  SLASH2-2              PIC X.
   798             20  DC-EDIT2-YEAR         PIC 99.
   799         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   800         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   801                     DC-GREG-DATE-1-YMD.
   802             20  DC-YMD-YEAR           PIC 99.
   803             20  DC-YMD-MONTH          PIC 99.
   804             20  DC-YMD-DAY            PIC 99.
   805         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   806         16  DC-GREG-DATE-1-MDY-R REDEFINES
   807                      DC-GREG-DATE-1-MDY.
   808             20  DC-MDY-MONTH          PIC 99.
   809             20  DC-MDY-DAY            PIC 99.
   810             20  DC-MDY-YEAR           PIC 99.
   811         16  DC-GREG-DATE-1-ALPHA.
   812             20  DC-ALPHA-MONTH        PIC X(10).
   813             20  DC-ALPHA-DAY          PIC 99.
   814             20  FILLER                PIC XX.
   815             20  DC-ALPHA-CENTURY.
   816                 24 DC-ALPHA-CEN-N     PIC 99.
   817             20  DC-ALPHA-YEAR         PIC 99.
   818         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   819         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   820         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   821         16  DC-JULIAN-DATE            PIC 9(05).
   822         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   823                                       PIC 9(05).
   824         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   825             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  16
* EL677.cbl
   826             20  DC-JULIAN-DAYS        PIC 999.
   827         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   828         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   829         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   830     12  DATE-CONVERSION-VARIBLES.
   831         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   832         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   833             20  FILLER                PIC 9(3).
   834             20  HOLD-CEN-1-CCYY.
   835                 24  HOLD-CEN-1-CC     PIC 99.
   836                 24  HOLD-CEN-1-YY     PIC 99.
   837             20  HOLD-CEN-1-MO         PIC 99.
   838             20  HOLD-CEN-1-DA         PIC 99.
   839         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   840             20  HOLD-CEN-1-R-MO       PIC 99.
   841             20  HOLD-CEN-1-R-DA       PIC 99.
   842             20  HOLD-CEN-1-R-CCYY.
   843                 24  HOLD-CEN-1-R-CC   PIC 99.
   844                 24  HOLD-CEN-1-R-YY   PIC 99.
   845             20  FILLER                PIC 9(3).
   846         16  HOLD-CENTURY-1-X.
   847             20  FILLER                PIC X(3)  VALUE SPACES.
   848             20  HOLD-CEN-1-X-CCYY.
   849                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   850                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   851             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   852             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   853         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   854             20  HOLD-CEN-1-R-X-MO     PIC XX.
   855             20  HOLD-CEN-1-R-X-DA     PIC XX.
   856             20  HOLD-CEN-1-R-X-CCYY.
   857                 24  HOLD-CEN-1-R-X-CC PIC XX.
   858                 24  HOLD-CEN-1-R-X-YY PIC XX.
   859             20  FILLER                PIC XXX.
   860         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   861         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   862         16  DC-JULIAN-DATE-1          PIC 9(07).
   863         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   864             20  DC-JULIAN-1-CCYY.
   865                 24  DC-JULIAN-1-CC    PIC 99.
   866                 24  DC-JULIAN-1-YR    PIC 99.
   867             20  DC-JULIAN-DA-1        PIC 999.
   868         16  DC-JULIAN-DATE-2          PIC 9(07).
   869         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   870             20  DC-JULIAN-2-CCYY.
   871                 24  DC-JULIAN-2-CC    PIC 99.
   872                 24  DC-JULIAN-2-YR    PIC 99.
   873             20  DC-JULIAN-DA-2        PIC 999.
   874         16  DC-GREG-DATE-A-EDIT.
   875             20  DC-EDITA-MONTH        PIC 99.
   876             20  SLASHA-1              PIC X VALUE '/'.
   877             20  DC-EDITA-DAY          PIC 99.
   878             20  SLASHA-2              PIC X VALUE '/'.
   879             20  DC-EDITA-CCYY.
   880                 24  DC-EDITA-CENT     PIC 99.
   881                 24  DC-EDITA-YEAR     PIC 99.
   882         16  DC-GREG-DATE-B-EDIT.
   883             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  17
* EL677.cbl
   884             20  SLASHB-1              PIC X VALUE '/'.
   885             20  DC-EDITB-DAY          PIC 99.
   886             20  SLASHB-2              PIC X VALUE '/'.
   887             20  DC-EDITB-CCYY.
   888                 24  DC-EDITB-CENT     PIC 99.
   889                 24  DC-EDITB-YEAR     PIC 99.
   890         16  DC-GREG-DATE-CYMD         PIC 9(08).
   891         16  DC-GREG-DATE-CYMD-R REDEFINES
   892                              DC-GREG-DATE-CYMD.
   893             20  DC-CYMD-CEN           PIC 99.
   894             20  DC-CYMD-YEAR          PIC 99.
   895             20  DC-CYMD-MONTH         PIC 99.
   896             20  DC-CYMD-DAY           PIC 99.
   897         16  DC-GREG-DATE-MDCY         PIC 9(08).
   898         16  DC-GREG-DATE-MDCY-R REDEFINES
   899                              DC-GREG-DATE-MDCY.
   900             20  DC-MDCY-MONTH         PIC 99.
   901             20  DC-MDCY-DAY           PIC 99.
   902             20  DC-MDCY-CEN           PIC 99.
   903             20  DC-MDCY-YEAR          PIC 99.
   904    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   905        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   906    12  DC-EL310-DATE                  PIC X(21).
   907    12  FILLER                         PIC X(28).
   908*                                    COPY ELCATTR.
   909******************************************************************
   910*                                                                *
   911*                            ELCATTR.                            *
   912*                            VMOD=2.001                          *
   913*                                                                *
   914*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   915*                                                                *
   916*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   917*                                                                *
   918*                   POS 1   P=PROTECTED                          *
   919*                           U=UNPROTECTED                        *
   920*                           S=ASKIP                              *
   921*                   POS 2   A=ALPHA/NUMERIC                      *
   922*                           N=NUMERIC                            *
   923*                   POS 3   N=NORMAL                             *
   924*                           B=BRIGHT                             *
   925*                           D=DARK                               *
   926*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   927*                           OF=MODIFIED DATA TAG OFF             *
   928*                                                                *
   929*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   930******************************************************************
   931 01  ATTRIBUTE-LIST.
   932     12  AL-PABOF            PIC X       VALUE 'Y'.
   933     12  AL-PABON            PIC X       VALUE 'Z'.
   934     12  AL-PADOF            PIC X       VALUE '%'.
   935     12  AL-PADON            PIC X       VALUE '_'.
   936     12  AL-PANOF            PIC X       VALUE '-'.
   937     12  AL-PANON            PIC X       VALUE '/'.
   938     12  AL-SABOF            PIC X       VALUE '8'.
   939     12  AL-SABON            PIC X       VALUE '9'.
   940     12  AL-SADOF            PIC X       VALUE '@'.
   941     12  AL-SADON            PIC X       VALUE QUOTE.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  18
* EL677.cbl
   942     12  AL-SANOF            PIC X       VALUE '0'.
   943     12  AL-SANON            PIC X       VALUE '1'.
   944     12  AL-UABOF            PIC X       VALUE 'H'.
   945     12  AL-UABON            PIC X       VALUE 'I'.
   946     12  AL-UADOF            PIC X       VALUE '<'.
   947     12  AL-UADON            PIC X       VALUE '('.
   948     12  AL-UANOF            PIC X       VALUE ' '.
   949     12  AL-UANON            PIC X       VALUE 'A'.
   950     12  AL-UNBOF            PIC X       VALUE 'Q'.
   951     12  AL-UNBON            PIC X       VALUE 'R'.
   952     12  AL-UNDOF            PIC X       VALUE '*'.
   953     12  AL-UNDON            PIC X       VALUE ')'.
   954     12  AL-UNNOF            PIC X       VALUE '&'.
   955     12  AL-UNNON            PIC X       VALUE 'J'.
   956*                                    COPY ELCEMIB.
   957******************************************************************
   958*                                                                *
   959*                                                                *
   960*                            ELCEMIB.                            *
   961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   962*                            VMOD=2.005                          *
   963*                                                                *
   964*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   965*                                                                *
   966******************************************************************
   967 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   968     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   969     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   970     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   971     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   972     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   973     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   974     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   975     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   976     12  EMI-SWITCH1             PIC X        VALUE '1'.
   977         88  EMI-NO-ERRORS                    VALUE '1'.
   978         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   979         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   980     12  EMI-SWITCH2             PIC X        VALUE '1'.
   981         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   982     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   983         88  EMI-AREA1-EMPTY                  VALUE '1'.
   984         88  EMI-AREA1-FULL                   VALUE '2'.
   985     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   986         88  EMI-AREA2-EMPTY                  VALUE '1'.
   987         88  EMI-AREA2-FULL                   VALUE '2'.
   988     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   989         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   990         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   991         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   992         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   993         88  EMI-BYPASS-FATALS                VALUE 'X'.
   994     12  EMI-ERROR-LINES.
   995         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   996         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   997         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   998         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   999             20  EMI-ERR-CODES OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  19
* EL677.cbl
  1000                 24  EMI-ERR-NUM         PIC X(4).
  1001                 24  EMI-FILLER          PIC X.
  1002                 24  EMI-SEV             PIC X.
  1003                 24  FILLER              PIC X.
  1004             20  FILLER                  PIC X(02).
  1005     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1006         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1007             20  EMI-ERROR-NUMBER    PIC X(4).
  1008             20  EMI-FILL            PIC X.
  1009             20  EMI-SEVERITY        PIC X.
  1010             20  FILLER              PIC X.
  1011             20  EMI-ERROR-TEXT.
  1012                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1013                 24  FILLER          PIC X(55).
  1014     12  EMI-SEVERITY-SAVE           PIC X.
  1015         88  EMI-NOTE                    VALUE 'N'.
  1016         88  EMI-WARNING                 VALUE 'W'.
  1017         88  EMI-FORCABLE                VALUE 'F'.
  1018         88  EMI-FATAL                   VALUE 'X'.
  1019     12  EMI-MESSAGE-FLAG            PIC X.
  1020         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1021         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1022     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1023     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1024         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1025         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1026         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1027     12  emi-claim-no                pic x(7).
  1028     12  emi-claim-type              pic x(6).
  1029     12  FILLER                      PIC X(124)  VALUE SPACES.
  1030     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1031     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1032     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1033     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1034*                                    COPY ELCINTF.
  1035******************************************************************
  1036*                                                                *
  1037*                                                                *
  1038*                            ELCINTF.                            *
  1039*                            VMOD=2.017                          *
  1040*                                                                *
  1041*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1042*                                                                *
  1043*       LENGTH = 1024                                            *
  1044*                                                                *
  1045******************************************************************
  1046*                   C H A N G E   L O G
  1047*
  1048* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1049*-----------------------------------------------------------------
  1050*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1051* EFFECTIVE    NUMBER
  1052*-----------------------------------------------------------------
  1053* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1054******************************************************************
  1055 01  PROGRAM-INTERFACE-BLOCK.
  1056     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1057     12  PI-CALLING-PROGRAM              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  20
* EL677.cbl
  1058     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1059     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1060     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1061     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1062     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1063     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1064     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1065     12  PI-COMPANY-ID                   PIC XXX.
  1066     12  PI-COMPANY-CD                   PIC X.
  1067
  1068     12  PI-COMPANY-PASSWORD             PIC X(8).
  1069
  1070     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1071
  1072     12  PI-CONTROL-IN-PROGRESS.
  1073         16  PI-CARRIER                  PIC X.
  1074         16  PI-GROUPING                 PIC X(6).
  1075         16  PI-STATE                    PIC XX.
  1076         16  PI-ACCOUNT                  PIC X(10).
  1077         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1078                                         PIC X(10).
  1079         16  PI-CLAIM-CERT-GRP.
  1080             20  PI-CLAIM-NO             PIC X(7).
  1081             20  PI-CERT-NO.
  1082                 25  PI-CERT-PRIME       PIC X(10).
  1083                 25  PI-CERT-SFX         PIC X.
  1084             20  PI-CERT-EFF-DT          PIC XX.
  1085         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1086             20  PI-PLAN-CODE            PIC X(2).
  1087             20  PI-REVISION-NUMBER      PIC X(3).
  1088             20  PI-PLAN-EFF-DT          PIC X(2).
  1089             20  PI-PLAN-EXP-DT          PIC X(2).
  1090             20  FILLER                  PIC X(11).
  1091         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1092             20  PI-OE-REFERENCE-1.
  1093                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1094                 25  PI-OE-REF-1-SUFF    PIC XX.
  1095
  1096     12  PI-SESSION-IN-PROGRESS          PIC X.
  1097         88  CLAIM-SESSION                   VALUE '1'.
  1098         88  CREDIT-SESSION                  VALUE '2'.
  1099         88  WARRANTY-SESSION                VALUE '3'.
  1100         88  MORTGAGE-SESSION                VALUE '4'.
  1101         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1102
  1103
  1104*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1105
  1106     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1107     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1108
  1109     12  PI-CREDIT-USER                  PIC X.
  1110         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1111         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1112
  1113     12  PI-CLAIM-USER                   PIC X.
  1114         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1115         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  21
* EL677.cbl
  1116
  1117     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1118         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1119         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1120         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1121         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1122         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1123
  1124     12  PI-PROCESSOR-ID                 PIC X(4).
  1125
  1126     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1127
  1128     12  PI-MEMBER-CAPTION               PIC X(10).
  1129
  1130     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1131         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1132
  1133     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1134     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1135     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1136     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1137
  1138     12  PI-AH-OVERRIDE-L1               PIC X.
  1139     12  PI-AH-OVERRIDE-L2               PIC XX.
  1140     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1141     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1142
  1143     12  PI-NEW-SYSTEM                   PIC X(2).
  1144
  1145     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1146     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1147         88  PI-USES-PAID-TO                 VALUE '1'.
  1148     12  PI-CRDTCRD-SYSTEM.
  1149         16  PI-CRDTCRD-USER             PIC X.
  1150             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1151             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1152         16  PI-CC-MONTH-END-DT          PIC XX.
  1153     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1154
  1155     12  PI-OE-REFERENCE-2.
  1156         16  PI-OE-REF-2-PRIME           PIC X(10).
  1157         16  PI-OE-REF-2-SUFF            PIC X.
  1158
  1159     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1160
  1161     12  PI-LANGUAGE-TYPE                PIC X.
  1162             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1163             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1164             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1165
  1166     12  PI-POLICY-LINKAGE-IND           PIC X.
  1167         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1168         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1169                                                   LOW-VALUES.
  1170
  1171     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1172     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1173         88  PI-CLAIM-CREDIT                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  22
* EL677.cbl
  1174         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1175
  1176     12  PI-PROCESSOR-CSR-IND            PIC X.
  1177         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1178         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1179
  1180     12  FILLER                          PIC X(3).
  1181
  1182     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1183
  1184     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1185         PI-SYSTEM-LEVEL.
  1186
  1187         16  PI-ENTRY-CODES.
  1188             20  PI-ENTRY-CD-1           PIC X.
  1189             20  PI-ENTRY-CD-2           PIC X.
  1190
  1191         16  PI-RETURN-CODES.
  1192             20  PI-RETURN-CD-1          PIC X.
  1193             20  PI-RETURN-CD-2          PIC X.
  1194
  1195         16  PI-UPDATE-STATUS-SAVE.
  1196             20  PI-UPDATE-BY            PIC X(4).
  1197             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1198
  1199         16  PI-LOWER-CASE-LETTERS       PIC X.
  1200             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1201
  1202*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1203*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1204*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1205
  1206         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1207             88  ST-ACCNT-CNTL               VALUE ' '.
  1208             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1209             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1210             88  ACCNT-CNTL                  VALUE '3'.
  1211             88  CARR-ACCNT-CNTL             VALUE '4'.
  1212
  1213         16  PI-PROCESSOR-CAP-LIST.
  1214             20  PI-SYSTEM-CONTROLS.
  1215                24 PI-SYSTEM-DISPLAY     PIC X.
  1216                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1217                24 PI-SYSTEM-MODIFY      PIC X.
  1218                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1219             20  FILLER                  PIC XX.
  1220             20  PI-DISPLAY-CAP          PIC X.
  1221                 88  DISPLAY-CAP             VALUE 'Y'.
  1222             20  PI-MODIFY-CAP           PIC X.
  1223                 88  MODIFY-CAP              VALUE 'Y'.
  1224             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1225                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1226             20  PI-FORCE-CAP            PIC X.
  1227                 88  FORCE-CAP               VALUE 'Y'.
  1228
  1229         16  PI-PROGRAM-CONTROLS.
  1230             20  PI-PGM-PRINT-OPT        PIC X.
  1231             20  PI-PGM-FORMAT-OPT       PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  23
* EL677.cbl
  1232             20  PI-PGM-PROCESS-OPT      PIC X.
  1233             20  PI-PGM-TOTALS-OPT       PIC X.
  1234
  1235         16  PI-HELP-INTERFACE.
  1236             20  PI-LAST-ERROR-NO        PIC X(4).
  1237             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1238
  1239         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1240             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1241
  1242         16  PI-CR-CONTROL-IN-PROGRESS.
  1243             20  PI-CR-CARRIER           PIC X.
  1244             20  PI-CR-GROUPING          PIC X(6).
  1245             20  PI-CR-STATE             PIC XX.
  1246             20  PI-CR-ACCOUNT           PIC X(10).
  1247             20  PI-CR-FIN-RESP          PIC X(10).
  1248             20  PI-CR-TYPE              PIC X.
  1249
  1250         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1251
  1252         16  PI-CR-MONTH-END-DT          PIC XX.
  1253
  1254         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1255             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1256             88  PI-ZERO-CARRIER             VALUE '1'.
  1257             88  PI-ZERO-GROUPING            VALUE '2'.
  1258             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1259
  1260         16  PI-CARRIER-SECURITY         PIC X.
  1261             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1262
  1263         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1264             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1265             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1266
  1267         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1268             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1269                                         INDEXED BY PI-ACCESS-NDX
  1270                                         PIC X.
  1271
  1272         16  PI-GA-BILLING-CONTROL       PIC X.
  1273             88  PI-GA-BILLING               VALUE '1'.
  1274
  1275         16  PI-MAIL-PROCESSING          PIC X.
  1276             88  PI-MAIL-YES                 VALUE 'Y'.
  1277
  1278         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1279
  1280         16  PI-AR-SYSTEM.
  1281             20  PI-AR-PROCESSING-CNTL   PIC X.
  1282                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1283             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1284             20  PI-AR-MONTH-END-DT      PIC XX.
  1285
  1286         16  PI-MP-SYSTEM.
  1287             20  PI-MORTGAGE-USER            PIC X.
  1288                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1289                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  24
* EL677.cbl
  1290             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1291                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1292                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1293                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1294                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1295                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1296             20  PI-MP-MONTH-END-DT          PIC XX.
  1297             20  PI-MP-REFERENCE-NO.
  1298                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1299                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1300
  1301         16  PI-LABEL-CONTROL            PIC X(01).
  1302             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1303             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1304
  1305         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1306             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1307
  1308         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1309             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1310             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1311
  1312         16  FILLER                      PIC X(14).
  1313
  1314     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1315******************************************************************
  1316     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1317         16  PI-EOF-SW               PIC X.
  1318             88  PI-FILE-EOF                     VALUE 'Y'.
  1319         16  PI-PREV-MAINT           PIC X.
  1320         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1321         16  PI-ERCHEK-KEY.
  1322             20  PI-CHEK-COMP-CD     PIC X.
  1323             20  PI-CHEK-CARRIER     PIC X.
  1324             20  PI-CHEK-GROUPING    PIC X(6).
  1325             20  PI-CHEK-STATE       PIC XX.
  1326             20  PI-CHEK-ACCOUNT     PIC X(10).
  1327             20  PI-CHEK-EFF-DT      PIC XX.
  1328             20  PI-CHEK-CERT-NO     PIC X(10).
  1329             20  PI-CHEK-SUF-NO      PIC X.
  1330             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1331         16  PI-ACCOUNT-ADDRESS.
  1332             20  PI-AM-NAME          PIC X(30).
  1333             20  PI-AM-ADDRS         PIC X(30).
  1334             20  PI-AM-CITY-st.
  1335                 24  pi-am-city      PIC X(28).
  1336                 24  pi-am-st        pic xx.
  1337             20  PI-AM-ZIP-CODE.
  1338                 24  PI-AM-ZIP-PRIME PIC X(5).
  1339                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1340         16  PI-PROCESS-CERT-SW          PIC X.
  1341             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1342         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1343             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1344         16  PI-PAYTO1                   PIC X(30).
  1345         16  PI-REFERENCE                PIC X(12).
  1346         16  PI-CANC-DT                  PIC XX.
  1347         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  25
* EL677.cbl
  1348         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1349         16  PI-INSURED-NAME             PIC X(28).
  1350         16  PI-PFKEY                    PIC XXX.
  1351             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1352             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1353         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1354         16  PI-TYPE                     PIC X.
  1355         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1356         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1357         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1358         16  pi-chek-rec-cnt             pic s999 comp-3.
  1359         16  pi-am-csr                   pic x(4).
  1360         16  pi-return-to                pic x(30).
  1361         16  pi-prev-ded-comm            pic x.
  1362         16  pi-table-name               pic x(30).
  1363         16  pi-check-cashed             pic x.
  1364         16  FILLER                      PIC X(353).
  1365*                                    COPY ELCAID.
  1366******************************************************************
  1367*                                                                *
  1368*                            ELCAID.                             *
  1369*                            VMOD=2.001                          *
  1370*                                                                *
  1371*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1372*                                                                *
  1373*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1374*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1375******************************************************************
  1376
  1377 01  DFHAID.
  1378   02  DFHNULL   PIC  X  VALUE  ' '.
  1379   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1380   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1381   02  DFHPEN    PIC  X  VALUE  '='.
  1382   02  DFHOPID   PIC  X  VALUE  'W'.
  1383   02  DFHPA1    PIC  X  VALUE  '%'.
  1384   02  DFHPA2    PIC  X  VALUE  '>'.
  1385   02  DFHPA3    PIC  X  VALUE  ','.
  1386   02  DFHPF1    PIC  X  VALUE  '1'.
  1387   02  DFHPF2    PIC  X  VALUE  '2'.
  1388   02  DFHPF3    PIC  X  VALUE  '3'.
  1389   02  DFHPF4    PIC  X  VALUE  '4'.
  1390   02  DFHPF5    PIC  X  VALUE  '5'.
  1391   02  DFHPF6    PIC  X  VALUE  '6'.
  1392   02  DFHPF7    PIC  X  VALUE  '7'.
  1393   02  DFHPF8    PIC  X  VALUE  '8'.
  1394   02  DFHPF9    PIC  X  VALUE  '9'.
  1395   02  DFHPF10   PIC  X  VALUE  ':'.
  1396   02  DFHPF11   PIC  X  VALUE  '#'.
  1397   02  DFHPF12   PIC  X  VALUE  '@'.
  1398   02  DFHPF13   PIC  X  VALUE  'A'.
  1399   02  DFHPF14   PIC  X  VALUE  'B'.
  1400   02  DFHPF15   PIC  X  VALUE  'C'.
  1401   02  DFHPF16   PIC  X  VALUE  'D'.
  1402   02  DFHPF17   PIC  X  VALUE  'E'.
  1403   02  DFHPF18   PIC  X  VALUE  'F'.
  1404   02  DFHPF19   PIC  X  VALUE  'G'.
  1405   02  DFHPF20   PIC  X  VALUE  'H'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  26
* EL677.cbl
  1406   02  DFHPF21   PIC  X  VALUE  'I'.
  1407*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1408   02  DFHPF22   PIC  X  VALUE  '['.
  1409   02  DFHPF23   PIC  X  VALUE  '.'.
  1410   02  DFHPF24   PIC  X  VALUE  '<'.
  1411   02  DFHMSRE   PIC  X  VALUE  'X'.
  1412   02  DFHSTRF   PIC  X  VALUE  'h'.
  1413   02  DFHTRIG   PIC  X  VALUE  '"'.
  1414 01  FILLER    REDEFINES DFHAID.
  1415     12  FILLER                      PIC X(8).
  1416     12  PF-VALUES                   PIC X       OCCURS 24.
  1417     12  FILLER                      PIC X(3).
  1418*                                    COPY EL677S.
  1419 01  EL677AI.
  1420     05  FILLER            PIC  X(0012).
  1421*    -------------------------------
  1422     05  DATEL PIC S9(0004) COMP.
  1423     05  DATEF PIC  X(0001).
  1424     05  FILLER REDEFINES DATEF.
  1425         10  DATEA PIC  X(0001).
  1426     05  DATEI PIC  X(0008).
  1427*    -------------------------------
  1428     05  TIMEL PIC S9(0004) COMP.
  1429     05  TIMEF PIC  X(0001).
  1430     05  FILLER REDEFINES TIMEF.
  1431         10  TIMEA PIC  X(0001).
  1432     05  TIMEI PIC  X(0005).
  1433*    -------------------------------
  1434     05  MAINTL PIC S9(0004) COMP.
  1435     05  MAINTF PIC  X(0001).
  1436     05  FILLER REDEFINES MAINTF.
  1437         10  MAINTA PIC  X(0001).
  1438     05  MAINTI PIC  X(0001).
  1439*    -------------------------------
  1440     05  DMAINT1L PIC S9(0004) COMP.
  1441     05  DMAINT1F PIC  X(0001).
  1442     05  FILLER REDEFINES DMAINT1F.
  1443         10  DMAINT1A PIC  X(0001).
  1444     05  DMAINT1I PIC  X(0009).
  1445*    -------------------------------
  1446     05  DMAINT2L PIC S9(0004) COMP.
  1447     05  DMAINT2F PIC  X(0001).
  1448     05  FILLER REDEFINES DMAINT2F.
  1449         10  DMAINT2A PIC  X(0001).
  1450     05  DMAINT2I PIC  X(0029).
  1451*    -------------------------------
  1452     05  CARRIERL PIC S9(0004) COMP.
  1453     05  CARRIERF PIC  X(0001).
  1454     05  FILLER REDEFINES CARRIERF.
  1455         10  CARRIERA PIC  X(0001).
  1456     05  CARRIERI PIC  X(0001).
  1457*    -------------------------------
  1458     05  GROUPL PIC S9(0004) COMP.
  1459     05  GROUPF PIC  X(0001).
  1460     05  FILLER REDEFINES GROUPF.
  1461         10  GROUPA PIC  X(0001).
  1462     05  GROUPI PIC  X(0006).
  1463*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  27
* EL677.cbl
  1464     05  STATEL PIC S9(0004) COMP.
  1465     05  STATEF PIC  X(0001).
  1466     05  FILLER REDEFINES STATEF.
  1467         10  STATEA PIC  X(0001).
  1468     05  STATEI PIC  X(0002).
  1469*    -------------------------------
  1470     05  ACCTL PIC S9(0004) COMP.
  1471     05  ACCTF PIC  X(0001).
  1472     05  FILLER REDEFINES ACCTF.
  1473         10  ACCTA PIC  X(0001).
  1474     05  ACCTI PIC  X(0010).
  1475*    -------------------------------
  1476     05  EFFDTL PIC S9(0004) COMP.
  1477     05  EFFDTF PIC  X(0001).
  1478     05  FILLER REDEFINES EFFDTF.
  1479         10  EFFDTA PIC  X(0001).
  1480     05  EFFDTI PIC  X(0008).
  1481*    -------------------------------
  1482     05  CERTNOL PIC S9(0004) COMP.
  1483     05  CERTNOF PIC  X(0001).
  1484     05  FILLER REDEFINES CERTNOF.
  1485         10  CERTNOA PIC  X(0001).
  1486     05  CERTNOI PIC  X(0010).
  1487*    -------------------------------
  1488     05  SFXL PIC S9(0004) COMP.
  1489     05  SFXF PIC  X(0001).
  1490     05  FILLER REDEFINES SFXF.
  1491         10  SFXA PIC  X(0001).
  1492     05  SFXI PIC  X(0001).
  1493*    -------------------------------
  1494     05  SEQL PIC S9(0004) COMP.
  1495     05  SEQF PIC  X(0001).
  1496     05  FILLER REDEFINES SEQF.
  1497         10  SEQA PIC  X(0001).
  1498     05  SEQI PIC  99.
  1499*    -------------------------------
  1500     05  PAYTO1L PIC S9(0004) COMP.
  1501     05  PAYTO1F PIC  X(0001).
  1502     05  FILLER REDEFINES PAYTO1F.
  1503         10  PAYTO1A PIC  X(0001).
  1504     05  PAYTO1I PIC  X(0030).
  1505*    -------------------------------
  1506     05  CREATEDL PIC S9(0004) COMP.
  1507     05  CREATEDF PIC  X(0001).
  1508     05  FILLER REDEFINES CREATEDF.
  1509         10  CREATEDA PIC  X(0001).
  1510     05  CREATEDI PIC  X(0008).
  1511*    -------------------------------
  1512     05  CBYL PIC S9(0004) COMP.
  1513     05  CBYF PIC  X(0001).
  1514     05  FILLER REDEFINES CBYF.
  1515         10  CBYA PIC  X(0001).
  1516     05  CBYI PIC  X(0004).
  1517*    -------------------------------
  1518     05  PAYTO2L PIC S9(0004) COMP.
  1519     05  PAYTO2F PIC  X(0001).
  1520     05  FILLER REDEFINES PAYTO2F.
  1521         10  PAYTO2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  28
* EL677.cbl
  1522     05  PAYTO2I PIC  X(0030).
  1523*    -------------------------------
  1524     05  PAYEEL PIC S9(0004) COMP.
  1525     05  PAYEEF PIC  X(0001).
  1526     05  FILLER REDEFINES PAYEEF.
  1527         10  PAYEEA PIC  X(0001).
  1528     05  PAYEEI PIC  X(0006).
  1529*    -------------------------------
  1530     05  APVSTATL PIC S9(0004) COMP.
  1531     05  APVSTATF PIC  X(0001).
  1532     05  FILLER REDEFINES APVSTATF.
  1533         10  APVSTATA PIC  X(0001).
  1534     05  APVSTATI PIC  X(0009).
  1535*    -------------------------------
  1536     05  PAYAD1L PIC S9(0004) COMP.
  1537     05  PAYAD1F PIC  X(0001).
  1538     05  FILLER REDEFINES PAYAD1F.
  1539         10  PAYAD1A PIC  X(0001).
  1540     05  PAYAD1I PIC  X(0030).
  1541*    -------------------------------
  1542     05  APVDTL PIC S9(0004) COMP.
  1543     05  APVDTF PIC  X(0001).
  1544     05  FILLER REDEFINES APVDTF.
  1545         10  APVDTA PIC  X(0001).
  1546     05  APVDTI PIC  X(0008).
  1547*    -------------------------------
  1548     05  APVBYL PIC S9(0004) COMP.
  1549     05  APVBYF PIC  X(0001).
  1550     05  FILLER REDEFINES APVBYF.
  1551         10  APVBYA PIC  X(0001).
  1552     05  APVBYI PIC  X(0004).
  1553*    -------------------------------
  1554     05  PAYAD2L PIC S9(0004) COMP.
  1555     05  PAYAD2F PIC  X(0001).
  1556     05  FILLER REDEFINES PAYAD2F.
  1557         10  PAYAD2A PIC  X(0001).
  1558     05  PAYAD2I PIC  X(0030).
  1559*    -------------------------------
  1560     05  VOIDEDL PIC S9(0004) COMP.
  1561     05  VOIDEDF PIC  X(0001).
  1562     05  FILLER REDEFINES VOIDEDF.
  1563         10  VOIDEDA PIC  X(0001).
  1564     05  VOIDEDI PIC  X(0008).
  1565*    -------------------------------
  1566     05  VBYL PIC S9(0004) COMP.
  1567     05  VBYF PIC  X(0001).
  1568     05  FILLER REDEFINES VBYF.
  1569         10  VBYA PIC  X(0001).
  1570     05  VBYI PIC  X(0004).
  1571*    -------------------------------
  1572     05  PAYCTYL PIC S9(0004) COMP.
  1573     05  PAYCTYF PIC  X(0001).
  1574     05  FILLER REDEFINES PAYCTYF.
  1575         10  PAYCTYA PIC  X(0001).
  1576     05  PAYCTYI PIC  X(0028).
  1577*    -------------------------------
  1578     05  PAYSTL PIC S9(0004) COMP.
  1579     05  PAYSTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  29
* EL677.cbl
  1580     05  FILLER REDEFINES PAYSTF.
  1581         10  PAYSTA PIC  X(0001).
  1582     05  PAYSTI PIC  X(0002).
  1583*    -------------------------------
  1584     05  PRINTEDL PIC S9(0004) COMP.
  1585     05  PRINTEDF PIC  X(0001).
  1586     05  FILLER REDEFINES PRINTEDF.
  1587         10  PRINTEDA PIC  X(0001).
  1588     05  PRINTEDI PIC  X(0008).
  1589*    -------------------------------
  1590     05  PTOZIPL PIC S9(0004) COMP.
  1591     05  PTOZIPF PIC  X(0001).
  1592     05  FILLER REDEFINES PTOZIPF.
  1593         10  PTOZIPA PIC  X(0001).
  1594     05  PTOZIPI PIC  X(0009).
  1595*    -------------------------------
  1596     05  DEDCYNL PIC S9(0004) COMP.
  1597     05  DEDCYNF PIC  X(0001).
  1598     05  FILLER REDEFINES DEDCYNF.
  1599         10  DEDCYNA PIC  X(0001).
  1600     05  DEDCYNI PIC  X(0001).
  1601*    -------------------------------
  1602     05  CASHEDL PIC S9(0004) COMP.
  1603     05  CASHEDF PIC  X(0001).
  1604     05  FILLER REDEFINES CASHEDF.
  1605         10  CASHEDA PIC  X(0001).
  1606     05  CASHEDI PIC  X(0008).
  1607*    -------------------------------
  1608     05  RETTOL PIC S9(0004) COMP.
  1609     05  RETTOF PIC  X(0001).
  1610     05  FILLER REDEFINES RETTOF.
  1611         10  RETTOA PIC  X(0001).
  1612     05  RETTOI PIC  X(0030).
  1613*    -------------------------------
  1614     05  DPREML PIC S9(0004) COMP.
  1615     05  DPREMF PIC  X(0001).
  1616     05  FILLER REDEFINES DPREMF.
  1617         10  DPREMA PIC  X(0001).
  1618     05  DPREMI PIC  X(0005).
  1619*    -------------------------------
  1620     05  PREML PIC S9(0004) COMP.
  1621     05  PREMF PIC  X(0001).
  1622     05  FILLER REDEFINES PREMF.
  1623         10  PREMA PIC  X(0001).
  1624     05  PREMI PIC  X(0008).
  1625*    -------------------------------
  1626     05  DCOMML PIC S9(0004) COMP.
  1627     05  DCOMMF PIC  X(0001).
  1628     05  FILLER REDEFINES DCOMMF.
  1629         10  DCOMMA PIC  X(0001).
  1630     05  DCOMMI PIC  X(0005).
  1631*    -------------------------------
  1632     05  ISSCOMML PIC S9(0004) COMP.
  1633     05  ISSCOMMF PIC  X(0001).
  1634     05  FILLER REDEFINES ISSCOMMF.
  1635         10  ISSCOMMA PIC  X(0001).
  1636     05  ISSCOMMI PIC  X(0008).
  1637*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  30
* EL677.cbl
  1638     05  DREFL PIC S9(0004) COMP.
  1639     05  DREFF PIC  X(0001).
  1640     05  FILLER REDEFINES DREFF.
  1641         10  DREFA PIC  X(0001).
  1642     05  DREFI PIC  X(0004).
  1643*    -------------------------------
  1644     05  REFL PIC S9(0004) COMP.
  1645     05  REFF PIC  X(0001).
  1646     05  FILLER REDEFINES REFF.
  1647         10  REFA PIC  X(0001).
  1648     05  REFI PIC  X(0008).
  1649*    -------------------------------
  1650     05  DUECOMML PIC S9(0004) COMP.
  1651     05  DUECOMMF PIC  X(0001).
  1652     05  FILLER REDEFINES DUECOMMF.
  1653         10  DUECOMMA PIC  X(0001).
  1654     05  DUECOMMI PIC  X(0007).
  1655*    -------------------------------
  1656     05  UECOMML PIC S9(0004) COMP.
  1657     05  UECOMMF PIC  X(0001).
  1658     05  FILLER REDEFINES UECOMMF.
  1659         10  UECOMMA PIC  X(0001).
  1660     05  UECOMMI PIC  X(0008).
  1661*    -------------------------------
  1662     05  DPREPDL PIC S9(0004) COMP.
  1663     05  DPREPDF PIC  X(0001).
  1664     05  FILLER REDEFINES DPREPDF.
  1665         10  DPREPDA PIC  X(0001).
  1666     05  DPREPDI PIC  X(0006).
  1667*    -------------------------------
  1668     05  PREPDL PIC S9(0004) COMP.
  1669     05  PREPDF PIC  X(0001).
  1670     05  FILLER REDEFINES PREPDF.
  1671         10  PREPDA PIC  X(0001).
  1672     05  PREPDI PIC  X(0008).
  1673*    -------------------------------
  1674     05  AMOUNTL PIC S9(0004) COMP.
  1675     05  AMOUNTF PIC  X(0001).
  1676     05  FILLER REDEFINES AMOUNTF.
  1677         10  AMOUNTA PIC  X(0001).
  1678     05  AMOUNTI PIC  S9(9)V99.
  1679*    -------------------------------
  1680     05  CHECKL PIC S9(0004) COMP.
  1681     05  CHECKF PIC  X(0001).
  1682     05  FILLER REDEFINES CHECKF.
  1683         10  CHECKA PIC  X(0001).
  1684     05  CHECKI PIC  X(0007).
  1685*    -------------------------------
  1686     05  TYPEL PIC S9(0004) COMP.
  1687     05  TYPEF PIC  X(0001).
  1688     05  FILLER REDEFINES TYPEF.
  1689         10  TYPEA PIC  X(0001).
  1690     05  TYPEI PIC  X(0001).
  1691*    -------------------------------
  1692     05  REASONL PIC S9(0004) COMP.
  1693     05  REASONF PIC  X(0001).
  1694     05  FILLER REDEFINES REASONF.
  1695         10  REASONA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  31
* EL677.cbl
  1696     05  REASONI PIC  X(0025).
  1697*    -------------------------------
  1698     05  VREASONL PIC S9(0004) COMP.
  1699     05  VREASONF PIC  X(0001).
  1700     05  FILLER REDEFINES VREASONF.
  1701         10  VREASONA PIC  X(0001).
  1702     05  VREASONI PIC  X(0024).
  1703*    -------------------------------
  1704     05  STUBL PIC S9(0004) COMP.
  1705     05  STUBF PIC  X(0001).
  1706     05  FILLER REDEFINES STUBF.
  1707         10  STUBA PIC  X(0001).
  1708     05  STUBI PIC  X(0030).
  1709*    -------------------------------
  1710     05  TEXT1L PIC S9(0004) COMP.
  1711     05  TEXT1F PIC  X(0001).
  1712     05  FILLER REDEFINES TEXT1F.
  1713         10  TEXT1A PIC  X(0001).
  1714     05  TEXT1I PIC  X(0050).
  1715*    -------------------------------
  1716     05  TEXT2L PIC S9(0004) COMP.
  1717     05  TEXT2F PIC  X(0001).
  1718     05  FILLER REDEFINES TEXT2F.
  1719         10  TEXT2A PIC  X(0001).
  1720     05  TEXT2I PIC  X(0050).
  1721*    -------------------------------
  1722     05  TEXT3L PIC S9(0004) COMP.
  1723     05  TEXT3F PIC  X(0001).
  1724     05  FILLER REDEFINES TEXT3F.
  1725         10  TEXT3A PIC  X(0001).
  1726     05  TEXT3I PIC  X(0040).
  1727*    -------------------------------
  1728     05  ERRMSG1L PIC S9(0004) COMP.
  1729     05  ERRMSG1F PIC  X(0001).
  1730     05  FILLER REDEFINES ERRMSG1F.
  1731         10  ERRMSG1A PIC  X(0001).
  1732     05  ERRMSG1I PIC  X(0079).
  1733*    -------------------------------
  1734     05  ERRMSG2L PIC S9(0004) COMP.
  1735     05  ERRMSG2F PIC  X(0001).
  1736     05  FILLER REDEFINES ERRMSG2F.
  1737         10  ERRMSG2A PIC  X(0001).
  1738     05  ERRMSG2I PIC  X(0079).
  1739*    -------------------------------
  1740     05  PFENTERL PIC S9(0004) COMP.
  1741     05  PFENTERF PIC  X(0001).
  1742     05  FILLER REDEFINES PFENTERF.
  1743         10  PFENTERA PIC  X(0001).
  1744     05  PFENTERI PIC  9(2).
  1745*    -------------------------------
  1746     05  PF357L PIC S9(0004) COMP.
  1747     05  PF357F PIC  X(0001).
  1748     05  FILLER REDEFINES PF357F.
  1749         10  PF357A PIC  X(0001).
  1750     05  PF357I PIC  X(0050).
  1751*    -------------------------------
  1752     05  PF46L PIC S9(0004) COMP.
  1753     05  PF46F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  32
* EL677.cbl
  1754     05  FILLER REDEFINES PF46F.
  1755         10  PF46A PIC  X(0001).
  1756     05  PF46I PIC  X(0033).
  1757 01  EL677AO REDEFINES EL677AI.
  1758     05  FILLER            PIC  X(0012).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  DATEO PIC  X(0008).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  TIMEO PIC  99.99.
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  MAINTO PIC  X(0001).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  DMAINT1O PIC  X(0009).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  DMAINT2O PIC  X(0029).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  CARRIERO PIC  X(0001).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  GROUPO PIC  X(0006).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  STATEO PIC  X(0002).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  ACCTO PIC  X(0010).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  EFFDTO PIC  99B99B99.
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  CERTNOO PIC  X(0010).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  SFXO PIC  X(0001).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  SEQO PIC  99.
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  PAYTO1O PIC  X(0030).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  CREATEDO PIC  X(0008).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  CBYO PIC  X(0004).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  PAYTO2O PIC  X(0030).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  33
* EL677.cbl
  1812     05  PAYEEO PIC  X(0006).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  APVSTATO PIC  X(0009).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  PAYAD1O PIC  X(0030).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  APVDTO PIC  X(0008).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  APVBYO PIC  X(0004).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  PAYAD2O PIC  X(0030).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  VOIDEDO PIC  X(0008).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  VBYO PIC  X(0004).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  PAYCTYO PIC  X(0028).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  PAYSTO PIC  X(0002).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  PRINTEDO PIC  99B99B99.
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  PTOZIPO PIC  X(0009).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  DEDCYNO PIC  X(0001).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  CASHEDO PIC  X(0008).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  RETTOO PIC  X(0030).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  DPREMO PIC  X(0005).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  PREMO PIC  Z(5).99.
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  DCOMMO PIC  X(0005).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  ISSCOMMO PIC  Z(5).99.
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  DREFO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  34
* EL677.cbl
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  REFO PIC  Z(5).99.
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  DUECOMMO PIC  X(0007).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  UECOMMO PIC  Z(5).99.
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  DPREPDO PIC  X(0006).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  PREPDO PIC  Z(5).99.
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  AMOUNTO PIC  Z(7).ZZ-.
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  CHECKO PIC  X(0007).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  TYPEO PIC  X(0001).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  REASONO PIC  X(0025).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  VREASONO PIC  X(0024).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  STUBO PIC  X(0030).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  TEXT1O PIC  X(0050).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  TEXT2O PIC  X(0050).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  TEXT3O PIC  X(0040).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  ERRMSG1O PIC  X(0079).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  ERRMSG2O PIC  X(0079).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  PFENTERO PIC  99.
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  PF357O PIC  X(0050).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  PF46O PIC  X(0033).
  1927*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  35
* EL677.cbl
  1928****************************************************************
  1929*
  1930* Copyright (c) 2007 by Clerity Solutions, Inc.
  1931* All rights reserved.
  1932*
  1933****************************************************************
  1934 01  DFHEIV.
  1935   02  DFHEIV0               PIC X(35).
  1936   02  DFHEIV1               PIC X(08).
  1937   02  DFHEIV2               PIC X(08).
  1938   02  DFHEIV3               PIC X(08).
  1939   02  DFHEIV4               PIC X(06).
  1940   02  DFHEIV5               PIC X(04).
  1941   02  DFHEIV6               PIC X(04).
  1942   02  DFHEIV7               PIC X(02).
  1943   02  DFHEIV8               PIC X(02).
  1944   02  DFHEIV9               PIC X(01).
  1945   02  DFHEIV10              PIC S9(7) COMP-3.
  1946   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1947   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1948   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1949   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1950   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1951   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1952   02  DFHEIV17              PIC X(04).
  1953   02  DFHEIV18              PIC X(04).
  1954   02  DFHEIV19              PIC X(04).
  1955   02  DFHEIV20              USAGE IS POINTER.
  1956   02  DFHEIV21              USAGE IS POINTER.
  1957   02  DFHEIV22              USAGE IS POINTER.
  1958   02  DFHEIV23              USAGE IS POINTER.
  1959   02  DFHEIV24              USAGE IS POINTER.
  1960   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1961   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1962   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1963   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1964   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1965   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1966   02  FILLER                PIC X(02).
  1967   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1968   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1969   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1970   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1971   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1972 LINKAGE  SECTION.
  1973*****************************************************************
  1974*                                                               *
  1975* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1976* All rights reserved.                                          *
  1977*                                                               *
  1978*****************************************************************
  1979 01  dfheiblk.
  1980     02  eibtime          pic s9(7) comp-3.
  1981     02  eibdate          pic s9(7) comp-3.
  1982     02  eibtrnid         pic x(4).
  1983     02  eibtaskn         pic s9(7) comp-3.
  1984     02  eibtrmid         pic x(4).
  1985     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  36
* EL677.cbl
  1986     02  eibcposn         pic s9(4) comp.
  1987     02  eibcalen         pic s9(4) comp.
  1988     02  eibaid           pic x(1).
  1989     02  eibfiller1       pic x(1).
  1990     02  eibfn            pic x(2).
  1991     02  eibfiller2       pic x(2).
  1992     02  eibrcode         pic x(6).
  1993     02  eibfiller3       pic x(2).
  1994     02  eibds            pic x(8).
  1995     02  eibreqid         pic x(8).
  1996     02  eibrsrce         pic x(8).
  1997     02  eibsync          pic x(1).
  1998     02  eibfree          pic x(1).
  1999     02  eibrecv          pic x(1).
  2000     02  eibsend          pic x(1).
  2001     02  eibatt           pic x(1).
  2002     02  eibeoc           pic x(1).
  2003     02  eibfmh           pic x(1).
  2004     02  eibcompl         pic x(1).
  2005     02  eibsig           pic x(1).
  2006     02  eibconf          pic x(1).
  2007     02  eiberr           pic x(1).
  2008     02  eibrldbk         pic x(1).
  2009     02  eiberrcd         pic x(4).
  2010     02  eibsynrb         pic x(1).
  2011     02  eibnodat         pic x(1).
  2012     02  eibfiller5       pic x(2).
  2013     02  eibresp          pic 9(09) comp.
  2014     02  eibresp2         pic 9(09) comp.
  2015     02  dfheigdj         pic s9(4) comp.
  2016     02  dfheigdk         pic s9(4) comp.
  2017 01  DFHCOMMAREA                     PIC X(1024).
  2018 01  var  pic x(30).
  2019*                                    COPY ELCCNTL.
  2020******************************************************************
  2021*                                                                *
  2022*                                                                *
  2023*                            ELCCNTL.                            *
  2024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2025*                            VMOD=2.059                          *
  2026*                                                                *
  2027*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2028*                                                                *
  2029*   FILE TYPE = VSAM,KSDS                                        *
  2030*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2031*                                                                *
  2032*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2033*       ALTERNATE INDEX = NONE                                   *
  2034*                                                                *
  2035*   LOG = YES                                                    *
  2036*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2037******************************************************************
  2038*                   C H A N G E   L O G
  2039*
  2040* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2041*-----------------------------------------------------------------
  2042*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2043* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  37
* EL677.cbl
  2044*-----------------------------------------------------------------
  2045* 082503                   PEMA  ADD BENEFIT GROUP
  2046* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2047* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2048* 092705    2005050300006  PEMA  ADD SPP LEASES
  2049* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2050* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2051* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2052* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2053* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2054* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2055* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2056* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2057* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2058******************************************************************
  2059*
  2060 01  CONTROL-FILE.
  2061     12  CF-RECORD-ID                       PIC XX.
  2062         88  VALID-CF-ID                        VALUE 'CF'.
  2063
  2064     12  CF-CONTROL-PRIMARY.
  2065         16  CF-COMPANY-ID                  PIC XXX.
  2066         16  CF-RECORD-TYPE                 PIC X.
  2067             88  CF-COMPANY-MASTER              VALUE '1'.
  2068             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2069             88  CF-STATE-MASTER                VALUE '3'.
  2070             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2071             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2072             88  CF-CARRIER-MASTER              VALUE '6'.
  2073             88  CF-MORTALITY-MASTER            VALUE '7'.
  2074             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2075             88  CF-TERMINAL-MASTER             VALUE '9'.
  2076             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2077             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2078             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2079             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2080             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2081             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2082             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2083             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2084             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2085         16  CF-ACCESS-CD-GENL              PIC X(4).
  2086         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2087             20  CF-PROCESSOR               PIC X(4).
  2088         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2089             20  CF-STATE-CODE              PIC XX.
  2090             20  FILLER                     PIC XX.
  2091         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2092             20  FILLER                     PIC XX.
  2093             20  CF-HI-BEN-IN-REC           PIC XX.
  2094         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2095             20  FILLER                     PIC XXX.
  2096             20  CF-CARRIER-CNTL            PIC X.
  2097         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2098             20  FILLER                     PIC XX.
  2099             20  CF-HI-TYPE-IN-REC          PIC 99.
  2100         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2101             20  CF-CRDB-TABLE-INDICATOR    PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  38
* EL677.cbl
  2102                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2103             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2104             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2105         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2106             20  FILLER                     PIC X.
  2107             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2108         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2109             20  FILLER                     PIC XX.
  2110             20  CF-MORTGAGE-PLAN           PIC XX.
  2111         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2112
  2113     12  CF-LAST-MAINT-DT                   PIC XX.
  2114     12  CF-LAST-MAINT-BY                   PIC X(4).
  2115     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2116
  2117     12  CF-RECORD-BODY                     PIC X(728).
  2118
  2119
  2120****************************************************************
  2121*             COMPANY MASTER RECORD                            *
  2122****************************************************************
  2123
  2124     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2125         16  CF-COMPANY-ADDRESS.
  2126             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2127             20  CF-CL-IN-CARE-OF           PIC X(30).
  2128             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2129             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2130             20  CF-CL-CITY-STATE           PIC X(30).
  2131             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2132             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2133         16  CF-COMPANY-CD                  PIC X.
  2134         16  CF-COMPANY-PASSWORD            PIC X(8).
  2135         16  CF-SECURITY-OPTION             PIC X.
  2136             88  ALL-SECURITY                   VALUE '1'.
  2137             88  COMPANY-VERIFY                 VALUE '2'.
  2138             88  PROCESSOR-VERIFY               VALUE '3'.
  2139             88  NO-SECURITY                    VALUE '4'.
  2140             88  ALL-BUT-TERM                   VALUE '5'.
  2141         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2142             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2143         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2144             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2145         16  CF-INFORCE-LOCATION            PIC X.
  2146             88  CERTS-ARE-ONLINE               VALUE '1'.
  2147             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2148             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2149         16  CF-LOWER-CASE-LETTERS          PIC X.
  2150         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2151             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2152             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2153             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2154             88  CF-ACCNT-CNTL                  VALUE '3'.
  2155             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2156
  2157         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2158         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2159
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  39
* EL677.cbl
  2160         16  CF-LGX-CREDIT-USER             PIC X.
  2161             88  CO-IS-NOT-USER                 VALUE 'N'.
  2162             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2163
  2164         16 CF-CREDIT-CALC-CODES.
  2165             20  CF-CR-REM-TERM-CALC PIC X.
  2166               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2167               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2168               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2169               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2170               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2171               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2172               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2173             20  CF-CR-R78-METHOD           PIC X.
  2174               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2175               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2176
  2177         16  CF-CLAIM-CONTROL-COUNTS.
  2178             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2179                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2180
  2181             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2182                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2183
  2184             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2185                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2186
  2187             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2188                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2189
  2190         16  CF-CURRENT-MONTH-END           PIC XX.
  2191
  2192         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2193             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2194             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2195             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2196             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2197                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2198                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2199             20  CF-CO-PREM-REJECT-SW       PIC X.
  2200                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2201                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2202             20  CF-CO-REF-REJECT-SW        PIC X.
  2203                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2204                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2205
  2206         16  CF-CO-REPORTING-DT             PIC XX.
  2207         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2208         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2209           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2210           88  CF-CO-MONTH-END                  VALUE '1'.
  2211
  2212         16  CF-LGX-CLAIM-USER              PIC X.
  2213             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2214             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2215
  2216         16  CF-CREDIT-EDIT-CONTROLS.
  2217             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  40
* EL677.cbl
  2218             20  CF-MIN-AGE                 PIC 99.
  2219             20  CF-DEFAULT-AGE             PIC 99.
  2220             20  CF-MIN-TERM                PIC S999      COMP-3.
  2221             20  CF-MAX-TERM                PIC S999      COMP-3.
  2222             20  CF-DEFAULT-SEX             PIC X.
  2223             20  CF-JOINT-AGE-INPUT         PIC X.
  2224                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2225             20  CF-BIRTH-DATE-INPUT        PIC X.
  2226                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2227             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2228                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2229                 88  CF-ZERO-CARRIER            VALUE '1'.
  2230                 88  CF-ZERO-GROUPING           VALUE '2'.
  2231                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2232             20  CF-EDIT-SW                 PIC X.
  2233                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2234             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2235             20  CF-CR-PR-METHOD            PIC X.
  2236               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2237               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2238             20  FILLER                     PIC X.
  2239
  2240         16  CF-CREDIT-MISC-CONTROLS.
  2241             20  CF-REIN-TABLE-SW           PIC X.
  2242                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2243             20  CF-COMP-TABLE-SW           PIC X.
  2244                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2245             20  CF-EXPERIENCE-RETENTION-AGE
  2246                                            PIC S9        COMP-3.
  2247             20  CF-CONVERSION-DT           PIC XX.
  2248             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2249             20  CF-RUN-FREQUENCY-SW        PIC X.
  2250                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2251                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2252
  2253             20  CF-CR-CHECK-NO-CONTROL.
  2254                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2255                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2256                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2257                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2258                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2259                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2260
  2261                 24  CF-CR-CHECK-COUNT       REDEFINES
  2262                     CF-CR-CHECK-COUNTER      PIC X(4).
  2263
  2264                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2265                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2266
  2267                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2268                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2269                 24  CF-MAIL-PROCESSING       PIC X.
  2270                     88  MAIL-PROCESSING          VALUE 'Y'.
  2271
  2272         16  CF-MISC-SYSTEM-CONTROL.
  2273             20  CF-SYSTEM-C                 PIC X.
  2274                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2275             20  CF-SYSTEM-D                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  41
* EL677.cbl
  2276                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2277             20  CF-SOC-SEC-NO-SW            PIC X.
  2278                 88  SOC-SEC-NO-USED             VALUE '1'.
  2279             20  CF-MEMBER-NO-SW             PIC X.
  2280                 88  MEMBER-NO-USED              VALUE '1'.
  2281             20  CF-TAX-ID-NUMBER            PIC X(11).
  2282             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2283             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2284                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2285                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2286                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2287                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2288             20  CF-SYSTEM-E                 PIC X.
  2289                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2290
  2291         16  CF-LGX-LIFE-USER               PIC X.
  2292             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2293             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2294
  2295         16  CF-CR-MONTH-END-DT             PIC XX.
  2296
  2297         16  CF-FILE-MAINT-DATES.
  2298             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2299                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2300             20  CF-LAST-BATCH       REDEFINES
  2301                 CF-LAST-BATCH-NO               PIC X(4).
  2302             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2303             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2304             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2305             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2306             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2307             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2308             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2309             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2310             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2311             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2312
  2313         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2314         16  FILLER                         PIC X.
  2315
  2316         16  CF-ALT-MORT-CODE               PIC X(4).
  2317         16  CF-MEMBER-CAPTION              PIC X(10).
  2318
  2319         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2320             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2321             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2322             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2323             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2324             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2325
  2326         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2327
  2328         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2329         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2330         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2331         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2332
  2333         16  CF-AH-OVERRIDE-L1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  42
* EL677.cbl
  2334         16  CF-AH-OVERRIDE-L2              PIC XX.
  2335         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2336         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2337
  2338         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2339         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2340
  2341         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2342         16  CF-AR-LAST-EL860-DT            PIC XX.
  2343         16  CF-MP-MONTH-END-DT             PIC XX.
  2344
  2345         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2346         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2347             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2348
  2349         16  CF-AR-MONTH-END-DT             PIC XX.
  2350
  2351         16  CF-CRDTCRD-USER                PIC X.
  2352             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2353             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2354
  2355         16  CF-CC-MONTH-END-DT             PIC XX.
  2356
  2357         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2358
  2359         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2360             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2361             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2362             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2363         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2364         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2365         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2366         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2367             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2368             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2369         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2370         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2371         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2372             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2373         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2374
  2375         16  CF-CL-ZIP-CODE.
  2376             20  CF-CL-ZIP-PRIME.
  2377                 24  CF-CL-ZIP-1ST          PIC X.
  2378                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2379                 24  FILLER                 PIC X(4).
  2380             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2381         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2382             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2383             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2384             20  FILLER                     PIC XXX.
  2385
  2386         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2387         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2388         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2389         16  CF-CO-OPTION-START-DATE        PIC XX.
  2390         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2391           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  43
* EL677.cbl
  2392                                                      '3' '4'.
  2393           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2394           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2395           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2396           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2397           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2398           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2399
  2400         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2401
  2402         16  CF-PAYMENT-APPROVAL-LEVELS.
  2403             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2404             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2405             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2406             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2407             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2408             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2409
  2410         16  CF-END-USER-REPORTING-USER     PIC X.
  2411             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2412             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2413
  2414         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2415             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2416             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2417
  2418         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2419
  2420         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2421         16  FILLER                         PIC X.
  2422
  2423         16  CF-CREDIT-ARCHIVE-CNTL.
  2424             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2425             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2426             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2427
  2428         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2429
  2430         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2431             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2432             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2433
  2434         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2435             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2436             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2437
  2438         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2439
  2440         16  CF-CO-ACH-ID-CODE              PIC  X.
  2441             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2442             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2443             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2444         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2445         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2446         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2447         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2448         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2449         16  CF-CO-ACH-RECV-NO              PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  44
* EL677.cbl
  2450         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2451         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2452         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2453                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2454         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2455                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2456
  2457         16  CF-CO-OVER-SHORT.
  2458             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2459             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2460
  2461*         16  FILLER                         PIC X(102).
  2462         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2463             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2464             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2465
  2466         16  CF-AH-APPROVAL-DAYS.
  2467             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2468             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2469             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2470             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2471
  2472         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2473
  2474         16  CF-APPROV-LEV-5.
  2475             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2476             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2477             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2478
  2479         16  FILLER                         PIC X(68).
  2480****************************************************************
  2481*             PROCESSOR/USER RECORD                            *
  2482****************************************************************
  2483
  2484     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2485         16  CF-PROCESSOR-NAME              PIC X(30).
  2486         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2487         16  CF-PROCESSOR-TITLE             PIC X(26).
  2488         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2489                 88  MESSAGE-YES                VALUE 'Y'.
  2490                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2491
  2492*****************************************************
  2493****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2494****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2495****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2496****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2497*****************************************************
  2498
  2499         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2500             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2501             20  CF-APPLICATION-FORCE       PIC X.
  2502             20  CF-INDIVIDUAL-APP.
  2503                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2504                     28  CF-BROWSE-APP      PIC X.
  2505                     28  CF-UPDATE-APP      PIC X.
  2506
  2507         16  CF-CURRENT-TERM-ON             PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  45
* EL677.cbl
  2508         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2509             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2510             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2511             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2512             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2513             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2514             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2515             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2516         16  CF-PROCESSOR-CARRIER           PIC X.
  2517             88  NO-CARRIER-SECURITY            VALUE ' '.
  2518         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2519             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2520         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2521             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2522         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2523             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2524
  2525         16  CF-PROC-SYS-ACCESS-SW.
  2526             20  CF-PROC-CREDIT-CLAIMS-SW.
  2527                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2528                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2529                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2530                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2531             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2532                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2533                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2534             20  CF-PROC-LIFE-GNRLDGR-SW.
  2535                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2536                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2537                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2538                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2539             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2540                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2541                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2542         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2543             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2544             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2545         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2546
  2547         16  CF-APPROVAL-LEVEL                  PIC X.
  2548             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2549             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2550             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2551             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2552             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2553
  2554         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2555
  2556         16  CF-LANGUAGE-TYPE                   PIC X.
  2557             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2558             88  CF-LANG-IS-FR                      VALUE 'F'.
  2559
  2560         16  CF-CSR-IND                         PIC X.
  2561         16  FILLER                             PIC X(239).
  2562
  2563****************************************************************
  2564*             PROCESSOR/REMINDERS RECORD                       *
  2565****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  46
* EL677.cbl
  2566
  2567     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2568         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2569             20  CF-START-REMIND-DT         PIC XX.
  2570             20  CF-END-REMIND-DT           PIC XX.
  2571             20  CF-REMINDER-TEXT           PIC X(50).
  2572         16  FILLER                         PIC X(296).
  2573
  2574
  2575****************************************************************
  2576*             STATE MASTER RECORD                              *
  2577****************************************************************
  2578
  2579     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2580         16  CF-STATE-ABBREVIATION          PIC XX.
  2581         16  CF-STATE-NAME                  PIC X(25).
  2582         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2583         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2584             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2585             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2586             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2587             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2588                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2589                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2590             20  CF-ST-PREM-REJECT-SW       PIC X.
  2591                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2592                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2593             20  CF-ST-REF-REJECT-SW        PIC X.
  2594                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2595                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2596         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2597         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2598         16  CF-ST-REFUND-RULES.
  2599             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2600             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2601             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2602         16  CF-ST-FST-PMT-EXTENSION.
  2603             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2604             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2605                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2606                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2607                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2608                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2609         16  CF-ST-STATE-CALL.
  2610             20  CF-ST-CALL-UNEARNED        PIC X.
  2611             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2612             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2613         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2614             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2615             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2616         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2617         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2618         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2619         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2620         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2621         16  FILLER                         PIC X.
  2622         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2623             20  CF-ST-BENEFIT-CD           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  47
* EL677.cbl
  2624             20  CF-ST-BENEFIT-KIND         PIC X.
  2625                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2626                 88  CF-ST-AH-KIND              VALUE 'A'.
  2627             20  CF-ST-REM-TERM-CALC        PIC X.
  2628                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2629                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2630                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2631                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2632                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2633                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2634                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2635                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2636
  2637             20  CF-ST-REFUND-CALC          PIC X.
  2638                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2639                 88  ST-REFD-BY-R78             VALUE '1'.
  2640                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2641                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2642                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2643                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2644                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2645                 88  ST-REFD-UTAH               VALUE '7'.
  2646                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2647                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2648                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2649
  2650             20  CF-ST-EARNING-CALC         PIC X.
  2651                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2652                 88  ST-EARN-BY-R78             VALUE '1'.
  2653                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2654                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2655                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2656                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2657                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2658                 88  ST-EARN-MEAN               VALUE '8'.
  2659                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2660
  2661             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2662                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2663                 88  ST-OVRD-BY-R78             VALUE '1'.
  2664                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2665                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2666                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2667                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2668                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2669                 88  ST-OVRD-MEAN               VALUE '8'.
  2670                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2671             20  FILLER                     PIC X.
  2672
  2673         16  CF-ST-COMMISSION-CAPS.
  2674             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2675             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2676             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2677             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2678         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2679                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2680
  2681         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  48
* EL677.cbl
  2682
  2683         16  CF-ST-STATUTORY-INTEREST.
  2684             20  CF-ST-STAT-DATE-FROM       PIC X.
  2685                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2686                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2687             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2688             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2689             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2690             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2691             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2692
  2693         16  CF-ST-OVER-SHORT.
  2694             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2695             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2696
  2697         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2698
  2699         16  CF-ST-RT-CALC                  PIC X.
  2700
  2701         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2702         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2703         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2704         16  CF-ST-RF-LR-CALC               PIC X.
  2705         16  CF-ST-RF-LL-CALC               PIC X.
  2706         16  CF-ST-RF-LN-CALC               PIC X.
  2707         16  CF-ST-RF-AH-CALC               PIC X.
  2708         16  CF-ST-RF-CP-CALC               PIC X.
  2709*        16  FILLER                         PIC X(206).
  2710*CIDMOD         16  FILLER                         PIC X(192).
  2711         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2712             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2713         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2714         16  CF-ST-VFY-2ND-BENE             PIC X.
  2715         16  CF-ST-CAUSAL-STATE             PIC X.
  2716         16  FILLER                         PIC X(185).
  2717
  2718****************************************************************
  2719*             BENEFIT MASTER RECORD                            *
  2720****************************************************************
  2721
  2722     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2723         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2724             20  CF-BENEFIT-CODE            PIC XX.
  2725             20  CF-BENEFIT-NUMERIC  REDEFINES
  2726                 CF-BENEFIT-CODE            PIC XX.
  2727             20  CF-BENEFIT-ALPHA           PIC XXX.
  2728             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2729             20  CF-BENEFIT-COMMENT         PIC X(10).
  2730
  2731             20  CF-LF-COVERAGE-TYPE        PIC X.
  2732                 88  CF-REDUCING                VALUE 'R'.
  2733                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2734
  2735             20  CF-SPECIAL-CALC-CD         PIC X.
  2736                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2737                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2738                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2739                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  49
* EL677.cbl
  2740                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2741                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2742                 88  CF-FARM-PLAN               VALUE 'F'.
  2743                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2744                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2745                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2746                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2747                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2748                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2749                 88  CF-PRUDENTIAL              VALUE 'P'.
  2750                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2751                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2752                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2753                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2754                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2755                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2756
  2757             20  CF-JOINT-INDICATOR         PIC X.
  2758                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2759
  2760*            20  FILLER                     PIC X(12).
  2761             20  FILLER                     PIC X(11).
  2762             20  CF-BENEFIT-CATEGORY        PIC X.
  2763             20  CF-LOAN-TYPE               PIC X(8).
  2764
  2765             20  CF-CO-REM-TERM-CALC        PIC X.
  2766                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2767                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2768                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2769                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2770                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2771
  2772             20  CF-CO-EARNINGS-CALC        PIC X.
  2773                 88  CO-EARN-BY-R78             VALUE '1'.
  2774                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2775                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2776                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2777                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2778                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2779                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2780                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2781
  2782             20  CF-CO-REFUND-CALC          PIC X.
  2783                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2784                 88  CO-REFD-BY-R78             VALUE '1'.
  2785                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2786                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2787                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2788                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2789                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2790                 88  CO-REFD-MEAN               VALUE '8'.
  2791                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2792                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2793                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2794
  2795             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2796                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2797                 88  CO-OVRD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  50
* EL677.cbl
  2798                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2799                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2800                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2801                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2802                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2803                 88  CO-OVRD-MEAN               VALUE '8'.
  2804                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2805
  2806             20  CF-CO-BEN-I-G-CD           PIC X.
  2807                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2808                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2809                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2810
  2811         16  FILLER                         PIC X(304).
  2812
  2813
  2814****************************************************************
  2815*             CARRIER MASTER RECORD                            *
  2816****************************************************************
  2817
  2818     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2819         16  CF-ADDRESS-DATA.
  2820             20  CF-MAIL-TO-NAME            PIC X(30).
  2821             20  CF-IN-CARE-OF              PIC X(30).
  2822             20  CF-ADDRESS-LINE-1          PIC X(30).
  2823             20  CF-ADDRESS-LINE-2          PIC X(30).
  2824             20  CF-CITY-STATE              PIC X(30).
  2825             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2826             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2827
  2828         16  CF-CLAIM-NO-CONTROL.
  2829             20  CF-CLAIM-NO-METHOD         PIC X.
  2830                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2831                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2832                 88  CLAIM-NO-SEQ               VALUE '3'.
  2833                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2834             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2835                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2836                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2837                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2838
  2839         16  CF-CHECK-NO-CONTROL.
  2840             20  CF-CHECK-NO-METHOD         PIC X.
  2841                 88  CHECK-NO-MANUAL            VALUE '1'.
  2842                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2843                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2844                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2845             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2846                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2847
  2848         16  CF-DOMICILE-STATE              PIC XX.
  2849
  2850         16  CF-EXPENSE-CONTROLS.
  2851             20  CF-EXPENSE-METHOD          PIC X.
  2852                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2853                 88  DOLLARS-PER-PMT            VALUE '2'.
  2854                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2855                 88  DOLLARS-PER-MONTH          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  51
* EL677.cbl
  2856             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2857             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2858
  2859         16  CF-CORRESPONDENCE-CONTROL.
  2860             20  CF-LETTER-RESEND-OPT       PIC X.
  2861                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2862                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2863             20  FILLER                     PIC X(4).
  2864
  2865         16  CF-RESERVE-CONTROLS.
  2866             20  CF-MANUAL-SW               PIC X.
  2867                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2868             20  CF-FUTURE-SW               PIC X.
  2869                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2870             20  CF-PTC-SW                  PIC X.
  2871                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2872             20  CF-IBNR-SW                 PIC X.
  2873                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2874             20  CF-PTC-LF-SW               PIC X.
  2875                 88  CF-LF-PTC-USED             VALUE '1'.
  2876             20  CF-CDT-ACCESS-METHOD       PIC X.
  2877                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2878                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2879                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2880             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2881
  2882         16  CF-CLAIM-CALC-METHOD           PIC X.
  2883             88  360-PLUS-MONTHS                VALUE '1'.
  2884             88  365-PLUS-MONTHS                VALUE '2'.
  2885             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2886             88  360-DAILY                      VALUE '4'.
  2887             88  365-DAILY                      VALUE '5'.
  2888
  2889         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2890         16  FILLER                         PIC X(11).
  2891
  2892         16  CF-LIMIT-AMOUNTS.
  2893             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2894             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2895             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2896             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2897             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2898             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2899             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2900             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2901             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2902             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2903
  2904         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2905         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2906         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2907
  2908         16  CF-ZIP-CODE.
  2909             20  CF-ZIP-PRIME.
  2910                 24  CF-ZIP-1ST             PIC X.
  2911                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2912                 24  FILLER                 PIC X(4).
  2913             20  CF-ZIP-PLUS4               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  52
* EL677.cbl
  2914         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2915             20  CF-CAN-POSTAL-1            PIC XXX.
  2916             20  CF-CAN-POSTAL-2            PIC XXX.
  2917             20  FILLER                     PIC XXX.
  2918
  2919         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2920         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2921         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2922
  2923         16  CF-RATING-SWITCH               PIC X.
  2924             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2925             88  CF-NO-RATING                   VALUE 'N'.
  2926
  2927         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2928
  2929         16  CF-CARRIER-OVER-SHORT.
  2930             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2931             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2932
  2933         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2934         16  CF-SECPAY-SWITCH               PIC X.
  2935             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2936             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2937         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2938         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2939         16  FILLER                         PIC X(444).
  2940*        16  FILLER                         PIC X(452).
  2941
  2942
  2943****************************************************************
  2944*             MORTALITY MASTER RECORD                          *
  2945****************************************************************
  2946
  2947     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2948         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2949                                INDEXED BY CF-MORT-NDX.
  2950             20  CF-MORT-TABLE              PIC X(5).
  2951             20  CF-MORT-TABLE-TYPE         PIC X.
  2952                 88  CF-MORT-JOINT              VALUE 'J'.
  2953                 88  CF-MORT-SINGLE             VALUE 'S'.
  2954                 88  CF-MORT-COMBINED           VALUE 'C'.
  2955                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2956                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2957             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2958             20  CF-MORT-AGE-METHOD         PIC XX.
  2959                 88  CF-AGE-LAST                VALUE 'AL'.
  2960                 88  CF-AGE-NEAR                VALUE 'AN'.
  2961             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2962             20  CF-MORT-ADJUSTMENT-DIRECTION
  2963                                            PIC X.
  2964                 88  CF-MINUS                   VALUE '-'.
  2965                 88  CF-PLUS                    VALUE '+'.
  2966             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2967             20  CF-MORT-JOINT-CODE         PIC X.
  2968                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2969             20  CF-MORT-PC-Q               PIC X.
  2970                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2971             20  CF-MORT-TABLE-CODE         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  53
* EL677.cbl
  2972             20  CF-MORT-COMMENTS           PIC X(15).
  2973             20  FILLER                     PIC X(14).
  2974
  2975         16  FILLER                         PIC X(251).
  2976
  2977
  2978****************************************************************
  2979*             BUSSINESS TYPE MASTER RECORD                     *
  2980****************************************************************
  2981
  2982     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2983* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2984* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2985* AND RECORD 05 IS TYPES 81-99
  2986         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2987             20  CF-BUSINESS-TITLE          PIC  X(19).
  2988             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2989                                            PIC S9V9(4) COMP-3.
  2990             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2991             20  FILLER                     PIC  X.
  2992         16  FILLER                         PIC  X(248).
  2993
  2994
  2995****************************************************************
  2996*             TERMINAL MASTER RECORD                           *
  2997****************************************************************
  2998
  2999     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3000
  3001         16  CF-COMPANY-TERMINALS.
  3002             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3003                                  PIC X(4).
  3004         16  FILLER               PIC X(248).
  3005
  3006
  3007****************************************************************
  3008*             LIFE EDIT MASTER RECORD                          *
  3009****************************************************************
  3010
  3011     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3012         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3013             20  CF-LIFE-CODE-IN            PIC XX.
  3014             20  CF-LIFE-CODE-OUT           PIC XX.
  3015         16  FILLER                         PIC X(248).
  3016
  3017
  3018****************************************************************
  3019*             AH EDIT MASTER RECORD                            *
  3020****************************************************************
  3021
  3022     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3023         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3024             20  CF-AH-CODE-IN              PIC XXX.
  3025             20  CF-AH-CODE-OUT             PIC XX.
  3026         16  FILLER                         PIC X(248).
  3027
  3028
  3029****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  54
* EL677.cbl
  3030*             CREDIBILITY TABLES                               *
  3031****************************************************************
  3032
  3033     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3034         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3035                             INDEXED BY CF-CRDB-NDX.
  3036             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3037             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3038             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3039         16  FILLER                         PIC  X(332).
  3040
  3041
  3042****************************************************************
  3043*             REPORT CUSTOMIZATION RECORD                      *
  3044****************************************************************
  3045
  3046     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3047         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3048             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3049             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3050             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3051**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3052****       A T-TRANSFER.                                   ****
  3053             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3054
  3055         16  FILLER                         PIC XX.
  3056
  3057         16  CF-CARRIER-CNTL-OPT.
  3058             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3059                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3060                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3061             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3062                                            PIC X.
  3063         16  CF-GROUP-CNTL-OPT.
  3064             20  CF-GROUP-OPT-SEQ           PIC 9.
  3065                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3066                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3067             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3068                                            PIC X(6).
  3069         16  CF-STATE-CNTL-OPT.
  3070             20  CF-STATE-OPT-SEQ           PIC 9.
  3071                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3072                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3073             20  CF-STATE-SELECT OCCURS 3 TIMES
  3074                                            PIC XX.
  3075         16  CF-ACCOUNT-CNTL-OPT.
  3076             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3077                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3078                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3079             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3080                                            PIC X(10).
  3081         16  CF-BUS-TYP-CNTL-OPT.
  3082             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3083                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3084                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3085             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3086                                            PIC XX.
  3087         16  CF-LF-TYP-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  55
* EL677.cbl
  3088             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3089                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3090                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3091             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3092                                            PIC XX.
  3093         16  CF-AH-TYP-CNTL-OPT.
  3094             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3095                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3096                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3097             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3098                                            PIC XX.
  3099         16  CF-REPTCD1-CNTL-OPT.
  3100             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3101                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3102                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3103             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3104                                            PIC X(10).
  3105         16  CF-REPTCD2-CNTL-OPT.
  3106             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3107                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3108                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3109             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3110                                            PIC X(10).
  3111         16  CF-USER1-CNTL-OPT.
  3112             20  CF-USER1-OPT-SEQ           PIC 9.
  3113                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3114                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3115             20  CF-USER1-SELECT OCCURS 3 TIMES
  3116                                            PIC X(10).
  3117         16  CF-USER2-CNTL-OPT.
  3118             20  CF-USER2-OPT-SEQ           PIC 9.
  3119                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3120                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3121             20  CF-USER2-SELECT OCCURS 3 TIMES
  3122                                            PIC X(10).
  3123         16  CF-USER3-CNTL-OPT.
  3124             20  CF-USER3-OPT-SEQ           PIC 9.
  3125                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3126                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3127             20  CF-USER3-SELECT OCCURS 3 TIMES
  3128                                            PIC X(10).
  3129         16  CF-USER4-CNTL-OPT.
  3130             20  CF-USER4-OPT-SEQ           PIC 9.
  3131                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3132                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3133             20  CF-USER4-SELECT OCCURS 3 TIMES
  3134                                            PIC X(10).
  3135         16  CF-USER5-CNTL-OPT.
  3136             20  CF-USER5-OPT-SEQ           PIC 9.
  3137                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3138                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3139             20  CF-USER5-SELECT OCCURS 3 TIMES
  3140                                            PIC X(10).
  3141         16  CF-REINS-CNTL-OPT.
  3142             20  CF-REINS-OPT-SEQ           PIC 9.
  3143                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3144                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3145             20  CF-REINS-SELECT OCCURS 3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  56
* EL677.cbl
  3146                 24  CF-REINS-PRIME         PIC XXX.
  3147                 24  CF-REINS-SUB           PIC XXX.
  3148
  3149         16  CF-AGENT-CNTL-OPT.
  3150             20  CF-AGENT-OPT-SEQ           PIC 9.
  3151                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3152                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3153             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3154                                            PIC X(10).
  3155
  3156         16  FILLER                         PIC X(43).
  3157
  3158         16  CF-LOSS-RATIO-SELECT.
  3159             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3160             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3161         16  CF-ENTRY-DATE-SELECT.
  3162             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3163             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3164         16  CF-EFFECTIVE-DATE-SELECT.
  3165             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3166             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3167
  3168         16  CF-EXCEPTION-LIST-IND          PIC X.
  3169             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3170
  3171         16  FILLER                         PIC X(318).
  3172
  3173****************************************************************
  3174*                  EXCEPTION REPORTING RECORD                  *
  3175****************************************************************
  3176
  3177     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3178         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3179             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3180
  3181         16  CF-COMBINED-LIFE-AH-OPT.
  3182             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3183             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3184             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3185             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3186
  3187         16  CF-LIFE-OPT.
  3188             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3189             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3190             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3191             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3192             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3193             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3194             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3195             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3196             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3197             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3198
  3199         16  CF-AH-OPT.
  3200             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3201             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3202             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3203             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  57
* EL677.cbl
  3204             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3205             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3206             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3207             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3208             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3209             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3210
  3211         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3212             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3213             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3214             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3215
  3216         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3217
  3218         16  FILLER                         PIC X(673).
  3219
  3220
  3221****************************************************************
  3222*             MORTGAGE SYSTEM PLAN RECORD                      *
  3223****************************************************************
  3224
  3225     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3226         16  CF-PLAN-TYPE                   PIC X.
  3227             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3228             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3229             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3230         16  CF-PLAN-ABBREV                 PIC XXX.
  3231         16  CF-PLAN-DESCRIPT               PIC X(10).
  3232         16  CF-PLAN-NOTES                  PIC X(20).
  3233         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3234         16  CF-PLAN-UNDERWRITING.
  3235             20  CF-PLAN-TERM-DATA.
  3236                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3237                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3238             20  CF-PLAN-AGE-DATA.
  3239                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3240                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3241                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3242             20  CF-PLAN-BENEFIT-DATA.
  3243                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3244                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3245                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3246                                            PIC S9(7)V99  COMP-3.
  3247         16  CF-PLAN-POLICY-FORMS.
  3248             20  CF-POLICY-FORM             PIC X(12).
  3249             20  CF-MASTER-APPLICATION      PIC X(12).
  3250             20  CF-MASTER-POLICY           PIC X(12).
  3251         16  CF-PLAN-RATING.
  3252             20  CF-RATE-CODE               PIC X(5).
  3253             20  CF-SEX-RATING              PIC X.
  3254                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3255                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3256             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3257             20  CF-SUB-STD-TYPE            PIC X.
  3258                 88  CF-PCT-OF-PREM            VALUE '1'.
  3259                 88  CF-PCT-OF-BENE            VALUE '2'.
  3260         16  CF-PLAN-PREM-TOLERANCES.
  3261             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  58
* EL677.cbl
  3262             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3263         16  CF-PLAN-PYMT-TOLERANCES.
  3264             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3265             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3266         16  CF-PLAN-MISC-DATA.
  3267             20  FILLER                     PIC X.
  3268             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3269             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3270         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3271         16  CF-PLAN-IND-GRP                PIC X.
  3272             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3273                                                     '1'.
  3274             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3275                                                     '2'.
  3276         16  CF-MIB-SEARCH-SW               PIC X.
  3277             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3278             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3279             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3280             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3281         16  CF-ALPHA-SEARCH-SW             PIC X.
  3282             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3283             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3284             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3285             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3286             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3287             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3288             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3289             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3290             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3291             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3292                                                     'A' 'B' 'C'
  3293                                                     'X' 'Y' 'Z'.
  3294         16  CF-EFF-DT-RULE-SW              PIC X.
  3295             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3296             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3297             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3298             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3299             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3300         16  FILLER                         PIC X(4).
  3301         16  CF-HEALTH-QUESTIONS            PIC X.
  3302             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3303         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3304         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3305         16  CF-PLAN-SNGL-JNT               PIC X.
  3306             88  CF-COMBINED-PLAN              VALUE 'C'.
  3307             88  CF-JNT-PLAN                   VALUE 'J'.
  3308             88  CF-SNGL-PLAN                  VALUE 'S'.
  3309         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3310         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3311         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3312         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3313         16  CF-RERATE-CNTL                 PIC  X.
  3314             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3315             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3316             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3317             88  CF-AUTO-RECALC                 VALUE '4'.
  3318         16  CF-BENEFIT-TYPE                PIC  X.
  3319             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  59
* EL677.cbl
  3320             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3321         16  CF-POLICY-FEE                  PIC S999V99
  3322                                                    COMP-3.
  3323         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3324         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3325         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3326         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3327         16  FILLER                         PIC  X(32).
  3328         16  CF-TERMINATION-FORM            PIC  X(04).
  3329         16  FILLER                         PIC  X(08).
  3330         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3331                                                       COMP-3.
  3332         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3333         16  CF-ISSUE-LETTER                PIC  X(4).
  3334         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3335         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3336             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3337             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3338         16  CF-MP-REFUND-CALC              PIC X.
  3339             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3340             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3341             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3342             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3343             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3344             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3345             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3346             88  CF-MP-REFD-MEAN                VALUE '8'.
  3347         16  CF-ALT-RATE-CODE               PIC  X(5).
  3348
  3349
  3350         16  FILLER                         PIC X(498).
  3351****************************************************************
  3352*             MORTGAGE COMPANY MASTER RECORD                   *
  3353****************************************************************
  3354
  3355     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3356         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3357         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3358             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3359             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3360             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3361             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3362             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3363
  3364         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3365         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3366         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3367         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3368         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3369
  3370         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3371             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3372         16  CF-MP-RECON-USE-IND            PIC X(1).
  3373             88  CF-MP-USE-RECON             VALUE 'Y'.
  3374         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3375             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3376         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3377             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  60
* EL677.cbl
  3378             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3379         16  FILLER                         PIC X(1).
  3380         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3381             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3382         16  CF-MORTG-MIB-VERSION           PIC X.
  3383             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3384             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3385             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3386         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3387             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3388                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3389             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3390                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3391             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3392                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3393             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3394                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3395             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3396                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3397             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3398                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3399         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3400         16  FILLER                         PIC X(7).
  3401         16  CF-MORTG-DESTINATION-SYMBOL.
  3402             20  CF-MORTG-MIB-COMM          PIC X(5).
  3403             20  CF-MORTG-MIB-TERM          PIC X(5).
  3404         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3405             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3406         16  FILLER                         PIC X(03).
  3407         16  CF-MP-CHECK-NO-CONTROL.
  3408             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3409                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3410                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3411                                                ' ' LOW-VALUES.
  3412                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3413                                               VALUE '3'.
  3414         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3415         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3416         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3417             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3418                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3419             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3420                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3421             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3422                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3423             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3424                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3425             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3426                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3427             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3428                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3429         16  CF-MORTG-BILLING-AREA.
  3430             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3431                                            PIC X.
  3432         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3433         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3434         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3435         16  CF-MORTG-MIB-DEST-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  61
* EL677.cbl
  3436             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3437             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3438         16  FILLER                         PIC X.
  3439         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3440             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3441             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3442         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3443         16  FILLER                         PIC X(8).
  3444         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3445         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3446         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3447         16  CF-ACH-COMPANY-ID.
  3448             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3449                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3450                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3451                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3452             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3453         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3454             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3455         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3456             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3457             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3458         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3459         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3460         16  FILLER                         PIC X(536).
  3461
  3462****************************************************************
  3463*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3464****************************************************************
  3465
  3466     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3467         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3468             20  CF-FEMALE-HEIGHT.
  3469                 24  CF-FEMALE-FT           PIC 99.
  3470                 24  CF-FEMALE-IN           PIC 99.
  3471             20  CF-FEMALE-MIN-WT           PIC 999.
  3472             20  CF-FEMALE-MAX-WT           PIC 999.
  3473         16  FILLER                         PIC X(428).
  3474
  3475     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3476         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3477             20  CF-MALE-HEIGHT.
  3478                 24  CF-MALE-FT             PIC 99.
  3479                 24  CF-MALE-IN             PIC 99.
  3480             20  CF-MALE-MIN-WT             PIC 999.
  3481             20  CF-MALE-MAX-WT             PIC 999.
  3482         16  FILLER                         PIC X(428).
  3483******************************************************************
  3484*             AUTOMATIC ACTIVITY RECORD                          *
  3485******************************************************************
  3486     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3487         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3488             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3489             20  CF-SYS-LETTER-ID           PIC X(04).
  3490             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3491             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3492             20  CF-SYS-RESET-SW            PIC X(01).
  3493             20  CF-SYS-REPORT-DAYS         PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  62
* EL677.cbl
  3494             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3495
  3496         16  FILLER                         PIC X(50).
  3497
  3498         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3499             20  CF-USER-ACTIVE-SW          PIC X(01).
  3500             20  CF-USER-LETTER-ID          PIC X(04).
  3501             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3502             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3503             20  CF-USER-RESET-SW           PIC X(01).
  3504             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3505             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3506             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3507
  3508         16  FILLER                         PIC X(246).
  3509*                                    COPY ERCCHEK.
  3510******************************************************************
  3511*                                                                *
  3512*                                                                *
  3513*                            ERCCHEK                             *
  3514*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3515*                            VMOD=2.008                          *
  3516*                                                                *
  3517*   FILE DESCRIPTION = CHECK RECORDS                             *
  3518*                                                                *
  3519*   FILE TYPE = VSAM,KSDS                                        *
  3520*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3521*                                                                *
  3522*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3523*       ALTERNATE INDEX = NONE                                   *
  3524*                                                                *
  3525*   LOG = YES                                                    *
  3526*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3527******************************************************************
  3528*                   C H A N G E   L O G
  3529*
  3530* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3531*-----------------------------------------------------------------
  3532*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3533* EFFECTIVE    NUMBER
  3534*-----------------------------------------------------------------
  3535* 021414    2003053000001  PEMA  changes for auto chk request
  3536******************************************************************
  3537 01  CHECK-RECORDS.
  3538     12  CH-RECORD-ID                      PIC XX.
  3539         88  VALID-CH-ID                      VALUE 'CH'.
  3540
  3541     12  CH-CONTROL-PRIMARY.
  3542         16  CH-COMPANY-CD                 PIC X.
  3543         16  CH-CARRIER                    PIC X.
  3544         16  CH-GROUPING                   PIC X(6).
  3545         16  CH-STATE                      PIC XX.
  3546         16  CH-ACCOUNT                    PIC X(10).
  3547         16  CH-CERT-EFF-DT                PIC XX.
  3548         16  CH-CERT-NO.
  3549             20  CH-CERT-PRIME             PIC X(10).
  3550             20  CH-CERT-SFX               PIC X.
  3551         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  63
* EL677.cbl
  3552
  3553     12  CH-RECORDED-DT                    PIC XX.
  3554     12  CH-RECORDED-BY                    PIC X(4).
  3555     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3556
  3557     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3558     12  CH-CHECK-NO                       PIC X(7).
  3559     12  CH-REASON-FOR-CHECK               PIC X(25).
  3560     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3561     12  FILLER                            PIC X.
  3562
  3563     12  CH-PAYEE-INFO.
  3564         16  CH-PAYEE-NAME-1               PIC X(30).
  3565         16  CH-PAYEE-NAME-2               PIC X(30).
  3566         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3567         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3568         16  CH-PAYEE-CITY-ST.
  3569             20  CH-PAYEE-CITY             PIC X(28).
  3570             20  CH-PAYEE-STATE            PIC XX.
  3571         16  CH-PAYEE-ZIP-CODE.
  3572             20  CH-PAYEE-ZIP.
  3573                 24  CH-ZIP-PRI-1ST        PIC X.
  3574                     88  CH-CANADIAN-POST-CODE
  3575                                           VALUES 'A' THRU 'Z'.
  3576                 24  FILLER                PIC X(4).
  3577             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3578         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3579             20  CH-CAN-POSTAL-1           PIC XXX.
  3580             20  CH-CAN-POSTAL-2           PIC XXX.
  3581             20  FILLER                    PIC XXX.
  3582
  3583     12  CH-CHECK-STUB-TEXT.
  3584         16  CH-STUB-LINE-1                PIC X(30).
  3585         16  CH-TEXT-LINE-1                PIC X(50).
  3586         16  CH-TEXT-LINE-2                PIC X(50).
  3587         16  CH-TEXT-LINE-3                PIC X(40).
  3588     12  CH-RETURN-TO                      PIC X(30).
  3589
  3590     12  CH-COMPENSATION-CONTROL.
  3591         16  CH-COMP-CARRIER               PIC X.
  3592         16  CH-COMP-GROUPING              PIC X(6).
  3593         16  CH-COMP-FIN-RESP              PIC X(10).
  3594         16  CH-COMP-ACCOUNT               PIC X(10).
  3595
  3596     12  CH-CREDIT-SELECT-DT               PIC XX.
  3597     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3598     12  CH-PAYEE-CODE                     PIC X(6).
  3599
  3600     12  CH-VOID-DATA.
  3601         20  CH-VOID-DT                    PIC XX.
  3602         20  CH-VOID-BY                    PIC X(4).
  3603         20  CH-VOID-REASON                PIC X(25).
  3604
  3605     12  CH-APPROVAL-DATA.
  3606         20  CH-APPROVAL-DT                PIC XX.
  3607         20  CH-APPROVAL-STATUS            PIC X.
  3608             88  CH-IN-LIMBO                  VALUE ' '.
  3609             88  CH-APPROV-PENDING            VALUE 'P' '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  64
* EL677.cbl
  3610             88  CH-APPROVED                  VALUE 'A'.
  3611             88  CH-DENIED                    VALUE 'D'.
  3612         20  CH-APPROVED-BY                PIC XXXX.
  3613     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3614             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3615     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3616
  3617     12  ch-released-dt                    pic xx.
  3618     12  ch-check-cashed-dt                pic xx.
  3619     12  FILLER                            PIC X.
  3620*    12  CH-CHECK-REFERENCE                PIC X(12).
  3621     12  CH-CHECK-ORIGIN-SW                PIC X.
  3622             88  CH-REFUND-CHECK              VALUE 'R'.
  3623             88  CH-MAINT-CHECK               VALUE 'M'.
  3624
  3625     12  CH-CANC-DT                        PIC XX.
  3626     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3627     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3628
  3629     12  CH-INSURED-NAME                   PIC X(28).
  3630
  3631     12  ch-released-by                    pic x(4).
  3632     12  ch-csr                            pic x(4).
  3633     12  ch-deduct-commission              pic x.
  3634         88  ch-deduct-comm                  value 'Y'.
  3635         88  ch-do-not-deduct-comm           value 'N'.
  3636
  3637     12  FILLER                            PIC X(11).
  3638*    12  CH-LETTER-TABLE.
  3639*        16  CH-LETTERS OCCURS 3 TIMES
  3640*                       INDEXED BY CH-LT-NDX
  3641*                                          PIC X(04).
  3642
  3643     12  FILLER                            PIC X(07).
  3644
  3645*                                    COPY ERCACCT.
  3646******************************************************************
  3647*                                                                *
  3648*                                                                *
  3649*                            ERCACCT                             *
  3650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3651*                            VMOD=2.031                          *
  3652*                                                                *
  3653*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3654*                                                                *
  3655*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3656*   VSAM ACCOUNT MASTER FILES.                                   *
  3657*                                                                *
  3658*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3659*                                                                *
  3660*   FILE TYPE = VSAM,KSDS                                        *
  3661*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3662*                                                                *
  3663*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3664*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3665*                                                                *
  3666*   LOG = NO                                                     *
  3667*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  65
* EL677.cbl
  3668*                                                                *
  3669*                                                                *
  3670******************************************************************
  3671*                   C H A N G E   L O G
  3672*
  3673* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3674*-----------------------------------------------------------------
  3675*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3676* EFFECTIVE    NUMBER
  3677*-----------------------------------------------------------------
  3678* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3679* 092705    2005050300006  PEMA  ADD SPP LEASES
  3680* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3681* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3682* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3683* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3684* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3685******************************************************************
  3686
  3687 01  ACCOUNT-MASTER.
  3688     12  AM-RECORD-ID                      PIC XX.
  3689         88  VALID-AM-ID                      VALUE 'AM'.
  3690
  3691     12  AM-CONTROL-PRIMARY.
  3692         16  AM-COMPANY-CD                 PIC X.
  3693         16  AM-MSTR-CNTRL.
  3694             20  AM-CONTROL-A.
  3695                 24  AM-CARRIER            PIC X.
  3696                 24  AM-GROUPING.
  3697                     28 AM-GROUPING-PREFIX PIC XXX.
  3698                     28 AM-GROUPING-PRIME  PIC XXX.
  3699                 24  AM-STATE              PIC XX.
  3700                 24  AM-ACCOUNT.
  3701                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3702                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3703             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3704                                           PIC X(19).
  3705             20  AM-CNTRL-B.
  3706                 24  AM-EXPIRATION-DT      PIC XX.
  3707                 24  FILLER                PIC X(4).
  3708             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3709                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3710
  3711     12  AM-CONTROL-BY-VAR-GRP.
  3712         16  AM-COMPANY-CD-A1              PIC X.
  3713         16  AM-VG-CARRIER                 PIC X.
  3714         16  AM-VG-GROUPING                PIC X(6).
  3715         16  AM-VG-STATE                   PIC XX.
  3716         16  AM-VG-ACCOUNT                 PIC X(10).
  3717         16  AM-VG-DATE.
  3718             20  AM-VG-EXPIRATION-DT       PIC XX.
  3719             20  FILLER                    PIC X(4).
  3720         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3721                                           PIC 9(11)      COMP-3.
  3722     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3723         16  FILLER                        PIC X(10).
  3724         16  AM-VG-KEY3.
  3725             20  AM-VG3-ACCOUNT            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  66
* EL677.cbl
  3726             20  AM-VG3-EXP-DT             PIC XX.
  3727         16  FILLER                        PIC X(4).
  3728     12  AM-MAINT-INFORMATION.
  3729         16  AM-LAST-MAINT-DT              PIC XX.
  3730         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3731         16  AM-LAST-MAINT-USER            PIC X(4).
  3732         16  FILLER                        PIC XX.
  3733
  3734     12  AM-EFFECTIVE-DT                   PIC XX.
  3735     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3736
  3737     12  AM-PREV-DATES  COMP-3.
  3738         16  AM-PREV-EXP-DT                PIC 9(11).
  3739         16  AM-PREV-EFF-DT                PIC 9(11).
  3740
  3741     12  AM-REPORT-CODE-1                  PIC X(10).
  3742     12  AM-REPORT-CODE-2                  PIC X(10).
  3743
  3744     12  AM-CITY-CODE                      PIC X(4).
  3745     12  AM-COUNTY-PARISH                  PIC X(6).
  3746
  3747     12  AM-NAME                           PIC X(30).
  3748     12  AM-PERSON                         PIC X(30).
  3749     12  AM-ADDRS                          PIC X(30).
  3750     12  AM-CITY.
  3751         16  AM-ADDR-CITY                  PIC X(28).
  3752         16  AM-ADDR-STATE                 PIC XX.
  3753     12  AM-ZIP.
  3754         16  AM-ZIP-PRIME.
  3755             20  AM-ZIP-PRI-1ST            PIC X.
  3756                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3757             20  FILLER                    PIC X(4).
  3758         16  AM-ZIP-PLUS4                  PIC X(4).
  3759     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3760         16  AM-CAN-POSTAL-1               PIC XXX.
  3761         16  AM-CAN-POSTAL-2               PIC XXX.
  3762         16  FILLER                        PIC XXX.
  3763     12  AM-TEL-NO.
  3764         16  AM-AREA-CODE                  PIC 999.
  3765         16  AM-TEL-PRE                    PIC 999.
  3766         16  AM-TEL-NBR                    PIC 9(4).
  3767     12  AM-TEL-LOC                        PIC X.
  3768         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3769         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3770
  3771     12  AM-COMM-STRUCTURE.
  3772         16  AM-DEFN-1.
  3773             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3774                 24  AM-AGT.
  3775                     28  AM-AGT-PREFIX     PIC X(4).
  3776                     28  AM-AGT-PRIME      PIC X(6).
  3777                 24  AM-COM-TYP            PIC X.
  3778                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3779                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3780                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3781                 24  AM-RECALC-LV-INDIC    PIC X.
  3782                 24  AM-RETRO-LV-INDIC     PIC X.
  3783                 24  AM-GL-CODES           PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  67
* EL677.cbl
  3784                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3785                 24  FILLER                PIC X(01).
  3786         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3787             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3788                 24  FILLER                PIC X(11).
  3789                 24  AM-L-COMA             PIC XXX.
  3790                 24  AM-J-COMA             PIC XXX.
  3791                 24  AM-A-COMA             PIC XXX.
  3792                 24  FILLER                PIC X(6).
  3793
  3794     12  AM-COMM-CHANGE-STATUS             PIC X.
  3795         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3796
  3797     12  AM-CSR-CODE                       PIC X(4).
  3798
  3799     12  AM-BILLING-STATUS                 PIC X.
  3800         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3801         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3802     12  AM-AUTO-REFUND-SW                 PIC X.
  3803         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3804         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3805     12  AM-GPCD                           PIC 99.
  3806     12  AM-IG                             PIC X.
  3807         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3808         88  AM-HAS-GROUP                     VALUE '2'.
  3809     12  AM-STATUS                         PIC X.
  3810         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3811         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3812         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3813         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3814         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3815         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3816     12  AM-REMIT-TO                       PIC 99.
  3817     12  AM-ID-NO                          PIC X(11).
  3818
  3819     12  AM-CAL-TABLE                      PIC XX.
  3820     12  AM-LF-DEVIATION                   PIC XXX.
  3821     12  AM-AH-DEVIATION                   PIC XXX.
  3822     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3823     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3824     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3825     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3826     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3827     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3828
  3829     12  AM-USER-FIELDS.
  3830         16  AM-FLD-1                      PIC XX.
  3831         16  AM-FLD-2                      PIC XX.
  3832         16  AM-FLD-3                      PIC XX.
  3833         16  AM-FLD-4                      PIC XX.
  3834         16  AM-FLD-5                      PIC XX.
  3835
  3836     12  AM-1ST-PROD-DATE.
  3837         16  AM-1ST-PROD-YR                PIC XX.
  3838         16  AM-1ST-PROD-MO                PIC XX.
  3839         16  AM-1ST-PROD-DA                PIC XX.
  3840     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3841     12  AM-CERTS-PURGED-DATE.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  68
* EL677.cbl
  3842         16  AM-PUR-YR                     PIC XX.
  3843         16  AM-PUR-MO                     PIC XX.
  3844         16  AM-PUR-DA                     PIC XX.
  3845     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3846     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3847     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3848     12  AM-INACTIVE-DATE.
  3849         16  AM-INA-MO                     PIC 99.
  3850         16  AM-INA-DA                     PIC 99.
  3851         16  AM-INA-YR                     PIC 99.
  3852     12  AM-AR-HI-CERT-DATE                PIC XX.
  3853
  3854     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3855     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3856
  3857     12  AM-OB-PAYMENT-MODE                PIC X.
  3858         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3859         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3860         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3861         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3862
  3863     12  AM-AH-ONLY-INDICATOR              PIC X.
  3864         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3865         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3866
  3867     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3868
  3869     12  AM-OVER-SHORT.
  3870         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3871         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3872
  3873     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3874     12  AM-DCC-CLP-STATE                  PIC XX.
  3875
  3876     12  AM-RECALC-COMM                    PIC X.
  3877     12  AM-RECALC-REIN                    PIC X.
  3878
  3879     12  AM-REI-TABLE                      PIC XXX.
  3880     12  AM-REI-ET-LF                      PIC X.
  3881     12  AM-REI-ET-AH                      PIC X.
  3882     12  AM-REI-PE-LF                      PIC X.
  3883     12  AM-REI-PE-AH                      PIC X.
  3884     12  AM-REI-PRT-ST                     PIC X.
  3885     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3886     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3887     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3888     12  AM-REI-GROUP-A                    PIC X(6).
  3889     12  AM-REI-MORT                       PIC X(4).
  3890     12  AM-REI-PRT-OW                     PIC X.
  3891     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3892     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3893     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3894     12  AM-REI-GROUP-B                    PIC X(6).
  3895
  3896     12  AM-TRUST-TYPE                     PIC X(2).
  3897
  3898     12  AM-EMPLOYER-STMT-USED             PIC X.
  3899     12  AM-GROUPED-CHECKS-Y-N             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  69
* EL677.cbl
  3900
  3901     12  AM-STD-AH-TYPE                    PIC XX.
  3902     12  AM-EARN-METHODS.
  3903         16  AM-EARN-METHOD-R              PIC X.
  3904             88 AM-REF-RL-R78                 VALUE 'R'.
  3905             88 AM-REF-RL-PR                  VALUE 'P'.
  3906             88 AM-REF-RL-MEAN                VALUE 'M'.
  3907             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3908         16  AM-EARN-METHOD-L              PIC X.
  3909             88 AM-REF-LL-R78                 VALUE 'R'.
  3910             88 AM-REF-LL-PR                  VALUE 'P'.
  3911             88 AM-REF-LL-MEAN                VALUE 'M'.
  3912             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3913         16  AM-EARN-METHOD-A              PIC X.
  3914             88 AM-REF-AH-R78                 VALUE 'R'.
  3915             88 AM-REF-AH-PR                  VALUE 'P'.
  3916             88 AM-REF-AH-MEAN                VALUE 'M'.
  3917             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3918             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3919             88 AM-REF-AH-NET                 VALUE 'N'.
  3920
  3921     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3922     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3923     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3924
  3925     12  AM-RET-Y-N                        PIC X.
  3926     12  AM-RET-P-E                        PIC X.
  3927     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3928     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3929     12  AM-RET-GRP                        PIC X(6).
  3930     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3931         16  AM-POOL-PRIME                 PIC XXX.
  3932         16  AM-POOL-SUB                   PIC XXX.
  3933     12  AM-RETRO-EARNINGS.
  3934         16  AM-RET-EARN-R                 PIC X.
  3935         16  AM-RET-EARN-L                 PIC X.
  3936         16  AM-RET-EARN-A                 PIC X.
  3937     12  AM-RET-ST-TAX-USE                 PIC X.
  3938         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3939         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3940     12  AM-RETRO-BEG-EARNINGS.
  3941         16  AM-RET-BEG-EARN-R             PIC X.
  3942         16  AM-RET-BEG-EARN-L             PIC X.
  3943         16  AM-RET-BEG-EARN-A             PIC X.
  3944     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3945     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3946
  3947     12  AM-USER-SELECT-OPTIONS.
  3948         16  AM-USER-SELECT-1              PIC X(10).
  3949         16  AM-USER-SELECT-2              PIC X(10).
  3950         16  AM-USER-SELECT-3              PIC X(10).
  3951         16  AM-USER-SELECT-4              PIC X(10).
  3952         16  AM-USER-SELECT-5              PIC X(10).
  3953
  3954     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3955
  3956     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3957
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  70
* EL677.cbl
  3958     12  AM-RPT045A-SWITCH                 PIC X.
  3959         88  RPT045A-OFF                   VALUE 'N'.
  3960
  3961     12  AM-INSURANCE-LIMITS.
  3962         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3963         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3964
  3965     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3966         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3967
  3968     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3969         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3970         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3971
  3972     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3973
  3974     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3975     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3976     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3977     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3978     12  AM-DCC-UEF-STATE                  PIC XX.
  3979     12  FILLER                            PIC XXX.
  3980     12  AM-REPORT-CODE-3                  PIC X(10).
  3981*    12  FILLER                            PIC X(22).
  3982
  3983     12  AM-RESERVE-DATE.
  3984         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3985         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3986         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3987
  3988     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3989     12  AM-NOTIFICATION-TYPES.
  3990         16  AM-NOTIF-OF-LETTERS           PIC X.
  3991         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3992         16  AM-NOTIF-OF-REPORTS           PIC X.
  3993         16  AM-NOTIF-OF-STATUS            PIC X.
  3994
  3995     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3996         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3997         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3998         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3999         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4000
  4001     12  AM-BENEFIT-CONTROLS.
  4002         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4003             20  AM-BENEFIT-CODE           PIC XX.
  4004             20  AM-BENEFIT-TYPE           PIC X.
  4005             20  AM-BENEFIT-REVISION       PIC XXX.
  4006             20  AM-BENEFIT-REM-TERM       PIC X.
  4007             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4008             20  FILLER                    PIC XX.
  4009         16  FILLER                        PIC X(80).
  4010
  4011     12  AM-TRANSFER-DATA.
  4012         16  AM-TRANSFERRED-FROM.
  4013             20  AM-TRNFROM-CARRIER        PIC X.
  4014             20  AM-TRNFROM-GROUPING.
  4015                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  71
* EL677.cbl
  4016                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4017             20  AM-TRNFROM-STATE          PIC XX.
  4018             20  AM-TRNFROM-ACCOUNT.
  4019                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4020                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4021             20  AM-TRNFROM-DTE            PIC XX.
  4022         16  AM-TRANSFERRED-TO.
  4023             20  AM-TRNTO-CARRIER          PIC X.
  4024             20  AM-TRNTO-GROUPING.
  4025                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4026                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4027             20  AM-TRNTO-STATE            PIC XX.
  4028             20  AM-TRNTO-ACCOUNT.
  4029                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4030                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4031             20  AM-TRNTO-DTE              PIC XX.
  4032         16  FILLER                        PIC X(10).
  4033
  4034     12  AM-SAVED-REMIT-TO                 PIC 99.
  4035
  4036     12  AM-COMM-STRUCTURE-SAVED.
  4037         16  AM-DEFN-1-SAVED.
  4038             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4039                 24  AM-AGT-SV             PIC X(10).
  4040                 24  AM-COM-TYP-SV         PIC X.
  4041                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4042                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4043                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4044                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4045                 24  FILLER                PIC X.
  4046                 24  AM-GL-CODES-SV        PIC X.
  4047                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4048                 24  FILLER                PIC X.
  4049         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4050             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4051                 24  FILLER                PIC X(11).
  4052                 24  AM-L-COMA-SV          PIC XXX.
  4053                 24  AM-J-COMA-SV          PIC XXX.
  4054                 24  AM-A-COMA-SV          PIC XXX.
  4055                 24  FILLER                PIC X(6).
  4056
  4057     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4058         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4059            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4060            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4061            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4062
  4063     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4064     12  FILLER                            PIC X(120).
  4065
  4066     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4067         16  AM-CONTROL-NAME               PIC X(30).
  4068         16  AM-EXECUTIVE-ONE.
  4069             20  AM-EXEC1-NAME             PIC X(15).
  4070             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4071                                                          COMP-3.
  4072             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4073                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  72
* EL677.cbl
  4074         16  AM-EXECUTIVE-TWO.
  4075             20  AM-EXEC2-NAME             PIC X(15).
  4076             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4077                                                          COMP-3.
  4078             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4079                                                          COMP-3.
  4080
  4081     12  AM-RETRO-ADDITIONAL-DATA.
  4082         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4083         16  AM-RETRO-PREM-P-E             PIC X.
  4084         16  AM-RETRO-CLMS-P-I             PIC X.
  4085         16  AM-RETRO-RET-BRACKET-LF.
  4086             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4087                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4088                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4089             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4090                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4091                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4092             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4093                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4094                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4095         16  AM-RETRO-RET-BRACKET-AH.
  4096             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4097                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4098                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4099                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4100             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4101                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4102                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4103             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4104                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4105                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4106
  4107     12  AM-COMMENTS.
  4108         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4109
  4110     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4111         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4112         16  AM-FLI-BILLING-CODE           PIC X.
  4113         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4114         16  AM-FLI-UNITED-IDENT           PIC X.
  4115         16  AM-FLI-INTEREST-LOST-DATA.
  4116             20  AM-FLI-BANK-NO            PIC X(5).
  4117             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4118             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4119             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4120         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4121             20  AM-FLI-AGT                PIC X(9).
  4122             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4123             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4124         16  FILLER                        PIC X(102).
  4125
  4126     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4127         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4128             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4129             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4130             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4131             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  73
* EL677.cbl
  4132             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4133         16  FILLER                          PIC X(10).
  4134******************************************************************
  4135*                                    COPY ERCCOMP.
  4136******************************************************************
  4137*                                                                *
  4138*                                                                *
  4139*                            ERCCOMP                             *
  4140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4141*                            VMOD=2.019                          *
  4142*                                                                *
  4143*   ONLINE CREDIT SYSTEM                                         *
  4144*                                                                *
  4145*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4146*                                                                *
  4147*   FILE TYPE = VSAM,KSDS                                        *
  4148*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4149*                                                                *
  4150*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4151*       ALTERNATE PATH = NONE                                    *
  4152*                                                                *
  4153*   LOG = NO                                                     *
  4154*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4155*                                                                *
  4156******************************************************************
  4157*                   C H A N G E   L O G
  4158*
  4159* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4160*-----------------------------------------------------------------
  4161*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4162* EFFECTIVE    NUMBER
  4163*-----------------------------------------------------------------
  4164* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4165* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4166* 092205    2005050300006  PEMA  ADD LEASE FEE
  4167* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4168* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4169* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4170* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4171* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4172* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4173******************************************************************
  4174
  4175 01  COMPENSATION-MASTER.
  4176     12  CO-RECORD-ID                          PIC XX.
  4177         88  VALID-CO-ID                          VALUE 'CO'.
  4178
  4179     12  CO-CONTROL-PRIMARY.
  4180         16  CO-COMPANY-CD                     PIC X.
  4181         16  CO-CONTROL.
  4182             20  CO-CTL-1.
  4183                 24  CO-CARR-GROUP.
  4184                     28  CO-CARRIER            PIC X.
  4185                     28  CO-GROUPING.
  4186                         32  CO-GROUP-PREFIX   PIC XXX.
  4187                         32  CO-GROUP-PRIME    PIC XXX.
  4188                 24  CO-RESP-NO.
  4189                     28  CO-RESP-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  74
* EL677.cbl
  4190                     28  CO-RESP-PRIME         PIC X(6).
  4191             20  CO-CTL-2.
  4192                 24  CO-ACCOUNT.
  4193                     28  CO-ACCT-PREFIX        PIC X(4).
  4194                     28  CO-ACCT-PRIME         PIC X(6).
  4195         16  CO-TYPE                           PIC X.
  4196             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4197             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4198             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4199
  4200     12  CO-MAINT-INFORMATION.
  4201         16  CO-LAST-MAINT-DT                  PIC XX.
  4202         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4203         16  CO-LAST-MAINT-USER                PIC X(4).
  4204     12  FILLER                                PIC XX.
  4205     12  CO-STMT-TYPE                          PIC XXX.
  4206     12  CO-COMP-TYPE                          PIC X.
  4207         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4208     12  CO-STMT-OWNER                         PIC X(4).
  4209     12  CO-BALANCE-CONTROL                    PIC X.
  4210         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4211         88  CO-NO-BALANCE                        VALUE 'N'.
  4212
  4213     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4214         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4215         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4216         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4217
  4218     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4219         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4220         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4221
  4222     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4223     12  CO-GA-DIRECT-DEP                      PIC X.
  4224     12  CO-FUTURE-SPACE                       PIC X.
  4225         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4226
  4227     12  CO-ACCT-NAME                          PIC X(30).
  4228     12  CO-MAIL-NAME                          PIC X(30).
  4229     12  CO-ADDR-1                             PIC X(30).
  4230     12  CO-ADDR-2                             PIC X(30).
  4231     12  CO-ADDR-3.
  4232         16  CO-ADDR-CITY                      PIC X(27).
  4233         16  CO-ADDR-STATE                     PIC XX.
  4234     12  CO-CSO-1099                           PIC X.
  4235     12  CO-ZIP.
  4236         16  CO-ZIP-PRIME.
  4237             20  CO-ZIP-PRI-1ST                PIC X.
  4238                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4239             20  FILLER                        PIC X(4).
  4240         16  CO-ZIP-PLUS4                      PIC X(4).
  4241     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4242         16  CO-CAN-POSTAL-1                   PIC XXX.
  4243         16  CO-CAN-POSTAL-2                   PIC XXX.
  4244         16  FILLER                            PIC XXX.
  4245     12  CO-SOC-SEC                            PIC X(13).
  4246     12  CO-TELEPHONE.
  4247         16  CO-AREA-CODE                      PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  75
* EL677.cbl
  4248         16  CO-PREFIX                         PIC XXX.
  4249         16  CO-PHONE                          PIC X(4).
  4250
  4251     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4252
  4253     12  CO-AR-BAL-LEVEL                       PIC X.
  4254         88  CO-AR-REF-LVL                        VALUE '1'.
  4255         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4256         88  CO-AR-BILL-LVL                       VALUE '2'.
  4257         88  CO-AR-AGT-LVL                        VALUE '3'.
  4258         88  CO-AR-FR-LVL                         VALUE '4'.
  4259
  4260     12  CO-AR-NORMAL-PRINT                    PIC X.
  4261         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4262         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4263
  4264     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4265
  4266     12  CO-AR-REPORTING                       PIC X.
  4267         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4268         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4269
  4270     12  CO-AR-PULL-CHECK                      PIC X.
  4271         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4272         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4273
  4274     12  CO-AR-BALANCE-PRINT                   PIC X.
  4275         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4276
  4277     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4278         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4279         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4280         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4281
  4282     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4283
  4284     12  CO-USER-CODE                          PIC X.
  4285     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4286
  4287******************************************************************
  4288*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4289*    THE LAST MONTH END RUN.
  4290******************************************************************
  4291
  4292     12  CO-LAST-ACTIVITY-DATE.
  4293         16  CO-ACT-YEAR                       PIC 99.
  4294         16  CO-ACT-MONTH                      PIC 99.
  4295         16  CO-ACT-DAY                        PIC 99.
  4296
  4297     12  CO-LAST-STMT-DT.
  4298         16  CO-LAST-STMT-YEAR                 PIC 99.
  4299         16  CO-LAST-STMT-MONTH                PIC 99.
  4300         16  CO-LAST-STMT-DAY                  PIC 99.
  4301
  4302     12  CO-MO-END-TOTALS.
  4303         16  CO-MONTHLY-TOTALS.
  4304             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4305             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  76
* EL677.cbl
  4306             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4307             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4308             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4309
  4310         16  CO-AGING-TOTALS.
  4311             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4312             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4313             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4314             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4315
  4316         16  CO-YTD-TOTALS.
  4317             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4318             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4319
  4320         16  CO-OVER-UNDER-TOTALS.
  4321             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4322             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4323
  4324     12  CO-MISCELLANEOUS-TOTALS.
  4325         16  CO-FICA-TOTALS.
  4326             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4327             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4328
  4329         16  CO-CLAIM-TOTALS.
  4330             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4331             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4332
  4333******************************************************************
  4334*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4335*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4336******************************************************************
  4337
  4338     12  CO-CURRENT-TOTALS.
  4339         16  CO-CURRENT-LAST-STMT-DT.
  4340             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4341             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4342             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4343
  4344         16  CO-CURRENT-MONTHLY-TOTALS.
  4345             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4346             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4347             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4348             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4349             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4350
  4351         16  CO-CURRENT-AGING-TOTALS.
  4352             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4353             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4354             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4355             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4356
  4357         16  CO-CURRENT-YTD-TOTALS.
  4358             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4359             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4360
  4361     12  CO-PAID-COMM-TOTALS.
  4362         16  CO-YTD-PAID-COMMS.
  4363             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  77
* EL677.cbl
  4364             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4365
  4366     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4367         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4368         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4369
  4370     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4371         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4372         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4373         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4374         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4375         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4376         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4377         88  CO-FINAL-LETTER                  VALUE 'F'.
  4378         88  CO-RECONCILING                   VALUE 'R'.
  4379         88  CO-PHONE-CALL                    VALUE 'P'.
  4380         88  CO-LEGAL                         VALUE 'L'.
  4381         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4382         88  CO-WRITE-OFF                     VALUE 'W'.
  4383         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4384
  4385     12  CO-CSR-CODE                       PIC X(4).
  4386
  4387     12  CO-GA-STATUS-INFO.
  4388         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4389         16  CO-GA-TERMINATION-DT          PIC XX.
  4390         16  CO-GA-STATUS-CODE             PIC X.
  4391             88  CO-GA-ACTIVE                 VALUE 'A'.
  4392             88  CO-GA-INACTIVE               VALUE 'I'.
  4393             88  CO-GA-PENDING                VALUE 'P'.
  4394         16  CO-GA-COMMENTS.
  4395             20  CO-GA-COMMENT-1           PIC X(40).
  4396             20  CO-GA-COMMENT-2           PIC X(40).
  4397             20  CO-GA-COMMENT-3           PIC X(40).
  4398             20  CO-GA-COMMENT-4           PIC X(40).
  4399
  4400     12  CO-RPTCD2                         PIC X(10).
  4401     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4402         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4403         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4404
  4405     12  CO-TYPE-AGENT                     PIC X(01).
  4406         88  CO-CORPORATION                   VALUE 'C'.
  4407         88  CO-PARTNERSHIP                   VALUE 'P'.
  4408         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4409         88  CO-TRUST                         VALUE 'T'.
  4410         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4411
  4412     12  CO-FAXNO.
  4413         16  CO-FAX-AREA-CODE                  PIC XXX.
  4414         16  CO-FAX-PREFIX                     PIC XXX.
  4415         16  CO-FAX-PHONE                      PIC X(4).
  4416
  4417     12  CO-BANK-INFORMATION.
  4418         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4419         16  CO-BANK-TRANSIT-NON REDEFINES
  4420             CO-BANK-TRANSIT-NO                PIC 9(8).
  4421
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  78
* EL677.cbl
  4422         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4423     12  CO-MISC-DEDUCT-INFO REDEFINES
  4424                  CO-BANK-INFORMATION.
  4425         16  CO-MD-GL-ACCT                     PIC X(10).
  4426         16  CO-MD-DIV                         PIC XX.
  4427         16  CO-MD-CENTER                      PIC X(4).
  4428         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4429         16  CO-CREATE-AP-CHECK                PIC X.
  4430         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4431         16  FILLER                            PIC XXX.
  4432     12  CO-ACH-STATUS                         PIC X.
  4433         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4434         88  CO-ACH-PENDING                        VALUE 'P'.
  4435
  4436     12  CO-BILL-SW                            PIC X.
  4437     12  CO-CONTROL-NAME                       PIC X(30).
  4438     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4439     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4440     12  CO-CLP-STATE                          PIC XX.
  4441     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4442     12  CO-SPP-REFUND-EDIT                    PIC X.
  4443
  4444******************************************************************
  4445*                                    COPY ELCCERT.
  4446******************************************************************
  4447*                                                                *
  4448*                            ELCCERT.                            *
  4449*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4450*                            VMOD=2.013                          *
  4451*                                                                *
  4452*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4453*                                                                *
  4454*   FILE TYPE = VSAM,KSDS                                        *
  4455*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4456*                                                                *
  4457*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4458*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4459*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4460*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4461*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4462*                                                                *
  4463*   LOG = YES                                                    *
  4464*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4465******************************************************************
  4466*                   C H A N G E   L O G
  4467*
  4468* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4469*-----------------------------------------------------------------
  4470*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4471* EFFECTIVE    NUMBER
  4472*-----------------------------------------------------------------
  4473* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4474* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4475* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4476* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4477* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4478* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4479* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  79
* EL677.cbl
  4480* 032612  CR2011110200001  PEMA  AHL CHANGES
  4481******************************************************************
  4482
  4483 01  CERTIFICATE-MASTER.
  4484     12  CM-RECORD-ID                      PIC XX.
  4485         88  VALID-CM-ID                      VALUE 'CM'.
  4486
  4487     12  CM-CONTROL-PRIMARY.
  4488         16  CM-COMPANY-CD                 PIC X.
  4489         16  CM-CARRIER                    PIC X.
  4490         16  CM-GROUPING.
  4491             20  CM-GROUPING-PREFIX        PIC X(3).
  4492             20  CM-GROUPING-PRIME         PIC X(3).
  4493         16  CM-STATE                      PIC XX.
  4494         16  CM-ACCOUNT.
  4495             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4496             20  CM-ACCOUNT-PRIME          PIC X(6).
  4497         16  CM-CERT-EFF-DT                PIC XX.
  4498         16  CM-CERT-NO.
  4499             20  CM-CERT-PRIME             PIC X(10).
  4500             20  CM-CERT-SFX               PIC X.
  4501
  4502     12  CM-CONTROL-BY-NAME.
  4503         16  CM-COMPANY-CD-A1              PIC X.
  4504         16  CM-INSURED-LAST-NAME          PIC X(15).
  4505         16  CM-INSURED-INITIALS.
  4506             20  CM-INSURED-INITIAL1       PIC X.
  4507             20  CM-INSURED-INITIAL2       PIC X.
  4508
  4509     12  CM-CONTROL-BY-SSN.
  4510         16  CM-COMPANY-CD-A2              PIC X.
  4511         16  CM-SOC-SEC-NO.
  4512             20  CM-SSN-STATE              PIC XX.
  4513             20  CM-SSN-ACCOUNT            PIC X(6).
  4514             20  CM-SSN-LN3.
  4515                 25  CM-INSURED-INITIALS-A2.
  4516                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4517                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4518                 25 CM-PART-LAST-NAME-A2         PIC X.
  4519
  4520     12  CM-CONTROL-BY-CERT-NO.
  4521         16  CM-COMPANY-CD-A4              PIC X.
  4522         16  CM-CERT-NO-A4                 PIC X(11).
  4523
  4524     12  CM-CONTROL-BY-MEMB.
  4525         16  CM-COMPANY-CD-A5              PIC X.
  4526         16  CM-MEMBER-NO.
  4527             20  CM-MEMB-STATE             PIC XX.
  4528             20  CM-MEMB-ACCOUNT           PIC X(6).
  4529             20  CM-MEMB-LN4.
  4530                 25  CM-INSURED-INITIALS-A5.
  4531                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4532                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4533                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4534
  4535     12  CM-INSURED-PROFILE-DATA.
  4536         16  CM-INSURED-FIRST-NAME.
  4537             20  CM-INSURED-1ST-INIT       PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  80
* EL677.cbl
  4538             20  FILLER                    PIC X(9).
  4539         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4540         16  CM-INSURED-SEX                PIC X.
  4541             88  CM-SEX-MALE                  VALUE 'M'.
  4542             88  CM-SEX-FEMAL                 VALUE 'F'.
  4543         16  CM-INSURED-JOINT-AGE          PIC 99.
  4544         16  CM-JOINT-INSURED-NAME.
  4545             20  CM-JT-LAST-NAME           PIC X(15).
  4546             20  CM-JT-FIRST-NAME.
  4547                 24  CM-JT-1ST-INIT        PIC X.
  4548                 24  FILLER                PIC X(9).
  4549             20  CM-JT-INITIAL             PIC X.
  4550
  4551     12  CM-LIFE-DATA.
  4552         16  CM-LF-BENEFIT-CD              PIC XX.
  4553         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4554         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4555         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4556         16  CM-LF-DEV-CODE                PIC XXX.
  4557         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4558         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4559         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4560         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4561         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4562         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4563         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4564         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4565         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4566         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4567         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4568         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4569         16  FILLER                        PIC XX.
  4570
  4571     12  CM-AH-DATA.
  4572         16  CM-AH-BENEFIT-CD              PIC XX.
  4573         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4574         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4575         16  CM-AH-DEV-CODE                PIC XXX.
  4576         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4577         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4578         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4579         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4580         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4581         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4582         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4583         16  CM-AH-PAID-THRU-DT            PIC XX.
  4584             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4585         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4586         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4587         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4588         16  FILLER                        PIC X.
  4589
  4590     12  CM-LOAN-INFORMATION.
  4591         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4592         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4593                                           PIC S9(5)V99  COMP-3.
  4594         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4595         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  81
* EL677.cbl
  4596         16  CM-PAY-FREQUENCY              PIC S99.
  4597         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4598         16  CM-RATE-CLASS                 PIC XX.
  4599         16  CM-BENEFICIARY                PIC X(25).
  4600         16  CM-POLICY-FORM-NO             PIC X(12).
  4601         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4602         16  CM-LAST-ADD-ON-DT             PIC XX.
  4603         16  CM-DEDUCTIBLE-AMOUNTS.
  4604             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4605             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4606         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4607             20  CM-RESIDENT-STATE         PIC XX.
  4608             20  CM-RATE-CODE              PIC X(4).
  4609             20  FILLER                    PIC XX.
  4610         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4611             20  CM-LOAN-OFFICER           PIC X(5).
  4612             20  FILLER                    PIC XXX.
  4613         16  CM-CSR-CODE                   PIC XXX.
  4614         16  CM-UNDERWRITING-CODE          PIC X.
  4615             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4616         16  CM-POST-CARD-IND              PIC X.
  4617         16  CM-NH-INTERFACE-SW            PIC X.
  4618         16  CM-PREMIUM-TYPE               PIC X.
  4619             88  CM-SING-PRM                  VALUE '1'.
  4620             88  CM-O-B-COVERAGE              VALUE '2'.
  4621             88  CM-OPEN-END                  VALUE '3'.
  4622         16  CM-IND-GRP-TYPE               PIC X.
  4623             88  CM-INDIVIDUAL                VALUE 'I'.
  4624             88  CM-GROUP                     VALUE 'G'.
  4625         16  CM-SKIP-CODE                  PIC X.
  4626             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4627             88  SKIP-JULY                    VALUE '1'.
  4628             88  SKIP-AUGUST                  VALUE '2'.
  4629             88  SKIP-SEPTEMBER               VALUE '3'.
  4630             88  SKIP-JULY-AUG                VALUE '4'.
  4631             88  SKIP-AUG-SEPT                VALUE '5'.
  4632             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4633             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4634             88  SKIP-JUNE                    VALUE '8'.
  4635             88  SKIP-JUNE-JULY               VALUE '9'.
  4636             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4637             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4638         16  CM-PAYMENT-MODE               PIC X.
  4639             88  PAY-MONTHLY                  VALUE SPACE.
  4640             88  PAY-WEEKLY                   VALUE '1'.
  4641             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4642             88  PAY-BI-WEEKLY                VALUE '3'.
  4643             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4644         16  CM-LOAN-NUMBER                PIC X(8).
  4645         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4646         16  CM-OLD-LOF                    PIC XXX.
  4647*        16  CM-LOAN-OFFICER               PIC XXX.
  4648         16  CM-REIN-TABLE                 PIC XXX.
  4649         16  CM-SPECIAL-REIN-CODE          PIC X.
  4650         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4651         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4652         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4653
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  82
* EL677.cbl
  4654     12  CM-STATUS-DATA.
  4655         16  CM-ENTRY-STATUS               PIC X.
  4656         16  CM-ENTRY-DT                   PIC XX.
  4657
  4658         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4659         16  CM-LF-CANCEL-DT               PIC XX.
  4660         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4661
  4662         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4663         16  CM-LF-DEATH-DT                PIC XX.
  4664         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4665
  4666         16  CM-LF-CURRENT-STATUS          PIC X.
  4667             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4668                                                'M' '4' '5' '9'.
  4669             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4670             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4671             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4672             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4673             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4674             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4675             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4676             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4677             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4678             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4679             88  CM-LF-DECLINED               VALUE 'D'.
  4680             88  CM-LF-VOIDED                 VALUE 'V'.
  4681
  4682         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4683         16  CM-AH-CANCEL-DT               PIC XX.
  4684         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4685
  4686         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4687         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4688         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4689
  4690         16  CM-AH-CURRENT-STATUS          PIC X.
  4691             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4692                                                'M' '4' '5' '9'.
  4693             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4694             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4695             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4696             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4697             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4698             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4699             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4700             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4701             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4702             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4703             88  CM-AH-DECLINED               VALUE 'D'.
  4704             88  CM-AH-VOIDED                 VALUE 'V'.
  4705
  4706         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4707             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4708             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4709             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4710         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4711
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  83
* EL677.cbl
  4712         16  CM-ENTRY-BATCH                PIC X(6).
  4713         16  CM-LF-EXIT-BATCH              PIC X(6).
  4714         16  CM-AH-EXIT-BATCH              PIC X(6).
  4715         16  CM-LAST-MONTH-END             PIC XX.
  4716
  4717     12  CM-NOTE-SW                        PIC X.
  4718         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4719         88  CERT-NOTES-PRESENT               VALUE '1'.
  4720         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4721         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4722         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4723         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4724         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4725         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4726     12  CM-COMP-EXCP-SW                   PIC X.
  4727         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4728         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4729     12  CM-INSURED-ADDRESS-SW             PIC X.
  4730         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4731         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4732
  4733*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4734     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4735     12  FILLER                            PIC X.
  4736
  4737*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4738     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4739     12  FILLER                            PIC X.
  4740*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4741     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4742
  4743     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4744         88  CERT-ADDED-BATCH                 VALUE ' '.
  4745         88  CERT-ADDED-ONLINE                VALUE '1'.
  4746         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4747         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4748         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4749     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4750         88  CERT-AS-LOADED                   VALUE ' '.
  4751         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4752         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4753         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4754         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4755         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4756         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4757         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4758
  4759     12  CM-ACCOUNT-COMM-PCTS.
  4760         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4761         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4762
  4763     12  CM-USER-FIELD                     PIC X.
  4764     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4765     12  CM-CLP-STATE                      PIC XX.
  4766     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4767     12  CM-USER-RESERVED                  PIC XXX.
  4768     12  FILLER REDEFINES CM-USER-RESERVED.
  4769         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  84
* EL677.cbl
  4770         16  F                             PIC X.
  4771******************************************************************
  4772*                                    COPY ERCPNDB.
  4773******************************************************************
  4774*                                                                *
  4775*                                                                *
  4776*                            ERCPNDB.                            *
  4777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4778*                            VMOD=2.025                          *
  4779*                                                                *
  4780*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4781*                                                                *
  4782******************************************************************
  4783*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4784*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4785******************************************************************
  4786*                                                                *
  4787*                                                                *
  4788*   FILE TYPE = VSAM,KSDS                                        *
  4789*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4790*                                                                *
  4791*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4792*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4793*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4794*                                                 RKP=13,LEN=36  *
  4795*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4796*                                      AND CHG-SEQ.)             *
  4797*                                                RKP=49,LEN=11   *
  4798*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4799*                                      AND CHG-SEQ.)             *
  4800*                                                RKP=60,LEN=15   *
  4801*                                                                *
  4802*   LOG = NO                                                     *
  4803*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4804******************************************************************
  4805******************************************************************
  4806*                   C H A N G E   L O G
  4807*
  4808* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4809*-----------------------------------------------------------------
  4810*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4811* EFFECTIVE    NUMBER
  4812*-----------------------------------------------------------------
  4813* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4814* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4815* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4816* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4817* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4818* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4819* 032306                   PEMA  ADD BOW LOAN NUMBER
  4820* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4821* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4822* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4823* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4824* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4825* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4826* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4827* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  85
* EL677.cbl
  4828******************************************************************
  4829
  4830 01  PENDING-BUSINESS.
  4831     12  PB-RECORD-ID                     PIC XX.
  4832         88  VALID-PB-ID                        VALUE 'PB'.
  4833
  4834     12  PB-CONTROL-PRIMARY.
  4835         16  PB-COMPANY-CD                PIC X.
  4836         16  PB-ENTRY-BATCH               PIC X(6).
  4837         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4838         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4839
  4840     12  PB-CONTROL-BY-ACCOUNT.
  4841         16  PB-COMPANY-CD-A1             PIC X.
  4842         16  PB-CARRIER                   PIC X.
  4843         16  PB-GROUPING.
  4844             20  PB-GROUPING-PREFIX       PIC XXX.
  4845             20  PB-GROUPING-PRIME        PIC XXX.
  4846         16  PB-STATE                     PIC XX.
  4847         16  PB-ACCOUNT.
  4848             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4849             20  PB-ACCOUNT-PRIME         PIC X(6).
  4850         16  PB-CERT-EFF-DT               PIC XX.
  4851         16  PB-CERT-NO.
  4852             20  PB-CERT-PRIME            PIC X(10).
  4853             20  PB-CERT-SFX              PIC X.
  4854         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4855
  4856         16  PB-RECORD-TYPE               PIC X.
  4857             88  PB-MAILING-DATA                VALUE '0'.
  4858             88  PB-ISSUE                       VALUE '1'.
  4859             88  PB-CANCELLATION                VALUE '2'.
  4860             88  PB-BATCH-TRAILER               VALUE '9'.
  4861
  4862     12  PB-CONTROL-BY-ORIG-BATCH.
  4863         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4864         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4865         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4866         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4867
  4868     12  PB-CONTROL-BY-CSR.
  4869         16  PB-CSR-COMPANY-CD            PIC X.
  4870         16  PB-CSR-ID                    PIC X(4).
  4871         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4872         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4873         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4874******************************************************************
  4875*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4876******************************************************************
  4877
  4878     12  PB-LAST-MAINT-DT                 PIC XX.
  4879     12  PB-LAST-MAINT-BY                 PIC X(4).
  4880     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4881
  4882     12  PB-RECORD-BODY                   PIC X(375).
  4883
  4884     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4885         16  PB-CERT-ORIGIN               PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  86
* EL677.cbl
  4886             88  CLASIC-CREATED-CERT         VALUE '1'.
  4887         16  PB-I-NAME.
  4888             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4889             20  PB-I-INSURED-FIRST-NAME.
  4890                 24  PB-I-INSURED-1ST-INIT PIC X.
  4891                 24  FILLER                PIC X(9).
  4892             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4893         16  PB-I-AGE                     PIC S99   COMP-3.
  4894         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4895         16  PB-I-BIRTHDAY                PIC XX.
  4896         16  PB-I-INSURED-SEX             PIC X.
  4897             88  PB-SEX-MALE     VALUE 'M'.
  4898             88  PB-SEX-FEMALE   VALUE 'F'.
  4899
  4900         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4901         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4902         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4903         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4904         16  PB-I-SKIP-CODE               PIC X.
  4905             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4906             88  PB-SKIP-JULY              VALUE '1'.
  4907             88  PB-SKIP-AUGUST            VALUE '2'.
  4908             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4909             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4910             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4911             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4912             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4913             88  PB-SKIP-JUNE              VALUE '8'.
  4914             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4915             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4916             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4917         16  PB-I-TERM-TYPE               PIC X.
  4918             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4919             88  PB-PAID-WEEKLY            VALUE 'W'.
  4920             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4921             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4922             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4923         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4924         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4925         16  PB-I-DATA-ENTRY-SW           PIC X.
  4926             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4927             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4928             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4929             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4930         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4931         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4932*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4933         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4934         16  FILLER                       PIC X.
  4935
  4936         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4937             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4938             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4939                                                   '90' THRU '99'.
  4940         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4941                                          PIC XX.
  4942         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4943         16  PB-I-AMOUNT-FINANCED REDEFINES
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  87
* EL677.cbl
  4944                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4945         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4946         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4947                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4948         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4949         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4950         16  PB-I-CLP-AMOUNT REDEFINES
  4951                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4952         16  PB-I-LF-CALC-FLAG            PIC X.
  4953             88 PB-COMP-LF-PREM               VALUE '?'.
  4954         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4955         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4956         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4957         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4958         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4959         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4960         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4961         16  PB-I-LF-ABBR                 PIC XXX.
  4962         16  PB-I-LF-INPUT-CD             PIC XX.
  4963
  4964         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4965             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4966             88  PB-INVALID-AH               VALUE '  ' '00'
  4967                                                   '90' THRU '99'.
  4968         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4969         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4970         16  PB-I-AH-CALC-FLAG            PIC X.
  4971             88 PB-COMP-AH-PREM                  VALUE '?'.
  4972         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4973         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4974         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4975         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4976         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4977         16  PB-I-AH-ABBR                 PIC XXX.
  4978         16  PB-I-AH-INPUT-CD             PIC XXX.
  4979
  4980         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4981         16  PB-I-REIN-TABLE              PIC XXX.
  4982         16  PB-I-BUSINESS-TYPE           PIC 99.
  4983         16  PB-I-INDV-GRP-CD             PIC X.
  4984         16  PB-I-MORT-CODE.
  4985             20  PB-I-TABLE               PIC X.
  4986             20  PB-I-INTEREST            PIC XX.
  4987             20  PB-I-MORT-TYP            PIC X.
  4988         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4989         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4990         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4991         16  PB-I-INDV-GRP-OVRD           PIC X.
  4992         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4993         16  PB-I-SIG-SW                  PIC X.
  4994             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4995         16  PB-I-RATE-CLASS              PIC XX.
  4996         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4997         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4998         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4999         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5000         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5001         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  88
* EL677.cbl
  5002         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5003         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5004         16  PB-I-OB-FLAG                 PIC X.
  5005             88  PB-I-OB                      VALUE 'B'.
  5006             88  PB-I-SUMMARY                 VALUE 'Z'.
  5007         16  PB-I-ENTRY-STATUS            PIC X.
  5008             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5009                                              'M' '5' '9' '2'.
  5010             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5011             88  PB-I-POLICY-PENDING          VALUE '2'.
  5012             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5013             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5014             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5015             88  PB-I-REIN-ONLY               VALUE '9'.
  5016             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5017             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5018             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5019             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5020         16  PB-I-INT-CODE                PIC X.
  5021             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5022             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5023         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5024         16  PB-I-SOC-SEC-NO              PIC X(11).
  5025         16  PB-I-MEMBER-NO               PIC X(12).
  5026         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5027*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5028         16  PB-I-OLD-LOF                 PIC XXX.
  5029         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5030         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5031         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5032         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5033         16  PB-I-LIFE-INDICATOR          PIC X.
  5034             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5035         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5036         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5037                                          PIC S9(5)V99    COMP-3.
  5038         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5039             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5040             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5041         16  PB-I-1ST-PMT-DT              PIC XX.
  5042         16  PB-I-JOINT-INSURED.
  5043             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5044             20 PB-I-JOINT-FIRST-NAME.
  5045                24  PB-I-JOINT-FIRST-INIT PIC X.
  5046                24  FILLER                PIC X(9).
  5047             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5048*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5049         16  PB-I-BENEFICIARY-NAME.
  5050             20  PB-I-BANK-NUMBER         PIC X(10).
  5051             20  FILLER                   PIC X(15).
  5052         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5053         16  PB-I-REFERENCE               PIC X(12).
  5054         16  FILLER REDEFINES PB-I-REFERENCE.
  5055             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5056             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5057             20  PB-I-CLP-STATE           PIC XX.
  5058         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5059             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  89
* EL677.cbl
  5060             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5061             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5062         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5063         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5064         16  PB-I-RESIDENT-STATE          PIC XX.
  5065         16  PB-I-RATE-CODE               PIC X(4).
  5066         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5067         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5068         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5069         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5070         16  PB-I-BANK-NOCHRGB            PIC 99.
  5071         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5072         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5073
  5074     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5075         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5076             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5077         16  PB-C-CANCEL-ORIGIN           PIC X.
  5078             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5079         16  PB-C-LF-CANCEL-DT            PIC XX.
  5080         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5081         16  PB-C-LF-CALC-REQ             PIC X.
  5082             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5083         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5084         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5085         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5086             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5087         16  PB-C-AH-CANCEL-DT            PIC XX.
  5088         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5089         16  PB-C-AH-CALC-REQ             PIC X.
  5090             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5091         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5092         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5093         16  PB-C-LAST-NAME               PIC X(15).
  5094         16  PB-C-REFUND-SW               PIC X.
  5095             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5096             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5097         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5098         16  PB-C-PAYEE-CODE              PIC X(6).
  5099         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5100         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5101         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5102         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5103         16  PB-C-REFERENCE               PIC X(12).
  5104         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5105         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5106         16  PB-C-POST-CARD-IND           PIC X.
  5107         16  PB-C-CANCEL-REASON           PIC X.
  5108         16  PB-C-REF-INTERFACE-SW        PIC X.
  5109         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5110         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5111         16  FILLER                       PIC X(01).
  5112*        16  FILLER                       PIC X(18).
  5113         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5114*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5115         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5116         16  PB-CANCELED-CERT-DATA.
  5117             20  PB-CI-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  90
* EL677.cbl
  5118                 24  PB-CI-LAST-NAME      PIC X(15).
  5119                 24  PB-CI-INITIALS       PIC XX.
  5120             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5121             20  PB-CI-INSURED-SEX        PIC X.
  5122             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5123             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5124             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5125             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5126             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5127             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5128             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5129             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5130             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5131             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5132             20  PB-CI-RATE-CLASS         PIC XX.
  5133             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5134             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5135             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5136             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5137             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5138             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5139             20  PB-CI-LF-ABBR            PIC X(3).
  5140             20  PB-CI-AH-ABBR            PIC X(3).
  5141             20  PB-CI-OB-FLAG            PIC X.
  5142                 88  PB-CI-OB                VALUE 'B'.
  5143             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5144                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5145                                           'M' '4' '5' '9' '2'.
  5146                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5147                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5148                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5149                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5150                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5151                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5152                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5153                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5154                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5155                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5156                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5157                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5158             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5159                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5160                                           'M' '4' '5' '9' '2'.
  5161                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5162                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5163                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5164                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5165                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5166                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5167                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5168                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5169                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5170                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5171                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5172                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5173             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5174             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5175             20  PB-CI-SOC-SEC-NO         PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  91
* EL677.cbl
  5176             20  PB-CI-MEMBER-NO          PIC X(12).
  5177             20  PB-CI-INT-CODE           PIC X.
  5178                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5179                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5180             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5181             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5182             20  PB-CI-COMP-EXCP-SW       PIC X.
  5183                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5184                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5185             20  PB-CI-ENTRY-STATUS       PIC X.
  5186             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5187             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5188             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5189             20  PB-CI-DEATH-DT           PIC XX.
  5190             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5191             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5192             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5193             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5194             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5195             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5196             20  PB-CI-ENTRY-DT              PIC XX.
  5197             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5198             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5199             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5200             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5201             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5202             20  PB-CI-OLD-LOF               PIC XXX.
  5203*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5204             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5205             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5206             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5207             20  PB-CI-INDV-GRP-CD           PIC X.
  5208             20  PB-CI-BENEFICIARY-NAME.
  5209                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5210                 24  FILLER                  PIC X(15).
  5211             20  PB-CI-NOTE-SW               PIC X.
  5212             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5213             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5214             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5215             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5216             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5217             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5218             20  PB-CI-FIRST-NAME            PIC X(10).
  5219             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5220
  5221         16  FILLER                       PIC X(13).
  5222*032306  16  FILLER                       PIC X(27).
  5223*        16  FILLER                       PIC X(46).
  5224
  5225     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5226         16  FILLER                       PIC X(10).
  5227         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5228         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5229         16  PB-M-INSURED-MID-INIT        PIC X.
  5230         16  PB-M-INSURED-AGE             PIC 99.
  5231         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5232         16  PB-M-INSURED-SEX             PIC X.
  5233         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  92
* EL677.cbl
  5234         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5235         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5236         16  PB-M-INSURED-CITY-STATE.
  5237             20  PB-M-INSURED-CITY        PIC X(28).
  5238             20  PB-M-INSURED-STATE       PIC XX.
  5239         16  PB-M-INSURED-ZIP-CODE.
  5240             20  PB-M-INSURED-ZIP-PRIME.
  5241                 24  PB-M-INSURED-ZIP-1   PIC X.
  5242                     88  PB-M-CANADIAN-POST-CODE
  5243                                             VALUE 'A' THRU 'Z'.
  5244                 24  FILLER               PIC X(4).
  5245             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5246         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5247                                        PB-M-INSURED-ZIP-CODE.
  5248             20  PM-M-INS-CAN-POST1       PIC XXX.
  5249             20  PM-M-INS-CAN-POST2       PIC XXX.
  5250             20  FILLER                   PIC XXX.
  5251         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5252         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5253         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5254         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5255         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5256         16  PB-M-CRED-BENE-CITYST.
  5257             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5258             20  PB-M-CRED-BENE-STATE     PIC XX.
  5259         16  FILLER                       PIC X(92).
  5260
  5261     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5262         16  FILLER                       PIC X(10).
  5263         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5264         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5265         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5266         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5267         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5268         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5269         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5270         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5271         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5272         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5273         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5274         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5275         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5276         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5277         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5278         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5279         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5280         16  PB-ACCOUNT-NAME              PIC X(30).
  5281         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5282         16  PB-REFERENCE                 PIC X(12).
  5283         16  PB-B-RECEIVED-DT             PIC XX.
  5284         16  FILLER                       PIC X(234).
  5285
  5286     12  PB-RECORD-STATUS.
  5287         16  PB-CREDIT-SELECT-DT          PIC XX.
  5288         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5289         16  PB-BILLED-DT                 PIC XX.
  5290         16  PB-BILLING-STATUS            PIC X.
  5291             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  93
* EL677.cbl
  5292             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5293             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5294         16  PB-RECORD-BILL               PIC X.
  5295             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5296             88  PB-RECORD-RETURNED           VALUE 'R'.
  5297             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5298             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5299             88  PB-OVERRIDE-AH               VALUE 'A'.
  5300             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5301         16  PB-BATCH-ENTRY               PIC X.
  5302             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5303             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5304             88  PB-REISSUED-CERT             VALUE 'E'.
  5305             88  PB-MONTHLY-CERT              VALUE 'M'.
  5306             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5307             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5308             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5309         16  PB-FORCE-CODE                PIC X.
  5310             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5311             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5312             88  PB-CANCEL-FORCE              VALUE '8'.
  5313             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5314             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5315             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5316             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5317             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5318             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5319             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5320         16  PB-FATAL-FLAG                PIC X.
  5321             88  PB-FATAL-ERRORS              VALUE 'X'.
  5322         16  PB-FORCE-ER-CD               PIC X.
  5323             88  PB-FORCE-ERRORS              VALUE 'F'.
  5324             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5325         16  PB-WARN-ER-CD                PIC X.
  5326             88  PB-WARNING-ERRORS            VALUE 'W'.
  5327         16  FILLER                       PIC X.
  5328         16  PB-OUT-BAL-CD                PIC X.
  5329             88  PB-OUT-OF-BAL                VALUE 'O'.
  5330         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5331         16  PB-AH-OVERRIDE-L1            PIC X.
  5332         16  PB-INPUT-DT                  PIC XX.
  5333         16  PB-INPUT-BY                  PIC X(4).
  5334         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5335         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5336         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5337         16  PB-LF-EARNING-METHOD         PIC X.
  5338         16  PB-AH-EARNING-METHOD         PIC X.
  5339         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5340         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5341         16  PB-REIN-CD                   PIC XXX.
  5342         16  PB-LF-REFUND-TYPE            PIC X.
  5343         16  PB-AH-REFUND-TYPE            PIC X.
  5344         16  PB-ACCT-EFF-DT               PIC XX.
  5345         16  PB-ACCT-EXP-DT               PIC XX.
  5346         16  PB-COMPANY-ID                PIC X(3).
  5347         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5348         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5349         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  94
* EL677.cbl
  5350         16  PB-SV-GROUPING               PIC X(6).
  5351         16  PB-SV-STATE                  PIC XX.
  5352         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5353         16  PB-GA-BILLING-INFO.
  5354             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5355                                          PIC XX.
  5356         16  PB-SV-REMIT-TO  REDEFINES
  5357             PB-GA-BILLING-INFO           PIC X(10).
  5358         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5359         16  PB-I-LOAN-OFFICER            PIC X(5).
  5360         16  PB-I-VIN                     PIC X(17).
  5361
  5362         16  FILLER                       PIC X(04).
  5363         16  IMNET-BYPASS-SW              PIC X.
  5364
  5365******************************************************************
  5366*                COMMON EDIT ERRORS                              *
  5367******************************************************************
  5368
  5369     12  PB-COMMON-ERRORS.
  5370         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5371                                           PIC S9(4)     COMP.
  5372
  5373******************************************************************
  5374*                                    COPY ERCPNDM.
  5375******************************************************************
  5376*                                                                *
  5377*                                                                *
  5378*                            ERCPNDM                             *
  5379*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5380*                            VMOD=2.003                          *
  5381*                                                                *
  5382*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5383*                                                                *
  5384*   FILE TYPE = VSAM,KSDS                                        *
  5385*   RECORD SIZE = 374   RECFORM = FIX                            *
  5386*                                                                *
  5387*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5388*   ALTERNATE PATH    = NOT USED                                 *
  5389*                                                                *
  5390*   LOG = YES                                                    *
  5391*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5392******************************************************************
  5393*                   C H A N G E   L O G
  5394*
  5395* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5396*-----------------------------------------------------------------
  5397*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5398* EFFECTIVE    NUMBER
  5399*-----------------------------------------------------------------
  5400* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5401* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5402* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5403******************************************************************
  5404
  5405 01  PENDING-MAILING-DATA.
  5406     12  PM-RECORD-ID                      PIC XX.
  5407         88  VALID-MA-ID                       VALUE 'PM'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  95
* EL677.cbl
  5408
  5409     12  PM-CONTROL-PRIMARY.
  5410         16  PM-COMPANY-CD                 PIC X.
  5411         16  PM-ENTRY-BATCH                PIC X(6).
  5412         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5413         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5414
  5415     12  FILLER                            PIC X(14).
  5416
  5417     12  PM-ACCESS-CONTROL.
  5418         16  PM-SOURCE-SYSTEM              PIC XX.
  5419             88  PM-FROM-CREDIT                VALUE 'CR'.
  5420             88  PM-FROM-VSI                   VALUE 'VS'.
  5421             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5422             88  PM-FROM-OTHER                 VALUE 'OT'.
  5423         16  PM-RECORD-ADD-DT              PIC XX.
  5424         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5425         16  PM-LAST-MAINT-DT              PIC XX.
  5426         16  PM-LAST-MAINT-BY              PIC XXXX.
  5427         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5428
  5429     12  PM-PROFILE-INFO.
  5430         16  PM-QUALIFY-CODE-1             PIC XX.
  5431         16  PM-QUALIFY-CODE-2             PIC XX.
  5432         16  PM-QUALIFY-CODE-3             PIC XX.
  5433         16  PM-QUALIFY-CODE-4             PIC XX.
  5434         16  PM-QUALIFY-CODE-5             PIC XX.
  5435
  5436         16  PM-INSURED-LAST-NAME          PIC X(15).
  5437         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5438         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5439         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5440         16  PM-INSURED-BIRTH-DT           PIC XX.
  5441         16  PM-INSURED-SEX                PIC X.
  5442             88  PM-SEX-MALE                   VALUE 'M'.
  5443             88  PM-SEX-FEMALE                 VALUE 'F'.
  5444         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5445
  5446         16  PM-ADDRESS-CORRECTED          PIC X.
  5447         16  PM-JOINT-BIRTH-DT             PIC XX.
  5448*        16  FILLER                        PIC X(12).
  5449
  5450         16  PM-ADDRESS-LINE-1             PIC X(30).
  5451         16  PM-ADDRESS-LINE-2             PIC X(30).
  5452         16  PM-CITY-STATE.
  5453             20  PM-CITY                   PIC X(28).
  5454             20  PM-STATE                  PIC XX.
  5455         16  PM-ZIP.
  5456             20  PM-ZIP-CODE.
  5457                 24  PM-ZIP-1              PIC X.
  5458                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5459                 24  FILLER                PIC X(4).
  5460             20  PM-ZIP-PLUS4              PIC X(4).
  5461         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5462             20  PM-CAN-POST1              PIC XXX.
  5463             20  PM-CAN-POST2              PIC XXX.
  5464             20  FILLER                    PIC XXX.
  5465
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  96
* EL677.cbl
  5466         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5467
  5468         16  FILLER                        PIC X(03).
  5469
  5470     12  PM-CRED-BENE-INFO.
  5471         16  PM-CRED-BENE-NAME             PIC X(25).
  5472         16  PM-CRED-BENE-ADDR             PIC X(30).
  5473         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5474         16  PM-CRED-BENE-CTYST.
  5475             20  PM-CRED-BENE-CITY         PIC X(28).
  5476             20  PM-CRED-BENE-STATE        PIC XX.
  5477         16  PM-CRED-BENE-ZIP.
  5478             20  PM-CB-ZIP-CODE.
  5479                 24  PM-CB-ZIP-1           PIC X.
  5480                     88  PM-CB-CANADIAN-POST-CODE
  5481                                  VALUE 'A' THRU 'Z'.
  5482                 24  FILLER                PIC X(4).
  5483             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5484         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5485             20  PM-CB-CAN-POST1           PIC XXX.
  5486             20  PM-CB-CAN-POST2           PIC XXX.
  5487             20  FILLER                    PIC XXX.
  5488     12  PM-POST-CARD-MAIL-DATA.
  5489         16  PM-MAIL-DATA OCCURS 7.
  5490             20  PM-MAIL-TYPE              PIC X.
  5491                 88  PM-12MO-MAILING           VALUE '1'.
  5492                 88  PM-EXP-MAILING            VALUE '2'.
  5493             20  PM-MAIL-STATUS            PIC X.
  5494                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5495                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5496                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5497             20  PM-MAIL-DATE              PIC XX.
  5498     12  FILLER                            PIC XX.
  5499     12  FILLER                            PIC X(12).
  5500*    12  FILLER                            PIC X(30).
  5501
  5502******************************************************************
  5503*                                    COPY ERCMAIL.
  5504******************************************************************
  5505*                                                                *
  5506*                                                                *
  5507*                            ERCMAIL                             *
  5508*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5509*                            VMOD=2.003                          *
  5510*                                                                *
  5511*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5512*                                                                *
  5513*   FILE TYPE = VSAM,KSDS                                        *
  5514*   RECORD SIZE = 374   RECFORM = FIX                            *
  5515*                                                                *
  5516*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5517*   ALTERNATE PATH    = NOT USED                                 *
  5518*                                                                *
  5519*   LOG = YES                                                    *
  5520*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5521******************************************************************
  5522*                   C H A N G E   L O G
  5523*
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  97
* EL677.cbl
  5524* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5525*-----------------------------------------------------------------
  5526*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5527* EFFECTIVE    NUMBER
  5528*-----------------------------------------------------------------
  5529* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5530* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5531* 111108                   PEMA  ADD CRED BENE ADDR2
  5532******************************************************************
  5533
  5534 01  MAILING-DATA.
  5535     12  MA-RECORD-ID                      PIC XX.
  5536         88  VALID-MA-ID                       VALUE 'MA'.
  5537
  5538     12  MA-CONTROL-PRIMARY.
  5539         16  MA-COMPANY-CD                 PIC X.
  5540         16  MA-CARRIER                    PIC X.
  5541         16  MA-GROUPING.
  5542             20  MA-GROUPING-PREFIX        PIC XXX.
  5543             20  MA-GROUPING-PRIME         PIC XXX.
  5544         16  MA-STATE                      PIC XX.
  5545         16  MA-ACCOUNT.
  5546             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5547             20  MA-ACCOUNT-PRIME          PIC X(6).
  5548         16  MA-CERT-EFF-DT                PIC XX.
  5549         16  MA-CERT-NO.
  5550             20  MA-CERT-PRIME             PIC X(10).
  5551             20  MA-CERT-SFX               PIC X.
  5552
  5553     12  FILLER                            PIC XX.
  5554
  5555     12  MA-ACCESS-CONTROL.
  5556         16  MA-SOURCE-SYSTEM              PIC XX.
  5557             88  MA-FROM-CREDIT                VALUE 'CR'.
  5558             88  MA-FROM-VSI                   VALUE 'VS'.
  5559             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5560             88  MA-FROM-OTHER                 VALUE 'OT'.
  5561         16  MA-RECORD-ADD-DT              PIC XX.
  5562         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5563         16  MA-LAST-MAINT-DT              PIC XX.
  5564         16  MA-LAST-MAINT-BY              PIC XXXX.
  5565         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5566
  5567     12  MA-PROFILE-INFO.
  5568         16  MA-QUALIFY-CODE-1             PIC XX.
  5569         16  MA-QUALIFY-CODE-2             PIC XX.
  5570         16  MA-QUALIFY-CODE-3             PIC XX.
  5571         16  MA-QUALIFY-CODE-4             PIC XX.
  5572         16  MA-QUALIFY-CODE-5             PIC XX.
  5573
  5574         16  MA-INSURED-LAST-NAME          PIC X(15).
  5575         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5576         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5577         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5578         16  MA-INSURED-BIRTH-DT           PIC XX.
  5579         16  MA-INSURED-SEX                PIC X.
  5580             88  MA-SEX-MALE                   VALUE 'M'.
  5581             88  MA-SEX-FEMALE                 VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  98
* EL677.cbl
  5582         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5583
  5584         16  MA-ADDRESS-CORRECTED          PIC X.
  5585         16  MA-JOINT-BIRTH-DT             PIC XX.
  5586*        16  FILLER                        PIC X(12).
  5587
  5588         16  MA-ADDRESS-LINE-1             PIC X(30).
  5589         16  MA-ADDRESS-LINE-2             PIC X(30).
  5590         16  MA-CITY-STATE.
  5591             20  MA-CITY                   PIC X(28).
  5592             20  MA-ADDR-STATE             PIC XX.
  5593         16  MA-ZIP.
  5594             20  MA-ZIP-CODE.
  5595                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5596                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5597                 24  FILLER                PIC X(4).
  5598             20  MA-ZIP-PLUS4              PIC X(4).
  5599         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5600             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5601             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5602             20  FILLER                    PIC X(3).
  5603
  5604         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5605
  5606         16  FILLER                        PIC XXX.
  5607*        16  FILLER                        PIC X(10).
  5608
  5609     12  MA-CRED-BENE-INFO.
  5610         16  MA-CRED-BENE-NAME                 PIC X(25).
  5611         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5612         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5613         16  MA-CRED-BENE-CTYST.
  5614             20  MA-CRED-BENE-CITY             PIC X(28).
  5615             20  MA-CRED-BENE-STATE            PIC XX.
  5616         16  MA-CRED-BENE-ZIP.
  5617             20  MA-CB-ZIP-CODE.
  5618                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5619                     88  MA-CB-CANADIAN-POST-CODE
  5620                                           VALUE 'A' THRU 'Z'.
  5621                 24  FILLER                    PIC X(4).
  5622             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5623         16  MA-CB-CANADIAN-POSTAL-CODE
  5624                            REDEFINES MA-CRED-BENE-ZIP.
  5625             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5626             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5627             20  FILLER                        PIC X(3).
  5628     12  MA-POST-CARD-MAIL-DATA.
  5629         16  MA-MAIL-DATA OCCURS 7.
  5630             20  MA-MAIL-TYPE              PIC X.
  5631                 88  MA-12MO-MAILING           VALUE '1'.
  5632                 88  MA-EXP-MAILING            VALUE '2'.
  5633             20  MA-MAIL-STATUS            PIC X.
  5634                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5635                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5636                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5637             20  MA-MAIL-DATE              PIC XX.
  5638     12  FILLER                            PIC XX.
  5639     12  FILLER                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page  99
* EL677.cbl
  5640*    12  FILLER                            PIC X(30).
  5641******************************************************************
  5642*                                    COPY ERCPYAJ.
  5643******************************************************************
  5644*                                                                *
  5645*                            ERCPYAJ                             *
  5646*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5647*                            VMOD=2.015                          *
  5648*                                                                *
  5649*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5650*                                                                *
  5651*                                                                *
  5652*   FILE TYPE = VSAM,KSDS                                        *
  5653*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5654*                                                                *
  5655*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5656*       ALTERNATE PATHS = NONE                                   *
  5657*                                                                *
  5658*   LOG = YES                                                    *
  5659*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5660******************************************************************
  5661******************************************************************
  5662*                   C H A N G E   L O G
  5663*
  5664* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5665*-----------------------------------------------------------------
  5666*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5667* EFFECTIVE    NUMBER
  5668*-----------------------------------------------------------------
  5669* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5670* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5671******************************************************************
  5672
  5673 01  PENDING-PAY-ADJ.
  5674     12  PY-RECORD-ID                     PIC XX.
  5675         88  VALID-PY-ID                        VALUE 'PY'.
  5676
  5677     12  PY-CONTROL-PRIMARY.
  5678         16  PY-COMPANY-CD                PIC X.
  5679         16  PY-CARRIER                   PIC X.
  5680         16  PY-GROUPING                  PIC X(6).
  5681         16  PY-FIN-RESP                  PIC X(10).
  5682         16  PY-ACCOUNT                   PIC X(10).
  5683         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5684                                          PIC X(10).
  5685         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5686         16  PY-RECORD-TYPE               PIC X.
  5687             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5688             88  PY-DEPOSIT                   VALUE 'D'.
  5689             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5690             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5691             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5692             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5693             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5694             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5695             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5696             88  PY-FICA-ENTRY                VALUE 'F'.
  5697             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 100
* EL677.cbl
  5698             88  PY-POLICY-FEE                VALUE 'W'.
  5699             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5700
  5701     12  PY-PYMT-TYPE                     PIC X.
  5702             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5703             88  PY-REINS-PYMT                VALUE 'R'.
  5704             88  PY-EXP-PYMT                  VALUE 'E'.
  5705
  5706     12  PY-BIL-INV                       PIC X(6).
  5707     12  PY-REF-NO                        PIC X(12).
  5708
  5709     12  PY-LAST-MAINT-DT                 PIC XX.
  5710     12  PY-LAST-MAINT-BY                 PIC X(4).
  5711     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5712
  5713     12  PY-PYADJ-RECORD.
  5714         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5715         16  PY-ENTRY-COMMENT             PIC X(30).
  5716         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5717             20  PY-GL-ACCOUNT            PIC X(10).
  5718             20  PY-GL-STATE              PIC X(02).
  5719             20  PY-GL-CANC-SW            PIC X(01).
  5720                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5721                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5722             20  PY-GL-COMMENT            PIC X(10).
  5723             20  FILLER      REDEFINES PY-GL-COMMENT.
  5724                 24  PY-GL-CHECK-NO       PIC 9(06).
  5725                 24  FILLER               PIC X(04).
  5726             20  FILLER                   PIC X(07).
  5727         16  PY-SAVE-ACCOUNT              PIC X(10).
  5728         16  PY-SAVE-TYPE                 PIC X(01).
  5729
  5730         16  PY-LETTERS.
  5731             20  PY-LETTER OCCURS 3 TIMES
  5732                           INDEXED BY PY-LET-NDX
  5733                                          PIC X(04).
  5734
  5735         16  PY-ERCOMP-TYPE               PIC X.
  5736             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5737             88  PY-GA-TYPE                   VALUE 'G'.
  5738             88  PY-BANK-TYPE                 VALUE 'B'.
  5739         16  FILLER                       PIC X(05).
  5740
  5741     12  PY-RECORD-STATUS.
  5742         16  PY-CREDIT-SELECT-DT          PIC XX.
  5743         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5744         16  PY-BILLED-DATE               PIC XX.
  5745         16  PY-REPORTED-DT               PIC XX.
  5746         16  PY-PMT-APPLIED               PIC X.
  5747             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5748             88  PY-GA-PMT                    VALUE 'G'.
  5749             88  PY-OVWRITE-PMT               VALUE 'O'.
  5750             88  PY-NON-AR-PMT                VALUE 'N'.
  5751         16  FILLER                       PIC X(5).
  5752         16  PY-INPUT-DT                  PIC XX.
  5753         16  PY-CHECK-NUMBER              PIC X(6).
  5754         16  PY-VOID-SW                   PIC X.
  5755             88  PY-CHECK-VOIDED              VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 101
* EL677.cbl
  5756         16  PY-CHECK-ORIGIN-SW           PIC X.
  5757             88  PY-BILLING-CHECK             VALUE 'B'.
  5758             88  PY-REFUND-CHECK              VALUE 'R'.
  5759             88  PY-GA-CHECK                  VALUE 'G'.
  5760             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5761             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5762         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5763         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5764         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5765         16  PY-BILL-FLAG                 PIC X.
  5766             88  PY-BILLED                    VALUE 'B'.
  5767         16  PY-AR-FLAG                   PIC X.
  5768             88  PY-AR-CYCLE                  VALUE 'C'.
  5769             88  PY-AR-MONTH-END              VALUE 'M'.
  5770         16  PY-AR-DATE                   PIC XX.
  5771
  5772     12  PY-GL-CODES.
  5773         16  PY-GL-DB                     PIC X(14).
  5774         16  PY-GL-CR                     PIC X(14).
  5775         16  PY-GL-FLAG                   PIC X.
  5776         16  PY-GL-DATE                   PIC XX.
  5777
  5778     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5779     12  FILLER                           PIC X(3).
  5780******************************************************************
  5781 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5782                          CHECK-RECORDS ACCOUNT-MASTER
  5783                          COMPENSATION-MASTER
  5784                          CERTIFICATE-MASTER PENDING-BUSINESS
  5785                          PENDING-MAILING-DATA MAILING-DATA
  5786                          PENDING-PAY-ADJ.
  5787 0000-DFHEXIT SECTION.
  5788     MOVE '9#                    $   ' TO DFHEIV0.
  5789     MOVE 'EL677' TO DFHEIV1.
  5790     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5791
  5792     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5793     MOVE '5'                    TO  DC-OPTION-CODE.
  5794     PERFORM 8500-DATE-CONVERT.
  5795     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5796     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5797     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5798
  5799     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5800
  5801     IF PI-AMOUNT NOT NUMERIC
  5802         MOVE ZEROS              TO  PI-AMOUNT.
  5803
  5804     IF EIBCALEN = 0
  5805         GO TO 8800-UNAUTHORIZED-ACCESS.
  5806     set P to address of KIXSYS
  5807     CALL "getenv" using by value P returning var-ptr
  5808     if var-ptr = null then
  5809        display ' kixsys not set '
  5810     else
  5811        set address of var to var-ptr
  5812        move 0 to env-var-len
  5813        inspect var tallying env-var-len
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 102
* EL677.cbl
  5814          for characters before X'00'
  5815        unstring var (1:env-var-len) delimited by '/'
  5816           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5817              WS-KIX-SYS
  5818        end-unstring
  5819     end-if
  5820     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5821     MOVE 2                      TO  EMI-SWITCH2.
  5822     MOVE EIBTRMID               TO  QID-TERM.
  5823
  5824     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5825         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5826
  5827     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5828         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5829             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5830             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5831             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5832             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5833             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5834             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5835             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5836             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5837         ELSE
  5838             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5839             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5840             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5841             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5842             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5843             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5844             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5845             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5846
  5847     MOVE LOW-VALUES             TO  EL677AI.
  5848
  5849     IF EIBTRNID NOT = TRANS-ID
  5850         move pi-processor-id    to pi-return-to
  5851         move 'N'                to dedcyno
  5852         move al-uanon           to dedcyna
  5853         perform 6800-browse-previous-chek-recs
  5854                                 thru 6800-exit
  5855         perform 5600-get-erpndb thru 5600-exit
  5856         IF PI-TO-EL677-FROM-EL1273
  5857             MOVE 'S'            TO MAINTI
  5858             MOVE 1              TO MAINTL
  5859             MOVE AL-UABON       TO MAINTA
  5860             MOVE DFHENTER       TO EIBAID
  5861             GO TO 5000-BROWSE-FILE.
  5862
  5863     IF EIBTRNID NOT = TRANS-ID
  5864        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5865           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5866           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5867           IF PI-PROCESS-BENEFICIARY
  5868              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5869           ELSE
  5870              GO TO 6300-BUILD-CERT-SCREEN
  5871           end-if
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 103
* EL677.cbl
  5872        ELSE
  5873           IF EIBTRNID NOT = EL6311-TRANS-ID
  5874              GO TO 8100-SEND-INITIAL-MAP
  5875           ELSE
  5876              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5877              IF PI-PROCESS-BENEFICIARY
  5878                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5879              ELSE
  5880                 GO TO 6300-BUILD-CERT-SCREEN
  5881              end-if
  5882           end-if
  5883        end-if
  5884      end-if
  5885
  5886     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5887                                     PI-CHEK-COMP-CD.
  5888
  5889
  5890* EXEC CICS HANDLE CONDITION
  5891*        PGMIDERR  (9600-PGMID-ERROR)
  5892*        ERROR     (9990-ABEND)
  5893*    END-EXEC.
  5894*    MOVE '"$L.                  ! " #00005792' TO DFHEIV0
  5895     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5897     MOVE X'2220233030303035373932' TO DFHEIV0(25:11)
  5898     CALL 'kxdfhei1' USING DFHEIV0
  5899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5900
  5901
  5902     IF EIBAID = DFHCLEAR
  5903         GO TO 9400-CLEAR.
  5904
  5905     IF PI-PROCESSOR-ID = 'LGXX'
  5906         GO TO 0200-RECEIVE.
  5907
  5908
  5909* EXEC CICS READQ TS
  5910*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5911*        INTO   (SECURITY-CONTROL)
  5912*        LENGTH (SC-COMM-LENGTH)
  5913*        ITEM   (SC-ITEM)
  5914*    END-EXEC.
  5915*    MOVE '*$II   L              ''   #00005803' TO DFHEIV0
  5916     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5917     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5918     MOVE X'2020233030303035383033' TO DFHEIV0(25:11)
  5919     CALL 'kxdfhei1' USING DFHEIV0,
  5920           PI-SECURITY-TEMP-STORE-ID,
  5921           SECURITY-CONTROL,
  5922           SC-COMM-LENGTH,
  5923           SC-ITEM,
  5924           DFHEIV99,
  5925           DFHEIV99
  5926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5927
  5928
  5929     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 104
* EL677.cbl
  5930     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  5931
  5932     IF NOT DISPLAY-CAP
  5933         MOVE 'READ'          TO SM-READ
  5934         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5935         MOVE ER-0070         TO  EMI-ERROR
  5936         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5937         GO TO 8100-SEND-INITIAL-MAP.
  5938
  5939 0200-RECEIVE.
  5940     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5941         MOVE ER-1159            TO  EMI-ERROR
  5942         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5943         MOVE -1                 TO  PFENTERL
  5944         GO TO 8200-SEND-DATAONLY.
  5945
  5946
  5947* EXEC CICS HANDLE CONDITION
  5948*        MAPFAIL (8100-SEND-INITIAL-MAP)
  5949*    END-EXEC.
  5950*    MOVE '"$?                   ! # #00005827' TO DFHEIV0
  5951     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  5952     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5953     MOVE X'2320233030303035383237' TO DFHEIV0(25:11)
  5954     CALL 'kxdfhei1' USING DFHEIV0
  5955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5956
  5957
  5958
  5959* EXEC CICS RECEIVE
  5960*        MAP      (EL677A)
  5961*        MAPSET   (MAPSET-NAME)
  5962*        INTO     (EL677AI)
  5963*    END-EXEC.
  5964     MOVE LENGTH OF
  5965      EL677AI
  5966       TO DFHEIV11
  5967*    MOVE '8"T I  L              ''   #00005831' TO DFHEIV0
  5968     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5969     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5970     MOVE X'2020233030303035383331' TO DFHEIV0(25:11)
  5971     CALL 'kxdfhei1' USING DFHEIV0,
  5972           EL677A,
  5973           EL677AI,
  5974           DFHEIV11,
  5975           MAPSET-NAME,
  5976           DFHEIV99,
  5977           DFHEIV99
  5978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5979
  5980
  5981     IF PFENTERL GREATER ZERO
  5982         IF EIBAID NOT = DFHENTER
  5983             MOVE ER-0004        TO  EMI-ERROR
  5984             MOVE AL-UNBOF       TO  PFENTERA
  5985             MOVE -1             TO  PFENTERL
  5986             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5987             GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 105
* EL677.cbl
  5988         ELSE
  5989             IF (PFENTERI NUMERIC) AND
  5990                (PFENTERI GREATER 0 AND LESS 25)
  5991                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  5992             ELSE
  5993                 MOVE ER-0029    TO  EMI-ERROR
  5994                 MOVE AL-UNBOF   TO  PFENTERA
  5995                 MOVE -1         TO  PFENTERL
  5996                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5997                 GO TO 8200-SEND-DATAONLY.
  5998 0300-CHECK-PFKEYS.
  5999     IF EIBAID = DFHPF23
  6000         GO TO 8810-PF23.
  6001
  6002     IF EIBAID = DFHPF24
  6003         GO TO 9200-RETURN-MAIN-MENU.
  6004
  6005     IF EIBAID = DFHPF12
  6006         GO TO 9500-PF12.
  6007
  6008     IF EIBAID = DFHPF1 OR DFHPF2
  6009         GO TO 5000-BROWSE-FILE.
  6010
  6011     if PI-TO-EL677-FROM-EL1273
  6012        and (eibaid not = dfhenter)
  6013        go to 0320-input-error
  6014     end-if
  6015     IF EIBAID = DFHPF3
  6016         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6017         MOVE 'PF3'              TO  PI-PFKEY
  6018         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6019         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6020             GO TO 9400-CLEAR
  6021         ELSE
  6022             MOVE XCTL-1273      TO  PGM-NAME
  6023             GO TO 9300-XCTL.
  6024
  6025     IF EIBAID = DFHPF4
  6026         IF NOT FORCE-CAP
  6027             MOVE ER-0433        TO EMI-ERROR
  6028             MOVE -1             TO PFENTERL
  6029             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6030             GO TO 8200-SEND-DATAONLY.
  6031
  6032     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6033                             DFHPF5 OR DFHPF6 or dfhpf7
  6034         GO TO 1000-EDIT-DATA.
  6035
  6036*    IF EIBAID = DFHPF7
  6037*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6038*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6039*        MOVE XCTL-114           TO  PGM-NAME
  6040*        GO TO 9300-XCTL.
  6041
  6042 0320-INPUT-ERROR.
  6043     MOVE ER-0029                TO  EMI-ERROR.
  6044     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6045     MOVE -1                     TO  PFENTERL.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 106
* EL677.cbl
  6046     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 107
* EL677.cbl
  6048
  6049 1000-EDIT-DATA.
  6050     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D'
  6051         MOVE AL-UANON           TO MAINTA
  6052         IF MAINTI = 'C' OR 'V'
  6053             IF PI-PREV-MAINT = 'S'  OR  'C'
  6054                 NEXT SENTENCE
  6055             ELSE
  6056                 MOVE ER-2056    TO  EMI-ERROR
  6057                 MOVE -1         TO  MAINTL
  6058                 MOVE AL-UABON   TO  MAINTA
  6059                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6060                 GO TO 1100-EDIT-COMPLETE
  6061         ELSE
  6062             NEXT SENTENCE
  6063     ELSE
  6064         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6065            NEXT SENTENCE
  6066         ELSE
  6067            MOVE ER-0023            TO  EMI-ERROR
  6068            MOVE -1                 TO  MAINTL
  6069            MOVE AL-UABON           TO  MAINTA
  6070            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6071
  6072     IF MODIFY-CAP
  6073         NEXT SENTENCE
  6074       ELSE
  6075         IF MAINTI NOT = 'S'
  6076            MOVE 'UPDATE'       TO SM-READ
  6077            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6078            MOVE ER-0070        TO EMI-ERROR
  6079            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6080            GO TO 8100-SEND-INITIAL-MAP.
  6081
  6082     if (pi-return-to-program = 'EL1273')
  6083        and (MAINTI not = 'S' and 'V')
  6084        move 'S'                 to mainti
  6085        move +1                  to maintl
  6086        move al-uanon            to mainta
  6087     end-if
  6088     IF CARRIERI NOT = LOW-VALUES
  6089         MOVE AL-UANON           TO  CARRIERA
  6090         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6091         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6092                                     PI-CARRIER
  6093     ELSE
  6094         MOVE -1                 TO  CARRIERL
  6095         MOVE AL-UABON           TO  CARRIERA
  6096         MOVE ER-0194            TO  EMI-ERROR
  6097         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6098
  6099     IF GROUPI NOT = LOW-VALUES
  6100         MOVE AL-UANON           TO  GROUPA
  6101         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6102                                     PI-GROUPING
  6103     ELSE
  6104         MOVE -1                 TO  GROUPL
  6105         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 108
* EL677.cbl
  6106         MOVE ER-0195            TO  EMI-ERROR
  6107         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6108
  6109     IF STATEI NOT = LOW-VALUES
  6110         MOVE AL-UANON           TO  STATEA
  6111         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6112         MOVE STATEI             TO  PI-CHEK-STATE
  6113                                     PI-STATE
  6114     ELSE
  6115         MOVE -1                 TO  STATEL
  6116         MOVE AL-UABON           TO  STATEA
  6117         MOVE ER-0196            TO  EMI-ERROR
  6118         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6119
  6120     IF EFFDTL GREATER ZERO
  6121         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6122         PERFORM 8700-DEEDIT
  6123         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6124             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6125             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6126             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6127             MOVE '4'                TO  DC-OPTION-CODE
  6128             PERFORM 8500-DATE-CONVERT
  6129             IF DC-ERROR-CODE NOT = SPACES
  6130                 MOVE ER-0215        TO  EMI-ERROR
  6131                 PERFORM 9900-ERROR-FORMAT
  6132                 MOVE -1             TO  EFFDTL
  6133                 MOVE AL-UABON       TO  EFFDTA
  6134               ELSE
  6135                 MOVE AL-UANON       TO  EFFDTA
  6136                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6137                                         PI-CERT-EFF-DT
  6138           ELSE
  6139             MOVE ER-0215        TO  EMI-ERROR
  6140             PERFORM 9900-ERROR-FORMAT
  6141             MOVE -1             TO  EFFDTL
  6142             MOVE AL-UABON       TO  EFFDTA
  6143       ELSE
  6144         MOVE ER-0216            TO  EMI-ERROR
  6145         PERFORM 9900-ERROR-FORMAT
  6146         MOVE -1                 TO  EFFDTL
  6147         MOVE AL-UABOF           TO  EFFDTA.
  6148
  6149     IF ACCTI NOT = LOW-VALUES
  6150         MOVE AL-UANON           TO  ACCTA
  6151         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6152         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6153                                     PI-ACCOUNT
  6154     ELSE
  6155         MOVE -1                 TO  ACCTL
  6156         MOVE AL-UABON           TO  ACCTA
  6157         MOVE ER-0197            TO  EMI-ERROR
  6158         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6159
  6160     IF CERTNOI NOT = LOW-VALUES
  6161         MOVE AL-UANON           TO  CERTNOA
  6162         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6163                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 109
* EL677.cbl
  6164     ELSE
  6165         MOVE -1                 TO  CERTNOL
  6166         MOVE AL-UABON           TO  CERTNOA
  6167         MOVE ER-0203            TO  EMI-ERROR
  6168         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6169
  6170     IF SFXI  = LOW-VALUES
  6171         MOVE SPACE              TO  SFXI.
  6172
  6173     MOVE AL-UANON               TO  SFXA.
  6174
  6175     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6176                                     PI-CERT-SFX.
  6177     IF SEQI = LOW-VALUES
  6178         MOVE +1                 TO  SEQI.
  6179
  6180     MOVE AL-UNNON               TO  SEQA.
  6181     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6182
  6183     IF PAYTO1L > 0
  6184         MOVE PAYTO1I            TO  PI-PAYTO1
  6185     ELSE
  6186         MOVE SPACES             TO  PI-PAYTO1.
  6187
  6188     IF AMOUNTL > 0
  6189
  6190* EXEC CICS BIF DEEDIT
  6191*            FIELD   (AMOUNTI)
  6192*            LENGTH  (11)
  6193*        END-EXEC
  6194     MOVE 11
  6195       TO DFHEIV11
  6196*    MOVE '@"L                   #   #00006045' TO DFHEIV0
  6197     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6198     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6199     MOVE X'2020233030303036303435' TO DFHEIV0(25:11)
  6200     CALL 'kxdfhei1' USING DFHEIV0,
  6201           AMOUNTI,
  6202           DFHEIV11
  6203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6204         MOVE AMOUNTI            TO  PI-AMOUNT
  6205     ELSE
  6206         MOVE ZEROS              TO  PI-AMOUNT.
  6207
  6208     IF TYPEL > 0
  6209         MOVE TYPEI              TO  PI-TYPE
  6210     ELSE
  6211         MOVE SPACE              TO  PI-TYPE.
  6212
  6213*    IF REFL > 0
  6214*        MOVE REFI               TO  PI-REFERENCE
  6215*    ELSE
  6216*        MOVE SPACES             TO  PI-REFERENCE.
  6217     if rettol not = zeros
  6218        move rettoi              to pi-return-to
  6219        MOVE AL-UANON            TO  RETTOA
  6220     end-if
  6221     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 110
* EL677.cbl
  6222        if dedcyni = 'Y' OR 'N'
  6223           continue
  6224        else
  6225           move er-3451          to emi-error
  6226           move -1               to dedcynl
  6227           move al-uabon         to dedcyna
  6228           perform 9900-error-format
  6229                                 thru 9900-exit
  6230        end-if
  6231     end-if
  6232
  6233     if mainti = 'V'
  6234        if (vreasonl > zeros)
  6235           and (vreasoni (1:2) not = spaces)
  6236           continue
  6237        else
  6238           move er-3454          to emi-error
  6239           move -1               to vreasonl
  6240           move al-uabon         to vreasona
  6241           perform 9900-error-format
  6242                                 thru 9900-exit
  6243        end-if
  6244     end-if
  6245     if mainti = 'A'
  6246        continue
  6247     else
  6248        IF MAINTI = 'S'
  6249           or pi-prev-maint = 'S'
  6250           GO TO 1100-EDIT-COMPLETE
  6251        end-if
  6252     end-if
  6253     IF EIBAID = DFHPF5
  6254        IF EMI-ERROR = ZEROS
  6255          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6256        ELSE
  6257          GO TO 1100-EDIT-COMPLETE.
  6258
  6259     IF EIBAID = DFHPF6
  6260        IF EMI-ERROR = ZEROS
  6261           GO TO 6300-BUILD-CERT-SCREEN
  6262         ELSE
  6263           GO TO 1100-EDIT-COMPLETE.
  6264
  6265     IF EIBAID = DFHPF7
  6266        IF EMI-ERROR = ZEROS
  6267           GO TO 6600-build-beneficiary-screen
  6268         ELSE
  6269           GO TO 1100-EDIT-COMPLETE.
  6270
  6271*    if mainti = 'V'
  6272*       if (vreasonl > zeros)
  6273*          and (vreasoni (1:2) not = spaces)
  6274*          continue
  6275*       else
  6276*          move er-3454          to emi-error
  6277*          move -1               to vreasonl
  6278*          move al-uabon         to vreasona
  6279*          perform 9900-error-format
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 111
* EL677.cbl
  6280*                                thru 9900-exit
  6281*       end-if
  6282*    end-if
  6283     IF MAINTI = 'A'
  6284        if (payto1i not = spaces and low-values)
  6285           and (payad1i not = spaces and low-values)
  6286           and (payctyi not = spaces and low-values)
  6287           and (paysti not = spaces and low-values)
  6288           and (ptozipi not = spaces and low-values)
  6289           continue
  6290        else
  6291           MOVE -1               TO PAYTO1L
  6292           MOVE ER-2907          TO EMI-ERROR
  6293           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6294        end-if
  6295     end-if
  6296
  6297     IF MAINTI = 'A'
  6298         IF EIBAID NOT = DFHPF4
  6299             MOVE DFHENTER       TO  EIBAID
  6300             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6301
  6302     IF MAINTI = 'S' OR 'V'
  6303         GO TO 1100-EDIT-COMPLETE.
  6304
  6305     IF PRINTEDL GREATER THAN +0
  6306         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6307         PERFORM 8700-DEEDIT
  6308         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6309             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6310             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6311             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6312             MOVE '4'                TO  DC-OPTION-CODE
  6313             PERFORM 8500-DATE-CONVERT
  6314             IF DC-ERROR-CODE NOT = SPACES
  6315                 MOVE ER-3046        TO  EMI-ERROR
  6316                 PERFORM 9900-ERROR-FORMAT
  6317                 MOVE -1             TO  PRINTEDL
  6318                 MOVE AL-UABON       TO  PRINTEDA
  6319                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6320             ELSE
  6321                 MOVE AL-UANON       TO  PRINTEDA
  6322                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6323         ELSE
  6324             MOVE ER-3046        TO  EMI-ERROR
  6325             PERFORM 9900-ERROR-FORMAT
  6326             MOVE -1             TO  PRINTEDL
  6327             MOVE AL-UABON       TO  PRINTEDA
  6328             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
  6329
  6330     IF AMOUNTL = ZEROS
  6331         GO TO 1050-CK-AMT.
  6332
  6333
  6334* EXEC CICS BIF DEEDIT
  6335*        FIELD   (AMOUNTI)
  6336*        LENGTH  (11)
  6337*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 112
* EL677.cbl
  6338     MOVE 11
  6339       TO DFHEIV11
  6340*    MOVE '@"L                   #   #00006178' TO DFHEIV0
  6341     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6342     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6343     MOVE X'2020233030303036313738' TO DFHEIV0(25:11)
  6344     CALL 'kxdfhei1' USING DFHEIV0,
  6345           AMOUNTI,
  6346           DFHEIV11
  6347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6348
  6349
  6350     IF AMOUNTI NOT NUMERIC     OR
  6351        AMOUNTI LESS THAN ZERO  OR
  6352       (AMOUNTI = ZEROS  AND
  6353               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6354          MOVE ER-1159            TO  EMI-ERROR
  6355          MOVE -1                 TO  AMOUNTL
  6356          MOVE AL-UNBON           TO  AMOUNTA
  6357          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6358          GO TO 1100-EDIT-COMPLETE.
  6359
  6360     MOVE AMOUNTI                TO  WS-AM-WORK.
  6361
  6362     IF WS-AM-SIGN = SPACES
  6363         MOVE WS-AM-NUM          TO  WS-AMT
  6364         ADD 0                   TO  WS-AMT
  6365       ELSE
  6366         MOVE AMOUNTI            TO  WS-AMT
  6367         ADD 0                   TO  WS-AMT.
  6368
  6369      MOVE WS-AMT                TO  AMOUNTO.
  6370      MOVE AL-UNNON              TO  AMOUNTA.
  6371
  6372 1050-CK-AMT.
  6373     IF AMOUNTL = ZEROS AND
  6374        MAINTI  = 'A'
  6375         MOVE ER-1159            TO  EMI-ERROR
  6376         MOVE -1                 TO  AMOUNTL
  6377         MOVE AL-UNBON           TO  AMOUNTA
  6378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6379
  6380     MOVE AL-UANON              TO  TYPEA.
  6381
  6382     IF TYPEL GREATER THAN ZEROS
  6383         IF TYPEI = 'R' OR 'M' OR 'E'
  6384             NEXT SENTENCE
  6385         ELSE
  6386             MOVE ER-3044    TO  EMI-ERROR
  6387             MOVE -1         TO  TYPEL
  6388             MOVE AL-UABON   TO  TYPEA
  6389             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6390     ELSE
  6391         IF MAINTI  = 'A'
  6392             MOVE ER-3044    TO  EMI-ERROR
  6393             MOVE -1         TO  TYPEL
  6394             MOVE AL-UABON   TO  TYPEA
  6395             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 113
* EL677.cbl
  6396
  6397
  6398 1100-EDIT-COMPLETE.
  6399
  6400     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6401       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6402        EIBAID NOT = DFHPF4)
  6403         GO TO 8200-SEND-DATAONLY.
  6404
  6405     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6406
  6407     IF MAINTI = 'A'
  6408         GO TO 2000-ADD-RECORD.
  6409
  6410*    IF MAINTI = 'C' OR 'V'
  6411     IF MAINTI = 'V'
  6412         GO TO 3000-CHANGE-RECORD.
  6413
  6414     IF MAINTI = 'S' or 'C'
  6415         GO TO 5000-BROWSE-FILE.
  6416
  6417     if mainti = 'D'
  6418        go to 3400-delete-record
  6419     end-if
  6420     .
  6421 1200-VERIFY-CARRIER-ID.
  6422     MOVE SPACES                 TO ELCNTL-KEY.
  6423     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6424     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6425     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6426     MOVE +0                     TO ELCNTL-SEQ.
  6427
  6428
  6429* EXEC CICS HANDLE CONDITION
  6430*        NOTFND   (1290-NO-CARRIER)
  6431*    END-EXEC.
  6432*    MOVE '"$I                   ! $ #00006261' TO DFHEIV0
  6433     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6435     MOVE X'2420233030303036323631' TO DFHEIV0(25:11)
  6436     CALL 'kxdfhei1' USING DFHEIV0
  6437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6438
  6439
  6440
  6441* EXEC CICS READ
  6442*        DATASET   (ELCNTL-FILE-ID)
  6443*        SET       (ADDRESS OF CONTROL-FILE)
  6444*        RIDFLD    (ELCNTL-KEY)
  6445*    END-EXEC.
  6446*    MOVE '&"S        E          (   #00006265' TO DFHEIV0
  6447     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6448     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6449     MOVE X'2020233030303036323635' TO DFHEIV0(25:11)
  6450     CALL 'kxdfhei1' USING DFHEIV0,
  6451           ELCNTL-FILE-ID,
  6452           DFHEIV20,
  6453           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 114
* EL677.cbl
  6454           ELCNTL-KEY,
  6455           DFHEIV99,
  6456           DFHEIV99,
  6457           DFHEIV99
  6458     SET ADDRESS OF CONTROL-FILE TO
  6459         DFHEIV20
  6460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6461
  6462
  6463     GO TO 1200-EXIT.
  6464
  6465 1290-NO-CARRIER.
  6466     MOVE ER-2208                TO EMI-ERROR.
  6467     MOVE -1                     TO CARRIERL.
  6468     MOVE AL-UABON               TO CARRIERA.
  6469     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6470
  6471 1200-EXIT.
  6472      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 115
* EL677.cbl
  6474 1300-VERIFY-STATE-ID.
  6475     MOVE SPACES                 TO ELCNTL-KEY.
  6476     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6477     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6478     MOVE STATEI                 TO ELCNTL-STATE.
  6479     MOVE +0                     TO ELCNTL-SEQ.
  6480
  6481
  6482* EXEC CICS HANDLE CONDITION
  6483*        NOTFND   (1380-NO-STATE)
  6484*    END-EXEC.
  6485*    MOVE '"$I                   ! % #00006289' TO DFHEIV0
  6486     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6488     MOVE X'2520233030303036323839' TO DFHEIV0(25:11)
  6489     CALL 'kxdfhei1' USING DFHEIV0
  6490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6491
  6492
  6493
  6494* EXEC CICS READ
  6495*        DATASET   (ELCNTL-FILE-ID)
  6496*        SET       (ADDRESS OF CONTROL-FILE)
  6497*        RIDFLD    (ELCNTL-KEY)
  6498*    END-EXEC.
  6499*    MOVE '&"S        E          (   #00006293' TO DFHEIV0
  6500     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6502     MOVE X'2020233030303036323933' TO DFHEIV0(25:11)
  6503     CALL 'kxdfhei1' USING DFHEIV0,
  6504           ELCNTL-FILE-ID,
  6505           DFHEIV20,
  6506           DFHEIV99,
  6507           ELCNTL-KEY,
  6508           DFHEIV99,
  6509           DFHEIV99,
  6510           DFHEIV99
  6511     SET ADDRESS OF CONTROL-FILE TO
  6512         DFHEIV20
  6513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6514
  6515
  6516     GO TO 1390-EXIT.
  6517
  6518 1380-NO-STATE.
  6519     MOVE ER-2209                TO EMI-ERROR.
  6520     MOVE -1                     TO STATEL.
  6521     MOVE AL-UABON               TO STATEA.
  6522     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6523
  6524 1390-EXIT.
  6525      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 116
* EL677.cbl
  6527
  6528 1400-VERIFY-ACCOUNT.
  6529     IF EIBAID = DFHPF5
  6530         GO TO 1410-BUILD-ACCOUNT-KEY.
  6531
  6532     IF MAINTL GREATER +0
  6533         NEXT SENTENCE
  6534       ELSE
  6535         GO TO 1490-EXIT.
  6536
  6537*    IF MAINTI = 'A' OR 'C' OR 'V'
  6538     IF MAINTI = 'A' OR 'V'
  6539         NEXT SENTENCE
  6540       ELSE
  6541         GO TO 1490-EXIT.
  6542
  6543 1410-BUILD-ACCOUNT-KEY.
  6544     MOVE CARRIERI               TO ERACCT-CARRIER.
  6545     MOVE GROUPI                 TO ERACCT-GROUPING
  6546     MOVE STATEI                 TO ERACCT-STATE.
  6547     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6548     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6549
  6550     MOVE '2'                    TO DC-OPTION-CODE.
  6551     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6552
  6553     PERFORM 8500-DATE-CONVERT.
  6554     IF DATE-CONVERSION-ERROR
  6555        GO TO 1480-ACCOUNT-INVALID.
  6556
  6557     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6558    .
  6559 1420-get-eracct.
  6560     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6561
  6562
  6563* EXEC CICS HANDLE CONDITION
  6564*        NOTFND   (1480-ACCOUNT-INVALID)
  6565*        ENDFILE  (1480-ACCOUNT-INVALID)
  6566*    END-EXEC.
  6567*    MOVE '"$I''                  ! & #00006345' TO DFHEIV0
  6568     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6570     MOVE X'2620233030303036333435' TO DFHEIV0(25:11)
  6571     CALL 'kxdfhei1' USING DFHEIV0
  6572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6573
  6574
  6575
  6576* EXEC CICS STARTBR
  6577*        DATASET   (ERACCT-FILE-ID)
  6578*        RIDFLD    (ERACCT-KEY)
  6579*    END-EXEC.
  6580     MOVE 0
  6581       TO DFHEIV11
  6582*    MOVE '&,         G          &   #00006350' TO DFHEIV0
  6583     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6584     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 117
* EL677.cbl
  6585     MOVE X'2020233030303036333530' TO DFHEIV0(25:11)
  6586     CALL 'kxdfhei1' USING DFHEIV0,
  6587           ERACCT-FILE-ID,
  6588           ERACCT-KEY,
  6589           DFHEIV99,
  6590           DFHEIV11,
  6591           DFHEIV99
  6592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6593
  6594
  6595     set eracct-start to true
  6596     .
  6597 1420-READNEXT-ACCOUNT-MASTER.
  6598
  6599* EXEC CICS READNEXT
  6600*        DATASET   (ERACCT-FILE-ID)
  6601*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6602*        RIDFLD    (ERACCT-KEY)
  6603*    END-EXEC.
  6604     MOVE 0
  6605       TO DFHEIV11
  6606*    MOVE '&.S                   )   #00006358' TO DFHEIV0
  6607     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6608     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6609     MOVE X'2020233030303036333538' TO DFHEIV0(25:11)
  6610     CALL 'kxdfhei1' USING DFHEIV0,
  6611           ERACCT-FILE-ID,
  6612           DFHEIV20,
  6613           DFHEIV99,
  6614           ERACCT-KEY,
  6615           DFHEIV99,
  6616           DFHEIV11,
  6617           DFHEIV99,
  6618           DFHEIV99
  6619     SET ADDRESS OF ACCOUNT-MASTER TO
  6620         DFHEIV20
  6621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6622
  6623
  6624*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6625*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6626*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6627*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6628*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6629*         GO TO 1480-ACCOUNT-INVALID.
  6630*
  6631*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6632*        GO TO 1480-ACCOUNT-INVALID.
  6633*
  6634*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6635*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6636
  6637     evaluate true
  6638        when (save-eracct-key (1:20) not =
  6639           am-control-primary (1:20))
  6640           and (not eracct-found)
  6641           go to 1480-account-invalid
  6642        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 118
* EL677.cbl
  6643           am-control-primary (1:20))
  6644           and (eracct-found)
  6645           move ws-hold-eracct-record
  6646                                 to account-master
  6647        when (sv-acct-exp-date < am-effective-dt)
  6648           and (not eracct-found)
  6649           go to 1480-account-invalid
  6650        when sv-acct-exp-date >= am-expiration-dt
  6651           go to 1420-readnext-account-master
  6652        when am-expiration-dt = high-values
  6653           continue
  6654        when other
  6655           set eracct-found to true
  6656           move account-master   to ws-hold-eracct-record
  6657           go to 1420-readnext-account-master
  6658     end-evaluate
  6659     if eracct-start
  6660
  6661* exec cics endbr
  6662*          dataset  (eracct-file-id)
  6663*       end-exec
  6664     MOVE 0
  6665       TO DFHEIV11
  6666*    MOVE '&2                    $   #00006400' TO DFHEIV0
  6667     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6668     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6669     MOVE X'2020233030303036343030' TO DFHEIV0(25:11)
  6670     CALL 'kxdfhei1' USING DFHEIV0,
  6671           eracct-file-id,
  6672           DFHEIV11,
  6673           DFHEIV99
  6674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6675     end-if
  6676*    if am-expiration-dt = high-values
  6677*       continue
  6678*    else
  6679*       move account-master      to ws-hold-eracct-record
  6680*       go to 1420-readnext-account-master
  6681*    end-if
  6682     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6683     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6684     MOVE AM-STATE               TO PI-CR-STATE.
  6685     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6686
  6687     MOVE AM-NAME                TO PI-AM-NAME.
  6688     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6689     MOVE AM-CITY                TO PI-AM-CITY-st
  6690     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6691     move am-csr-code            to pi-am-csr
  6692
  6693     MOVE +0                     TO WS-SUB.
  6694
  6695 1430-FIND-ACC-AGT.
  6696     ADD +1                      TO WS-SUB.
  6697
  6698     IF  WS-SUB GREATER +10
  6699         GO TO 1480-ACCOUNT-INVALID.
  6700
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 119
* EL677.cbl
  6701     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F' OR 'S')
  6702         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6703       ELSE
  6704         GO TO 1430-FIND-ACC-AGT.
  6705
  6706     MOVE AL-UANON               TO CARRIERA
  6707                                    GROUPA
  6708                                    STATEA.
  6709
  6710     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6711
  6712     GO TO 1490-EXIT.
  6713
  6714 1480-ACCOUNT-INVALID.
  6715     MOVE -1                     TO CARRIERL
  6716     MOVE AL-UANON               TO CARRIERA
  6717                                    GROUPA
  6718                                    STATEA
  6719                                    ACCTA.
  6720     MOVE ER-2210                TO EMI-ERROR.
  6721     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6722     GO TO 8200-SEND-DATAONLY.
  6723
  6724 1490-EXIT.
  6725      EXIT.
  6726
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 120
* EL677.cbl
  6728 1500-VERIFY-PENDING-BUS-REC.
  6729
  6730* EXEC CICS HANDLE CONDITION
  6731*        NOTFND   (1590-EXIT)
  6732*    END-EXEC.
  6733*    MOVE '"$I                   ! '' #00006457' TO DFHEIV0
  6734     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6736     MOVE X'2720233030303036343537' TO DFHEIV0(25:11)
  6737     CALL 'kxdfhei1' USING DFHEIV0
  6738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6739
  6740
  6741     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6742
  6743     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6744     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6745     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6746     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6747     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6748     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6749     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6750     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6751     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6752     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6753
  6754     IF ST-ACCNT-CNTL  OR
  6755        ACCNT-CNTL
  6756          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6757
  6758     IF ST-ACCNT-CNTL      OR
  6759        CARR-ST-ACCNT-CNTL OR
  6760        ACCNT-CNTL         OR
  6761        CARR-ACCNT-CNTL
  6762          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6763
  6764     IF ACCNT-CNTL OR
  6765        CARR-ACCNT-CNTL
  6766          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6767
  6768
  6769* EXEC CICS READ
  6770*         DATASET   (ERPNDB-ALT-FILE-ID)
  6771*         SET       (ADDRESS OF PENDING-BUSINESS)
  6772*         RIDFLD    (ERPNDB-ALT-KEY)
  6773*     END-EXEC.
  6774*    MOVE '&"S        E          (   #00006488' TO DFHEIV0
  6775     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6776     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6777     MOVE X'2020233030303036343838' TO DFHEIV0(25:11)
  6778     CALL 'kxdfhei1' USING DFHEIV0,
  6779           ERPNDB-ALT-FILE-ID,
  6780           DFHEIV20,
  6781           DFHEIV99,
  6782           ERPNDB-ALT-KEY,
  6783           DFHEIV99,
  6784           DFHEIV99,
  6785           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 121
* EL677.cbl
  6786     SET ADDRESS OF PENDING-BUSINESS TO
  6787         DFHEIV20
  6788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6789
  6790
  6791     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6792
  6793     IF PB-C-PAYEE-CODE GREATER SPACES
  6794        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6795
  6796     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6797*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6798
  6799     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6800     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6801
  6802     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6803         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6804     ELSE
  6805         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6806
  6807     IF MAINTI = 'A' OR 'C'
  6808       IF PB-C-REFUND-CREATED
  6809           MOVE -1               TO  MAINTL
  6810           MOVE ER-3445          TO  EMI-ERROR
  6811           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6812
  6813 1590-EXIT.
  6814      EXIT.
  6815
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 122
* EL677.cbl
  6817 2000-ADD-RECORD.
  6818
  6819* EXEC CICS GETMAIN
  6820*        SET      (ADDRESS OF CHECK-RECORDS)
  6821*        LENGTH   (600)
  6822*        INITIMG  (GETMAIN-SPACE)
  6823*    END-EXEC.
  6824     MOVE 600
  6825       TO DFHEIV11
  6826*    MOVE ',"IL                  $   #00006521' TO DFHEIV0
  6827     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6828     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6829     MOVE X'2020233030303036353231' TO DFHEIV0(25:11)
  6830     CALL 'kxdfhei1' USING DFHEIV0,
  6831           DFHEIV20,
  6832           DFHEIV11,
  6833           GETMAIN-SPACE
  6834     SET ADDRESS OF CHECK-RECORDS TO
  6835         DFHEIV20
  6836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6837
  6838
  6839     MOVE 'CH'                   TO CH-RECORD-ID.
  6840     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6841     MOVE CARRIERI               TO CH-CARRIER.
  6842     MOVE GROUPI                 TO CH-GROUPING.
  6843     MOVE STATEI                 TO CH-STATE.
  6844     MOVE ACCTI                  TO CH-ACCOUNT.
  6845
  6846     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6847     MOVE '2'                    TO DC-OPTION-CODE.
  6848     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6849     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6850
  6851     MOVE CERTNOI                TO CH-CERT-PRIME.
  6852     MOVE SFXI                   TO CH-CERT-SFX.
  6853
  6854     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6855
  6856     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6857                                    ch-released-by
  6858     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6859
  6860     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6861     MOVE '5'                    TO DC-OPTION-CODE.
  6862     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6863     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6864                                    ch-released-dt
  6865
  6866     move 'P'                    to ch-approval-status
  6867
  6868     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6869                                    CH-VOID-DT
  6870                                    CH-CREDIT-ACCEPT-DT
  6871                                    CH-CANC-DT
  6872                                    ch-approval-dt
  6873                                    ch-check-cashed-dt
  6874     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 123
* EL677.cbl
  6875                                    CH-AH-REFUND
  6876*                                   CH-DEDUCT-WITHHELD
  6877*                                   CH-ADDITIONAL-CHARGE.
  6878
  6879     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  6880
  6881     if pi-prev-paid not numeric
  6882        move zeros               to pi-prev-paid
  6883     end-if
  6884     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6885       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6886        EIBAID NOT = DFHPF4)
  6887         GO TO 8200-SEND-DATAONLY.
  6888
  6889     add ch-amount-paid to pi-prev-paid
  6890     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  6891     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  6892     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  6893     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  6894     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  6895     move pi-am-csr              to ch-csr
  6896     .
  6897 2100-WRITE-RECORD.
  6898
  6899* exec cics read
  6900*       dataset    (erchek-file-id)
  6901*       into       (ws-dummy-erchek)
  6902*       ridfld     (ch-control-primary)
  6903*       resp       (ws-response)
  6904*    end-exec
  6905     MOVE LENGTH OF
  6906      ws-dummy-erchek
  6907       TO DFHEIV11
  6908*    MOVE '&"IL       E          (  N#00006586' TO DFHEIV0
  6909     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6911     MOVE X'204E233030303036353836' TO DFHEIV0(25:11)
  6912     CALL 'kxdfhei1' USING DFHEIV0,
  6913           erchek-file-id,
  6914           ws-dummy-erchek,
  6915           DFHEIV11,
  6916           ch-control-primary,
  6917           DFHEIV99,
  6918           DFHEIV99,
  6919           DFHEIV99
  6920     MOVE EIBRESP  TO ws-response
  6921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6922     if RESP-NOTFND
  6923        continue
  6924     else
  6925        add +1 to ch-sequence-no
  6926        add 1 to seqi
  6927        go to 2100-write-record
  6928     end-if
  6929     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
  6930
  6931* EXEC CICS HANDLE CONDITION
  6932*        DUPREC (2200-DUPREC)
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 124
* EL677.cbl
  6933*    END-EXEC.
  6934*    MOVE '"$%                   ! ( #00006600' TO DFHEIV0
  6935     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6937     MOVE X'2820233030303036363030' TO DFHEIV0(25:11)
  6938     CALL 'kxdfhei1' USING DFHEIV0
  6939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6940
  6941
  6942     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  6943     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  6944                                    CH-CHECK-QUE-SEQUENCE
  6945
  6946
  6947* EXEC CICS WRITE
  6948*        DATASET  (ERCHEK-FILE-ID)
  6949*        FROM     (CHECK-RECORDS)
  6950*        RIDFLD   (CH-CONTROL-PRIMARY)
  6951*    END-EXEC.
  6952     MOVE LENGTH OF
  6953      CHECK-RECORDS
  6954       TO DFHEIV11
  6955*    MOVE '&$ L                  ''   #00006608' TO DFHEIV0
  6956     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6957     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6958     MOVE X'2020233030303036363038' TO DFHEIV0(25:11)
  6959     CALL 'kxdfhei1' USING DFHEIV0,
  6960           ERCHEK-FILE-ID,
  6961           CHECK-RECORDS,
  6962           DFHEIV11,
  6963           CH-CONTROL-PRIMARY,
  6964           DFHEIV99,
  6965           DFHEIV99
  6966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6967
  6968
  6969     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  6970             ERCHEK-RECORD-LENGTH + 23.
  6971
  6972     PERFORM 6200-UPDATE-PENDING-BUS-REC THRU 6200-EXIT.
  6973     if resp-normal
  6974        MOVE 'Y'                 TO PB-C-REFUND-SW
  6975        add +1 to pi-chek-rec-cnt
  6976        perform 6210-rewrite-pndb thru 6210-exit
  6977*       PERFORM 2700-WRITE-SQL   THRU 2700-EXIT
  6978     end-if
  6979*    PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.
  6980
  6981     IF EMI-NO-ERRORS
  6982         MOVE ER-0000            TO EMI-ERROR
  6983     ELSE
  6984         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  6985            EIBAID = DFHPF4
  6986             MOVE ER-2600        TO EMI-ERROR.
  6987
  6988     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6989
  6990     MOVE LOW-VALUES             TO EL677AI.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 125
* EL677.cbl
  6991
  6992     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  6993     MOVE PI-CHEK-GROUPING       TO GROUPO.
  6994     MOVE PI-CHEK-STATE          TO STATEO.
  6995     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  6996
  6997     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  6998     MOVE SPACE                  TO DC-OPTION-CODE.
  6999     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7000     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7001
  7002     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7003     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7004     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7005
  7006     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7007                                    ACCTA     EFFDTA  CERTNOA
  7008                                    SFXA.
  7009     MOVE AL-UNNON               TO SEQA.
  7010     go to 5000-browse-file
  7011     GO TO 8100-SEND-INITIAL-MAP.
  7012
  7013 2200-DUPREC.
  7014     ADD +1 TO CH-SEQUENCE-NO.
  7015     MOVE CH-SEQUENCE-NO         TO SEQO
  7016                                    PI-CHEK-SEQUENCE
  7017                                    CHEK-RECORD-SEQ.
  7018     GO TO 2100-WRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 126
* EL677.cbl
  7020
  7021 2500-WRITE-PAY-ADJ.
  7022
  7023     PERFORM 2600-READ-CONTROL-FILE THRU 2600-EXIT.
  7024
  7025     IF CH-AMOUNT-PAID = ZEROS
  7026         GO TO 2510-CONTINUE.
  7027     PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.
  7028     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  7029
  7030 2510-CONTINUE.
  7031
  7032     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  7033         GO TO 2580-HANDLE-ELCNTL-FILE.
  7034
  7035 2550-BUILD-ERPYAJ-RECORD.
  7036
  7037
  7038* EXEC CICS GETMAIN
  7039*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7040*        LENGTH  (200)
  7041*        INITIMG (GETMAIN-SPACE)
  7042*    END-EXEC.
  7043     MOVE 200
  7044       TO DFHEIV11
  7045*    MOVE ',"IL                  $   #00006682' TO DFHEIV0
  7046     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7047     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7048     MOVE X'2020233030303036363832' TO DFHEIV0(25:11)
  7049     CALL 'kxdfhei1' USING DFHEIV0,
  7050           DFHEIV20,
  7051           DFHEIV11,
  7052           GETMAIN-SPACE
  7053     SET ADDRESS OF PENDING-PAY-ADJ TO
  7054         DFHEIV20
  7055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7056
  7057
  7058     MOVE SPACES                 TO PENDING-PAY-ADJ.
  7059     MOVE 'PY'                   TO PY-RECORD-ID.
  7060     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7061
  7062     MOVE CARRIERI               TO PY-CARRIER.
  7063     IF PI-ZERO-CARRIER  OR
  7064        PI-ZERO-CAR-GROUP
  7065         MOVE ZERO               TO PY-CARRIER.
  7066
  7067     MOVE GROUPI                 TO PY-GROUPING.
  7068     IF PI-ZERO-GROUPING  OR
  7069        PI-ZERO-CAR-GROUP
  7070         MOVE ZERO               TO PY-GROUPING.
  7071
  7072     MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.
  7073     MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.
  7074     MOVE 'C'                    TO PY-RECORD-TYPE.
  7075     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7076
  7077     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 127
* EL677.cbl
  7078                                    WS-PY-REF-DATE
  7079                                    WS-PY-END-DATE
  7080                                    WS-PY-DED-DATE
  7081                                    WS-PY-ADDL-DATE.
  7082     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7083     MOVE CERTNOI                TO WS-PY-CURRENT-CERT
  7084                                    WS-PY-REF-CERT
  7085                                    WS-PY-END-CERT
  7086                                    WS-PY-DED-CERT
  7087                                    WS-PY-ADDL-CERT
  7088                                    WS-TMS-PY-CERT.
  7089     IF SFXI NOT = LOW-VALUES
  7090         MOVE SFXI               TO WS-PY-CURRENT-SUFFIX
  7091                                    WS-PY-REF-SUFFIX
  7092                                    WS-PY-END-SUFFIX
  7093                                    WS-PY-DED-SUFFIX
  7094                                    WS-PY-ADDL-SUFFIX
  7095     ELSE
  7096         MOVE SPACE              TO WS-PY-CURRENT-SUFFIX
  7097                                    WS-PY-REF-SUFFIX
  7098                                    WS-PY-END-SUFFIX
  7099                                    WS-PY-DED-SUFFIX
  7100                                    WS-PY-ADDL-SUFFIX.
  7101
  7102     IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'
  7103         MOVE WS-TMS-ENTRY-COMMENT
  7104                                 TO PY-ENTRY-COMMENT
  7105     ELSE
  7106         IF TYPEI EQUAL 'R'
  7107             MOVE WS-PY-REF-COMMENT
  7108                                 TO PY-ENTRY-COMMENT
  7109         ELSE
  7110             IF TYPEI EQUAL 'E'
  7111                 MOVE WS-PY-END-COMMENT
  7112                                 TO PY-ENTRY-COMMENT
  7113             ELSE
  7114                 MOVE WS-PY-ENTRY-COMMENT
  7115                                 TO PY-ENTRY-COMMENT.
  7116
  7117     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.
  7118
  7119     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7120     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7121     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7122                                    PY-INPUT-DT.
  7123*    MOVE +0                     TO PY-CHECK-QUE-CONTROL
  7124*                                   PY-CHECK-QUE-SEQUENCE.
  7125     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7126                                    PY-REPORTED-DT
  7127                                    PY-CHECK-WRITTEN-DT
  7128                                    PY-BILLED-DATE
  7129                                    PY-AR-DATE
  7130                                    PY-GL-DATE.
  7131     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7132     MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.
  7133*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7134
  7135     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 128
* EL677.cbl
  7136         MOVE 'B'                TO PY-PYMT-TYPE
  7137         MOVE 'A'                TO PY-PMT-APPLIED.
  7138
  7139 2559-BUILD-EXIT.
  7140     EXIT.
  7141
  7142 2570-WRITE-ERPYAJ-RECORD.
  7143
  7144
  7145* EXEC CICS HANDLE CONDITION
  7146*        DUPREC (2577-DUPREC)
  7147*    END-EXEC.
  7148*    MOVE '"$%                   ! ) #00006774' TO DFHEIV0
  7149     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7150     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7151     MOVE X'2920233030303036373734' TO DFHEIV0(25:11)
  7152     CALL 'kxdfhei1' USING DFHEIV0
  7153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7154
  7155
  7156
  7157* EXEC CICS WRITE
  7158*        DATASET (ERPYAJ-FILE-ID)
  7159*        FROM    (PENDING-PAY-ADJ)
  7160*        RIDFLD  (PY-CONTROL-PRIMARY)
  7161*    END-EXEC.
  7162     MOVE LENGTH OF
  7163      PENDING-PAY-ADJ
  7164       TO DFHEIV11
  7165*    MOVE '&$ L                  ''   #00006778' TO DFHEIV0
  7166     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7167     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7168     MOVE X'2020233030303036373738' TO DFHEIV0(25:11)
  7169     CALL 'kxdfhei1' USING DFHEIV0,
  7170           ERPYAJ-FILE-ID,
  7171           PENDING-PAY-ADJ,
  7172           DFHEIV11,
  7173           PY-CONTROL-PRIMARY,
  7174           DFHEIV99,
  7175           DFHEIV99
  7176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7177
  7178
  7179     GO TO 2579-WRITE-EXIT.
  7180
  7181 2577-DUPREC.
  7182     ADD +1 TO PY-FILE-SEQ-NO.
  7183
  7184     GO TO 2570-WRITE-ERPYAJ-RECORD.
  7185
  7186 2579-WRITE-EXIT.
  7187     EXIT.
  7188
  7189 2580-HANDLE-ELCNTL-FILE.
  7190
  7191     IF CR-CHECK-NO-AUTO-SEQ
  7192         PERFORM 2650-REWRITE-CONTROL-FILE THRU 2650-EXIT
  7193     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 129
* EL677.cbl
  7194
  7195* EXEC CICS UNLOCK
  7196*            DATASET (ELCNTL-FILE-ID)
  7197*        END-EXEC.
  7198*    MOVE '&*                    #   #00006799' TO DFHEIV0
  7199     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7200     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7201     MOVE X'2020233030303036373939' TO DFHEIV0(25:11)
  7202     CALL 'kxdfhei1' USING DFHEIV0,
  7203           ELCNTL-FILE-ID,
  7204           DFHEIV99
  7205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7206
  7207
  7208 2590-EXIT.
  7209      EXIT.
  7210
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 130
* EL677.cbl
  7212
  7213 2600-READ-CONTROL-FILE.
  7214     MOVE SPACES                 TO ELCNTL-KEY.
  7215     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  7216     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7217     MOVE +0                     TO ELCNTL-SEQ.
  7218
  7219
  7220* EXEC CICS HANDLE CONDITION
  7221*        NOTFND   (2600-NO-CO-MASTER)
  7222*    END-EXEC.
  7223*    MOVE '"$I                   ! * #00006814' TO DFHEIV0
  7224     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7225     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7226     MOVE X'2A20233030303036383134' TO DFHEIV0(25:11)
  7227     CALL 'kxdfhei1' USING DFHEIV0
  7228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7229
  7230
  7231
  7232* EXEC CICS READ
  7233*        DATASET   (ELCNTL-FILE-ID)
  7234*        SET       (ADDRESS OF CONTROL-FILE)
  7235*        RIDFLD    (ELCNTL-KEY)
  7236*    END-EXEC.
  7237*    MOVE '&"S        E          (   #00006818' TO DFHEIV0
  7238     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7240     MOVE X'2020233030303036383138' TO DFHEIV0(25:11)
  7241     CALL 'kxdfhei1' USING DFHEIV0,
  7242           ELCNTL-FILE-ID,
  7243           DFHEIV20,
  7244           DFHEIV99,
  7245           ELCNTL-KEY,
  7246           DFHEIV99,
  7247           DFHEIV99,
  7248           DFHEIV99
  7249     SET ADDRESS OF CONTROL-FILE TO
  7250         DFHEIV20
  7251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7252
  7253
  7254     GO TO 2600-EXIT
  7255
  7256     .
  7257 2600-NO-CO-MASTER.
  7258     MOVE ER-0022                TO  EMI-ERROR.
  7259     MOVE -1                     TO  CARRIERL.
  7260     MOVE AL-UABON               TO  CARRIERA.
  7261     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7262
  7263 2600-EXIT.
  7264      EXIT.
  7265
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 131
* EL677.cbl
  7267 2650-REWRITE-CONTROL-FILE.
  7268
  7269* EXEC CICS READ
  7270*        DATASET   (ELCNTL-FILE-ID)
  7271*        SET       (ADDRESS OF CONTROL-FILE)
  7272*        RIDFLD    (ELCNTL-KEY)
  7273*        UPDATE
  7274*    END-EXEC.
  7275*    MOVE '&"S        EU         (   #00006838' TO DFHEIV0
  7276     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7277     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7278     MOVE X'2020233030303036383338' TO DFHEIV0(25:11)
  7279     CALL 'kxdfhei1' USING DFHEIV0,
  7280           ELCNTL-FILE-ID,
  7281           DFHEIV20,
  7282           DFHEIV99,
  7283           ELCNTL-KEY,
  7284           DFHEIV99,
  7285           DFHEIV99,
  7286           DFHEIV99
  7287     SET ADDRESS OF CONTROL-FILE TO
  7288         DFHEIV20
  7289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7290
  7291
  7292
  7293* EXEC CICS REWRITE
  7294*         DATASET (ELCNTL-FILE-ID)
  7295*         FROM    (CONTROL-FILE)
  7296*     END-EXEC.
  7297     MOVE LENGTH OF
  7298      CONTROL-FILE
  7299       TO DFHEIV11
  7300*    MOVE '&& L                  %   #00006845' TO DFHEIV0
  7301     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7302     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7303     MOVE X'2020233030303036383435' TO DFHEIV0(25:11)
  7304     CALL 'kxdfhei1' USING DFHEIV0,
  7305           ELCNTL-FILE-ID,
  7306           CONTROL-FILE,
  7307           DFHEIV11,
  7308           DFHEIV99
  7309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7310
  7311
  7312 2650-EXIT.
  7313      EXIT.
  7314 2700-WRITE-SQL.
  7315     perform 2710-build-rec      thru 2710-exit
  7316     perform 2720-insert-row     thru 2720-exit
  7317     perform 4300-FINISH-UP-DB   thru 4300-exit
  7318     .
  7319 2700-EXIT.
  7320     EXIT.
  7321 2710-BUILD-REC.
  7322     move spaces                 to daily-check-request-rec
  7323     move pi-company-id          to db-compid
  7324     move ch-carrier             to db-carrier
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 132
* EL677.cbl
  7325                                    db-fincar
  7326     move ch-grouping            to db-grouping
  7327                                    db-fingrp
  7328     move ch-state               to db-state
  7329     move ch-account             to db-account
  7330     move ch-cert-eff-dt         to dc-bin-date-1
  7331     move ' '                    to dc-option-code
  7332     perform 8500-date-convert   thru 8500-exit
  7333     if no-conversion-error
  7334        move dc-greg-date-a-edit to db-effdate
  7335     else
  7336        move spaces              to db-effdate
  7337     end-if
  7338     move ch-cert-prime          to db-certificate
  7339     move ch-cert-sfx            to db-cert-sfx
  7340     move ch-sequence-no         to db-seq-no
  7341     move '1'                    to db-type
  7342     move ch-amount-paid         to db-amount-n
  7343     move zeros                  to db-checkstatus
  7344     move ch-check-que-control   to db-releasebatch
  7345     move save-bin-date          to dc-bin-date-1
  7346     move ' '                    to dc-option-code
  7347     perform 8500-date-convert   thru 8500-exit
  7348     if no-conversion-error
  7349        move dc-greg-date-a-edit to db-releasedt
  7350     else
  7351        move spaces              to db-releasedt
  7352     end-if
  7353     move pi-processor-id        to db-releaseby
  7354     move ch-payee-name-1        to db-payeename1
  7355     move ch-payee-name-2        to db-payeename2
  7356     move ch-payee-address-1     to db-payeeaddr1
  7357     move ch-payee-address-2     to db-payeeaddr2
  7358     move ch-payee-city          to db-payeecity
  7359     move ch-payee-state         to db-payeest
  7360     move ch-payee-zip-code      to db-payeezip
  7361     move ch-comp-fin-resp       to db-finresp
  7362     move ch-comp-account        to db-finacct
  7363     move ch-recorded-by         to db-preparer
  7364     move ch-return-to           to db-return-to
  7365     move pi-table-name          to db-insured-name
  7366     .
  7367 2710-EXIT.
  7368     EXIT.
  7369 2720-INSERT-ROW.
  7370     if not connected-to-db
  7371        perform 4100-CONNECT-TO-DB
  7372                                 thru 4100-exit
  7373     end-if
  7374     EXEC SQL
  7375        INSERT into ChkApp_Check (
  7376           Company,
  7377           CertCarrier,
  7378           CertGroup,
  7379           CertState,
  7380           CertAccount,
  7381           CertEffDate,
  7382           CertNumber,
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 133
* EL677.cbl
  7383           CertNumberSuf,
  7384           CheckSeqNbr,
  7385           CheckType,
  7386           CheckAmount,
  7387           ReleaseBatchNbr,
  7388           ReleaseDate,
  7389           ReleasedBy,
  7390           PayeeName1,
  7391           PayeeName2,
  7392           PayeeAddress1,
  7393           PayeeAddress2,
  7394           PayeeCity,
  7395           PayeeState,
  7396           PayeeZip,
  7397           CompCarrier,
  7398           CompGroup,
  7399           CompFinResp,
  7400           CompAccount,
  7401           Preparer,
  7402           ReturnTo,
  7403           InsuredName)
  7404         VALUES (
  7405           :DB-CompId,
  7406           :DB-Carrier,
  7407           :DB-Grouping,
  7408           :DB-State,
  7409           :DB-Account,
  7410           :DB-EffDate,
  7411           :DB-Certificate,
  7412           :db-cert-sfx,
  7413           :DB-Seq-No,
  7414           :DB-Type,
  7415           :db-amount,
  7416           :db-releasebatch,
  7417           :db-releasedt,
  7418           :db-releaseby,
  7419           :db-payeename1,
  7420           :db-payeename2,
  7421           :db-payeeaddr1,
  7422           :db-payeeaddr2,
  7423           :db-payeecity,
  7424           :db-payeest,
  7425           :db-payeezip,
  7426           :db-fincar,
  7427           :db-fingrp,
  7428           :db-finresp,
  7429           :db-finacct,
  7430           :db-preparer,
  7431           :db-return-to,
  7432           :db-insured-name)
  7433     END-EXEC
  7434     if sqlcode = -2601
  7435        add +1                   to ch-sequence-no
  7436        move ch-sequence-no      to DB-Seq-No
  7437        go to 2720-insert-row
  7438     end-if
  7439     if sqlcode not = 0
  7440        display "Error: cannot insert row "
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 134
* EL677.cbl
  7441        display ' sql return code ' sqlcode
  7442        move sqlcode to ws-sql-code
  7443        move ws-sql-code to ws-dis-sql-code
  7444        display ' dis sql code ' ws-dis-sql-code
  7445        display ' sql err mess    ' sqlerrmc
  7446        move sqlcode to ws-sql-code
  7447        move ws-sql-code to ws-dis-sql-code
  7448        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7449           into EMI-MESSAGE-AREA (1)
  7450        end-string
  7451        display ' msga1 ' emi-message-area (1)
  7452        perform 4300-FINISH-UP-DB thru 4300-exit
  7453        go to 8200-send-dataonly
  7454*       goback
  7455     end-if
  7456     .
  7457 2720-EXIT.
  7458     EXIT.
  7459 3000-CHANGE-RECORD.
  7460
  7461* EXEC CICS HANDLE CONDITION
  7462*        NOTFND (3900-RECORD-NOTFND)
  7463*    END-EXEC.
  7464*    MOVE '"$I                   ! + #00006998' TO DFHEIV0
  7465     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7466     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7467     MOVE X'2B20233030303036393938' TO DFHEIV0(25:11)
  7468     CALL 'kxdfhei1' USING DFHEIV0
  7469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7470
  7471
  7472
  7473* EXEC CICS READ
  7474*        DATASET  (ERCHEK-FILE-ID)
  7475*        SET      (ADDRESS OF CHECK-RECORDS)
  7476*        RIDFLD   (PI-ERCHEK-KEY)
  7477*        UPDATE
  7478*    END-EXEC.
  7479*    MOVE '&"S        EU         (   #00007002' TO DFHEIV0
  7480     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7481     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7482     MOVE X'2020233030303037303032' TO DFHEIV0(25:11)
  7483     CALL 'kxdfhei1' USING DFHEIV0,
  7484           ERCHEK-FILE-ID,
  7485           DFHEIV20,
  7486           DFHEIV99,
  7487           PI-ERCHEK-KEY,
  7488           DFHEIV99,
  7489           DFHEIV99,
  7490           DFHEIV99
  7491     SET ADDRESS OF CHECK-RECORDS TO
  7492         DFHEIV20
  7493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7494
  7495
  7496     IF CH-LF-REFUND NOT NUMERIC
  7497         MOVE ZEROS              TO CH-LF-REFUND.
  7498     IF CH-AH-REFUND NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 135
* EL677.cbl
  7499         MOVE ZEROS              TO CH-AH-REFUND.
  7500*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7501*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7502*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7503*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7504
  7505     IF VREASONL NOT = ZEROS
  7506         MOVE VREASONI           TO  CH-VOID-REASON.
  7507
  7508     IF MAINTI = 'V'
  7509        GO TO 3050-void-processing
  7510     end-if
  7511
  7512     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7513
  7514     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7515
  7516     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7517       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7518        EIBAID NOT = DFHPF4)
  7519         GO TO 8200-SEND-DATAONLY.
  7520     go to 3100-rewrite-record
  7521     .
  7522 3050-void-processing.
  7523     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7524     if sqlcode = 0
  7525        perform 4200-get-tbl-row thru 4200-exit
  7526        if sqlcode = 0
  7527           if nu-app-date = -1
  7528              move -1            to maintl
  7529              move er-3453       to emi-error
  7530              move al-uabon      to mainta
  7531              perform 9900-error-format
  7532                                 thru 9900-exit
  7533              perform 4300-FINISH-UP-DB thru 4300-exit
  7534              go to 8200-send-dataonly
  7535           end-if
  7536        end-if
  7537        if connected-to-db
  7538           perform 4300-FINISH-UP-DB thru 4300-exit
  7539        end-if
  7540     end-if
  7541     if (ch-check-written-dt = low-values)
  7542        or (ch-check-no = spaces)
  7543        move -1                  to maintl
  7544        move er-3455             to emi-error
  7545        move al-uabon            to mainta
  7546        perform 9900-error-format
  7547                                 thru 9900-exit
  7548        perform 4300-FINISH-UP-DB thru 4300-exit
  7549        go to 8200-send-dataonly
  7550     end-if
  7551     .
  7552 3100-REWRITE-RECORD.
  7553     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7554
  7555     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7556     MOVE '5'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 136
* EL677.cbl
  7557     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7558
  7559     IF MAINTI = 'C'
  7560       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7561     end-if
  7562*      IF MANUAL-CHECK-WRITTEN
  7563*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.
  7564
  7565     IF MAINTI = 'V'
  7566        IF (CH-VOID-DT = LOW-VALUES)
  7567           and (pi-check-cashed = spaces)
  7568           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7569           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7570*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT
  7571           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7572           if pi-chek-rec-cnt = +1
  7573              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7574                                 THRU 6200-EXIT
  7575              if resp-normal
  7576                 MOVE ' '        TO PB-C-REFUND-SW
  7577                 perform 6210-rewrite-pndb
  7578                                 thru 6210-exit
  7579              end-if
  7580           end-if
  7581        ELSE
  7582           MOVE -1               TO MAINTL
  7583           MOVE ER-2583          TO EMI-ERROR
  7584           MOVE AL-UABON         TO MAINTA
  7585           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7586           GO TO 8200-SEND-DATAONLY
  7587        end-if
  7588     end-if
  7589
  7590     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7591
  7592
  7593* EXEC CICS REWRITE
  7594*        DATASET  (ERCHEK-FILE-ID)
  7595*        FROM     (CHECK-RECORDS)
  7596*    END-EXEC.
  7597     MOVE LENGTH OF
  7598      CHECK-RECORDS
  7599       TO DFHEIV11
  7600*    MOVE '&& L                  %   #00007105' TO DFHEIV0
  7601     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7602     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7603     MOVE X'2020233030303037313035' TO DFHEIV0(25:11)
  7604     CALL 'kxdfhei1' USING DFHEIV0,
  7605           ERCHEK-FILE-ID,
  7606           CHECK-RECORDS,
  7607           DFHEIV11,
  7608           DFHEIV99
  7609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7610
  7611
  7612     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7613        (MAINTI EQUAL 'C')          AND
  7614        (PI-PAYTO1 NOT EQUAL PAYTO1I)
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 137
* EL677.cbl
  7615            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7616
  7617     IF EMI-NO-ERRORS
  7618         MOVE ER-0000            TO EMI-ERROR
  7619     ELSE
  7620         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7621            EIBAID = DFHPF4
  7622             MOVE ER-2600        TO EMI-ERROR.
  7623
  7624     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7625
  7626     MOVE LOW-VALUES             TO EL677AI.
  7627
  7628     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7629     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7630     MOVE PI-CHEK-STATE          TO STATEO.
  7631     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7632
  7633     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7634     MOVE SPACE                  TO DC-OPTION-CODE.
  7635     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7636     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7637
  7638     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7639     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7640     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7641
  7642     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7643                                     ACCTA   EFFDTA
  7644                                    CERTNOA   SFXA.
  7645
  7646     MOVE AL-UNNON               TO SEQA.
  7647     go to 5000-browse-file
  7648*    GO TO 8100-SEND-INITIAL-MAP.
  7649
  7650     .
  7651 3200-PAY-ADJS-REVERSAL.
  7652
  7653     IF CH-AMOUNT-PAID NOT = ZEROS
  7654         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7655         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7656
  7657     GO TO 3290-EXIT
  7658     .
  7659 3250-BUILD-ERPYAJ-REVERSAL.
  7660
  7661
  7662* EXEC CICS GETMAIN
  7663*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7664*        LENGTH  (200)
  7665*        INITIMG (GETMAIN-SPACE)
  7666*    END-EXEC.
  7667     MOVE 200
  7668       TO DFHEIV11
  7669*    MOVE ',"IL                  $   #00007159' TO DFHEIV0
  7670     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7671     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7672     MOVE X'2020233030303037313539' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 138
* EL677.cbl
  7673     CALL 'kxdfhei1' USING DFHEIV0,
  7674           DFHEIV20,
  7675           DFHEIV11,
  7676           GETMAIN-SPACE
  7677     SET ADDRESS OF PENDING-PAY-ADJ TO
  7678         DFHEIV20
  7679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7680
  7681
  7682     MOVE 'PY'                   TO PY-RECORD-ID.
  7683     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7684
  7685     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7686     IF PI-ZERO-CARRIER  OR
  7687        PI-ZERO-CAR-GROUP
  7688         MOVE ZERO               TO PY-CARRIER.
  7689
  7690     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7691     IF PI-ZERO-GROUPING  OR
  7692        PI-ZERO-CAR-GROUP
  7693         MOVE ZERO               TO PY-GROUPING.
  7694
  7695     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7696     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7697     MOVE 'R'                    TO PY-RECORD-TYPE.
  7698     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7699     move '1825011300'           to py-gl-account
  7700     move 'VOID REFCK'           TO py-gl-comment
  7701     move ch-amount-paid         to py-entry-amt
  7702*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7703
  7704     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7705     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7706
  7707     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7708     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7709     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7710                                    PY-INPUT-DT.
  7711*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7712*                                   PY-CHECK-QUE-SEQUENCE.
  7713     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7714                                    PY-BILLED-DATE
  7715                                    PY-REPORTED-DT
  7716                                    PY-CHECK-WRITTEN-DT
  7717                                    PY-AR-DATE
  7718                                    PY-GL-DATE.
  7719     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7720     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7721*    MOVE 'V'                    TO PY-VOID-SW.
  7722*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7723
  7724     IF PI-AR-PROCESSING
  7725         MOVE 'B'                TO PY-PYMT-TYPE
  7726         MOVE 'A'                TO PY-PMT-APPLIED.
  7727
  7728 3259-BUILD-EXIT.
  7729     EXIT.
  7730
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 139
* EL677.cbl
  7731 3280-WRITE-ERPYAJ-REVERSAL.
  7732
  7733
  7734* EXEC CICS HANDLE CONDITION
  7735*        DUPREC (3287-DUPREC)
  7736*    END-EXEC.
  7737*    MOVE '"$%                   ! , #00007216' TO DFHEIV0
  7738     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7739     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7740     MOVE X'2C20233030303037323136' TO DFHEIV0(25:11)
  7741     CALL 'kxdfhei1' USING DFHEIV0
  7742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7743
  7744
  7745
  7746* EXEC CICS WRITE
  7747*        DATASET (ERPYAJ-FILE-ID)
  7748*        FROM    (PENDING-PAY-ADJ)
  7749*        RIDFLD  (PY-CONTROL-PRIMARY)
  7750*    END-EXEC.
  7751     MOVE LENGTH OF
  7752      PENDING-PAY-ADJ
  7753       TO DFHEIV11
  7754*    MOVE '&$ L                  ''   #00007220' TO DFHEIV0
  7755     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7756     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7757     MOVE X'2020233030303037323230' TO DFHEIV0(25:11)
  7758     CALL 'kxdfhei1' USING DFHEIV0,
  7759           ERPYAJ-FILE-ID,
  7760           PENDING-PAY-ADJ,
  7761           DFHEIV11,
  7762           PY-CONTROL-PRIMARY,
  7763           DFHEIV99,
  7764           DFHEIV99
  7765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7766
  7767
  7768     GO TO 3289-WRITE-EXIT.
  7769
  7770 3287-DUPREC.
  7771     ADD +1 TO PY-FILE-SEQ-NO.
  7772
  7773     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7774
  7775 3289-WRITE-EXIT.
  7776     EXIT.
  7777
  7778 3290-EXIT.
  7779      EXIT.
  7780
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 140
* EL677.cbl
  7782 3300-UPDATE-ERPYAJ.
  7783
  7784
  7785* EXEC CICS GETMAIN
  7786*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7787*        LENGTH  (200)
  7788*        INITIMG (GETMAIN-SPACE)
  7789*    END-EXEC.
  7790     MOVE 200
  7791       TO DFHEIV11
  7792*    MOVE ',"IL                  $   #00007242' TO DFHEIV0
  7793     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7794     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7795     MOVE X'2020233030303037323432' TO DFHEIV0(25:11)
  7796     CALL 'kxdfhei1' USING DFHEIV0,
  7797           DFHEIV20,
  7798           DFHEIV11,
  7799           GETMAIN-SPACE
  7800     SET ADDRESS OF PENDING-PAY-ADJ TO
  7801         DFHEIV20
  7802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7803
  7804
  7805     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7806     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7807     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7808     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7809     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7810     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7811     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7812
  7813
  7814* EXEC CICS HANDLE CONDITION
  7815*        NOTFND   (3390-EXIT)
  7816*        ENDFILE  (3390-EXIT)
  7817*    END-EXEC.
  7818*    MOVE '"$I''                  ! - #00007256' TO DFHEIV0
  7819     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7821     MOVE X'2D20233030303037323536' TO DFHEIV0(25:11)
  7822     CALL 'kxdfhei1' USING DFHEIV0
  7823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7824
  7825
  7826 3320-READNEXT-ERPYAJ.
  7827
  7828
  7829* EXEC CICS READ
  7830*        DATASET  (ERPYAJ-FILE-ID)
  7831*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7832*        RIDFLD   (ERPYAJ-KEY)
  7833*        GTEQ
  7834*    END-EXEC.
  7835*    MOVE '&"S        G          (   #00007263' TO DFHEIV0
  7836     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7837     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7838     MOVE X'2020233030303037323633' TO DFHEIV0(25:11)
  7839     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 141
* EL677.cbl
  7840           ERPYAJ-FILE-ID,
  7841           DFHEIV20,
  7842           DFHEIV99,
  7843           ERPYAJ-KEY,
  7844           DFHEIV99,
  7845           DFHEIV99,
  7846           DFHEIV99
  7847     SET ADDRESS OF PENDING-PAY-ADJ TO
  7848         DFHEIV20
  7849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7850
  7851
  7852     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7853
  7854     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7855        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7856        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7857        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7858        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7859        (PY-RECORD-TYPE   NOT = 'C')
  7860          GO TO 3390-EXIT.
  7861
  7862     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7863         ADD +1 TO PYAJ-FILE-SEQ-NO
  7864         GO TO 3320-READNEXT-ERPYAJ.
  7865
  7866
  7867* EXEC CICS READ UPDATE
  7868*        DATASET   (ERPYAJ-FILE-ID)
  7869*        RIDFLD    (ERPYAJ-KEY)
  7870*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7871*    END-EXEC.
  7872*    MOVE '&"S        EU         (   #00007284' TO DFHEIV0
  7873     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7874     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7875     MOVE X'2020233030303037323834' TO DFHEIV0(25:11)
  7876     CALL 'kxdfhei1' USING DFHEIV0,
  7877           ERPYAJ-FILE-ID,
  7878           DFHEIV20,
  7879           DFHEIV99,
  7880           ERPYAJ-KEY,
  7881           DFHEIV99,
  7882           DFHEIV99,
  7883           DFHEIV99
  7884     SET ADDRESS OF PENDING-PAY-ADJ TO
  7885         DFHEIV20
  7886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7887
  7888
  7889     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7890     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7891
  7892     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  7893
  7894     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7895     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7896     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7897
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 142
* EL677.cbl
  7898
  7899* EXEC CICS REWRITE
  7900*        DATASET  (ERPYAJ-FILE-ID)
  7901*        FROM     (PENDING-PAY-ADJ)
  7902*    END-EXEC.
  7903     MOVE LENGTH OF
  7904      PENDING-PAY-ADJ
  7905       TO DFHEIV11
  7906*    MOVE '&& L                  %   #00007299' TO DFHEIV0
  7907     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7908     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7909     MOVE X'2020233030303037323939' TO DFHEIV0(25:11)
  7910     CALL 'kxdfhei1' USING DFHEIV0,
  7911           ERPYAJ-FILE-ID,
  7912           PENDING-PAY-ADJ,
  7913           DFHEIV11,
  7914           DFHEIV99
  7915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7916
  7917
  7918 3390-EXIT.
  7919      EXIT.
  7920
  7921 3400-delete-record.
  7922
  7923* EXEC CICS READ
  7924*        DATASET  (ERCHEK-FILE-ID)
  7925*        SET      (ADDRESS OF CHECK-RECORDS)
  7926*        RIDFLD   (PI-ERCHEK-KEY)
  7927*        UPDATE
  7928*        resp     (ws-response)
  7929*    END-EXEC
  7930*    MOVE '&"S        EU         (  N#00007308' TO DFHEIV0
  7931     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7932     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7933     MOVE X'204E233030303037333038' TO DFHEIV0(25:11)
  7934     CALL 'kxdfhei1' USING DFHEIV0,
  7935           ERCHEK-FILE-ID,
  7936           DFHEIV20,
  7937           DFHEIV99,
  7938           PI-ERCHEK-KEY,
  7939           DFHEIV99,
  7940           DFHEIV99,
  7941           DFHEIV99
  7942     SET ADDRESS OF CHECK-RECORDS TO
  7943         DFHEIV20
  7944     MOVE EIBRESP  TO ws-response
  7945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7946     if (ch-in-limbo or ch-approv-pending)
  7947        and (ch-void-dt = low-values)
  7948        and (ch-check-written-dt = low-values)
  7949        and (ch-credit-accept-dt = low-values)
  7950        perform 3500-check-tbl   thru 3500-exit
  7951        if (row-deleted and tbl-commited)
  7952           or (emi-error = er-3450)
  7953
  7954* exec cics delete
  7955*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 143
* EL677.cbl
  7956*          end-exec
  7957*    MOVE '&(                    &   #00007322' TO DFHEIV0
  7958     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7959     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7960     MOVE X'2020233030303037333232' TO DFHEIV0(25:11)
  7961     CALL 'kxdfhei1' USING DFHEIV0,
  7962           erchek-file-id,
  7963           DFHEIV99,
  7964           DFHEIV99,
  7965           DFHEIV99,
  7966           DFHEIV99
  7967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7968        end-if
  7969     else
  7970        move -1               to maintl
  7971        move er-3452          to emi-error
  7972        move al-uabon         to mainta
  7973        perform 9900-error-format
  7974                                 thru 9900-exit
  7975        go to 8200-send-dataonly
  7976     end-if
  7977     if pi-chek-rec-cnt = +1
  7978        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7979                                 THRU 6200-EXIT
  7980        if resp-normal
  7981           MOVE ' '              TO PB-C-REFUND-SW
  7982           perform 6210-rewrite-pndb
  7983                                 thru 6210-exit
  7984        end-if
  7985     end-if
  7986     MOVE ER-0000            TO EMI-ERROR
  7987     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7988     MOVE LOW-VALUES             TO EL677AI.
  7989     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7990     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7991     MOVE PI-CHEK-STATE          TO STATEO.
  7992     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7993     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7994     MOVE SPACE                  TO DC-OPTION-CODE.
  7995     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7996     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7997     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7998     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7999     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  8000     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8001                                    ACCTA   EFFDTA
  8002                                    CERTNOA   SFXA.
  8003     MOVE AL-UNNON               TO SEQA.
  8004     GO TO 8100-SEND-INITIAL-MAP
  8005     .
  8006 3400-exit.
  8007     exit.
  8008 3500-check-tbl.
  8009     perform 4100-CONNECT-TO-DB  thru 4100-exit
  8010*    if sqlcode = 0
  8011*       perform 4150-open-cursor    thru 4150-exit
  8012*    end-if
  8013     if sqlcode = 0
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 144
* EL677.cbl
  8014        perform 4200-get-tbl-row thru 4200-exit
  8015     end-if
  8016      if sqlcode = 0
  8017         if (nu-app-date = -1)
  8018            or (db-app-status = '2')
  8019            perform 4250-delete-row thru 4250-exit
  8020         else
  8021           MOVE ER-3452            TO  EMI-ERROR
  8022           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8023           MOVE -1                 TO  PFENTERL
  8024           GO TO 8200-SEND-DATAONLY
  8025        end-if
  8026      else
  8027         MOVE ER-3450            TO  EMI-ERROR
  8028         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8029         MOVE -1                 TO  PFENTERL
  8030*        GO TO 8200-SEND-DATAONLY
  8031      end-if
  8032     if connected-to-db
  8033        perform 4300-FINISH-UP-DB thru 4300-exit
  8034     end-if
  8035     .
  8036 3500-exit.
  8037     exit.
  8038 3700-UPDATE-ERCHKQ.
  8039*    MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.
  8040*    MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.
  8041*    MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.
  8042*
  8043*    EXEC CICS HANDLE CONDITION
  8044*        NOTFND (3780-CHECK-NOTFND)
  8045*    END-EXEC.
  8046*
  8047*    EXEC CICS READ
  8048*        DATASET  (ERCHKQ-FILE-ID)
  8049*        SET      (ADDRESS OF CHECK-QUE)
  8050*        RIDFLD   (ERCHKQ-KEY)
  8051*        UPDATE
  8052*    END-EXEC.
  8053*
  8054*    IF MAINTI = 'C'
  8055*        IF MANUAL-CHECK-WRITTEN
  8056*            MOVE 'M'                 TO CQ-ENTRY-TYPE
  8057*            MOVE +1                  TO CQ-TIMES-PRINTED
  8058*            MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER
  8059*            MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT
  8060*            MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  8061*
  8062*    IF MAINTI = 'V'
  8063*        MOVE 'V'                TO CQ-ENTRY-TYPE
  8064*                                   CQ-VOID-INDICATOR
  8065*        MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.
  8066*
  8067*    MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.
  8068*
  8069*    EXEC CICS REWRITE
  8070*        DATASET  (ERCHKQ-FILE-ID)
  8071*        FROM     (CHECK-QUE)
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 145
* EL677.cbl
  8072*    END-EXEC.
  8073*
  8074*    GO TO 3790-EXIT.
  8075*
  8076*3780-CHECK-NOTFND.
  8077*    MOVE ER-2905                TO EMI-ERROR.
  8078*    MOVE -1                     TO CARRIERL
  8079*    MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8080*                                   ACCTA     EFFDTA  CERTNOA
  8081*                                   SFXA      SEQA.
  8082*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8083     .
  8084 3790-EXIT.
  8085      EXIT.
  8086
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 146
* EL677.cbl
  8088
  8089 3900-RECORD-NOTFND.
  8090     MOVE ER-2908                TO EMI-ERROR.
  8091     MOVE -1                     TO CARRIERL
  8092     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8093                                    ACCTA     EFFDTA  CERTNOA
  8094                                    SFXA      SEQA.
  8095     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8096     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 147
* EL677.cbl
  8098 4000-ADD-CHANGE.
  8099     IF PAYTO1L NOT = ZEROS
  8100        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8101     END-IF
  8102
  8103     IF PAYTO2L NOT = ZEROS
  8104         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8105
  8106     IF PAYAD1L NOT = ZEROS
  8107         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8108
  8109     IF PAYAD2L NOT = ZEROS
  8110         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8111
  8112     IF PAYctyL NOT = ZEROS
  8113         MOVE payctyi            TO CH-PAYEE-CITY.
  8114
  8115     IF PAYstL NOT = ZEROS
  8116         MOVE paysti            TO CH-PAYEE-state.
  8117
  8118     IF PAYEEI GREATER SPACES
  8119        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8120
  8121     IF PTOZIPL  =  ZEROS
  8122         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8123         GO TO 4000-CK-REST.
  8124
  8125     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8126
  8127     IF NOT WS-CANADIAN-POST-CODE
  8128         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8129         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8130         GO TO 4000-CK-REST.
  8131
  8132     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8133     IF WS-CAN-POST-4TH = SPACE OR '-'
  8134         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8135         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8136     ELSE
  8137         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8138         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8139
  8140 4000-CK-REST.
  8141
  8142     IF RETTOL NOT = ZEROS
  8143        MOVE RETTOI TO CH-RETURN-TO.
  8144     if dedcynl not = zeros
  8145        move dedcyni             to ch-deduct-commission
  8146     end-if
  8147     if dedcynl not = zeros
  8148        if (dedcyni = 'Y')
  8149           or (pi-prev-ded-comm = 'Y')
  8150           compute ws-amt =
  8151              pi-refund-on-pending-rec -
  8152                 pi-prev-paid - pi-ue-comm
  8153        else
  8154           if dedcyni = 'N'
  8155              compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 148
* EL677.cbl
  8156                 pi-refund-on-pending-rec -
  8157                    pi-prev-paid
  8158           end-if
  8159        end-if
  8160     end-if
  8161     IF AMOUNTL NOT = ZEROS
  8162         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8163         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8164
  8165     IF CHECKL NOT = ZEROS
  8166         MOVE CHECKI             TO CH-CHECK-NO.
  8167
  8168     IF REASONL NOT = ZEROS
  8169         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8170
  8171*    IF DEDAMTL NOT = ZEROS
  8172*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8173*                                   DEDAMTO.
  8174
  8175*    IF ADDLCHGL NOT = ZEROS
  8176*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8177*                                   ADDLCHGO.
  8178
  8179     IF STUBL NOT = ZEROS
  8180         MOVE STUBI              TO CH-STUB-LINE-1.
  8181
  8182     IF TEXT1L NOT = ZEROS
  8183         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8184
  8185     IF TEXT2L NOT = ZEROS
  8186         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8187
  8188     IF TEXT3L NOT = ZEROS
  8189         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8190
  8191     IF TYPEL NOT = ZEROS
  8192         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8193
  8194*    MOVE LETTER1I               TO CH-LETTERS (1).
  8195*    MOVE LETTER2I               TO CH-LETTERS (2).
  8196*    MOVE LETTER3I               TO CH-LETTERS (3).
  8197
  8198*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8199     IF CH-CHECK-ORIGIN-SW = 'R'
  8200         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8201*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
  8202         MOVE PI-CANC-DT             TO CH-CANC-DT
  8203         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8204         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8205         MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8206
  8207*    IF PI-AR-PROCESSING AND
  8208*       REFL NOT = ZERO
  8209*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8210
  8211 4000-EXIT.
  8212      EXIT.
  8213 4100-CONNECT-TO-DB.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 149
* EL677.cbl
  8214     move 'NTSQLTST2_Logic'      to svr
  8215     move 'sa'                   to usr
  8216     move 'sql2008r2'            to pass
  8217
  8218     if ws-kix-myenv = 'cid1p'
  8219        move 'NTCSO2_ChkApprv'   to svr
  8220        move 'sa'                to usr
  8221        move 'ntcso2'            to pass
  8222     end-if
  8223     string
  8224         usr delimited space
  8225         "." delimited size
  8226         pass delimited space into usr-pass
  8227     end-string
  8228     EXEC SQL
  8229        CONNECT TO :svr USER :usr-pass
  8230     END-EXEC
  8231     if sqlcode not = 0
  8232        display "Error: cannot connect "
  8233        display sqlcode
  8234        display sqlerrmc
  8235     end-if
  8236     set connected-to-db to true
  8237     .
  8238 4100-EXIT.
  8239     EXIT.
  8240 4150-open-cursor.
  8241     move pi-company-id          to ws-compid
  8242     move ch-carrier             to ws-carrier
  8243     move ch-grouping            to ws-grouping
  8244     move ch-state               to ws-state
  8245     move ch-account             to ws-account
  8246     move ch-cert-eff-dt         to dc-bin-date-1
  8247     move ' '                    to dc-option-code
  8248     perform 8500-date-convert   thru 8500-exit
  8249     if no-conversion-error
  8250        move dc-greg-date-a-edit to ws-eff-date
  8251     end-if
  8252     move ch-cert-prime          to ws-certificate
  8253     move ch-cert-sfx            to ws-cert-sfx
  8254     move ch-sequence-no         to ws-seq-no
  8255     move '1'                    to ws-type
  8256     EXEC SQL
  8257        DECLARE
  8258           checkapp cursor for
  8259        SELECT
  8260           ApprovalStatus,
  8261           MaintainedBy,
  8262           MaintainedDate,
  8263           ApprovalBatch
  8264        FROM
  8265           ChkApp_Check
  8266        WHERE
  8267           Company           = :ws-compid
  8268           and CertCarrier   = :ws-carrier
  8269           and CertGroup     = :ws-grouping
  8270           and CertState     = :ws-state
  8271           and CertAccount   = :ws-account
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 150
* EL677.cbl
  8272           and CertEffDate   = :ws-eff-date
  8273           and CertNumber    = :ws-certificate
  8274           and CertNumberSuf = :ws-cert-sfx
  8275           and CheckSeqNbr   = :ws-seq-no
  8276           and CheckType     = :ws-type
  8277     END-EXEC
  8278     if sqlcode not = 0
  8279        display "Error: cannot declare cursor "
  8280        display ' sql retrun code ' sqlcode
  8281        display ' sql err mess    ' sqlerrmc
  8282        go to 4150-exit
  8283     end-if
  8284     EXEC SQL
  8285        open checkapp
  8286     END-EXEC
  8287     if sqlcode not = 0
  8288        display "Error: cannot open cursor "
  8289        display ' sql retrun code ' sqlcode
  8290        display ' sql err mess    ' sqlerrmc
  8291     end-if
  8292     .
  8293 4150-exit.
  8294     exit.
  8295 4200-get-tbl-row.
  8296***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8297***                                                            ***
  8298***  I'm only expecting one row so no cursor is declared       ***
  8299***                                                            ***
  8300***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8301     move pi-company-id          to ws-compid
  8302     move ch-carrier             to ws-carrier
  8303     move ch-grouping            to ws-grouping
  8304     move ch-state               to ws-state
  8305     move ch-account             to ws-account
  8306     move ch-cert-eff-dt         to dc-bin-date-1
  8307     move ' '                    to dc-option-code
  8308     perform 8500-date-convert   thru 8500-exit
  8309     if no-conversion-error
  8310        move dc-greg-date-a-edit to ws-eff-date
  8311     end-if
  8312     move ch-cert-prime          to ws-certificate
  8313     move ch-cert-sfx            to ws-cert-sfx
  8314     move ch-sequence-no         to ws-seq-no
  8315     move '1'                    to ws-type
  8316     exec sql
  8317        SELECT
  8318           ApprovalStatus,
  8319           MaintainedBy,
  8320           MaintainedDate,
  8321           ApprovalBatch
  8322        INTO
  8323           :db-app-status :nu-app-status,
  8324           :db-app-by :nu-app-by,
  8325           :db-app-date :nu-app-date,
  8326           :db-app-batch :nu-app-batch
  8327        FROM
  8328           ChkApp_Check
  8329        WHERE
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 151
* EL677.cbl
  8330           Company           = :ws-compid
  8331           and CertCarrier   = :ws-carrier
  8332           and CertGroup     = :ws-grouping
  8333           and CertState     = :ws-state
  8334           and CertAccount   = :ws-account
  8335           and CertEffDate   = :ws-eff-date
  8336           and CertNumber    = :ws-certificate
  8337           and CertNumberSuf = :ws-cert-sfx
  8338           and CheckSeqNbr   = :ws-seq-no
  8339           and CheckType     = :ws-type
  8340     end-exec
  8341     if sqlcode not = 0
  8342        display "Error: cannot read row "
  8343        display ' sql return code ' sqlcode
  8344        display ' sql err mess    ' sqlerrmc
  8345        go to 4200-exit
  8346     end-if
  8347*    display ' status ' db-app-status
  8348*    display ' by     ' db-app-by
  8349*    display ' date   ' db-app-date
  8350*    display ' batch  ' db-app-batch
  8351*    if nu-app-date = -1
  8352*       display ' approval date is low-values '
  8353*    else
  8354*       display ' approval date is NOT low values '
  8355*    end-if
  8356     .
  8357 4200-exit.
  8358     exit.
  8359 4250-delete-row.
  8360     EXEC SQL
  8361        DELETE
  8362           from ChkApp_Check
  8363        WHERE
  8364           Company           = :ws-compid
  8365           and CertCarrier   = :ws-carrier
  8366           and CertGroup     = :ws-grouping
  8367           and CertState     = :ws-state
  8368           and CertAccount   = :ws-account
  8369           and CertEffDate   = :ws-eff-date
  8370           and CertNumber    = :ws-certificate
  8371           and CertNumberSuf = :ws-cert-sfx
  8372           and CheckSeqNbr   = :ws-seq-no
  8373           and CheckType     = :ws-type
  8374     END-EXEC
  8375     if sqlcode not = 0
  8376        display "Error: cannot delete row  "
  8377        display ' sql retrun code ' sqlcode
  8378        display ' sql err mess    ' sqlerrmc
  8379        go to 4250-exit
  8380     end-if
  8381     set row-deleted         to true
  8382     EXEC SQL
  8383         commit transaction
  8384     END-EXEC
  8385     if sqlcode not = 0
  8386        display "Error: commit "
  8387        display ' sql return code ' sqlcode
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 152
* EL677.cbl
  8388        display ' sql err mess    ' sqlerrmc
  8389        go to 4250-exit
  8390     end-if
  8391     set tbl-commited to true
  8392     .
  8393 4250-exit.
  8394     exit.
  8395 4300-FINISH-UP-DB.
  8396     EXEC SQL
  8397         commit work release
  8398     END-EXEC
  8399     if sqlcode not = 0
  8400        display "Error: commit release "
  8401        display ' sql return code ' sqlcode
  8402        display ' sql err mess    ' sqlerrmc
  8403     end-if
  8404     .
  8405 4300-EXIT.
  8406     EXIT.
  8407 5000-BROWSE-FILE.
  8408
  8409* EXEC CICS HANDLE CONDITION
  8410*        NOTFND   (5560-END-OF-FILE)
  8411*        ENDFILE  (5560-END-OF-FILE)
  8412*    END-EXEC.
  8413*    MOVE '"$I''                  ! . #00007765' TO DFHEIV0
  8414     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8416     MOVE X'2E20233030303037373635' TO DFHEIV0(25:11)
  8417     CALL 'kxdfhei1' USING DFHEIV0
  8418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8419
  8420
  8421     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8422
  8423     IF SEQI = LOW-VALUES
  8424         MOVE +1                 TO CHEK-RECORD-SEQ.
  8425
  8426     IF EIBAID = DFHPF2
  8427         GO TO 5100-BROWSE-BKWD.
  8428
  8429 5010-READ-LOOP.
  8430     IF EIBAID = DFHPF1
  8431         ADD +1                  TO CHEK-RECORD-SEQ.
  8432
  8433
  8434* EXEC CICS READ
  8435*        DATASET  (ERCHEK-FILE-ID)
  8436*        SET      (ADDRESS OF CHECK-RECORDS)
  8437*        RIDFLD   (ERCHEK-KEY)
  8438*        GTEQ
  8439*    END-EXEC.
  8440*    MOVE '&"S        G          (   #00007782' TO DFHEIV0
  8441     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8443     MOVE X'2020233030303037373832' TO DFHEIV0(25:11)
  8444     CALL 'kxdfhei1' USING DFHEIV0,
  8445           ERCHEK-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 153
* EL677.cbl
  8446           DFHEIV20,
  8447           DFHEIV99,
  8448           ERCHEK-KEY,
  8449           DFHEIV99,
  8450           DFHEIV99,
  8451           DFHEIV99
  8452     SET ADDRESS OF CHECK-RECORDS TO
  8453         DFHEIV20
  8454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8455
  8456
  8457     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8458         IF EIBAID = DFHENTER
  8459             GO TO 5550-NO-RECORD
  8460         ELSE
  8461             GO TO 5560-END-OF-FILE.
  8462
  8463        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8464           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8465           PI-CHEK-STATE      = CH-STATE       AND
  8466           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8467           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8468           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8469           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8470              GO TO 5500-FORMAT-SCREEN
  8471            ELSE
  8472              IF EIBAID = DFHPF1
  8473                  GO TO 5560-END-OF-FILE
  8474                ELSE
  8475                  GO TO 5550-NO-RECORD.
  8476
  8477     IF EIBAID = DFHENTER
  8478        IF CHEK-CARRIER    = CH-CARRIER     AND
  8479           CHEK-GROUPING   = CH-GROUPING    AND
  8480           CHEK-STATE      = CH-STATE       AND
  8481           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8482           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8483           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8484           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8485           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8486              GO TO 5500-FORMAT-SCREEN
  8487        ELSE
  8488              GO TO 5550-NO-RECORD.
  8489
  8490     GO TO 5500-FORMAT-SCREEN.
  8491
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 154
* EL677.cbl
  8493
  8494 5100-BROWSE-BKWD.
  8495
  8496* EXEC CICS STARTBR
  8497*        DATASET  (ERCHEK-FILE-ID)
  8498*        RIDFLD   (ERCHEK-KEY)
  8499*    END-EXEC.
  8500     MOVE 0
  8501       TO DFHEIV11
  8502*    MOVE '&,         G          &   #00007827' TO DFHEIV0
  8503     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8504     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8505     MOVE X'2020233030303037383237' TO DFHEIV0(25:11)
  8506     CALL 'kxdfhei1' USING DFHEIV0,
  8507           ERCHEK-FILE-ID,
  8508           ERCHEK-KEY,
  8509           DFHEIV99,
  8510           DFHEIV11,
  8511           DFHEIV99
  8512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8513
  8514
  8515
  8516* EXEC CICS READPREV
  8517*        DATASET  (ERCHEK-FILE-ID)
  8518*        SET      (ADDRESS OF CHECK-RECORDS)
  8519*        RIDFLD   (ERCHEK-KEY)
  8520*    END-EXEC.
  8521     MOVE 0
  8522       TO DFHEIV11
  8523*    MOVE '&0S                   )   #00007832' TO DFHEIV0
  8524     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8525     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8526     MOVE X'2020233030303037383332' TO DFHEIV0(25:11)
  8527     CALL 'kxdfhei1' USING DFHEIV0,
  8528           ERCHEK-FILE-ID,
  8529           DFHEIV20,
  8530           DFHEIV99,
  8531           ERCHEK-KEY,
  8532           DFHEIV99,
  8533           DFHEIV11,
  8534           DFHEIV99,
  8535           DFHEIV99
  8536     SET ADDRESS OF CHECK-RECORDS TO
  8537         DFHEIV20
  8538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8539
  8540
  8541 5110-READ-LOOP.
  8542     IF PI-FILE-EOF
  8543         MOVE SPACE              TO PI-EOF-SW
  8544     ELSE
  8545
  8546* EXEC CICS READPREV
  8547*            DATASET  (ERCHEK-FILE-ID)
  8548*            SET      (ADDRESS OF CHECK-RECORDS)
  8549*            RIDFLD   (ERCHEK-KEY)
  8550*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 155
* EL677.cbl
  8551     MOVE 0
  8552       TO DFHEIV11
  8553*    MOVE '&0S                   )   #00007842' TO DFHEIV0
  8554     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8555     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8556     MOVE X'2020233030303037383432' TO DFHEIV0(25:11)
  8557     CALL 'kxdfhei1' USING DFHEIV0,
  8558           ERCHEK-FILE-ID,
  8559           DFHEIV20,
  8560           DFHEIV99,
  8561           ERCHEK-KEY,
  8562           DFHEIV99,
  8563           DFHEIV11,
  8564           DFHEIV99,
  8565           DFHEIV99
  8566     SET ADDRESS OF CHECK-RECORDS TO
  8567         DFHEIV20
  8568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8569
  8570
  8571     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8572         GO TO 5560-END-OF-FILE.
  8573
  8574        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8575           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8576           PI-CHEK-STATE      = CH-STATE       AND
  8577           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8578           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8579           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8580           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8581              GO TO 5500-FORMAT-SCREEN
  8582            ELSE
  8583              GO TO 5560-END-OF-FILE.
  8584
  8585     GO TO 5500-FORMAT-SCREEN.
  8586
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 156
* EL677.cbl
  8588*                          COPY ELCNPD.
  8589*****************************************************************
  8590*                                                               *
  8591*                                                               *
  8592*                            ELCNPD                             *
  8593*                            VMOD=2.001                         *
  8594*****************************************************************
  8595
  8596 5200-MOVE-NAME.
  8597*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8598*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8599*            BLANKS.                                            *
  8600*                                                               *
  8601*                  FIELD               VALUE                    *
  8602*                                                               *
  8603*                LAST NAME (CL15)      SMITH                    *
  8604*                1ST NAME  (CL12)      JOHN                     *
  8605*                MID NAME  (CL1)       A                        *
  8606*                                                               *
  8607*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8608*         *                                                     *
  8609*         *              JOHN A. SMITH                          *
  8610*         *                                                     *
  8611*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8612*         *  STORAGE COPYBOOK:                                  *
  8613*         *                                                     *
  8614*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8615*         *******************************************************.
  8616
  8617     MOVE SPACES                 TO  WS-NAME-WORK
  8618                                     WS-NAME-WORK2.
  8619     MOVE ZERO                   TO  WS-NAME-SW.
  8620     SET NWA-INDEX TO +1.
  8621
  8622     IF WS-INSURED-1ST-NAME = SPACES  AND
  8623        WS-INSURED-MID-INIT = SPACES
  8624         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8625         GO TO 5200-EXIT.
  8626
  8627     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8628     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8629
  8630     SET NWA-INDEX UP BY +1
  8631     IF WS-INSURED-MID-INIT NOT = SPACES
  8632        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8633        SET NWA-INDEX UP BY +1
  8634        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8635        SET NWA-INDEX UP BY +2.
  8636
  8637     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8638     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8639
  8640
  8641 5200-EXIT.
  8642     EXIT.
  8643
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 157
* EL677.cbl
  8645 5300-MOVE-NAME SECTION.
  8646     IF WS-NAME-SW GREATER THAN +1
  8647         GO TO 5390-EXIT.
  8648
  8649     IF WS-NAME-WORK2 = SPACES
  8650         GO TO 5390-EXIT.
  8651
  8652     SET NWA-INDEX2 TO +1.
  8653     SET NWA-INDEX3 TO +2.
  8654
  8655 5310-MOVE-NAME.
  8656     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8657
  8658     IF NWA-INDEX LESS THAN +30
  8659        SET NWA-INDEX UP BY +1
  8660     ELSE
  8661        ADD +2  TO  WS-NAME-SW
  8662        GO TO 5390-EXIT.
  8663
  8664     IF NWA-INDEX2 LESS THAN +20
  8665         SET NWA-INDEX2 UP BY +1
  8666         SET NWA-INDEX3 UP BY +1.
  8667
  8668     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8669        WS-NW2 (NWA-INDEX3) = SPACES
  8670        GO TO 5390-EXIT.
  8671
  8672     GO TO 5310-MOVE-NAME.
  8673
  8674 5390-EXIT.
  8675     EXIT.
  8676
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 158
* EL677.cbl
  8679 5500-FORMAT-SCREEN.
  8680     MOVE LOW-VALUES             TO  EL677AI.
  8681     MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.
  8682     MOVE +1                     TO  MAINTL.
  8683     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8684     MOVE CH-CARRIER             TO  CARRIERO.
  8685     MOVE CH-GROUPING            TO  GROUPO.
  8686     MOVE CH-STATE               TO  STATEO.
  8687     MOVE CH-ACCOUNT             TO  ACCTO.
  8688
  8689     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8690     MOVE SPACE                  TO  DC-OPTION-CODE.
  8691     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8692     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8693
  8694     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8695     MOVE CH-CERT-SFX            TO  SFXO.
  8696     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8697
  8698     MOVE AL-UANON               TO  CARRIERA
  8699                                     GROUPA
  8700                                     STATEA
  8701                                     ACCTA
  8702                                     EFFDTA
  8703                                     CERTNOA
  8704                                     SFXA.
  8705     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8706
  8707     if ch-approval-dt not = low-values
  8708        move ch-approval-dt      to dc-bin-date-1
  8709        move ' '                 to dc-option-code
  8710        perform 8500-date-convert thru 8500-exit
  8711        move dc-greg-date-1-edit to apvdto
  8712     end-if
  8713     evaluate ch-approval-status
  8714        when '2'
  8715           move 'PENDING '       TO APVSTATO
  8716        when 'P'
  8717           move 'PENDING '       TO APVSTATO
  8718        when 'A'
  8719           move 'APPROVED'       to apvstato
  8720        when 'D'
  8721           move 'DENIED'         to apvstato
  8722     end-evaluate
  8723     move ch-approved-by         to apvbyo
  8724*    IF PI-COMPANY-ID = 'TMS'
  8725*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8726*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8727*    ELSE
  8728         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8729         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8730
  8731     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8732     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8733     move ch-payee-city          to payctyo
  8734     move ch-payee-state         to paysto
  8735     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8736
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 159
* EL677.cbl
  8737     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8738         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8739         MOVE AL-UANON           TO  PTOZIPA.
  8740
  8741     MOVE CH-RETURN-TO           TO  RETTOO
  8742*    if ch-check-cashed-dt not = spaces and low-values
  8743*       move ch-check-cashed-dt  to dc-bin-date-1
  8744*       MOVE SPACE               TO  DC-OPTION-CODE
  8745*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8746*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8747*    end-if
  8748     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8749     MOVE SPACE                  TO  DC-OPTION-CODE.
  8750     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8751     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8752
  8753     MOVE CH-RECORDED-BY         TO  CBYO.
  8754
  8755     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8756         NEXT SENTENCE
  8757     ELSE
  8758         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8759         MOVE SPACE                  TO  DC-OPTION-CODE
  8760         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8761         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8762         MOVE CH-VOID-BY             TO  VBYO.
  8763
  8764     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8765         NEXT SENTENCE
  8766     ELSE
  8767         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8768         MOVE SPACE                  TO  DC-OPTION-CODE
  8769         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8770         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8771
  8772     MOVE CH-AMOUNT-PAID         TO  AMOUNTO.
  8773     MOVE AL-SANOF               TO  AMOUNTA.
  8774     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8775     MOVE AL-SANOF               TO  TYPEA.
  8776     MOVE CH-CHECK-NO            TO  CHECKO.
  8777     move ch-deduct-commission   to dedcyno
  8778     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8779     MOVE CH-VOID-REASON         TO  VREASONO.
  8780
  8781     MOVE CH-STUB-LINE-1         TO  STUBO.
  8782     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8783     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8784     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8785     IF CH-LF-REFUND NOT NUMERIC
  8786         MOVE ZEROS              TO CH-LF-REFUND.
  8787     IF CH-AH-REFUND NOT NUMERIC
  8788         MOVE ZEROS              TO CH-AH-REFUND.
  8789     if (ch-check-no not = spaces and low-values)
  8790        and (ch-check-written-dt not = low-values)
  8791        perform 5800-fetch-check-cashed-dt
  8792                                 thru 5800-exit
  8793     end-if
  8794     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 160
* EL677.cbl
  8795        CH-VOID-DT          GREATER LOW-VALUES
  8796        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8797                                     STUBA     TEXT1A   TEXT2A
  8798                                     TEXT3A    PAYTO1A  SFXA
  8799                                     PAYTO2A   PAYAD1A  PAYctyA
  8800                                     paysta    RETTOA   PAYAD2A
  8801                                     PTOZIPA
  8802                                     PRINTEDA
  8803     ELSE
  8804        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8805                                     ACCTA     EFFDTA   CERTNOA
  8806                                     CHECKA    REASONA  VREASONA
  8807                                     STUBA     TEXT1A   TEXT2A
  8808                                     TEXT3A    PAYTO1A  SFXA
  8809                                     PAYTO2A   PAYAD1A  PAYctyA
  8810                                     paysta    RETTOA   PAYAD2A
  8811                                     PRINTEDA.
  8812
  8813     MOVE AL-UNNON               TO SEQA.
  8814     perform 5600-get-erpndb     thru 5600-exit
  8815     perform 5700-get-elcert     thru 5700-exit
  8816     move pi-prev-paid           to prepdo
  8817     if WS-PNDB-FOUND
  8818        compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8819     end-if
  8820     if WS-CERT-FOUND
  8821        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8822           cm-lf-alt-premium-amt
  8823        compute ws-tot-iss-prem  =
  8824           cm-ah-premium-amt + ws-tot-lf-prem
  8825        compute ws-tot-iss-comm =
  8826           (ws-tot-lf-prem * cm-life-comm-pct) +
  8827           (cm-ah-premium-amt * cm-ah-comm-pct)
  8828        compute ws-tot-ref-comm =
  8829           (pi-lf-refund * cm-life-comm-pct) +
  8830           (pi-ah-refund * cm-ah-comm-pct)
  8831        move ws-tot-iss-prem     to premo
  8832        move ws-tot-iss-comm     to isscommo
  8833        move ws-tot-ref-comm     to uecommo
  8834     end-if
  8835     if PI-TO-EL677-FROM-EL1273
  8836        move zeros               to premo
  8837                                    isscommo
  8838                                    uecommo
  8839                                    prepdo
  8840                                    refo
  8841     end-if
  8842     GO TO 8100-SEND-INITIAL-MAP
  8843     .
  8844 5550-NO-RECORD.
  8845     MOVE ER-1162                TO  EMI-ERROR.
  8846     MOVE -1                     TO  CARRIERL.
  8847     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8848                                     ACCTA     EFFDTA  CERTNOA
  8849                                     SFXA      SEQA.
  8850     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8851
  8852     IF NOT PI-TO-EL677-FROM-EL1273
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 161
* EL677.cbl
  8853         GO TO 8200-SEND-DATAONLY.
  8854
  8855     MOVE CHEK-CARRIER           TO  CARRIERO.
  8856     MOVE CHEK-GROUPING          TO  GROUPO.
  8857     MOVE CHEK-STATE             TO  STATEO.
  8858     MOVE CHEK-ACCOUNT           TO  ACCTO.
  8859
  8860     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  8861     MOVE SPACE                  TO  DC-OPTION-CODE.
  8862     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8863     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8864
  8865     MOVE CHEK-CERT-NO           TO  CERTNOO.
  8866     MOVE CHEK-SUF-NO            TO  SFXO.
  8867     GO TO 8100-SEND-INITIAL-MAP.
  8868
  8869 5560-END-OF-FILE.
  8870     IF EIBAID = DFHPF1
  8871         MOVE 'Y'                TO  PI-EOF-SW
  8872         MOVE ER-2237            TO  EMI-ERROR
  8873     ELSE
  8874     IF EIBAID = DFHENTER
  8875        GO TO 5550-NO-RECORD
  8876     ELSE
  8877*        MOVE SPACES             TO  PI-ERCHEK-KEY
  8878         MOVE ER-2238            TO  EMI-ERROR.
  8879
  8880     MOVE -1                     TO  MAINTL.
  8881     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8882     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 162
* EL677.cbl
  8884 5600-get-erpndb.
  8885     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  8886     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  8887     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  8888     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  8889     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  8890     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  8891     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  8892     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  8893     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  8894     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  8895     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  8896     IF ST-ACCNT-CNTL  OR
  8897        ACCNT-CNTL
  8898          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  8899     IF ST-ACCNT-CNTL      OR
  8900        CARR-ST-ACCNT-CNTL OR
  8901        ACCNT-CNTL         OR
  8902        CARR-ACCNT-CNTL
  8903          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  8904     IF ACCNT-CNTL OR
  8905        CARR-ACCNT-CNTL
  8906          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  8907
  8908* EXEC CICS READ
  8909*         DATASET   (ERPNDB-ALT-FILE-ID)
  8910*         SET       (ADDRESS OF PENDING-BUSINESS)
  8911*         RIDFLD    (ERPNDB-ALT-KEY)
  8912*         resp      (ws-response)
  8913*    END-EXEC
  8914*    MOVE '&"S        E          (  N#00008184' TO DFHEIV0
  8915     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8916     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8917     MOVE X'204E233030303038313834' TO DFHEIV0(25:11)
  8918     CALL 'kxdfhei1' USING DFHEIV0,
  8919           ERPNDB-ALT-FILE-ID,
  8920           DFHEIV20,
  8921           DFHEIV99,
  8922           ERPNDB-ALT-KEY,
  8923           DFHEIV99,
  8924           DFHEIV99,
  8925           DFHEIV99
  8926     SET ADDRESS OF PENDING-BUSINESS TO
  8927         DFHEIV20
  8928     MOVE EIBRESP  TO ws-response
  8929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8930     if resp-normal
  8931        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  8932        compute pi-refund-on-pending-rec =
  8933           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8934     end-if
  8935     .
  8936 5600-exit.
  8937     exit.
  8938 5700-get-elcert.
  8939     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  8940     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  8941     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 163
* EL677.cbl
  8942     MOVE PI-STATE               TO  ELCERT-STATE.
  8943     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  8944     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  8945     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  8946     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  8947     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  8948
  8949* EXEC CICS READ
  8950*         DATASET   (ELCERT-FILE-ID)
  8951*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  8952*         RIDFLD    (ELCERT-KEY)
  8953*         resp      (ws-response)
  8954*    END-EXEC
  8955*    MOVE '&"S        E          (  N#00008208' TO DFHEIV0
  8956     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8957     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8958     MOVE X'204E233030303038323038' TO DFHEIV0(25:11)
  8959     CALL 'kxdfhei1' USING DFHEIV0,
  8960           ELCERT-FILE-ID,
  8961           DFHEIV20,
  8962           DFHEIV99,
  8963           ELCERT-KEY,
  8964           DFHEIV99,
  8965           DFHEIV99,
  8966           DFHEIV99
  8967     SET ADDRESS OF CERTIFICATE-MASTER TO
  8968         DFHEIV20
  8969     MOVE EIBRESP  TO ws-response
  8970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8971     if resp-normal
  8972        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  8973     end-if
  8974     .
  8975 5700-exit.
  8976     exit.
  8977 5800-fetch-check-cashed-dt.
  8978     move ' '                    to ws-connect-sw
  8979                                    ws-match-sw
  8980                                    pi-check-cashed
  8981     move 'NTCSO2_PdBnkInfo'     to svr
  8982     move 'sa'                   to usr
  8983     move 'ntcso2'               to pass
  8984     string
  8985         usr delimited space
  8986         "." delimited size
  8987         pass delimited space into usr-pass
  8988     end-string
  8989     EXEC SQL
  8990        CONNECT TO :svr USER :usr-pass
  8991     END-EXEC
  8992     if sqlcode not = 0
  8993        display "Error: cannot connect to pdbnkinfo "
  8994        display sqlcode
  8995        display sqlerrmc
  8996        go to 5800-exit
  8997     end-if
  8998     set connected-to-db to true
  8999     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 164
* EL677.cbl
  9000        move 'CSO - AP%'         to ws-pb-compid
  9001     else
  9002        move 'AHL - AP%'         to ws-pb-compid
  9003     end-if
  9004     move '000'                  to ws-pb-check-no (1:3)
  9005     move ch-check-no            to ws-pb-check-no (4:7)
  9006     move spaces                 to ws-pb-bad-check-no
  9007     perform varying s1 from +1 by +1 until
  9008        (s1 > +10)
  9009        or (ws-pb-check-no (s1:1) not = '0')
  9010     end-perform
  9011     if s1 < +11
  9012        move ws-pb-check-no (s1:11 - s1)
  9013                            to ws-pb-bad-check-no (1: 11 - s1)
  9014     end-if
  9015*    display ' compid **' ws-pb-compid '**'
  9016*    display ' ckno  **' ws-pb-check-no '**'
  9017     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  9018     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  9019     MOVE SPACES              TO pb-paid-date
  9020
  9021     EXEC SQL
  9022        CALL pbi_GetCashDate_by_TransactionNbr
  9023           @compid          = :ws-pb-compid,
  9024           @checkno         = :ws-pb-check-no,
  9025           @badcheckno      = :ws-pb-bad-check-no,
  9026           @checkamount     = :ws-check-amount,
  9027           @checkcasheddate = :pb-paid-date OUT
  9028     END-EXEC
  9029     if sqlcode not = 0
  9030        display "Error: cannot run stor proc  "
  9031        move sqlcode            to ws-sql-code
  9032        move ws-sql-code to ws-dis-sql-code
  9033        display ' dis sql code ' ws-dis-sql-code
  9034        display ' sql return code ' sqlcode
  9035        display ' sql err mess    ' sqlerrmc
  9036        go to 5800-disconnect
  9037     end-if
  9038***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9039***                                                            ***
  9040***  The following code works just as well as the above        ***
  9041***  stored procedure and just as fast.                        ***
  9042***  Originally, I had declared a cursor and fetched through   ***
  9043***  the record set to find the correct check and that REALLY  ***
  9044***  slowed the response down to ~ 3/4 second.                 ***
  9045***                                                            ***
  9046***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9047*     EXEC SQL
  9048*        SELECT
  9049*           PaidDate
  9050*        INTO
  9051*           :pb-paid-date
  9052*        FROM
  9053*           dbo.cso_pbi_TransactionLookup
  9054*        WHERE
  9055*           (BankAcctDescr like :ws-pb-compid)
  9056*           and (Amount = :ws-check-amount)
  9057*           and ((transactionNbr = :ws-pb-check-no)
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 165
* EL677.cbl
  9058*                  or
  9059*               (transactionnbr = :ws-pb-bad-check-no))
  9060**          and (CAST(TransactionNbr AS INT) =
  9061**             :ws-pb-check-no-num)
  9062**          and (right('00000' + rtrim(TransactionNbr),10)
  9063**             = :ws-pb-check-no)
  9064**          and (TransactionNbr  = :ws-pb-check-no)
  9065*     END-EXEC
  9066*    display ' chkno  ' pb-check-no
  9067*    display ' desc   ' pb-bank-acct-desc
  9068*    display ' trn typ' pb-tran-type
  9069*    display ' amt   *' pb-amount '**'
  9070*    display ' pd dte ' pb-paid-date
  9071     string pb-paid-date (7:4)
  9072            pb-paid-date (1:2)
  9073            pb-paid-date (4:2)
  9074        delimited by size into dc-greg-date-cymd-r
  9075     end-string
  9076     move 'L'                    to dc-option-code
  9077     perform 8500-date-convert   thru 8500-exit
  9078     if no-conversion-error
  9079*       move dc-bin-date-1       to ws-bin-cashed-dt
  9080        move dc-greg-date-1-edit to cashedo
  9081        move 'Y' to pi-check-cashed
  9082     else
  9083        display ' error cvtdte cash dt ' pb-paid-date ' '
  9084           dc-error-code
  9085     end-if
  9086     .
  9087 5800-disconnect.
  9088     EXEC SQL
  9089        DISCONNECT ALL
  9090     END-EXEC
  9091     if sqlcode not = 0
  9092        display "Error: cannot disconnect pdbnk "
  9093        display ' sql return code ' sqlcode
  9094        display ' sql err mess    ' sqlerrmc
  9095     end-if
  9096     .
  9097 5800-exit.
  9098     exit.
  9099 6000-VERIFY-COMP-MASTER.
  9100
  9101* EXEC CICS HANDLE CONDITION
  9102*        NOTFND   (6070-NO-COMP-MSTR)
  9103*    END-EXEC.
  9104*    MOVE '"$I                   ! / #00008343' TO DFHEIV0
  9105     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9107     MOVE X'2F20233030303038333433' TO DFHEIV0(25:11)
  9108     CALL 'kxdfhei1' USING DFHEIV0
  9109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9110
  9111
  9112     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  9113
  9114     IF NOT PI-ZERO-CARRIER AND
  9115        NOT PI-ZERO-CAR-GROUP
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 166
* EL677.cbl
  9116         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9117     ELSE
  9118         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9119
  9120     IF NOT PI-ZERO-GROUPING  AND
  9121        NOT PI-ZERO-CAR-GROUP
  9122         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  9123     ELSE
  9124         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9125
  9126     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9127     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9128     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9129
  9130
  9131* EXEC CICS READ
  9132*         DATASET   (ERCOMP-FILE-ID)
  9133*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9134*         RIDFLD    (ERCOMP-KEY)
  9135*     END-EXEC.
  9136*    MOVE '&"S        E          (   #00008365' TO DFHEIV0
  9137     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9139     MOVE X'2020233030303038333635' TO DFHEIV0(25:11)
  9140     CALL 'kxdfhei1' USING DFHEIV0,
  9141           ERCOMP-FILE-ID,
  9142           DFHEIV20,
  9143           DFHEIV99,
  9144           ERCOMP-KEY,
  9145           DFHEIV99,
  9146           DFHEIV99,
  9147           DFHEIV99
  9148     SET ADDRESS OF COMPENSATION-MASTER TO
  9149         DFHEIV20
  9150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9151
  9152
  9153     GO TO 6090-EXIT.
  9154
  9155 6070-NO-COMP-MSTR.
  9156     MOVE -1                     TO  CARRIERL.
  9157     MOVE ER-2230                TO  EMI-ERROR.
  9158     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9159     GO TO 8200-SEND-DATAONLY.
  9160
  9161 6090-EXIT.
  9162      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 167
* EL677.cbl
  9164 6100-VERIFY-CERTIFICATE.
  9165
  9166* EXEC CICS HANDLE CONDITION
  9167*        NOTFND   (6170-NO-CERTIFICATE)
  9168*    END-EXEC.
  9169*    MOVE '"$I                   ! 0 #00008383' TO DFHEIV0
  9170     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9171     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9172     MOVE X'3020233030303038333833' TO DFHEIV0(25:11)
  9173     CALL 'kxdfhei1' USING DFHEIV0
  9174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9175
  9176
  9177     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9178     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9179     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9180     MOVE PI-STATE               TO  ELCERT-STATE.
  9181     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9182     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9183     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9184     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9185
  9186     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9187
  9188     MOVE SPACES                 TO  PI-REFERENCE
  9189*                                    PI-INSURED-NAME.
  9190     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9191     MOVE ZEROS                  TO  PI-LF-REFUND
  9192                                     PI-AH-REFUND.
  9193
  9194
  9195* EXEC CICS READ
  9196*         DATASET   (ELCERT-FILE-ID)
  9197*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9198*         RIDFLD    (ELCERT-KEY)
  9199*     END-EXEC.
  9200*    MOVE '&"S        E          (   #00008404' TO DFHEIV0
  9201     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9202     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9203     MOVE X'2020233030303038343034' TO DFHEIV0(25:11)
  9204     CALL 'kxdfhei1' USING DFHEIV0,
  9205           ELCERT-FILE-ID,
  9206           DFHEIV20,
  9207           DFHEIV99,
  9208           ELCERT-KEY,
  9209           DFHEIV99,
  9210           DFHEIV99,
  9211           DFHEIV99
  9212     SET ADDRESS OF CERTIFICATE-MASTER TO
  9213         DFHEIV20
  9214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9215
  9216
  9217     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9218
  9219     MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9220     MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9221     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 168
* EL677.cbl
  9222         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9223     ELSE
  9224         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9225             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9226*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9227
  9228     GO TO 6190-EXIT.
  9229
  9230 6170-NO-CERTIFICATE.
  9231     MOVE -1                     TO  CARRIERL.
  9232     MOVE ER-2726                TO  EMI-ERROR.
  9233     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9234
  9235 6190-EXIT.
  9236      EXIT.
  9237
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 169
* EL677.cbl
  9239 6200-UPDATE-PENDING-BUS-REC.
  9240     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9241     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9242     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9243     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9244     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9245     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9246     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9247     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9248     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9249     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9250
  9251     IF ST-ACCNT-CNTL  OR
  9252        ACCNT-CNTL
  9253          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9254
  9255     IF ST-ACCNT-CNTL      OR
  9256        CARR-ST-ACCNT-CNTL OR
  9257        ACCNT-CNTL         OR
  9258        CARR-ACCNT-CNTL
  9259          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9260
  9261     IF ACCNT-CNTL OR
  9262        CARR-ACCNT-CNTL
  9263          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9264
  9265
  9266* EXEC CICS READ
  9267*         DATASET   (ERPNDB-ALT-FILE-ID)
  9268*         SET       (ADDRESS OF PENDING-BUSINESS)
  9269*         RIDFLD    (ERPNDB-ALT-KEY)
  9270*         resp      (ws-response)
  9271*     END-EXEC.
  9272*    MOVE '&"S        E          (  N#00008458' TO DFHEIV0
  9273     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9274     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9275     MOVE X'204E233030303038343538' TO DFHEIV0(25:11)
  9276     CALL 'kxdfhei1' USING DFHEIV0,
  9277           ERPNDB-ALT-FILE-ID,
  9278           DFHEIV20,
  9279           DFHEIV99,
  9280           ERPNDB-ALT-KEY,
  9281           DFHEIV99,
  9282           DFHEIV99,
  9283           DFHEIV99
  9284     SET ADDRESS OF PENDING-BUSINESS TO
  9285         DFHEIV20
  9286     MOVE EIBRESP  TO ws-response
  9287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9288
  9289
  9290     if not resp-normal
  9291        go to 6200-exit
  9292     end-if
  9293     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9294
  9295
  9296* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 170
* EL677.cbl
  9297*         DATASET   (ERPNDB-FILE-ID)
  9298*         SET       (ADDRESS OF PENDING-BUSINESS)
  9299*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9300*         UPDATE
  9301*         resp      (ws-response)
  9302*     END-EXEC.
  9303*    MOVE '&"S        EU         (  N#00008470' TO DFHEIV0
  9304     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9305     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9306     MOVE X'204E233030303038343730' TO DFHEIV0(25:11)
  9307     CALL 'kxdfhei1' USING DFHEIV0,
  9308           ERPNDB-FILE-ID,
  9309           DFHEIV20,
  9310           DFHEIV99,
  9311           ERPNDB-PRIMARY-KEY,
  9312           DFHEIV99,
  9313           DFHEIV99,
  9314           DFHEIV99
  9315     SET ADDRESS OF PENDING-BUSINESS TO
  9316         DFHEIV20
  9317     MOVE EIBRESP  TO ws-response
  9318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9319
  9320
  9321 6200-EXIT.
  9322      EXIT.
  9323 6210-rewrite-pndb.
  9324
  9325* EXEC CICS REWRITE
  9326*        DATASET  (ERPNDB-FILE-ID)
  9327*        FROM     (PENDING-BUSINESS)
  9328*    END-EXEC
  9329     MOVE LENGTH OF
  9330      PENDING-BUSINESS
  9331       TO DFHEIV11
  9332*    MOVE '&& L                  %   #00008481' TO DFHEIV0
  9333     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9334     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9335     MOVE X'2020233030303038343831' TO DFHEIV0(25:11)
  9336     CALL 'kxdfhei1' USING DFHEIV0,
  9337           ERPNDB-FILE-ID,
  9338           PENDING-BUSINESS,
  9339           DFHEIV11,
  9340           DFHEIV99
  9341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9342     .
  9343 6210-exit.
  9344     exit.
  9345 6300-BUILD-CERT-SCREEN.
  9346     perform 6700-build-common   thru 6700-exit
  9347     if ws-refund-amount = zeros
  9348        move pi-company-cd       to pi-chek-comp-cd
  9349        move pi-carrier          to pi-chek-carrier
  9350        move pi-grouping         to pi-chek-grouping
  9351        move pi-state            to pi-chek-state
  9352        move pi-account          to pi-chek-account
  9353        move pi-cert-eff-dt      to pi-chek-eff-dt
  9354        move pi-cert-prime       to pi-chek-cert-no
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 171
* EL677.cbl
  9355        move pi-cert-sfx         to pi-chek-suf-no
  9356        move +1                  to pi-chek-sequence
  9357             MOVE 'S'            TO MAINTI
  9358             MOVE 1              TO MAINTL
  9359             MOVE AL-UABON       TO MAINTA
  9360             MOVE DFHENTER       TO EIBAID
  9361        go to 5000-browse-file
  9362     end-if
  9363     IF WS-CERT-NOT-FOUND
  9364         GO TO 8100-SEND-INITIAL-MAP.
  9365
  9366*    IF WS-PNDB-FOUND
  9367*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9368*                                   PB-C-AH-CANCEL-AMT
  9369*        MOVE 'R'                TO  TYPEO
  9370*        IF PI-AR-PROCESSING
  9371*            MOVE AL-UANON       TO  REFA
  9372*            MOVE PB-C-REFERENCE TO  REFO
  9373*        END-IF
  9374*    ELSE
  9375*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9376*                                   CM-AH-ITD-CANCEL-AMT.
  9377     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9378     MOVE 'R'                     TO TYPEO
  9379
  9380     IF PI-COMPANY-ID = 'TMS'
  9381         MOVE WS-NAME-WORK         TO PAYTO1I
  9382                                      PI-PAYTO1
  9383         MOVE AL-UANON             TO PAYTO1A
  9384     ELSE
  9385         MOVE WS-NAME-WORK         TO PAYTO1I
  9386                                      PI-PAYTO1
  9387         MOVE AL-UANON             TO PAYTO1A.
  9388
  9389*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9390*    MOVE AL-UANON                 TO PAYTO1AA.
  9391     move 'N'                    to dedcyni
  9392     move al-uanon               to dedcyna
  9393     move 'INS'                  to payeeo
  9394     move al-panon               to payeea
  9395     IF PI-MAIL-YES
  9396         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9397
  9398     GO TO 8100-SEND-INITIAL-MAP.
  9399
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 172
* EL677.cbl
  9401
  9402 6400-MAILING-ADDRESS.
  9403
  9404* EXEC CICS HANDLE CONDITION
  9405*        NOTFND   (6470-NO-ADDRESS)
  9406*    END-EXEC.
  9407*    MOVE '"$I                   ! 1 #00008546' TO DFHEIV0
  9408     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9409     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9410     MOVE X'3120233030303038353436' TO DFHEIV0(25:11)
  9411     CALL 'kxdfhei1' USING DFHEIV0
  9412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9413
  9414
  9415
  9416* EXEC CICS READ
  9417*        DATASET   (ERMAIL-FILE-ID)
  9418*        SET       (ADDRESS OF MAILING-DATA)
  9419*        RIDFLD    (ELCERT-KEY)
  9420*    END-EXEC.
  9421*    MOVE '&"S        E          (   #00008550' TO DFHEIV0
  9422     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9423     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9424     MOVE X'2020233030303038353530' TO DFHEIV0(25:11)
  9425     CALL 'kxdfhei1' USING DFHEIV0,
  9426           ERMAIL-FILE-ID,
  9427           DFHEIV20,
  9428           DFHEIV99,
  9429           ELCERT-KEY,
  9430           DFHEIV99,
  9431           DFHEIV99,
  9432           DFHEIV99
  9433     SET ADDRESS OF MAILING-DATA TO
  9434         DFHEIV20
  9435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9436
  9437
  9438     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9439     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9440     move ma-city                to payctyi
  9441     move ma-addr-state          to paysti
  9442     MOVE MA-ZIP                 TO PTOZIPI.
  9443     MOVE AL-UANON               TO PAYAD1A
  9444                                    PAYAD2A
  9445                                    PAYctyA
  9446                                    paysta
  9447                                    PTOZIPA.
  9448
  9449     GO TO 6490-EXIT.
  9450
  9451 6470-NO-ADDRESS.
  9452     MOVE -1                     TO  PAYAD1L.
  9453     MOVE ER-2394                TO  EMI-ERROR.
  9454     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9455
  9456 6490-EXIT.
  9457      EXIT.
  9458
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 173
* EL677.cbl
  9460
  9461 6500-BUILD-ACCOUNT-SCREEN.
  9462     perform 6700-build-common   thru 6700-exit
  9463     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9464     MOVE PI-AM-NAME             TO PAYTO1I
  9465     MOVE SPACES                 TO PAYTO2I
  9466     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9467     MOVE PI-AM-CITY             TO PAYCTYI
  9468     move pi-am-st               to paysti
  9469     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9470     move 'ACCT'                 to payeeo
  9471     move al-panon               to payeea
  9472     MOVE AL-UANON               TO PAYTO1A
  9473                                    PAYTO2A
  9474                                    PAYAD1A
  9475                                    PAYCTYA
  9476                                    paysta
  9477                                    PTOZIPA.
  9478     GO TO 8100-SEND-INITIAL-MAP
  9479     .
  9480 6600-BUILD-BENEFICIARY-SCREEN.
  9481     perform 6700-build-common   thru 6700-exit
  9482     IF WS-CERT-NOT-FOUND
  9483         GO TO 8100-SEND-INITIAL-MAP.
  9484
  9485*    IF WS-PNDB-FOUND
  9486*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9487*                                   PB-C-AH-CANCEL-AMT
  9488*        MOVE 'R'                TO  TYPEO
  9489*        IF PI-AR-PROCESSING
  9490*            MOVE AL-UANON       TO  REFA
  9491*            MOVE PB-C-REFERENCE TO  REFO
  9492*        END-IF
  9493*    ELSE
  9494*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9495*                                   CM-AH-ITD-CANCEL-AMT.
  9496
  9497     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9498     MOVE 'R'                     TO  TYPEO.
  9499
  9500     IF PI-COMPANY-ID = 'TMS'
  9501         MOVE WS-NAME-WORK         TO PAYTO1I
  9502                                      PI-PAYTO1
  9503         MOVE AL-UANON             TO PAYTO1A
  9504     ELSE
  9505         MOVE WS-NAME-WORK         TO PAYTO1I
  9506                                      PI-PAYTO1
  9507         MOVE AL-UANON             TO PAYTO1A.
  9508
  9509*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9510*    MOVE AL-UANON                 TO PAYTO1AA.
  9511
  9512     move 'N'                    to dedcyni
  9513     move al-uanon               to dedcyna
  9514     move 'BENE'                 to payeeo
  9515     move al-panon               to payeea
  9516     IF PI-MAIL-YES
  9517         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 174
* EL677.cbl
  9518
  9519     GO TO 8100-SEND-INITIAL-MAP.
  9520
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 175
* EL677.cbl
  9522
  9523 6620-MAILING-ADDRESS.
  9524
  9525* EXEC CICS HANDLE CONDITION
  9526*        NOTFND   (6670-NO-beneficiary)
  9527*    END-EXEC.
  9528*    MOVE '"$I                   ! 2 #00008642' TO DFHEIV0
  9529     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9531     MOVE X'3220233030303038363432' TO DFHEIV0(25:11)
  9532     CALL 'kxdfhei1' USING DFHEIV0
  9533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9534
  9535
  9536
  9537* EXEC CICS READ
  9538*        DATASET   (ERMAIL-FILE-ID)
  9539*        SET       (ADDRESS OF MAILING-DATA)
  9540*        RIDFLD    (ELCERT-KEY)
  9541*    END-EXEC.
  9542*    MOVE '&"S        E          (   #00008646' TO DFHEIV0
  9543     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9544     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9545     MOVE X'2020233030303038363436' TO DFHEIV0(25:11)
  9546     CALL 'kxdfhei1' USING DFHEIV0,
  9547           ERMAIL-FILE-ID,
  9548           DFHEIV20,
  9549           DFHEIV99,
  9550           ELCERT-KEY,
  9551           DFHEIV99,
  9552           DFHEIV99,
  9553           DFHEIV99
  9554     SET ADDRESS OF MAILING-DATA TO
  9555         DFHEIV20
  9556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9557
  9558
  9559     move spaces                 to payto2i
  9560     move ma-cred-bene-name      to payto1i
  9561     MOVE MA-cred-bene-addr      TO PAYad1I.
  9562     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9563     move ma-cred-bene-city      to payctyi
  9564     move ma-cred-bene-state     to paysti
  9565     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9566     MOVE AL-UANON               TO payto1a
  9567                                    PAYTO2A
  9568                                    PAYad1A
  9569                                    payad2a
  9570                                    PAYctyA
  9571                                    paysta
  9572                                    PTOZIPA.
  9573
  9574     GO TO 6690-EXIT.
  9575
  9576 6670-NO-BENEFICIARY.
  9577     MOVE -1                     TO  PAYTO1L.
  9578     MOVE ER-2394                TO  EMI-ERROR.
  9579     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 176
* EL677.cbl
  9580
  9581 6690-EXIT.
  9582      EXIT.
  9583 6700-build-common.
  9584     if not eracct-found
  9585        move pi-company-cd       to eracct-co
  9586        move pi-carrier          to eracct-carrier
  9587        move pi-grouping         to eracct-grouping
  9588        move pi-state            to eracct-state
  9589        move pi-account          to eracct-account
  9590        move pi-cert-eff-dt      to eracct-exp-date
  9591        if not eracct-found
  9592           perform 1420-get-eracct  thru 1490-exit
  9593        end-if
  9594     end-if
  9595*    if WS-PNDB-NOT-FOUND
  9596*       perform 5600-get-erpndb thru 5600-exit
  9597*    end-if
  9598     MOVE LOW-VALUES             TO  EL677AI.
  9599     MOVE 'A'                    TO  MAINTI.
  9600     MOVE AL-UANON               TO  MAINTA.
  9601     MOVE +1                     TO  MAINTL.
  9602     MOVE PI-CARRIER             TO  CARRIERO.
  9603     MOVE PI-GROUPING            TO  GROUPO.
  9604     MOVE PI-STATE               TO  STATEO.
  9605     MOVE PI-ACCOUNT             TO  ACCTO.
  9606     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9607     MOVE PI-CERT-SFX            TO  SFXO.
  9608     MOVE PI-AMOUNT              TO  AMOUNTO.
  9609     MOVE PI-TYPE                TO  TYPEO.
  9610     move pi-return-to           to  rettoo
  9611*    MOVE PI-REFERENCE           TO  REFO.
  9612     MOVE PI-PAYTO1              TO  PAYTO1O.
  9613     MOVE AL-UANON               TO  CARRIERA
  9614                                     GROUPA
  9615                                     STATEA
  9616                                     ACCTA
  9617                                     CERTNOA
  9618                                     SFXA
  9619                                     PAYTO1A
  9620                                     PAYTO2A
  9621*                                    AMOUNTA
  9622                                     TYPEA
  9623                                     rettoa.
  9624     move al-panon               to amounta
  9625     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9626     MOVE ' '                    TO  DC-OPTION-CODE.
  9627     PERFORM 8500-DATE-CONVERT.
  9628     IF NO-CONVERSION-ERROR
  9629         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9630         MOVE AL-UANON            TO  EFFDTA
  9631         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9632         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9633     ELSE
  9634         GO TO 8200-SEND-DATAONLY.
  9635     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9636         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
  9637         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 177
* EL677.cbl
  9638     ELSE
  9639         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9640         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9641     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9642     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9643     move spaces to pi-insured-name
  9644     string cm-insured-last-name ' '
  9645            cm-insured-first-name delimited by '  '
  9646        into pi-insured-name
  9647     end-string
  9648     move spaces                 to pi-table-name
  9649     string cm-insured-last-name ', '
  9650            cm-insured-first-name ' '
  9651            cm-insured-initial2
  9652        delimited by '  '
  9653        into
  9654           pi-table-name
  9655     end-string
  9656*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9657     if eibaid = dfhpf5
  9658        move 'Y'                 to dedcyni
  9659        move al-uanon            to dedcyna
  9660     end-if
  9661    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9662       cm-lf-alt-premium-amt
  9663    compute ws-tot-iss-prem  =
  9664       cm-ah-premium-amt + ws-tot-lf-prem
  9665    compute ws-tot-iss-comm =
  9666       (ws-tot-lf-prem * cm-life-comm-pct) +
  9667       (cm-ah-premium-amt * cm-ah-comm-pct)
  9668    compute ws-tot-ref-comm =
  9669       (pi-lf-refund * cm-life-comm-pct) +
  9670       (pi-ah-refund * cm-ah-comm-pct)
  9671     move ws-tot-iss-prem         to premo
  9672     move ws-tot-iss-comm         to isscommo
  9673     compute refo = pi-lf-refund + pi-ah-refund
  9674     move ws-tot-ref-comm         to uecommo
  9675                                     pi-ue-comm
  9676     move pi-prev-paid            to prepdo
  9677     compute ws-refund-amount = pi-refund-on-pending-rec -
  9678        pi-prev-paid
  9679     if (dedcyni = 'Y')
  9680        or (pi-prev-ded-comm = 'Y')
  9681        compute ws-refund-amount = ws-refund-amount -
  9682           ws-tot-ref-comm
  9683     end-if
  9684     if not WS-CERT-NOT-FOUND
  9685        string
  9686           pi-cert-prime         ' : '
  9687           cm-insured-last-name  ', '
  9688           cm-insured-first-name ' : '
  9689           pi-account            ' : '
  9690           pi-am-csr delimited by '  ' into text1o
  9691        end-string
  9692        move al-uanon            to text1a
  9693        MOVE 'REF'               TO WS-USER-REASON
  9694        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9695        inspect ws-user-cert-no replacing leading zeros
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 178
* EL677.cbl
  9696           by spaces
  9697        move pi-insured-name     to ws-user-name
  9698        perform varying s1 from +1 by +1 until
  9699           (s1 > +11)
  9700           or (ws-user-cert-no (s1:1)) <> ' '
  9701        end-perform
  9702        string ws-user-reason  ' ' delimited by size
  9703               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9704                  delimited by size
  9705               cm-insured-last-name ' '
  9706               cm-insured-first-name delimited by '  '
  9707           into stubo
  9708        end-string
  9709        move al-uanon            to stuba
  9710     end-if
  9711     .
  9712 6700-exit.
  9713     exit.
  9714 6800-browse-previous-chek-recs.
  9715***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9716***                                                            ***
  9717**** this should be the first time through, we need to gather  ***
  9718**** all the erchek records for this pending record, add the   ***
  9719**** amounts and make sure this check request will not exceed  ***
  9720**** the collected premium                                     ***
  9721***                                                            ***
  9722***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9723     move zeros                  to pi-prev-paid
  9724                                    ws-browse-sw
  9725                                    pi-chek-rec-cnt
  9726     move spaces                 to pi-prev-ded-comm
  9727     move pi-company-cd          to chek-company-cd
  9728     move pi-carrier             to chek-carrier
  9729     move pi-grouping            to chek-grouping
  9730     move pi-state               to chek-state
  9731     move pi-account             to chek-account
  9732     move pi-cert-prime          to chek-cert-no
  9733     move pi-cert-sfx            to chek-suf-no
  9734     move pi-cert-eff-dt         to chek-eff-dt
  9735     move +0                     to chek-record-seq
  9736     move erchek-key             to ws-compare-erchek-key
  9737
  9738* EXEC CICS STARTBR
  9739*       DATASET  (ERCHEK-FILE-ID)
  9740*       RIDFLD   (ERCHEK-KEY)
  9741*       resp     (ws-response)
  9742*    END-EXEC
  9743     MOVE 0
  9744       TO DFHEIV11
  9745*    MOVE '&,         G          &  N#00008830' TO DFHEIV0
  9746     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9747     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9748     MOVE X'204E233030303038383330' TO DFHEIV0(25:11)
  9749     CALL 'kxdfhei1' USING DFHEIV0,
  9750           ERCHEK-FILE-ID,
  9751           ERCHEK-KEY,
  9752           DFHEIV99,
  9753           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 179
* EL677.cbl
  9754           DFHEIV99
  9755     MOVE EIBRESP  TO ws-response
  9756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9757     if not resp-normal
  9758        go to 6800-exit
  9759     end-if
  9760     perform until i-say-when
  9761
  9762* EXEC CICS READNEXT
  9763*          DATASET   (ERCHEK-FILE-ID)
  9764*          SET       (ADDRESS OF CHECK-RECORDS)
  9765*          RIDFLD    (ERCHEK-KEY)
  9766*          resp      (ws-response)
  9767*       END-EXEC
  9768     MOVE 0
  9769       TO DFHEIV11
  9770*    MOVE '&.S                   )  N#00008839' TO DFHEIV0
  9771     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9772     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9773     MOVE X'204E233030303038383339' TO DFHEIV0(25:11)
  9774     CALL 'kxdfhei1' USING DFHEIV0,
  9775           ERCHEK-FILE-ID,
  9776           DFHEIV20,
  9777           DFHEIV99,
  9778           ERCHEK-KEY,
  9779           DFHEIV99,
  9780           DFHEIV11,
  9781           DFHEIV99,
  9782           DFHEIV99
  9783     SET ADDRESS OF CHECK-RECORDS TO
  9784         DFHEIV20
  9785     MOVE EIBRESP  TO ws-response
  9786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9787        if resp-normal
  9788           and erchek-key (1:33) = ws-compare-erchek-key
  9789           if ch-void-dt = low-values
  9790              and not ch-denied
  9791              compute pi-prev-paid = pi-prev-paid +
  9792                 ch-amount-paid
  9793              add +1 to pi-chek-rec-cnt
  9794              move ch-deduct-commission
  9795                                 to pi-prev-ded-comm
  9796           end-if
  9797        else
  9798           set i-say-when to true
  9799        end-if
  9800     end-perform
  9801     .
  9802 6800-exit.
  9803     exit.
  9804 7000-SET-PI-AREA.
  9805     MOVE CARRIERI               TO  PI-CARRIER
  9806                                     PI-CHEK-CARRIER.
  9807     MOVE GROUPI                 TO  PI-GROUPING
  9808                                     PI-CHEK-GROUPING.
  9809     MOVE STATEI                 TO  PI-STATE
  9810                                     PI-CHEK-STATE.
  9811     MOVE ACCTI                  TO  PI-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 180
* EL677.cbl
  9812                                     PI-CHEK-ACCOUNT.
  9813     MOVE CERTNOI                TO  PI-CERT-PRIME
  9814                                     PI-CHEK-CERT-NO.
  9815     IF SFXI NOT = LOW-VALUES
  9816         MOVE SFXI               TO  PI-CERT-SFX
  9817                                     PI-CHEK-SUF-NO
  9818     ELSE
  9819         MOVE SPACE              TO  PI-CERT-SFX
  9820                                     PI-CHEK-SUF-NO.
  9821
  9822     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
  9823     MOVE '2'                    TO  DC-OPTION-CODE.
  9824     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9825     IF DATE-CONVERSION-ERROR
  9826         MOVE ER-0215            TO  EMI-ERROR
  9827         MOVE -1                 TO  EFFDTL
  9828         MOVE AL-UNBON           TO  EFFDTA
  9829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9830         GO TO 8200-SEND-DATAONLY
  9831     ELSE
  9832         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
  9833                                     PI-CHEK-EFF-DT.
  9834
  9835 7090-EXIT.
  9836      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 181
* EL677.cbl
  9838 7100-CREATE-TEMP-STORAGE.
  9839     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9840
  9841
  9842* EXEC CICS WRITEQ TS
  9843*        QUEUE   (QID)
  9844*        FROM    (PROGRAM-INTERFACE-BLOCK)
  9845*        LENGTH  (PI-COMM-LENGTH)
  9846*    END-EXEC.
  9847*    MOVE '*"                    ''   #00008899' TO DFHEIV0
  9848     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  9849     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9850     MOVE X'2020233030303038383939' TO DFHEIV0(25:11)
  9851     CALL 'kxdfhei1' USING DFHEIV0,
  9852           QID,
  9853           PROGRAM-INTERFACE-BLOCK,
  9854           PI-COMM-LENGTH,
  9855           DFHEIV99,
  9856           DFHEIV99,
  9857           DFHEIV99
  9858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9859
  9860
  9861 7100-EXIT.
  9862      EXIT.
  9863
  9864 7200-RECOVER-TEMP-STORAGE.
  9865
  9866* EXEC CICS READQ TS
  9867*        QUEUE   (QID)
  9868*        INTO    (PROGRAM-INTERFACE-BLOCK)
  9869*        LENGTH  (PI-COMM-LENGTH)
  9870*    END-EXEC.
  9871*    MOVE '*$I    L              ''   #00008909' TO DFHEIV0
  9872     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9873     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9874     MOVE X'2020233030303038393039' TO DFHEIV0(25:11)
  9875     CALL 'kxdfhei1' USING DFHEIV0,
  9876           QID,
  9877           PROGRAM-INTERFACE-BLOCK,
  9878           PI-COMM-LENGTH,
  9879           DFHEIV99,
  9880           DFHEIV99,
  9881           DFHEIV99
  9882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9883
  9884
  9885     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9886
  9887 7200-EXIT.
  9888      EXIT.
  9889
  9890 7300-DELETE-TEMP-STORAGE.
  9891
  9892* EXEC CICS HANDLE CONDITION
  9893*        QIDERR  (7300-EXIT)
  9894*    END-EXEC.
  9895*    MOVE '"$N                   ! 3 #00008921' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 182
* EL677.cbl
  9896     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9898     MOVE X'3320233030303038393231' TO DFHEIV0(25:11)
  9899     CALL 'kxdfhei1' USING DFHEIV0
  9900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9901
  9902
  9903
  9904* EXEC CICS DELETEQ TS
  9905*        QUEUE  (QID)
  9906*    END-EXEC.
  9907*    MOVE '*&                    #   #00008925' TO DFHEIV0
  9908     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9909     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9910     MOVE X'2020233030303038393235' TO DFHEIV0(25:11)
  9911     CALL 'kxdfhei1' USING DFHEIV0,
  9912           QID,
  9913           DFHEIV99
  9914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9915
  9916
  9917 7300-EXIT.
  9918      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 183
* EL677.cbl
  9920 8035-LETR-NOT-OPEN.
  9921
  9922     MOVE ER-0013                TO EMI-ERROR.
  9923*    MOVE -1                     TO LETTER1L
  9924     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9925     GO TO 8200-SEND-DATAONLY.
  9926
  9927 8035-EXIT.
  9928     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 184
* EL677.cbl
  9930 8100-SEND-INITIAL-MAP.
  9931     MOVE SAVE-DATE              TO  DATEO.
  9932     MOVE EIBTIME                TO  TIME-IN.
  9933     MOVE TIME-OUT               TO  TIMEO.
  9934     MOVE -1                     TO  MAINTL
  9935     move al-uanon               to mainta
  9936     if PI-TO-EL677-FROM-EL1273
  9937        move al-sadof            to pf357a
  9938                                    pf46a
  9939                                    dprema
  9940                                    dcomma
  9941                                    drefa
  9942                                    duecomma
  9943                                    dprepda
  9944                                    prema
  9945                                    isscomma
  9946                                    refa
  9947                                    uecomma
  9948                                    prepda
  9949                                    dmaint2a
  9950        move ', VOID(V)'         to dmaint1o
  9951     end-if
  9952     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9953     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9954
  9955
  9956* EXEC CICS SEND
  9957*        MAP      (EL677A)
  9958*        MAPSET   (MAPSET-NAME)
  9959*        FROM     (EL677AO)
  9960*        ERASE
  9961*        CURSOR
  9962*    END-EXEC.
  9963     MOVE LENGTH OF
  9964      EL677AO
  9965       TO DFHEIV12
  9966     MOVE -1
  9967       TO DFHEIV11
  9968*    MOVE '8$     CT  E    H L F ,   #00008967' TO DFHEIV0
  9969     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9970     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9971     MOVE X'2020233030303038393637' TO DFHEIV0(25:11)
  9972     CALL 'kxdfhei1' USING DFHEIV0,
  9973           EL677A,
  9974           EL677AO,
  9975           DFHEIV12,
  9976           MAPSET-NAME,
  9977           DFHEIV99,
  9978           DFHEIV99,
  9979           DFHEIV99,
  9980           DFHEIV11,
  9981           DFHEIV99,
  9982           DFHEIV99,
  9983           DFHEIV99
  9984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9985
  9986
  9987     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 185
* EL677.cbl
  9989 8200-SEND-DATAONLY.
  9990     if connected-to-db
  9991        perform 4300-FINISH-UP-DB thru 4300-exit
  9992     end-if
  9993     MOVE SAVE-DATE              TO  DATEO.
  9994     MOVE EIBTIME                TO  TIME-IN.
  9995     MOVE TIME-OUT               TO  TIMEO.
  9996     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9997     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9998
  9999
 10000* EXEC CICS SEND
 10001*        MAP     (EL677A)
 10002*        MAPSET  (MAPSET-NAME)
 10003*        FROM    (EL677AO)
 10004*        DATAONLY
 10005*        CURSOR
 10006*    END-EXEC.
 10007     MOVE LENGTH OF
 10008      EL677AO
 10009       TO DFHEIV12
 10010     MOVE -1
 10011       TO DFHEIV11
 10012*    MOVE '8$D    CT       H L F ,   #00008987' TO DFHEIV0
 10013     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10014     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10015     MOVE X'2020233030303038393837' TO DFHEIV0(25:11)
 10016     CALL 'kxdfhei1' USING DFHEIV0,
 10017           EL677A,
 10018           EL677AO,
 10019           DFHEIV12,
 10020           MAPSET-NAME,
 10021           DFHEIV99,
 10022           DFHEIV99,
 10023           DFHEIV99,
 10024           DFHEIV11,
 10025           DFHEIV99,
 10026           DFHEIV99,
 10027           DFHEIV99
 10028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10029
 10030
 10031     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 186
* EL677.cbl
 10033 8300-SEND-TEXT.
 10034
 10035* EXEC CICS SEND TEXT
 10036*        FROM     (LOGOFF-TEXT)
 10037*        LENGTH   (LOGOFF-LENGTH)
 10038*        ERASE
 10039*        FREEKB
 10040*    END-EXEC.
 10041*    MOVE '8&      T  E F  H   F -   #00008998' TO DFHEIV0
 10042     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10043     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10044     MOVE X'2020233030303038393938' TO DFHEIV0(25:11)
 10045     CALL 'kxdfhei1' USING DFHEIV0,
 10046           LOGOFF-TEXT,
 10047           LOGOFF-LENGTH,
 10048           DFHEIV99,
 10049           DFHEIV99,
 10050           DFHEIV99,
 10051           DFHEIV99,
 10052           DFHEIV99,
 10053           DFHEIV99,
 10054           DFHEIV99,
 10055           DFHEIV99,
 10056           DFHEIV99,
 10057           DFHEIV99
 10058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10059
 10060
 10061
 10062* EXEC CICS RETURN
 10063*    END-EXEC.
 10064*    MOVE '.(                    ''   #00009005' TO DFHEIV0
 10065     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10066     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10067     MOVE X'2020233030303039303035' TO DFHEIV0(25:11)
 10068     CALL 'kxdfhei1' USING DFHEIV0,
 10069           DFHEIV99,
 10070           DFHEIV99,
 10071           DFHEIV99,
 10072           DFHEIV99,
 10073           DFHEIV99,
 10074           DFHEIV99
 10075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10076
 10077
 10078 8500-DATE-CONVERT.
 10079     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10080
 10081
 10082* EXEC CICS LINK
 10083*        PROGRAM    (PGM-NAME)
 10084*        COMMAREA   (DATE-CONVERSION-DATA)
 10085*        LENGTH     (DC-COMM-LENGTH)
 10086*    END-EXEC.
 10087*    MOVE '."C                   (   #00009011' TO DFHEIV0
 10088     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10090     MOVE X'2020233030303039303131' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 187
* EL677.cbl
 10091     CALL 'kxdfhei1' USING DFHEIV0,
 10092           PGM-NAME,
 10093           DATE-CONVERSION-DATA,
 10094           DC-COMM-LENGTH,
 10095           DFHEIV99,
 10096           DFHEIV99,
 10097           DFHEIV99,
 10098           DFHEIV99
 10099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10100
 10101
 10102 8500-EXIT.
 10103      EXIT.
 10104
 10105 8600-DEEDIT.
 10106
 10107* EXEC CICS BIF DEEDIT
 10108*        FIELD   (WS-DEEDIT-FIELD)
 10109*        LENGTH  (10)
 10110*    END-EXEC.
 10111     MOVE 10
 10112       TO DFHEIV11
 10113*    MOVE '@"L                   #   #00009021' TO DFHEIV0
 10114     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10115     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10116     MOVE X'2020233030303039303231' TO DFHEIV0(25:11)
 10117     CALL 'kxdfhei1' USING DFHEIV0,
 10118           WS-DEEDIT-FIELD,
 10119           DFHEIV11
 10120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10121
 10122
 10123 8600-EXIT.
 10124      EXIT.
 10125
 10126 8700-DEEDIT.
 10127
 10128* EXEC CICS BIF DEEDIT
 10129*        FIELD   (WS-DT-DEEDIT-FIELD)
 10130*        LENGTH  (10)
 10131*    END-EXEC.
 10132     MOVE 10
 10133       TO DFHEIV11
 10134*    MOVE '@"L                   #   #00009030' TO DFHEIV0
 10135     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10136     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10137     MOVE X'2020233030303039303330' TO DFHEIV0(25:11)
 10138     CALL 'kxdfhei1' USING DFHEIV0,
 10139           WS-DT-DEEDIT-FIELD,
 10140           DFHEIV11
 10141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10142
 10143
 10144 8700-EXIT.
 10145      EXIT.
 10146
 10147 8800-UNAUTHORIZED-ACCESS.
 10148     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 188
* EL677.cbl
 10149     GO TO 8300-SEND-TEXT.
 10150
 10151 8810-PF23.
 10152     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10153     MOVE XCTL-005               TO  PGM-NAME.
 10154     GO TO 9300-XCTL.
 10155
 10156
 10157 9100-RETURN-TRAN.
 10158     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10159     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10160
 10161* EXEC CICS RETURN
 10162*        TRANSID  (TRANS-ID)
 10163*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10164*        LENGTH   (PI-COMM-LENGTH)
 10165*    END-EXEC.
 10166*    MOVE '.(CT                  ''   #00009051' TO DFHEIV0
 10167     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10168     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10169     MOVE X'2020233030303039303531' TO DFHEIV0(25:11)
 10170     CALL 'kxdfhei1' USING DFHEIV0,
 10171           TRANS-ID,
 10172           PROGRAM-INTERFACE-BLOCK,
 10173           PI-COMM-LENGTH,
 10174           DFHEIV99,
 10175           DFHEIV99,
 10176           DFHEIV99
 10177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10178
 10179
 10180
 10181* GOBACK.
 10182     MOVE '9%                    "   ' TO DFHEIV0
 10183     MOVE 'EL677' TO DFHEIV1
 10184     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10185     GOBACK.
 10186
 10187 9200-RETURN-MAIN-MENU.
 10188     MOVE XCTL-626               TO  PGM-NAME.
 10189     GO TO 9300-XCTL.
 10190
 10191 9300-XCTL.
 10192
 10193* EXEC CICS XCTL
 10194*        PROGRAM    (PGM-NAME)
 10195*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10196*        LENGTH     (PI-COMM-LENGTH)
 10197*    END-EXEC.
 10198*    MOVE '.$C                   %   #00009064' TO DFHEIV0
 10199     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10200     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10201     MOVE X'2020233030303039303634' TO DFHEIV0(25:11)
 10202     CALL 'kxdfhei1' USING DFHEIV0,
 10203           PGM-NAME,
 10204           PROGRAM-INTERFACE-BLOCK,
 10205           PI-COMM-LENGTH,
 10206           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 189
* EL677.cbl
 10207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10208
 10209
 10210 9400-CLEAR.
 10211     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10212     MOVE SPACES                 TO  PI-PFKEY.
 10213     GO TO 9300-XCTL.
 10214
 10215 9500-PF12.
 10216     MOVE XCTL-010               TO  PGM-NAME.
 10217     GO TO 9300-XCTL.
 10218
 10219 9600-PGMID-ERROR.
 10220
 10221* EXEC CICS HANDLE CONDITION
 10222*        PGMIDERR    (8300-SEND-TEXT)
 10223*    END-EXEC.
 10224*    MOVE '"$L                   ! 4 #00009080' TO DFHEIV0
 10225     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10227     MOVE X'3420233030303039303830' TO DFHEIV0(25:11)
 10228     CALL 'kxdfhei1' USING DFHEIV0
 10229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10230
 10231
 10232     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10233     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10234     MOVE XCTL-005               TO  PGM-NAME.
 10235     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10236     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10237
 10238     GO TO 9300-XCTL.
 10239
 10240 9900-ERROR-FORMAT.
 10241     IF NOT EMI-ERRORS-COMPLETE
 10242         MOVE LINK-001           TO  PGM-NAME
 10243
 10244* EXEC CICS LINK
 10245*            PROGRAM    (PGM-NAME)
 10246*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10247*            LENGTH     (EMI-COMM-LENGTH)
 10248*        END-EXEC.
 10249*    MOVE '."C                   (   #00009095' TO DFHEIV0
 10250     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10252     MOVE X'2020233030303039303935' TO DFHEIV0(25:11)
 10253     CALL 'kxdfhei1' USING DFHEIV0,
 10254           PGM-NAME,
 10255           ERROR-MESSAGE-INTERFACE-BLOCK,
 10256           EMI-COMM-LENGTH,
 10257           DFHEIV99,
 10258           DFHEIV99,
 10259           DFHEIV99,
 10260           DFHEIV99
 10261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10262
 10263
 10264 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 190
* EL677.cbl
 10265      EXIT.
 10266
 10267 9990-ABEND.
 10268     MOVE LINK-004               TO  PGM-NAME.
 10269     MOVE DFHEIBLK               TO  EMI-LINE1.
 10270
 10271* EXEC CICS LINK
 10272*        PROGRAM   (PGM-NAME)
 10273*        COMMAREA  (EMI-LINE1)
 10274*        LENGTH    (72)
 10275*    END-EXEC.
 10276     MOVE 72
 10277       TO DFHEIV11
 10278*    MOVE '."C                   (   #00009107' TO DFHEIV0
 10279     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10280     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10281     MOVE X'2020233030303039313037' TO DFHEIV0(25:11)
 10282     CALL 'kxdfhei1' USING DFHEIV0,
 10283           PGM-NAME,
 10284           EMI-LINE1,
 10285           DFHEIV11,
 10286           DFHEIV99,
 10287           DFHEIV99,
 10288           DFHEIV99,
 10289           DFHEIV99
 10290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10291
 10292
 10293     GO TO 8200-SEND-DATAONLY.
 10294
 10295 9995-SECURITY-VIOLATION.
 10296*                            COPY ELCSCTP.
 10297******************************************************************
 10298*                                                                *
 10299*                            ELCSCTP                             *
 10300*                            VMOD=2.001                          *
 10301*                                                                *
 10302*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10303******************************************************************
 10304
 10305
 10306     MOVE EIBDATE          TO SM-JUL-DATE.
 10307     MOVE EIBTRMID         TO SM-TERMID.
 10308     MOVE THIS-PGM         TO SM-PGM.
 10309     MOVE EIBTIME          TO TIME-IN.
 10310     MOVE TIME-OUT         TO SM-TIME.
 10311     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10312
 10313
 10314* EXEC CICS LINK
 10315*         PROGRAM  ('EL003')
 10316*         COMMAREA (SECURITY-MESSAGE)
 10317*         LENGTH   (80)
 10318*    END-EXEC.
 10319     MOVE 'EL003' TO DFHEIV1
 10320     MOVE 80
 10321       TO DFHEIV11
 10322*    MOVE '."C                   (   #00009133' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 191
* EL677.cbl
 10323     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10324     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10325     MOVE X'2020233030303039313333' TO DFHEIV0(25:11)
 10326     CALL 'kxdfhei1' USING DFHEIV0,
 10327           DFHEIV1,
 10328           SECURITY-MESSAGE,
 10329           DFHEIV11,
 10330           DFHEIV99,
 10331           DFHEIV99,
 10332           DFHEIV99,
 10333           DFHEIV99
 10334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10335
 10336
 10337******************************************************************
 10338
 10339
 10340 9995-EXIT.
 10341     EXIT.
 10342
 10343
 10344 9999-DFHBACK SECTION.
 10345     MOVE '9%                    "   ' TO DFHEIV0
 10346     MOVE 'EL677' TO DFHEIV1
 10347     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10348     GOBACK.
 10349 9999-DFHEXIT.
 10350     IF DFHEIGDJ EQUAL 0001
 10351         NEXT SENTENCE
 10352     ELSE IF DFHEIGDJ EQUAL 2
 10353         GO TO 9600-PGMID-ERROR,
 10354               9990-ABEND
 10355         DEPENDING ON DFHEIGDI
 10356     ELSE IF DFHEIGDJ EQUAL 3
 10357         GO TO 8100-SEND-INITIAL-MAP
 10358         DEPENDING ON DFHEIGDI
 10359     ELSE IF DFHEIGDJ EQUAL 4
 10360         GO TO 1290-NO-CARRIER
 10361         DEPENDING ON DFHEIGDI
 10362     ELSE IF DFHEIGDJ EQUAL 5
 10363         GO TO 1380-NO-STATE
 10364         DEPENDING ON DFHEIGDI
 10365     ELSE IF DFHEIGDJ EQUAL 6
 10366         GO TO 1480-ACCOUNT-INVALID,
 10367               1480-ACCOUNT-INVALID
 10368         DEPENDING ON DFHEIGDI
 10369     ELSE IF DFHEIGDJ EQUAL 7
 10370         GO TO 1590-EXIT
 10371         DEPENDING ON DFHEIGDI
 10372     ELSE IF DFHEIGDJ EQUAL 8
 10373         GO TO 2200-DUPREC
 10374         DEPENDING ON DFHEIGDI
 10375     ELSE IF DFHEIGDJ EQUAL 9
 10376         GO TO 2577-DUPREC
 10377         DEPENDING ON DFHEIGDI
 10378     ELSE IF DFHEIGDJ EQUAL 10
 10379         GO TO 2600-NO-CO-MASTER
 10380         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 04-Mar-14 14:40 Page 192
* EL677.cbl
 10381     ELSE IF DFHEIGDJ EQUAL 11
 10382         GO TO 3900-RECORD-NOTFND
 10383         DEPENDING ON DFHEIGDI
 10384     ELSE IF DFHEIGDJ EQUAL 12
 10385         GO TO 3287-DUPREC
 10386         DEPENDING ON DFHEIGDI
 10387     ELSE IF DFHEIGDJ EQUAL 13
 10388         GO TO 3390-EXIT,
 10389               3390-EXIT
 10390         DEPENDING ON DFHEIGDI
 10391     ELSE IF DFHEIGDJ EQUAL 14
 10392         GO TO 5560-END-OF-FILE,
 10393               5560-END-OF-FILE
 10394         DEPENDING ON DFHEIGDI
 10395     ELSE IF DFHEIGDJ EQUAL 15
 10396         GO TO 6070-NO-COMP-MSTR
 10397         DEPENDING ON DFHEIGDI
 10398     ELSE IF DFHEIGDJ EQUAL 16
 10399         GO TO 6170-NO-CERTIFICATE
 10400         DEPENDING ON DFHEIGDI
 10401     ELSE IF DFHEIGDJ EQUAL 17
 10402         GO TO 6470-NO-ADDRESS
 10403         DEPENDING ON DFHEIGDI
 10404     ELSE IF DFHEIGDJ EQUAL 18
 10405         GO TO 6670-NO-beneficiary
 10406         DEPENDING ON DFHEIGDI
 10407     ELSE IF DFHEIGDJ EQUAL 19
 10408         GO TO 7300-EXIT
 10409         DEPENDING ON DFHEIGDI
 10410     ELSE IF DFHEIGDJ EQUAL 20
 10411         GO TO 8300-SEND-TEXT
 10412         DEPENDING ON DFHEIGDI.
 10413     MOVE '9%                    "   ' TO DFHEIV0
 10414     MOVE 'EL677' TO DFHEIV1
 10415     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10416     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      142340     Code:       38519
