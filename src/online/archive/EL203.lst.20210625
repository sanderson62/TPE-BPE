* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   1
* EL203.cbl
* Options: int("EL203.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL203.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL203.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL203.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2015 by Central States Health and Life          *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. EL203.
     9*
    10*AUTHOR.    Cowtown.
    11*           Colleyville, TEXAS.
    12*REMARKS.
    13***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   2
* EL203.cbl
    14***                                                            ***
    15***  This program is waken up by a http client/request         ***
    16***  and is passed several variables in the url. Cert key info,***
    17***  agent first and last names, license number and npn number.***
    18***  Next the program will read the certificate trailer file   ***
    19***  for that particular cert and update it with the agent     ***
    20***  name, license no and npn number.                          ***
    21***                                                            ***
    22***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 091114  CR2015010800003  PEMA  NEW PROGRAM
    32* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    33*-----------------------------------------------------------------
    34 environment division.
    35 data division.
    36 working-storage section.
    37 01  DFH-START PIC X(04).
    38 77  s1                          pic s999 comp-3 value +0.
    39 77  s2                          pic s999 comp-3 value +0.
    40 77  i1                          pic s999 comp-3 value +0.
    41 77  o1                          pic s999 comp-3 value +0.
    42 77  c1                          pic s999 comp-3 value +0.
    43 77  ws-current-bin-dt           pic xx value low-values.
    44 77  ws-bin-eom-dt               pic xx value low-values.
    45 77  ws-build-note-sw            pic x value ' '.
    46     88  finished-with-notes      value 'Y'.
    47 77  ws-cert-note-generic-key-len pic s9(4) comp value +34.
    48 77  note-count                  pic s999 comp-3 value +0.
    49 77  ws-ercnot-sw                pic x  value spaces.
    50     88  ercnot-startbr            value 'Y'.
    51 01  P pointer.
    52 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    53 01  var-ptr pointer.
    54 01  env-var-len                 pic 9(4)  binary.
    55 01  rc                          pic 9(9)  binary.
    56 01  WS-KIXSYS.
    57     05  WS-KIX-FIL1             PIC X(10).
    58     05  WS-KIX-APPS             PIC X(10).
    59     05  WS-KIX-ENV              PIC X(10).
    60     05  WS-KIX-MYENV            PIC X(10).
    61     05  WS-KIX-SYS              PIC X(10).
    62 01  ws-remit-id-a               pic x(10).
    63 01  ws-remit-id redefines
    64     ws-remit-id-a               pic 9(10).
    65 01  ws-key-stuff.
    66     05  ws-cert-key.
    67         10  ws-carrier          pic x.
    68         10  ws-state            pic xx.
    69         10  ws-account          pic x(10).
    70         10  ws-eff-date         pic x(8).
    71         10  ws-certificate      pic x(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   3
* EL203.cbl
    72         10  ws-cert-sfx         pic x.
    73         10  ws-batch-no         pic x(6).
    74         10  ws-region-id        pic x(6).
    75         10  ws-comp-id          pic xxx.
    76     05  filler                  pic x(10).
    77     05  ws-agent-first-name     pic x(20).
    78     05  ws-agent-mi             pic x.
    79     05  ws-agent-last-name      pic x(25).
    80     05  ws-agent-license-no     pic x(15).
    81     05  ws-agent-npn-no         pic x(10).
    82     05  ws-proc-id              pic x(4).
    83 01  ws-error-message            pic x(50) value spaces.
    84 01  WS-CZ-KEY.
    85     05  WS-CZ-COMPANY-CD        PIC X.
    86     05  WS-CZ-CARRIER           PIC X.
    87     05  WS-CZ-GROUP             PIC X(6).
    88     05  WS-CZ-STATE             PIC XX.
    89     05  WS-CZ-ACCOUNT           PIC X(10).
    90     05  WS-CZ-EFF-DT            PIC XX.
    91     05  WS-CZ-CERT-NO           PIC X(11).
    92     05  WS-CZ-REC-TYPE          PIC X.
    93     05  ws-cz-note-seq          pic s9(4) comp.
    94 01  FILE-KEYS.
    95     05  elcert-key.
    96         10  elcert-company-cd   pic x.
    97         10  elcert-carrier      pic x.
    98         10  elcert-grouping     pic x(6).
    99         10  elcert-state        pic xx.
   100         10  elcert-account      pic x(10).
   101         10  elcert-eff-dt       pic xx.
   102         10  elcert-certificate.
   103             15  elcert-cert     pic x(10).
   104             15  elcert-cert-sfx pic x.
   105     05  elcrtt-key.
   106         10  elcrtt-company-cd   pic x.
   107         10  elcrtt-carrier      pic x.
   108         10  elcrtt-grouping     pic x(6).
   109         10  elcrtt-state        pic xx.
   110         10  elcrtt-account      pic x(10).
   111         10  elcrtt-eff-dt       pic xx.
   112         10  elcrtt-cert-no      pic x(11).
   113         10  elcrtt-rec-type     pic x.
   114 01  cert-note-records-holder.
   115     05  cert-note-record occurs 300.
   116         10  filler              pic x(48).
   117         10  cnr-rest            pic x(102).
   118 01  ws-init-erpndb-rec          pic x(585) value spaces.
   119 01  ws-init-erpndm              pic x(374) value spaces.
   120 01  f.
   121     05  ws-batch-seq-no         pic s9(4) comp value +0.
   122     05  ws-connect-sw               pic x  value ' '.
   123         88  connected-to-db             value 'Y'.
   124     05  ws-comp-cd              pic x.
   125 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   126     88  RESP-NORMAL                    VALUE +0.
   127     88  resp-file-notfnd               value +12.
   128     88  RESP-NOTFND                    VALUE +13.
   129     88  resp-duprec                    value +14.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   4
* EL203.cbl
   130     88  resp-dupkey                    value +15.
   131     88  resp-invreq                    value +16.
   132     88  RESP-NOTOPEN                   VALUE +19.
   133     88  RESP-ENDFILE                   VALUE +20.
   134     88  resp-lengtherr                 value +22.
   135 01  ws-display-response         pic s9(5) value zeros.
   136 01  ws-work-time-a              pic x(6).
   137 01  ws-work-time redefines ws-work-time-a
   138                                 pic 9(6).
   139 01  ws-work-amt-alpha           pic x(11).
   140 01  ws-work-amt-num redefines ws-work-amt-alpha
   141                                 pic 9(9)v99.
   142 01  ws-qry-string               pic x(150) value spaces.
   143 01  ws-string-out               pic x(150) value spaces.
   144 01  ws-qrystr-len               pic s9(8) comp value +150.
   145 01  ws-var-alpha                pic x(10).
   146 01  ws-seq-alpha                pic x(5).
   147 01  ws-seq-no-num redefines ws-seq-alpha
   148                                 pic 9(5).
   149*                                copy ELCFUNDT.
   150*****************************************************************
   151*                                                               *
   152*                            ELCFUNDT.                          *
   153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   154*                            VMOD=2.001                         *
   155*                                                               *
   156*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   157*                                                               *
   158*****************************************************************
   159
   160
   161 01  FUNCTION-DATE.
   162     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   163     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   164         10  WS-FN-CCYR            PIC 9(4).
   165         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   166             15  WS-FN-CC          PIC 99.
   167             15  WS-FN-YR          PIC 99.
   168         10  WS-FN-MO              PIC 99.
   169         10  WS-FN-DA              PIC 99.
   170     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   171     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   172     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   173     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   174     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   175         88  WS-BEHIND-GMT                     VALUE '-'.
   176         88  WS-AFTER-GMT                      VALUE '+'.
   177         88  WS-NO-GMT                         VALUE ZERO.
   178     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   179     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   180*                                COPY ELCDATE.
   181******************************************************************
   182*                                                                *
   183*                                                                *
   184*                            ELCDATE.                            *
   185*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   186*                            VMOD=2.003
   187*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   5
* EL203.cbl
   188*                                                                *
   189*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   190*                 LENGTH = 200                                   *
   191******************************************************************
   192
   193 01  DATE-CONVERSION-DATA.
   194     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   195     12  DC-OPTION-CODE                PIC X.
   196         88  BIN-TO-GREG                VALUE ' '.
   197         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   198         88  EDIT-GREG-TO-BIN           VALUE '2'.
   199         88  YMD-GREG-TO-BIN            VALUE '3'.
   200         88  MDY-GREG-TO-BIN            VALUE '4'.
   201         88  JULIAN-TO-BIN              VALUE '5'.
   202         88  BIN-PLUS-ELAPSED           VALUE '6'.
   203         88  FIND-CENTURY               VALUE '7'.
   204         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   205         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   206         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   207         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   208         88  JULIAN-TO-BIN-3            VALUE 'C'.
   209         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   210         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   211         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   212         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   213         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   214         88  CHECK-LEAP-YEAR            VALUE 'H'.
   215         88  BIN-3-TO-GREG              VALUE 'I'.
   216         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   217         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   218         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   219         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   220         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   221         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   222         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   223         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   224         88  THREE-CHARACTER-BIN
   225                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   226         88  GREGORIAN-TO-BIN
   227                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   228         88  BIN-TO-GREGORIAN
   229                  VALUES ' ' '1' 'I' '8' 'G'.
   230         88  JULIAN-TO-BINARY
   231                  VALUES '5' 'C' 'E' 'F'.
   232     12  DC-ERROR-CODE                 PIC X.
   233         88  NO-CONVERSION-ERROR        VALUE ' '.
   234         88  DATE-CONVERSION-ERROR
   235                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   236         88  DATE-IS-ZERO               VALUE '1'.
   237         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   238         88  DATE-IS-INVALID            VALUE '3'.
   239         88  DATE1-GREATER-DATE2        VALUE '4'.
   240         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   241         88  DATE-INVALID-OPTION        VALUE '9'.
   242         88  INVALID-CENTURY            VALUE 'A'.
   243         88  ONLY-CENTURY               VALUE 'B'.
   244         88  ONLY-LEAP-YEAR             VALUE 'C'.
   245         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   6
* EL203.cbl
   246     12  DC-END-OF-MONTH               PIC X.
   247         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   248     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   249         88  USE-NORMAL-PROCESS         VALUE ' '.
   250         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   251         88  ADJUST-UP-100-YRS          VALUE '2'.
   252     12  FILLER                        PIC X.
   253     12  DC-CONVERSION-DATES.
   254         16  DC-BIN-DATE-1             PIC XX.
   255         16  DC-BIN-DATE-2             PIC XX.
   256         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   257         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   258                       DC-GREG-DATE-1-EDIT.
   259             20  DC-EDIT1-MONTH        PIC 99.
   260             20  SLASH1-1              PIC X.
   261             20  DC-EDIT1-DAY          PIC 99.
   262             20  SLASH1-2              PIC X.
   263             20  DC-EDIT1-YEAR         PIC 99.
   264         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   265         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   266                     DC-GREG-DATE-2-EDIT.
   267             20  DC-EDIT2-MONTH        PIC 99.
   268             20  SLASH2-1              PIC X.
   269             20  DC-EDIT2-DAY          PIC 99.
   270             20  SLASH2-2              PIC X.
   271             20  DC-EDIT2-YEAR         PIC 99.
   272         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   273         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   274                     DC-GREG-DATE-1-YMD.
   275             20  DC-YMD-YEAR           PIC 99.
   276             20  DC-YMD-MONTH          PIC 99.
   277             20  DC-YMD-DAY            PIC 99.
   278         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   279         16  DC-GREG-DATE-1-MDY-R REDEFINES
   280                      DC-GREG-DATE-1-MDY.
   281             20  DC-MDY-MONTH          PIC 99.
   282             20  DC-MDY-DAY            PIC 99.
   283             20  DC-MDY-YEAR           PIC 99.
   284         16  DC-GREG-DATE-1-ALPHA.
   285             20  DC-ALPHA-MONTH        PIC X(10).
   286             20  DC-ALPHA-DAY          PIC 99.
   287             20  FILLER                PIC XX.
   288             20  DC-ALPHA-CENTURY.
   289                 24 DC-ALPHA-CEN-N     PIC 99.
   290             20  DC-ALPHA-YEAR         PIC 99.
   291         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   292         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   293         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   294         16  DC-JULIAN-DATE            PIC 9(05).
   295         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   296                                       PIC 9(05).
   297         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   298             20  DC-JULIAN-YEAR        PIC 99.
   299             20  DC-JULIAN-DAYS        PIC 999.
   300         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   301         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   302         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   303     12  DATE-CONVERSION-VARIBLES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   7
* EL203.cbl
   304         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   305         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   306             20  FILLER                PIC 9(3).
   307             20  HOLD-CEN-1-CCYY.
   308                 24  HOLD-CEN-1-CC     PIC 99.
   309                 24  HOLD-CEN-1-YY     PIC 99.
   310             20  HOLD-CEN-1-MO         PIC 99.
   311             20  HOLD-CEN-1-DA         PIC 99.
   312         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   313             20  HOLD-CEN-1-R-MO       PIC 99.
   314             20  HOLD-CEN-1-R-DA       PIC 99.
   315             20  HOLD-CEN-1-R-CCYY.
   316                 24  HOLD-CEN-1-R-CC   PIC 99.
   317                 24  HOLD-CEN-1-R-YY   PIC 99.
   318             20  FILLER                PIC 9(3).
   319         16  HOLD-CENTURY-1-X.
   320             20  FILLER                PIC X(3)  VALUE SPACES.
   321             20  HOLD-CEN-1-X-CCYY.
   322                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   323                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   324             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   325             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   326         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   327             20  HOLD-CEN-1-R-X-MO     PIC XX.
   328             20  HOLD-CEN-1-R-X-DA     PIC XX.
   329             20  HOLD-CEN-1-R-X-CCYY.
   330                 24  HOLD-CEN-1-R-X-CC PIC XX.
   331                 24  HOLD-CEN-1-R-X-YY PIC XX.
   332             20  FILLER                PIC XXX.
   333         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   334         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   335         16  DC-JULIAN-DATE-1          PIC 9(07).
   336         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   337             20  DC-JULIAN-1-CCYY.
   338                 24  DC-JULIAN-1-CC    PIC 99.
   339                 24  DC-JULIAN-1-YR    PIC 99.
   340             20  DC-JULIAN-DA-1        PIC 999.
   341         16  DC-JULIAN-DATE-2          PIC 9(07).
   342         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   343             20  DC-JULIAN-2-CCYY.
   344                 24  DC-JULIAN-2-CC    PIC 99.
   345                 24  DC-JULIAN-2-YR    PIC 99.
   346             20  DC-JULIAN-DA-2        PIC 999.
   347         16  DC-GREG-DATE-A-EDIT.
   348             20  DC-EDITA-MONTH        PIC 99.
   349             20  SLASHA-1              PIC X VALUE '/'.
   350             20  DC-EDITA-DAY          PIC 99.
   351             20  SLASHA-2              PIC X VALUE '/'.
   352             20  DC-EDITA-CCYY.
   353                 24  DC-EDITA-CENT     PIC 99.
   354                 24  DC-EDITA-YEAR     PIC 99.
   355         16  DC-GREG-DATE-B-EDIT.
   356             20  DC-EDITB-MONTH        PIC 99.
   357             20  SLASHB-1              PIC X VALUE '/'.
   358             20  DC-EDITB-DAY          PIC 99.
   359             20  SLASHB-2              PIC X VALUE '/'.
   360             20  DC-EDITB-CCYY.
   361                 24  DC-EDITB-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   8
* EL203.cbl
   362                 24  DC-EDITB-YEAR     PIC 99.
   363         16  DC-GREG-DATE-CYMD         PIC 9(08).
   364         16  DC-GREG-DATE-CYMD-R REDEFINES
   365                              DC-GREG-DATE-CYMD.
   366             20  DC-CYMD-CEN           PIC 99.
   367             20  DC-CYMD-YEAR          PIC 99.
   368             20  DC-CYMD-MONTH         PIC 99.
   369             20  DC-CYMD-DAY           PIC 99.
   370         16  DC-GREG-DATE-MDCY         PIC 9(08).
   371         16  DC-GREG-DATE-MDCY-R REDEFINES
   372                              DC-GREG-DATE-MDCY.
   373             20  DC-MDCY-MONTH         PIC 99.
   374             20  DC-MDCY-DAY           PIC 99.
   375             20  DC-MDCY-CEN           PIC 99.
   376             20  DC-MDCY-YEAR          PIC 99.
   377    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   378        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   379    12  DC-EL310-DATE                  PIC X(21).
   380    12  FILLER                         PIC X(28).
   381*                                COPY ELCCNTL.
   382******************************************************************
   383*                                                                *
   384*                                                                *
   385*                            ELCCNTL.                            *
   386*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   387*                            VMOD=2.059                          *
   388*                                                                *
   389*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   390*                                                                *
   391*   FILE TYPE = VSAM,KSDS                                        *
   392*   RECORD SIZE = 750  RECFORM = FIXED                           *
   393*                                                                *
   394*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   395*       ALTERNATE INDEX = NONE                                   *
   396*                                                                *
   397*   LOG = YES                                                    *
   398*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   399******************************************************************
   400*                   C H A N G E   L O G
   401*
   402* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   403*-----------------------------------------------------------------
   404*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   405* EFFECTIVE    NUMBER
   406*-----------------------------------------------------------------
   407* 082503                   PEMA  ADD BENEFIT GROUP
   408* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   409* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   410* 092705    2005050300006  PEMA  ADD SPP LEASES
   411* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   412* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   413* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   414* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   415* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   416* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   417* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   418* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   419* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   9
* EL203.cbl
   420* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   421******************************************************************
   422*
   423 01  CONTROL-FILE.
   424     12  CF-RECORD-ID                       PIC XX.
   425         88  VALID-CF-ID                        VALUE 'CF'.
   426
   427     12  CF-CONTROL-PRIMARY.
   428         16  CF-COMPANY-ID                  PIC XXX.
   429         16  CF-RECORD-TYPE                 PIC X.
   430             88  CF-COMPANY-MASTER              VALUE '1'.
   431             88  CF-PROCESSOR-MASTER            VALUE '2'.
   432             88  CF-STATE-MASTER                VALUE '3'.
   433             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   434             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   435             88  CF-CARRIER-MASTER              VALUE '6'.
   436             88  CF-MORTALITY-MASTER            VALUE '7'.
   437             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   438             88  CF-TERMINAL-MASTER             VALUE '9'.
   439             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   440             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   441             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   442             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   443             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   444             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   445             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   446             88  CF-REMINDERS-MASTER            VALUE 'R'.
   447             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   448         16  CF-ACCESS-CD-GENL              PIC X(4).
   449         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   450             20  CF-PROCESSOR               PIC X(4).
   451         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   452             20  CF-STATE-CODE              PIC XX.
   453             20  FILLER                     PIC XX.
   454         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   455             20  FILLER                     PIC XX.
   456             20  CF-HI-BEN-IN-REC           PIC XX.
   457         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   458             20  FILLER                     PIC XXX.
   459             20  CF-CARRIER-CNTL            PIC X.
   460         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   461             20  FILLER                     PIC XX.
   462             20  CF-HI-TYPE-IN-REC          PIC 99.
   463         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   464             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   465                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   466             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   467             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   468         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   469             20  FILLER                     PIC X.
   470             20  CF-CUSTOM-REPORT-NO        PIC 999.
   471         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   472             20  FILLER                     PIC XX.
   473             20  CF-MORTGAGE-PLAN           PIC XX.
   474         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   475
   476     12  CF-LAST-MAINT-DT                   PIC XX.
   477     12  CF-LAST-MAINT-BY                   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  10
* EL203.cbl
   478     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   479
   480     12  CF-RECORD-BODY                     PIC X(728).
   481
   482
   483****************************************************************
   484*             COMPANY MASTER RECORD                            *
   485****************************************************************
   486
   487     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   488         16  CF-COMPANY-ADDRESS.
   489             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   490             20  CF-CL-IN-CARE-OF           PIC X(30).
   491             20  CF-CL-ADDR-LINE-1          PIC X(30).
   492             20  CF-CL-ADDR-LINE-2          PIC X(30).
   493             20  CF-CL-CITY-STATE           PIC X(30).
   494             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   495             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   496         16  CF-COMPANY-CD                  PIC X.
   497         16  CF-COMPANY-PASSWORD            PIC X(8).
   498         16  CF-SECURITY-OPTION             PIC X.
   499             88  ALL-SECURITY                   VALUE '1'.
   500             88  COMPANY-VERIFY                 VALUE '2'.
   501             88  PROCESSOR-VERIFY               VALUE '3'.
   502             88  NO-SECURITY                    VALUE '4'.
   503             88  ALL-BUT-TERM                   VALUE '5'.
   504         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   505             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   506         16  CF-LGX-INTERFACE-CNTL          PIC X.
   507             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   508         16  CF-INFORCE-LOCATION            PIC X.
   509             88  CERTS-ARE-ONLINE               VALUE '1'.
   510             88  CERTS-ARE-OFFLINE              VALUE '2'.
   511             88  NO-CERTS-AVAILABLE             VALUE '3'.
   512         16  CF-LOWER-CASE-LETTERS          PIC X.
   513         16  CF-CERT-ACCESS-CONTROL         PIC X.
   514             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   515             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   516             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   517             88  CF-ACCNT-CNTL                  VALUE '3'.
   518             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   519
   520         16  CF-FORMS-PRINTER-ID            PIC X(4).
   521         16  CF-CHECK-PRINTER-ID            PIC X(4).
   522
   523         16  CF-LGX-CREDIT-USER             PIC X.
   524             88  CO-IS-NOT-USER                 VALUE 'N'.
   525             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   526
   527         16 CF-CREDIT-CALC-CODES.
   528             20  CF-CR-REM-TERM-CALC PIC X.
   529               88  CR-EARN-AFTER-15TH           VALUE '1'.
   530               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   531               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   532               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   533               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   534               88  CR-EARN-AFTER-14TH           VALUE '6'.
   535               88  CR-EARN-AFTER-16TH           VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  11
* EL203.cbl
   536             20  CF-CR-R78-METHOD           PIC X.
   537               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   538               88  DONT-USE-PLUS-ONE            VALUE '1'.
   539
   540         16  CF-CLAIM-CONTROL-COUNTS.
   541             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   542                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   543
   544             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   545                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   546
   547             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   548                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   549
   550             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   551                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   552
   553         16  CF-CURRENT-MONTH-END           PIC XX.
   554
   555         16  CF-CO-CALC-QUOTE-TOLERANCE.
   556             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   557             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   558             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   559             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   560                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   561                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   562             20  CF-CO-PREM-REJECT-SW       PIC X.
   563                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   564                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   565             20  CF-CO-REF-REJECT-SW        PIC X.
   566                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   567                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   568
   569         16  CF-CO-REPORTING-DT             PIC XX.
   570         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   571         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   572           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   573           88  CF-CO-MONTH-END                  VALUE '1'.
   574
   575         16  CF-LGX-CLAIM-USER              PIC X.
   576             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   577             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   578
   579         16  CF-CREDIT-EDIT-CONTROLS.
   580             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   581             20  CF-MIN-AGE                 PIC 99.
   582             20  CF-DEFAULT-AGE             PIC 99.
   583             20  CF-MIN-TERM                PIC S999      COMP-3.
   584             20  CF-MAX-TERM                PIC S999      COMP-3.
   585             20  CF-DEFAULT-SEX             PIC X.
   586             20  CF-JOINT-AGE-INPUT         PIC X.
   587                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   588             20  CF-BIRTH-DATE-INPUT        PIC X.
   589                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   590             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   591                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   592                 88  CF-ZERO-CARRIER            VALUE '1'.
   593                 88  CF-ZERO-GROUPING           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  12
* EL203.cbl
   594                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   595             20  CF-EDIT-SW                 PIC X.
   596                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   597             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   598             20  CF-CR-PR-METHOD            PIC X.
   599               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   600               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   601             20  FILLER                     PIC X.
   602
   603         16  CF-CREDIT-MISC-CONTROLS.
   604             20  CF-REIN-TABLE-SW           PIC X.
   605                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   606             20  CF-COMP-TABLE-SW           PIC X.
   607                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   608             20  CF-EXPERIENCE-RETENTION-AGE
   609                                            PIC S9        COMP-3.
   610             20  CF-CONVERSION-DT           PIC XX.
   611             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   612             20  CF-RUN-FREQUENCY-SW        PIC X.
   613                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   614                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   615
   616             20  CF-CR-CHECK-NO-CONTROL.
   617                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   618                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   619                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   620                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   621                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   622                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   623
   624                 24  CF-CR-CHECK-COUNT       REDEFINES
   625                     CF-CR-CHECK-COUNTER      PIC X(4).
   626
   627                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   628                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   629
   630                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   631                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   632                 24  CF-MAIL-PROCESSING       PIC X.
   633                     88  MAIL-PROCESSING          VALUE 'Y'.
   634
   635         16  CF-MISC-SYSTEM-CONTROL.
   636             20  CF-SYSTEM-C                 PIC X.
   637                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   638             20  CF-SYSTEM-D                 PIC X.
   639                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   640             20  CF-SOC-SEC-NO-SW            PIC X.
   641                 88  SOC-SEC-NO-USED             VALUE '1'.
   642             20  CF-MEMBER-NO-SW             PIC X.
   643                 88  MEMBER-NO-USED              VALUE '1'.
   644             20  CF-TAX-ID-NUMBER            PIC X(11).
   645             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   646             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   647                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   648                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   649                 88  CF-ALL-APPROVED             VALUE 'Y'.
   650                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   651             20  CF-SYSTEM-E                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  13
* EL203.cbl
   652                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   653
   654         16  CF-LGX-LIFE-USER               PIC X.
   655             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   656             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   657
   658         16  CF-CR-MONTH-END-DT             PIC XX.
   659
   660         16  CF-FILE-MAINT-DATES.
   661             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   662                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   663             20  CF-LAST-BATCH       REDEFINES
   664                 CF-LAST-BATCH-NO               PIC X(4).
   665             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   666             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   667             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   668             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   669             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   670             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   671             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   672             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   673             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   674             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   675
   676         16  CF-NEXT-COMPANY-ID             PIC XXX.
   677         16  FILLER                         PIC X.
   678
   679         16  CF-ALT-MORT-CODE               PIC X(4).
   680         16  CF-MEMBER-CAPTION              PIC X(10).
   681
   682         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   683             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   684             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   685             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   686             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   687             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   688
   689         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   690
   691         16  CF-LIFE-OVERRIDE-L1            PIC X.
   692         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   693         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   694         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   695
   696         16  CF-AH-OVERRIDE-L1              PIC X.
   697         16  CF-AH-OVERRIDE-L2              PIC XX.
   698         16  CF-AH-OVERRIDE-L6              PIC X(6).
   699         16  CF-AH-OVERRIDE-L12             PIC X(12).
   700
   701         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   702         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   703
   704         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   705         16  CF-AR-LAST-EL860-DT            PIC XX.
   706         16  CF-MP-MONTH-END-DT             PIC XX.
   707
   708         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   709         16  CF-CLAIM-PAID-THRU-TO          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  14
* EL203.cbl
   710             88  CF-CLAIM-PAID-TO               VALUE '1'.
   711
   712         16  CF-AR-MONTH-END-DT             PIC XX.
   713
   714         16  CF-CRDTCRD-USER                PIC X.
   715             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   716             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   717
   718         16  CF-CC-MONTH-END-DT             PIC XX.
   719
   720         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   721
   722         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   723             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   724             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   725             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   726         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   727         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   728         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   729         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   730             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   731             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   732         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   733         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   734         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   735             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   736         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   737
   738         16  CF-CL-ZIP-CODE.
   739             20  CF-CL-ZIP-PRIME.
   740                 24  CF-CL-ZIP-1ST          PIC X.
   741                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   742                 24  FILLER                 PIC X(4).
   743             20  CF-CL-ZIP-PLUS4            PIC X(4).
   744         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   745             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   746             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   747             20  FILLER                     PIC XXX.
   748
   749         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   750         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   751         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   752         16  CF-CO-OPTION-START-DATE        PIC XX.
   753         16  CF-REM-TRM-CALC-OPTION         PIC X.
   754           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   755                                                      '3' '4'.
   756           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   757           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   758           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   759           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   760           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   761           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   762
   763         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   764
   765         16  CF-PAYMENT-APPROVAL-LEVELS.
   766             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   767             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  15
* EL203.cbl
   768             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   769             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   770             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   771             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   772
   773         16  CF-END-USER-REPORTING-USER     PIC X.
   774             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   775             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   776
   777         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   778             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   779             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   780
   781         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   782
   783         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   784         16  FILLER                         PIC X.
   785
   786         16  CF-CREDIT-ARCHIVE-CNTL.
   787             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   788             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   789             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   790
   791         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   792
   793         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   794             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   795             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   796
   797         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   798             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   799             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   800
   801         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   802
   803         16  CF-CO-ACH-ID-CODE              PIC  X.
   804             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   805             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   806             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   807         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   808         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   809         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   810         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   811         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   812         16  CF-CO-ACH-RECV-NO              PIC X(08).
   813         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   814         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   815         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   816                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   817         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   818                 CF-CO-ACH-TRACE-NO         PIC X(4).
   819
   820         16  CF-CO-OVER-SHORT.
   821             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   822             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   823
   824*         16  FILLER                         PIC X(102).
   825         16  CF-PAYMENT-APPROVAL-LEVELS-2.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  16
* EL203.cbl
   826             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   827             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   828
   829         16  CF-AH-APPROVAL-DAYS.
   830             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   831             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   832             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   833             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   834
   835         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
   836
   837         16  CF-APPROV-LEV-5.
   838             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
   839             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
   840             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
   841
   842         16  FILLER                         PIC X(68).
   843****************************************************************
   844*             PROCESSOR/USER RECORD                            *
   845****************************************************************
   846
   847     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   848         16  CF-PROCESSOR-NAME              PIC X(30).
   849         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   850         16  CF-PROCESSOR-TITLE             PIC X(26).
   851         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   852                 88  MESSAGE-YES                VALUE 'Y'.
   853                 88  MESSAGE-NO                 VALUE ' ' 'N'.
   854
   855*****************************************************
   856****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   857****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   858****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   859****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   860*****************************************************
   861
   862         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   863             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   864             20  CF-APPLICATION-FORCE       PIC X.
   865             20  CF-INDIVIDUAL-APP.
   866                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   867                     28  CF-BROWSE-APP      PIC X.
   868                     28  CF-UPDATE-APP      PIC X.
   869
   870         16  CF-CURRENT-TERM-ON             PIC X(4).
   871         16  CF-PROCESSOR-LIMITS-CLAIMS.
   872             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   873             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   874             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   875             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   876             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   877             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   878             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   879         16  CF-PROCESSOR-CARRIER           PIC X.
   880             88  NO-CARRIER-SECURITY            VALUE ' '.
   881         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   882             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   883         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  17
* EL203.cbl
   884             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   885         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   886             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   887
   888         16  CF-PROC-SYS-ACCESS-SW.
   889             20  CF-PROC-CREDIT-CLAIMS-SW.
   890                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   891                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   892                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   893                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   894             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   895                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   896                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   897             20  CF-PROC-LIFE-GNRLDGR-SW.
   898                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   899                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   900                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   901                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
   902             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
   903                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   904                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   905         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   906             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   907             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   908         16  CF-PROCESSOR-PRINTER               PIC X(4).
   909
   910         16  CF-APPROVAL-LEVEL                  PIC X.
   911             88  APPROVAL-LEVEL-1                   VALUE '1'.
   912             88  APPROVAL-LEVEL-2                   VALUE '2'.
   913             88  APPROVAL-LEVEL-3                   VALUE '3'.
   914             88  APPROVAL-LEVEL-4                   VALUE '4'.
   915             88  APPROVAL-LEVEL-5                   VALUE '5'.
   916
   917         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   918
   919         16  CF-LANGUAGE-TYPE                   PIC X.
   920             88  CF-LANG-IS-ENG                     VALUE 'E'.
   921             88  CF-LANG-IS-FR                      VALUE 'F'.
   922
   923         16  CF-CSR-IND                         PIC X.
   924         16  FILLER                             PIC X(239).
   925
   926****************************************************************
   927*             PROCESSOR/REMINDERS RECORD                       *
   928****************************************************************
   929
   930     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   931         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   932             20  CF-START-REMIND-DT         PIC XX.
   933             20  CF-END-REMIND-DT           PIC XX.
   934             20  CF-REMINDER-TEXT           PIC X(50).
   935         16  FILLER                         PIC X(296).
   936
   937
   938****************************************************************
   939*             STATE MASTER RECORD                              *
   940****************************************************************
   941
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  18
* EL203.cbl
   942     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   943         16  CF-STATE-ABBREVIATION          PIC XX.
   944         16  CF-STATE-NAME                  PIC X(25).
   945         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   946         16  CF-ST-CALC-QUOTE-TOLERANCE.
   947             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   948             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   949             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   950             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   951                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   952                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   953             20  CF-ST-PREM-REJECT-SW       PIC X.
   954                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   955                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   956             20  CF-ST-REF-REJECT-SW        PIC X.
   957                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   958                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   959         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
   960         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
   961         16  CF-ST-REFUND-RULES.
   962             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   963             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   964             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   965         16  CF-ST-FST-PMT-EXTENSION.
   966             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   967             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   968                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   969                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   970                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
   971                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   972         16  CF-ST-STATE-CALL.
   973             20  CF-ST-CALL-UNEARNED        PIC X.
   974             20  CF-ST-CALL-RPT-CNTL        PIC X.
   975             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   976         16  CF-REPLACEMENT-LAW-SW          PIC X.
   977             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   978             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   979         16  CF-REPLACEMENT-LETTER          PIC X(4).
   980         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   981         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   982         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   983         16  CF-ST-SPLIT-PAYMENT            PIC X.
   984         16  FILLER                         PIC X.
   985         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   986             20  CF-ST-BENEFIT-CD           PIC XX.
   987             20  CF-ST-BENEFIT-KIND         PIC X.
   988                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   989                 88  CF-ST-AH-KIND              VALUE 'A'.
   990             20  CF-ST-REM-TERM-CALC        PIC X.
   991                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   992                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   993                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   994                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   995                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   996                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   997                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   998                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   999
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  19
* EL203.cbl
  1000             20  CF-ST-REFUND-CALC          PIC X.
  1001                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1002                 88  ST-REFD-BY-R78             VALUE '1'.
  1003                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1004                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1005                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1006                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1007                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1008                 88  ST-REFD-UTAH               VALUE '7'.
  1009                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1010                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1011                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1012
  1013             20  CF-ST-EARNING-CALC         PIC X.
  1014                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1015                 88  ST-EARN-BY-R78             VALUE '1'.
  1016                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1017                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1018                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1019                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1020                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1021                 88  ST-EARN-MEAN               VALUE '8'.
  1022                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1023
  1024             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1025                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1026                 88  ST-OVRD-BY-R78             VALUE '1'.
  1027                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1028                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1029                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1030                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1031                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1032                 88  ST-OVRD-MEAN               VALUE '8'.
  1033                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1034             20  cf-st-extra-periods        pic 9.
  1035*            20  FILLER                     PIC X.
  1036
  1037         16  CF-ST-COMMISSION-CAPS.
  1038             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1039             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1040             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1041             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1042         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1043                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1044
  1045         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1046
  1047         16  CF-ST-STATUTORY-INTEREST.
  1048             20  CF-ST-STAT-DATE-FROM       PIC X.
  1049                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1050                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1051             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1052             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1053             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1054             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1055             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1056
  1057         16  CF-ST-OVER-SHORT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  20
* EL203.cbl
  1058             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1059             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1060
  1061         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1062
  1063         16  CF-ST-RT-CALC                  PIC X.
  1064
  1065         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1066         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1067         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1068         16  CF-ST-RF-LR-CALC               PIC X.
  1069         16  CF-ST-RF-LL-CALC               PIC X.
  1070         16  CF-ST-RF-LN-CALC               PIC X.
  1071         16  CF-ST-RF-AH-CALC               PIC X.
  1072         16  CF-ST-RF-CP-CALC               PIC X.
  1073*        16  FILLER                         PIC X(206).
  1074*CIDMOD         16  FILLER                         PIC X(192).
  1075         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1076             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1077         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1078         16  CF-ST-VFY-2ND-BENE             PIC X.
  1079         16  CF-ST-CAUSAL-STATE             PIC X.
  1080         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1081         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1082         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1083             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1084         16  CF-ST-NET-ONLY-STATE           PIC X.
  1085             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1086         16  FILLER                         PIC X(181).
  1087
  1088****************************************************************
  1089*             BENEFIT MASTER RECORD                            *
  1090****************************************************************
  1091
  1092     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1093         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1094             20  CF-BENEFIT-CODE            PIC XX.
  1095             20  CF-BENEFIT-NUMERIC  REDEFINES
  1096                 CF-BENEFIT-CODE            PIC XX.
  1097             20  CF-BENEFIT-ALPHA           PIC XXX.
  1098             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1099             20  CF-BENEFIT-COMMENT         PIC X(10).
  1100
  1101             20  CF-LF-COVERAGE-TYPE        PIC X.
  1102                 88  CF-REDUCING                VALUE 'R'.
  1103                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1104
  1105             20  CF-SPECIAL-CALC-CD         PIC X.
  1106                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1107                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1108                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1109                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1110                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1111                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1112                 88  CF-FARM-PLAN               VALUE 'F'.
  1113                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1114                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1115                 88  CF-3-MTH-INTEREST          VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  21
* EL203.cbl
  1116                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1117                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1118                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1119                 88  CF-PRUDENTIAL              VALUE 'P'.
  1120                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1121                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1122                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1123                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1124                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1125                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1126
  1127             20  CF-JOINT-INDICATOR         PIC X.
  1128                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1129
  1130*            20  FILLER                     PIC X(12).
  1131             20  cf-maximum-benefits        pic s999 comp-3.
  1132             20  FILLER                     PIC X(09).
  1133             20  CF-BENEFIT-CATEGORY        PIC X.
  1134             20  CF-LOAN-TYPE               PIC X(8).
  1135
  1136             20  CF-CO-REM-TERM-CALC        PIC X.
  1137                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1138                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1139                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1140                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1141                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1142
  1143             20  CF-CO-EARNINGS-CALC        PIC X.
  1144                 88  CO-EARN-BY-R78             VALUE '1'.
  1145                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1146                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1147                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1148                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1149                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1150                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1151                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1152
  1153             20  CF-CO-REFUND-CALC          PIC X.
  1154                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1155                 88  CO-REFD-BY-R78             VALUE '1'.
  1156                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1157                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1158                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1159                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1160                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1161                 88  CO-REFD-MEAN               VALUE '8'.
  1162                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1163                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1164                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1165
  1166             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1167                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1168                 88  CO-OVRD-BY-R78             VALUE '1'.
  1169                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1170                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1171                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1172                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1173                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  22
* EL203.cbl
  1174                 88  CO-OVRD-MEAN               VALUE '8'.
  1175                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1176
  1177             20  CF-CO-BEN-I-G-CD           PIC X.
  1178                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1179                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1180                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1181
  1182         16  FILLER                         PIC X(304).
  1183
  1184
  1185****************************************************************
  1186*             CARRIER MASTER RECORD                            *
  1187****************************************************************
  1188
  1189     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1190         16  CF-ADDRESS-DATA.
  1191             20  CF-MAIL-TO-NAME            PIC X(30).
  1192             20  CF-IN-CARE-OF              PIC X(30).
  1193             20  CF-ADDRESS-LINE-1          PIC X(30).
  1194             20  CF-ADDRESS-LINE-2          PIC X(30).
  1195             20  CF-CITY-STATE              PIC X(30).
  1196             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1197             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1198
  1199         16  CF-CLAIM-NO-CONTROL.
  1200             20  CF-CLAIM-NO-METHOD         PIC X.
  1201                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1202                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1203                 88  CLAIM-NO-SEQ               VALUE '3'.
  1204                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1205             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1206                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1207                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1208                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1209
  1210         16  CF-CHECK-NO-CONTROL.
  1211             20  CF-CHECK-NO-METHOD         PIC X.
  1212                 88  CHECK-NO-MANUAL            VALUE '1'.
  1213                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1214                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1215                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1216             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1217                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1218
  1219         16  CF-DOMICILE-STATE              PIC XX.
  1220
  1221         16  CF-EXPENSE-CONTROLS.
  1222             20  CF-EXPENSE-METHOD          PIC X.
  1223                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1224                 88  DOLLARS-PER-PMT            VALUE '2'.
  1225                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1226                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1227             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1228             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1229
  1230         16  CF-CORRESPONDENCE-CONTROL.
  1231             20  CF-LETTER-RESEND-OPT       PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  23
* EL203.cbl
  1232                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1233                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1234             20  FILLER                     PIC X(4).
  1235
  1236         16  CF-RESERVE-CONTROLS.
  1237             20  CF-MANUAL-SW               PIC X.
  1238                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1239             20  CF-FUTURE-SW               PIC X.
  1240                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1241             20  CF-PTC-SW                  PIC X.
  1242                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1243             20  CF-IBNR-SW                 PIC X.
  1244                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1245             20  CF-PTC-LF-SW               PIC X.
  1246                 88  CF-LF-PTC-USED             VALUE '1'.
  1247             20  CF-CDT-ACCESS-METHOD       PIC X.
  1248                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1249                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1250                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1251             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1252
  1253         16  CF-CLAIM-CALC-METHOD           PIC X.
  1254             88  360-PLUS-MONTHS                VALUE '1'.
  1255             88  365-PLUS-MONTHS                VALUE '2'.
  1256             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1257             88  360-DAILY                      VALUE '4'.
  1258             88  365-DAILY                      VALUE '5'.
  1259
  1260         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1261         16  FILLER                         PIC X(11).
  1262
  1263         16  CF-LIMIT-AMOUNTS.
  1264             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1265             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1266             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1267             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1268             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1269             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1270             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1271             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1272             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1273             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1274
  1275         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1276         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1277         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1278
  1279         16  CF-ZIP-CODE.
  1280             20  CF-ZIP-PRIME.
  1281                 24  CF-ZIP-1ST             PIC X.
  1282                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1283                 24  FILLER                 PIC X(4).
  1284             20  CF-ZIP-PLUS4               PIC X(4).
  1285         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1286             20  CF-CAN-POSTAL-1            PIC XXX.
  1287             20  CF-CAN-POSTAL-2            PIC XXX.
  1288             20  FILLER                     PIC XXX.
  1289
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  24
* EL203.cbl
  1290         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1291         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1292         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1293
  1294         16  CF-RATING-SWITCH               PIC X.
  1295             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1296             88  CF-NO-RATING                   VALUE 'N'.
  1297
  1298         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1299
  1300         16  CF-CARRIER-OVER-SHORT.
  1301             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1302             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1303
  1304         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1305         16  CF-SECPAY-SWITCH               PIC X.
  1306             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1307             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1308         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1309         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1310         16  FILLER                         PIC X(444).
  1311*        16  FILLER                         PIC X(452).
  1312
  1313
  1314****************************************************************
  1315*             MORTALITY MASTER RECORD                          *
  1316****************************************************************
  1317
  1318     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1319         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1320                                INDEXED BY CF-MORT-NDX.
  1321             20  CF-MORT-TABLE              PIC X(5).
  1322             20  CF-MORT-TABLE-TYPE         PIC X.
  1323                 88  CF-MORT-JOINT              VALUE 'J'.
  1324                 88  CF-MORT-SINGLE             VALUE 'S'.
  1325                 88  CF-MORT-COMBINED           VALUE 'C'.
  1326                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1327                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1328             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1329             20  CF-MORT-AGE-METHOD         PIC XX.
  1330                 88  CF-AGE-LAST                VALUE 'AL'.
  1331                 88  CF-AGE-NEAR                VALUE 'AN'.
  1332             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1333             20  CF-MORT-ADJUSTMENT-DIRECTION
  1334                                            PIC X.
  1335                 88  CF-MINUS                   VALUE '-'.
  1336                 88  CF-PLUS                    VALUE '+'.
  1337             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1338             20  CF-MORT-JOINT-CODE         PIC X.
  1339                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1340             20  CF-MORT-PC-Q               PIC X.
  1341                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1342             20  CF-MORT-TABLE-CODE         PIC X(4).
  1343             20  CF-MORT-COMMENTS           PIC X(15).
  1344             20  FILLER                     PIC X(14).
  1345
  1346         16  FILLER                         PIC X(251).
  1347
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  25
* EL203.cbl
  1348
  1349****************************************************************
  1350*             BUSSINESS TYPE MASTER RECORD                     *
  1351****************************************************************
  1352
  1353     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1354* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1355* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1356* AND RECORD 05 IS TYPES 81-99
  1357         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1358             20  CF-BUSINESS-TITLE          PIC  X(19).
  1359             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1360                                            PIC S9V9(4) COMP-3.
  1361             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1362             20  FILLER                     PIC  X.
  1363         16  FILLER                         PIC  X(248).
  1364
  1365
  1366****************************************************************
  1367*             TERMINAL MASTER RECORD                           *
  1368****************************************************************
  1369
  1370     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1371
  1372         16  CF-COMPANY-TERMINALS.
  1373             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1374                                  PIC X(4).
  1375         16  FILLER               PIC X(248).
  1376
  1377
  1378****************************************************************
  1379*             LIFE EDIT MASTER RECORD                          *
  1380****************************************************************
  1381
  1382     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1383         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1384             20  CF-LIFE-CODE-IN            PIC XX.
  1385             20  CF-LIFE-CODE-OUT           PIC XX.
  1386         16  FILLER                         PIC X(248).
  1387
  1388
  1389****************************************************************
  1390*             AH EDIT MASTER RECORD                            *
  1391****************************************************************
  1392
  1393     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1394         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1395             20  CF-AH-CODE-IN              PIC XXX.
  1396             20  CF-AH-CODE-OUT             PIC XX.
  1397         16  FILLER                         PIC X(248).
  1398
  1399
  1400****************************************************************
  1401*             CREDIBILITY TABLES                               *
  1402****************************************************************
  1403
  1404     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1405         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  26
* EL203.cbl
  1406                             INDEXED BY CF-CRDB-NDX.
  1407             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1408             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1409             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1410         16  FILLER                         PIC  X(332).
  1411
  1412
  1413****************************************************************
  1414*             REPORT CUSTOMIZATION RECORD                      *
  1415****************************************************************
  1416
  1417     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1418         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1419             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1420             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1421             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1422**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1423****       A T-TRANSFER.                                   ****
  1424             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1425
  1426         16  FILLER                         PIC XX.
  1427
  1428         16  CF-CARRIER-CNTL-OPT.
  1429             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1430                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1431                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1432             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1433                                            PIC X.
  1434         16  CF-GROUP-CNTL-OPT.
  1435             20  CF-GROUP-OPT-SEQ           PIC 9.
  1436                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1437                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1438             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1439                                            PIC X(6).
  1440         16  CF-STATE-CNTL-OPT.
  1441             20  CF-STATE-OPT-SEQ           PIC 9.
  1442                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1443                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1444             20  CF-STATE-SELECT OCCURS 3 TIMES
  1445                                            PIC XX.
  1446         16  CF-ACCOUNT-CNTL-OPT.
  1447             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1448                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1449                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1450             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1451                                            PIC X(10).
  1452         16  CF-BUS-TYP-CNTL-OPT.
  1453             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1454                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1455                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1456             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1457                                            PIC XX.
  1458         16  CF-LF-TYP-CNTL-OPT.
  1459             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1460                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1461                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1462             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1463                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  27
* EL203.cbl
  1464         16  CF-AH-TYP-CNTL-OPT.
  1465             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1466                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1467                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1468             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1469                                            PIC XX.
  1470         16  CF-REPTCD1-CNTL-OPT.
  1471             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1472                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1473                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1474             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1475                                            PIC X(10).
  1476         16  CF-REPTCD2-CNTL-OPT.
  1477             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1478                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1479                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1480             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1481                                            PIC X(10).
  1482         16  CF-USER1-CNTL-OPT.
  1483             20  CF-USER1-OPT-SEQ           PIC 9.
  1484                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1485                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1486             20  CF-USER1-SELECT OCCURS 3 TIMES
  1487                                            PIC X(10).
  1488         16  CF-USER2-CNTL-OPT.
  1489             20  CF-USER2-OPT-SEQ           PIC 9.
  1490                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1491                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1492             20  CF-USER2-SELECT OCCURS 3 TIMES
  1493                                            PIC X(10).
  1494         16  CF-USER3-CNTL-OPT.
  1495             20  CF-USER3-OPT-SEQ           PIC 9.
  1496                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1497                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1498             20  CF-USER3-SELECT OCCURS 3 TIMES
  1499                                            PIC X(10).
  1500         16  CF-USER4-CNTL-OPT.
  1501             20  CF-USER4-OPT-SEQ           PIC 9.
  1502                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1503                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1504             20  CF-USER4-SELECT OCCURS 3 TIMES
  1505                                            PIC X(10).
  1506         16  CF-USER5-CNTL-OPT.
  1507             20  CF-USER5-OPT-SEQ           PIC 9.
  1508                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1509                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1510             20  CF-USER5-SELECT OCCURS 3 TIMES
  1511                                            PIC X(10).
  1512         16  CF-REINS-CNTL-OPT.
  1513             20  CF-REINS-OPT-SEQ           PIC 9.
  1514                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1515                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1516             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1517                 24  CF-REINS-PRIME         PIC XXX.
  1518                 24  CF-REINS-SUB           PIC XXX.
  1519
  1520         16  CF-AGENT-CNTL-OPT.
  1521             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  28
* EL203.cbl
  1522                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1523                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1524             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1525                                            PIC X(10).
  1526
  1527         16  FILLER                         PIC X(43).
  1528
  1529         16  CF-LOSS-RATIO-SELECT.
  1530             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1531             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1532         16  CF-ENTRY-DATE-SELECT.
  1533             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1534             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1535         16  CF-EFFECTIVE-DATE-SELECT.
  1536             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1537             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1538
  1539         16  CF-EXCEPTION-LIST-IND          PIC X.
  1540             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1541
  1542         16  FILLER                         PIC X(318).
  1543
  1544****************************************************************
  1545*                  EXCEPTION REPORTING RECORD                  *
  1546****************************************************************
  1547
  1548     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1549         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1550             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1551
  1552         16  CF-COMBINED-LIFE-AH-OPT.
  1553             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1554             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1555             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1556             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1557
  1558         16  CF-LIFE-OPT.
  1559             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1560             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1561             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1562             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1563             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1564             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1565             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1566             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1567             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1568             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1569
  1570         16  CF-AH-OPT.
  1571             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1572             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1573             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1574             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1575             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1576             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1577             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1578             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1579             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  29
* EL203.cbl
  1580             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1581
  1582         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1583             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1584             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1585             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1586
  1587         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1588
  1589         16  FILLER                         PIC X(673).
  1590
  1591
  1592****************************************************************
  1593*             MORTGAGE SYSTEM PLAN RECORD                      *
  1594****************************************************************
  1595
  1596     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1597         16  CF-PLAN-TYPE                   PIC X.
  1598             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1599             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1600             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1601         16  CF-PLAN-ABBREV                 PIC XXX.
  1602         16  CF-PLAN-DESCRIPT               PIC X(10).
  1603         16  CF-PLAN-NOTES                  PIC X(20).
  1604         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1605         16  CF-PLAN-UNDERWRITING.
  1606             20  CF-PLAN-TERM-DATA.
  1607                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1608                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1609             20  CF-PLAN-AGE-DATA.
  1610                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1611                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1612                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1613             20  CF-PLAN-BENEFIT-DATA.
  1614                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1615                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1616                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1617                                            PIC S9(7)V99  COMP-3.
  1618         16  CF-PLAN-POLICY-FORMS.
  1619             20  CF-POLICY-FORM             PIC X(12).
  1620             20  CF-MASTER-APPLICATION      PIC X(12).
  1621             20  CF-MASTER-POLICY           PIC X(12).
  1622         16  CF-PLAN-RATING.
  1623             20  CF-RATE-CODE               PIC X(5).
  1624             20  CF-SEX-RATING              PIC X.
  1625                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1626                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1627             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1628             20  CF-SUB-STD-TYPE            PIC X.
  1629                 88  CF-PCT-OF-PREM            VALUE '1'.
  1630                 88  CF-PCT-OF-BENE            VALUE '2'.
  1631         16  CF-PLAN-PREM-TOLERANCES.
  1632             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1633             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1634         16  CF-PLAN-PYMT-TOLERANCES.
  1635             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1636             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1637         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  30
* EL203.cbl
  1638             20  FILLER                     PIC X.
  1639             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1640             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1641         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1642         16  CF-PLAN-IND-GRP                PIC X.
  1643             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1644                                                     '1'.
  1645             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1646                                                     '2'.
  1647         16  CF-MIB-SEARCH-SW               PIC X.
  1648             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1649             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1650             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1651             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1652         16  CF-ALPHA-SEARCH-SW             PIC X.
  1653             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1654             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1655             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1656             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1657             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1658             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1659             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1660             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1661             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1662             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1663                                                     'A' 'B' 'C'
  1664                                                     'X' 'Y' 'Z'.
  1665         16  CF-EFF-DT-RULE-SW              PIC X.
  1666             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1667             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1668             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1669             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1670             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1671         16  FILLER                         PIC X(4).
  1672         16  CF-HEALTH-QUESTIONS            PIC X.
  1673             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1674         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1675         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1676         16  CF-PLAN-SNGL-JNT               PIC X.
  1677             88  CF-COMBINED-PLAN              VALUE 'C'.
  1678             88  CF-JNT-PLAN                   VALUE 'J'.
  1679             88  CF-SNGL-PLAN                  VALUE 'S'.
  1680         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1681         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1682         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1683         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1684         16  CF-RERATE-CNTL                 PIC  X.
  1685             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1686             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1687             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1688             88  CF-AUTO-RECALC                 VALUE '4'.
  1689         16  CF-BENEFIT-TYPE                PIC  X.
  1690             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1691             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1692         16  CF-POLICY-FEE                  PIC S999V99
  1693                                                    COMP-3.
  1694         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1695         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  31
* EL203.cbl
  1696         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1697         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1698         16  FILLER                         PIC  X(32).
  1699         16  CF-TERMINATION-FORM            PIC  X(04).
  1700         16  FILLER                         PIC  X(08).
  1701         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1702                                                       COMP-3.
  1703         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1704         16  CF-ISSUE-LETTER                PIC  X(4).
  1705         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1706         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1707             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1708             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1709         16  CF-MP-REFUND-CALC              PIC X.
  1710             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1711             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1712             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1713             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1714             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1715             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1716             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1717             88  CF-MP-REFD-MEAN                VALUE '8'.
  1718         16  CF-ALT-RATE-CODE               PIC  X(5).
  1719
  1720
  1721         16  FILLER                         PIC X(498).
  1722****************************************************************
  1723*             MORTGAGE COMPANY MASTER RECORD                   *
  1724****************************************************************
  1725
  1726     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1727         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1728         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1729             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1730             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1731             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1732             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1733             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1734
  1735         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1736         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1737         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1738         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1739         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1740
  1741         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1742             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1743         16  CF-MP-RECON-USE-IND            PIC X(1).
  1744             88  CF-MP-USE-RECON             VALUE 'Y'.
  1745         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1746             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1747         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1748             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1749             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1750         16  FILLER                         PIC X(1).
  1751         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1752             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1753         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  32
* EL203.cbl
  1754             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1755             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1756             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1757         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1758             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1759                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1760             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1761                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1762             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1763                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1764             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1765                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1766             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1767                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1768             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1769                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1770         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1771         16  FILLER                         PIC X(7).
  1772         16  CF-MORTG-DESTINATION-SYMBOL.
  1773             20  CF-MORTG-MIB-COMM          PIC X(5).
  1774             20  CF-MORTG-MIB-TERM          PIC X(5).
  1775         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1776             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1777         16  FILLER                         PIC X(03).
  1778         16  CF-MP-CHECK-NO-CONTROL.
  1779             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1780                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1781                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1782                                                ' ' LOW-VALUES.
  1783                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1784                                               VALUE '3'.
  1785         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1786         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1787         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1788             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1789                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1790             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1791                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1792             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1793                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1794             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1795                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1796             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1797                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1798             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1799                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1800         16  CF-MORTG-BILLING-AREA.
  1801             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1802                                            PIC X.
  1803         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1804         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1805         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1806         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1807             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1808             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1809         16  FILLER                         PIC X.
  1810         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1811             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  33
* EL203.cbl
  1812             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1813         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1814         16  FILLER                         PIC X(8).
  1815         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1816         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1817         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1818         16  CF-ACH-COMPANY-ID.
  1819             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1820                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1821                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1822                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1823             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1824         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1825             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1826         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1827             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1828             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1829         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1830         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1831         16  FILLER                         PIC X(536).
  1832
  1833****************************************************************
  1834*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1835****************************************************************
  1836
  1837     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1838         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  1839             20  CF-FEMALE-HEIGHT.
  1840                 24  CF-FEMALE-FT           PIC 99.
  1841                 24  CF-FEMALE-IN           PIC 99.
  1842             20  CF-FEMALE-MIN-WT           PIC 999.
  1843             20  CF-FEMALE-MAX-WT           PIC 999.
  1844         16  FILLER                         PIC X(428).
  1845
  1846     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1847         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1848             20  CF-MALE-HEIGHT.
  1849                 24  CF-MALE-FT             PIC 99.
  1850                 24  CF-MALE-IN             PIC 99.
  1851             20  CF-MALE-MIN-WT             PIC 999.
  1852             20  CF-MALE-MAX-WT             PIC 999.
  1853         16  FILLER                         PIC X(428).
  1854******************************************************************
  1855*             AUTOMATIC ACTIVITY RECORD                          *
  1856******************************************************************
  1857     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1858         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1859             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1860             20  CF-SYS-LETTER-ID           PIC X(04).
  1861             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1862             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1863             20  CF-SYS-RESET-SW            PIC X(01).
  1864             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1865             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1866
  1867         16  FILLER                         PIC X(50).
  1868
  1869         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  34
* EL203.cbl
  1870             20  CF-USER-ACTIVE-SW          PIC X(01).
  1871             20  CF-USER-LETTER-ID          PIC X(04).
  1872             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1873             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1874             20  CF-USER-RESET-SW           PIC X(01).
  1875             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1876             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1877             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1878
  1879         16  FILLER                         PIC X(246).
  1880*                                copy ELCCERT.
  1881******************************************************************
  1882*                                                                *
  1883*                            ELCCERT.                            *
  1884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1885*                            VMOD=2.013                          *
  1886*                                                                *
  1887*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1888*                                                                *
  1889*   FILE TYPE = VSAM,KSDS                                        *
  1890*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1891*                                                                *
  1892*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1893*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1894*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1895*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1896*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1897*                                                                *
  1898*   LOG = YES                                                    *
  1899*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1900******************************************************************
  1901*                   C H A N G E   L O G
  1902*
  1903* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1904*-----------------------------------------------------------------
  1905*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1906* EFFECTIVE    NUMBER
  1907*-----------------------------------------------------------------
  1908* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1909* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1910* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1911* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1912* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1913* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1914* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1915* 032612  CR2011110200001  PEMA  AHL CHANGES
  1916* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1917* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1918******************************************************************
  1919
  1920 01  CERTIFICATE-MASTER.
  1921     12  CM-RECORD-ID                      PIC XX.
  1922         88  VALID-CM-ID                      VALUE 'CM'.
  1923
  1924     12  CM-CONTROL-PRIMARY.
  1925         16  CM-COMPANY-CD                 PIC X.
  1926         16  CM-CARRIER                    PIC X.
  1927         16  CM-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  35
* EL203.cbl
  1928             20  CM-GROUPING-PREFIX        PIC X(3).
  1929             20  CM-GROUPING-PRIME         PIC X(3).
  1930         16  CM-STATE                      PIC XX.
  1931         16  CM-ACCOUNT.
  1932             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1933             20  CM-ACCOUNT-PRIME          PIC X(6).
  1934         16  CM-CERT-EFF-DT                PIC XX.
  1935         16  CM-CERT-NO.
  1936             20  CM-CERT-PRIME             PIC X(10).
  1937             20  CM-CERT-SFX               PIC X.
  1938
  1939     12  CM-CONTROL-BY-NAME.
  1940         16  CM-COMPANY-CD-A1              PIC X.
  1941         16  CM-INSURED-LAST-NAME          PIC X(15).
  1942         16  CM-INSURED-INITIALS.
  1943             20  CM-INSURED-INITIAL1       PIC X.
  1944             20  CM-INSURED-INITIAL2       PIC X.
  1945
  1946     12  CM-CONTROL-BY-SSN.
  1947         16  CM-COMPANY-CD-A2              PIC X.
  1948         16  CM-SOC-SEC-NO.
  1949             20  CM-SSN-STATE              PIC XX.
  1950             20  CM-SSN-ACCOUNT            PIC X(6).
  1951             20  CM-SSN-LN3.
  1952                 25  CM-INSURED-INITIALS-A2.
  1953                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1954                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1955                 25 CM-PART-LAST-NAME-A2         PIC X.
  1956
  1957     12  CM-CONTROL-BY-CERT-NO.
  1958         16  CM-COMPANY-CD-A4              PIC X.
  1959         16  CM-CERT-NO-A4                 PIC X(11).
  1960
  1961     12  CM-CONTROL-BY-MEMB.
  1962         16  CM-COMPANY-CD-A5              PIC X.
  1963         16  CM-MEMBER-NO.
  1964             20  CM-MEMB-STATE             PIC XX.
  1965             20  CM-MEMB-ACCOUNT           PIC X(6).
  1966             20  CM-MEMB-LN4.
  1967                 25  CM-INSURED-INITIALS-A5.
  1968                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1969                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1970                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1971
  1972     12  CM-INSURED-PROFILE-DATA.
  1973         16  CM-INSURED-FIRST-NAME.
  1974             20  CM-INSURED-1ST-INIT       PIC X.
  1975             20  FILLER                    PIC X(9).
  1976         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1977         16  CM-INSURED-SEX                PIC X.
  1978             88  CM-SEX-MALE                  VALUE 'M'.
  1979             88  CM-SEX-FEMAL                 VALUE 'F'.
  1980         16  CM-INSURED-JOINT-AGE          PIC 99.
  1981         16  CM-JOINT-INSURED-NAME.
  1982             20  CM-JT-LAST-NAME           PIC X(15).
  1983             20  CM-JT-FIRST-NAME.
  1984                 24  CM-JT-1ST-INIT        PIC X.
  1985                 24  FILLER                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  36
* EL203.cbl
  1986             20  CM-JT-INITIAL             PIC X.
  1987
  1988     12  CM-LIFE-DATA.
  1989         16  CM-LF-BENEFIT-CD              PIC XX.
  1990         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1991         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1992         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1993         16  CM-LF-DEV-CODE                PIC XXX.
  1994         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1995         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1996         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1997         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1998         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1999         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2000         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2001         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2002         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2003         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2004         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2005         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2006         16  cm-temp-epiq                  pic xx.
  2007             88  EPIQ-CLASS                  value 'EQ'.
  2008*        16  FILLER                        PIC XX.
  2009
  2010     12  CM-AH-DATA.
  2011         16  CM-AH-BENEFIT-CD              PIC XX.
  2012         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2013         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2014         16  CM-AH-DEV-CODE                PIC XXX.
  2015         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2016         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2017         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2018         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2019         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2020         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2021         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2022         16  CM-AH-PAID-THRU-DT            PIC XX.
  2023             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2024         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2025         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2026         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2027         16  FILLER                        PIC X.
  2028
  2029     12  CM-LOAN-INFORMATION.
  2030         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2031         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2032                                           PIC S9(5)V99  COMP-3.
  2033         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2034         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2035         16  CM-PAY-FREQUENCY              PIC S99.
  2036         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2037         16  CM-RATE-CLASS                 PIC XX.
  2038         16  CM-BENEFICIARY                PIC X(25).
  2039         16  CM-POLICY-FORM-NO             PIC X(12).
  2040         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2041         16  CM-LAST-ADD-ON-DT             PIC XX.
  2042         16  CM-DEDUCTIBLE-AMOUNTS.
  2043             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  37
* EL203.cbl
  2044             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2045         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2046             20  CM-RESIDENT-STATE         PIC XX.
  2047             20  CM-RATE-CODE              PIC X(4).
  2048             20  FILLER                    PIC XX.
  2049         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2050             20  CM-LOAN-OFFICER           PIC X(5).
  2051             20  FILLER                    PIC XXX.
  2052         16  CM-CSR-CODE                   PIC XXX.
  2053         16  CM-UNDERWRITING-CODE          PIC X.
  2054             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2055         16  CM-POST-CARD-IND              PIC X.
  2056         16  CM-NH-INTERFACE-SW            PIC X.
  2057         16  CM-PREMIUM-TYPE               PIC X.
  2058             88  CM-SING-PRM                  VALUE '1'.
  2059             88  CM-O-B-COVERAGE              VALUE '2'.
  2060             88  CM-OPEN-END                  VALUE '3'.
  2061         16  CM-IND-GRP-TYPE               PIC X.
  2062             88  CM-INDIVIDUAL                VALUE 'I'.
  2063             88  CM-GROUP                     VALUE 'G'.
  2064         16  CM-SKIP-CODE                  PIC X.
  2065             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2066             88  SKIP-JULY                    VALUE '1'.
  2067             88  SKIP-AUGUST                  VALUE '2'.
  2068             88  SKIP-SEPTEMBER               VALUE '3'.
  2069             88  SKIP-JULY-AUG                VALUE '4'.
  2070             88  SKIP-AUG-SEPT                VALUE '5'.
  2071             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2072             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2073             88  SKIP-JUNE                    VALUE '8'.
  2074             88  SKIP-JUNE-JULY               VALUE '9'.
  2075             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2076             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2077         16  CM-PAYMENT-MODE               PIC X.
  2078             88  PAY-MONTHLY                  VALUE SPACE.
  2079             88  PAY-WEEKLY                   VALUE '1'.
  2080             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2081             88  PAY-BI-WEEKLY                VALUE '3'.
  2082             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2083         16  CM-LOAN-NUMBER                PIC X(8).
  2084         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2085         16  CM-OLD-LOF                    PIC XXX.
  2086*        16  CM-LOAN-OFFICER               PIC XXX.
  2087         16  CM-REIN-TABLE                 PIC XXX.
  2088         16  CM-SPECIAL-REIN-CODE          PIC X.
  2089         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2090         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2091         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2092
  2093     12  CM-STATUS-DATA.
  2094         16  CM-ENTRY-STATUS               PIC X.
  2095         16  CM-ENTRY-DT                   PIC XX.
  2096
  2097         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2098         16  CM-LF-CANCEL-DT               PIC XX.
  2099         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2100
  2101         16  CM-LF-STATUS-AT-DEATH         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  38
* EL203.cbl
  2102         16  CM-LF-DEATH-DT                PIC XX.
  2103         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2104
  2105         16  CM-LF-CURRENT-STATUS          PIC X.
  2106             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2107                                                'M' '4' '5' '9'.
  2108             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2109             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2110             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2111             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2112             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2113             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2114             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2115             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2116             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2117             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2118             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2119             88  CM-LF-DECLINED               VALUE 'D'.
  2120             88  CM-LF-VOIDED                 VALUE 'V'.
  2121
  2122         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2123         16  CM-AH-CANCEL-DT               PIC XX.
  2124         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2125
  2126         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2127         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2128         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2129
  2130         16  CM-AH-CURRENT-STATUS          PIC X.
  2131             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2132                                                'M' '4' '5' '9'.
  2133             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2134             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2135             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2136             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2137             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2138             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2139             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2140             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2141             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2142             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2143             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2144             88  CM-AH-DECLINED               VALUE 'D'.
  2145             88  CM-AH-VOIDED                 VALUE 'V'.
  2146
  2147         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2148             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2149             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2150             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2151         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2152
  2153         16  CM-ENTRY-BATCH                PIC X(6).
  2154         16  CM-LF-EXIT-BATCH              PIC X(6).
  2155         16  CM-AH-EXIT-BATCH              PIC X(6).
  2156         16  CM-LAST-MONTH-END             PIC XX.
  2157
  2158     12  CM-NOTE-SW                        PIC X.
  2159         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  39
* EL203.cbl
  2160         88  CERT-NOTES-PRESENT               VALUE '1'.
  2161         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2162         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2163         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2164         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2165         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2166         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2167     12  CM-COMP-EXCP-SW                   PIC X.
  2168         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2169         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2170     12  CM-INSURED-ADDRESS-SW             PIC X.
  2171         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2172         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2173
  2174*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2175     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2176     12  FILLER                            PIC X.
  2177
  2178*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2179     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2180     12  FILLER                            PIC X.
  2181*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2182     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2183
  2184     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2185         88  CERT-ADDED-BATCH                 VALUE ' '.
  2186         88  CERT-ADDED-ONLINE                VALUE '1'.
  2187         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2188         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2189         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2190     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2191         88  CERT-AS-LOADED                   VALUE ' '.
  2192         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2193         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2194         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2195         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2196         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2197         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2198         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2199
  2200     12  CM-ACCOUNT-COMM-PCTS.
  2201         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2202         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2203
  2204     12  CM-USER-FIELD                     PIC X.
  2205     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2206     12  CM-CLP-STATE                      PIC XX.
  2207     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2208     12  CM-USER-RESERVED                  PIC XXX.
  2209     12  FILLER REDEFINES CM-USER-RESERVED.
  2210         16  CM-AH-CLASS-CD                PIC XX.
  2211         16  F                             PIC X.
  2212******************************************************************
  2213*                                copy ELCCRTT.
  2214******************************************************************
  2215*                                                                *
  2216*                            ELCCRTT.                            *
  2217*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  40
* EL203.cbl
  2218*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2219*                                                                *
  2220*   FILE TYPE = VSAM,KSDS                                        *
  2221*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2222*                                                                *
  2223*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2224*                                                                *
  2225*   LOG = YES                                                    *
  2226*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2227******************************************************************
  2228*                   C H A N G E   L O G
  2229*
  2230* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2231*-----------------------------------------------------------------
  2232*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2233* EFFECTIVE    NUMBER
  2234*-----------------------------------------------------------------
  2235* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2236* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2237* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2238* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2239* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2240* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2241* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2242* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2243* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2244******************************************************************
  2245
  2246 01  CERTIFICATE-TRAILERS.
  2247     12  CS-RECORD-ID                      PIC XX.
  2248         88  VALID-CS-ID                      VALUE 'CS'.
  2249
  2250     12  CS-CONTROL-PRIMARY.
  2251         16  CS-COMPANY-CD                 PIC X.
  2252         16  CS-CARRIER                    PIC X.
  2253         16  CS-GROUPING                   PIC X(6).
  2254         16  CS-STATE                      PIC XX.
  2255         16  CS-ACCOUNT                    PIC X(10).
  2256         16  CS-CERT-EFF-DT                PIC XX.
  2257         16  CS-CERT-NO.
  2258             20  CS-CERT-PRIME             PIC X(10).
  2259             20  CS-CERT-SFX               PIC X.
  2260         16  CS-TRAILER-TYPE               PIC X.
  2261             88  COMM-TRLR           VALUE 'A'.
  2262             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2263             88  CERT-DATA-TRLR      VALUE 'C'.
  2264
  2265     12  CS-DATA-AREA                      PIC X(516).
  2266
  2267     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2268         16  CS-BANK-COMMISSION-AREA.
  2269             20  CS-BANK-COMMS       OCCURS 10.
  2270                 24  CS-AGT                PIC X(10).
  2271                 24  CS-COM-TYP            PIC X.
  2272                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2273                 24  CS-RECALC-LV-INDIC    PIC X.
  2274                 24  FILLER                PIC X(10).
  2275         16  FILLER                        PIC X(256).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  41
* EL203.cbl
  2276
  2277     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2278****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2279         16  CS-MB-CLAIM-DATA OCCURS 24.
  2280             20  CS-CLAIM-NO               PIC X(7).
  2281             20  CS-CLAIM-TYPE             PIC X.
  2282                 88  CS-AH-CLM               VALUE 'A'.
  2283                 88  CS-IU-CLM               VALUE 'I'.
  2284                 88  CS-GP-CLM               VALUE 'G'.
  2285                 88  CS-LF-CLM               VALUE 'L'.
  2286                 88  CS-PR-CLM               VALUE 'P'.
  2287                 88  CS-FL-CLM               VALUE 'F'.
  2288             20  CS-INSURED-TYPE           PIC X.
  2289                 88  CS-PRIM-INSURED          VALUE 'P'.
  2290                 88  CS-CO-BORROWER           VALUE 'C'.
  2291             20  CS-BENEFIT-PERIOD         PIC 99.
  2292             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2293             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2294             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2295         16  FILLER                        PIC X(12).
  2296     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2297         16  CS-VIN-NUMBER                 PIC X(17).
  2298         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2299         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2300         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2301         16  cs-agent-name.
  2302             20  cs-agent-fname            pic x(20).
  2303             20  cs-agent-mi               pic x.
  2304             20  cs-agent-lname            pic x(25).
  2305         16  cs-license-no                 pic x(15).
  2306         16  cs-npn-number                 pic x(10).
  2307         16  cs-agent-edit-status          pic x.
  2308             88  cs-ae-refer-to-manager      value 'M'.
  2309             88  cs-ae-cover-sheet           value 'C'.
  2310             88  cs-ae-sig-form              value 'S'.
  2311             88  cs-ae-verified              value 'V'.
  2312             88  cs-unidentified-signature   value 'U'.
  2313             88  cs-cert-returned            value 'R'.
  2314             88  cs-accept-no-commission     value 'N'.
  2315         16  cs-year                       pic 9999.
  2316         16  cs-make                       pic x(20).
  2317         16  cs-model                      pic x(20).
  2318         16  cs-future                     pic x(20).
  2319         16  cs-vehicle-odometer           pic s9(7) comp-3.
  2320         16  FILLER                        PIC X(356). *> was 420
  2321*        16  FILLER                        PIC X(496).
  2322*                                copy ERCCNOT.
  2323******************************************************************
  2324*                                                                *
  2325*                            ERCCNOT                             *
  2326*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2327*                            VMOD=2.003                          *
  2328*                                                                *
  2329*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  2330*                                                                *
  2331*        FILE TYPE= VSAM,KSDS                                    *
  2332*        RECORD SIZE = 150    RECFORM = FIXED                    *
  2333*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  42
* EL203.cbl
  2334*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  2335*                                                                *
  2336*        LOG = YES                                               *
  2337*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2338*                                                                *
  2339******************************************************************
  2340*                   C H A N G E   L O G
  2341*
  2342* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2343*-----------------------------------------------------------------
  2344*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2345* EFFECTIVE    NUMBER
  2346*-----------------------------------------------------------------
  2347* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  2348******************************************************************
  2349
  2350 01  CERT-NOTE-FILE.
  2351     12  CZ-RECORD-ID                PIC  XX.
  2352         88  VALID-CZ-ID                  VALUE 'CZ'.
  2353
  2354     12  CZ-CONTROL-PRIMARY.
  2355         16  CZ-COMPANY-CD           PIC X.
  2356         16  CZ-CARRIER              PIC X.
  2357         16  CZ-GROUPING.
  2358             20 CZ-GROUPING-PREFIX   PIC XXX.
  2359             20 CZ-GROUPING-PRIME    PIC XXX.
  2360         16  CZ-STATE                PIC XX.
  2361         16  CZ-ACCOUNT.
  2362             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  2363             20 CZ-ACCOUNT-PRIME     PIC X(6).
  2364         16  CZ-CERT-EFF-DT          PIC XX.
  2365         16  CZ-CERT-NO.
  2366             20  CZ-CERT-PRIME       PIC X(10).
  2367             20  CZ-CERT-SFX         PIC X.
  2368         16  CZ-RECORD-TYPE          PIC X.
  2369             88  CERT-NOTE           VALUE '1'.
  2370             88  CLAIM-CERT-NOTE     VALUE '2'.
  2371         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  2372
  2373     12  CZ-LAST-MAINT-DT            PIC XX.
  2374     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2375     12  CZ-LAST-MAINT-USER          PIC X(4).
  2376
  2377     12  CZ-NOTE-INFORMATION.
  2378         16  CZ-NOTE                 PIC X(63).
  2379         16  FILLER                  PIC X(39).
  2380******************************************************************
  2381 01  w-doctoken                  pic x(16).
  2382 01 output-data.
  2383    05  filler                   pic x(6) value "TITLE=".
  2384    05  output-title             pic x(26) value 'AGENT SIG'.
  2385    05  filler                   pic x(8) value "&COMPID=".
  2386    05  out-comp-id              pic xxx.
  2387    05  filler                   pic x(5) value "&MSG=".
  2388    05  output-msg               pic x(50).
  2389****************************************************************
  2390*
  2391* Copyright (c) 2007 by Clerity Solutions, Inc.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  43
* EL203.cbl
  2392* All rights reserved.
  2393*
  2394****************************************************************
  2395 01  DFHEIV.
  2396   02  DFHEIV0               PIC X(35).
  2397   02  DFHEIV1               PIC X(08).
  2398   02  DFHEIV2               PIC X(08).
  2399   02  DFHEIV3               PIC X(08).
  2400   02  DFHEIV4               PIC X(06).
  2401   02  DFHEIV5               PIC X(04).
  2402   02  DFHEIV6               PIC X(04).
  2403   02  DFHEIV7               PIC X(02).
  2404   02  DFHEIV8               PIC X(02).
  2405   02  DFHEIV9               PIC X(01).
  2406   02  DFHEIV10              PIC S9(7) COMP-3.
  2407   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2408   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2409   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2410   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2411   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2412   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2413   02  DFHEIV17              PIC X(04).
  2414   02  DFHEIV18              PIC X(04).
  2415   02  DFHEIV19              PIC X(04).
  2416   02  DFHEIV20              USAGE IS POINTER.
  2417   02  DFHEIV21              USAGE IS POINTER.
  2418   02  DFHEIV22              USAGE IS POINTER.
  2419   02  DFHEIV23              USAGE IS POINTER.
  2420   02  DFHEIV24              USAGE IS POINTER.
  2421   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2422   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2423   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2424   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2425   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2426   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2427   02  FILLER                PIC X(02).
  2428   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2429   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2430   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2431   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2432   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2433 LINKAGE  SECTION.
  2434*****************************************************************
  2435*                                                               *
  2436* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2437* All rights reserved.                                          *
  2438*                                                               *
  2439*****************************************************************
  2440 01  dfheiblk.
  2441     02  eibtime          pic s9(7) comp-3.
  2442     02  eibdate          pic s9(7) comp-3.
  2443     02  eibtrnid         pic x(4).
  2444     02  eibtaskn         pic s9(7) comp-3.
  2445     02  eibtrmid         pic x(4).
  2446     02  dfheigdi         pic s9(4) comp.
  2447     02  eibcposn         pic s9(4) comp.
  2448     02  eibcalen         pic s9(4) comp.
  2449     02  eibaid           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  44
* EL203.cbl
  2450     02  eibfiller1       pic x(1).
  2451     02  eibfn            pic x(2).
  2452     02  eibfiller2       pic x(2).
  2453     02  eibrcode         pic x(6).
  2454     02  eibfiller3       pic x(2).
  2455     02  eibds            pic x(8).
  2456     02  eibreqid         pic x(8).
  2457     02  eibrsrce         pic x(8).
  2458     02  eibsync          pic x(1).
  2459     02  eibfree          pic x(1).
  2460     02  eibrecv          pic x(1).
  2461     02  eibsend          pic x(1).
  2462     02  eibatt           pic x(1).
  2463     02  eibeoc           pic x(1).
  2464     02  eibfmh           pic x(1).
  2465     02  eibcompl         pic x(1).
  2466     02  eibsig           pic x(1).
  2467     02  eibconf          pic x(1).
  2468     02  eiberr           pic x(1).
  2469     02  eibrldbk         pic x(1).
  2470     02  eiberrcd         pic x(4).
  2471     02  eibsynrb         pic x(1).
  2472     02  eibnodat         pic x(1).
  2473     02  eibfiller5       pic x(2).
  2474     02  eibresp          pic 9(09) comp.
  2475     02  eibresp2         pic 9(09) comp.
  2476     02  dfheigdj         pic s9(4) comp.
  2477     02  dfheigdk         pic s9(4) comp.
  2478 01  DFHCOMMAREA                     PIC X(1024).
  2479 01  var  pic x(30).
  2480 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  2481 0000-DFHEXIT SECTION.
  2482     MOVE '9#                    $   ' TO DFHEIV0.
  2483     MOVE 'EL203' TO DFHEIV1.
  2484     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2485*    display ' Entering EL203 '
  2486     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2487     string ws-fn-hours ws-fn-minutes ws-fn-seconds
  2488        delimited by size into ws-work-time-a
  2489     end-string
  2490     move ws-fn-cymd             to dc-greg-date-cymd
  2491     move 'L'                    to dc-option-code
  2492     perform 9700-date-convert   thru 9700-exit
  2493     if no-conversion-error
  2494        move dc-bin-date-1       to ws-current-bin-dt
  2495     else
  2496        display ' error current dt invalid ' dc-error-code
  2497     end-if
  2498     set P to address of KIXSYS
  2499     CALL "getenv" using by value P returning var-ptr
  2500     if var-ptr = null then
  2501        display ' kixsys not set '
  2502     else
  2503        set address of var to var-ptr
  2504        move 0 to env-var-len
  2505        inspect var tallying env-var-len
  2506          for characters before X'00'
  2507        unstring var (1:env-var-len) delimited by '/'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  45
* EL203.cbl
  2508           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2509              WS-KIX-SYS
  2510        end-unstring
  2511     end-if
  2512
  2513* exec cics web extract
  2514*       querystring  (ws-qry-string)
  2515*       querystrlen  (ws-qrystr-len)
  2516*    end-exec
  2517*    MOVE 'X0  QL                .   #00002508' TO DFHEIV0
  2518     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2519     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2520     MOVE X'2020233030303032353038' TO DFHEIV0(25:11)
  2521     CALL 'kxdfhei1' USING DFHEIV0,
  2522           DFHEIV99,
  2523           DFHEIV99,
  2524           ws-qry-string,
  2525           ws-qrystr-len,
  2526           DFHEIV99,
  2527           DFHEIV99,
  2528           DFHEIV99,
  2529           DFHEIV99,
  2530           DFHEIV99,
  2531           DFHEIV99,
  2532           DFHEIV99,
  2533           DFHEIV99,
  2534           DFHEIV99
  2535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2536*    display ' qry string ' ws-qry-string
  2537*    display ' gry len    ' ws-qrystr-len
  2538     move +1                     to o1
  2539     perform varying i1 from +1 by +1 until
  2540        (i1 > +200)
  2541        or (ws-qry-string (i1:1) = ' ')
  2542        if ws-qry-string (i1:3) = '%20'  *>   space
  2543           move ' '              to ws-string-out (o1:1)
  2544           add +2                to i1
  2545           add +1                to o1
  2546        else
  2547           move ws-qry-string (i1:1)
  2548                                 to ws-string-out (o1:1)
  2549           add +1                to o1
  2550        end-if
  2551     end-perform
  2552*    display ' string out ' ws-string-out
  2553     unstring ws-string-out delimited by '?' or '&'
  2554        into  ws-cert-key
  2555           ws-agent-first-name
  2556           ws-agent-mi
  2557           ws-agent-last-name
  2558           ws-agent-license-no
  2559           ws-agent-npn-no
  2560           ws-proc-id
  2561     end-unstring
  2562     evaluate true
  2563        when ws-comp-id = 'CID'
  2564           move X'04'            to ws-comp-cd
  2565        when ws-comp-id = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  46
* EL203.cbl
  2566           move X'05'            to ws-comp-cd
  2567        when ws-comp-id = 'AHL'
  2568           move X'06'            to ws-comp-cd
  2569        when ws-comp-id = 'VPP'
  2570           move X'07'            to ws-comp-cd
  2571     end-evaluate
  2572*    display ' cert key   :**' ws-cert-key '**'
  2573*    display ' first name : ' ws-agent-first-name
  2574*    display ' middle int : ' ws-agent-mi
  2575*    display ' last name  : ' ws-agent-last-name
  2576*    display ' license no : ' ws-agent-license-no
  2577*    display ' nbn number : ' ws-agent-npn-no
  2578*    display ' proc ID    : ' ws-proc-id
  2579     move ws-comp-cd             to elcert-company-cd
  2580     move ws-carrier             to elcert-carrier
  2581     move '000000'               to elcert-grouping
  2582     move ws-state               to elcert-state
  2583     move ws-account             to elcert-account
  2584     move ws-certificate         to elcert-cert
  2585     move ws-cert-sfx            to elcert-cert-sfx
  2586     move ws-eff-date (7:2)      to dc-ymd-year
  2587     move ws-eff-date (1:2)      to dc-ymd-month
  2588     move ws-eff-date (4:2)      to dc-ymd-day
  2589     move '3'                    to dc-option-code
  2590     perform 9700-date-convert   thru 9700-exit
  2591     if no-conversion-error
  2592        move dc-bin-date-1       to elcert-eff-dt
  2593     else
  2594        move ' Bad Eff Dte Convert '
  2595                                 to output-msg
  2596        display ' bad eff dte convert ' dc-error-code ' '
  2597           ws-cert-key
  2598        go to 0000-return
  2599     end-if
  2600*    display ' about to read elcert ' elcert-key (2:19) ' '
  2601*       elcert-key (23:11)
  2602
  2603* exec cics read
  2604*       dataset    ('ELCERT')
  2605*       into       (certificate-master)
  2606*       ridfld     (elcert-key)
  2607*       resp       (ws-response)
  2608*    end-exec
  2609     MOVE LENGTH OF
  2610      certificate-master
  2611       TO DFHEIV11
  2612     MOVE 'ELCERT' TO DFHEIV1
  2613*    MOVE '&"IL       E          (  N#00002578' TO DFHEIV0
  2614     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2616     MOVE X'204E233030303032353738' TO DFHEIV0(25:11)
  2617     CALL 'kxdfhei1' USING DFHEIV0,
  2618           DFHEIV1,
  2619           certificate-master,
  2620           DFHEIV11,
  2621           elcert-key,
  2622           DFHEIV99,
  2623           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  47
* EL203.cbl
  2624           DFHEIV99
  2625     MOVE EIBRESP  TO ws-response
  2626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2627     if resp-normal
  2628        continue
  2629     else
  2630        move ' Bad ELCERT Read  '
  2631                                 to output-msg
  2632        display ' bad read on elcert ' ws-response ' '
  2633           ws-cert-key
  2634        go to 0000-return
  2635     end-if
  2636*    display ' Read ELCERT okay '
  2637     move elcert-key             to elcrtt-key
  2638     move 'C'                    to elcrtt-rec-type
  2639*    display ' about to read elcrtt ' elcrtt-key (2:19) ' '
  2640*       elcrtt-key (23:12)
  2641
  2642* exec cics read
  2643*       update
  2644*       dataset    ('ELCRTT')
  2645*       into       (certificate-trailers)
  2646*       ridfld     (elcrtt-key)
  2647*       resp       (ws-response)
  2648*    end-exec
  2649     MOVE LENGTH OF
  2650      certificate-trailers
  2651       TO DFHEIV11
  2652     MOVE 'ELCRTT' TO DFHEIV1
  2653*    MOVE '&"IL       EU         (  N#00002598' TO DFHEIV0
  2654     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2655     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2656     MOVE X'204E233030303032353938' TO DFHEIV0(25:11)
  2657     CALL 'kxdfhei1' USING DFHEIV0,
  2658           DFHEIV1,
  2659           certificate-trailers,
  2660           DFHEIV11,
  2661           elcrtt-key,
  2662           DFHEIV99,
  2663           DFHEIV99,
  2664           DFHEIV99
  2665     MOVE EIBRESP  TO ws-response
  2666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2667     if resp-notfnd
  2668*       display ' Read ELCrtt not found '
  2669        move spaces              to certificate-trailers
  2670        move 'CS'                to cs-record-id
  2671        move elcert-key          to cs-control-primary
  2672        move 'C'                 to cs-trailer-type
  2673        move ws-agent-first-name to cs-agent-fname
  2674        move ws-agent-mi         to cs-agent-mi
  2675        move ws-agent-last-name  to cs-agent-lname
  2676        move ws-agent-license-no to cs-license-no
  2677        move ws-agent-npn-no     to cs-npn-number
  2678        move 'V'                 to cs-agent-edit-status
  2679*    display ' about to write elcrtt ' cs-control-primary (2:19)
  2680*       ' ' cs-control-primary (23:12)
  2681
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  48
* EL203.cbl
  2682* exec cics write
  2683*          dataset    ('ELCRTT')
  2684*          from       (certificate-trailers)
  2685*          ridfld     (cs-control-primary)
  2686*          resp       (ws-response)
  2687*       end-exec
  2688     MOVE LENGTH OF
  2689      certificate-trailers
  2690       TO DFHEIV11
  2691     MOVE 'ELCRTT' TO DFHEIV1
  2692*    MOVE '&$ L                  ''  N#00002619' TO DFHEIV0
  2693     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2694     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2695     MOVE X'204E233030303032363139' TO DFHEIV0(25:11)
  2696     CALL 'kxdfhei1' USING DFHEIV0,
  2697           DFHEIV1,
  2698           certificate-trailers,
  2699           DFHEIV11,
  2700           cs-control-primary,
  2701           DFHEIV99,
  2702           DFHEIV99
  2703     MOVE EIBRESP  TO ws-response
  2704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2705        if resp-normal
  2706*          display ' write ELCrtt okay '
  2707           perform 0150-process-cert-notes
  2708                                 thru 0150-exit
  2709        else
  2710           move ' Bad ELCRTT write  '
  2711                                 to output-msg
  2712           display ' bad write on elcrtt ' ws-response ' '
  2713              ws-cert-key
  2714           go to 0000-return
  2715        end-if
  2716     else
  2717        if resp-normal
  2718*          display ' Read ELCrtt okay '
  2719           move ws-agent-first-name
  2720                                 to cs-agent-fname
  2721           move ws-agent-mi      to cs-agent-mi
  2722           move ws-agent-last-name
  2723                                 to cs-agent-lname
  2724           move ws-agent-license-no
  2725                                 to cs-license-no
  2726           move ws-agent-npn-no  to cs-npn-number
  2727           move 'V'              to cs-agent-edit-status
  2728*    display ' about to rewrite elcrtt '
  2729*       cs-control-primary (2:19) ' '
  2730*       cs-control-primary (23:12)
  2731
  2732* exec cics rewrite
  2733*             dataset    ('ELCRTT')
  2734*             from       (certificate-trailers)
  2735*             resp       (ws-response)
  2736*          end-exec
  2737     MOVE LENGTH OF
  2738      certificate-trailers
  2739       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  49
* EL203.cbl
  2740     MOVE 'ELCRTT' TO DFHEIV1
  2741*    MOVE '&& L                  %  N#00002651' TO DFHEIV0
  2742     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2743     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2744     MOVE X'204E233030303032363531' TO DFHEIV0(25:11)
  2745     CALL 'kxdfhei1' USING DFHEIV0,
  2746           DFHEIV1,
  2747           certificate-trailers,
  2748           DFHEIV11,
  2749           DFHEIV99
  2750     MOVE EIBRESP  TO ws-response
  2751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2752           if resp-normal
  2753*             display ' rewrite ELCrtt okay '
  2754              perform 0150-process-cert-notes
  2755                                 thru 0150-exit
  2756           else
  2757              move ' Bad ELCRTT rewrite  '
  2758                                 to output-msg
  2759              display ' bad rewrite on elcrtt ' ws-response ' '
  2760                 ws-cert-key
  2761              go to 0000-return
  2762           end-if
  2763        else
  2764           move ' Bad ELCRTT Read  '
  2765                                 to output-msg
  2766           display ' bad read on elcrtt ' ws-response ' '
  2767              ws-cert-key
  2768           go to 0000-return
  2769        end-if
  2770     end-if
  2771     .
  2772 0000-return.
  2773*    perform 0220-send-form      thru 0220-exit
  2774
  2775* exec cics
  2776*       return
  2777*    end-exec
  2778*    MOVE '.(                    ''   #00002678' TO DFHEIV0
  2779     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2780     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2781     MOVE X'2020233030303032363738' TO DFHEIV0(25:11)
  2782     CALL 'kxdfhei1' USING DFHEIV0,
  2783           DFHEIV99,
  2784           DFHEIV99,
  2785           DFHEIV99,
  2786           DFHEIV99,
  2787           DFHEIV99,
  2788           DFHEIV99
  2789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2790
  2791* goback
  2792
  2793     MOVE '9%                    "   ' TO DFHEIV0
  2794     MOVE 'EL203' TO DFHEIV1
  2795     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2796     goback
  2797     .
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  50
* EL203.cbl
  2798 0150-process-cert-notes.
  2799*    display ' made it to 0150 '
  2800     move spaces                 to cert-note-records-holder
  2801                                    ws-build-note-sw
  2802                                    ws-ercnot-sw
  2803     move cm-control-primary     to ws-cz-key
  2804     move '1'                    to ws-cz-rec-type
  2805     move +0                     to ws-cz-note-seq
  2806                                    c1
  2807*    display ' about to startbr ercnot ' ws-cz-key (2:19) ' '
  2808*       ws-cz-key (23:12) ' ' ws-cz-note-seq
  2809
  2810* EXEC CICS STARTBR
  2811*         DATASET    ('ERCNOT')
  2812*         RIDFLD     (WS-CZ-KEY)
  2813*         GTEQ
  2814*         RESP       (WS-RESPONSE)
  2815*    END-EXEC
  2816     MOVE 'ERCNOT' TO DFHEIV1
  2817     MOVE 0
  2818       TO DFHEIV11
  2819*    MOVE '&,         G          &  N#00002694' TO DFHEIV0
  2820     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2821     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2822     MOVE X'204E233030303032363934' TO DFHEIV0(25:11)
  2823     CALL 'kxdfhei1' USING DFHEIV0,
  2824           DFHEIV1,
  2825           WS-CZ-KEY,
  2826           DFHEIV99,
  2827           DFHEIV11,
  2828           DFHEIV99
  2829     MOVE EIBRESP  TO WS-RESPONSE
  2830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2831     IF RESP-NORMAL
  2832*       display ' normal startbr '
  2833        set ercnot-startbr to true
  2834        perform until finished-with-notes
  2835*    display ' about to readnext ercnot ' ws-cz-key (2:19) ' '
  2836*       ws-cz-key (23:12) ' ' ws-cz-note-seq
  2837
  2838* EXEC CICS READNEXT
  2839*             DATASET    ('ERCNOT')
  2840*             RIDFLD     (WS-CZ-KEY)
  2841*             INTO       (cert-note-file)
  2842*             resp       (ws-response)
  2843*          end-exec
  2844     MOVE LENGTH OF
  2845      cert-note-file
  2846       TO DFHEIV12
  2847     MOVE 'ERCNOT' TO DFHEIV1
  2848     MOVE 0
  2849       TO DFHEIV11
  2850*    MOVE '&.IL                  )  N#00002706' TO DFHEIV0
  2851     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2852     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2853     MOVE X'204E233030303032373036' TO DFHEIV0(25:11)
  2854     CALL 'kxdfhei1' USING DFHEIV0,
  2855           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  51
* EL203.cbl
  2856           cert-note-file,
  2857           DFHEIV12,
  2858           WS-CZ-KEY,
  2859           DFHEIV99,
  2860           DFHEIV11,
  2861           DFHEIV99,
  2862           DFHEIV99
  2863     MOVE EIBRESP  TO ws-response
  2864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2865           if (resp-normal)
  2866              and (cz-control-primary (1:33) =
  2867                 cm-control-primary (1:33))
  2868              if cz-record-type = '1'
  2869                 add +1 to c1
  2870                 move cert-note-file
  2871                                 to cert-note-record (c1)
  2872              end-if
  2873           else
  2874              set finished-with-notes to true
  2875           end-if
  2876        end-perform
  2877     end-if
  2878     if ercnot-startbr
  2879*    display ' about to endbr ercnot '
  2880
  2881* exec cics endbr
  2882*          dataset    ('ERCNOT')
  2883*       end-exec
  2884     MOVE 'ERCNOT' TO DFHEIV1
  2885     MOVE 0
  2886       TO DFHEIV11
  2887*    MOVE '&2                    $   #00002727' TO DFHEIV0
  2888     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2889     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2890     MOVE X'2020233030303032373237' TO DFHEIV0(25:11)
  2891     CALL 'kxdfhei1' USING DFHEIV0,
  2892           DFHEIV1,
  2893           DFHEIV11,
  2894           DFHEIV99
  2895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2896     end-if
  2897     move c1                     to note-count
  2898     if c1 = +0
  2899*       display ' c1 equals 0 '
  2900        perform 0151-add-verify-agent-sig-note
  2901                                 thru 0151-exit
  2902     else
  2903        if cnr-rest (1) (1:24) = 'AGENT SIGNATURE VERIFIED'
  2904           go to 0150-exit
  2905        else
  2906           perform 0152-delete-cert-notes
  2907                                 thru 0152-exit
  2908           if resp-normal
  2909              perform 0151-add-verify-agent-sig-note
  2910                                 thru 0151-exit
  2911           end-if
  2912           if resp-normal
  2913              perform 0153-put-back-cert-notes
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  52
* EL203.cbl
  2914                                 thru 0153-exit
  2915           end-if
  2916        end-if
  2917     end-if
  2918     .
  2919 0150-exit.
  2920     exit.
  2921 0151-add-verify-agent-sig-note.
  2922     move 'CZ'                to cert-note-file
  2923     move cm-control-primary  to cz-control-primary
  2924     move '1'                 to cz-record-type
  2925     move +1                  to cz-note-sequence
  2926     move ws-current-bin-dt   to cz-last-maint-dt
  2927     move eibtime             to cz-last-maint-hhmmss
  2928     move ws-proc-id          to cz-last-maint-user
  2929     MOVE 'AGENT SIGNATURE VERIFIED'
  2930                              to cz-note
  2931*    display ' about to write ercnot ' cz-control-primary (2:19)
  2932*       ' ' cz-control-primary (23:12) ' ' cz-note-sequence
  2933
  2934* exec cics write
  2935*       dataset   ('ERCNOT')
  2936*       from      (cert-note-file)
  2937*       ridfld    (cz-control-primary)
  2938*       resp      (ws-response)
  2939*    end-exec
  2940     MOVE LENGTH OF
  2941      cert-note-file
  2942       TO DFHEIV11
  2943     MOVE 'ERCNOT' TO DFHEIV1
  2944*    MOVE '&$ L                  ''  N#00002767' TO DFHEIV0
  2945     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2946     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2947     MOVE X'204E233030303032373637' TO DFHEIV0(25:11)
  2948     CALL 'kxdfhei1' USING DFHEIV0,
  2949           DFHEIV1,
  2950           cert-note-file,
  2951           DFHEIV11,
  2952           cz-control-primary,
  2953           DFHEIV99,
  2954           DFHEIV99
  2955     MOVE EIBRESP  TO ws-response
  2956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2957     if not resp-normal
  2958        display ' error-ercnot-write ' ws-response ' '
  2959           cz-control-primary (2:19)
  2960        ' ' cz-control-primary (23:12) ' ' cz-note-sequence
  2961     end-if
  2962     .
  2963 0151-exit.
  2964     exit.
  2965 0152-delete-cert-notes.
  2966     move cm-control-primary     to ws-cz-key
  2967     move '1'                    to ws-cz-rec-type
  2968     move +0                     to ws-cz-note-seq
  2969*    display ' about to delete ercnot ' ws-cz-key (2:19)
  2970*       ' ' ws-cz-key (23:12) ' ' ws-cz-note-seq ' '
  2971*       ws-cert-note-generic-key-len
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  53
* EL203.cbl
  2972
  2973* exec cics delete
  2974*       dataset    ('ERCNOT')
  2975*       keylength  (ws-cert-note-generic-key-len)
  2976*       ridfld     (ws-cz-key)
  2977*       generic
  2978*       resp       (ws-response)
  2979*    end-exec
  2980     MOVE 'ERCNOT' TO DFHEIV1
  2981*    MOVE '&(  RKG               &  N#00002788' TO DFHEIV0
  2982     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  2983     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2984     MOVE X'204E233030303032373838' TO DFHEIV0(25:11)
  2985     CALL 'kxdfhei1' USING DFHEIV0,
  2986           DFHEIV1,
  2987           ws-cz-key,
  2988           ws-cert-note-generic-key-len,
  2989           DFHEIV99,
  2990           DFHEIV99
  2991     MOVE EIBRESP  TO ws-response
  2992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2993     if resp-normal
  2994        continue
  2995*       display ' generic delete okay '
  2996     else
  2997        display ' error-ercnot-delete ' ws-response
  2998     end-if
  2999     .
  3000 0152-exit.
  3001     exit.
  3002 0153-put-back-cert-notes.
  3003*    display ' made it to 0153 '
  3004     perform varying c1 from +1 by +1 until
  3005        c1 > note-count
  3006        move cert-note-record (c1)
  3007                                 to cert-note-file
  3008        add +1                   to cz-note-sequence
  3009*    display ' about to write ercnot ' cz-control-primary (2:19)
  3010*       ' ' cz-control-primary (23:12) ' ' cz-note-sequence
  3011
  3012* exec cics write
  3013*          dataset ('ERCNOT')
  3014*          FROM    (cert-note-file)
  3015*          ridfld  (cz-control-primary)
  3016*          resp    (ws-response)
  3017*       end-exec
  3018     MOVE LENGTH OF
  3019      cert-note-file
  3020       TO DFHEIV11
  3021     MOVE 'ERCNOT' TO DFHEIV1
  3022*    MOVE '&$ L                  ''  N#00002813' TO DFHEIV0
  3023     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3024     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3025     MOVE X'204E233030303032383133' TO DFHEIV0(25:11)
  3026     CALL 'kxdfhei1' USING DFHEIV0,
  3027           DFHEIV1,
  3028           cert-note-file,
  3029           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  54
* EL203.cbl
  3030           cz-control-primary,
  3031           DFHEIV99,
  3032           DFHEIV99
  3033     MOVE EIBRESP  TO ws-response
  3034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3035        if not resp-normal
  3036           display ' error-ercnot-write subsequ ' ws-response ' '
  3037              cz-control-primary (2:33)
  3038           move +999             to c1
  3039        end-if
  3040     end-perform
  3041    .
  3042 0153-exit.
  3043     exit.
  3044 0220-send-form.
  3045     move ws-comp-id             to out-comp-id
  3046     move 'AGENT SIG  '          to output-title
  3047*    display ' about to send form '
  3048
  3049* exec cics document create
  3050*       doctoken   (w-doctoken)
  3051*       template   ('AGENTSIG')
  3052*       symbollist (output-data)
  3053*       listlength (length of output-data)
  3054*    end-exec
  3055     MOVE 'AGENTSIG'
  3056      TO DFHEIVL0
  3057     MOVE LENGTH OF
  3058      output-data TO DFHEIV16
  3059*    MOVE '\"D tSL               )   #00002832' TO DFHEIV0
  3060     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  3061     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3062     MOVE X'2020233030303032383332' TO DFHEIV0(25:11)
  3063     CALL 'kxdfhei1' USING DFHEIV0,
  3064           w-doctoken,
  3065           DFHEIV99,
  3066           DFHEIVL0,
  3067           output-data,
  3068           DFHEIV16,
  3069           DFHEIV99,
  3070           DFHEIV99,
  3071           DFHEIV99
  3072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3073
  3074* exec cics web send
  3075*       doctoken(w-doctoken)
  3076*    end-exec
  3077*    MOVE 'X$D                   *   #00002838' TO DFHEIV0
  3078     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  3079     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  3080     MOVE X'2020233030303032383338' TO DFHEIV0(25:11)
  3081     CALL 'kxdfhei1' USING DFHEIV0,
  3082           w-doctoken,
  3083           DFHEIV99,
  3084           DFHEIV99,
  3085           DFHEIV99,
  3086           DFHEIV99,
  3087           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  55
* EL203.cbl
  3088           DFHEIV99,
  3089           DFHEIV99,
  3090           DFHEIV99
  3091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3092     .
  3093 0220-exit.
  3094     exit.
  3095 9700-DATE-CONVERT.
  3096
  3097* EXEC CICS LINK
  3098*         PROGRAM  ('ELDATCV')
  3099*         COMMAREA (DATE-CONVERSION-DATA)
  3100*         LENGTH   (DC-COMM-LENGTH)
  3101*    END-EXEC.
  3102     MOVE 'ELDATCV' TO DFHEIV1
  3103*    MOVE '."C                   (   #00002845' TO DFHEIV0
  3104     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3106     MOVE X'2020233030303032383435' TO DFHEIV0(25:11)
  3107     CALL 'kxdfhei1' USING DFHEIV0,
  3108           DFHEIV1,
  3109           DATE-CONVERSION-DATA,
  3110           DC-COMM-LENGTH,
  3111           DFHEIV99,
  3112           DFHEIV99,
  3113           DFHEIV99,
  3114           DFHEIV99
  3115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3116
  3117 9700-EXIT.
  3118      EXIT.
  3119
  3120 9999-DFHBACK SECTION.
  3121     MOVE '9%                    "   ' TO DFHEIV0
  3122     MOVE 'EL203' TO DFHEIV1
  3123     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3124     GOBACK.
  3125 9999-DFHEXIT.
  3126     IF DFHEIGDJ EQUAL 0001
  3127         NEXT SENTENCE.
  3128     MOVE '9%                    "   ' TO DFHEIV0
  3129     MOVE 'EL203' TO DFHEIV1
  3130     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3131     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       50088     Code:        4806
