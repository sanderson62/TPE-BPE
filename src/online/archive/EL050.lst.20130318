* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45******************************************************************
    46 ENVIRONMENT DIVISION.
    47
    48 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   3
* EL050.cbl
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52
    53 77  FILLER   PIC X(32) VALUE '********************************'.
    54 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    55 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    56
    57 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    58 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    59                                   USAGE POINTER.
    60 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    61 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    63                                   USAGE IS POINTER.
    64 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    65 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    66                                   USAGE IS POINTER.
    67 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    68 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    69                                   USAGE IS POINTER.
    70
    71 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    73                                   USAGE IS POINTER.
    74
    75*    COPY ELC50WS.
    76*****************************************************************
    77*                                                               *
    78*                            ELC50WS.                           *
    79*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    80*                            VMOD=2.061.                        *
    81*                                                               *
    82*   THIS IS THE WORKING STORAGE FOR EL050                       *
    83*                                   EL517                       *
    84*****************************************************************
    85******************************************************************
    86*                   C H A N G E   L O G
    87*
    88* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    89*-----------------------------------------------------------------
    90*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    91* EFFECTIVE    NUMBER
    92*-----------------------------------------------------------------
    93* 123102                   PEMA  ADD DCC PROCESSING
    94* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    95* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    96* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    97* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    98* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    99* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   100* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   101* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   102* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   103* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   104* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   105* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   106* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   107* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   4
* EL050.cbl
   108* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   109* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   110* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   111* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   112* 030309  CR2009021700001  PEMA  ADD ER-2883
   113* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   114* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   115* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   116* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   117* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   118* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   119* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   120* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   121* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   122* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   123* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   124* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   125* 061412  CR2011022800001  AJRA  NAPERSOFT
   126* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   127* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   128*-----------------------------------------------------------------
   129
   130 01  WORK-AREAS.
   131
   132*****************************************************************
   133*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   134*****************************************************************
   135
   136     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   137     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   138     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   139     12  WS-NAME-EDIT-WORK-AREA.
   140         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   141         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   142             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   143         16  WS-WORK-NAME.
   144             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   145             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   146             20  FILLER           PIC X(10)     VALUE SPACES.
   147         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   148             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   149
   150*****************************************************************
   151*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   152*****************************************************************
   153
   154     12  WS-ERRESC-KEY.
   155         16 WS-ERRESC-SEARCH-KEY.
   156             20  WS-ERRESC-COMPANY-CD PIC  X.
   157             20  WS-ERRESC-CARRIER    PIC  X.
   158             20  WS-ERRESC-GROUP      PIC X(6).
   159             20  WS-ERRESC-STATE      PIC XX.
   160             20  WS-ERRESC-ACCOUNT    PIC X(10).
   161         16 WS-ERRESC-RESIDUAL-KEY.
   162             20  WS-ERRESC-AGENT      PIC X(10).
   163             20  WS-ERRESC-RES-STATE  PIC XX.
   164             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   165*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   5
* EL050.cbl
   166     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   167     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   168
   169*RESIDENT STATE TAX MASTER(ERRESS)
   170*
   171     12  WS-ERRESS-KEY.
   172         16  WS-ERRESS-COMPANY-CD      PIC  X.
   173         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   174         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   175         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   176*                                          YYYYMMDD
   177
   178     12  WS-CONTRACT-DATE              PIC 9(8).
   179*                                          YYYYMMDD
   180     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   181     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   182         16 WS-YEAR-YY                 PIC   9999.
   183         16 FILLER                     PIC 9(4).
   184*                                          YYYYMMDD
   185     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   186     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   187     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   188     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   189
   190     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   191         88  DPRB-1ST-TIME                      VALUE ' '.
   192
   193*****************************************************************
   194*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   195*****************************************************************
   196
   197     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   198     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   199     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   200     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   201     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   202     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   203     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   204     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   205     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   206     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   207         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   208         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   209     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   210         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   211         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   212     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   213
   214     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   215     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   216
   217     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   218     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   219     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   220     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   222     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   223     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   6
* EL050.cbl
   224     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   228     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   229     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   230     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   231     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   232     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   252     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   253     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   254     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   255     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   256     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   257     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   265     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   266     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   267     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   268     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   269     12  WS-2671-SW               PIC X         VALUE SPACE.
   270     12  WS-2672-SW               PIC X         VALUE SPACE.
   271     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   272         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   273     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   274         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   275     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   276
   277     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   278         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   279         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   280         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   281         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   7
* EL050.cbl
   282
   283     12  WS-CREDIT-EDIT-CONTROLS.
   284         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   285         16  WS-MIN-AGE           PIC 99                VALUE  0.
   286         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   287         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   288         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   289         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   290
   291     12  WS-AGE-FIELDS.
   292         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   293         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   294         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   295         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   296
   297     12  WS-SAVE-ALLOWABLE-BENEFIT.
   298         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   299         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   300         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   301         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   302         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   303         16  FILLER                      PIC XX.
   304
   305     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   306     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   307     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   308     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   309     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   310     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   311     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   312     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   313     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   314     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   315
   316     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   317     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   318     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   319     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   320     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   321     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   322     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   323     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   324         88  WS-REDUCING              VALUE 'R'.
   325         88  WS-LEVEL                 VALUE 'L' 'P'.
   326     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   327
   328     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   329     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   330     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   331     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   332     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   333     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   334     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   335     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   336     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   337
   338     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   339     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   8
* EL050.cbl
   340     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   341     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   342     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   343     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   344     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   345     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   346     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   347     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   348     12  WS-ACCT-SIG-SW.
   349         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   350         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   351     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   352     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   353     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   354     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   355     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   356     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   357     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   358     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   359     12  WS-INITIALS.
   360         16  WS-INIT-1            PIC X         VALUE SPACES.
   361         16  WS-INIT-2            PIC X         VALUE SPACES.
   362
   363     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   364     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   365     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   366     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   367     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   368*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   369     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   370     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   371     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   372     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   373     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   374     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   375     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   376     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   377     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   378     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   379     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   380     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   381     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   382     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   383     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   385     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   386     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   387     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   388     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   389     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   390     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   391******** FLA
   392     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   393     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   394     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   395     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   396     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   397********
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   9
* EL050.cbl
   398     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   399     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   400     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   401     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   402     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   403     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   404     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   405     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   406     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   407     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   408
   409     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   410         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   411                                         '0' THRU '9'.
   412
   413     12  NUMBER-OF-MONTHS.
   414         16  SK-MO OCCURS 12 TIMES PIC X.
   415
   416     12  WS-WORK-DATE.
   417         16  WS-YEAR            PIC 99    VALUE 00.
   418         16  WS-MONTH           PIC 99    VALUE 00.
   419         16  WS-DAY             PIC 99    VALUE 00.
   420
   421     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   422     12  WS-WORK-CRIT-DEV       REDEFINES
   423         WS-WORK-LF-CRIT-PER    PIC X(03).
   424
   425     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   426     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   427
   428     12  WS-WORK-DATE-FROM.
   429         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   430         16  FILLER             PIC X  VALUE SPACE.
   431         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   432         16  FILLER             PIC X         VALUE SPACE.
   433         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   434
   435     12  WS-WORK-DATE-THRU.
   436         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   437         16  FILLER             PIC X         VALUE SPACE.
   438         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   439         16  FILLER             PIC X         VALUE SPACE.
   440         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   441
   442     12  WS-LF-INPUT-CD.
   443         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   444         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   445
   446     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   447     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   448         16  WS-AH-INPUT-CD-1   PIC X.
   449         16  WS-AH-INPUT-CD-2-3 PIC XX.
   450
   451     12  WS-SWITCHES.
   452         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   453         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   454             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   455         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  10
* EL050.cbl
   456             88  BANK-ACCT-FOUND          VALUE 'Y'.
   457         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   458             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   459         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   460             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   461         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   462             88  COMP-MASTER-FOUND        VALUE 'Y'.
   463         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   464             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   465         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   466             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   467         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   468             88  STAT-MASTER-FOUND        VALUE 'Y'.
   469         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   470             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   471         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   472             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   473         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   474             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   475         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   476             88  FORM-MASTER-FOUND        VALUE 'Y'.
   477         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   478             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   479         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   480             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   481         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   482             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   483         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   484             88  NO-BENEFIT-FOUND         VALUE 'N'.
   485         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   486             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   487         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   488             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   489         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   490             88  AH-BENEFIT-FOUND         VALUE ' '.
   491             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   492         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   493             88  LF-BENEFIT-FOUND         VALUE ' '.
   494             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   495         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   496             88  NO-STATE-RECORD          VALUE '1'.
   497         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   498             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   499         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   500             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   501         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   502             88  CERT-WAS-FOUND           VALUE ' '.
   503             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   504         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   505             88  BROWSE-STARTED           VALUE 'Y'.
   506         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   507             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   508         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   509             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   510         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   511             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   512         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   513             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  11
* EL050.cbl
   514         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   515             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   516         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   517             88  APP-CERT-USED            VALUE 'Y' 'A'.
   518         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   519             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   520             88  FIRST-TIME-THROUGH       VALUE '1'.
   521             88  CTBL-NOT-FOUND           VALUE '2'.
   522
   523         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   524             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   525
   526         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   527             88  DLO-ERROR-FOUND          VALUE 'Y'.
   528
   529********FLA
   530     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   531     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   532********
   533     12  RC-SW-1                  PIC X           VALUE '0'.
   534     12  RC-SW-2                  PIC X           VALUE '0'.
   535     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   536     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   537     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   538     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   539     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   540     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   541     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   542     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   543     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   544     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   545     12  LIT-SPACES               PIC X           VALUE SPACES.
   546     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   547     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   548     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   549     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   550     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   551     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   552     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   553         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   554         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   555     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   556         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   557
   558 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   559     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   560     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   561 01  WS-CRI-SSN-WORK-AREA.
   562     05  WS-CRI-SOC-SEC-NO.
   563         10  WS-SS-REPT-CD       PIC X(5).
   564         10  WS-SS-LAST-NAME     PIC X(5).
   565         10  WS-SS-INITIAL       PIC X.
   566
   567     05  WS-CRI-REPORT-CODE.
   568         10  FILLER              PIC X(5).
   569         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   570
   571     05  WS-CRI-LAST-NAME.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  12
* EL050.cbl
   572         10  WS-CRI-NAME-MOVE    PIC X(5).
   573         10  FILLER              PIC X(10).
   574
   575 01  WS-NUM-TABLE                PIC X(26)  VALUE
   576     '12345678012345070923456789'.
   577 01  FILLER REDEFINES WS-NUM-TABLE.
   578     05  WS-NUM OCCURS 26        PIC 9.
   579 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   580 01  V1                          PIC S999 COMP-3.
   581 01  V2                          PIC S999 COMP-3.
   582 01  V3                          PIC S999 COMP-3.
   583 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   584 01  FILLER REDEFINES WS-WORK-VIN.
   585     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   586 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   587 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   588 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   589 01  WS-HEX-WORK.
   590     05  FILLER                  PIC X  VALUE LOW-VALUES.
   591     05  WS-HEX-BYTE             PIC X.
   592 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   593 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   594 01  WS-WORK-HIN-ROW-B.
   595     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   596
   597 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   598 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   599     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   600 01  WS-ROW-D-TABLE.
   601     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   602
   603 01  WS-HIN-TABLE-B.
   604     05  F                       PIC XX VALUE 'A2'.
   605     05  F                       PIC XX VALUE 'B3'.
   606     05  F                       PIC XX VALUE 'C4'.
   607     05  F                       PIC XX VALUE 'D5'.
   608     05  F                       PIC XX VALUE 'E6'.
   609     05  F                       PIC XX VALUE 'F7'.
   610     05  F                       PIC XX VALUE 'G8'.
   611     05  F                       PIC XX VALUE 'H9'.
   612     05  F                       PIC XX VALUE 'I1'.
   613     05  F                       PIC XX VALUE 'J2'.
   614     05  F                       PIC XX VALUE 'K3'.
   615     05  F                       PIC XX VALUE 'L4'.
   616     05  F                       PIC XX VALUE 'M5'.
   617     05  F                       PIC XX VALUE 'N6'.
   618     05  F                       PIC XX VALUE 'O0'.
   619     05  F                       PIC XX VALUE 'P7'.
   620     05  F                       PIC XX VALUE 'Q0'.
   621     05  F                       PIC XX VALUE 'R8'.
   622     05  F                       PIC XX VALUE 'S9'.
   623     05  F                       PIC XX VALUE 'T2'.
   624     05  F                       PIC XX VALUE 'U3'.
   625     05  F                       PIC XX VALUE 'V4'.
   626     05  F                       PIC XX VALUE 'W5'.
   627     05  F                       PIC XX VALUE 'X6'.
   628     05  F                       PIC XX VALUE 'Y7'.
   629     05  F                       PIC XX VALUE 'Z8'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  13
* EL050.cbl
   630 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   631     05  WS-VAL-IN               PIC X.
   632     05  WS-VAL-OUT              PIC 9.
   633 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   634 01  WS-COMPARE-BINARY-DATES.
   635     05  WS-971231                PIC XX VALUE X'92FF'.
   636     05  WS-931231                PIC XX VALUE X'8CFF'.
   637     05  WS-791231                PIC XX VALUE X'77FF'.
   638     05  WS-771001                PIC XX VALUE X'74A1'.
   639     05  WS-820301                PIC XX VALUE X'7B41'.
   640     05  WS-831031                PIC XX VALUE X'7DBF'.
   641     05  WS-831231                PIC XX VALUE X'7DFF'.
   642     05  WS-810831                PIC XX VALUE X'7A7F'.
   643     05  WS-830901                PIC XX VALUE X'7D81'.
   644
   645 01  FILE-ACCESS-IDS.
   646     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   647     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   648     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   649     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   650     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   651     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   652     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   653     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   654     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   655     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   656     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   657     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   658     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   659     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   660     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   661     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   662     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   663 01  DD-IU-SW                    PIC X   VALUE ' '.
   664     88  DD-IU-PRESENT                 VALUE 'Y'.
   665
   666 01  ACCESS-KEYS.
   667     12  ELMSTR-KEY.
   668         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   669         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   670     12  W-CLAIM-KEY.
   671         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   672         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   673
   674     12  ELCNTL-KEY.
   675         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   676         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   677         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   678         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   679
   680     12  ELCERT-KEY.
   681         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   682         16  CERT-CARRIER         PIC X       VALUE SPACE.
   683         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   684         16  CERT-STATE           PIC XX      VALUE SPACES.
   685         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   686         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   687         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  14
* EL050.cbl
   688
   689     12  ELCERT2-KEY.
   690         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   691         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   692
   693     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   694
   695     12  ELCERT-SAVE.
   696         16  FILLER                      PIC XX    VALUE SPACES.
   697
   698         16  WCS-CONTROL-PRIMARY.
   699             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   700             20  WCS-CARRIER             PIC X     VALUE SPACE.
   701             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   702             20  WCS-STATE               PIC XX    VALUE SPACES.
   703             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   704             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   705             20  WCS-CERT-NO.
   706                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   707                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   708
   709         16  CS-CONTROL-BY-NAME.
   710             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   711             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   712             20  CS-INSURED-INITIALS.
   713                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   714                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   715
   716         16  CS-CONTROL-BY-SSN.
   717             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   718             20  CS-SOC-SEC-NO.
   719                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   720                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   721                 24  CS-SSN-LN3.
   722                     28 CS-INSURED-INITIALS-A2   PIC XX
   723                                     VALUE SPACES.
   724                     28 CS-PART-LAST-NAME-A2     PIC X
   725                                     VALUE SPACE.
   726
   727         16  CS-CONTROL-BY-CERT-NO.
   728             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   729             20  CS-CERT-NO-A4           PIC X(11)
   730                                     VALUE SPACES.
   731
   732         16  CS-CONTROL-BY-MEMB.
   733             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   734             20  CS-MEMBER-NO.
   735                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   736                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   737                 24  CS-MEMB-LN4.
   738                     28 CS-INSURED-INITIALS-A5   PIC XX
   739                                      VALUE SPACES.
   740                     28 CS-PART-LAST-NAME-A5     PIC XX
   741                                      VALUE SPACES.
   742
   743         16  FILLER              PIC X(360) VALUE SPACES.
   744
   745     12  ERACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  15
* EL050.cbl
   746         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   747         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   748         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   749         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   750         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   751         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   752
   753     12  ERCOMP-KEY.
   754         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   755         16  COMP-CARRIER         PIC X     VALUE SPACES.
   756         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   757         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   758         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   759         16  COMP-TYPE            PIC X     VALUE SPACES.
   760
   761     12  ERLOFC-KEY.
   762         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   763         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   764         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   765         16  LOFC-STATE           PIC XX    VALUE SPACES.
   766         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   767         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   768
   769     12  WS-ELCRTT-KEY.
   770         16  WS-ELCRTT-PRIMARY       PIC X(33).
   771         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   772
   773     12  ERBXRF-KEY.
   774         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   775         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   776         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   777         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   778
   779     12  ERAGTC-KEY.
   780         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   781         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   782         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   783         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   784         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   785         16  AGTC-TYPE            PIC X     VALUE SPACES.
   786
   787     12  ERPLAN-KEY.
   788         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   789         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   790         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   791         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   792         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   793         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   794         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   795         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   796
   797     12  ERFORM-KEY.
   798         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   799         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   800         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   801         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   802
   803     12  ERREIN-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  16
* EL050.cbl
   804         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   805         16  REIN-TYPE            PIC X     VALUE SPACES.
   806         16  REIN-TABLE-CO.
   807             20  REIN-CODE-1      PIC X     VALUE SPACE.
   808             20  REIN-CODE-2      PIC X     VALUE SPACE.
   809             20  REIN-CODE-3      PIC X     VALUE SPACE.
   810         16  FILLER               PIC X(3)  VALUE SPACES.
   811
   812     12  ERCTBL-KEY.
   813         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   814         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   815         16  CTBL-CNTRL-2.
   816             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   817             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   818
   819     12  ELCRTO-KEY.
   820         16  ELCRTO-COMPANY-CD       PIC X.
   821         16  ELCRTO-CARRIER          PIC X.
   822         16  ELCRTO-GROUPING         PIC X(6).
   823         16  ELCRTO-STATE            PIC XX.
   824         16  ELCRTO-ACCOUNT          PIC X(10).
   825         16  ELCRTO-CERT-EFF-DT      PIC XX.
   826         16  ELCRTO-CERT-NO.
   827             20  ELCRTO-CERT-PRIME   PIC X(10).
   828             20  ELCRTO-CERT-SFX     PIC X.
   829         16  ELCRTO-RECORD-TYPE      PIC X.
   830         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   831
   832
   833     12  WS-ACCESS.
   834         16  FILLER               PIC XX    VALUE SPACES.
   835         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   836
   837     12  WS-CARR-ACCESS.
   838         16  FILLER               PIC X(3)  VALUE SPACES.
   839         16  WS-CARR              PIC X     VALUE SPACE.
   840*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   841*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   842     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   843         88  WS-DMD-LF-RATING   VALUE 'Y'.
   844         88  WS-DMD-AH-RATING   VALUE 'Y'.
   845         88  WS-DMD-NO-RATING   VALUE 'N'.
   846
   847     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   848         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   849                                         'NJ' 'NL'
   850                                         'PJ' 'PL'
   851                                         'SJ' 'SL'.
   852     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   853         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   854                                         'NI' 'NJ' 'NL' 'NU'
   855                                         'PJ' 'PL' 'PI' 'PU'
   856                                         'SI' 'SJ' 'SL' 'SU'
   857                                         'MX' 'MY' 'MZ'.
   858 01  ERPDEF-KEY-SAVE             PIC X(18).
   859 01  ERPDEF-KEY.
   860     12  ERPDEF-COMPANY-CD       PIC X.
   861     12  ERPDEF-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  17
* EL050.cbl
   862     12  ERPDEF-PROD-CD          PIC XXX.
   863     12  F                       PIC X(7).
   864     12  ERPDEF-BEN-TYPE         PIC X.
   865     12  ERPDEF-BEN-CODE         PIC XX.
   866     12  ERPDEF-EXP-DT           PIC XX.
   867
   868 01  ELSTAT-KEY-SAVE             PIC X(20).
   869 01  ELSTAT-KEY.
   870     12  ELSTAT-COMPANY-ID       PIC XXX.
   871     12  ELSTAT-CARRIER          PIC X.
   872     12  ELSTAT-GROUP            PIC X(6).
   873     12  ELSTAT-STATE            PIC XX.
   874     12  ELSTAT-EXP-DT           PIC 9(8).
   875 01  WS-ERROR-VALUES.
   876     12  ER-1570                     PIC S9(4)   VALUE +1570.
   877     12  ER-1571                     PIC S9(4)   VALUE +1571.
   878     12  ER-1575                     PIC S9(4)   VALUE +1575.
   879     12  ER-1891                     PIC S9(4)   VALUE +1891.
   880     12  ER-1892                     PIC S9(4)   VALUE +1892.
   881     12  ER-1893                     PIC S9(4)   VALUE +1893.
   882     12  ER-1894                     PIC S9(4)   VALUE +1894.
   883     12  ER-1895                     PIC S9(4)   VALUE +1895.
   884     12  ER-1896                     PIC S9(4)   VALUE +1896.
   885     12  ER-1897                     PIC S9(4)   VALUE +1897.
   886     12  ER-1898                     PIC S9(4)   VALUE +1898.
   887     12  ER-1899                     PIC S9(4)   VALUE +1899.
   888     12  ER-1900                     PIC S9(4)   VALUE +1900.
   889     12  ER-1901                     PIC S9(4)   VALUE +1901.
   890     12  ER-1902                     PIC S9(4)   VALUE +1902.
   891     12  ER-1903                     PIC S9(4)   VALUE +1903.
   892     12  ER-1904                     PIC S9(4)   VALUE +1904.
   893     12  ER-1905                     PIC S9(4)   VALUE +1905.
   894     12  ER-1906                     PIC S9(4)   VALUE +1906.
   895     12  ER-1907                     PIC S9(4)   VALUE +1907.
   896     12  ER-1909                     PIC S9(4)   VALUE +1909.
   897     12  ER-1910                     PIC S9(4)   VALUE +1910.
   898     12  ER-1911                     PIC S9(4)   VALUE +1911.
   899     12  ER-1912                     PIC S9(4)   VALUE +1912.
   900     12  ER-1913                     PIC S9(4)   VALUE +1913.
   901     12  ER-1914                     PIC S9(4)   VALUE +1914.
   902     12  ER-1915                     PIC S9(4)   VALUE +1915.
   903     12  ER-1916                     PIC S9(4)   VALUE +1916.
   904     12  ER-1917                     PIC S9(4)   VALUE +1917.
   905     12  ER-1918                     PIC S9(4)   VALUE +1918.
   906     12  ER-1919                     PIC S9(4)   VALUE +1919.
   907     12  ER-1920                     PIC S9(4)   VALUE +1920.
   908     12  ER-1921                     PIC S9(4)   VALUE +1921.
   909     12  ER-1922                     PIC S9(4)   VALUE +1922.
   910     12  ER-1923                     PIC S9(4)   VALUE +1923.
   911     12  ER-1924                     PIC S9(4)   VALUE +1924.
   912     12  ER-1925                     PIC S9(4)   VALUE +1925.
   913     12  ER-1926                     PIC S9(4)   VALUE +1926.
   914     12  ER-1927                     PIC S9(4)   VALUE +1927.
   915     12  ER-2393                     PIC S9(4)   VALUE +2393.
   916     12  ER-2600                     PIC S9(4)   VALUE +2600.
   917     12  ER-2601                     PIC S9(4)   VALUE +2601.
   918     12  ER-2602                     PIC S9(4)   VALUE +2602.
   919     12  ER-2603                     PIC S9(4)   VALUE +2603.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  18
* EL050.cbl
   920     12  ER-2604                     PIC S9(4)   VALUE +2604.
   921     12  ER-2605                     PIC S9(4)   VALUE +2605.
   922     12  ER-2606                     PIC S9(4)   VALUE +2606.
   923     12  ER-2607                     PIC S9(4)   VALUE +2607.
   924     12  ER-2608                     PIC S9(4)   VALUE +2608.
   925     12  ER-2609                     PIC S9(4)   VALUE +2609.
   926     12  ER-2610                     PIC S9(4)   VALUE +2610.
   927     12  ER-2611                     PIC S9(4)   VALUE +2611.
   928     12  ER-2612                     PIC S9(4)   VALUE +2612.
   929     12  ER-2613                     PIC S9(4)   VALUE +2613.
   930     12  ER-2614                     PIC S9(4)   VALUE +2614.
   931     12  ER-2615                     PIC S9(4)   VALUE +2615.
   932     12  ER-2616                     PIC S9(4)   VALUE +2616.
   933     12  ER-2617                     PIC S9(4)   VALUE +2617.
   934     12  ER-2618                     PIC S9(4)   VALUE +2618.
   935     12  ER-2619                     PIC S9(4)   VALUE +2619.
   936     12  ER-2620                     PIC S9(4)   VALUE +2620.
   937     12  ER-2621                     PIC S9(4)   VALUE +2621.
   938     12  ER-2622                     PIC S9(4)   VALUE +2622.
   939     12  ER-2623                     PIC S9(4)   VALUE +2623.
   940     12  ER-2624                     PIC S9(4)   VALUE +2624.
   941     12  ER-2625                     PIC S9(4)   VALUE +2625.
   942     12  ER-2626                     PIC S9(4)   VALUE +2626.
   943     12  ER-2627                     PIC S9(4)   VALUE +2627.
   944     12  ER-2628                     PIC S9(4)   VALUE +2628.
   945     12  ER-2629                     PIC S9(4)   VALUE +2629.
   946     12  ER-2630                     PIC S9(4)   VALUE +2630.
   947     12  ER-2631                     PIC S9(4)   VALUE +2631.
   948     12  ER-2632                     PIC S9(4)   VALUE +2632.
   949     12  ER-2633                     PIC S9(4)   VALUE +2633.
   950     12  ER-2634                     PIC S9(4)   VALUE +2634.
   951     12  ER-2635                     PIC S9(4)   VALUE +2635.
   952     12  ER-2636                     PIC S9(4)   VALUE +2636.
   953     12  ER-2637                     PIC S9(4)   VALUE +2637.
   954     12  ER-2638                     PIC S9(4)   VALUE +2638.
   955     12  ER-2639                     PIC S9(4)   VALUE +2639.
   956     12  ER-2640                     PIC S9(4)   VALUE +2640.
   957     12  ER-2641                     PIC S9(4)   VALUE +2641.
   958     12  ER-2642                     PIC S9(4)   VALUE +2642.
   959     12  ER-2643                     PIC S9(4)   VALUE +2643.
   960     12  ER-2644                     PIC S9(4)   VALUE +2644.
   961     12  ER-2645                     PIC S9(4)   VALUE +2645.
   962     12  ER-2646                     PIC S9(4)   VALUE +2646.
   963     12  ER-2647                     PIC S9(4)   VALUE +2647.
   964     12  ER-2648                     PIC S9(4)   VALUE +2648.
   965     12  ER-2649                     PIC S9(4)   VALUE +2649.
   966     12  ER-2650                     PIC S9(4)   VALUE +2650.
   967     12  ER-2651                     PIC S9(4)   VALUE +2651.
   968     12  ER-2652                     PIC S9(4)   VALUE +2652.
   969     12  ER-2653                     PIC S9(4)   VALUE +2653.
   970     12  ER-2654                     PIC S9(4)   VALUE +2654.
   971     12  ER-2655                     PIC S9(4)   VALUE +2655.
   972     12  ER-2656                     PIC S9(4)   VALUE +2656.
   973     12  ER-2657                     PIC S9(4)   VALUE +2657.
   974     12  ER-2658                     PIC S9(4)   VALUE +2658.
   975     12  ER-2659                     PIC S9(4)   VALUE +2659.
   976     12  ER-2660                     PIC S9(4)   VALUE +2660.
   977     12  ER-2661                     PIC S9(4)   VALUE +2661.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  19
* EL050.cbl
   978     12  ER-2662                     PIC S9(4)   VALUE +2662.
   979     12  ER-2663                     PIC S9(4)   VALUE +2663.
   980     12  ER-2664                     PIC S9(4)   VALUE +2664.
   981     12  ER-2665                     PIC S9(4)   VALUE +2665.
   982     12  ER-2666                     PIC S9(4)   VALUE +2666.
   983     12  ER-2667                     PIC S9(4)   VALUE +2667.
   984     12  ER-2668                     PIC S9(4)   VALUE +2668.
   985     12  ER-2669                     PIC S9(4)   VALUE +2669.
   986     12  ER-2670                     PIC S9(4)   VALUE +2670.
   987     12  ER-2671                     PIC S9(4)   VALUE +2671.
   988     12  ER-2672                     PIC S9(4)   VALUE +2672.
   989     12  ER-2673                     PIC S9(4)   VALUE +2673.
   990     12  ER-2674                     PIC S9(4)   VALUE +2674.
   991     12  ER-2675                     PIC S9(4)   VALUE +2675.
   992     12  ER-2676                     PIC S9(4)   VALUE +2676.
   993     12  ER-2677                     PIC S9(4)   VALUE +2677.
   994     12  ER-2678                     PIC S9(4)   VALUE +2678.
   995     12  ER-2679                     PIC S9(4)   VALUE +2679.
   996     12  ER-2680                     PIC S9(4)   VALUE +2680.
   997     12  ER-2681                     PIC S9(4)   VALUE +2681.
   998     12  ER-2682                     PIC S9(4)   VALUE +2682.
   999     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1000     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1001     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1002     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1003     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1004     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1005     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1006     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1007     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1008     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1009     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1010     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1011     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1012     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1013     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1014     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1015     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1016     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1017     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1018     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1019     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1020     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1021     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1022     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1023     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1024     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1025     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1026     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1027     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1028     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1029     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1030     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1031     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1032     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1033     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1034     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1035     12  ER-2729                     PIC S9(4)   VALUE +2729.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  20
* EL050.cbl
  1036     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1037     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1038     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1039     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1040     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1041     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1042     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1043     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1044     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1045     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1046     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1047     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1048     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1049     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1050     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1051     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1052     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1053     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1054     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1055     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1056     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1057     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1058     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1059     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1060     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1061     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1062     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1063     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1064     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1065     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1066     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1067     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1068     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1069     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1070     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1071     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1072     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1073     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1074     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1075     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1076     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1077     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1078     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1079     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1080     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1081     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1082     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1083     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1084     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1085     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1086     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1087     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1088     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1089     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1090     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1091     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1092     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1093     12  ER-2789                     PIC S9(4)   VALUE +2789.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  21
* EL050.cbl
  1094     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1095     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1096     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1097     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1098     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1099     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1100     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1101     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1102     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1103     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1104     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1105     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1106     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1107     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1108     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1109     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1110     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1111     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1112     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1113     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1114     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1115     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1116     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1117     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1118     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1119     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1120     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1121     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1122     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1123     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1124     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1125     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1126     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1127     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1128     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1129     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1130     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1131     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1132     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1133     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1134     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1135     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1136     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1137     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1138     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1139     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1140     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1141     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1142     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1143     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1144     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1145     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1146     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1147     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1148     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1149     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1150     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1151     12  ER-8041                     PIC S9(4)   VALUE +8041.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  22
* EL050.cbl
  1152     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1153     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1154     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1155     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1156     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1157     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1158     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1159     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1160     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1161     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1162     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1163     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1164     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1165     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1166     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1167     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1168     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1169     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1170     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1171     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1172     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1173     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1174     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1175     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1176     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1177     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1178     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1179     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1180     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1181     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1182     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1183     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1184     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1185     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1186     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1187     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1188     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1189     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1190     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1191     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1192     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1193     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1194     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1195     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1196     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1197     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1198     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1199     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1200     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1201     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1202     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1203     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1204     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1205     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1206     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1207     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1208     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1209     12  ER-8315                     PIC S9(4)   VALUE +8315.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  23
* EL050.cbl
  1210     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1211     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1212     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1213     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1214     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1215     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1216     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1217******************************************************************
  1218***************   END OF ELC50WS     ****************************
  1219******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  24
* EL050.cbl
  1222 01  WORKING-STORAGE-WORK-AREAS.
  1223     12  WS-RESPONSE             PIC S9(8)  COMP.
  1224         88  WS-RESP-NORMAL           VALUE +00.
  1225         88  WS-RESP-ERROR            VALUE +01.
  1226         88  WS-RESP-NOTFND           VALUE +13.
  1227         88  WS-RESP-DUPREC           VALUE +14.
  1228         88  WS-RESP-ENDFILE          VALUE +20.
  1229     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1230     12  WORK-AREAS.
  1231         16  WK-CONV-GREG.
  1232             24  WCG-CENT             PIC XX.
  1233             24  WCG-REST             PIC X(4).
  1234         16  WORK-GREGORIAN-DATE.
  1235             24  WK-GREG-CENT         PIC XX.
  1236             24  WK-GREG-DATE-YYMMDD.
  1237                 28  WK-GREG-YYMM     PIC X(4).
  1238                 28  WK-GREG-DD       PIC XX.
  1239
  1240         16  WORK-SELECT-DATE.
  1241             24  WK-SELECT-CENT            PIC XX.
  1242             24  WK-SELECT-DATE-YYMMDD.
  1243                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1244                 28  FILLER                PIC XX.
  1245
  1246         16  WK-FORM-NO.
  1247             24  WK-FORM-BANK-ID       PIC X(5).
  1248             24  WK-FORM-UNDRWRTR      PIC X(1).
  1249             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1250
  1251         16  WK-MEMBER-NO.
  1252             24  WK-MEMBER-1-6        PIC X(6).
  1253             24  WK-MEMBER-7-12       PIC X(6).
  1254
  1255         16  WK-FULL-CERT-NO.
  1256             24  WK-CERT-POS-1-2      PIC X(2).
  1257             24  WK-CERT-POS-3        PIC X(1).
  1258             24  WK-CERT-POS-4        PIC X(1).
  1259             24  WK-CERT-POS-5-6      PIC X(2).
  1260             24  WK-CERT-POS-7        PIC X(1).
  1261             24  WK-CERT-POS-8-11     PIC X(4).
  1262
  1263         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1264             88  VALID-RATE-CODE        VALUE 'Y'.
  1265             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1266
  1267         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1268         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1269         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1270         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1271         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1272         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1273         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1274         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1275         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1276         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1277
  1278* DLO001
  1279 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  25
* EL050.cbl
  1280     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1281     12  DMPF-RETURN-CODE          PIC XX.
  1282         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1283         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1284         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1285         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1286         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1287         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1288
  1289* DLO002
  1290 01  WS-DLO-INTERNAL-POLICY-FORM.
  1291     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1292     12  DIPF-RETURN-CODE          PIC XX.
  1293         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1294         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1295         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1296         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1297         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1298         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1299
  1300* DLO003
  1301 01  WS-DLO-VALID-BANK-ID.
  1302     12  DVBI-BANK-ID              PIC X(5).
  1303     12  DVBI-BANK-ID-TYPE         PIC X.
  1304         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1305         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1306         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1307         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1308         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1309     12  DVBI-RETURN-CODE          PIC XX.
  1310         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1311         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1312         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1313         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1314         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1315         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1316         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1317         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1318         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1319
  1320* DLO007
  1321 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1322     12  DCUA-RES-STATE            PIC XX.
  1323     12  DCUA-BEN-TYPE             PIC XX.
  1324     12  DCUA-SYS-IDENT            PIC X.
  1325         88  DCUA-CLAIM                        VALUE 'C'.
  1326         88  DCUA-PREMIUM                      VALUE 'P'.
  1327     12  DCUA-COVERAGE-RULE        PIC X.
  1328     12  DCUA-CLIENT-ID            PIC X(10).
  1329     12  DCUA-EFF-DATE             PIC X(8).
  1330     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1331     12  DCUA-RETURN-CODE          PIC XX.
  1332         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1333     12  DCUA-CERT-NUMBER          PIC X(11).
  1334     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1335     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1336
  1337* DLO011
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  26
* EL050.cbl
  1338 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1339     12  DPRB-RATE-CODE            PIC X(4).
  1340     12  DPRB-COVERAGE-CATEG       PIC X.
  1341     12  DPRB-RETURN-CODE          PIC XX.
  1342         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1343         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1344         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1345         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1346         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1347         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1348         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1349         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1350         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1351     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1352     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1353     12  DPRB-BEN-TYPE             PIC XX.
  1354
  1355* DLO017
  1356 01  WS-DLO-VALID-RATE-CODE.
  1357     12  DVRC-RATE-CODE            PIC X(4).
  1358     12  DVRC-RETURN-CODE          PIC XX.
  1359         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1360         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1361         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1362         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1363         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1364         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1365
  1366* DLO019
  1367 01  WS-DLO-ORIG-COV-CAT.
  1368     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1369     12  DOCC-RETURN-CODE          PIC XX.
  1370     12  DOCC-ORIG-COV-CAT         PIC X.
  1371     12  DOCC-UNDERWITER           PIC XX.
  1372     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1373     12  DOCC-FILLER               PIC X(6).
  1374
  1375* DLO021
  1376 01  WS-DLO-VALID-LOAN-OFFICER.
  1377     12  DVLO-LOAN-OFFICER.
  1378         16  DVLO-BILL-TYPE        PIC X.
  1379         16  DVLO-BILL-SOURCE      PIC X.
  1380         16  DVLO-BATCH-TYPE       PIC X.
  1381     12  DVLO-RETURN-CODE          PIC XX.
  1382         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1383         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1384         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1385         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1386         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1387         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1388
  1389* DLO022
  1390 01  WS-DLO-VALID-STATE-CODE.
  1391     12  DVSC-STATE-CODE           PIC XX.
  1392     12  DVSC-RETURN-CODE          PIC XX.
  1393         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1394
  1395* DLO023
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  27
* EL050.cbl
  1396 01  WS-DLO-VALID-CODE-VALUES.
  1397     12  DVCV-SYSTEM-ID            PIC XX.
  1398         88  DVCV-CLAIMS                       VALUE 'CL'.
  1399         88  DVCV-CREDIT                       VALUE 'CR'.
  1400     12  DVCV-RECORD-TYPE          PIC XX.
  1401         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1402         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1403         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1404         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1405         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1406         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1407         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1408         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1409     12  DVCV-RECORD-KEY           PIC X(6).
  1410     12  DVCV-RETURN-CODE          PIC XX.
  1411         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1412         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1413         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1414         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1415         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1416         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1417         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1418     12  DVCV-CODE-DESC            PIC X(60).
  1419     12  DVCV-GEN-DESC-1           PIC X(20).
  1420     12  DVCV-GEN-DESC-2           PIC X(20).
  1421     12  DVCV-GEN-DESC-3           PIC X(20).
  1422
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  28
* EL050.cbl
  1424*    COPY ERCBXRF.
  1425******************************************************************
  1426*                                                                *
  1427*                                                                *
  1428*                            ERCBXRF                             *
  1429*                                                                *
  1430*   ONLINE CREDIT SYSTEM                                         *
  1431*                                                                *
  1432*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1433*                                                                *
  1434*   FILE TYPE = VSAM,KSDS                                        *
  1435*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1436*                                                                *
  1437*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1438*       ALTERNATE PATH = NONE                                    *
  1439*                                                                *
  1440*   LOG = NO                                                     *
  1441*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1442*                                                                *
  1443******************************************************************
  1444
  1445 01  BANK-CROSS-REFERENCE.
  1446     12  BK-RECORD-ID                PIC XX.
  1447         88  VALID-BK-ID             VALUE 'BK'.
  1448
  1449     12  BK-CONTROL-PRIMARY.
  1450         16  BK-COMPANY-CD           PIC X.
  1451         16  BK-CARRIER              PIC X.
  1452         16  BK-GROUPING             PIC X(6).
  1453         16  BK-BANK-NO              PIC X(10).
  1454
  1455     12  BK-MAINT-INFORMATION.
  1456         16  BK-LAST-MAINT-DT        PIC XX.
  1457         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1458         16  BK-LAST-MAINT-USER      PIC X(4).
  1459         16  FILLER                  PIC X(9).
  1460
  1461     12  FILLER                      PIC X(37).
  1462
  1463     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1464
  1465     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1466                            DEPENDING ON BK-BANK-POINTER-CNT.
  1467         16  BK-AM-ACCOUNT           PIC X(10).
  1468         16  BK-AM-EXP-DT            PIC XX.
  1469         16  BK-AM-EFF-DT            PIC XX.
  1470         16  BK-AM-STATE             PIC XX.
  1471         16  FILLER                  PIC X(20).
  1472
  1473******************************************************************
  1474
  1475*    COPY ERCCOMP.
  1476******************************************************************
  1477*                                                                *
  1478*                                                                *
  1479*                            ERCCOMP                             *
  1480*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1481*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  29
* EL050.cbl
  1482*                                                                *
  1483*   ONLINE CREDIT SYSTEM                                         *
  1484*                                                                *
  1485*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1486*                                                                *
  1487*   FILE TYPE = VSAM,KSDS                                        *
  1488*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1489*                                                                *
  1490*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1491*       ALTERNATE PATH = NONE                                    *
  1492*                                                                *
  1493*   LOG = NO                                                     *
  1494*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1495*                                                                *
  1496******************************************************************
  1497*                   C H A N G E   L O G
  1498*
  1499* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1500*-----------------------------------------------------------------
  1501*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1502* EFFECTIVE    NUMBER
  1503*-----------------------------------------------------------------
  1504* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1505* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1506* 092205    2005050300006  PEMA  ADD LEASE FEE
  1507* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1508* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1509* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1510* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1511* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1512* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1513******************************************************************
  1514
  1515 01  COMPENSATION-MASTER.
  1516     12  CO-RECORD-ID                          PIC XX.
  1517         88  VALID-CO-ID                          VALUE 'CO'.
  1518
  1519     12  CO-CONTROL-PRIMARY.
  1520         16  CO-COMPANY-CD                     PIC X.
  1521         16  CO-CONTROL.
  1522             20  CO-CTL-1.
  1523                 24  CO-CARR-GROUP.
  1524                     28  CO-CARRIER            PIC X.
  1525                     28  CO-GROUPING.
  1526                         32  CO-GROUP-PREFIX   PIC XXX.
  1527                         32  CO-GROUP-PRIME    PIC XXX.
  1528                 24  CO-RESP-NO.
  1529                     28  CO-RESP-PREFIX        PIC X(4).
  1530                     28  CO-RESP-PRIME         PIC X(6).
  1531             20  CO-CTL-2.
  1532                 24  CO-ACCOUNT.
  1533                     28  CO-ACCT-PREFIX        PIC X(4).
  1534                     28  CO-ACCT-PRIME         PIC X(6).
  1535         16  CO-TYPE                           PIC X.
  1536             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1537             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1538             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1539
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  30
* EL050.cbl
  1540     12  CO-MAINT-INFORMATION.
  1541         16  CO-LAST-MAINT-DT                  PIC XX.
  1542         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1543         16  CO-LAST-MAINT-USER                PIC X(4).
  1544     12  FILLER                                PIC XX.
  1545     12  CO-STMT-TYPE                          PIC XXX.
  1546     12  CO-COMP-TYPE                          PIC X.
  1547         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1548     12  CO-STMT-OWNER                         PIC X(4).
  1549     12  CO-BALANCE-CONTROL                    PIC X.
  1550         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1551         88  CO-NO-BALANCE                        VALUE 'N'.
  1552
  1553     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1554         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1555         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1556         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1557
  1558     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1559         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1560         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1561
  1562     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1563     12  CO-GA-DIRECT-DEP                      PIC X.
  1564     12  CO-FUTURE-SPACE                       PIC X.
  1565         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1566
  1567     12  CO-ACCT-NAME                          PIC X(30).
  1568     12  CO-MAIL-NAME                          PIC X(30).
  1569     12  CO-ADDR-1                             PIC X(30).
  1570     12  CO-ADDR-2                             PIC X(30).
  1571     12  CO-ADDR-3.
  1572         16  CO-ADDR-CITY                      PIC X(27).
  1573         16  CO-ADDR-STATE                     PIC XX.
  1574     12  CO-CSO-1099                           PIC X.
  1575     12  CO-ZIP.
  1576         16  CO-ZIP-PRIME.
  1577             20  CO-ZIP-PRI-1ST                PIC X.
  1578                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1579             20  FILLER                        PIC X(4).
  1580         16  CO-ZIP-PLUS4                      PIC X(4).
  1581     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1582         16  CO-CAN-POSTAL-1                   PIC XXX.
  1583         16  CO-CAN-POSTAL-2                   PIC XXX.
  1584         16  FILLER                            PIC XXX.
  1585     12  CO-SOC-SEC                            PIC X(13).
  1586     12  CO-TELEPHONE.
  1587         16  CO-AREA-CODE                      PIC XXX.
  1588         16  CO-PREFIX                         PIC XXX.
  1589         16  CO-PHONE                          PIC X(4).
  1590
  1591     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1592
  1593     12  CO-AR-BAL-LEVEL                       PIC X.
  1594         88  CO-AR-REF-LVL                        VALUE '1'.
  1595         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1596         88  CO-AR-BILL-LVL                       VALUE '2'.
  1597         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  31
* EL050.cbl
  1598         88  CO-AR-FR-LVL                         VALUE '4'.
  1599
  1600     12  CO-AR-NORMAL-PRINT                    PIC X.
  1601         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1602         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1603
  1604     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1605
  1606     12  CO-AR-REPORTING                       PIC X.
  1607         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1608         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1609
  1610     12  CO-AR-PULL-CHECK                      PIC X.
  1611         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1612         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1613
  1614     12  CO-AR-BALANCE-PRINT                   PIC X.
  1615         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1616
  1617     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1618         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1619         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1620         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1621
  1622     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1623
  1624     12  CO-USER-CODE                          PIC X.
  1625     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1626
  1627******************************************************************
  1628*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1629*    THE LAST MONTH END RUN.
  1630******************************************************************
  1631
  1632     12  CO-LAST-ACTIVITY-DATE.
  1633         16  CO-ACT-YEAR                       PIC 99.
  1634         16  CO-ACT-MONTH                      PIC 99.
  1635         16  CO-ACT-DAY                        PIC 99.
  1636
  1637     12  CO-LAST-STMT-DT.
  1638         16  CO-LAST-STMT-YEAR                 PIC 99.
  1639         16  CO-LAST-STMT-MONTH                PIC 99.
  1640         16  CO-LAST-STMT-DAY                  PIC 99.
  1641
  1642     12  CO-MO-END-TOTALS.
  1643         16  CO-MONTHLY-TOTALS.
  1644             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1645             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1646             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1647             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1648             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1649
  1650         16  CO-AGING-TOTALS.
  1651             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1652             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1653             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1654             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1655
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  32
* EL050.cbl
  1656         16  CO-YTD-TOTALS.
  1657             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1658             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1659
  1660         16  CO-OVER-UNDER-TOTALS.
  1661             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1662             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1663
  1664     12  CO-MISCELLANEOUS-TOTALS.
  1665         16  CO-FICA-TOTALS.
  1666             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1667             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1668
  1669         16  CO-CLAIM-TOTALS.
  1670             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1671             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1672
  1673******************************************************************
  1674*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1675*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1676******************************************************************
  1677
  1678     12  CO-CURRENT-TOTALS.
  1679         16  CO-CURRENT-LAST-STMT-DT.
  1680             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1681             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1682             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1683
  1684         16  CO-CURRENT-MONTHLY-TOTALS.
  1685             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1686             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1687             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1689             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1690
  1691         16  CO-CURRENT-AGING-TOTALS.
  1692             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1693             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1694             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1695             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1696
  1697         16  CO-CURRENT-YTD-TOTALS.
  1698             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1699             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1700
  1701     12  CO-PAID-COMM-TOTALS.
  1702         16  CO-YTD-PAID-COMMS.
  1703             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1704             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1705
  1706     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1707         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1708         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1709
  1710     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1711         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1712         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1713         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  33
* EL050.cbl
  1714         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1715         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1716         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1717         88  CO-FINAL-LETTER                  VALUE 'F'.
  1718         88  CO-RECONCILING                   VALUE 'R'.
  1719         88  CO-PHONE-CALL                    VALUE 'P'.
  1720         88  CO-LEGAL                         VALUE 'L'.
  1721         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1722         88  CO-WRITE-OFF                     VALUE 'W'.
  1723         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1724
  1725     12  CO-CSR-CODE                       PIC X(4).
  1726
  1727     12  CO-GA-STATUS-INFO.
  1728         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1729         16  CO-GA-TERMINATION-DT          PIC XX.
  1730         16  CO-GA-STATUS-CODE             PIC X.
  1731             88  CO-GA-ACTIVE                 VALUE 'A'.
  1732             88  CO-GA-INACTIVE               VALUE 'I'.
  1733             88  CO-GA-PENDING                VALUE 'P'.
  1734         16  CO-GA-COMMENTS.
  1735             20  CO-GA-COMMENT-1           PIC X(40).
  1736             20  CO-GA-COMMENT-2           PIC X(40).
  1737             20  CO-GA-COMMENT-3           PIC X(40).
  1738             20  CO-GA-COMMENT-4           PIC X(40).
  1739
  1740     12  CO-RPTCD2                         PIC X(10).
  1741     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1742         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1743         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1744
  1745     12  CO-TYPE-AGENT                     PIC X(01).
  1746         88  CO-CORPORATION                   VALUE 'C'.
  1747         88  CO-PARTNERSHIP                   VALUE 'P'.
  1748         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1749         88  CO-TRUST                         VALUE 'T'.
  1750         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1751
  1752     12  CO-FAXNO.
  1753         16  CO-FAX-AREA-CODE                  PIC XXX.
  1754         16  CO-FAX-PREFIX                     PIC XXX.
  1755         16  CO-FAX-PHONE                      PIC X(4).
  1756
  1757     12  CO-BANK-INFORMATION.
  1758         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1759         16  CO-BANK-TRANSIT-NON REDEFINES
  1760             CO-BANK-TRANSIT-NO                PIC 9(8).
  1761
  1762         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1763     12  CO-MISC-DEDUCT-INFO REDEFINES
  1764                  CO-BANK-INFORMATION.
  1765         16  CO-MD-GL-ACCT                     PIC X(10).
  1766         16  CO-MD-DIV                         PIC XX.
  1767         16  CO-MD-CENTER                      PIC X(4).
  1768         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1769         16  CO-CREATE-AP-CHECK                PIC X.
  1770         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1771         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  34
* EL050.cbl
  1772     12  CO-ACH-STATUS                         PIC X.
  1773         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1774         88  CO-ACH-PENDING                        VALUE 'P'.
  1775
  1776     12  CO-BILL-SW                            PIC X.
  1777     12  CO-CONTROL-NAME                       PIC X(30).
  1778     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1779     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1780     12  CO-CLP-STATE                          PIC XX.
  1781     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1782     12  CO-SPP-REFUND-EDIT                    PIC X.
  1783
  1784******************************************************************
  1785
  1786*    COPY ERCAGTC.
  1787******************************************************************
  1788*                                                                *
  1789*                                                                *
  1790*                            ERCAGTC                             *
  1791*                            VMOD=2.001                          *
  1792*                                                                *
  1793*   ONLINE CREDIT SYSTEM                                         *
  1794*                                                                *
  1795*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1796*                                                                *
  1797*   FILE TYPE = VSAM,KSDS                                        *
  1798*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1799*                                                                *
  1800*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1801*       ALTERNATE PATH = NONE                                    *
  1802*                                                                *
  1803*   LOG = NO                                                     *
  1804*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1805*                                                                *
  1806******************************************************************
  1807*                   C H A N G E   L O G
  1808*
  1809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1810*-----------------------------------------------------------------
  1811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1812* EFFECTIVE    NUMBER
  1813*-----------------------------------------------------------------
  1814* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1815* 111004                         NEW FILE AND COPYBOOK
  1816* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1817******************************************************************
  1818 01  AGENT-COMMISSIONS.
  1819     12  AG-RECORD-ID                          PIC XX.
  1820         88  VALID-CO-ID                          VALUE 'AG'.
  1821     12  AG-CONTROL-PRIMARY.
  1822         16  AG-COMPANY-CD                     PIC X.
  1823         16  AG-CONTROL.
  1824             20  AG-CTL-1.
  1825                 24  AG-CARR-GROUP.
  1826                     28  AG-CARRIER            PIC X.
  1827                     28  AG-GROUPING           PIC X(6).
  1828                 24  AG-BANK                   PIC X(10).
  1829             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  35
* EL050.cbl
  1830                 24  AG-EXP-DT                 PIC XX.
  1831         16  AG-TYPE                           PIC X.
  1832             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1833             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1834     12  AG-MAINT-INFORMATION.
  1835         16  AG-LAST-MAINT-DT                  PIC XX.
  1836         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1837         16  AG-LAST-MAINT-USER                PIC X(4).
  1838         16  FILLER                            PIC X(10).
  1839     12  AG-EFF-DT                             PIC XX.
  1840     12  AG-COMM-STRUCTURE.
  1841         16  AG-AGT-COMMS OCCURS 10.
  1842             20  AG-AGT                PIC X(10).
  1843             20  AG-COM-TYP            PIC X.
  1844             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1845             20  AG-RECALC-LV-INDIC    PIC X.
  1846             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1847             20  AG-LRCALC-LV-INDIC    PIC X.
  1848             20  FILLER                PIC X(05).
  1849     12  FILLER                  PIC X(145).
  1850******************************************************************
  1851*    COPY ERCRESS.
  1852******************************************************************
  1853*                                                                *
  1854*                            ERCRESS                             *
  1855*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1856*                            VMOD=2.002                          *
  1857*                                                                *
  1858*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1859*                                                                *
  1860*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1861*   VSAM RESIDENT STATE TAX MASTER                              *
  1862*                                                                *
  1863*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1864*                                                                *
  1865*   FILE TYPE = VSAM,KSDS                                        *
  1866*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1867*                                                                *
  1868*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1869*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1870*                                                                *
  1871*   LOG = NO                                                     *
  1872*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1873*                                                                *
  1874*                                                                *
  1875******************************************************************
  1876
  1877 01  RESIDENT-STATE-TAX-MASTER.
  1878
  1879     10  ERRESS-PRIMARY-KEY.
  1880         15  RES-COMPANY-CD        PIC X.
  1881         15  RES-RESIDENT-STATE    PIC XX.
  1882         15  RES-COVERAGE-CATEGORY PIC X.
  1883         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1884*                                      YYYYMMDD
  1885*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1886
  1887     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  36
* EL050.cbl
  1888
  1889         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1890         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1891         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1892         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1893
  1894     10 RES-RECALC-SW              PIC   X.
  1895         88 RECALC                VALUE 'Y'.
  1896         88 NO-RECALC             VALUE 'N'.
  1897     10  RES-MAINT-BY              PIC X(4).
  1898     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1899     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1900*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  37
* EL050.cbl
  1902*    COPY ERCRESC.
  1903******************************************************************
  1904*                                                                *
  1905*                            ERCRESC                             *
  1906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1907*                            VMOD=2.003                          *
  1908*                                                                *
  1909*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1910*                                                                *
  1911*   FILE TYPE = VSAM,KSDS                                        *
  1912*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1913*                                                                *
  1914*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1915*       ALTERNATE PATH1 = NONE                                   *
  1916*                                                                *
  1917*   LOG = NO                                                     *
  1918*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1919*                                                                *
  1920******************************************************************
  1921
  1922 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1923
  1924     10  ERRESC-RECORD-KEY.
  1925         15  RESC-COMPANY-CD           PIC   X.
  1926         15  RESC-CARRIER              PIC   X.
  1927         15  RESC-GROUP                PIC   X(6).
  1928         15  RESC-STATE                PIC   XX.
  1929         15  RESC-ACCOUNT              PIC   X(10).
  1930         15  RESC-AGENT                PIC   X(10).
  1931         15  RESC-RESIDENT-STATE       PIC   XX.
  1932         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1933*                                           YYYYMMDD
  1934     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1935
  1936     10  RESC-COMM-RECORD-DATA.
  1937         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1938             20 RESC-COVERAGE-CAT      PIC    X.
  1939             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1940             20 RESC-COMMISSION-TAB REDEFINES
  1941                RESC-COMMISSION-PER    PIC  XXX.
  1942
  1943     10  RESC-MAINT-BY                 PIC X(4).
  1944     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1945     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1946*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  38
* EL050.cbl
  1948*    COPY ERCPLAN.
  1949******************************************************************
  1950*                                                                *
  1951*                                                                *
  1952*                            ERCPLAN                             *
  1953*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1954*                            VMOD=2.003                          *
  1955*                                                                *
  1956*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1957*                                                                *
  1958*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1959*   PLAN MASTER                                                  *
  1960*                                                                *
  1961*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1962*                                                                *
  1963*   FILE TYPE = VSAM,KSDS                                        *
  1964*   RECORD SIZE = 420   RECFORM = FIX                            *
  1965*                                                                *
  1966*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1967*       ALTERNATE PATH1 = N/A                                    *
  1968*                                                                *
  1969*   LOG = NO                                                     *
  1970*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1971*                                                                *
  1972*                                                                *
  1973******************************************************************
  1974
  1975 01  PLAN-MASTER.
  1976     12  PL-RECORD-ID                      PIC XX.
  1977         88  VALID-PL-ID                      VALUE 'PL'.
  1978
  1979     12  PL-CONTROL-PRIMARY.
  1980         16  PL-COMPANY-CD                 PIC X.
  1981         16  PL-MSTR-CNTRL.
  1982             20  PL-CONTROL-A.
  1983                 24  PL-CARRIER            PIC X.
  1984                 24  PL-GROUPING           PIC X(6).
  1985                 24  PL-STATE              PIC XX.
  1986                 24  PL-ACCOUNT            PIC X(10).
  1987             20  PL-BENEFIT-TYPE           PIC X.
  1988             20  PL-BENEFIT-CODE           PIC XX.
  1989             20  PL-REVISION-NO            PIC X(3).
  1990
  1991     12  PL-CONTROL-BY-VAR-GRP.
  1992         16  PL-COMPANY-CD-A1              PIC X.
  1993         16  PL-VG-CARRIER                 PIC X.
  1994         16  PL-VG-GROUPING                PIC X(6).
  1995         16  PL-VG-STATE                   PIC XX.
  1996         16  PL-VG-ACCOUNT                 PIC X(10).
  1997         16  PL-BENEFIT-TYPE-A1            PIC X.
  1998         16  PL-BENEFIT-CODE-A1            PIC XX.
  1999         16  PL-REVISION-NO-A1             PIC 999.
  2000
  2001     12  PL-MAINT-INFORMATION.
  2002         16  PL-LAST-MAINT-DT              PIC XX.
  2003         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2004         16  PL-LAST-MAINT-USER            PIC X(4).
  2005         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  39
* EL050.cbl
  2006
  2007     12  PL-LIABILITY-LIMITS.
  2008         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2009         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2010             20  PL-LM-AGE                 PIC S99        COMP-3.
  2011             20  PL-LM-DUR                 PIC S999       COMP-3.
  2012             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2013             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2014
  2015     12  FILLER                            PIC X(30).
  2016
  2017     12  PL-GL-ACCOUNT-NOS.
  2018         16  PL-PREMIUM-GL                 PIC X(8).
  2019         16  PL-COMM-GL                    PIC X(8).
  2020         16  PL-CLAIM-GL                   PIC X(8).
  2021     12  FILLER                            PIC X(24).
  2022     12  PL-TOLERANCES.
  2023         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2024         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2025         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2026         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2027         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2028         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2029     12  PL-OVER-SHORT.
  2030         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2031         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2032     12  FILLER                            PIC X(24).
  2033     12  PLAN-MISC.
  2034         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2035         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2036         16  PL-IG                         PIC X.
  2037         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2038         16  PL-POLICY-FORM                PIC X(12).
  2039         16  PL-EDIT-FOR-FORM              PIC X(01).
  2040         16  PL-DEV-CODE                   PIC XXX.
  2041         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2042         16  PL-CALC-METHOD                PIC X.
  2043         16  PL-BENEFIT-GROUP              PIC X(05).
  2044         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2045
  2046         16  FILLER                        PIC X(99).
  2047******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  40
* EL050.cbl
  2049*    COPY ELCCERT.
  2050******************************************************************
  2051*                                                                *
  2052*                            ELCCERT.                            *
  2053*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2054*                            VMOD=2.013                          *
  2055*                                                                *
  2056*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2057*                                                                *
  2058*   FILE TYPE = VSAM,KSDS                                        *
  2059*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2060*                                                                *
  2061*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2062*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2063*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2064*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2065*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2066*                                                                *
  2067*   LOG = YES                                                    *
  2068*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2069******************************************************************
  2070*                   C H A N G E   L O G
  2071*
  2072* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2073*-----------------------------------------------------------------
  2074*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2075* EFFECTIVE    NUMBER
  2076*-----------------------------------------------------------------
  2077* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2078* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2079* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2080* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2081* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2082* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2083* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2084* 032612  CR2011110200001  PEMA  AHL CHANGES
  2085******************************************************************
  2086
  2087 01  CERTIFICATE-MASTER.
  2088     12  CM-RECORD-ID                      PIC XX.
  2089         88  VALID-CM-ID                      VALUE 'CM'.
  2090
  2091     12  CM-CONTROL-PRIMARY.
  2092         16  CM-COMPANY-CD                 PIC X.
  2093         16  CM-CARRIER                    PIC X.
  2094         16  CM-GROUPING.
  2095             20  CM-GROUPING-PREFIX        PIC X(3).
  2096             20  CM-GROUPING-PRIME         PIC X(3).
  2097         16  CM-STATE                      PIC XX.
  2098         16  CM-ACCOUNT.
  2099             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2100             20  CM-ACCOUNT-PRIME          PIC X(6).
  2101         16  CM-CERT-EFF-DT                PIC XX.
  2102         16  CM-CERT-NO.
  2103             20  CM-CERT-PRIME             PIC X(10).
  2104             20  CM-CERT-SFX               PIC X.
  2105
  2106     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  41
* EL050.cbl
  2107         16  CM-COMPANY-CD-A1              PIC X.
  2108         16  CM-INSURED-LAST-NAME          PIC X(15).
  2109         16  CM-INSURED-INITIALS.
  2110             20  CM-INSURED-INITIAL1       PIC X.
  2111             20  CM-INSURED-INITIAL2       PIC X.
  2112
  2113     12  CM-CONTROL-BY-SSN.
  2114         16  CM-COMPANY-CD-A2              PIC X.
  2115         16  CM-SOC-SEC-NO.
  2116             20  CM-SSN-STATE              PIC XX.
  2117             20  CM-SSN-ACCOUNT            PIC X(6).
  2118             20  CM-SSN-LN3.
  2119                 25  CM-INSURED-INITIALS-A2.
  2120                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2121                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2122                 25 CM-PART-LAST-NAME-A2         PIC X.
  2123
  2124     12  CM-CONTROL-BY-CERT-NO.
  2125         16  CM-COMPANY-CD-A4              PIC X.
  2126         16  CM-CERT-NO-A4                 PIC X(11).
  2127
  2128     12  CM-CONTROL-BY-MEMB.
  2129         16  CM-COMPANY-CD-A5              PIC X.
  2130         16  CM-MEMBER-NO.
  2131             20  CM-MEMB-STATE             PIC XX.
  2132             20  CM-MEMB-ACCOUNT           PIC X(6).
  2133             20  CM-MEMB-LN4.
  2134                 25  CM-INSURED-INITIALS-A5.
  2135                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2136                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2137                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2138
  2139     12  CM-INSURED-PROFILE-DATA.
  2140         16  CM-INSURED-FIRST-NAME.
  2141             20  CM-INSURED-1ST-INIT       PIC X.
  2142             20  FILLER                    PIC X(9).
  2143         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2144         16  CM-INSURED-SEX                PIC X.
  2145             88  CM-SEX-MALE                  VALUE 'M'.
  2146             88  CM-SEX-FEMAL                 VALUE 'F'.
  2147         16  CM-INSURED-JOINT-AGE          PIC 99.
  2148         16  CM-JOINT-INSURED-NAME.
  2149             20  CM-JT-LAST-NAME           PIC X(15).
  2150             20  CM-JT-FIRST-NAME.
  2151                 24  CM-JT-1ST-INIT        PIC X.
  2152                 24  FILLER                PIC X(9).
  2153             20  CM-JT-INITIAL             PIC X.
  2154
  2155     12  CM-LIFE-DATA.
  2156         16  CM-LF-BENEFIT-CD              PIC XX.
  2157         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2158         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2159         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2160         16  CM-LF-DEV-CODE                PIC XXX.
  2161         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2162         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2163         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2164         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  42
* EL050.cbl
  2165         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2166         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2167         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2168         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2169         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2170         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2171         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2172         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2173         16  FILLER                        PIC XX.
  2174
  2175     12  CM-AH-DATA.
  2176         16  CM-AH-BENEFIT-CD              PIC XX.
  2177         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2178         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2179         16  CM-AH-DEV-CODE                PIC XXX.
  2180         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2181         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2182         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2183         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2184         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2185         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2186         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2187         16  CM-AH-PAID-THRU-DT            PIC XX.
  2188             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2189         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2190         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2191         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2192         16  FILLER                        PIC X.
  2193
  2194     12  CM-LOAN-INFORMATION.
  2195         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2196         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2197                                           PIC S9(5)V99  COMP-3.
  2198         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2199         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2200         16  CM-PAY-FREQUENCY              PIC S99.
  2201         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2202         16  CM-RATE-CLASS                 PIC XX.
  2203         16  CM-BENEFICIARY                PIC X(25).
  2204         16  CM-POLICY-FORM-NO             PIC X(12).
  2205         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2206         16  CM-LAST-ADD-ON-DT             PIC XX.
  2207         16  CM-DEDUCTIBLE-AMOUNTS.
  2208             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2209             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2210         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2211             20  CM-RESIDENT-STATE         PIC XX.
  2212             20  CM-RATE-CODE              PIC X(4).
  2213             20  FILLER                    PIC XX.
  2214         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2215             20  CM-LOAN-OFFICER           PIC X(5).
  2216             20  FILLER                    PIC XXX.
  2217         16  CM-CSR-CODE                   PIC XXX.
  2218         16  CM-UNDERWRITING-CODE          PIC X.
  2219             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2220         16  CM-POST-CARD-IND              PIC X.
  2221         16  CM-NH-INTERFACE-SW            PIC X.
  2222         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  43
* EL050.cbl
  2223             88  CM-SING-PRM                  VALUE '1'.
  2224             88  CM-O-B-COVERAGE              VALUE '2'.
  2225             88  CM-OPEN-END                  VALUE '3'.
  2226         16  CM-IND-GRP-TYPE               PIC X.
  2227             88  CM-INDIVIDUAL                VALUE 'I'.
  2228             88  CM-GROUP                     VALUE 'G'.
  2229         16  CM-SKIP-CODE                  PIC X.
  2230             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2231             88  SKIP-JULY                    VALUE '1'.
  2232             88  SKIP-AUGUST                  VALUE '2'.
  2233             88  SKIP-SEPTEMBER               VALUE '3'.
  2234             88  SKIP-JULY-AUG                VALUE '4'.
  2235             88  SKIP-AUG-SEPT                VALUE '5'.
  2236             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2237             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2238             88  SKIP-JUNE                    VALUE '8'.
  2239             88  SKIP-JUNE-JULY               VALUE '9'.
  2240             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2241             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2242         16  CM-PAYMENT-MODE               PIC X.
  2243             88  PAY-MONTHLY                  VALUE SPACE.
  2244             88  PAY-WEEKLY                   VALUE '1'.
  2245             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2246             88  PAY-BI-WEEKLY                VALUE '3'.
  2247             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2248         16  CM-LOAN-NUMBER                PIC X(8).
  2249         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2250         16  CM-OLD-LOF                    PIC XXX.
  2251*        16  CM-LOAN-OFFICER               PIC XXX.
  2252         16  CM-REIN-TABLE                 PIC XXX.
  2253         16  CM-SPECIAL-REIN-CODE          PIC X.
  2254         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2255         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2256         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2257
  2258     12  CM-STATUS-DATA.
  2259         16  CM-ENTRY-STATUS               PIC X.
  2260         16  CM-ENTRY-DT                   PIC XX.
  2261
  2262         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2263         16  CM-LF-CANCEL-DT               PIC XX.
  2264         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2265
  2266         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2267         16  CM-LF-DEATH-DT                PIC XX.
  2268         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2269
  2270         16  CM-LF-CURRENT-STATUS          PIC X.
  2271             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2272                                                'M' '4' '5' '9'.
  2273             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2274             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2275             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2276             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2277             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2278             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2279             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2280             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  44
* EL050.cbl
  2281             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2282             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2283             88  CM-LF-DECLINED               VALUE 'D'.
  2284             88  CM-LF-VOIDED                 VALUE 'V'.
  2285
  2286         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2287         16  CM-AH-CANCEL-DT               PIC XX.
  2288         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2289
  2290         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2291         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2292         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2293
  2294         16  CM-AH-CURRENT-STATUS          PIC X.
  2295             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2296                                                'M' '4' '5' '9'.
  2297             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2298             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2299             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2300             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2301             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2302             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2303             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2304             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2305             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2306             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2307             88  CM-AH-DECLINED               VALUE 'D'.
  2308             88  CM-AH-VOIDED                 VALUE 'V'.
  2309
  2310         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2311             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2312             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2313             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2314         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2315
  2316         16  CM-ENTRY-BATCH                PIC X(6).
  2317         16  CM-LF-EXIT-BATCH              PIC X(6).
  2318         16  CM-AH-EXIT-BATCH              PIC X(6).
  2319         16  CM-LAST-MONTH-END             PIC XX.
  2320
  2321     12  CM-NOTE-SW                        PIC X.
  2322         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2323         88  CERT-NOTES-PRESENT               VALUE '1'.
  2324         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2325         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2326         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2327         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2328         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2329         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2330     12  CM-COMP-EXCP-SW                   PIC X.
  2331         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2332         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2333     12  CM-INSURED-ADDRESS-SW             PIC X.
  2334         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2335         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2336
  2337*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2338     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  45
* EL050.cbl
  2339     12  FILLER                            PIC X.
  2340
  2341*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2342     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2343     12  FILLER                            PIC X.
  2344*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2345     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2346
  2347     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2348         88  CERT-ADDED-BATCH                 VALUE ' '.
  2349         88  CERT-ADDED-ONLINE                VALUE '1'.
  2350         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2351         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2352         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2353     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2354         88  CERT-AS-LOADED                   VALUE ' '.
  2355         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2356         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2357         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2358         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2359         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2360         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2361         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2362
  2363     12  CM-ACCOUNT-COMM-PCTS.
  2364         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2365         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2366
  2367     12  CM-USER-FIELD                     PIC X.
  2368     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2369     12  CM-CLP-STATE                      PIC XX.
  2370     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2371     12  CM-USER-RESERVED                  PIC XXX.
  2372     12  FILLER REDEFINES CM-USER-RESERVED.
  2373         16  CM-AH-CLASS-CD                PIC XX.
  2374         16  F                             PIC X.
  2375******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  46
* EL050.cbl
  2377*    COPY ERCMAIL.
  2378******************************************************************
  2379*                                                                *
  2380*                                                                *
  2381*                            ERCMAIL                             *
  2382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2383*                            VMOD=2.003                          *
  2384*                                                                *
  2385*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2386*                                                                *
  2387*   FILE TYPE = VSAM,KSDS                                        *
  2388*   RECORD SIZE = 374   RECFORM = FIX                            *
  2389*                                                                *
  2390*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2391*   ALTERNATE PATH    = NOT USED                                 *
  2392*                                                                *
  2393*   LOG = YES                                                    *
  2394*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2395******************************************************************
  2396*                   C H A N G E   L O G
  2397*
  2398* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2399*-----------------------------------------------------------------
  2400*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2401* EFFECTIVE    NUMBER
  2402*-----------------------------------------------------------------
  2403* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2404* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2405* 111108                   PEMA  ADD CRED BENE ADDR2
  2406******************************************************************
  2407
  2408 01  MAILING-DATA.
  2409     12  MA-RECORD-ID                      PIC XX.
  2410         88  VALID-MA-ID                       VALUE 'MA'.
  2411
  2412     12  MA-CONTROL-PRIMARY.
  2413         16  MA-COMPANY-CD                 PIC X.
  2414         16  MA-CARRIER                    PIC X.
  2415         16  MA-GROUPING.
  2416             20  MA-GROUPING-PREFIX        PIC XXX.
  2417             20  MA-GROUPING-PRIME         PIC XXX.
  2418         16  MA-STATE                      PIC XX.
  2419         16  MA-ACCOUNT.
  2420             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2421             20  MA-ACCOUNT-PRIME          PIC X(6).
  2422         16  MA-CERT-EFF-DT                PIC XX.
  2423         16  MA-CERT-NO.
  2424             20  MA-CERT-PRIME             PIC X(10).
  2425             20  MA-CERT-SFX               PIC X.
  2426
  2427     12  FILLER                            PIC XX.
  2428
  2429     12  MA-ACCESS-CONTROL.
  2430         16  MA-SOURCE-SYSTEM              PIC XX.
  2431             88  MA-FROM-CREDIT                VALUE 'CR'.
  2432             88  MA-FROM-VSI                   VALUE 'VS'.
  2433             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2434             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  47
* EL050.cbl
  2435         16  MA-RECORD-ADD-DT              PIC XX.
  2436         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2437         16  MA-LAST-MAINT-DT              PIC XX.
  2438         16  MA-LAST-MAINT-BY              PIC XXXX.
  2439         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2440
  2441     12  MA-PROFILE-INFO.
  2442         16  MA-QUALIFY-CODE-1             PIC XX.
  2443         16  MA-QUALIFY-CODE-2             PIC XX.
  2444         16  MA-QUALIFY-CODE-3             PIC XX.
  2445         16  MA-QUALIFY-CODE-4             PIC XX.
  2446         16  MA-QUALIFY-CODE-5             PIC XX.
  2447
  2448         16  MA-INSURED-LAST-NAME          PIC X(15).
  2449         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2450         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2451         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2452         16  MA-INSURED-BIRTH-DT           PIC XX.
  2453         16  MA-INSURED-SEX                PIC X.
  2454             88  MA-SEX-MALE                   VALUE 'M'.
  2455             88  MA-SEX-FEMALE                 VALUE 'F'.
  2456         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2457
  2458         16  MA-ADDRESS-CORRECTED          PIC X.
  2459         16  MA-JOINT-BIRTH-DT             PIC XX.
  2460*        16  FILLER                        PIC X(12).
  2461
  2462         16  MA-ADDRESS-LINE-1             PIC X(30).
  2463         16  MA-ADDRESS-LINE-2             PIC X(30).
  2464         16  MA-CITY-STATE.
  2465             20  MA-CITY                   PIC X(28).
  2466             20  MA-ADDR-STATE             PIC XX.
  2467         16  MA-ZIP.
  2468             20  MA-ZIP-CODE.
  2469                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2470                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2471                 24  FILLER                PIC X(4).
  2472             20  MA-ZIP-PLUS4              PIC X(4).
  2473         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2474             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2475             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2476             20  FILLER                    PIC X(3).
  2477
  2478         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2479
  2480         16  FILLER                        PIC XXX.
  2481*        16  FILLER                        PIC X(10).
  2482
  2483     12  MA-CRED-BENE-INFO.
  2484         16  MA-CRED-BENE-NAME                 PIC X(25).
  2485         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2486         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2487         16  MA-CRED-BENE-CTYST.
  2488             20  MA-CRED-BENE-CITY             PIC X(28).
  2489             20  MA-CRED-BENE-STATE            PIC XX.
  2490         16  MA-CRED-BENE-ZIP.
  2491             20  MA-CB-ZIP-CODE.
  2492                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  48
* EL050.cbl
  2493                     88  MA-CB-CANADIAN-POST-CODE
  2494                                           VALUE 'A' THRU 'Z'.
  2495                 24  FILLER                    PIC X(4).
  2496             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2497         16  MA-CB-CANADIAN-POSTAL-CODE
  2498                            REDEFINES MA-CRED-BENE-ZIP.
  2499             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2500             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2501             20  FILLER                        PIC X(3).
  2502     12  MA-POST-CARD-MAIL-DATA.
  2503         16  MA-MAIL-DATA OCCURS 7.
  2504             20  MA-MAIL-TYPE              PIC X.
  2505                 88  MA-12MO-MAILING           VALUE '1'.
  2506                 88  MA-EXP-MAILING            VALUE '2'.
  2507             20  MA-MAIL-STATUS            PIC X.
  2508                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2509                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2510                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2511             20  MA-MAIL-DATE              PIC XX.
  2512     12  FILLER                            PIC XX.
  2513     12  FILLER                            PIC XX.
  2514*    12  FILLER                            PIC X(30).
  2515******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  49
* EL050.cbl
  2517*    COPY ERCPNDM.
  2518******************************************************************
  2519*                                                                *
  2520*                                                                *
  2521*                            ERCPNDM                             *
  2522*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2523*                            VMOD=2.003                          *
  2524*                                                                *
  2525*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2526*                                                                *
  2527*   FILE TYPE = VSAM,KSDS                                        *
  2528*   RECORD SIZE = 374   RECFORM = FIX                            *
  2529*                                                                *
  2530*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2531*   ALTERNATE PATH    = NOT USED                                 *
  2532*                                                                *
  2533*   LOG = YES                                                    *
  2534*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2535******************************************************************
  2536*                   C H A N G E   L O G
  2537*
  2538* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2539*-----------------------------------------------------------------
  2540*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2541* EFFECTIVE    NUMBER
  2542*-----------------------------------------------------------------
  2543* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2544* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2545* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2546******************************************************************
  2547
  2548 01  PENDING-MAILING-DATA.
  2549     12  PM-RECORD-ID                      PIC XX.
  2550         88  VALID-MA-ID                       VALUE 'PM'.
  2551
  2552     12  PM-CONTROL-PRIMARY.
  2553         16  PM-COMPANY-CD                 PIC X.
  2554         16  PM-ENTRY-BATCH                PIC X(6).
  2555         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2556         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2557
  2558     12  FILLER                            PIC X(14).
  2559
  2560     12  PM-ACCESS-CONTROL.
  2561         16  PM-SOURCE-SYSTEM              PIC XX.
  2562             88  PM-FROM-CREDIT                VALUE 'CR'.
  2563             88  PM-FROM-VSI                   VALUE 'VS'.
  2564             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2565             88  PM-FROM-OTHER                 VALUE 'OT'.
  2566         16  PM-RECORD-ADD-DT              PIC XX.
  2567         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2568         16  PM-LAST-MAINT-DT              PIC XX.
  2569         16  PM-LAST-MAINT-BY              PIC XXXX.
  2570         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2571
  2572     12  PM-PROFILE-INFO.
  2573         16  PM-QUALIFY-CODE-1             PIC XX.
  2574         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  50
* EL050.cbl
  2575         16  PM-QUALIFY-CODE-3             PIC XX.
  2576         16  PM-QUALIFY-CODE-4             PIC XX.
  2577         16  PM-QUALIFY-CODE-5             PIC XX.
  2578
  2579         16  PM-INSURED-LAST-NAME          PIC X(15).
  2580         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2581         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2582         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2583         16  PM-INSURED-BIRTH-DT           PIC XX.
  2584         16  PM-INSURED-SEX                PIC X.
  2585             88  PM-SEX-MALE                   VALUE 'M'.
  2586             88  PM-SEX-FEMALE                 VALUE 'F'.
  2587         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2588
  2589         16  PM-ADDRESS-CORRECTED          PIC X.
  2590         16  PM-JOINT-BIRTH-DT             PIC XX.
  2591*        16  FILLER                        PIC X(12).
  2592
  2593         16  PM-ADDRESS-LINE-1             PIC X(30).
  2594         16  PM-ADDRESS-LINE-2             PIC X(30).
  2595         16  PM-CITY-STATE.
  2596             20  PM-CITY                   PIC X(28).
  2597             20  PM-STATE                  PIC XX.
  2598         16  PM-ZIP.
  2599             20  PM-ZIP-CODE.
  2600                 24  PM-ZIP-1              PIC X.
  2601                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2602                 24  FILLER                PIC X(4).
  2603             20  PM-ZIP-PLUS4              PIC X(4).
  2604         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2605             20  PM-CAN-POST1              PIC XXX.
  2606             20  PM-CAN-POST2              PIC XXX.
  2607             20  FILLER                    PIC XXX.
  2608
  2609         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2610
  2611         16  FILLER                        PIC X(03).
  2612
  2613     12  PM-CRED-BENE-INFO.
  2614         16  PM-CRED-BENE-NAME             PIC X(25).
  2615         16  PM-CRED-BENE-ADDR             PIC X(30).
  2616         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2617         16  PM-CRED-BENE-CTYST.
  2618             20  PM-CRED-BENE-CITY         PIC X(28).
  2619             20  PM-CRED-BENE-STATE        PIC XX.
  2620         16  PM-CRED-BENE-ZIP.
  2621             20  PM-CB-ZIP-CODE.
  2622                 24  PM-CB-ZIP-1           PIC X.
  2623                     88  PM-CB-CANADIAN-POST-CODE
  2624                                  VALUE 'A' THRU 'Z'.
  2625                 24  FILLER                PIC X(4).
  2626             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2627         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2628             20  PM-CB-CAN-POST1           PIC XXX.
  2629             20  PM-CB-CAN-POST2           PIC XXX.
  2630             20  FILLER                    PIC XXX.
  2631     12  PM-POST-CARD-MAIL-DATA.
  2632         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  51
* EL050.cbl
  2633             20  PM-MAIL-TYPE              PIC X.
  2634                 88  PM-12MO-MAILING           VALUE '1'.
  2635                 88  PM-EXP-MAILING            VALUE '2'.
  2636             20  PM-MAIL-STATUS            PIC X.
  2637                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2638                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2639                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2640             20  PM-MAIL-DATE              PIC XX.
  2641     12  FILLER                            PIC XX.
  2642     12  FILLER                            PIC X(12).
  2643*    12  FILLER                            PIC X(30).
  2644
  2645******************************************************************
  2646*                                COPY ERCLOFC.
  2647******************************************************************
  2648*                                                                *
  2649*                                                                *
  2650*                            ERCLOFC                             *
  2651*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2652*                            VMOD=2.003                          *
  2653*                                                                *
  2654*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2655*                                                                *
  2656*   FILE TYPE = VSAM,KSDS                                        *
  2657*   RECORD SIZE = 670   RECFORM = FIX                            *
  2658*                                                                *
  2659*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2660*                                                                *
  2661*   LOG = YES                                                    *
  2662*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2663*                                                                *
  2664******************************************************************
  2665
  2666 01  LOAN-OFFICER-MASTER.
  2667     12  LO-RECORD-ID                PIC XX.
  2668         88  VALID-LO-ID                VALUE 'LO'.
  2669
  2670     12  LO-CONTROL-PRIMARY.
  2671         16  LO-COMPANY-CD           PIC X.
  2672         16  LO-CARRIER              PIC X.
  2673         16  LO-GROUPING.
  2674             20  LO-GROUPING-PREFIX  PIC XXX.
  2675             20  LO-GROUPING-PRIME   PIC XXX.
  2676         16  LO-STATE                PIC XX.
  2677         16  LO-ACCOUNT.
  2678             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2679             20  LO-ACCOUNT-PRIME    PIC X(6).
  2680         16  LO-OFFICER-CODE         PIC X(5).
  2681
  2682     12  LO-OFFICER-NAME             PIC X(30).
  2683
  2684     12  LO-LAST-MAINT-DT            PIC XX.
  2685     12  LO-LAST-USER                PIC X(4).
  2686     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2687
  2688     12  LO-COMP-CONTROL             PIC X.
  2689             88  LO-SHOW-COMP           VALUE 'Y'.
  2690             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  52
* EL050.cbl
  2691     12  LO-DETAIL-CONTROL           PIC X.
  2692             88  LO-PRINT-DETAIL        VALUE 'D'.
  2693             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2694
  2695     12  LO-SV-CARRIER               PIC X.
  2696     12  LO-SV-GROUPING              PIC X(6).
  2697     12  LO-SV-STATE                 PIC XX.
  2698
  2699     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2700     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2701
  2702     12  LO-OFFICER-INFO.
  2703         16  FILLER OCCURS 12 TIMES.
  2704             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2705             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2706             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2707             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2708             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2709             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2710             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2711             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2712     12  FILLER                      PIC X(198).
  2713******************************************************************
  2714*                                COPY ERCPDEF.
  2715******************************************************************
  2716*                                                                *
  2717*                                                                *
  2718*                            ERCPDEF.                            *
  2719*                                                                *
  2720*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2721*                                                                *
  2722*    FILE TYPE = VSAM,KSDS                                       *
  2723*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2724*                                                                *
  2725*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2726*                                                                *
  2727*    LOG = YES                                                   *
  2728*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2729******************************************************************
  2730 01  PRODUCT-MASTER.
  2731    12  PD-RECORD-ID                 PIC X(02).
  2732        88  VALID-PD-ID                  VALUE 'PD'.
  2733    12  PD-CONTROL-PRIMARY.
  2734        16  PD-COMPANY-CD            PIC X.
  2735        16  PD-STATE                 PIC XX.
  2736        16  PD-PRODUCT-CD            PIC XXX.
  2737        16  PD-FILLER                PIC X(7).
  2738        16  PD-BEN-TYPE              PIC X.
  2739        16  PD-BEN-CODE              PIC XX.
  2740        16  PD-PROD-EXP-DT           PIC XX.
  2741    12  FILLER                       PIC X(50).
  2742    12  PD-PRODUCT-DATA OCCURS 8.
  2743        16  PD-PROD-CODE             PIC X.
  2744            88  PD-PROD-LIFE           VALUE 'L'.
  2745            88  PD-PROD-PROP           VALUE 'P'.
  2746            88  PD-PROD-AH             VALUE 'A'.
  2747            88  PD-PROD-IU             VALUE 'I'.
  2748            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  53
* EL050.cbl
  2749        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2750        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2751        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2752        16  PD-MAX-TERM              PIC S999        COMP-3.
  2753        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2754        16  FILLER                   PIC X.
  2755        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2756        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2757        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2758        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2759        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2760        16  PD-REC-CRIT-PERIOD       PIC X.
  2761        16  PD-RTW-MOS               PIC 99.
  2762        16  FILLER                   PIC X(5).
  2763    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2764    12  PD-TERM-LIMITS OCCURS 15.
  2765        16  PD-LOW-TERM              PIC S999        COMP-3.
  2766        16  PD-HI-TERM               PIC S999        COMP-3.
  2767*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2768    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2769        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2770        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2771    12  PD-EARN-FACTORS.
  2772        16  FILLER OCCURS 15.
  2773            20  FILLER OCCURS 15.
  2774                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2775    12  PD-PRODUCT-DESC              PIC X(80).
  2776    12  PD-TRUNCATED                 PIC X.
  2777    12  FILLER                       PIC X(59).
  2778    12  PD-MAINT-INFORMATION.
  2779        16  PD-LAST-MAINT-DT         PIC X(02).
  2780        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2781        16  PD-LAST-MAINT-BY         PIC X(04).
  2782*                                COPY ELCSTATE.
  2783******************************************************************
  2784*                                                                *
  2785*                                                                *
  2786*                            ELCSTATE.                           *
  2787*                                                                *
  2788*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2789*                                                                *
  2790*   FILE TYPE = VSAM,KSDS                                        *
  2791*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2792*                                                                *
  2793*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2794*       ALTERNATE INDEX = NONE                                   *
  2795*                                                                *
  2796*   LOG = YES                                                    *
  2797*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2798******************************************************************
  2799*                   C H A N G E   L O G
  2800*
  2801* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2802*-----------------------------------------------------------------
  2803*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2804* EFFECTIVE    NUMBER
  2805*-----------------------------------------------------------------
  2806* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  54
* EL050.cbl
  2807******************************************************************
  2808*
  2809 01  STATE-FILE.
  2810     12  SF-RECORD-ID                       PIC XX.
  2811         88  VALID-CF-ID                        VALUE 'SF'.
  2812     12  SF-CONTROL-PRIMARY.
  2813         16  SF-COMPANY-ID                  PIC XXX.
  2814         16  SF-CARRIER-CODE                PIC X.
  2815         16  SF-GROUPING                    PIC X(6).
  2816         16  SF-STATE-CODE                  PIC XX.
  2817         16  SF-EXPIRE-DATE                 PIC 9(8).
  2818****************************************************************
  2819*             STATE CONTROLS
  2820****************************************************************
  2821     12  SF-LAST-MAINT-DT                   PIC XX.
  2822     12  SF-LAST-MAINT-BY                   PIC X(4).
  2823     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2824     12  SF-STATE-RT-CONTROLS.
  2825         16  SF-ST-RT-CALC                  PIC X.
  2826     12  SF-ST-TAX-CONTROLS.
  2827         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2828         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2829         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2830     12  SF-ST-REFUND-OPTIONS.
  2831         16  SF-ST-RF-LR-CALC               PIC X.
  2832         16  SF-ST-RF-LL-CALC               PIC X.
  2833         16  SF-ST-RF-LN-CALC               PIC X.
  2834         16  SF-ST-RF-AH-CALC               PIC X.
  2835         16  SF-ST-RF-CP-CALC               PIC X.
  2836     12  SF-ST-UNEARN-PREM-OPTIONS.
  2837         16  SF-ST-LUEP-R78                 PIC X.
  2838         16  SF-ST-LUEP-PRO                 PIC X.
  2839         16  SF-ST-LUEP-ST                  PIC X.
  2840         16  SF-ST-LUEP-DOM                 PIC X.
  2841         16  SF-ST-AUEP-R78                 PIC X.
  2842         16  SF-ST-AUEP-PRO                 PIC X.
  2843         16  SF-ST-AUEP-ST                  PIC X.
  2844         16  SF-ST-AUEP-DOM                 PIC X.
  2845         16  SF-ST-CUEP-R78                 PIC X.
  2846         16  SF-ST-CUEP-PRO                 PIC X.
  2847         16  SF-ST-CUEP-ST                  PIC X.
  2848         16  SF-ST-CUEP-DOM                 PIC X.
  2849     12  SF-ST-EARN-PREM-OPTIONS.
  2850         16  SF-ST-LEP-R78                  PIC X.
  2851         16  SF-ST-LEP-PRO                  PIC X.
  2852         16  SF-ST-LEP-ST                   PIC X.
  2853         16  SF-ST-LEP-DOM                  PIC X.
  2854         16  SF-ST-AEP-R78                  PIC X.
  2855         16  SF-ST-AEP-PRO                  PIC X.
  2856         16  SF-ST-AEP-ST                   PIC X.
  2857         16  SF-ST-AEP-DOM                  PIC X.
  2858         16  SF-ST-CEP-R78                  PIC X.
  2859         16  SF-ST-CEP-PRO                  PIC X.
  2860         16  SF-ST-CEP-ST                   PIC X.
  2861         16  SF-ST-CEP-DOM                  PIC X.
  2862     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  55
* EL050.cbl
  2864*    COPY ELCCRTT.
  2865******************************************************************
  2866*                                                                *
  2867*                            ELCCRTT.                            *
  2868*                                                                *
  2869*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2870*                                                                *
  2871*   FILE TYPE = VSAM,KSDS                                        *
  2872*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2873*                                                                *
  2874*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2875*                                                                *
  2876*   LOG = YES                                                    *
  2877*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2878******************************************************************
  2879*                   C H A N G E   L O G
  2880*
  2881* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2882*-----------------------------------------------------------------
  2883*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2884* EFFECTIVE    NUMBER
  2885*-----------------------------------------------------------------
  2886* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2887* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2888* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2889* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2890******************************************************************
  2891
  2892 01  CERTIFICATE-TRAILERS.
  2893     12  CS-RECORD-ID                      PIC XX.
  2894         88  VALID-CS-ID                      VALUE 'CS'.
  2895
  2896     12  CS-CONTROL-PRIMARY.
  2897         16  CS-COMPANY-CD                 PIC X.
  2898         16  CS-CARRIER                    PIC X.
  2899         16  CS-GROUPING                   PIC X(6).
  2900         16  CS-STATE                      PIC XX.
  2901         16  CS-ACCOUNT                    PIC X(10).
  2902         16  CS-CERT-EFF-DT                PIC XX.
  2903         16  CS-CERT-NO.
  2904             20  CS-CERT-PRIME             PIC X(10).
  2905             20  CS-CERT-SFX               PIC X.
  2906         16  CS-TRAILER-TYPE               PIC X.
  2907             88  COMM-TRLR           VALUE 'A'.
  2908             88  FUTURE-TRLR         VALUE 'B'.
  2909             88  CERT-DATA-TRLR      VALUE 'C'.
  2910
  2911     12  CS-DATA-AREA                      PIC X(516).
  2912
  2913     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2914         16  CS-BANK-COMMISSION-AREA.
  2915             20  CS-BANK-COMMS       OCCURS 10.
  2916                 24  CS-AGT                PIC X(10).
  2917                 24  CS-COM-TYP            PIC X.
  2918                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2919                 24  CS-RECALC-LV-INDIC    PIC X.
  2920                 24  FILLER                PIC X(10).
  2921         16  FILLER                        PIC X(256).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  56
* EL050.cbl
  2922
  2923     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2924         16  CS-VIN-NUMBER                 PIC X(17).
  2925         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2926         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2927         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2928         16  FILLER                        PIC X(496).
  2929******************************************************************
  2930*    COPY ELCCRTO.
  2931******************************************************************
  2932*                                                                *
  2933*                            ELCCRTO.                            *
  2934*                                                                *
  2935*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2936*                                                                *
  2937*   FILE TYPE = VSAM,KSDS                                        *
  2938*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2939*                                                                *
  2940*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2941*                                                                *
  2942*   LOG = YES                                                    *
  2943*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2944******************************************************************
  2945*                   C H A N G E   L O G
  2946*
  2947* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2948*-----------------------------------------------------------------
  2949*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2950* EFFECTIVE    NUMBER
  2951*-----------------------------------------------------------------
  2952* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2953* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2954* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2955* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2956* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2957******************************************************************
  2958 01  ORIGINAL-CERTIFICATE.
  2959     12  OC-RECORD-ID                      PIC XX.
  2960         88  VALID-OC-ID                      VALUE 'OC'.
  2961     12  OC-CONTROL-PRIMARY.
  2962         16  OC-COMPANY-CD                 PIC X.
  2963         16  OC-CARRIER                    PIC X.
  2964         16  OC-GROUPING                   PIC X(6).
  2965         16  OC-STATE                      PIC XX.
  2966         16  OC-ACCOUNT                    PIC X(10).
  2967         16  OC-CERT-EFF-DT                PIC XX.
  2968         16  OC-CERT-NO.
  2969             20  OC-CERT-PRIME             PIC X(10).
  2970             20  OC-CERT-SFX               PIC X.
  2971         16  OC-RECORD-TYPE                PIC X.
  2972         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2973     12  OC-LAST-MAINT-DT                  PIC XX.
  2974     12  OC-LAST-MAINT-BY                  PIC X(4).
  2975     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2976     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2977     12  FILLER                            PIC X(49).
  2978     12  OC-ORIG-REC.
  2979         16  OC-INS-LAST-NAME              PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  57
* EL050.cbl
  2980         16  OC-INS-FIRST-NAME             PIC X(10).
  2981         16  OC-INS-MIDDLE-INIT            PIC X.
  2982         16  OC-INS-AGE                    PIC S999     COMP-3.
  2983         16  OC-JNT-LAST-NAME              PIC X(15).
  2984         16  OC-JNT-FIRST-NAME             PIC X(10).
  2985         16  OC-JNT-MIDDLE-INIT            PIC X.
  2986         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2987         16  OC-LF-BENCD                   PIC XX.
  2988         16  OC-LF-TERM                    PIC S999      COMP-3.
  2989         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2990         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2991         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2992         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2993         16  OC-LF-EXP-DT                  PIC XX.
  2994         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2995         16  OC-LF-CANCEL-DT               PIC XX.
  2996         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2997         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2998         16  OC-AH-BENCD                   PIC XX.
  2999         16  OC-AH-TERM                    PIC S999      COMP-3.
  3000         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3001         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3002         16  OC-AH-EXP-DT                  PIC XX.
  3003         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3004         16  OC-AH-CP                      PIC 99.
  3005         16  OC-AH-CANCEL-DT               PIC XX.
  3006         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3007         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3008         16  OC-CRED-BENE-NAME             PIC X(25).
  3009         16  OC-1ST-PMT-DT                 PIC XX.
  3010         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3011         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3012         16  OC-ISSUE-TRAN-IND             PIC X.
  3013         16  OC-CANCEL-TRAN-IND            PIC X.
  3014         16  FILLER                        PIC X(211).
  3015
  3016     12  FILLER                            PIC X(50).
  3017******************************************************************
  3018
  3019*    COPY ELCDATE.
  3020******************************************************************
  3021*                                                                *
  3022*                                                                *
  3023*                            ELCDATE.                            *
  3024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3025*                            VMOD=2.003
  3026*                                                                *
  3027*                                                                *
  3028*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3029*                 LENGTH = 200                                   *
  3030******************************************************************
  3031
  3032 01  DATE-CONVERSION-DATA.
  3033     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3034     12  DC-OPTION-CODE                PIC X.
  3035         88  BIN-TO-GREG                VALUE ' '.
  3036         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3037         88  EDIT-GREG-TO-BIN           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  58
* EL050.cbl
  3038         88  YMD-GREG-TO-BIN            VALUE '3'.
  3039         88  MDY-GREG-TO-BIN            VALUE '4'.
  3040         88  JULIAN-TO-BIN              VALUE '5'.
  3041         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3042         88  FIND-CENTURY               VALUE '7'.
  3043         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3044         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3045         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3046         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3047         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3048         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3049         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3050         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3051         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3052         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3053         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3054         88  BIN-3-TO-GREG              VALUE 'I'.
  3055         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3056         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3057         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3058         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3059         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3060         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3061         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3062         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3063         88  THREE-CHARACTER-BIN
  3064                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3065         88  GREGORIAN-TO-BIN
  3066                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3067         88  BIN-TO-GREGORIAN
  3068                  VALUES ' ' '1' 'I' '8' 'G'.
  3069         88  JULIAN-TO-BINARY
  3070                  VALUES '5' 'C' 'E' 'F'.
  3071     12  DC-ERROR-CODE                 PIC X.
  3072         88  NO-CONVERSION-ERROR        VALUE ' '.
  3073         88  DATE-CONVERSION-ERROR
  3074                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3075         88  DATE-IS-ZERO               VALUE '1'.
  3076         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3077         88  DATE-IS-INVALID            VALUE '3'.
  3078         88  DATE1-GREATER-DATE2        VALUE '4'.
  3079         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3080         88  DATE-INVALID-OPTION        VALUE '9'.
  3081         88  INVALID-CENTURY            VALUE 'A'.
  3082         88  ONLY-CENTURY               VALUE 'B'.
  3083         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3084         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3085     12  DC-END-OF-MONTH               PIC X.
  3086         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3087     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3088         88  USE-NORMAL-PROCESS         VALUE ' '.
  3089         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3090         88  ADJUST-UP-100-YRS          VALUE '2'.
  3091     12  FILLER                        PIC X.
  3092     12  DC-CONVERSION-DATES.
  3093         16  DC-BIN-DATE-1             PIC XX.
  3094         16  DC-BIN-DATE-2             PIC XX.
  3095         16  DC-GREG-DATE-1-EDIT       PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  59
* EL050.cbl
  3096         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3097                       DC-GREG-DATE-1-EDIT.
  3098             20  DC-EDIT1-MONTH        PIC 99.
  3099             20  SLASH1-1              PIC X.
  3100             20  DC-EDIT1-DAY          PIC 99.
  3101             20  SLASH1-2              PIC X.
  3102             20  DC-EDIT1-YEAR         PIC 99.
  3103         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3104         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3105                     DC-GREG-DATE-2-EDIT.
  3106             20  DC-EDIT2-MONTH        PIC 99.
  3107             20  SLASH2-1              PIC X.
  3108             20  DC-EDIT2-DAY          PIC 99.
  3109             20  SLASH2-2              PIC X.
  3110             20  DC-EDIT2-YEAR         PIC 99.
  3111         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3112         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3113                     DC-GREG-DATE-1-YMD.
  3114             20  DC-YMD-YEAR           PIC 99.
  3115             20  DC-YMD-MONTH          PIC 99.
  3116             20  DC-YMD-DAY            PIC 99.
  3117         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3118         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3119                      DC-GREG-DATE-1-MDY.
  3120             20  DC-MDY-MONTH          PIC 99.
  3121             20  DC-MDY-DAY            PIC 99.
  3122             20  DC-MDY-YEAR           PIC 99.
  3123         16  DC-GREG-DATE-1-ALPHA.
  3124             20  DC-ALPHA-MONTH        PIC X(10).
  3125             20  DC-ALPHA-DAY          PIC 99.
  3126             20  FILLER                PIC XX.
  3127             20  DC-ALPHA-CENTURY.
  3128                 24 DC-ALPHA-CEN-N     PIC 99.
  3129             20  DC-ALPHA-YEAR         PIC 99.
  3130         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3131         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3132         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3133         16  DC-JULIAN-DATE            PIC 9(05).
  3134         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3135                                       PIC 9(05).
  3136         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3137             20  DC-JULIAN-YEAR        PIC 99.
  3138             20  DC-JULIAN-DAYS        PIC 999.
  3139         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3140         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3141         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3142     12  DATE-CONVERSION-VARIBLES.
  3143         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3144         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3145             20  FILLER                PIC 9(3).
  3146             20  HOLD-CEN-1-CCYY.
  3147                 24  HOLD-CEN-1-CC     PIC 99.
  3148                 24  HOLD-CEN-1-YY     PIC 99.
  3149             20  HOLD-CEN-1-MO         PIC 99.
  3150             20  HOLD-CEN-1-DA         PIC 99.
  3151         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3152             20  HOLD-CEN-1-R-MO       PIC 99.
  3153             20  HOLD-CEN-1-R-DA       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  60
* EL050.cbl
  3154             20  HOLD-CEN-1-R-CCYY.
  3155                 24  HOLD-CEN-1-R-CC   PIC 99.
  3156                 24  HOLD-CEN-1-R-YY   PIC 99.
  3157             20  FILLER                PIC 9(3).
  3158         16  HOLD-CENTURY-1-X.
  3159             20  FILLER                PIC X(3)  VALUE SPACES.
  3160             20  HOLD-CEN-1-X-CCYY.
  3161                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3162                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3163             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3164             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3165         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3166             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3167             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3168             20  HOLD-CEN-1-R-X-CCYY.
  3169                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3170                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3171             20  FILLER                PIC XXX.
  3172         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3173         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3174         16  DC-JULIAN-DATE-1          PIC 9(07).
  3175         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3176             20  DC-JULIAN-1-CCYY.
  3177                 24  DC-JULIAN-1-CC    PIC 99.
  3178                 24  DC-JULIAN-1-YR    PIC 99.
  3179             20  DC-JULIAN-DA-1        PIC 999.
  3180         16  DC-JULIAN-DATE-2          PIC 9(07).
  3181         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3182             20  DC-JULIAN-2-CCYY.
  3183                 24  DC-JULIAN-2-CC    PIC 99.
  3184                 24  DC-JULIAN-2-YR    PIC 99.
  3185             20  DC-JULIAN-DA-2        PIC 999.
  3186         16  DC-GREG-DATE-A-EDIT.
  3187             20  DC-EDITA-MONTH        PIC 99.
  3188             20  SLASHA-1              PIC X VALUE '/'.
  3189             20  DC-EDITA-DAY          PIC 99.
  3190             20  SLASHA-2              PIC X VALUE '/'.
  3191             20  DC-EDITA-CCYY.
  3192                 24  DC-EDITA-CENT     PIC 99.
  3193                 24  DC-EDITA-YEAR     PIC 99.
  3194         16  DC-GREG-DATE-B-EDIT.
  3195             20  DC-EDITB-MONTH        PIC 99.
  3196             20  SLASHB-1              PIC X VALUE '/'.
  3197             20  DC-EDITB-DAY          PIC 99.
  3198             20  SLASHB-2              PIC X VALUE '/'.
  3199             20  DC-EDITB-CCYY.
  3200                 24  DC-EDITB-CENT     PIC 99.
  3201                 24  DC-EDITB-YEAR     PIC 99.
  3202         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3203         16  DC-GREG-DATE-CYMD-R REDEFINES
  3204                              DC-GREG-DATE-CYMD.
  3205             20  DC-CYMD-CEN           PIC 99.
  3206             20  DC-CYMD-YEAR          PIC 99.
  3207             20  DC-CYMD-MONTH         PIC 99.
  3208             20  DC-CYMD-DAY           PIC 99.
  3209         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3210         16  DC-GREG-DATE-MDCY-R REDEFINES
  3211                              DC-GREG-DATE-MDCY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  61
* EL050.cbl
  3212             20  DC-MDCY-MONTH         PIC 99.
  3213             20  DC-MDCY-DAY           PIC 99.
  3214             20  DC-MDCY-CEN           PIC 99.
  3215             20  DC-MDCY-YEAR          PIC 99.
  3216    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3217        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3218    12  DC-EL310-DATE                  PIC X(21).
  3219    12  FILLER                         PIC X(28).
  3220
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  62
* EL050.cbl
  3222*    COPY ELCCALC.
  3223******************************************************************
  3224*                                                                *
  3225*                           ELCCALC.                            *
  3226*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3227*                            VMOD=2.025                          *
  3228*                                                                *
  3229*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3230*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3231*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3232*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3233*                                                                *
  3234*  PASSED TO ELRTRM                                              *
  3235*  -----------------                                             *
  3236*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3237*  ORIGINAL TERM                                                 *
  3238*  BEGINNING DATE                                                *
  3239*  ENDING DATE                                                   *
  3240*  COMPANY I.D.                                                  *
  3241*  ACCOUNT MASTER USER FIELD                                     *
  3242*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3243*  FREE LOOK DAYS                                                *
  3244*                                                                *
  3245*  RETURNED FROM ELRTRM                                          *
  3246*  ---------------------                                         *
  3247*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3248*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3249*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3250*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3251*----------------------------------------------------------------*
  3252*  PASSED TO ELRAMT                                              *
  3253*  ----------------                                              *
  3254*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3255*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3256*  ORIGINAL AMOUNT                                               *
  3257*  ALTERNATE BENEFIT (BALLON)                                    *
  3258*  A.P.R. - NET PAY ONLY                                         *
  3259*  METHOD
  3260*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3261*  COMPANY I.D.                                                  *
  3262*  BENEFIT TYPE                                                  *
  3263*                                                                *
  3264*  RETURNED FROM ELRAMT                                          *
  3265*  --------------------                                          *
  3266*  REMAINING AMOUNT 1 - CURRENT                                  *
  3267*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3268*  REMAINING AMOUNT FACTOR
  3269*----------------------------------------------------------------*
  3270*  PASSED TO ELRESV                                              *
  3271*  -----------------                                             *
  3272*  CERTIFICATE EFFECTIVE DATE                                    *
  3273*  VALUATION DATE                                                *
  3274*  PAID THRU DATE                                                *
  3275*  BENEFIT                                                       *
  3276*  INCURRED DATE                                                 *
  3277*  REPORTED DATE                                                 *
  3278*  ISSUE AGE                                                     *
  3279*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  63
* EL050.cbl
  3280*  CDT PERCENT                                                   *
  3281*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3282* *CLAIM TYPE (LIFE, A/H)                                        *
  3283* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3284* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3285*                                                                *
  3286*  RETURNED FROM ELRESV                                          *
  3287*  --------------------                                          *
  3288*  CDT TABLE USED                                                *
  3289*  CDT FACTOR USED                                               *
  3290*  PAY TO CURRENT RESERVE                                        *
  3291*  I.B.N.R. - A/H ONLY                                           *
  3292*  FUTURE (ACCRUED) AH ONLY                                      *
  3293*----------------------------------------------------------------*
  3294*  PASSED TO ELRATE                                              *
  3295*  ----------------                                              *
  3296*  CERT ISSUE DATE                                               *
  3297*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3298*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3299*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3300*  STATE CODE (CLIENT DEFINED)                                   *
  3301*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3302*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3303*  DEVIATION CODE                                                *
  3304*  ISSUE AGE                                                     *
  3305*  ORIGINAL BENEFIT AMOUNT                                       *
  3306*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3307*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3308*  BENEFIT KIND (LIFE OR A/H)                                    *
  3309*  A.P.R.                                                        *
  3310*  METHOD
  3311*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3312*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3313*  COMPANY I.D. (3 CHARACTER)                                    *
  3314*  BENEFIT CODE                                                  *
  3315*  BENEFIT OVERRIDE CODE                                         *
  3316*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3317*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3318*  JOINT INDICATOR (CSL ONLY)                                    *
  3319*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3320*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3321*                                                                *
  3322*  RETURNED FROM ELRATE                                          *
  3323*  --------------------                                          *
  3324*  CALCULATED PREMIUM                                            *
  3325*  PREMIUM RATE                                                  *
  3326*  MORTALITY CODE                                                *
  3327*  MAX ATTAINED AGE                                              *
  3328*  MAX AGE                                                       *
  3329*  MAX TERM                                                      *
  3330*  MAX MONTHLY BENEFIT                                           *
  3331*  MAX TOTAL BENIFIT                                             *
  3332*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3333*----------------------------------------------------------------*
  3334*  PASSED TO ELRFND                                              *
  3335*  ----------------                                              *
  3336*  CERT ISSUE DATE                                               *
  3337*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  64
* EL050.cbl
  3338*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3339*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3340*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3341*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3342*  STATE CODE (CLIENT DEFINED)                                   *
  3343*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3344*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3345*  DEVIATION CODE                                                *
  3346*  ISSUE AGE                                                     *
  3347*  ORIGINAL BENEFIT AMOUNT                                       *
  3348*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3349*  PROCESS TYPE (CANCEL)                                         *
  3350*  BENEFIT KIND (LIFE OR A/H)                                    *
  3351*  A.P.R.                                                        *
  3352*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3353*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3354*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3355*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3356*  COMPANY I.D. (3 CHARACTER)                                    *
  3357*  BENEFIT CODE                                                  *
  3358*  BENEFIT OVERRIDE CODE                                         *
  3359*                                                                *
  3360*  RETURNED FROM ELRFND                                          *
  3361*  --------------------                                          *
  3362*  CALCULATED REFUND                                             *
  3363*----------------------------------------------------------------*
  3364*  PASSED TO ELEARN                                              *
  3365*  ----------------                                              *
  3366*  CERT ISSUE DATE                                               *
  3367*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3368*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3369*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3370*  STATE CODE (CLIENT DEFINED)                                   *
  3371*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3372*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3373*  DEVIATION CODE                                                *
  3374*  ISSUE AGE                                                     *
  3375*  ORIGINAL BENEFIT AMOUNT                                       *
  3376*  BENEFIT KIND (LIFE OR A/H)                                    *
  3377*  A.P.R.                                                        *
  3378*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3379*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3380*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3381*  COMPANY I.D. (3 CHARACTER)                                    *
  3382*  BENEFIT CODE                                                  *
  3383*  BENEFIT OVERRIDE CODE                                         *
  3384*                                                                *
  3385*  RETURNED FROM ELEARN                                          *
  3386*  --------------------                                          *
  3387*  INDICATED  EARNINGS                                           *
  3388*----------------------------------------------------------------*
  3389*                 LENGTH = 450                                   *
  3390*                                                                *
  3391******************************************************************
  3392******************************************************************
  3393*                   C H A N G E   L O G
  3394*
  3395* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  65
* EL050.cbl
  3396*-----------------------------------------------------------------
  3397*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3398* EFFECTIVE    NUMBER
  3399*-----------------------------------------------------------------
  3400* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3401* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3402* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3403* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3404* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3405* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3406* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3407* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3408* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3409******************************************************************
  3410
  3411 01  CALCULATION-PASS-AREA.
  3412     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3413                                     COMP.
  3414
  3415     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3416       88  NO-CP-ERROR                             VALUE ZERO.
  3417       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3418                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3419       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3420       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3421       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3422       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3423       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3424       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3425       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3426       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3427       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3428       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3429       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3430       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3431       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3432       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3433       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3434       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3435       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3436
  3437     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3438       88  NO-CP-ERROR-2                           VALUE ZERO.
  3439***********************  INPUT AREAS ****************************
  3440
  3441     12  CP-CALCULATION-AREA.
  3442         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3443         16  CP-CERT-EFF-DT        PIC XX.
  3444         16  CP-VALUATION-DT       PIC XX.
  3445         16  CP-PAID-THRU-DT       PIC XX.
  3446         16  CP-BENEFIT-TYPE       PIC X.
  3447           88  CP-AH                               VALUE 'A' 'D'
  3448                                                   'I' 'U'.
  3449           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3450           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3451         16  CP-INCURRED-DT        PIC XX.
  3452         16  CP-REPORTED-DT        PIC XX.
  3453         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  66
* EL050.cbl
  3454         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3455         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3456                                     COMP-3.
  3457         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3458                                     COMP-3.
  3459         16  CP-CDT-METHOD         PIC X.
  3460           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3461           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3462           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3463         16  CP-CLAIM-TYPE         PIC X.
  3464           88  CP-AH-CLAIM                         VALUE 'A'.
  3465           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3466         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3467                                     COMP-3.
  3468         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3469                                     COMP-3.
  3470         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3471                                     COMP-3.
  3472         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3473                                     COMP-3.
  3474         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3475                                     COMP-3.
  3476         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3477                                     COMP-3.
  3478         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3479                                     COMP-3.
  3480         16  CP-REM-TERM-METHOD    PIC X.
  3481           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3482           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3483           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3484           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3485           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3486           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3487           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3488         16  CP-EARNING-METHOD     PIC X.
  3489           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3490           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3491           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3492           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3493           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3494           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3495           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3496           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3497           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3498           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3499           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3500           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3501           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3502           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3503         16  CP-PROCESS-TYPE       PIC X.
  3504           88  CP-CLAIM                            VALUE '1'.
  3505           88  CP-CANCEL                           VALUE '2'.
  3506           88  CP-ISSUE                            VALUE '3'.
  3507         16  CP-SPECIAL-CALC-CD    PIC X.
  3508           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3509           88  CP-1-MTH-INTEREST               VALUE ' '.
  3510           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3511           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  67
* EL050.cbl
  3512           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3513           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3514           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3515           88  CP-FARM-PLAN                    VALUE 'F'.
  3516           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3517           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3518           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3519           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3520           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3521           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3522           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3523           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3524           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3525           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3526                                                     'W' 'X'.
  3527           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3528           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3529           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3530           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3531           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3532           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3533           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3534           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3535           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3536           88  CP-CSL-METH-1                   VALUE '5'.
  3537           88  CP-CSL-METH-2                   VALUE '6'.
  3538           88  CP-CSL-METH-3                   VALUE '7'.
  3539           88  CP-CSL-METH-4                   VALUE '8'.
  3540
  3541         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3542                                     COMP-3.
  3543         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3544         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3545         16  CP-STATE              PIC XX          VALUE SPACE.
  3546         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3547         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3548           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3549               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3550         16  CP-R78-OPTION         PIC X.
  3551           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3552           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3553
  3554         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3555         16  CP-IBNR-RESERVE-SW    PIC X.
  3556         16  CP-CLAIM-STATUS       PIC X.
  3557         16  CP-RATE-FILE          PIC X.
  3558         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3559                                     COMP-3.
  3560
  3561         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3562         16  CP-AH-OVERRIDE-CODE   PIC X.
  3563
  3564         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3565                                     COMP-3.
  3566         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3567                                   PIC S9(5)V99 COMP-3.
  3568         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3569                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  68
* EL050.cbl
  3570         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3571                                     COMP-3.
  3572         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3573                                     COMP-3.
  3574         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3575                                  PIC S9(7)V99 COMP-3.
  3576
  3577         16  CP-PAID-FROM-DATE     PIC X(02).
  3578         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3579         16  CP-EXT-DAYS-CALC      PIC X.
  3580           88  CP-EXT-NO-CHG                   VALUE ' '.
  3581           88  CP-EXT-CHG-LF                   VALUE '1'.
  3582           88  CP-EXT-CHG-AH                   VALUE '2'.
  3583           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3584         16  CP-DOMICILE-STATE     PIC XX.
  3585         16  CP-CARRIER            PIC X.
  3586         16  CP-REIN-FLAG          PIC X.
  3587         16  CP-REM-TRM-CALC-OPTION PIC X.
  3588           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3589                      '2' '3' '4' '5'.
  3590           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3591           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3592           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3593           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3594           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3595           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3596           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3597           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3598         16  CP-SIG-SWITCH         PIC X.
  3599         16  CP-RATING-METHOD      PIC X.
  3600           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3601           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3602           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3603           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3604           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3605           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3606           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3607           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3608           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3609         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3610                                     COMP-3.
  3611         16  CP-BEN-CATEGORY       PIC X.
  3612         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3613         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3614                                   PIC S99V9(5) COMP-3.
  3615         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3616         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3617                                   PIC S99V9(5) COMP-3.
  3618         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3619         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3620         16  CP-EXPIRE-DT          PIC XX.
  3621         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3622         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3623         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3624         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3625         16  CP-DDF-SPEC-CALC      PIC X.
  3626             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3627             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  69
* EL050.cbl
  3628         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3629         16  CP-CANCEL-REASON      PIC X.
  3630         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3631         16  CP-PMT-MODE           PIC X.
  3632         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3633         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3634         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3635         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3636         16  FILLER                PIC X.
  3637
  3638***************    OUTPUT FROM ELRESV   ************************
  3639
  3640         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3641
  3642         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3643                                     COMP-3.
  3644         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3645                                     COMP-3.
  3646         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3647                                     COMP-3.
  3648         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3649                                     COMP-3.
  3650         16  FILLER                PIC X(09).
  3651***************    OUTPUT FROM ELRTRM   *************************
  3652
  3653         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3654                                     COMP-3.
  3655         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3656                                     COMP-3.
  3657         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3658                                     COMP-3.
  3659         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3660                                     COMP-3.
  3661         16  FILLER                PIC X(12).
  3662
  3663***************    OUTPUT FROM ELRAMT   *************************
  3664
  3665         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3668                                     COMP-3.
  3669         16  FILLER                PIC X(12).
  3670
  3671***************    OUTPUT FROM ELRATE   *************************
  3672
  3673         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3674                                     COMP-3.
  3675         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-MORTALITY-CODE     PIC X(4).
  3678         16  CP-RATE-EDIT-FLAG     PIC X.
  3679             88  CP-RATES-NEED-APR                  VALUE '1'.
  3680         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3681                                     COMP-3.
  3682         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3683         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3684         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3685                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  70
* EL050.cbl
  3686         16  FILLER                PIC X(07).
  3687
  3688***************    OUTPUT FROM ELRFND   *************************
  3689
  3690         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3691                                     COMP-3.
  3692         16  CP-REFUND-TYPE-USED   PIC X.
  3693           88  CP-R-AS-R78                         VALUE '1'.
  3694           88  CP-R-AS-PRORATA                     VALUE '2'.
  3695           88  CP-R-AS-CALIF                       VALUE '3'.
  3696           88  CP-R-AS-TEXAS                       VALUE '4'.
  3697           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3698           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3699           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3700           88  CP-R-AS-MEAN                        VALUE '8'.
  3701           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3702           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3703           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3704           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3705           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3706           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3707         16  FILLER                PIC X(12).
  3708
  3709***************    OUTPUT FROM ELEARN   *************************
  3710
  3711         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3712                                     COMP-3.
  3713         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3714                                     COMP-3.
  3715         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3716                                     COMP-3.
  3717         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3718                                     COMP-3.
  3719         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3720                                     COMP-3.
  3721         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3722                                     COMP-3.
  3723         16  CP-EARNING-TYPE-USED  PIC X.
  3724           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3725           88  CP-E-AS-R78                         VALUE '1'.
  3726           88  CP-E-AS-PRORATA                     VALUE '2'.
  3727           88  CP-E-AS-TEXAS                       VALUE '4'.
  3728           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3729           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3730           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3731           88  CP-E-AS-MEAN                        VALUE '8'.
  3732           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3733         16  FILLER                PIC X(12).
  3734
  3735***************    OUTPUT FROM ELPMNT   *************************
  3736
  3737         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3738                                     COMP-3.
  3739         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3740                                     COMP-3.
  3741         16  FILLER                PIC X(12).
  3742
  3743***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  71
* EL050.cbl
  3744         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3745                                     COMP-3.
  3746         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3749                                     COMP-3.
  3750         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3753                                     COMP-3.
  3754         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3755                                     COMP-3.
  3756         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3757             88  OPEN-RATE-FILE                   VALUE 'O'.
  3758             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3759             88  IO-ERROR                         VALUE 'E'.
  3760
  3761         16  CP-FIRST-PAY-DATE     PIC XX.
  3762
  3763         16  CP-JOINT-INDICATOR    PIC X.
  3764
  3765         16  CP-RESERVE-REMAINING-TERM
  3766                                   PIC S9(4)V9    VALUE ZERO
  3767                                     COMP-3.
  3768
  3769         16  CP-INSURED-BIRTH-DT   PIC XX.
  3770
  3771         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3772                                     COMP-3.
  3773
  3774         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3775                                     COMP-3.
  3776
  3777         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3778                                     COMP-3.
  3779
  3780         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3781                                     COMP-3.
  3782
  3783         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3784                                     COMP-3.
  3785
  3786         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3787                                     COMP-3.
  3788
  3789         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3790                                     COMP-3.
  3791
  3792         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3793             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3794
  3795         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3796                                     COMP-3.
  3797         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3798                                     COMP-3.
  3799         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3800         16  FILLER                PIC X(15).
  3801******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  72
* EL050.cbl
  3803******************************************************************
  3804*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3805*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3806*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3807*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3808*** MODIFICATION.                                              ***
  3809*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3810*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3811******************************************************************
  3812*    COPY ERCPNDB.
  3813******************************************************************
  3814*                                                                *
  3815*                                                                *
  3816*                            ERCPNDB.                            *
  3817*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3818*                            VMOD=2.025                          *
  3819*                                                                *
  3820*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3821*                                                                *
  3822******************************************************************
  3823*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3824*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3825******************************************************************
  3826*                                                                *
  3827*                                                                *
  3828*   FILE TYPE = VSAM,KSDS                                        *
  3829*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3830*                                                                *
  3831*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3832*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3833*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3834*                                                 RKP=13,LEN=36  *
  3835*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3836*                                      AND CHG-SEQ.)             *
  3837*                                                RKP=49,LEN=11   *
  3838*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3839*                                      AND CHG-SEQ.)             *
  3840*                                                RKP=60,LEN=15   *
  3841*                                                                *
  3842*   LOG = NO                                                     *
  3843*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3844******************************************************************
  3845******************************************************************
  3846*                   C H A N G E   L O G
  3847*
  3848* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3849*-----------------------------------------------------------------
  3850*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3851* EFFECTIVE    NUMBER
  3852*-----------------------------------------------------------------
  3853* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3854* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3855* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3856* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3857* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3858* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3859* 032306                   PEMA  ADD BOW LOAN NUMBER
  3860* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  73
* EL050.cbl
  3861* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3862* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3863* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3864* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3865* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3866* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3867* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3868******************************************************************
  3869
  3870 01  PENDING-BUSINESS.
  3871     12  PB-RECORD-ID                     PIC XX.
  3872         88  VALID-PB-ID                        VALUE 'PB'.
  3873
  3874     12  PB-CONTROL-PRIMARY.
  3875         16  PB-COMPANY-CD                PIC X.
  3876         16  PB-ENTRY-BATCH               PIC X(6).
  3877         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3878         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3879
  3880     12  PB-CONTROL-BY-ACCOUNT.
  3881         16  PB-COMPANY-CD-A1             PIC X.
  3882         16  PB-CARRIER                   PIC X.
  3883         16  PB-GROUPING.
  3884             20  PB-GROUPING-PREFIX       PIC XXX.
  3885             20  PB-GROUPING-PRIME        PIC XXX.
  3886         16  PB-STATE                     PIC XX.
  3887         16  PB-ACCOUNT.
  3888             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3889             20  PB-ACCOUNT-PRIME         PIC X(6).
  3890         16  PB-CERT-EFF-DT               PIC XX.
  3891         16  PB-CERT-NO.
  3892             20  PB-CERT-PRIME            PIC X(10).
  3893             20  PB-CERT-SFX              PIC X.
  3894         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3895
  3896         16  PB-RECORD-TYPE               PIC X.
  3897             88  PB-MAILING-DATA                VALUE '0'.
  3898             88  PB-ISSUE                       VALUE '1'.
  3899             88  PB-CANCELLATION                VALUE '2'.
  3900             88  PB-BATCH-TRAILER               VALUE '9'.
  3901
  3902     12  PB-CONTROL-BY-ORIG-BATCH.
  3903         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3904         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3905         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3906         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3907
  3908     12  PB-CONTROL-BY-CSR.
  3909         16  PB-CSR-COMPANY-CD            PIC X.
  3910         16  PB-CSR-ID                    PIC X(4).
  3911         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3912         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3913         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3914******************************************************************
  3915*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3916******************************************************************
  3917
  3918     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  74
* EL050.cbl
  3919     12  PB-LAST-MAINT-BY                 PIC X(4).
  3920     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3921
  3922     12  PB-RECORD-BODY                   PIC X(375).
  3923
  3924     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3925         16  PB-CERT-ORIGIN               PIC X.
  3926             88  CLASIC-CREATED-CERT         VALUE '1'.
  3927         16  PB-I-NAME.
  3928             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3929             20  PB-I-INSURED-FIRST-NAME.
  3930                 24  PB-I-INSURED-1ST-INIT PIC X.
  3931                 24  FILLER                PIC X(9).
  3932             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3933         16  PB-I-AGE                     PIC S99   COMP-3.
  3934         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3935         16  PB-I-BIRTHDAY                PIC XX.
  3936         16  PB-I-INSURED-SEX             PIC X.
  3937             88  PB-SEX-MALE     VALUE 'M'.
  3938             88  PB-SEX-FEMALE   VALUE 'F'.
  3939
  3940         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3941         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3942         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3943         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3944         16  PB-I-SKIP-CODE               PIC X.
  3945             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3946             88  PB-SKIP-JULY              VALUE '1'.
  3947             88  PB-SKIP-AUGUST            VALUE '2'.
  3948             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3949             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3950             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3951             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3952             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3953             88  PB-SKIP-JUNE              VALUE '8'.
  3954             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3955             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3956             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3957         16  PB-I-TERM-TYPE               PIC X.
  3958             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3959             88  PB-PAID-WEEKLY            VALUE 'W'.
  3960             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3961             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3962             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3963         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3964         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3965         16  PB-I-DATA-ENTRY-SW           PIC X.
  3966             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3967             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3968             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3969             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3970         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3971         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3972*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3973         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3974         16  FILLER                       PIC X.
  3975
  3976         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  75
* EL050.cbl
  3977             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3978             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3979                                                   '90' THRU '99'.
  3980         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3981                                          PIC XX.
  3982         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3983         16  PB-I-AMOUNT-FINANCED REDEFINES
  3984                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3985         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3986         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3987                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3988         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3989         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3990         16  PB-I-CLP-AMOUNT REDEFINES
  3991                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3992         16  PB-I-LF-CALC-FLAG            PIC X.
  3993             88 PB-COMP-LF-PREM               VALUE '?'.
  3994         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3995         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3996         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3997         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3998         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3999         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4000         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4001         16  PB-I-LF-ABBR                 PIC XXX.
  4002         16  PB-I-LF-INPUT-CD             PIC XX.
  4003
  4004         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4005             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4006             88  PB-INVALID-AH               VALUE '  ' '00'
  4007                                                   '90' THRU '99'.
  4008         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4009         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4010         16  PB-I-AH-CALC-FLAG            PIC X.
  4011             88 PB-COMP-AH-PREM                  VALUE '?'.
  4012         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4013         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4014         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4015         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4016         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4017         16  PB-I-AH-ABBR                 PIC XXX.
  4018         16  PB-I-AH-INPUT-CD             PIC XXX.
  4019
  4020         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4021         16  PB-I-REIN-TABLE              PIC XXX.
  4022         16  PB-I-BUSINESS-TYPE           PIC 99.
  4023         16  PB-I-INDV-GRP-CD             PIC X.
  4024         16  PB-I-MORT-CODE.
  4025             20  PB-I-TABLE               PIC X.
  4026             20  PB-I-INTEREST            PIC XX.
  4027             20  PB-I-MORT-TYP            PIC X.
  4028         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4029         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4030         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4031         16  PB-I-INDV-GRP-OVRD           PIC X.
  4032         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4033         16  PB-I-SIG-SW                  PIC X.
  4034             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  76
* EL050.cbl
  4035         16  PB-I-RATE-CLASS              PIC XX.
  4036         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4037         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4038         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4039         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4040         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4041         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4042         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4043         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4044         16  PB-I-OB-FLAG                 PIC X.
  4045             88  PB-I-OB                      VALUE 'B'.
  4046             88  PB-I-SUMMARY                 VALUE 'Z'.
  4047         16  PB-I-ENTRY-STATUS            PIC X.
  4048             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4049                                              'M' '5' '9' '2'.
  4050             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4051             88  PB-I-POLICY-PENDING          VALUE '2'.
  4052             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4053             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4054             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4055             88  PB-I-REIN-ONLY               VALUE '9'.
  4056             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4057             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4058             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4059             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4060         16  PB-I-INT-CODE                PIC X.
  4061             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4062             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4063         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4064         16  PB-I-SOC-SEC-NO              PIC X(11).
  4065         16  PB-I-MEMBER-NO               PIC X(12).
  4066         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4067*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4068         16  PB-I-OLD-LOF                 PIC XXX.
  4069         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4070         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4071         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4072         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4073         16  PB-I-LIFE-INDICATOR          PIC X.
  4074             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4075         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4076         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4077                                          PIC S9(5)V99    COMP-3.
  4078         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4079             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4080             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4081         16  PB-I-1ST-PMT-DT              PIC XX.
  4082         16  PB-I-JOINT-INSURED.
  4083             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4084             20 PB-I-JOINT-FIRST-NAME.
  4085                24  PB-I-JOINT-FIRST-INIT PIC X.
  4086                24  FILLER                PIC X(9).
  4087             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4088*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4089         16  PB-I-BENEFICIARY-NAME.
  4090             20  PB-I-BANK-NUMBER         PIC X(10).
  4091             20  FILLER                   PIC X(15).
  4092         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  77
* EL050.cbl
  4093         16  PB-I-REFERENCE               PIC X(12).
  4094         16  FILLER REDEFINES PB-I-REFERENCE.
  4095             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4096             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4097             20  PB-I-CLP-STATE           PIC XX.
  4098         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4099             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4100             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4101             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4102         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4103         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4104         16  PB-I-RESIDENT-STATE          PIC XX.
  4105         16  PB-I-RATE-CODE               PIC X(4).
  4106         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4107         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4108         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4109         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4110         16  PB-I-BANK-NOCHRGB            PIC 99.
  4111         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4112         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4113
  4114     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4115         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4116             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4117         16  PB-C-CANCEL-ORIGIN           PIC X.
  4118             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4119         16  PB-C-LF-CANCEL-DT            PIC XX.
  4120         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4121         16  PB-C-LF-CALC-REQ             PIC X.
  4122             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4123         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4124         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4125         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4126             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4127         16  PB-C-AH-CANCEL-DT            PIC XX.
  4128         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4129         16  PB-C-AH-CALC-REQ             PIC X.
  4130             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4131         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4132         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4133         16  PB-C-LAST-NAME               PIC X(15).
  4134         16  PB-C-REFUND-SW               PIC X.
  4135             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4136             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4137         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4138         16  PB-C-PAYEE-CODE              PIC X(6).
  4139         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4140         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4141         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4142         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4143         16  PB-C-REFERENCE               PIC X(12).
  4144         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4145         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4146         16  PB-C-POST-CARD-IND           PIC X.
  4147         16  PB-C-CANCEL-REASON           PIC X.
  4148         16  PB-C-REF-INTERFACE-SW        PIC X.
  4149         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4150         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  78
* EL050.cbl
  4151         16  FILLER                       PIC X(01).
  4152*        16  FILLER                       PIC X(18).
  4153         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4154*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4155         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4156         16  PB-CANCELED-CERT-DATA.
  4157             20  PB-CI-INSURED-NAME.
  4158                 24  PB-CI-LAST-NAME      PIC X(15).
  4159                 24  PB-CI-INITIALS       PIC XX.
  4160             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4161             20  PB-CI-INSURED-SEX        PIC X.
  4162             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4163             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4164             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4165             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4166             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4167             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4168             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4169             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4170             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4171             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4172             20  PB-CI-RATE-CLASS         PIC XX.
  4173             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4174             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4175             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4176             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4177             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4178             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4179             20  PB-CI-LF-ABBR            PIC X(3).
  4180             20  PB-CI-AH-ABBR            PIC X(3).
  4181             20  PB-CI-OB-FLAG            PIC X.
  4182                 88  PB-CI-OB                VALUE 'B'.
  4183             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4184                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4185                                           'M' '4' '5' '9' '2'.
  4186                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4187                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4188                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4189                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4190                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4191                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4192                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4193                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4194                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4195                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4196                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4197                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4198             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4199                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4200                                           'M' '4' '5' '9' '2'.
  4201                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4202                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4203                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4204                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4205                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4206                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4207                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4208                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  79
* EL050.cbl
  4209                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4210                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4211                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4212                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4213             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4214             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4215             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4216             20  PB-CI-MEMBER-NO          PIC X(12).
  4217             20  PB-CI-INT-CODE           PIC X.
  4218                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4219                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4220             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4221             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4222             20  PB-CI-COMP-EXCP-SW       PIC X.
  4223                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4224                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4225             20  PB-CI-ENTRY-STATUS       PIC X.
  4226             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4227             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4228             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4229             20  PB-CI-DEATH-DT           PIC XX.
  4230             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4231             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4232             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4233             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4234             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4235             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4236             20  PB-CI-ENTRY-DT              PIC XX.
  4237             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4238             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4239             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4240             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4241             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4242             20  PB-CI-OLD-LOF               PIC XXX.
  4243*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4244             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4245             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4246             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4247             20  PB-CI-INDV-GRP-CD           PIC X.
  4248             20  PB-CI-BENEFICIARY-NAME.
  4249                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4250                 24  FILLER                  PIC X(15).
  4251             20  PB-CI-NOTE-SW               PIC X.
  4252             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4253             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4254             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4255             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4256             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4257             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4258             20  PB-CI-FIRST-NAME            PIC X(10).
  4259             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4260
  4261         16  FILLER                       PIC X(13).
  4262*032306  16  FILLER                       PIC X(27).
  4263*        16  FILLER                       PIC X(46).
  4264
  4265     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4266         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  80
* EL050.cbl
  4267         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4268         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4269         16  PB-M-INSURED-MID-INIT        PIC X.
  4270         16  PB-M-INSURED-AGE             PIC 99.
  4271         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4272         16  PB-M-INSURED-SEX             PIC X.
  4273         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4274         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4275         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4276         16  PB-M-INSURED-CITY-STATE.
  4277             20  PB-M-INSURED-CITY        PIC X(28).
  4278             20  PB-M-INSURED-STATE       PIC XX.
  4279         16  PB-M-INSURED-ZIP-CODE.
  4280             20  PB-M-INSURED-ZIP-PRIME.
  4281                 24  PB-M-INSURED-ZIP-1   PIC X.
  4282                     88  PB-M-CANADIAN-POST-CODE
  4283                                             VALUE 'A' THRU 'Z'.
  4284                 24  FILLER               PIC X(4).
  4285             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4286         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4287                                        PB-M-INSURED-ZIP-CODE.
  4288             20  PM-M-INS-CAN-POST1       PIC XXX.
  4289             20  PM-M-INS-CAN-POST2       PIC XXX.
  4290             20  FILLER                   PIC XXX.
  4291         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4292         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4293         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4294         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4295         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4296         16  PB-M-CRED-BENE-CITYST.
  4297             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4298             20  PB-M-CRED-BENE-STATE     PIC XX.
  4299         16  FILLER                       PIC X(92).
  4300
  4301     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4302         16  FILLER                       PIC X(10).
  4303         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4304         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4305         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4306         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4307         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4308         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4309         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4310         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4311         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4312         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4313         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4314         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4315         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4316         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4317         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4318         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4319         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4320         16  PB-ACCOUNT-NAME              PIC X(30).
  4321         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4322         16  PB-REFERENCE                 PIC X(12).
  4323         16  PB-B-RECEIVED-DT             PIC XX.
  4324         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  81
* EL050.cbl
  4325
  4326     12  PB-RECORD-STATUS.
  4327         16  PB-CREDIT-SELECT-DT          PIC XX.
  4328         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4329         16  PB-BILLED-DT                 PIC XX.
  4330         16  PB-BILLING-STATUS            PIC X.
  4331             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4332             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4333             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4334         16  PB-RECORD-BILL               PIC X.
  4335             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4336             88  PB-RECORD-RETURNED           VALUE 'R'.
  4337             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4338             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4339             88  PB-OVERRIDE-AH               VALUE 'A'.
  4340             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4341         16  PB-BATCH-ENTRY               PIC X.
  4342             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4343             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4344             88  PB-REISSUED-CERT             VALUE 'E'.
  4345             88  PB-MONTHLY-CERT              VALUE 'M'.
  4346             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4347             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4348             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4349         16  PB-FORCE-CODE                PIC X.
  4350             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4351             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4352             88  PB-CANCEL-FORCE              VALUE '8'.
  4353             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4354             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4355             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4356             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4357             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4358             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4359             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4360         16  PB-FATAL-FLAG                PIC X.
  4361             88  PB-FATAL-ERRORS              VALUE 'X'.
  4362         16  PB-FORCE-ER-CD               PIC X.
  4363             88  PB-FORCE-ERRORS              VALUE 'F'.
  4364             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4365         16  PB-WARN-ER-CD                PIC X.
  4366             88  PB-WARNING-ERRORS            VALUE 'W'.
  4367         16  FILLER                       PIC X.
  4368         16  PB-OUT-BAL-CD                PIC X.
  4369             88  PB-OUT-OF-BAL                VALUE 'O'.
  4370         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4371         16  PB-AH-OVERRIDE-L1            PIC X.
  4372         16  PB-INPUT-DT                  PIC XX.
  4373         16  PB-INPUT-BY                  PIC X(4).
  4374         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4375         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4376         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4377         16  PB-LF-EARNING-METHOD         PIC X.
  4378         16  PB-AH-EARNING-METHOD         PIC X.
  4379         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4380         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4381         16  PB-REIN-CD                   PIC XXX.
  4382         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  82
* EL050.cbl
  4383         16  PB-AH-REFUND-TYPE            PIC X.
  4384         16  PB-ACCT-EFF-DT               PIC XX.
  4385         16  PB-ACCT-EXP-DT               PIC XX.
  4386         16  PB-COMPANY-ID                PIC X(3).
  4387         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4388         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4389         16  PB-SV-CARRIER                PIC X.
  4390         16  PB-SV-GROUPING               PIC X(6).
  4391         16  PB-SV-STATE                  PIC XX.
  4392         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4393         16  PB-GA-BILLING-INFO.
  4394             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4395                                          PIC XX.
  4396         16  PB-SV-REMIT-TO  REDEFINES
  4397             PB-GA-BILLING-INFO           PIC X(10).
  4398         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4399         16  PB-I-LOAN-OFFICER            PIC X(5).
  4400         16  PB-I-VIN                     PIC X(17).
  4401
  4402         16  FILLER                       PIC X(04).
  4403         16  IMNET-BYPASS-SW              PIC X.
  4404
  4405******************************************************************
  4406*                COMMON EDIT ERRORS                              *
  4407******************************************************************
  4408
  4409     12  PB-COMMON-ERRORS.
  4410         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4411                                           PIC S9(4)     COMP.
  4412
  4413******************************************************************
  4414
  4415* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4416*    COPY ELC50W1.
  4417******************************************************************
  4418*                                                                *
  4419*                                                                *
  4420*                             ELC50W1                            *
  4421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4422*                            VMOD=2.004                          *
  4423*                                                                *
  4424*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4425*                                                                *
  4426*                                                                *
  4427******************************************************************
  4428
  4429     12  WK-WORK-AREA.
  4430         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4431         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4432         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4433         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4434         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4435         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4436         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4437         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4438         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4439         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4440         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  83
* EL050.cbl
  4441         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4442         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4443         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4444         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4445         16  WK-CREDIT-EDIT-CONTROLS.
  4446             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4447             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4448             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4449             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4450             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4451             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4452         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4453         16  WK-SAVE-REIN-DATA.
  4454             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4455             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4456             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4457         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4458             88  ENTRY-FROM-EL6311       VALUE '6'.
  4459         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4460         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4461     12  WK-RECORD-ADDRESSES.
  4462         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4463         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4464         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4465         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4466         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4467         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4468         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4469         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4470     12  WK-OVER-SHORT-AREA.
  4471         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4472         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4473         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4474             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4475         16  FILLER                   PIC X(5) VALUE SPACES.
  4476
  4477*    COPY ELCEDITC.
  4478******************************************************************
  4479*                                                                *
  4480*                                                                *
  4481*                            ELCEDITC                            *
  4482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4483*                            VMOD=2.012                          *
  4484*                                                                *
  4485*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4486*                     EL6313, EL050 AND EL517.                   *
  4487*                                                                *
  4488******************************************************************
  4489******************************************************************
  4490*                   C H A N G E   L O G
  4491*
  4492* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4493*-----------------------------------------------------------------
  4494*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4495* EFFECTIVE    NUMBER
  4496*-----------------------------------------------------------------
  4497* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4498******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  84
* EL050.cbl
  4499
  4500     12  EDIT-CRITERIA-DATA.
  4501         16  EC-CO-MONTH-END-DT       PIC XX.
  4502         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4503         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4504         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4505         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4506         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4507         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4508         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4509         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4510         16  EC-CO-REM-TERM-CALC      PIC X.
  4511               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4512               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4513               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4514               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4515
  4516         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4517               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4518               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4519               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4520               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4521               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4522               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4523               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4524               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4525               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4526               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4527
  4528         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4529               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4530               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4531               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4532               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4533               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4534               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4535               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4536               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4537
  4538         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4539                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4540                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4541
  4542         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4543                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4544                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4545                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4546                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4547                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4548                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4549                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4550                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4551
  4552         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4553               88  EC-BR-REDUCING                   VALUE 'R'.
  4554               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4555
  4556         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  85
* EL050.cbl
  4557         16  EC-BR-LF-DESC             PIC X(10).
  4558         16  EC-BR-AH-DESC             PIC X(10).
  4559         16  EC-BR-LF-COMMENT          PIC X(10).
  4560         16  EC-BR-AH-COMMENT          PIC X(10).
  4561
  4562         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4563               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4564               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4565               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4566               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4567
  4568         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4569               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4570               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4571               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4572               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4573
  4574         16  EC-BR-LF-REFUND-CALC      PIC X.
  4575                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4576                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4577                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4578                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4579                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4580                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4581                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4582
  4583         16  EC-BR-AH-REFUND-CALC      PIC X.
  4584                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4585                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4586                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4587                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4588                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4589                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4590                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4591                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4592
  4593         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4594                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4595                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4596                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4597
  4598         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4599                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4600                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4601                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4602
  4603         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4604         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4605         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4606         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4607
  4608         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4609         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4610                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4611                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4612                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4613                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4614
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  86
* EL050.cbl
  4615         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4616               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4617               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4618               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4619               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4620               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4621
  4622         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4623               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4624               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4625               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4626               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4627               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4628
  4629         16  EC-ST-LF-REFUND-CALC      PIC X.
  4630                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4631                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4632                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4633                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4634                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4635                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4636                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4637                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4638
  4639         16  EC-ST-AH-REFUND-CALC      PIC X.
  4640                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4641                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4642                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4643                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4644                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4645                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4646                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4647                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4648
  4649         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4650         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4651         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4652         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4653         16  EC-AM-EXPIRATION-DT       PIC XX.
  4654         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4655         16  EC-AM-CLASS-CD            PIC XX.
  4656         16  EC-AM-LF-DEVIATION        PIC XXX.
  4657         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4658         16  EC-AM-AH-DEVIATION        PIC XXX.
  4659         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4660         16  EC-AM-PHONE-NO            PIC X(10).
  4661
  4662         16  EC-AM-LF-REFUND-CALC      PIC X.
  4663                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4664                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4665                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4666                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4667                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4668                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4669                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4670
  4671         16  EC-AM-AH-REFUND-CALC      PIC X.
  4672                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  87
* EL050.cbl
  4673                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4674                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4675                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4676                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4677                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4678                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4679
  4680         16  EC-AM-BEN-I-G-CD          PIC X.
  4681                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4682                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4683                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4684
  4685         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4686         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4687         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4688         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4689         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4690         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4691         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4692         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4693         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4694
  4695         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4696         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4697         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4698         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4699         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4700         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4701         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4702         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4703         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4704         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4705         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4706         16  EC-RT-LF-NSP-ST           PIC XX.
  4707         16  EC-RT-AH-NSP-ST           PIC XX.
  4708         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4709         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4710
  4711         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4712             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4713                                             'M' '5' '9' '2'.
  4714             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4715             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4716             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4717             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4718             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4719             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4720             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4721             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4722             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4723             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4724
  4725         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4726             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4727                                             'M' '5' '9' '2'.
  4728             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4729             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4730             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  88
* EL050.cbl
  4731             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4732             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4733             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4734             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4735             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4736             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4737             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4738
  4739         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4740         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4741         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4742         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4743         16  EC-CM-DEATH-DT            PIC XX.
  4744
  4745*DMD CUSTOM CODING FIELDS BELOW
  4746*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4747         16  EC-BR-DMD-RATING-SW       PIC X.
  4748                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4749                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4750                 88  NO-DMD-RATING               VALUE 'N'.
  4751
  4752         16  EC-NEW-CERT               PIC X(11).
  4753         16  EC-NEW-STATE              PIC XX.
  4754         16  FILLER                    PIC X.
  4755*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4756         16  OVER-SHORT-EDIT-FIELDS.
  4757             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4758             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4759             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4760             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4761             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4762             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4763             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4764             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4765             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4766         16  FILLER                    PIC X(71).
  4767******************************************************************
  4768
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  89
* EL050.cbl
  4770*    COPY ELCDIFRD.
  4771******************************************************************
  4772*                                                                *
  4773*                                                                *
  4774*                            ELCDIFRD.                           *
  4775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4776*                            VMOD=2.004                          *
  4777*                                                                *
  4778*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4779*                                                                *
  4780******************************************************************
  4781*
  4782  01  WS-DIFFERENCE-CALCULATION.
  4783        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4784        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4785        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4786        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4787        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4788        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4789        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4790        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4791        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4792        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4793        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4794
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  90
* EL050.cbl
  4796****************************************************************
  4797*
  4798* Copyright (c) 2007 by Clerity Solutions, Inc.
  4799* All rights reserved.
  4800*
  4801****************************************************************
  4802 01  DFHEIV.
  4803   02  DFHEIV0               PIC X(35).
  4804   02  DFHEIV1               PIC X(08).
  4805   02  DFHEIV2               PIC X(08).
  4806   02  DFHEIV3               PIC X(08).
  4807   02  DFHEIV4               PIC X(06).
  4808   02  DFHEIV5               PIC X(04).
  4809   02  DFHEIV6               PIC X(04).
  4810   02  DFHEIV7               PIC X(02).
  4811   02  DFHEIV8               PIC X(02).
  4812   02  DFHEIV9               PIC X(01).
  4813   02  DFHEIV10              PIC S9(7) COMP-3.
  4814   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4815   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4816   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4817   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4818   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4819   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4820   02  DFHEIV17              PIC X(04).
  4821   02  DFHEIV18              PIC X(04).
  4822   02  DFHEIV19              PIC X(04).
  4823   02  DFHEIV20              USAGE IS POINTER.
  4824   02  DFHEIV21              USAGE IS POINTER.
  4825   02  DFHEIV22              USAGE IS POINTER.
  4826   02  DFHEIV23              USAGE IS POINTER.
  4827   02  DFHEIV24              USAGE IS POINTER.
  4828   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4829   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4830   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4831   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4832   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4833   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4834   02  FILLER                PIC X(02).
  4835   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4836   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4837   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4838   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4839   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4840 LINKAGE  SECTION.
  4841*****************************************************************
  4842*                                                               *
  4843* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4844* All rights reserved.                                          *
  4845*                                                               *
  4846*****************************************************************
  4847 01  dfheiblk.
  4848     02  eibtime          pic s9(7) comp-3.
  4849     02  eibdate          pic s9(7) comp-3.
  4850     02  eibtrnid         pic x(4).
  4851     02  eibtaskn         pic s9(7) comp-3.
  4852     02  eibtrmid         pic x(4).
  4853     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  91
* EL050.cbl
  4854     02  eibcposn         pic s9(4) comp.
  4855     02  eibcalen         pic s9(4) comp.
  4856     02  eibaid           pic x(1).
  4857     02  eibfiller1       pic x(1).
  4858     02  eibfn            pic x(2).
  4859     02  eibfiller2       pic x(2).
  4860     02  eibrcode         pic x(6).
  4861     02  eibfiller3       pic x(2).
  4862     02  eibds            pic x(8).
  4863     02  eibreqid         pic x(8).
  4864     02  eibrsrce         pic x(8).
  4865     02  eibsync          pic x(1).
  4866     02  eibfree          pic x(1).
  4867     02  eibrecv          pic x(1).
  4868     02  eibsend          pic x(1).
  4869     02  eibatt           pic x(1).
  4870     02  eibeoc           pic x(1).
  4871     02  eibfmh           pic x(1).
  4872     02  eibcompl         pic x(1).
  4873     02  eibsig           pic x(1).
  4874     02  eibconf          pic x(1).
  4875     02  eiberr           pic x(1).
  4876     02  eibrldbk         pic x(1).
  4877     02  eiberrcd         pic x(4).
  4878     02  eibsynrb         pic x(1).
  4879     02  eibnodat         pic x(1).
  4880     02  eibfiller5       pic x(2).
  4881     02  eibresp          pic 9(09) comp.
  4882     02  eibresp2         pic 9(09) comp.
  4883     02  dfheigdj         pic s9(4) comp.
  4884     02  dfheigdk         pic s9(4) comp.
  4885
  4886 01  DFHCOMMAREA                   PIC X(1036).
  4887
  4888*01 PARMLIST .
  4889*    02  FILLER                    PIC S9(8)   COMP.
  4890*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4891*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4892*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4893*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4894*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4895*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4896*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4897
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  92
* EL050.cbl
  4899*    COPY ELCCNTL.
  4900******************************************************************
  4901*                                                                *
  4902*                                                                *
  4903*                            ELCCNTL.                            *
  4904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4905*                            VMOD=2.059                          *
  4906*                                                                *
  4907*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4908*                                                                *
  4909*   FILE TYPE = VSAM,KSDS                                        *
  4910*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4911*                                                                *
  4912*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4913*       ALTERNATE INDEX = NONE                                   *
  4914*                                                                *
  4915*   LOG = YES                                                    *
  4916*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4917******************************************************************
  4918*                   C H A N G E   L O G
  4919*
  4920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4921*-----------------------------------------------------------------
  4922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4923* EFFECTIVE    NUMBER
  4924*-----------------------------------------------------------------
  4925* 082503                   PEMA  ADD BENEFIT GROUP
  4926* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4927* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4928* 092705    2005050300006  PEMA  ADD SPP LEASES
  4929* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4930* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4931* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4932* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4933* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4934* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4935* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4936******************************************************************
  4937*
  4938 01  CONTROL-FILE.
  4939     12  CF-RECORD-ID                       PIC XX.
  4940         88  VALID-CF-ID                        VALUE 'CF'.
  4941
  4942     12  CF-CONTROL-PRIMARY.
  4943         16  CF-COMPANY-ID                  PIC XXX.
  4944         16  CF-RECORD-TYPE                 PIC X.
  4945             88  CF-COMPANY-MASTER              VALUE '1'.
  4946             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4947             88  CF-STATE-MASTER                VALUE '3'.
  4948             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4949             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4950             88  CF-CARRIER-MASTER              VALUE '6'.
  4951             88  CF-MORTALITY-MASTER            VALUE '7'.
  4952             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4953             88  CF-TERMINAL-MASTER             VALUE '9'.
  4954             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4955             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4956             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  93
* EL050.cbl
  4957             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4958             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4959             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4960             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4961             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4962             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4963         16  CF-ACCESS-CD-GENL              PIC X(4).
  4964         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4965             20  CF-PROCESSOR               PIC X(4).
  4966         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4967             20  CF-STATE-CODE              PIC XX.
  4968             20  FILLER                     PIC XX.
  4969         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4970             20  FILLER                     PIC XX.
  4971             20  CF-HI-BEN-IN-REC           PIC XX.
  4972         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4973             20  FILLER                     PIC XXX.
  4974             20  CF-CARRIER-CNTL            PIC X.
  4975         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4976             20  FILLER                     PIC XX.
  4977             20  CF-HI-TYPE-IN-REC          PIC 99.
  4978         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4979             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4980                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4981             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4982             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4983         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4984             20  FILLER                     PIC X.
  4985             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4986         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4987             20  FILLER                     PIC XX.
  4988             20  CF-MORTGAGE-PLAN           PIC XX.
  4989         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4990
  4991     12  CF-LAST-MAINT-DT                   PIC XX.
  4992     12  CF-LAST-MAINT-BY                   PIC X(4).
  4993     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4994
  4995     12  CF-RECORD-BODY                     PIC X(728).
  4996
  4997
  4998****************************************************************
  4999*             COMPANY MASTER RECORD                            *
  5000****************************************************************
  5001
  5002     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5003         16  CF-COMPANY-ADDRESS.
  5004             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5005             20  CF-CL-IN-CARE-OF           PIC X(30).
  5006             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5007             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5008             20  CF-CL-CITY-STATE           PIC X(30).
  5009             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5010             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5011         16  CF-COMPANY-CD                  PIC X.
  5012         16  CF-COMPANY-PASSWORD            PIC X(8).
  5013         16  CF-SECURITY-OPTION             PIC X.
  5014             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  94
* EL050.cbl
  5015             88  COMPANY-VERIFY                 VALUE '2'.
  5016             88  PROCESSOR-VERIFY               VALUE '3'.
  5017             88  NO-SECURITY                    VALUE '4'.
  5018             88  ALL-BUT-TERM                   VALUE '5'.
  5019         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5020             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5021         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5022             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5023         16  CF-INFORCE-LOCATION            PIC X.
  5024             88  CERTS-ARE-ONLINE               VALUE '1'.
  5025             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5026             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5027         16  CF-LOWER-CASE-LETTERS          PIC X.
  5028         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5029             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5030             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5031             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5032             88  CF-ACCNT-CNTL                  VALUE '3'.
  5033             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5034
  5035         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5036         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5037
  5038         16  CF-LGX-CREDIT-USER             PIC X.
  5039             88  CO-IS-NOT-USER                 VALUE 'N'.
  5040             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5041
  5042         16 CF-CREDIT-CALC-CODES.
  5043             20  CF-CR-REM-TERM-CALC PIC X.
  5044               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5045               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5046               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5047               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5048               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5049               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5050               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5051             20  CF-CR-R78-METHOD           PIC X.
  5052               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5053               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5054
  5055         16  CF-CLAIM-CONTROL-COUNTS.
  5056             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5057                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5058
  5059             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5060                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5061
  5062             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5063                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5064
  5065             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5066                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5067
  5068         16  CF-CURRENT-MONTH-END           PIC XX.
  5069
  5070         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5071             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5072             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  95
* EL050.cbl
  5073             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5074             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5075                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5076                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5077             20  CF-CO-PREM-REJECT-SW       PIC X.
  5078                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5079                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5080             20  CF-CO-REF-REJECT-SW        PIC X.
  5081                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5082                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5083
  5084         16  CF-CO-REPORTING-DT             PIC XX.
  5085         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5086         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5087           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5088           88  CF-CO-MONTH-END                  VALUE '1'.
  5089
  5090         16  CF-LGX-CLAIM-USER              PIC X.
  5091             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5092             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5093
  5094         16  CF-CREDIT-EDIT-CONTROLS.
  5095             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5096             20  CF-MIN-AGE                 PIC 99.
  5097             20  CF-DEFAULT-AGE             PIC 99.
  5098             20  CF-MIN-TERM                PIC S999      COMP-3.
  5099             20  CF-MAX-TERM                PIC S999      COMP-3.
  5100             20  CF-DEFAULT-SEX             PIC X.
  5101             20  CF-JOINT-AGE-INPUT         PIC X.
  5102                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5103             20  CF-BIRTH-DATE-INPUT        PIC X.
  5104                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5105             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5106                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5107                 88  CF-ZERO-CARRIER            VALUE '1'.
  5108                 88  CF-ZERO-GROUPING           VALUE '2'.
  5109                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5110             20  CF-EDIT-SW                 PIC X.
  5111                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5112             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5113             20  CF-CR-PR-METHOD            PIC X.
  5114               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5115               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5116             20  FILLER                     PIC X.
  5117
  5118         16  CF-CREDIT-MISC-CONTROLS.
  5119             20  CF-REIN-TABLE-SW           PIC X.
  5120                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5121             20  CF-COMP-TABLE-SW           PIC X.
  5122                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5123             20  CF-EXPERIENCE-RETENTION-AGE
  5124                                            PIC S9        COMP-3.
  5125             20  CF-CONVERSION-DT           PIC XX.
  5126             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5127             20  CF-RUN-FREQUENCY-SW        PIC X.
  5128                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5129                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5130
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  96
* EL050.cbl
  5131             20  CF-CR-CHECK-NO-CONTROL.
  5132                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5133                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5134                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5135                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5136                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5137                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5138
  5139                 24  CF-CR-CHECK-COUNT       REDEFINES
  5140                     CF-CR-CHECK-COUNTER      PIC X(4).
  5141
  5142                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5143                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5144
  5145                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5146                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5147                 24  CF-MAIL-PROCESSING       PIC X.
  5148                     88  MAIL-PROCESSING          VALUE 'Y'.
  5149
  5150         16  CF-MISC-SYSTEM-CONTROL.
  5151             20  CF-SYSTEM-C                 PIC X.
  5152                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5153             20  CF-SYSTEM-D                 PIC X.
  5154                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5155             20  CF-SOC-SEC-NO-SW            PIC X.
  5156                 88  SOC-SEC-NO-USED             VALUE '1'.
  5157             20  CF-MEMBER-NO-SW             PIC X.
  5158                 88  MEMBER-NO-USED              VALUE '1'.
  5159             20  CF-TAX-ID-NUMBER            PIC X(11).
  5160             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5161             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5162                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5163                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5164                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5165                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5166             20  CF-SYSTEM-E                 PIC X.
  5167                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5168
  5169         16  CF-LGX-LIFE-USER               PIC X.
  5170             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5171             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5172
  5173         16  CF-CR-MONTH-END-DT             PIC XX.
  5174
  5175         16  CF-FILE-MAINT-DATES.
  5176             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5177                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5178             20  CF-LAST-BATCH       REDEFINES
  5179                 CF-LAST-BATCH-NO               PIC X(4).
  5180             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5181             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5182             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5183             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5184             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5185             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5186             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5187             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5188             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  97
* EL050.cbl
  5189             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5190
  5191         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5192         16  FILLER                         PIC X.
  5193
  5194         16  CF-ALT-MORT-CODE               PIC X(4).
  5195         16  CF-MEMBER-CAPTION              PIC X(10).
  5196
  5197         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5198             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5199             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5200             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5201             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5202             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5203
  5204         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5205
  5206         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5207         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5208         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5209         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5210
  5211         16  CF-AH-OVERRIDE-L1              PIC X.
  5212         16  CF-AH-OVERRIDE-L2              PIC XX.
  5213         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5214         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5215
  5216         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5217         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5218
  5219         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5220         16  CF-AR-LAST-EL860-DT            PIC XX.
  5221         16  CF-MP-MONTH-END-DT             PIC XX.
  5222
  5223         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5224         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5225             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5226
  5227         16  CF-AR-MONTH-END-DT             PIC XX.
  5228
  5229         16  CF-CRDTCRD-USER                PIC X.
  5230             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5231             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5232
  5233         16  CF-CC-MONTH-END-DT             PIC XX.
  5234
  5235         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5236
  5237         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5238             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5239             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5240             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5241         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5242         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5243         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5244         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5245             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5246             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  98
* EL050.cbl
  5247         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5248         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5249         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5250             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5251         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5252
  5253         16  CF-CL-ZIP-CODE.
  5254             20  CF-CL-ZIP-PRIME.
  5255                 24  CF-CL-ZIP-1ST          PIC X.
  5256                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5257                 24  FILLER                 PIC X(4).
  5258             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5259         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5260             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5261             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5262             20  FILLER                     PIC XXX.
  5263
  5264         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5265         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5266         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5267         16  CF-CO-OPTION-START-DATE        PIC XX.
  5268         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5269           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5270                                                      '3' '4'.
  5271           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5272           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5273           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5274           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5275           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5276           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5277
  5278         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5279
  5280         16  CF-PAYMENT-APPROVAL-LEVELS.
  5281             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5282             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5283             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5284             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5285             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5286             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5287
  5288         16  CF-END-USER-REPORTING-USER     PIC X.
  5289             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5290             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5291
  5292         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5293             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5294             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5295
  5296         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5297
  5298         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5299         16  FILLER                         PIC X.
  5300
  5301         16  CF-CREDIT-ARCHIVE-CNTL.
  5302             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5303             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5304             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  99
* EL050.cbl
  5305
  5306         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5307
  5308         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5309             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5310             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5311
  5312         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5313             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5314             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5315
  5316         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5317
  5318         16  CF-CO-ACH-ID-CODE              PIC  X.
  5319             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5320             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5321             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5322         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5323         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5324         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5325         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5326         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5327         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5328         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5329         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5330         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5331                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5332         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5333                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5334
  5335         16  CF-CO-OVER-SHORT.
  5336             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5337             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5338
  5339*         16  FILLER                         PIC X(102).
  5340         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5341             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5342             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5343
  5344         16  CF-AH-APPROVAL-DAYS.
  5345             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5346             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5347             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5348             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5349
  5350         16  FILLER                         PIC X(82).
  5351****************************************************************
  5352*             PROCESSOR/USER RECORD                            *
  5353****************************************************************
  5354
  5355     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5356         16  CF-PROCESSOR-NAME              PIC X(30).
  5357         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5358         16  CF-PROCESSOR-TITLE             PIC X(26).
  5359         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5360                 88  MESSAGE-YES                VALUE 'Y'.
  5361                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5362
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 100
* EL050.cbl
  5363*****************************************************
  5364****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5365****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5366****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5367****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5368*****************************************************
  5369
  5370         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5371             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5372             20  CF-APPLICATION-FORCE       PIC X.
  5373             20  CF-INDIVIDUAL-APP.
  5374                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5375                     28  CF-BROWSE-APP      PIC X.
  5376                     28  CF-UPDATE-APP      PIC X.
  5377
  5378         16  CF-CURRENT-TERM-ON             PIC X(4).
  5379         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5380             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5381             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5382             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5383             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5384             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5385             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5386             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5387         16  CF-PROCESSOR-CARRIER           PIC X.
  5388             88  NO-CARRIER-SECURITY            VALUE ' '.
  5389         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5390             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5391         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5392             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5393         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5394             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5395
  5396         16  CF-PROC-SYS-ACCESS-SW.
  5397             20  CF-PROC-CREDIT-CLAIMS-SW.
  5398                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5399                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5400                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5401                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5402             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5403                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5404                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5405             20  CF-PROC-LIFE-GNRLDGR-SW.
  5406                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5407                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5408                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5409                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5410             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5411                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5412                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5413         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5414             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5415             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5416         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5417
  5418         16  CF-APPROVAL-LEVEL                  PIC X.
  5419             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5420             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 101
* EL050.cbl
  5421             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5422             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5423
  5424         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5425
  5426         16  CF-LANGUAGE-TYPE                   PIC X.
  5427             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5428             88  CF-LANG-IS-FR                      VALUE 'F'.
  5429
  5430         16  CF-CSR-IND                         PIC X.
  5431         16  FILLER                             PIC X(239).
  5432
  5433****************************************************************
  5434*             PROCESSOR/REMINDERS RECORD                       *
  5435****************************************************************
  5436
  5437     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5438         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5439             20  CF-START-REMIND-DT         PIC XX.
  5440             20  CF-END-REMIND-DT           PIC XX.
  5441             20  CF-REMINDER-TEXT           PIC X(50).
  5442         16  FILLER                         PIC X(296).
  5443
  5444
  5445****************************************************************
  5446*             STATE MASTER RECORD                              *
  5447****************************************************************
  5448
  5449     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5450         16  CF-STATE-ABBREVIATION          PIC XX.
  5451         16  CF-STATE-NAME                  PIC X(25).
  5452         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5453         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5454             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5455             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5456             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5457             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5458                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5459                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5460             20  CF-ST-PREM-REJECT-SW       PIC X.
  5461                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5462                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5463             20  CF-ST-REF-REJECT-SW        PIC X.
  5464                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5465                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5466         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5467         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5468         16  CF-ST-REFUND-RULES.
  5469             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5470             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5471             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5472         16  CF-ST-FST-PMT-EXTENSION.
  5473             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5474             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5475                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5476                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5477                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5478                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 102
* EL050.cbl
  5479         16  CF-ST-STATE-CALL.
  5480             20  CF-ST-CALL-UNEARNED        PIC X.
  5481             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5482             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5483         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5484             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5485             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5486         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5487         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5488         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5489         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5490         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5491         16  FILLER                         PIC X.
  5492         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5493             20  CF-ST-BENEFIT-CD           PIC XX.
  5494             20  CF-ST-BENEFIT-KIND         PIC X.
  5495                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5496                 88  CF-ST-AH-KIND              VALUE 'A'.
  5497             20  CF-ST-REM-TERM-CALC        PIC X.
  5498                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5499                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5500                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5501                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5502                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5503                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5504                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5505                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5506
  5507             20  CF-ST-REFUND-CALC          PIC X.
  5508                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5509                 88  ST-REFD-BY-R78             VALUE '1'.
  5510                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5511                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5512                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5513                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5514                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5515                 88  ST-REFD-UTAH               VALUE '7'.
  5516                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5517                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5518                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5519
  5520             20  CF-ST-EARNING-CALC         PIC X.
  5521                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5522                 88  ST-EARN-BY-R78             VALUE '1'.
  5523                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5524                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5525                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5526                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5527                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5528                 88  ST-EARN-MEAN               VALUE '8'.
  5529                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5530
  5531             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5532                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5533                 88  ST-OVRD-BY-R78             VALUE '1'.
  5534                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5535                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5536                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 103
* EL050.cbl
  5537                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5538                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5539                 88  ST-OVRD-MEAN               VALUE '8'.
  5540                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5541             20  FILLER                     PIC X.
  5542
  5543         16  CF-ST-COMMISSION-CAPS.
  5544             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5545             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5546             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5547             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5548         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5549                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5550
  5551         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5552
  5553         16  CF-ST-STATUTORY-INTEREST.
  5554             20  CF-ST-STAT-DATE-FROM       PIC X.
  5555                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5556                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5557             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5558             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5559             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5560             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5561             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5562
  5563         16  CF-ST-OVER-SHORT.
  5564             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5565             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5566
  5567         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5568
  5569         16  CF-ST-RT-CALC                  PIC X.
  5570
  5571         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5572         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5573         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5574         16  CF-ST-RF-LR-CALC               PIC X.
  5575         16  CF-ST-RF-LL-CALC               PIC X.
  5576         16  CF-ST-RF-LN-CALC               PIC X.
  5577         16  CF-ST-RF-AH-CALC               PIC X.
  5578         16  CF-ST-RF-CP-CALC               PIC X.
  5579*        16  FILLER                         PIC X(206).
  5580*CIDMOD         16  FILLER                         PIC X(192).
  5581         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5582             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5583         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5584         16  CF-ST-VFY-2ND-BENE             PIC X.
  5585         16  CF-ST-CAUSAL-STATE             PIC X.
  5586         16  FILLER                         PIC X(185).
  5587
  5588****************************************************************
  5589*             BENEFIT MASTER RECORD                            *
  5590****************************************************************
  5591
  5592     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5593         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5594             20  CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 104
* EL050.cbl
  5595             20  CF-BENEFIT-NUMERIC  REDEFINES
  5596                 CF-BENEFIT-CODE            PIC XX.
  5597             20  CF-BENEFIT-ALPHA           PIC XXX.
  5598             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5599             20  CF-BENEFIT-COMMENT         PIC X(10).
  5600
  5601             20  CF-LF-COVERAGE-TYPE        PIC X.
  5602                 88  CF-REDUCING                VALUE 'R'.
  5603                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5604
  5605             20  CF-SPECIAL-CALC-CD         PIC X.
  5606                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5607                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5608                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5609                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5610                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5611                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5612                 88  CF-FARM-PLAN               VALUE 'F'.
  5613                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5614                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5615                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5616                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5617                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5618                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5619                 88  CF-PRUDENTIAL              VALUE 'P'.
  5620                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5621                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5622                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5623                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5624                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5625                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5626
  5627             20  CF-JOINT-INDICATOR         PIC X.
  5628                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5629
  5630*            20  FILLER                     PIC X(12).
  5631             20  FILLER                     PIC X(11).
  5632             20  CF-BENEFIT-CATEGORY        PIC X.
  5633             20  CF-LOAN-TYPE               PIC X(8).
  5634
  5635             20  CF-CO-REM-TERM-CALC        PIC X.
  5636                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5637                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5638                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5639                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5640                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5641
  5642             20  CF-CO-EARNINGS-CALC        PIC X.
  5643                 88  CO-EARN-BY-R78             VALUE '1'.
  5644                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5645                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5646                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5647                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5648                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5649                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5650                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5651
  5652             20  CF-CO-REFUND-CALC          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 105
* EL050.cbl
  5653                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5654                 88  CO-REFD-BY-R78             VALUE '1'.
  5655                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5656                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5657                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5658                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5659                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5660                 88  CO-REFD-MEAN               VALUE '8'.
  5661                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5662                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5663                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5664
  5665             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5666                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5667                 88  CO-OVRD-BY-R78             VALUE '1'.
  5668                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5669                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5670                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5671                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5672                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5673                 88  CO-OVRD-MEAN               VALUE '8'.
  5674                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5675
  5676             20  CF-CO-BEN-I-G-CD           PIC X.
  5677                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5678                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5679                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5680
  5681         16  FILLER                         PIC X(304).
  5682
  5683
  5684****************************************************************
  5685*             CARRIER MASTER RECORD                            *
  5686****************************************************************
  5687
  5688     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5689         16  CF-ADDRESS-DATA.
  5690             20  CF-MAIL-TO-NAME            PIC X(30).
  5691             20  CF-IN-CARE-OF              PIC X(30).
  5692             20  CF-ADDRESS-LINE-1          PIC X(30).
  5693             20  CF-ADDRESS-LINE-2          PIC X(30).
  5694             20  CF-CITY-STATE              PIC X(30).
  5695             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5696             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5697
  5698         16  CF-CLAIM-NO-CONTROL.
  5699             20  CF-CLAIM-NO-METHOD         PIC X.
  5700                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5701                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5702                 88  CLAIM-NO-SEQ               VALUE '3'.
  5703                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5704             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5705                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5706                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5707                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5708
  5709         16  CF-CHECK-NO-CONTROL.
  5710             20  CF-CHECK-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 106
* EL050.cbl
  5711                 88  CHECK-NO-MANUAL            VALUE '1'.
  5712                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5713                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5714                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5715             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5716                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5717
  5718         16  CF-DOMICILE-STATE              PIC XX.
  5719
  5720         16  CF-EXPENSE-CONTROLS.
  5721             20  CF-EXPENSE-METHOD          PIC X.
  5722                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5723                 88  DOLLARS-PER-PMT            VALUE '2'.
  5724                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5725                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5726             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5727             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5728
  5729         16  CF-CORRESPONDENCE-CONTROL.
  5730             20  CF-LETTER-RESEND-OPT       PIC X.
  5731                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5732                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5733             20  FILLER                     PIC X(4).
  5734
  5735         16  CF-RESERVE-CONTROLS.
  5736             20  CF-MANUAL-SW               PIC X.
  5737                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5738             20  CF-FUTURE-SW               PIC X.
  5739                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5740             20  CF-PTC-SW                  PIC X.
  5741                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5742             20  CF-IBNR-SW                 PIC X.
  5743                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5744             20  CF-PTC-LF-SW               PIC X.
  5745                 88  CF-LF-PTC-USED             VALUE '1'.
  5746             20  CF-CDT-ACCESS-METHOD       PIC X.
  5747                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5748                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5749                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5750             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5751
  5752         16  CF-CLAIM-CALC-METHOD           PIC X.
  5753             88  360-PLUS-MONTHS                VALUE '1'.
  5754             88  365-PLUS-MONTHS                VALUE '2'.
  5755             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5756             88  360-DAILY                      VALUE '4'.
  5757             88  365-DAILY                      VALUE '5'.
  5758
  5759         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5760         16  FILLER                         PIC X(11).
  5761
  5762         16  CF-LIMIT-AMOUNTS.
  5763             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5764             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5765             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5766             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5767             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5768             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 107
* EL050.cbl
  5769             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5770             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5771             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5772             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5773
  5774         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5775         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5776         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5777
  5778         16  CF-ZIP-CODE.
  5779             20  CF-ZIP-PRIME.
  5780                 24  CF-ZIP-1ST             PIC X.
  5781                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5782                 24  FILLER                 PIC X(4).
  5783             20  CF-ZIP-PLUS4               PIC X(4).
  5784         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5785             20  CF-CAN-POSTAL-1            PIC XXX.
  5786             20  CF-CAN-POSTAL-2            PIC XXX.
  5787             20  FILLER                     PIC XXX.
  5788
  5789         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5790         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5791         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5792
  5793         16  CF-RATING-SWITCH               PIC X.
  5794             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5795             88  CF-NO-RATING                   VALUE 'N'.
  5796
  5797         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5798
  5799         16  CF-CARRIER-OVER-SHORT.
  5800             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5801             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5802
  5803         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5804         16  CF-SECPAY-SWITCH               PIC X.
  5805             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5806             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5807         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5808         16  FILLER                         PIC X(448).
  5809*        16  FILLER                         PIC X(452).
  5810
  5811
  5812****************************************************************
  5813*             MORTALITY MASTER RECORD                          *
  5814****************************************************************
  5815
  5816     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5817         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5818                                INDEXED BY CF-MORT-NDX.
  5819             20  CF-MORT-TABLE              PIC X(5).
  5820             20  CF-MORT-TABLE-TYPE         PIC X.
  5821                 88  CF-MORT-JOINT              VALUE 'J'.
  5822                 88  CF-MORT-SINGLE             VALUE 'S'.
  5823                 88  CF-MORT-COMBINED           VALUE 'C'.
  5824                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5825                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5826             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 108
* EL050.cbl
  5827             20  CF-MORT-AGE-METHOD         PIC XX.
  5828                 88  CF-AGE-LAST                VALUE 'AL'.
  5829                 88  CF-AGE-NEAR                VALUE 'AN'.
  5830             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5831             20  CF-MORT-ADJUSTMENT-DIRECTION
  5832                                            PIC X.
  5833                 88  CF-MINUS                   VALUE '-'.
  5834                 88  CF-PLUS                    VALUE '+'.
  5835             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5836             20  CF-MORT-JOINT-CODE         PIC X.
  5837                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5838             20  CF-MORT-PC-Q               PIC X.
  5839                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5840             20  CF-MORT-TABLE-CODE         PIC X(4).
  5841             20  CF-MORT-COMMENTS           PIC X(15).
  5842             20  FILLER                     PIC X(14).
  5843
  5844         16  FILLER                         PIC X(251).
  5845
  5846
  5847****************************************************************
  5848*             BUSSINESS TYPE MASTER RECORD                     *
  5849****************************************************************
  5850
  5851     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5852* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5853* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5854* AND RECORD 05 IS TYPES 81-99
  5855         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5856             20  CF-BUSINESS-TITLE          PIC  X(19).
  5857             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5858                                            PIC S9V9(4) COMP-3.
  5859             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5860             20  FILLER                     PIC  X.
  5861         16  FILLER                         PIC  X(248).
  5862
  5863
  5864****************************************************************
  5865*             TERMINAL MASTER RECORD                           *
  5866****************************************************************
  5867
  5868     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5869
  5870         16  CF-COMPANY-TERMINALS.
  5871             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5872                                  PIC X(4).
  5873         16  FILLER               PIC X(248).
  5874
  5875
  5876****************************************************************
  5877*             LIFE EDIT MASTER RECORD                          *
  5878****************************************************************
  5879
  5880     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5881         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5882             20  CF-LIFE-CODE-IN            PIC XX.
  5883             20  CF-LIFE-CODE-OUT           PIC XX.
  5884         16  FILLER                         PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 109
* EL050.cbl
  5885
  5886
  5887****************************************************************
  5888*             AH EDIT MASTER RECORD                            *
  5889****************************************************************
  5890
  5891     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5892         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5893             20  CF-AH-CODE-IN              PIC XXX.
  5894             20  CF-AH-CODE-OUT             PIC XX.
  5895         16  FILLER                         PIC X(248).
  5896
  5897
  5898****************************************************************
  5899*             CREDIBILITY TABLES                               *
  5900****************************************************************
  5901
  5902     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5903         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5904                             INDEXED BY CF-CRDB-NDX.
  5905             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5906             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5907             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5908         16  FILLER                         PIC  X(332).
  5909
  5910
  5911****************************************************************
  5912*             REPORT CUSTOMIZATION RECORD                      *
  5913****************************************************************
  5914
  5915     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5916         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5917             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5918             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5919             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5920**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5921****       A T-TRANSFER.                                   ****
  5922             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5923
  5924         16  FILLER                         PIC XX.
  5925
  5926         16  CF-CARRIER-CNTL-OPT.
  5927             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5928                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5929                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5930             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5931                                            PIC X.
  5932         16  CF-GROUP-CNTL-OPT.
  5933             20  CF-GROUP-OPT-SEQ           PIC 9.
  5934                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5935                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5936             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5937                                            PIC X(6).
  5938         16  CF-STATE-CNTL-OPT.
  5939             20  CF-STATE-OPT-SEQ           PIC 9.
  5940                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5941                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5942             20  CF-STATE-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 110
* EL050.cbl
  5943                                            PIC XX.
  5944         16  CF-ACCOUNT-CNTL-OPT.
  5945             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5946                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5947                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5948             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5949                                            PIC X(10).
  5950         16  CF-BUS-TYP-CNTL-OPT.
  5951             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5952                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5953                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5954             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5955                                            PIC XX.
  5956         16  CF-LF-TYP-CNTL-OPT.
  5957             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5958                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5959                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5960             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5961                                            PIC XX.
  5962         16  CF-AH-TYP-CNTL-OPT.
  5963             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5964                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5965                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5966             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5967                                            PIC XX.
  5968         16  CF-REPTCD1-CNTL-OPT.
  5969             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5970                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5971                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5972             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5973                                            PIC X(10).
  5974         16  CF-REPTCD2-CNTL-OPT.
  5975             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5976                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5977                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5978             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5979                                            PIC X(10).
  5980         16  CF-USER1-CNTL-OPT.
  5981             20  CF-USER1-OPT-SEQ           PIC 9.
  5982                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5983                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5984             20  CF-USER1-SELECT OCCURS 3 TIMES
  5985                                            PIC X(10).
  5986         16  CF-USER2-CNTL-OPT.
  5987             20  CF-USER2-OPT-SEQ           PIC 9.
  5988                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5989                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5990             20  CF-USER2-SELECT OCCURS 3 TIMES
  5991                                            PIC X(10).
  5992         16  CF-USER3-CNTL-OPT.
  5993             20  CF-USER3-OPT-SEQ           PIC 9.
  5994                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5995                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5996             20  CF-USER3-SELECT OCCURS 3 TIMES
  5997                                            PIC X(10).
  5998         16  CF-USER4-CNTL-OPT.
  5999             20  CF-USER4-OPT-SEQ           PIC 9.
  6000                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 111
* EL050.cbl
  6001                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6002             20  CF-USER4-SELECT OCCURS 3 TIMES
  6003                                            PIC X(10).
  6004         16  CF-USER5-CNTL-OPT.
  6005             20  CF-USER5-OPT-SEQ           PIC 9.
  6006                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6007                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6008             20  CF-USER5-SELECT OCCURS 3 TIMES
  6009                                            PIC X(10).
  6010         16  CF-REINS-CNTL-OPT.
  6011             20  CF-REINS-OPT-SEQ           PIC 9.
  6012                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6013                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6014             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6015                 24  CF-REINS-PRIME         PIC XXX.
  6016                 24  CF-REINS-SUB           PIC XXX.
  6017
  6018         16  CF-AGENT-CNTL-OPT.
  6019             20  CF-AGENT-OPT-SEQ           PIC 9.
  6020                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6021                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6022             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6023                                            PIC X(10).
  6024
  6025         16  FILLER                         PIC X(43).
  6026
  6027         16  CF-LOSS-RATIO-SELECT.
  6028             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6029             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6030         16  CF-ENTRY-DATE-SELECT.
  6031             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6032             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6033         16  CF-EFFECTIVE-DATE-SELECT.
  6034             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6035             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6036
  6037         16  CF-EXCEPTION-LIST-IND          PIC X.
  6038             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6039
  6040         16  FILLER                         PIC X(318).
  6041
  6042****************************************************************
  6043*                  EXCEPTION REPORTING RECORD                  *
  6044****************************************************************
  6045
  6046     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6047         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6048             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6049
  6050         16  CF-COMBINED-LIFE-AH-OPT.
  6051             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6052             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6053             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6054             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6055
  6056         16  CF-LIFE-OPT.
  6057             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6058             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 112
* EL050.cbl
  6059             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6060             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6061             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6062             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6063             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6064             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6065             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6066             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6067
  6068         16  CF-AH-OPT.
  6069             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6070             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6071             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6072             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6073             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6074             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6075             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6076             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6077             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6078             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6079
  6080         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6081             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6082             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6083             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6084
  6085         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6086
  6087         16  FILLER                         PIC X(673).
  6088
  6089
  6090****************************************************************
  6091*             MORTGAGE SYSTEM PLAN RECORD                      *
  6092****************************************************************
  6093
  6094     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6095         16  CF-PLAN-TYPE                   PIC X.
  6096             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6097             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6098             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6099         16  CF-PLAN-ABBREV                 PIC XXX.
  6100         16  CF-PLAN-DESCRIPT               PIC X(10).
  6101         16  CF-PLAN-NOTES                  PIC X(20).
  6102         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6103         16  CF-PLAN-UNDERWRITING.
  6104             20  CF-PLAN-TERM-DATA.
  6105                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6106                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6107             20  CF-PLAN-AGE-DATA.
  6108                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6109                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6110                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6111             20  CF-PLAN-BENEFIT-DATA.
  6112                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6113                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6114                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6115                                            PIC S9(7)V99  COMP-3.
  6116         16  CF-PLAN-POLICY-FORMS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 113
* EL050.cbl
  6117             20  CF-POLICY-FORM             PIC X(12).
  6118             20  CF-MASTER-APPLICATION      PIC X(12).
  6119             20  CF-MASTER-POLICY           PIC X(12).
  6120         16  CF-PLAN-RATING.
  6121             20  CF-RATE-CODE               PIC X(5).
  6122             20  CF-SEX-RATING              PIC X.
  6123                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6124                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6125             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6126             20  CF-SUB-STD-TYPE            PIC X.
  6127                 88  CF-PCT-OF-PREM            VALUE '1'.
  6128                 88  CF-PCT-OF-BENE            VALUE '2'.
  6129         16  CF-PLAN-PREM-TOLERANCES.
  6130             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6131             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6132         16  CF-PLAN-PYMT-TOLERANCES.
  6133             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6134             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6135         16  CF-PLAN-MISC-DATA.
  6136             20  FILLER                     PIC X.
  6137             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6138             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6139         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6140         16  CF-PLAN-IND-GRP                PIC X.
  6141             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6142                                                     '1'.
  6143             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6144                                                     '2'.
  6145         16  CF-MIB-SEARCH-SW               PIC X.
  6146             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6147             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6148             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6149             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6150         16  CF-ALPHA-SEARCH-SW             PIC X.
  6151             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6152             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6153             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6154             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6155             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6156             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6157             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6158             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6159             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6160             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6161                                                     'A' 'B' 'C'
  6162                                                     'X' 'Y' 'Z'.
  6163         16  CF-EFF-DT-RULE-SW              PIC X.
  6164             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6165             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6166             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6167             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6168             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6169         16  FILLER                         PIC X(4).
  6170         16  CF-HEALTH-QUESTIONS            PIC X.
  6171             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6172         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6173         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6174         16  CF-PLAN-SNGL-JNT               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 114
* EL050.cbl
  6175             88  CF-COMBINED-PLAN              VALUE 'C'.
  6176             88  CF-JNT-PLAN                   VALUE 'J'.
  6177             88  CF-SNGL-PLAN                  VALUE 'S'.
  6178         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6179         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6180         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6181         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6182         16  CF-RERATE-CNTL                 PIC  X.
  6183             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6184             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6185             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6186             88  CF-AUTO-RECALC                 VALUE '4'.
  6187         16  CF-BENEFIT-TYPE                PIC  X.
  6188             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6189             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6190         16  CF-POLICY-FEE                  PIC S999V99
  6191                                                    COMP-3.
  6192         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6193         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6194         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6195         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6196         16  FILLER                         PIC  X(32).
  6197         16  CF-TERMINATION-FORM            PIC  X(04).
  6198         16  FILLER                         PIC  X(08).
  6199         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6200                                                       COMP-3.
  6201         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6202         16  CF-ISSUE-LETTER                PIC  X(4).
  6203         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6204         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6205             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6206             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6207         16  CF-MP-REFUND-CALC              PIC X.
  6208             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6209             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6210             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6211             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6212             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6213             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6214             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6215             88  CF-MP-REFD-MEAN                VALUE '8'.
  6216         16  CF-ALT-RATE-CODE               PIC  X(5).
  6217
  6218
  6219         16  FILLER                         PIC X(498).
  6220****************************************************************
  6221*             MORTGAGE COMPANY MASTER RECORD                   *
  6222****************************************************************
  6223
  6224     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6225         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6226         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6227             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6228             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6229             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6230             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6231             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6232
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 115
* EL050.cbl
  6233         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6234         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6235         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6236         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6237         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6238
  6239         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6240             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6241         16  CF-MP-RECON-USE-IND            PIC X(1).
  6242             88  CF-MP-USE-RECON             VALUE 'Y'.
  6243         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6244             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6245         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6246             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6247             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6248         16  FILLER                         PIC X(1).
  6249         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6250             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6251         16  CF-MORTG-MIB-VERSION           PIC X.
  6252             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6253             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6254             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6255         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6256             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6257                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6258             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6259                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6260             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6261                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6262             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6263                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6264             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6265                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6266             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6267                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6268         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6269         16  FILLER                         PIC X(7).
  6270         16  CF-MORTG-DESTINATION-SYMBOL.
  6271             20  CF-MORTG-MIB-COMM          PIC X(5).
  6272             20  CF-MORTG-MIB-TERM          PIC X(5).
  6273         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6274             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6275         16  FILLER                         PIC X(03).
  6276         16  CF-MP-CHECK-NO-CONTROL.
  6277             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6278                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6279                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6280                                                ' ' LOW-VALUES.
  6281                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6282                                               VALUE '3'.
  6283         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6284         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6285         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6286             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6287                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6288             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6289                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6290             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 116
* EL050.cbl
  6291                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6292             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6293                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6294             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6295                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6296             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6297                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6298         16  CF-MORTG-BILLING-AREA.
  6299             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6300                                            PIC X.
  6301         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6302         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6303         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6304         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6305             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6306             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6307         16  FILLER                         PIC X.
  6308         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6309             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6310             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6311         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6312         16  FILLER                         PIC X(8).
  6313         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6314         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6315         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6316         16  CF-ACH-COMPANY-ID.
  6317             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6318                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6319                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6320                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6321             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6322         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6323             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6324         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6325             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6326             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6327         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6328         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6329         16  FILLER                         PIC X(536).
  6330
  6331****************************************************************
  6332*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6333****************************************************************
  6334
  6335     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6336         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6337             20  CF-FEMALE-HEIGHT.
  6338                 24  CF-FEMALE-FT           PIC 99.
  6339                 24  CF-FEMALE-IN           PIC 99.
  6340             20  CF-FEMALE-MIN-WT           PIC 999.
  6341             20  CF-FEMALE-MAX-WT           PIC 999.
  6342         16  FILLER                         PIC X(428).
  6343
  6344     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6345         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6346             20  CF-MALE-HEIGHT.
  6347                 24  CF-MALE-FT             PIC 99.
  6348                 24  CF-MALE-IN             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 117
* EL050.cbl
  6349             20  CF-MALE-MIN-WT             PIC 999.
  6350             20  CF-MALE-MAX-WT             PIC 999.
  6351         16  FILLER                         PIC X(428).
  6352******************************************************************
  6353*             AUTOMATIC ACTIVITY RECORD                          *
  6354******************************************************************
  6355     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6356         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6357             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6358             20  CF-SYS-LETTER-ID           PIC X(04).
  6359             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6360             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6361             20  CF-SYS-RESET-SW            PIC X(01).
  6362             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6363             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6364
  6365         16  FILLER                         PIC X(50).
  6366
  6367         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6368             20  CF-USER-ACTIVE-SW          PIC X(01).
  6369             20  CF-USER-LETTER-ID          PIC X(04).
  6370             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6371             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6372             20  CF-USER-RESET-SW           PIC X(01).
  6373             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6374             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6375             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6376
  6377         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 118
* EL050.cbl
  6379*    COPY ERCACCT.
  6380******************************************************************
  6381*                                                                *
  6382*                                                                *
  6383*                            ERCACCT                             *
  6384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6385*                            VMOD=2.031                          *
  6386*                                                                *
  6387*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6388*                                                                *
  6389*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6390*   VSAM ACCOUNT MASTER FILES.                                   *
  6391*                                                                *
  6392*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6393*                                                                *
  6394*   FILE TYPE = VSAM,KSDS                                        *
  6395*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6396*                                                                *
  6397*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6398*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6399*                                                                *
  6400*   LOG = NO                                                     *
  6401*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6402*                                                                *
  6403*                                                                *
  6404******************************************************************
  6405*                   C H A N G E   L O G
  6406*
  6407* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6408*-----------------------------------------------------------------
  6409*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6410* EFFECTIVE    NUMBER
  6411*-----------------------------------------------------------------
  6412* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6413* 092705    2005050300006  PEMA  ADD SPP LEASES
  6414* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6415* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6416* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6417* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6418* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6419******************************************************************
  6420
  6421 01  ACCOUNT-MASTER.
  6422     12  AM-RECORD-ID                      PIC XX.
  6423         88  VALID-AM-ID                      VALUE 'AM'.
  6424
  6425     12  AM-CONTROL-PRIMARY.
  6426         16  AM-COMPANY-CD                 PIC X.
  6427         16  AM-MSTR-CNTRL.
  6428             20  AM-CONTROL-A.
  6429                 24  AM-CARRIER            PIC X.
  6430                 24  AM-GROUPING.
  6431                     28 AM-GROUPING-PREFIX PIC XXX.
  6432                     28 AM-GROUPING-PRIME  PIC XXX.
  6433                 24  AM-STATE              PIC XX.
  6434                 24  AM-ACCOUNT.
  6435                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6436                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 119
* EL050.cbl
  6437             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6438                                           PIC X(19).
  6439             20  AM-CNTRL-B.
  6440                 24  AM-EXPIRATION-DT      PIC XX.
  6441                 24  FILLER                PIC X(4).
  6442             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6443                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6444
  6445     12  AM-CONTROL-BY-VAR-GRP.
  6446         16  AM-COMPANY-CD-A1              PIC X.
  6447         16  AM-VG-CARRIER                 PIC X.
  6448         16  AM-VG-GROUPING                PIC X(6).
  6449         16  AM-VG-STATE                   PIC XX.
  6450         16  AM-VG-ACCOUNT                 PIC X(10).
  6451         16  AM-VG-DATE.
  6452             20  AM-VG-EXPIRATION-DT       PIC XX.
  6453             20  FILLER                    PIC X(4).
  6454         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6455                                           PIC 9(11)      COMP-3.
  6456     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6457         16  FILLER                        PIC X(10).
  6458         16  AM-VG-KEY3.
  6459             20  AM-VG3-ACCOUNT            PIC X(10).
  6460             20  AM-VG3-EXP-DT             PIC XX.
  6461         16  FILLER                        PIC X(4).
  6462     12  AM-MAINT-INFORMATION.
  6463         16  AM-LAST-MAINT-DT              PIC XX.
  6464         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6465         16  AM-LAST-MAINT-USER            PIC X(4).
  6466         16  FILLER                        PIC XX.
  6467
  6468     12  AM-EFFECTIVE-DT                   PIC XX.
  6469     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6470
  6471     12  AM-PREV-DATES  COMP-3.
  6472         16  AM-PREV-EXP-DT                PIC 9(11).
  6473         16  AM-PREV-EFF-DT                PIC 9(11).
  6474
  6475     12  AM-REPORT-CODE-1                  PIC X(10).
  6476     12  AM-REPORT-CODE-2                  PIC X(10).
  6477
  6478     12  AM-CITY-CODE                      PIC X(4).
  6479     12  AM-COUNTY-PARISH                  PIC X(6).
  6480
  6481     12  AM-NAME                           PIC X(30).
  6482     12  AM-PERSON                         PIC X(30).
  6483     12  AM-ADDRS                          PIC X(30).
  6484     12  AM-CITY.
  6485         16  AM-ADDR-CITY                  PIC X(28).
  6486         16  AM-ADDR-STATE                 PIC XX.
  6487     12  AM-ZIP.
  6488         16  AM-ZIP-PRIME.
  6489             20  AM-ZIP-PRI-1ST            PIC X.
  6490                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6491             20  FILLER                    PIC X(4).
  6492         16  AM-ZIP-PLUS4                  PIC X(4).
  6493     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6494         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 120
* EL050.cbl
  6495         16  AM-CAN-POSTAL-2               PIC XXX.
  6496         16  FILLER                        PIC XXX.
  6497     12  AM-TEL-NO.
  6498         16  AM-AREA-CODE                  PIC 999.
  6499         16  AM-TEL-PRE                    PIC 999.
  6500         16  AM-TEL-NBR                    PIC 9(4).
  6501     12  AM-TEL-LOC                        PIC X.
  6502         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6503         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6504
  6505     12  AM-COMM-STRUCTURE.
  6506         16  AM-DEFN-1.
  6507             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6508                 24  AM-AGT.
  6509                     28  AM-AGT-PREFIX     PIC X(4).
  6510                     28  AM-AGT-PRIME      PIC X(6).
  6511                 24  AM-COM-TYP            PIC X.
  6512                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6513                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6514                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6515                 24  AM-RECALC-LV-INDIC    PIC X.
  6516                 24  AM-RETRO-LV-INDIC     PIC X.
  6517                 24  AM-GL-CODES           PIC X.
  6518                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6519                 24  FILLER                PIC X(01).
  6520         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6521             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6522                 24  FILLER                PIC X(11).
  6523                 24  AM-L-COMA             PIC XXX.
  6524                 24  AM-J-COMA             PIC XXX.
  6525                 24  AM-A-COMA             PIC XXX.
  6526                 24  FILLER                PIC X(6).
  6527
  6528     12  AM-COMM-CHANGE-STATUS             PIC X.
  6529         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6530
  6531     12  AM-CSR-CODE                       PIC X(4).
  6532
  6533     12  AM-BILLING-STATUS                 PIC X.
  6534         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6535         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6536     12  AM-AUTO-REFUND-SW                 PIC X.
  6537         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6538         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6539     12  AM-GPCD                           PIC 99.
  6540     12  AM-IG                             PIC X.
  6541         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6542         88  AM-HAS-GROUP                     VALUE '2'.
  6543     12  AM-STATUS                         PIC X.
  6544         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6545         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6546         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6547         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6548         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6549         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6550     12  AM-REMIT-TO                       PIC 99.
  6551     12  AM-ID-NO                          PIC X(11).
  6552
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 121
* EL050.cbl
  6553     12  AM-CAL-TABLE                      PIC XX.
  6554     12  AM-LF-DEVIATION                   PIC XXX.
  6555     12  AM-AH-DEVIATION                   PIC XXX.
  6556     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6557     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6558     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6559     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6560     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6561     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6562
  6563     12  AM-USER-FIELDS.
  6564         16  AM-FLD-1                      PIC XX.
  6565         16  AM-FLD-2                      PIC XX.
  6566         16  AM-FLD-3                      PIC XX.
  6567         16  AM-FLD-4                      PIC XX.
  6568         16  AM-FLD-5                      PIC XX.
  6569
  6570     12  AM-1ST-PROD-DATE.
  6571         16  AM-1ST-PROD-YR                PIC XX.
  6572         16  AM-1ST-PROD-MO                PIC XX.
  6573         16  AM-1ST-PROD-DA                PIC XX.
  6574     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6575     12  AM-CERTS-PURGED-DATE.
  6576         16  AM-PUR-YR                     PIC XX.
  6577         16  AM-PUR-MO                     PIC XX.
  6578         16  AM-PUR-DA                     PIC XX.
  6579     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6580     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6581     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6582     12  AM-INACTIVE-DATE.
  6583         16  AM-INA-MO                     PIC 99.
  6584         16  AM-INA-DA                     PIC 99.
  6585         16  AM-INA-YR                     PIC 99.
  6586     12  AM-AR-HI-CERT-DATE                PIC XX.
  6587
  6588     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6589     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6590
  6591     12  AM-OB-PAYMENT-MODE                PIC X.
  6592         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6593         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6594         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6595         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6596
  6597     12  AM-AH-ONLY-INDICATOR              PIC X.
  6598         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6599         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6600
  6601     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6602
  6603     12  AM-OVER-SHORT.
  6604         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6605         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6606
  6607     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6608     12  AM-DCC-CLP-STATE                  PIC XX.
  6609
  6610     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 122
* EL050.cbl
  6611     12  AM-RECALC-REIN                    PIC X.
  6612
  6613     12  AM-REI-TABLE                      PIC XXX.
  6614     12  AM-REI-ET-LF                      PIC X.
  6615     12  AM-REI-ET-AH                      PIC X.
  6616     12  AM-REI-PE-LF                      PIC X.
  6617     12  AM-REI-PE-AH                      PIC X.
  6618     12  AM-REI-PRT-ST                     PIC X.
  6619     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6620     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6621     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6622     12  AM-REI-GROUP-A                    PIC X(6).
  6623     12  AM-REI-MORT                       PIC X(4).
  6624     12  AM-REI-PRT-OW                     PIC X.
  6625     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6626     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6627     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6628     12  AM-REI-GROUP-B                    PIC X(6).
  6629
  6630     12  AM-TRUST-TYPE                     PIC X(2).
  6631
  6632     12  AM-EMPLOYER-STMT-USED             PIC X.
  6633     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6634
  6635     12  AM-STD-AH-TYPE                    PIC XX.
  6636     12  AM-EARN-METHODS.
  6637         16  AM-EARN-METHOD-R              PIC X.
  6638             88 AM-REF-RL-R78                 VALUE 'R'.
  6639             88 AM-REF-RL-PR                  VALUE 'P'.
  6640             88 AM-REF-RL-MEAN                VALUE 'M'.
  6641             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6642         16  AM-EARN-METHOD-L              PIC X.
  6643             88 AM-REF-LL-R78                 VALUE 'R'.
  6644             88 AM-REF-LL-PR                  VALUE 'P'.
  6645             88 AM-REF-LL-MEAN                VALUE 'M'.
  6646             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6647         16  AM-EARN-METHOD-A              PIC X.
  6648             88 AM-REF-AH-R78                 VALUE 'R'.
  6649             88 AM-REF-AH-PR                  VALUE 'P'.
  6650             88 AM-REF-AH-MEAN                VALUE 'M'.
  6651             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6652             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6653             88 AM-REF-AH-NET                 VALUE 'N'.
  6654
  6655     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6656     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6657     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6658
  6659     12  AM-RET-Y-N                        PIC X.
  6660     12  AM-RET-P-E                        PIC X.
  6661     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6662     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6663     12  AM-RET-GRP                        PIC X(6).
  6664     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6665         16  AM-POOL-PRIME                 PIC XXX.
  6666         16  AM-POOL-SUB                   PIC XXX.
  6667     12  AM-RETRO-EARNINGS.
  6668         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 123
* EL050.cbl
  6669         16  AM-RET-EARN-L                 PIC X.
  6670         16  AM-RET-EARN-A                 PIC X.
  6671     12  AM-RET-ST-TAX-USE                 PIC X.
  6672         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6673         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6674     12  AM-RETRO-BEG-EARNINGS.
  6675         16  AM-RET-BEG-EARN-R             PIC X.
  6676         16  AM-RET-BEG-EARN-L             PIC X.
  6677         16  AM-RET-BEG-EARN-A             PIC X.
  6678     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6679     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6680
  6681     12  AM-USER-SELECT-OPTIONS.
  6682         16  AM-USER-SELECT-1              PIC X(10).
  6683         16  AM-USER-SELECT-2              PIC X(10).
  6684         16  AM-USER-SELECT-3              PIC X(10).
  6685         16  AM-USER-SELECT-4              PIC X(10).
  6686         16  AM-USER-SELECT-5              PIC X(10).
  6687
  6688     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6689
  6690     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6691
  6692     12  AM-RPT045A-SWITCH                 PIC X.
  6693         88  RPT045A-OFF                   VALUE 'N'.
  6694
  6695     12  AM-INSURANCE-LIMITS.
  6696         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6697         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6698
  6699     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6700         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6701
  6702     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6703         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6704         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6705
  6706     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6707
  6708     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6709     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6710     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6711     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6712     12  AM-DCC-UEF-STATE                  PIC XX.
  6713     12  FILLER                            PIC XXX.
  6714     12  AM-REPORT-CODE-3                  PIC X(10).
  6715*    12  FILLER                            PIC X(22).
  6716
  6717     12  AM-RESERVE-DATE.
  6718         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6719         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6720         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6721
  6722     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6723     12  AM-NOTIFICATION-TYPES.
  6724         16  AM-NOTIF-OF-LETTERS           PIC X.
  6725         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6726         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 124
* EL050.cbl
  6727         16  AM-NOTIF-OF-STATUS            PIC X.
  6728
  6729     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6730         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6731         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6732         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6733         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6734
  6735     12  AM-BENEFIT-CONTROLS.
  6736         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6737             20  AM-BENEFIT-CODE           PIC XX.
  6738             20  AM-BENEFIT-TYPE           PIC X.
  6739             20  AM-BENEFIT-REVISION       PIC XXX.
  6740             20  AM-BENEFIT-REM-TERM       PIC X.
  6741             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6742             20  FILLER                    PIC XX.
  6743         16  FILLER                        PIC X(80).
  6744
  6745     12  AM-TRANSFER-DATA.
  6746         16  AM-TRANSFERRED-FROM.
  6747             20  AM-TRNFROM-CARRIER        PIC X.
  6748             20  AM-TRNFROM-GROUPING.
  6749                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6750                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6751             20  AM-TRNFROM-STATE          PIC XX.
  6752             20  AM-TRNFROM-ACCOUNT.
  6753                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6754                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6755             20  AM-TRNFROM-DTE            PIC XX.
  6756         16  AM-TRANSFERRED-TO.
  6757             20  AM-TRNTO-CARRIER          PIC X.
  6758             20  AM-TRNTO-GROUPING.
  6759                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6760                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6761             20  AM-TRNTO-STATE            PIC XX.
  6762             20  AM-TRNTO-ACCOUNT.
  6763                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6764                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6765             20  AM-TRNTO-DTE              PIC XX.
  6766         16  FILLER                        PIC X(10).
  6767
  6768     12  AM-SAVED-REMIT-TO                 PIC 99.
  6769
  6770     12  AM-COMM-STRUCTURE-SAVED.
  6771         16  AM-DEFN-1-SAVED.
  6772             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6773                 24  AM-AGT-SV             PIC X(10).
  6774                 24  AM-COM-TYP-SV         PIC X.
  6775                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6776                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6777                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6778                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6779                 24  FILLER                PIC X.
  6780                 24  AM-GL-CODES-SV        PIC X.
  6781                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6782                 24  FILLER                PIC X.
  6783         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6784             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 125
* EL050.cbl
  6785                 24  FILLER                PIC X(11).
  6786                 24  AM-L-COMA-SV          PIC XXX.
  6787                 24  AM-J-COMA-SV          PIC XXX.
  6788                 24  AM-A-COMA-SV          PIC XXX.
  6789                 24  FILLER                PIC X(6).
  6790
  6791     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6792         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6793            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6794            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6795            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6796
  6797     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6798     12  FILLER                            PIC X(120).
  6799
  6800     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6801         16  AM-CONTROL-NAME               PIC X(30).
  6802         16  AM-EXECUTIVE-ONE.
  6803             20  AM-EXEC1-NAME             PIC X(15).
  6804             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6805                                                          COMP-3.
  6806             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6807                                                          COMP-3.
  6808         16  AM-EXECUTIVE-TWO.
  6809             20  AM-EXEC2-NAME             PIC X(15).
  6810             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6811                                                          COMP-3.
  6812             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6813                                                          COMP-3.
  6814
  6815     12  AM-RETRO-ADDITIONAL-DATA.
  6816         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6817         16  AM-RETRO-PREM-P-E             PIC X.
  6818         16  AM-RETRO-CLMS-P-I             PIC X.
  6819         16  AM-RETRO-RET-BRACKET-LF.
  6820             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6821                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6822                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6823             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6824                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6825                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6826             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6827                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6828                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6829         16  AM-RETRO-RET-BRACKET-AH.
  6830             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6831                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6832                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6833                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6834             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6835                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6836                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6837             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6838                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6839                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6840
  6841     12  AM-COMMENTS.
  6842         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 126
* EL050.cbl
  6843
  6844     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6845         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6846         16  AM-FLI-BILLING-CODE           PIC X.
  6847         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6848         16  AM-FLI-UNITED-IDENT           PIC X.
  6849         16  AM-FLI-INTEREST-LOST-DATA.
  6850             20  AM-FLI-BANK-NO            PIC X(5).
  6851             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6852             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6853             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6854         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6855             20  AM-FLI-AGT                PIC X(9).
  6856             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6857             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6858         16  FILLER                        PIC X(102).
  6859
  6860     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6861         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6862             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6863             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6864             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6865             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6866             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6867         16  FILLER                          PIC X(10).
  6868******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 127
* EL050.cbl
  6870*    COPY ERCREIN.
  6871******************************************************************
  6872*                                                                *
  6873*                            ERCREIN                             *
  6874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6875*                            VMOD=2.010                          *
  6876*                                                                *
  6877*   ONLINE CREDIT SYSTEM                                         *
  6878*                                                                *
  6879*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6880*                                                                *
  6881*   FILE TYPE = VSAM,KSDS                                        *
  6882*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6883*                                                                *
  6884*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6885*       ALTERNATE PATH = NONE                                    *
  6886*                                                                *
  6887*   LOG = NO                                                     *
  6888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6889*                                                                *
  6890******************************************************************
  6891*                   C H A N G E   L O G
  6892*
  6893* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6894*-----------------------------------------------------------------
  6895*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6896* EFFECTIVE    NUMBER
  6897*-----------------------------------------------------------------
  6898* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6899* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6900******************************************************************
  6901 01  REINSURANCE-RECORD.
  6902     12  RE-RECORD-ID                      PIC XX.
  6903         88  VALID-RE-ID                      VALUE 'RE'.
  6904
  6905     12  RE-CONTROL-PRIMARY.
  6906         16  RE-COMPANY-CD                 PIC X.
  6907         16  RE-KEY.
  6908             20  RE-CODE                   PIC X.
  6909                 88  RE-TABLE-RECORD          VALUE 'A'.
  6910                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6911             20  RE-TABLE                  PIC XXX.
  6912             20  FILLER                    PIC XXX.
  6913         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6914             20  FILLER                    PIC X.
  6915             20  RE-COMPANY.
  6916                 24  RE-COMP-PRIME         PIC XXX.
  6917                 24  RE-COMP-SUB           PIC XXX.
  6918
  6919     12  RE-MAINT-INFORMATION.
  6920         16  RE-LAST-MAINT-DT              PIC XX.
  6921         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6922         16  RE-LAST-MAINT-USER            PIC X(4).
  6923         16  FILLER                        PIC X(10).
  6924
  6925     12  RE-TABLE-DATA.
  6926         16  RE-100-COMP                   PIC 99.
  6927
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 128
* EL050.cbl
  6928         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6929             20  RE-REI-COMP-NO.
  6930                 24  RE-REI-COMP           PIC XXX.
  6931                 24  RE-REI-COMP-SUB       PIC XXX.
  6932             20  RE-LF-QC                  PIC X.
  6933             20  RE-AH-QC                  PIC X.
  6934             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6935             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6936             20  RE-LFAGE-LO               PIC 99.
  6937             20  RE-LFAGE-HI               PIC 99.
  6938             20  RE-AHAGE-LO               PIC 99.
  6939             20  RE-AHAGE-HI               PIC 99.
  6940             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6941             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6942             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6943             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6944             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6945             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6946             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6947             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6948             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6949             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6950             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6951             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6952             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6953             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6954             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6955             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6956             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6957             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6958             20  RE-LF-BEN-CODE            PIC X.
  6959             20  RE-AH-BEN-CODE            PIC X.
  6960             20  RE-INTERACTIVE            PIC X.
  6961             20  RE-REMAINING              PIC X.
  6962             20  RE-LF-RUNOFF-SW           PIC X.
  6963             20  RE-AH-RUNOFF-SW           PIC X.
  6964             20  FILLER                    PIC X(19).
  6965
  6966         16  RE-COMP-INFO-END              PIC X(6).
  6967         16  RE-NSP-ST-CD-LF               PIC XX.
  6968         16  RE-NSP-ST-CD-AH               PIC XX.
  6969         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6970             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6971
  6972         16  FILLER                        PIC X(27).
  6973
  6974     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6975         16  RE-NAME                       PIC X(30).
  6976         16  RE-LF-PE                      PIC X.
  6977         16  RE-AH-PE                      PIC X.
  6978         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6979         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6980         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6981         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6982         16  RE-PRT-ST                     PIC X.
  6983         16  RE-PRT-OW                     PIC X.
  6984         16  RE-MORT-CODE                  PIC X(4).
  6985         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 129
* EL050.cbl
  6986         16  RE-ZERO-LF-FEE                PIC X.
  6987         16  RE-ZERO-AH-FEE                PIC X.
  6988         16  RE-CEDE-NAME                  PIC X(30).
  6989         16  RE-LF-COMM                    PIC X.
  6990         16  RE-AH-COMM                    PIC X.
  6991         16  RE-LF-TAX                     PIC X.
  6992         16  RE-AH-TAX                     PIC X.
  6993         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6994         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6995         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6996
  6997         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6998             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6999
  7000         16  RE-LF-CEDING-FEE-BRACKETS.
  7001             20  RE-LF-FEE-METHOD          PIC X.
  7002                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7003                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7004                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7005                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7006             20  RE-LF-FEE-BASIS           PIC X.
  7007                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7008                 88  RE-LF-NET-CEDED               VALUE '2'.
  7009                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7010                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7011                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7012                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7013                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7014                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7015             20  FILLER                    PIC XXX.
  7016             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7017                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7018                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7019
  7020         16  RE-AH-CEDING-FEE-BRACKETS.
  7021             20  RE-AH-FEE-METHOD          PIC X.
  7022                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7023                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7024                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7025                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7026             20  RE-AH-FEE-BASIS           PIC X.
  7027                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7028                 88  RE-AH-NET-CEDED               VALUE '2'.
  7029                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7030                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7031                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7032                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7033                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7034                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7035             20  FILLER                    PIC XXX.
  7036             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7037                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7038                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7039
  7040         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7041
  7042         16  RE-OLD-CEDING-STMT            PIC X.
  7043
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 130
* EL050.cbl
  7044         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7045         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7046         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7047         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7048         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7049         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7050         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7051         16  RE-MORT-SW                    PIC X.
  7052         16  RE-CEDING-TYPE-FLAG           PIC X.
  7053             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7054             88  RE-CEDED                          VALUE 'C'.
  7055             88  RE-ASSUMED                        VALUE 'A'.
  7056             88  RE-PHANTOM                        VALUE 'P'.
  7057
  7058         16  RE-CEDING-STMT-OPT-A          PIC X.
  7059             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7060         16  RE-CEDING-STMT-OPT-B          PIC X.
  7061             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7062         16  RE-CEDING-STMT-OPT-C          PIC X.
  7063             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7064         16  RE-CEDING-STMT-OPT-D          PIC X.
  7065             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7066         16  RE-CEDING-STMT-OPT-E          PIC X.
  7067             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7068
  7069         16  RE-PRT-CRSV                   PIC X.
  7070
  7071         16  RE-GL-CENTER                  PIC X(4).
  7072
  7073         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7074
  7075         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7076
  7077         16  RE-EARN-STOP-CODE             PIC X.
  7078             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7079             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7080
  7081         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7082             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7083
  7084         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7085         16  FILLER                        PIC X(2281).
  7086
  7087         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7088
  7089******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 131
* EL050.cbl
  7091*    COPY ERCCTBL.
  7092******************************************************************
  7093*                                                                *
  7094*                                                                *
  7095*                            ERCCTBL                             *
  7096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7097*                            VMOD=2.003
  7098*                                                                *
  7099*   ONLINE CREDIT SYSTEM                                         *
  7100*                                                                *
  7101*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7102*                                                                *
  7103*   FILE TYPE = VSAM,KSDS                                        *
  7104*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7105*                                                                *
  7106*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7107*       ALTERNATE PATH = NONE                                    *
  7108*                                                                *
  7109*   LOG = NO                                                     *
  7110*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7111*                                                                *
  7112*                                                                *
  7113******************************************************************
  7114
  7115 01  COMM-TABLE-RECORD.
  7116     12  CT-RECORD-ID                      PIC XX.
  7117         88  VALID-CT-ID                      VALUE 'CT'.
  7118
  7119     12  CT-CONTROL-PRIMARY.
  7120         16  CT-COMPANY-CD                 PIC X.
  7121         16  CT-TABLE                      PIC XXX.
  7122         16  CT-CNTRL-2.
  7123             20  CT-BEN-TYPE               PIC X.
  7124             20  CT-BEN-CODE               PIC XX.
  7125
  7126     12  CT-MAINT-INFORMATION.
  7127         16  CT-LAST-MAINT-DT              PIC XX.
  7128         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7129         16  CT-LAST-MAINT-USER            PIC X(4).
  7130         16  FILLER                        PIC X(31).
  7131
  7132     12  CT-LIMITS.
  7133         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7134
  7135         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7136
  7137         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7138
  7139     12  CT-RATES.
  7140         16  CT-RTX          OCCURS 27 TIMES.
  7141             20  CT-RT                     PIC SV9(5)     COMP-3.
  7142             20  CT-RT-R   REDEFINES
  7143                 CT-RT                     PIC XXX.
  7144
  7145     12  FILLER                            PIC  X(42).
  7146
  7147******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 132
* EL050.cbl
  7149*    COPY ERCFORM.
  7150******************************************************************
  7151*                                                                *
  7152*                                                                *
  7153*                            ERCFORM.                            *
  7154*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7155*                            VMOD=2.003                          *
  7156*                                                                *
  7157*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7158*                                                                *
  7159*    FILE TYPE = VSAM,KSDS                                       *
  7160*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7161*                                                                *
  7162*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7163*                                                                *
  7164*    LOG = YES                                                   *
  7165*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7166******************************************************************
  7167 01  FORM-MASTER.
  7168    12  FO-RECORD-ID                 PIC X(02).
  7169        88  VALID-FO-ID                  VALUE 'FO'.
  7170
  7171    12  FO-CONTROL-PRIMARY.
  7172        16  FO-COMPANY-CD            PIC X(01).
  7173        16  FO-STATE                 PIC X(02).
  7174        16  FO-FORM-ID               PIC X(12).
  7175        16  FO-FORM-EXP-DT           PIC X(02).
  7176
  7177    12  FO-POLICY-FORM-DATA.
  7178        16  FO-IND-GRP-CD            PIC X(01).
  7179        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7180        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7181        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7182        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7183        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7184        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7185        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7186        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7187        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7188        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7189        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7190        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7191        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7192        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7193        16  FO-APP-CERT-USE-CD       PIC X(01).
  7194
  7195    12  FILLER                       PIC X(29).
  7196
  7197    12  FO-FORM-PLAN-TABLE.
  7198        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7199            20  FO-PLAN-TYPE         PIC X(01).
  7200            20  FO-PLAN-ID           PIC X(02).
  7201            20  FO-PLAN-TERM         PIC 9(03).
  7202            20  FO-PLAN-REFUND-METHOD
  7203                                     PIC X.
  7204
  7205    12  FILLER                       PIC X(30).
  7206
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 133
* EL050.cbl
  7207    12  FO-COMMENTS-AREA.
  7208        16  FO-COMMENT-LINE-1        PIC X(78).
  7209
  7210    12  FILLER                       PIC X(20).
  7211
  7212    12  FO-MAINT-INFORMATION.
  7213        16  FO-LAST-MAINT-DT         PIC X(02).
  7214        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7215        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 134
* EL050.cbl
  7217*    COPY ELCMSTR.
  7218******************************************************************
  7219*                                                                *
  7220*                            ELCMSTR.                            *
  7221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7222*                            VMOD=2.012                          *
  7223*                                                                *
  7224*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7225*                                                                *
  7226*   FILE TYPE = VSAM,KSDS                                        *
  7227*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7228*                                                                *
  7229*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7230*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7231*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7232*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7233*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7234*                                                 RKP=75,LEN=21  *
  7235*                                                                *
  7236*   **** NOTE ****                                               *
  7237*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7238*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7239*                                                                *
  7240*   LOG = YES                                                    *
  7241*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7242******************************************************************
  7243*                   C H A N G E   L O G
  7244*
  7245* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7246*-----------------------------------------------------------------
  7247*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7248* EFFECTIVE    NUMBER
  7249*-----------------------------------------------------------------
  7250* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7251* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7252******************************************************************
  7253 01  CLAIM-MASTER.
  7254     12  CL-RECORD-ID                PIC XX.
  7255         88  VALID-CL-ID         VALUE 'CL'.
  7256
  7257     12  CL-CONTROL-PRIMARY.
  7258         16  CL-COMPANY-CD           PIC X.
  7259         16  CL-CARRIER              PIC X.
  7260         16  CL-CLAIM-NO             PIC X(7).
  7261         16  CL-CERT-NO.
  7262             20  CL-CERT-PRIME       PIC X(10).
  7263             20  CL-CERT-SFX         PIC X.
  7264
  7265     12  CL-CONTROL-BY-NAME.
  7266         16  CL-COMPANY-CD-A1        PIC X.
  7267         16  CL-INSURED-LAST-NAME    PIC X(15).
  7268         16  CL-INSURED-NAME.
  7269             20  CL-INSURED-1ST-NAME PIC X(12).
  7270             20  CL-INSURED-MID-INIT PIC X.
  7271
  7272     12  CL-CONTROL-BY-SSN.
  7273         16  CL-COMPANY-CD-A2        PIC X.
  7274         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 135
* EL050.cbl
  7275             20  CL-SSN-STATE        PIC XX.
  7276             20  CL-SSN-ACCOUNT      PIC X(6).
  7277             20  CL-SSN-LN3          PIC X(3).
  7278
  7279     12  CL-CONTROL-BY-CERT-NO.
  7280         16  CL-COMPANY-CD-A4        PIC X.
  7281         16  CL-CERT-NO-A4.
  7282             20  CL-CERT-A4-PRIME    PIC X(10).
  7283             20  CL-CERT-A4-SFX      PIC X.
  7284
  7285     12  CL-CONTROL-BY-CCN.
  7286         16  CL-COMPANY-CD-A5        PIC X.
  7287         16  CL-CCN-A5.
  7288             20  CL-CCN.
  7289                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7290                 24  CL-CCN-PRIME-A5 PIC X(12).
  7291             20  CL-CCN-FILLER-A5    PIC X(4).
  7292
  7293     12  CL-INSURED-PROFILE-DATA.
  7294         16  CL-INSURED-BIRTH-DT     PIC XX.
  7295         16  CL-INSURED-SEX-CD       PIC X.
  7296             88  INSURED-IS-MALE        VALUE 'M'.
  7297             88  INSURED-IS-FEMALE      VALUE 'F'.
  7298             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7299         16  CL-INSURED-OCC-CD       PIC X(6).
  7300         16  FILLER                  PIC X(5).
  7301
  7302     12  CL-PROCESSING-INFO.
  7303         16  CL-PROCESSOR-ID         PIC X(4).
  7304         16  CL-CLAIM-STATUS         PIC X.
  7305             88  CLAIM-IS-OPEN          VALUE 'O'.
  7306             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7307         16  CL-CLAIM-TYPE           PIC X.
  7308*            88  AH-CLAIM               VALUE 'A'.
  7309*            88  LIFE-CLAIM             VALUE 'L'.
  7310*            88  PROPERTY-CLAIM         VALUE 'P'.
  7311*            88  IUI-CLAIM              VALUE 'I'.
  7312*            88  GAP-CLAIM              VALUE 'G'.
  7313         16  CL-CLAIM-PREM-TYPE      PIC X.
  7314             88  SINGLE-PREMIUM         VALUE '1'.
  7315             88  O-B-COVERAGE           VALUE '2'.
  7316             88  OPEN-END-COVERAGE      VALUE '3'.
  7317         16  CL-INCURRED-DT          PIC XX.
  7318         16  CL-REPORTED-DT          PIC XX.
  7319         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7320         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7321         16  CL-LAST-PMT-DT          PIC XX.
  7322         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7323         16  CL-PAID-THRU-DT         PIC XX.
  7324         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7325         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7326         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7327         16  CL-PMT-CALC-METHOD      PIC X.
  7328             88  CL-360-DAY-YR          VALUE '1'.
  7329             88  CL-365-DAY-YR          VALUE '2'.
  7330             88  CL-FULL-MONTHS         VALUE '3'.
  7331         16  CL-CAUSE-CD             PIC X(6).
  7332
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 136
* EL050.cbl
  7333         16  CL-PRIME-CERT-NO.
  7334             20  CL-PRIME-CERT-PRIME PIC X(10).
  7335             20  CL-PRIME-CERT-SFX   PIC X.
  7336
  7337         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7338             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7339             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7340
  7341         16  CL-MICROFILM-NO         PIC X(10).
  7342         16  CL-PROG-FORM-TYPE       PIC X.
  7343         16  CL-LAST-ADD-ON-DT       PIC XX.
  7344
  7345         16  CL-LAST-REOPEN-DT       PIC XX.
  7346         16  CL-LAST-CLOSE-DT        PIC XX.
  7347         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7348             88  FINAL-PAID             VALUE '1'.
  7349             88  CLAIM-DENIED           VALUE '2'.
  7350             88  AUTO-CLOSE             VALUE '3'.
  7351             88  MANUAL-CLOSE           VALUE '4'.
  7352             88  BENEFITS-CHANGED       VALUE 'C'.
  7353             88  SETUP-ERRORS           VALUE 'E'.
  7354         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7355         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7356         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7357             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7358         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7359         16  FILLER                  PIC X.
  7360
  7361     12  CL-CERTIFICATE-DATA.
  7362         16  CL-CERT-ORIGIN          PIC X.
  7363             88  CERT-WAS-ONLINE        VALUE '1'.
  7364             88  CERT-WAS-CREATED       VALUE '2'.
  7365             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7366         16  CL-CERT-KEY-DATA.
  7367             20  CL-CERT-CARRIER     PIC X.
  7368             20  CL-CERT-GROUPING    PIC X(6).
  7369             20  CL-CERT-STATE       PIC XX.
  7370             20  CL-CERT-ACCOUNT.
  7371                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7372                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7373             20  CL-CERT-EFF-DT      PIC XX.
  7374
  7375     12  CL-STATUS-CONTROLS.
  7376         16  CL-PRIORITY-CD          PIC X.
  7377             88  CONFIDENTIAL-DATA      VALUE '8'.
  7378             88  HIGHEST-PRIORITY       VALUE '9'.
  7379         16  CL-SUPV-ATTN-CD         PIC X.
  7380             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7381             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7382         16  CL-PURGED-DT            PIC XX.
  7383         16  CL-RESTORED-DT          PIC XX.
  7384         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7385         16  CL-NEXT-RESEND-DT       PIC XX.
  7386         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7387         16  FILLER                  PIC XX.
  7388         16  CL-LAST-MAINT-DT        PIC XX.
  7389         16  CL-LAST-MAINT-USER      PIC X(4).
  7390         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 137
* EL050.cbl
  7391         16  CL-LAST-MAINT-TYPE      PIC X.
  7392             88  CLAIM-SET-UP           VALUE ' '.
  7393             88  PAYMENT-MADE           VALUE '1'.
  7394             88  LETTER-SENT            VALUE '2'.
  7395             88  MASTER-WAS-ALTERED     VALUE '3'.
  7396             88  MASTER-WAS-RESTORED    VALUE '4'.
  7397             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7398             88  FILE-CONVERTED         VALUE '6'.
  7399             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7400             88  ERROR-CORRECTION       VALUE 'E'.
  7401         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7402         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7403         16  CL-BENEFICIARY          PIC X(10).
  7404         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7405         16  CL-DENIAL-TYPE          PIC X.
  7406             88  CL-TYPE-DENIAL          VALUE '1'.
  7407             88  CL-TYPE-RESCISSION      VALUE '2'.
  7408             88  CL-TYPE-REFORMATION     VALUE '3'.
  7409             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7410             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7411         16  FILLER                  PIC X(5).
  7412
  7413     12  CL-TRAILER-CONTROLS.
  7414         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7415             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7416             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7417             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7418         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7419         16  FILLER                  PIC XX.
  7420         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7421         16  CL-ADDRESS-TRAILER-CNT.
  7422             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7423                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7424             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7425                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7426             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7427                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7428             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7429                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7430             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7431                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7432             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7433                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7434             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7435                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7436
  7437     12  CL-CV-REFERENCE-NO.
  7438         16  CL-CV-REFNO-PRIME       PIC X(18).
  7439         16  CL-CV-REFNO-SFX         PIC XX.
  7440
  7441     12  CL-FILE-LOCATION            PIC X(4).
  7442
  7443     12  CL-PROCESS-ERRORS.
  7444         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7445             88  NO-FATAL-ERRORS        VALUE ZERO.
  7446         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7447             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7448
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 138
* EL050.cbl
  7449     12  CL-PRODUCT-CD               PIC X.
  7450
  7451     12  CL-CURRENT-KEY-DATA.
  7452         16  CL-CURRENT-CARRIER      PIC X.
  7453         16  CL-CURRENT-GROUPING     PIC X(6).
  7454         16  CL-CURRENT-STATE        PIC XX.
  7455         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7456
  7457     12  CL-ASSOCIATES               PIC X.
  7458         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7459         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7460         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7461         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7462
  7463     12  CL-ACTIVITY-CODE            PIC 99.
  7464     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7465     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7466
  7467     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7468     12  CL-LAG-REPORT-CODE          PIC 9.
  7469     12  CL-LOAN-TYPE                PIC XX.
  7470     12  CL-LEGAL-STATE              PIC XX.
  7471
  7472*    12  FILLER                      PIC X(5).
  7473     12  CL-YESNOSW                  PIC X.
  7474     12  FILLER                      PIC X(4).
  7475
  7476 01  PLAN-RECORDS.
  7477     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7478     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7479
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 139
* EL050.cbl
  7481 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7482                          ACCOUNT-MASTER REINSURANCE-RECORD
  7483                          COMM-TABLE-RECORD FORM-MASTER
  7484                          CLAIM-MASTER PLAN-RECORDS.
  7485 0000-DFHEXIT SECTION.
  7486     MOVE '9#                    $   ' TO DFHEIV0.
  7487     MOVE 'EL050' TO DFHEIV1.
  7488     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7489
  7490     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7491
  7492
  7493* EXEC CICS  HANDLE CONDITION
  7494*           ERROR    (9300-ABEND)
  7495*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7496*    END-EXEC.
  7497*    MOVE '"$.J                  ! " #00007488' TO DFHEIV0
  7498     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7500     MOVE X'2220233030303037343838' TO DFHEIV0(25:11)
  7501     CALL 'kxdfhei1' USING DFHEIV0
  7502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7503
  7504
  7505 0000-COPY-PROCEDURE-DIV.
  7506*                          COPY ELC50PD.
  7507******************************************************************
  7508*                                                                *
  7509*                            ELC50PD                             *
  7510*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7511*                            VMOD=2.188                          *
  7512*                                                                *
  7513******************************************************************
  7514*                   C H A N G E   L O G
  7515*
  7516* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7517*-----------------------------------------------------------------
  7518*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7519* EFFECTIVE    NUMBER
  7520*-----------------------------------------------------------------
  7521* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7522* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7523* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7524*                             2709 AND 2718
  7525* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7526* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7527* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7528* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7529* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7530*                                IS OPEN OR CNC DT < PD THRU
  7531* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7532* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7533* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7534* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7535* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7536* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7537* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7538* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 140
* EL050.cbl
  7539* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7540* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7541* 020906                   PEMA  EXPAND LOAN OFFICER
  7542* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7543* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7544* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7545* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7546* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7547* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7548* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7549* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7550* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7551* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7552* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7553* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7554* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7555* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7556* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7557* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7558* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7559* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7560* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7561* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7562* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7563* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7564* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7565* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7566* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7567*                                UPDATE VIN ON CERT TRAILER
  7568* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7569* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7570* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7571* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7572* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7573* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7574* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7575* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7576* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7577* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7578* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7579* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7580* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7581* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7582* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7583* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7584* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7585* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7586* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7587* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7588* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7589* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7590* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7591* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7592* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7593* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7594* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7595* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7596* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 141
* EL050.cbl
  7597* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7598* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7599* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7600* 032912  CR2011110200001  PEMA  AHL CHANGES
  7601* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7602* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7603* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7604* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7605* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7606* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7607* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7608* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7609* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7610* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7611* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7612******************************************************************
  7613************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7614******************************************************************
  7615
  7616     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7617
  7618     MOVE SPACES                 TO PB-FATAL-FLAG
  7619                                    PB-FORCE-ER-CD
  7620                                    PB-WARN-ER-CD
  7621                                    PB-OUT-BAL-CD.
  7622
  7623     MOVE SPACE                  TO WS-IG-OVRD-AH
  7624                                    WS-IG-OVRD-LF
  7625                                    WS-IG-OVRD-AM
  7626                                    WS-IG-OVRD
  7627                                    WS-IG-OVRD-AH-PL
  7628                                    WS-IG-OVRD-LF-PL
  7629                                    WS-IG-OVRD-AH-BEN
  7630                                    WS-IG-OVRD-LF-BEN.
  7631
  7632******************************************************************
  7633*************       INITIALIZE COMMON ERRORS       ***************
  7634******************************************************************
  7635
  7636     MOVE +0                     TO PB-NO-OF-ERRORS.
  7637     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7638
  7639******************************************************************
  7640
  7641     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7642     SET JULIAN-TO-BIN           TO TRUE.
  7643*    MOVE 5                      TO DC-OPTION-CODE.
  7644     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7645     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7646
  7647     MOVE ZERO                   TO  SUB4.
  7648
  7649 0040-INITIALIZE-GA-BILL-DT.
  7650
  7651     ADD +1                      TO  SUB4.
  7652
  7653     IF  SUB4 GREATER THAN +5
  7654         GO TO 0050-CHECK-CNTL-FOUND.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 142
* EL050.cbl
  7655
  7656     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7657         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7658
  7659     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7660
  7661 0050-CHECK-CNTL-FOUND.
  7662
  7663     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7664        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7665                                         WS-AH-REM-TERM-CALC
  7666                                         EC-CO-REM-TERM-CALC
  7667        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7668        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7669        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7670                                         WS-TOL-AH-CLAIM
  7671        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7672                                         WS-TOL-AH-PREM
  7673                                         EC-CO-TOL-PREM
  7674        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7675                                         WS-TOL-AH-REFUND
  7676                                         EC-CO-TOL-REFUND
  7677        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7678                                         WS-AH-REFUND-OVS-AMT
  7679                                         EC-CO-OVR-SHT-AMT
  7680        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7681                                         WS-TOL-AH-PREM-PCT
  7682                                         EC-CO-TOL-PREM-PCT
  7683        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7684                                         WS-TOL-AH-REFUND-PCT
  7685                                         EC-CO-TOL-REFUND-PCT
  7686        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7687                                         WS-AH-REFUND-OVS-PCT
  7688                                         EC-CO-OVR-SHT-PCT
  7689        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7690        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7691        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7692        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7693        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7694        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7695        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7696        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7697        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7698        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7699        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7700        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7701                                         EC-CO-MONTH-END-DT
  7702        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7703          GO TO 0100-READ-ACCT.
  7704
  7705     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7706     MOVE SPACES                 TO CNTL-ACCESS.
  7707     MOVE '1'                    TO CNTL-REC-TYPE.
  7708     MOVE +0                     TO CNTL-SEQ-NO.
  7709
  7710     MOVE '1' TO RC-SW-1.
  7711     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7712     IF NOT CF-COMPANY-MASTER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 143
* EL050.cbl
  7713         MOVE ZEROS             TO WK-CO-TOL-PREM
  7714                                   WK-CO-TOL-CLAIM
  7715                                   WK-CO-TOL-REFUND
  7716                                   WK-REFUND-OVS-AMT
  7717                                   WK-REFUND-OVS-PCT
  7718                                   WK-CO-TOL-PREM-PCT
  7719                                   WK-CO-TOL-REFUND-PCT
  7720                                   WK-DEFAULT-APR
  7721                                   WK-CO-MAX-CAP
  7722        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7723                                   WK-CR-R78-METHOD
  7724                                   WK-CO-REF-REJECT-SW
  7725                                   WK-CO-PREM-REJECT-SW
  7726                                   WK-REM-TRM-CALC-OPTION
  7727                                   WK-BIRTH-DATE-INPUT
  7728                                   WK-JOINT-AGE-INPUT
  7729        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7730        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7731        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7732        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7733          GO TO 0099-COMPANY-NOT-FOUND.
  7734
  7735     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7736        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7737     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7738        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7739     IF CF-CO-TOL-CAP NOT NUMERIC
  7740        MOVE +0                    TO CF-CO-TOL-CAP.
  7741     IF CF-DEFAULT-APR NOT NUMERIC
  7742        MOVE +0                    TO CF-DEFAULT-APR.
  7743
  7744     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7745     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7746     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7747     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7748     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7749     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7750     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7751     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7752     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7753     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7754     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7755     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7756
  7757     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7758          CF-CO-OVR-SHT-AMT > +0
  7759        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7760
  7761     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7762          CF-CO-OVR-SHT-PCT > +0
  7763        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7764
  7765     IF CF-VALID-REM-TRM-OPTION
  7766         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7767     ELSE
  7768         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7769
  7770     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 144
* EL050.cbl
  7771     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7772     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7773     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7774
  7775     GO TO 0050-CHECK-CNTL-FOUND.
  7776
  7777 0099-COMPANY-NOT-FOUND.
  7778
  7779     MOVE ER-2616                TO WS-ERROR.
  7780     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7781
  7782 0100-READ-ACCT.
  7783
  7784     MOVE SPACES                 TO DATE-RANGE-SW.
  7785
  7786     IF WK-ACCT-ADDR = ZEROS
  7787        GO TO 0102-ACCT-GETMAIN.
  7788
  7789     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7790     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7791     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7792
  7793     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7794        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7795        GO TO 0105-READ-ACCT
  7796     END-IF
  7797
  7798     IF PB-CARRIER NOT = SPACES
  7799        IF PB-CARRIER NOT = AM-VG-CARRIER
  7800           GO TO 0105-READ-ACCT.
  7801
  7802     IF PB-STATE NOT = SPACES
  7803        IF PB-STATE NOT = AM-VG-STATE
  7804           GO TO 0105-READ-ACCT.
  7805
  7806     IF PB-GROUPING NOT = SPACES
  7807        IF PB-GROUPING NOT = AM-VG-GROUPING
  7808           GO TO 0105-READ-ACCT.
  7809
  7810     MOVE 'X'                 TO DATE-RANGE-SW.
  7811
  7812     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7813        MOVE 'X'                 TO DATE-RANGE-SW
  7814        GO TO 0105-READ-ACCT.
  7815
  7816     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7817        GO TO 0105-READ-ACCT.
  7818
  7819     GO TO 0180-ACCOUNT-FOUND.
  7820
  7821 0102-ACCT-GETMAIN.
  7822     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7823     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7824
  7825 0105-READ-ACCT.
  7826     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7827     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7828     MOVE PB-GROUPING            TO ACCT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 145
* EL050.cbl
  7829     MOVE PB-STATE               TO ACCT-STATE.
  7830     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7831     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7832
  7833     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7834
  7835     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7836
  7837 0110-FIND-ACCT-TOLERANCES-LOOP.
  7838     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7839
  7840     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7841        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7842        GO TO 0199-ACCT-NOT-FOUND
  7843     END-IF
  7844     IF PB-CARRIER NOT = SPACES
  7845        IF PB-CARRIER NOT = AM-VG-CARRIER
  7846           GO TO 0199-ACCT-NOT-FOUND.
  7847
  7848     IF PB-STATE NOT = SPACES
  7849        IF PB-STATE NOT = AM-VG-STATE
  7850           GO TO 0199-ACCT-NOT-FOUND.
  7851
  7852     IF PB-GROUPING NOT = SPACES
  7853        IF PB-GROUPING NOT = AM-VG-GROUPING
  7854           GO TO 0199-ACCT-NOT-FOUND.
  7855
  7856     MOVE 'X'                    TO DATE-RANGE-SW.
  7857
  7858     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7859        MOVE 'X'                 TO DATE-RANGE-SW
  7860        GO TO 0199-ACCT-NOT-FOUND.
  7861
  7862     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7863        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7864
  7865 0180-ACCOUNT-FOUND.
  7866     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7867     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7868     MOVE AM-STATE               TO PB-SV-STATE.
  7869     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7870
  7871     IF AM-CANCEL-FEE  NOT NUMERIC
  7872        MOVE ZEROS TO AM-CANCEL-FEE.
  7873
  7874     IF AM-MAX-MON-BEN NOT NUMERIC
  7875        MOVE ZEROS TO AM-MAX-MON-BEN.
  7876
  7877     IF AM-MAX-TOT-BEN NOT NUMERIC
  7878        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7879
  7880     IF AM-CLP-TOL-PCT NOT NUMERIC
  7881        MOVE +0                  TO AM-CLP-TOL-PCT
  7882     END-IF
  7883     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7884        MOVE +0                  TO AM-SPP-LEASE-COMM
  7885     END-IF
  7886     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 146
* EL050.cbl
  7887        MOVE ER-2611             TO   WS-ERROR
  7888        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7889
  7890     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7891        MOVE ER-2621             TO   WS-ERROR
  7892        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7893
  7894     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7895        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7896        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7897        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7898         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7899
  7900     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7901     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7902     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7903     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7904     IF AM-CLP-TOL-PCT NOT = ZEROS
  7905        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7906     END-IF
  7907     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7908        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7909     END-IF
  7910*    IF PB-COMPANY-ID = 'DCC'
  7911*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7912*                                   WS-ADMIN-FEES
  7913*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7914*          (SUB5 > +10)
  7915*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7916*             AND (AM-A-COM (SUB5) NUMERIC)
  7917*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7918*                + (AM-A-COM (SUB5) * 1000)
  7919*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7920*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7921*                + (AM-A-COM (SUB5) * 1000)
  7922*             END-IF
  7923*             IF AM-COM-TYP (SUB5) = 'N'
  7924*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7925*                + (AM-A-COM (SUB5) * 1000)
  7926*             END-IF
  7927*          END-IF
  7928*       END-PERFORM
  7929*    END-IF
  7930     IF (PB-COMPANY-ID = 'DCC')
  7931        AND (PB-ISSUE)
  7932        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7933        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7934           (SUB5 > +10)
  7935           MOVE +0 TO WS-WK-RATE
  7936           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7937              IF (AM-A-COM (SUB5) NUMERIC)
  7938                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7939                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7940              ELSE
  7941                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7942                 IF PB-ISSUE
  7943                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7944                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 147
* EL050.cbl
  7945                 ELSE
  7946                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7947                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7948                 END-IF
  7949                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7950                 MOVE ZEROS             TO WS-SUB1
  7951                                           WS-COMMISSION
  7952                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7953                 MOVE '0530'               TO CTBL-SW
  7954                 MOVE ' '                  TO WS-CTBL-READ-SW
  7955                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7956                 IF FIRST-TIME-THROUGH
  7957                    MOVE 'AA'              TO CTBL-BEN-CODE
  7958                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7959                 END-IF
  7960                 IF CTBL-TABLE-FOUND
  7961                    IF PB-ISSUE
  7962                       COMPUTE WS-COMM-CK-AMT =
  7963                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7964                    ELSE
  7965                       COMPUTE WS-COMM-CK-AMT =
  7966                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7967                    END-IF
  7968                    PERFORM 8800-GET-COMP-RATE
  7969                              THRU 8800-EXIT
  7970                 END-IF
  7971              END-IF
  7972              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7973                + (WS-WK-RATE * 1000)
  7974           END-IF
  7975        END-PERFORM
  7976     END-IF
  7977     IF PB-COMPANY-ID EQUAL 'CRI'
  7978         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7979
  7980     IF PB-COMPANY-ID EQUAL 'NCL'
  7981         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7982     END-IF
  7983
  7984     GO TO 0200-READ-CERT.
  7985
  7986 0199-ACCT-NOT-FOUND.
  7987
  7988     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7989
  7990     IF DATE-RANGE-SW NOT = SPACES
  7991        MOVE ER-2601             TO WS-ERROR
  7992        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7993     ELSE
  7994        MOVE ER-2619             TO WS-ERROR
  7995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7996
  7997     GO TO 9990-RETURN.
  7998
  7999 0200-READ-CERT.
  8000
  8001     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8002     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 148
* EL050.cbl
  8003     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8004     MOVE PB-SV-STATE            TO CERT-STATE.
  8005     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8006     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8007     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8008
  8009     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8010
  8011     IF CERT-WAS-NOT-FOUND
  8012        GO TO 0299-CERT-NOT-FOUND.
  8013
  8014     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8015        MOVE ER-2759             TO WS-ERROR
  8016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8017        GO TO 0298-UNLOCK-RETURN.
  8018
  8019     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8020         MOVE ER-2758            TO WS-ERROR
  8021         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8022         GO TO 0298-UNLOCK-RETURN.
  8023
  8024     IF PB-ISSUE
  8025        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8026           IF CERT-WAS-CREATED-FOR-CLAIM
  8027              NEXT SENTENCE
  8028            ELSE
  8029              MOVE ER-2626       TO WS-ERROR
  8030              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8031              GO TO 0298-UNLOCK-RETURN.
  8032
  8033     IF NOT PB-CANCELLATION
  8034        GO TO 0300-CONTINUE-EDIT.
  8035
  8036     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8037     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8038     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8039     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8040     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8041     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8042
  8043     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8044     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8045     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8046     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8047     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8048     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8049     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8050     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8051     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8052
  8053     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8054     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8055     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8056     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8057     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8058     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8059     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8060
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 149
* EL050.cbl
  8061     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8062     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8063
  8064     MOVE CM-CREDIT-INTERFACE-SW-1
  8065                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8066     MOVE CM-CREDIT-INTERFACE-SW-2
  8067                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8068
  8069     IF CM-O-B-COVERAGE
  8070         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8071
  8072     IF CM-LIVES NOT NUMERIC
  8073         MOVE ZERO                TO CM-LIVES.
  8074
  8075     IF CM-BILLED NOT NUMERIC
  8076         MOVE ZERO                TO CM-BILLED.
  8077
  8078     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8079         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8080         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8081         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8082         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8083         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8084         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8085         MOVE CM-LIVES             TO PB-CI-LIVES
  8086*The next line causes a problem with my change  I dont think it is
  8087*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8088
  8089     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8090     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8091     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8092     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8093     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8094     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8095
  8096     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8097     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8098     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8099     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8100
  8101     IF CM-LIFE-COMM-PCT NUMERIC
  8102         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8103     ELSE
  8104         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8105
  8106     IF CM-AH-COMM-PCT NUMERIC
  8107         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8108     ELSE
  8109         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8110
  8111     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8112
  8113     IF CM-LOAN-APR       NOT NUMERIC
  8114           MOVE ZERO               TO CM-LOAN-APR.
  8115
  8116     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8117           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8118
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 150
* EL050.cbl
  8119     IF CM-LOAN-TERM      NOT NUMERIC
  8120           MOVE ZERO               TO CM-LOAN-TERM.
  8121
  8122     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8123           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8124
  8125     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8126           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8127
  8128     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8129     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8130     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8131     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8132     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8133     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8134     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8135     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8136     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8137     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8138     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8139     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8140
  8141     IF CM-STATE = CM-SSN-STATE
  8142         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8143
  8144     IF CM-STATE NOT = CM-MEMB-STATE
  8145         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8146
  8147     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8148
  8149     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8150        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8151        IF CM-ADDL-CLP NOT NUMERIC
  8152           MOVE +0               TO CM-ADDL-CLP
  8153        END-IF
  8154        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8155        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8156           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8157        END-IF
  8158     END-IF
  8159     IF PB-COMPANY-ID = 'DCC'
  8160        MOVE +0                  TO WS-ADMIN-FEES
  8161                                    WS-CSO-ADMIN-FEE
  8162                                    WS-COMM-AND-MFEE
  8163                                    WS-1ST-YR-ALLOW
  8164        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8165           (SUB5 > +10)
  8166           MOVE +0 TO WS-WK-RATE
  8167           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8168              IF (AM-A-COM (SUB5) NUMERIC)
  8169                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8170                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8171              ELSE
  8172                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8173                 IF PB-ISSUE
  8174                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8175                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8176                 ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 151
* EL050.cbl
  8177                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8178                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8179                 END-IF
  8180                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8181                 MOVE ZEROS             TO WS-SUB1
  8182                                           WS-COMMISSION
  8183                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8184                 MOVE '0530'               TO CTBL-SW
  8185                 MOVE ' '                  TO WS-CTBL-READ-SW
  8186                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8187                 IF FIRST-TIME-THROUGH
  8188                    MOVE 'AA'              TO CTBL-BEN-CODE
  8189                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8190                 END-IF
  8191                 IF CTBL-TABLE-FOUND
  8192                    IF PB-ISSUE
  8193                       COMPUTE WS-COMM-CK-AMT =
  8194                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8195                    ELSE
  8196                       COMPUTE WS-COMM-CK-AMT =
  8197                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8198                    END-IF
  8199                    PERFORM 8800-GET-COMP-RATE
  8200                              THRU 8800-EXIT
  8201                 END-IF
  8202              END-IF
  8203              IF AM-COM-TYP (SUB5) = 'I'
  8204                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8205                   + (WS-WK-RATE * 1000)
  8206              END-IF
  8207              IF AM-COM-TYP (SUB5) = 'N'
  8208                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8209                   + (WS-WK-RATE * 1000)
  8210              END-IF
  8211              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8212                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8213                   + (WS-WK-RATE * 1000)
  8214              END-IF
  8215              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8216                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8217                   + (WS-WK-RATE * 1000)
  8218              END-IF
  8219           END-IF
  8220        END-PERFORM
  8221     END-IF
  8222     GO TO 0300-CONTINUE-EDIT.
  8223
  8224 0298-UNLOCK-RETURN.
  8225      PERFORM 9250-UNLOCK-RETURN
  8226      GO TO 9990-RETURN.
  8227
  8228 0299-CERT-NOT-FOUND.
  8229
  8230     MOVE '1'                     TO CERT-STATUS-SW.
  8231
  8232     IF PB-COMPANY-ID = 'UCL'
  8233         IF WS-ERROR = ER-2799
  8234             GO TO 3000-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 152
* EL050.cbl
  8235
  8236     IF NOT PB-CANCELLATION
  8237         GO TO 0300-CONTINUE-EDIT.
  8238
  8239     MOVE ER-2726                  TO  WS-ERROR.
  8240     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8241     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8242     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8243                                    PB-CI-LF-TERM
  8244                                    PB-C-LF-REM-TERM
  8245                                    PB-CI-AH-TERM
  8246                                    PB-C-AH-REM-TERM
  8247                                    PB-CI-LF-BENEFIT-CD
  8248                                    PB-CI-LF-BENEFIT-AMT
  8249                                    PB-CI-LF-ALT-BENEFIT-AMT
  8250                                    PB-CI-LF-PREMIUM-AMT
  8251                                    PB-CI-LF-ALT-PREMIUM-AMT
  8252                                    PB-CI-AH-BENEFIT-CD
  8253                                    PB-CI-AH-BENEFIT-AMT
  8254                                    PB-CI-AH-PREMIUM-AMT
  8255                                    PB-CI-PAY-FREQUENCY
  8256                                    PB-CI-LOAN-APR
  8257                                    PB-CI-LOAN-TERM
  8258                                    PB-CI-LIFE-COMMISSION
  8259                                    PB-CI-AH-COMMISSION
  8260                                    PB-CI-CURR-SEQ
  8261                                    PB-CI-AH-CANCEL-AMT
  8262                                    PB-CI-LF-CANCEL-AMT
  8263                                    PB-CI-RATE-DEV-PCT-LF
  8264                                    PB-CI-RATE-DEV-PCT-AH
  8265                                    PB-CI-EXTENTION-DAYS
  8266                                    PB-CI-TERM-IN-DAYS
  8267                                    PB-CI-LIVES
  8268                                    PB-CI-LF-CRIT-PER
  8269                                    PB-CI-AH-CRIT-PER
  8270                                    PB-CI-ADDL-CLP
  8271                                    PB-CI-DDF-IU-RATE-UP.
  8272
  8273     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8274                                    PB-CI-AH-SETTLEMENT-DT
  8275                                    PB-CI-DEATH-DT
  8276                                    PB-CI-LF-PRIOR-CANCEL-DT
  8277                                    PB-CI-AH-PRIOR-CANCEL-DT
  8278                                    PB-CI-ENTRY-DT
  8279                                    PB-CI-LF-EXPIRE-DT
  8280                                    PB-CI-AH-EXPIRE-DT
  8281                                    PB-CI-LOAN-1ST-PMT-DT.
  8282
  8283     IF ACCOUNT-MAST-FOUND
  8284        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8285        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8286
  8287     GO TO 3000-CONTINUE-EDIT.
  8288
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 153
* EL050.cbl
  8290
  8291 0300-CONTINUE-EDIT.
  8292
  8293     IF PB-ISSUE
  8294        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8295            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8296
  8297     IF PB-ISSUE
  8298        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8299            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8300
  8301     IF PB-ISSUE
  8302       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8303          (AM-NO-AH-ONLY)
  8304           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8305               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8306                   MOVE ER-2679 TO WS-ERROR
  8307                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8308
  8309     IF PB-ISSUE
  8310        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8311        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8312        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8313     ELSE
  8314        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8315        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8316        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8317
  8318     MOVE 'N'                    TO PLAN-MASTER-SW
  8319                                    PLAN-MASTER-LIFE-SW
  8320                                    FORM-MASTER-SW
  8321                                    WS-APP-CERT-SW.
  8322
  8323     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8324                                    WS-PL-TOL-LF-REFUND
  8325                                    WS-PL-REF-OVS-AMT
  8326                                    WS-PL-TOL-LF-PREM-PCT
  8327                                    WS-PL-TOL-LF-REFUND-PCT
  8328                                    WS-PL-REF-OVS-PCT
  8329                                    WS-PL-TOL-LF-CLAIM.
  8330
  8331     IF PB-COMPANY-ID = 'NCL'
  8332       IF PB-ISSUE
  8333         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8334             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8335             IF FORM-MASTER-FOUND
  8336                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8337
  8338     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8339        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8340
  8341********************** MON CODE **********************
  8342     IF PB-COMPANY-ID = 'MON'
  8343     IF PB-ISSUE
  8344     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8345        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8346             PB-I-LOAN-APR = ZERO)
  8347               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 154
* EL050.cbl
  8348******************************************************
  8349
  8350     IF PB-COMPANY-ID = 'NCL'
  8351       IF PB-ISSUE
  8352           IF FORM-MASTER-FOUND
  8353             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8354                AM-DISMBR-COVERAGE
  8355                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8356                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8357                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8358                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8359                                           PB-I-LIFE-BENEFIT-CD.
  8360
  8361     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8362
  8363     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8364         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8365         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8366         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8367         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8368         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8369           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8370             GO TO 0301-LIFE-BENEFIT-SEARCH
  8371         ELSE
  8372             NEXT SENTENCE
  8373     ELSE
  8374         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8375
  8376     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8377     MOVE '4'                    TO CNTL-REC-TYPE.
  8378     MOVE +0                     TO CNTL-SEQ-NO.
  8379     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8380
  8381     MOVE '1' TO RC-SW-2.
  8382     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8383
  8384     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8385        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8386         GO TO 0305-BENEFIT-NOT-FOUND.
  8387
  8388     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8389
  8390 0301-LIFE-BENEFIT-SEARCH.
  8391
  8392     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8393
  8394     IF NO-BENEFIT-FOUND
  8395        GO TO 0305-BENEFIT-NOT-FOUND.
  8396
  8397     IF WS-BEN-CD = '99'
  8398        GO TO 0305-BENEFIT-NOT-FOUND.
  8399
  8400     IF PB-COMPANY-ID = 'NCL'
  8401         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8402             GO TO 0304-LIFE-BENEFIT-FOUND.
  8403
  8404     MOVE +1                     TO SUB5.
  8405     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 155
* EL050.cbl
  8406
  8407* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8408* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8409     IF PB-COMPANY-ID = 'DMD'
  8410         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8411
  8412 0302-EDIT-ACCT-LF-BENEFITS.
  8413
  8414     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8415        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8416           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8417                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8418           GO TO 03XX-GET-LIFE-ERPLAN.
  8419
  8420     IF SUB5 LESS THAN +20
  8421        ADD +1                   TO SUB5
  8422        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8423
  8424     MOVE +1                     TO SUB5.
  8425
  8426     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8427        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8428
  8429 0303-EDIT-DMD-EXTRA-BENEFITS.
  8430
  8431     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8432        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8433           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8434                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8435           GO TO 03XX-GET-LIFE-ERPLAN.
  8436
  8437     IF SUB5 LESS THAN +30
  8438        ADD +1                   TO SUB5
  8439        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8440
  8441     MOVE +1                     TO SUB5.
  8442
  8443 03XX-EDIT-FOR-NINETY-LF.
  8444
  8445***************************************************************
  8446*                                                             *
  8447*    NINETY BENEFIT PLAN TYPES:                               *
  8448*                                                             *
  8449*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8450*      92 = ALL GROUP REDUCING BENEFITS                       *
  8451*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8452*      94 = ALL GROUP LEVEL BENEFITS                          *
  8453*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8454*           BENEFIT CONTROLS.                                 *
  8455*      99 = ALL BENEFITS                                      *
  8456*                                                             *
  8457***************************************************************
  8458
  8459     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8460                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8461
  8462     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8463       AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 156
* EL050.cbl
  8464        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8465        GO TO 03XX-GET-LIFE-ERPLAN.
  8466
  8467     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8468       AND
  8469        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8470        IF CF-REDUCING (SUB3)
  8471           IF (PB-I-INDV-GRP-OVRD = 'I')
  8472              OR
  8473           ((AM-IG = '1') AND
  8474           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8475              OR
  8476           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8477           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8478           (AM-IG NOT = '2'))
  8479              GO TO 03XX-GET-LIFE-ERPLAN.
  8480
  8481     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8482       AND
  8483        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8484        IF CF-REDUCING (SUB3)
  8485           IF (PB-I-INDV-GRP-OVRD = 'G')
  8486              OR
  8487           ((AM-IG = '2') AND
  8488           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8489              OR
  8490           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8491           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8492           (AM-IG NOT = '1'))
  8493              GO TO 03XX-GET-LIFE-ERPLAN.
  8494
  8495     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8496       AND
  8497        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8498        IF CF-LEVEL    (SUB3)
  8499           IF (PB-I-INDV-GRP-OVRD = 'I')
  8500              OR
  8501           ((AM-IG = '1') AND
  8502           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8503              OR
  8504           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8505           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8506            (AM-IG NOT = '2'))
  8507              GO TO 03XX-GET-LIFE-ERPLAN.
  8508
  8509     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8510       AND
  8511        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8512        IF CF-LEVEL    (SUB3)
  8513           IF (PB-I-INDV-GRP-OVRD = 'G')
  8514              OR
  8515           ((AM-IG = '2') AND
  8516           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8517              OR
  8518           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8519           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8520           (AM-IG NOT = '1'))
  8521              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 157
* EL050.cbl
  8522
  8523     IF SUB5 LESS THAN +20
  8524        ADD +1                   TO SUB5
  8525        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8526
  8527     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8528
  8529     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8530        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8531
  8532     MOVE +1                     TO SUB5.
  8533
  8534 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8535
  8536     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8537                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8538
  8539     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8540       AND
  8541        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8542        GO TO 03XX-GET-LIFE-ERPLAN.
  8543
  8544     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8545       AND
  8546        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8547        IF CF-REDUCING (SUB3)
  8548           IF (PB-I-INDV-GRP-OVRD = 'I')
  8549              OR
  8550           ((AM-IG = '1') AND
  8551           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8552              OR
  8553           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8554           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8555           (AM-IG NOT = '2'))
  8556              GO TO 03XX-GET-LIFE-ERPLAN.
  8557
  8558     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8559       AND
  8560        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8561        IF CF-REDUCING (SUB3)
  8562           IF (PB-I-INDV-GRP-OVRD = 'G')
  8563              OR
  8564           ((AM-IG = '2') AND
  8565           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8566              OR
  8567           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8568           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8569           (AM-IG NOT = '1'))
  8570              GO TO 03XX-GET-LIFE-ERPLAN.
  8571
  8572     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8573       AND
  8574        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8575        IF CF-LEVEL    (SUB3)
  8576           IF (PB-I-INDV-GRP-OVRD = 'I')
  8577              OR
  8578           ((AM-IG = '1') AND
  8579           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 158
* EL050.cbl
  8580              OR
  8581           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8582           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8583            (AM-IG NOT = '2'))
  8584              GO TO 03XX-GET-LIFE-ERPLAN.
  8585
  8586     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8587       AND
  8588        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8589        IF CF-LEVEL    (SUB3)
  8590           IF (PB-I-INDV-GRP-OVRD = 'G')
  8591              OR
  8592           ((AM-IG = '2') AND
  8593           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8594              OR
  8595           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8596           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8597           (AM-IG NOT = '1'))
  8598              GO TO 03XX-GET-LIFE-ERPLAN.
  8599
  8600     IF SUB5 LESS THAN +30
  8601        ADD +1                   TO SUB5
  8602        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8603
  8604     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8605
  8606 03XX-EDIT-FOR-NINETY-LF-CONT.
  8607
  8608     MOVE +99                    TO SUB5.
  8609
  8610     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8611        IF PB-ISSUE
  8612           MOVE ER-1924          TO  WS-ERROR
  8613           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8614
  8615     GO TO 0304-LIFE-BENEFIT-FOUND.
  8616
  8617 03XX-GET-LIFE-ERPLAN.
  8618
  8619     IF WK-PLAN-ADDR EQUAL +0
  8620        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8621
  8622     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8623     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8624     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8625     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8626     MOVE 'Y'                    TO PLAN-MASTER-SW
  8627                                    PLAN-MASTER-LIFE-SW.
  8628     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8629
  8630 03XX-ERPLAN-LIFE-GETMAIN.
  8631
  8632     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8633     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8634
  8635 03XX-ERPLAN-LIFE-READ.
  8636
  8637     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 159
* EL050.cbl
  8638     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8639     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8640     MOVE PB-SV-STATE            TO PLAN-STATE.
  8641     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8642     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8643     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8644     MOVE WS-SAVE-BENEFIT-REVISION
  8645                                 TO PLAN-REVISION-NO.
  8646
  8647     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8648     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8649
  8650     IF PB-COMPANY-ID = 'NCL'
  8651       IF NOT LF-PLAN-MASTER-FOUND
  8652         IF NOT PB-POLICY-IS-DECLINED  AND
  8653            NOT PB-POLICY-IS-VOIDED
  8654             MOVE  ER-1921         TO  WS-ERROR
  8655             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8656             GO TO 0304-LIFE-BENEFIT-FOUND.
  8657
  8658     IF NOT LF-PLAN-MASTER-FOUND
  8659        GO TO 0304-LIFE-BENEFIT-FOUND.
  8660
  8661 XXXX-CHECK-LF-PLAN-KEY.
  8662
  8663     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8664        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8665        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8666        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8667        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8668        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8669        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8670        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8671        MOVE 'N'                 TO PLAN-MASTER-SW
  8672          GO TO 03XX-ERPLAN-LIFE-READ.
  8673
  8674     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8675
  8676     IF  PB-CANCELLATION
  8677         GO TO  0303-LF-ACCT-BEN-FOUND.
  8678
  8679     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8680        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8681           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8682           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8683              MOVE ER-2644             TO WS-ERROR
  8684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8685           ELSE
  8686              NEXT SENTENCE
  8687        ELSE
  8688           IF PB-COMPANY-ID NOT = 'NCL'
  8689              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8690                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8691
  8692 0303-LF-ACCT-BEN-FOUND.
  8693
  8694     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8695
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 160
* EL050.cbl
  8696     IF PL-DEV-CODE NOT = SPACES
  8697        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8698
  8699     IF PL-DEV-PCT NUMERIC AND
  8700        PL-DEV-PCT NOT = ZEROS
  8701        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8702
  8703     IF PL-TOL-PREM-AMT GREATER THAN +0
  8704        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8705
  8706     IF PL-TOL-REF-AMT GREATER THAN +0
  8707        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8708
  8709     IF PL-TOL-PREM-PCT GREATER THAN +0
  8710        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8711
  8712     IF PL-TOL-REF-PCT GREATER THAN +0
  8713        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8714
  8715     IF PL-TOL-CLM-AMT GREATER THAN +0
  8716        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8717
  8718     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8719                          PL-OVER-SHORT-AMT > +0
  8720        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8721
  8722     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8723                          PL-OVER-SHORT-PCT > +0
  8724        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8725
  8726     IF PL-SALES-TAX NUMERIC AND
  8727                          PL-SALES-TAX > +0
  8728         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8729
  8730     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8731        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8732                                    WS-IG-OVRD-AM.
  8733
  8734 0304-LIFE-BENEFIT-FOUND.
  8735
  8736     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8737
  8738     IF PB-ISSUE
  8739        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8740     ELSE
  8741        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8742
  8743     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8744     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8745     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8746     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8747     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8748                                         WS-LF-REFUND-CALC.
  8749
  8750     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8751        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8752
  8753     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 161
* EL050.cbl
  8754        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8755     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8756
  8757     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8758     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8759     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8760     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8761     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8762     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8763
  8764     IF PB-COMPANY-ID = 'NCL'  AND
  8765        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8766         NEXT SENTENCE
  8767     ELSE
  8768         IF SUB5 NOT GREATER THAN +20
  8769            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8770               MOVE WS-SAVE-BENEFIT-REM-TERM
  8771                                      TO WS-AM-LF-BENE-REM-TERM
  8772                                         EC-BR-LF-REM-TERM-CALC.
  8773
  8774     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8775     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8776
  8777     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8778
  8779 0305-BENEFIT-NOT-FOUND.
  8780
  8781     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8782     MOVE ER-2604                TO WS-ERROR.
  8783     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8784
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 162
* EL050.cbl
  8786
  8787 0310-FIND-AH-BENEFIT-RECORD.
  8788
  8789     MOVE 'N'                    TO PLAN-MASTER-SW
  8790                                    PLAN-MASTER-AH-SW.
  8791
  8792     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8793                                    WS-PL-TOL-AH-REFUND
  8794                                    WS-AH-PL-REF-OVS-AMT
  8795                                    WS-PL-TOL-AH-PREM-PCT
  8796                                    WS-PL-TOL-AH-REFUND-PCT
  8797                                    WS-AH-PL-REF-OVS-PCT
  8798                                    WS-PL-TOL-AH-CLAIM.
  8799     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8800
  8801
  8802     if pb-issue
  8803        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8804           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8805        end-if
  8806        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8807           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8808           GO TO 0399-BENEFIT-NOT-FOUND
  8809        end-if
  8810     end-if
  8811
  8812     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8813        GO TO 0400-FIND-CARRIER.
  8814
  8815     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8816
  8817     IF WK-AH-BEN-ADDR NOT = ZEROS
  8818         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8819         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8820         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8821         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8822           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8823             GO TO 0311-AH-BENEFIT-SEARCH
  8824         ELSE
  8825             NEXT SENTENCE
  8826     ELSE
  8827         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8828
  8829     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8830     MOVE '5'                    TO CNTL-REC-TYPE.
  8831     MOVE +0                     TO CNTL-SEQ-NO.
  8832     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8833
  8834     MOVE '2' TO RC-SW-2.
  8835     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8836
  8837     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8838        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8839          GO TO 0399-BENEFIT-NOT-FOUND.
  8840
  8841     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8842
  8843 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 163
* EL050.cbl
  8844
  8845     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8846
  8847     IF NO-BENEFIT-FOUND
  8848         GO TO 0399-BENEFIT-NOT-FOUND.
  8849
  8850     IF WS-BEN-CD = '99'
  8851        GO TO 0399-BENEFIT-NOT-FOUND.
  8852
  8853     IF PB-COMPANY-ID  =  'NCL'
  8854         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8855             GO TO 0314-A-H-BENEFIT-FOUND.
  8856
  8857     MOVE +1                     TO SUB5.
  8858     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8859
  8860* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8861* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8862     IF PB-COMPANY-ID = 'DMD'
  8863         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8864
  8865 0312-EDIT-ACCT-AH-BENEFITS.
  8866
  8867     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8868        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8869           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8870                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8871           GO TO 03XX-GET-AH-ERPLAN.
  8872
  8873     IF SUB5 LESS THAN +20
  8874        ADD +1                   TO SUB5
  8875        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8876
  8877     MOVE +1                     TO SUB5.
  8878
  8879     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8880        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8881
  8882 0313-EDIT-DMD-EXTRA-BENEFITS.
  8883
  8884     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8885        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8886           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8887                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8888           GO TO 03XX-GET-AH-ERPLAN.
  8889
  8890     IF SUB5 LESS THAN +30
  8891        ADD +1                   TO SUB5
  8892        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8893
  8894     MOVE +1                     TO SUB5.
  8895
  8896 03XX-EDIT-FOR-NINETY-AH.
  8897
  8898***************************************************************
  8899*                                                             *
  8900*    NINETY BENEFIT PLAN TYPES:                               *
  8901*                                                             *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 164
* EL050.cbl
  8902*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8903*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8904*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8905*           BENEFIT CONTROLS.                                 *
  8906*      99 = ALL BENEFITS.                                     *
  8907*                                                             *
  8908***************************************************************
  8909
  8910     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8911                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8912
  8913     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8914       AND
  8915        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8916        GO TO 03XX-GET-AH-ERPLAN.
  8917
  8918     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8919       AND
  8920        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8921           IF (PB-I-INDV-GRP-OVRD = 'I')
  8922              OR
  8923           ((AM-IG = '1') AND
  8924           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8925              OR
  8926           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8927           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8928           (AM-IG NOT = '2'))
  8929              GO TO 03XX-GET-AH-ERPLAN.
  8930
  8931     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8932       AND
  8933        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8934           IF (PB-I-INDV-GRP-OVRD = 'G')
  8935              OR
  8936           ((AM-IG = '2') AND
  8937           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8938              OR
  8939           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8940           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8941           (AM-IG NOT = '1'))
  8942              GO TO 03XX-GET-AH-ERPLAN.
  8943
  8944     IF SUB5 LESS THAN +20
  8945        ADD +1                   TO SUB5
  8946        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8947
  8948     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8949        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8950
  8951     MOVE +1                    TO SUB5.
  8952
  8953 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8954
  8955     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8956                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8957
  8958     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8959       AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 165
* EL050.cbl
  8960        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8961        GO TO 03XX-GET-AH-ERPLAN.
  8962
  8963     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8964       AND
  8965        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8966           IF (PB-I-INDV-GRP-OVRD = 'I')
  8967              OR
  8968           ((AM-IG = '1') AND
  8969           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8970              OR
  8971           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8972           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8973           (AM-IG NOT = '2'))
  8974              GO TO 03XX-GET-AH-ERPLAN.
  8975
  8976     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8977       AND
  8978        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8979           IF (PB-I-INDV-GRP-OVRD = 'G')
  8980              OR
  8981           ((AM-IG = '2') AND
  8982           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8983              OR
  8984           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8985           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8986           (AM-IG NOT = '1'))
  8987              GO TO 03XX-GET-AH-ERPLAN.
  8988
  8989     IF SUB5 LESS THAN +30
  8990        ADD +1                   TO SUB5
  8991        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8992
  8993 03XX-EDIT-FOR-NINETY-AH-CONT.
  8994
  8995     MOVE +99                    TO SUB5.
  8996
  8997     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8998
  8999     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9000        IF PB-ISSUE
  9001           MOVE ER-1925          TO  WS-ERROR
  9002           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9003
  9004     GO TO 0314-A-H-BENEFIT-FOUND.
  9005
  9006 03XX-GET-AH-ERPLAN.
  9007
  9008     IF WK-PLAN-ADDR EQUAL +0
  9009         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9010
  9011     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9012     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9013     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9014     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9015     MOVE 'Y'                    TO PLAN-MASTER-SW
  9016                                    PLAN-MASTER-AH-SW.
  9017*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 166
* EL050.cbl
  9018     GO TO 03XX-ERPLAN-AH-READ.
  9019
  9020 03XX-ERPLAN-AH-GETMAIN.
  9021
  9022     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9023     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9024
  9025 03XX-ERPLAN-AH-READ.
  9026
  9027     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9028     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9029     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9030     MOVE PB-SV-STATE            TO PLAN-STATE.
  9031     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9032     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9033     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9034     MOVE WS-SAVE-BENEFIT-REVISION
  9035                                 TO PLAN-REVISION-NO.
  9036
  9037     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9038     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9039
  9040     IF PB-COMPANY-ID = 'NCL'
  9041       IF NOT AH-PLAN-MASTER-FOUND
  9042         IF NOT PB-POLICY-IS-DECLINED  AND
  9043            NOT PB-POLICY-IS-VOIDED
  9044             MOVE  ER-1922         TO  WS-ERROR
  9045             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9046             GO TO 0314-A-H-BENEFIT-FOUND.
  9047
  9048     IF NOT AH-PLAN-MASTER-FOUND
  9049        GO TO 0314-A-H-BENEFIT-FOUND.
  9050
  9051 XXXX-CHECK-AH-PLAN-KEY.
  9052
  9053     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9054        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9055        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9056        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9057        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9058        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9059        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9060        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9061        MOVE 'N'                 TO PLAN-MASTER-SW
  9062          GO TO 03XX-ERPLAN-AH-READ.
  9063
  9064     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9065
  9066     IF  PB-CANCELLATION
  9067         GO TO  0313-AH-ACCT-BEN-FOUND.
  9068
  9069     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9070       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9071          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9072          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9073             MOVE ER-2644             TO WS-ERROR
  9074             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9075          ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 167
* EL050.cbl
  9076             NEXT SENTENCE
  9077       ELSE
  9078          IF PB-COMPANY-ID NOT = 'NCL'
  9079             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9080                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9081
  9082 0313-AH-ACCT-BEN-FOUND.
  9083
  9084     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9085
  9086     IF PL-DEV-CODE NOT = SPACES
  9087        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9088
  9089     IF PL-DEV-PCT NUMERIC AND
  9090        PL-DEV-PCT NOT = ZEROS
  9091        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9092
  9093     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9094        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9095
  9096     IF PL-TOL-REF-AMT NOT EQUAL +0
  9097        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9098
  9099     IF PL-TOL-PREM-PCT GREATER THAN +0
  9100        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9101
  9102     IF PL-TOL-REF-PCT GREATER THAN +0
  9103        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9104
  9105     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9106        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9107
  9108     IF PL-OVER-SHORT-AMT NUMERIC AND
  9109                          PL-OVER-SHORT-AMT > +0
  9110        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9111
  9112     IF PL-OVER-SHORT-PCT NUMERIC AND
  9113                          PL-OVER-SHORT-PCT > +0
  9114        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9115
  9116     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9117        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9118        IF WS-IG-OVRD-AM EQUAL SPACES
  9119            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9120
  9121 0314-A-H-BENEFIT-FOUND.
  9122
  9123     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9124
  9125     IF PB-ISSUE
  9126        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9127       ELSE
  9128        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9129
  9130     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9131     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9132     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9133     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 168
* EL050.cbl
  9134                                         WS-AH-REFUND-CALC.
  9135
  9136     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9137        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9138
  9139     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9140        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9141     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9142
  9143     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9144     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9145     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9146     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9147     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9148     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9149
  9150     IF PB-COMPANY-ID = 'NCL'  AND
  9151        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9152         NEXT SENTENCE
  9153     ELSE
  9154         IF SUB5 NOT GREATER THAN +20
  9155            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9156                MOVE WS-SAVE-BENEFIT-REM-TERM
  9157                                      TO WS-AM-AH-BENE-REM-TERM
  9158                                         EC-BR-AH-REM-TERM-CALC.
  9159
  9160     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9161     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9162
  9163     GO TO 0400-FIND-CARRIER.
  9164
  9165 0399-BENEFIT-NOT-FOUND.
  9166
  9167     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9168     MOVE ER-2605                TO WS-ERROR.
  9169     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9170
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 169
* EL050.cbl
  9172
  9173 0400-FIND-CARRIER.
  9174
  9175     MOVE PB-SV-CARRIER          TO WS-CARR.
  9176
  9177     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9178     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9179     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9180     MOVE '6'                    TO CNTL-REC-TYPE.
  9181
  9182*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9183     MOVE SPACE                  TO WS-DMD-RATING-SW
  9184                                    EC-BR-DMD-RATING-SW.
  9185
  9186     MOVE '2'                    TO RC-SW-1.
  9187     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9188
  9189     IF NOT CF-CARRIER-MASTER
  9190        GO TO 0400-CARRIER-NOT-FOUND.
  9191
  9192 0400-BUILD-CARR-TOL.
  9193
  9194     IF CF-CR-TOL-PREM NUMERIC AND
  9195        CF-CR-TOL-PREM GREATER THAN +0
  9196        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9197                                    WS-TOL-AH-PREM.
  9198
  9199     IF CF-CR-TOL-REFUND NUMERIC AND
  9200        CF-CR-TOL-REFUND GREATER THAN +0
  9201        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9202                                    WS-TOL-AH-REFUND.
  9203
  9204     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9205        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9206        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9207                                    WS-AH-REFUND-OVS-AMT.
  9208
  9209     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9210        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9211        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9212                                    WS-AH-REFUND-OVS-PCT.
  9213
  9214     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9215        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9216        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9217                                    WS-TOL-AH-PREM-PCT.
  9218
  9219     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9220        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9221        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9222                                     WS-TOL-AH-REFUND-PCT.
  9223
  9224     IF CF-COMPANY-ID EQUAL 'DMD'
  9225         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9226                                    EC-BR-DMD-RATING-SW.
  9227
  9228     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9229     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 170
* EL050.cbl
  9230        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9231     END-IF
  9232     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9233        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9234     END-IF
  9235     IF WS-TOL-CLP-PCT = ZEROS
  9236        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9237     END-IF
  9238
  9239     IF WS-SPP-LEASE-COMM = ZEROS
  9240        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9241     END-IF
  9242     GO TO 0400-FIND-ERPDEF.
  9243
  9244 0400-CARRIER-NOT-FOUND.
  9245
  9246     MOVE ER-2602                TO WS-ERROR.
  9247     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9248
  9249 0400-FIND-ERPDEF.
  9250     IF PB-COMPANY-ID = 'DCC'
  9251        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9252        CONTINUE
  9253     ELSE
  9254        GO TO 0400-FIND-ERCOMP
  9255     END-IF
  9256     MOVE ' '                    TO PDEF-MASTER-SW
  9257     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9258     MOVE PB-STATE               TO ERPDEF-STATE
  9259     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9260     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9261     IF PB-ISSUE
  9262        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9263     ELSE
  9264        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9265     END-IF
  9266     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9267     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9268     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9269     IF PDEF-MASTER-FOUND
  9270        MOVE 'N'                 TO PDEF-MASTER-SW
  9271        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9272        IF PDEF-MASTER-FOUND
  9273           IF (ERPDEF-KEY-SAVE (1:16) =
  9274                        PD-CONTROL-PRIMARY (1:16))
  9275              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9276              CONTINUE
  9277           ELSE
  9278              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9279              IF (ERPDEF-KEY-SAVE (1:16) =
  9280                        PD-CONTROL-PRIMARY (1:16))
  9281                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9282                 CONTINUE
  9283              ELSE
  9284                 MOVE 'N'        TO PDEF-MASTER-SW
  9285              END-IF
  9286           END-IF
  9287        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 171
* EL050.cbl
  9288        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9289     END-IF
  9290     IF PDEF-MASTER-FOUND
  9291        IF PD-TRUNCATED = 'Y'
  9292           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9293        END-IF
  9294     END-IF
  9295     .
  9296 0400-FIND-ERCOMP.
  9297     IF PB-COMPANY-ID = 'DCC'
  9298        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9299           (WS-SUB1 > +10)
  9300           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9301                 OR 'A' OR 'N'
  9302              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9303              MOVE PB-CARRIER    TO COMP-CARRIER
  9304              MOVE PB-GROUPING   TO COMP-GROUPING
  9305              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9306              MOVE AM-AGT (WS-SUB1)
  9307                                 TO COMP-FIN-RESP
  9308              MOVE 'G'           TO COMP-TYPE
  9309              PERFORM 8582-READ-COMPENSATION-MASTER
  9310                                 THRU 8582-EXIT
  9311              IF COMP-MASTER-FOUND
  9312                 IF CO-GA-INACTIVE
  9313                    MOVE ER-2763 TO WS-ERROR
  9314                    PERFORM 9900-ERROR-FORMAT
  9315                                 THRU 9900-EXIT
  9316                    MOVE +11     TO WS-SUB1
  9317                 END-IF
  9318                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9319                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9320                    MOVE ER-2788 TO WS-ERROR
  9321                    PERFORM 9900-ERROR-FORMAT
  9322                                 THRU 9900-EXIT
  9323                    MOVE +11     TO WS-SUB1
  9324                 END-IF
  9325              END-IF
  9326           END-IF
  9327        END-PERFORM
  9328     END-IF
  9329     IF PB-COMPANY-ID = 'DCC'
  9330        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9331           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9332                                    WS-CLP-STATE
  9333        ELSE
  9334           MOVE SPACES           TO PB-I-CLP-STATE
  9335                                    WS-CLP-STATE
  9336        END-IF
  9337     END-IF
  9338
  9339     IF (PB-COMPANY-ID = 'DCC')
  9340        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9341        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9342        CONTINUE
  9343     ELSE
  9344        GO TO 0400-FIND-STATE-RECORD
  9345     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 172
* EL050.cbl
  9346     MOVE SPACES                 TO WS-CLP-STATE
  9347     MOVE +0                     TO WS-BANK-FEE
  9348                                    WS-BANK-LFEE
  9349                                    WS-BANK-NOCHRGB
  9350
  9351     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9352     IF (PB-ISSUE)
  9353        AND (PB-I-BANK-NUMBER NOT =
  9354            SPACES AND ZEROS AND LOW-VALUES)
  9355        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9356     ELSE
  9357        IF (PB-CANCELLATION)
  9358           AND (PB-CI-BANK-NUMBER NOT =
  9359                SPACES AND ZEROS AND LOW-VALUES)
  9360           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9361        END-IF
  9362     END-IF
  9363     IF COMP-FIN-RESP NOT = LOW-VALUES
  9364        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9365        MOVE PB-CARRIER          TO COMP-CARRIER
  9366        MOVE PB-GROUPING         TO COMP-GROUPING
  9367        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9368        MOVE 'B'                 TO COMP-TYPE
  9369        PERFORM 8582-READ-COMPENSATION-MASTER
  9370                                 THRU 8582-EXIT
  9371        IF COMP-MASTER-FOUND
  9372           IF CO-MAX-BANK-FEE NOT NUMERIC
  9373              MOVE +0            TO CO-MAX-BANK-FEE
  9374           END-IF
  9375           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9376              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9377           END-IF
  9378           IF CO-GA-INACTIVE
  9379              MOVE ER-2763       TO WS-ERROR
  9380              PERFORM 9900-ERROR-FORMAT
  9381                                 THRU 9900-EXIT
  9382           END-IF
  9383           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9384              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9385              MOVE ER-2788 TO WS-ERROR
  9386              PERFORM 9900-ERROR-FORMAT
  9387                                 THRU 9900-EXIT
  9388              MOVE +11     TO WS-SUB1
  9389           END-IF
  9390           IF WS-AH-BEN-CATEGORY = 'G'
  9391              MOVE CO-MAX-BANK-FEE
  9392                                 TO WS-BANK-FEE
  9393                                    PB-I-BANK-FEE
  9394           ELSE
  9395              MOVE CO-MAX-BANK-FEE-LEASE
  9396                                 TO WS-BANK-LFEE
  9397                                    PB-I-BANK-FEE
  9398           END-IF
  9399           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9400              AND (WS-AH-REFUND-CALC = 'G'))
  9401                        OR
  9402              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9403              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 173
* EL050.cbl
  9404              CONTINUE
  9405           ELSE
  9406              MOVE ER-2789 TO WS-ERROR
  9407              PERFORM 9900-ERROR-FORMAT
  9408                                 THRU 9900-EXIT
  9409           END-IF
  9410           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9411                                    PB-I-CLP-STATE
  9412           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9413           MOVE CO-CARRIER       TO BXRF-CARRIER
  9414           MOVE CO-GROUPING      TO BXRF-GROUPING
  9415           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9416           MOVE BXRF-MAX-REC-LENGTH
  9417                                 TO BXRF-REC-LENGTH
  9418           PERFORM 8584-READ-BANK-CROSS-REF
  9419                                 THRU 8584-EXIT
  9420           IF BXRF-MASTER-FOUND
  9421              MOVE ' '           TO BANK-ACCT-SW
  9422              MOVE BK-BANK-POINTER-CNT
  9423                                 TO BK-BANK-POINTER-CNT
  9424              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9425                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9426                 OR (BANK-ACCT-FOUND)
  9427                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9428                    AND (BK-AM-EXP-DT (WS-SUB1)
  9429                                 > PB-CERT-EFF-DT)
  9430                    AND (BK-AM-EFF-DT (WS-SUB1)
  9431                                 NOT > PB-CERT-EFF-DT)
  9432                    SET BANK-ACCT-FOUND TO TRUE
  9433                 END-IF
  9434              END-PERFORM
  9435              IF NOT BANK-ACCT-FOUND
  9436                 MOVE ZEROS      TO WS-BANK-FEE
  9437                                    WS-BANK-LFEE
  9438                 MOVE ER-2869    TO WS-ERROR
  9439                 PERFORM 9900-ERROR-FORMAT
  9440                                 THRU 9900-EXIT
  9441              ELSE
  9442                 PERFORM 5000-PROCESS-REPS
  9443                                 THRU 5000-EXIT
  9444                 IF AGENT-MASTER-FOUND
  9445                    MOVE +0      TO WS-BANK-FEE
  9446                                    WS-BANK-LFEE
  9447*                   MOVE AG-SPP-FEES (1)
  9448*                                TO PB-I-BANK-FEE
  9449*                                   WS-BANK-FEE
  9450                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9451                       (WS-SUB1 > +10)
  9452                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9453                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9454                       END-IF
  9455                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9456                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9457                       END-IF
  9458                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9459                          AG-SPP-FEES (WS-SUB1)
  9460                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9461                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 174
* EL050.cbl
  9462                    END-PERFORM
  9463                    IF WS-AH-BEN-CATEGORY = 'G'
  9464                       MOVE WS-BANK-FEE
  9465                                 TO PB-I-BANK-FEE
  9466                    ELSE
  9467                       MOVE WS-BANK-LFEE
  9468                                 TO PB-I-BANK-FEE
  9469                    END-IF
  9470                 END-IF
  9471              END-IF
  9472           END-IF
  9473        ELSE
  9474           MOVE ER-2879          TO WS-ERROR
  9475           PERFORM 9900-ERROR-FORMAT
  9476                                 THRU 9900-EXIT
  9477        END-IF
  9478     ELSE
  9479        MOVE ER-2879             TO WS-ERROR
  9480        PERFORM 9900-ERROR-FORMAT
  9481                                 THRU 9900-EXIT
  9482     END-IF
  9483     IF WS-AH-BEN-CATEGORY = 'G'
  9484        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9485        + WS-BANK-FEE
  9486     ELSE
  9487        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9488        + WS-BANK-LFEE
  9489     END-IF
  9490     .
  9491 0400-FIND-STATE-RECORD.
  9492
  9493     IF WK-STATE-ADDR NOT = ZEROS
  9494         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9495         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9496         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9497         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9498         IF PB-SV-STATE = CF-STATE-CODE
  9499             GO TO 0405-CONTINUE-EDIT
  9500         ELSE
  9501             NEXT SENTENCE
  9502     ELSE
  9503         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9504
  9505     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9506     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9507     MOVE '3'                    TO CNTL-REC-TYPE.
  9508     MOVE +0                     TO CNTL-SEQ-NO.
  9509
  9510     MOVE '3'                    TO RC-SW-2.
  9511     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9512
  9513     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9514        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9515        PB-SV-STATE   NOT = CF-STATE-CODE)
  9516        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9517                                    WS-TOL-AH-CLAIM
  9518                                    WS-MINIMUM-REFUND
  9519                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 175
* EL050.cbl
  9520                                    WS-TOL-AH-PREM
  9521                                    WS-TOL-LF-REFUND
  9522                                    WS-TOL-AH-REFUND
  9523                                    EC-ST-TOL-PREM-PCT
  9524                                    WS-TOL-LF-PREM-PCT
  9525                                    WS-TOL-AH-PREM-PCT
  9526                                    EC-ST-TOL-REFUND-PCT
  9527                                    WS-TOL-LF-REFUND-PCT
  9528                                    WS-TOL-AH-REFUND-PCT
  9529                                    EC-ST-TOL-PREM
  9530                                    EC-ST-TOL-REFUND
  9531                                    EC-ST-FST-PMT-DAYS-MAX
  9532                                    WS-FREE-LOOK-PERIOD
  9533                                    WS-ST-LF-PREM-TAX
  9534                                    WS-ST-AH-PREM-TAX-I
  9535                                    WS-ST-AH-PREM-TAX-G
  9536                                    WS-BANK-FEE
  9537                                    WS-BANK-LFEE
  9538                                    WS-TOL-CLP-PCT
  9539                                    WS-SPP-LEASE-COMM
  9540        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9541                                    EC-ST-FST-PMT-DAYS-CHG
  9542                                    WS-LF-REM-TERM-CALC
  9543                                    WS-LF-REFUND-CALC
  9544                                    EC-ST-LF-REM-TERM-CALC
  9545                                    EC-ST-LF-REFUND-CALC
  9546                                    WS-AH-REM-TERM-CALC
  9547                                    WS-AH-REFUND-CALC
  9548                                    WS-LF-BEN-CATEGORY
  9549                                    WS-AH-BEN-CATEGORY
  9550                                    WS-CLP-STATE
  9551                                    WS-ST-REFUND-CLAIM-FLAG
  9552                                    EC-ST-AH-REM-TERM-CALC
  9553                                    EC-ST-AH-REFUND-CALC
  9554          GO TO 0499-STATE-NOT-FOUND.
  9555
  9556     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9557
  9558 0405-CONTINUE-EDIT.
  9559
  9560     if pb-company-id = 'AHL'
  9561        continue
  9562     else
  9563        IF PB-CERT-PRIME NOT NUMERIC
  9564           MOVE ER-2722          TO WS-ERROR
  9565           PERFORM 9900-ERROR-FORMAT
  9566                                 THRU 9900-EXIT
  9567        end-if
  9568     END-IF
  9569*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9570*       MOVE +0                  TO SUB3
  9571*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9572*       IF SUB3 > +0
  9573*          MOVE ER-2722          TO WS-ERROR
  9574*          PERFORM 9900-ERROR-FORMAT
  9575*                                THRU 9900-EXIT
  9576*       END-IF
  9577*    END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 176
* EL050.cbl
  9578*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9579*       IF PB-CERT-PRIME NOT NUMERIC
  9580*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9581*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9582*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9583*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9584*
  9585*          MOVE ER-2722          TO WS-ERROR
  9586*          PERFORM 9900-ERROR-FORMAT
  9587*                                THRU 9900-EXIT
  9588*       END-IF
  9589*    END-IF
  9590
  9591     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9592
  9593     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9594        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9595                                    WS-TOL-AH-CLAIM.
  9596
  9597     IF CF-ST-REFUND-MIN NOT NUMERIC
  9598        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9599
  9600     IF CF-ST-REFUND-MIN NOT = ZEROS
  9601        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9602
  9603     IF CF-ST-TOL-PREM  NOT = ZEROS
  9604        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9605                                    WS-TOL-AH-PREM
  9606        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9607
  9608     IF CF-ST-TOL-REFUND NOT = ZEROS
  9609        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9610                                    WS-TOL-AH-REFUND
  9611        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9612
  9613     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9614        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9615        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9616                                    WS-AH-REFUND-OVS-AMT
  9617                                    EC-ST-OVR-SHT-AMT.
  9618
  9619     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9620        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9621        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9622                                    WS-TOL-LF-PREM-PCT
  9623                                    WS-TOL-AH-PREM-PCT.
  9624
  9625     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9626        CF-ST-TOL-REF-PCT GREATER THAN +0
  9627        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9628                                    WS-TOL-LF-REFUND-PCT
  9629                                    WS-TOL-AH-REFUND-PCT.
  9630
  9631     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9632        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9633        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9634                                    WS-AH-REFUND-OVS-PCT
  9635                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 177
* EL050.cbl
  9636
  9637     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9638     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9639
  9640     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9641          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9642
  9643     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9644     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9645     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9646
  9647     IF CF-ST-LF-PREM-TAX NUMERIC
  9648        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9649     END-IF
  9650     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9651        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9652     END-IF
  9653     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9654        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9655     END-IF
  9656
  9657     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9658         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9659     END-IF.
  9660
  9661     IF WS-LF-BENEFIT-CD = ZEROS
  9662        GO TO 0410-CHECK-AH.
  9663
  9664     IF CF-ST-RT-CALC NOT = SPACES
  9665        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9666                                    EC-ST-LF-REM-TERM-CALC
  9667     END-IF
  9668
  9669     IF WS-LF-COVERAGE-TYPE = 'R'
  9670        IF WS-LF-EARNINGS-CALC = '5'
  9671           IF CF-ST-RF-LN-CALC > '0'
  9672              MOVE CF-ST-RF-LN-CALC
  9673                                 TO WS-LF-REFUND-CALC
  9674                                    EC-ST-LF-REFUND-CALC
  9675           END-IF
  9676        ELSE
  9677           IF CF-ST-RF-LR-CALC > '0'
  9678              MOVE CF-ST-RF-LR-CALC
  9679                                 TO WS-LF-REFUND-CALC
  9680                                    EC-ST-LF-REFUND-CALC
  9681           END-IF
  9682        END-IF
  9683     ELSE
  9684        IF CF-ST-RF-LL-CALC > '0'
  9685           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9686                                    EC-ST-LF-REFUND-CALC
  9687        END-IF
  9688     END-IF
  9689
  9690     IF CF-ST-RT-CALC NOT = SPACES
  9691        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9692                                    EC-ST-LF-REM-TERM-CALC
  9693     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 178
* EL050.cbl
  9694
  9695     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9696     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9697
  9698     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9699
  9700     IF NO-BENEFIT-FOUND
  9701        GO TO 0410-CHECK-AH.
  9702
  9703     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9704        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9705                                 TO EC-ST-LF-REM-TERM-CALC
  9706                                    WS-LF-REM-TERM-CALC
  9707     END-IF
  9708
  9709     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9710        MOVE CF-ST-REFUND-CALC (SUB3)
  9711                                 TO WS-LF-REFUND-CALC
  9712                                    EC-ST-LF-REFUND-CALC
  9713     END-IF
  9714*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9715
  9716     .
  9717 0410-CHECK-AH.
  9718
  9719     IF WS-AH-BENEFIT-CD = ZEROS
  9720        GO TO 0500-SET-ACCOUNT.
  9721
  9722     IF CF-ST-RT-CALC NOT = SPACES
  9723        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9724                                    EC-ST-AH-REM-TERM-CALC
  9725     END-IF
  9726
  9727     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9728        IF CF-ST-RF-CP-CALC > '0'
  9729           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9730                                    EC-ST-AH-REFUND-CALC
  9731        END-IF
  9732     ELSE
  9733        IF CF-ST-RF-AH-CALC > '0'
  9734           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9735                                    EC-ST-AH-REFUND-CALC
  9736        END-IF
  9737     END-IF
  9738     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9739     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9740
  9741     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9742
  9743     IF NO-BENEFIT-FOUND
  9744        GO TO 0500-SET-ACCOUNT.
  9745
  9746     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9747        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9748                                 TO WS-AH-REM-TERM-CALC
  9749                                    EC-ST-AH-REM-TERM-CALC
  9750     END-IF
  9751
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 179
* EL050.cbl
  9752     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9753        MOVE CF-ST-REFUND-CALC (SUB3)
  9754                                 TO WS-AH-REFUND-CALC
  9755                                    EC-ST-AH-REFUND-CALC
  9756     END-IF
  9757
  9758*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9759
  9760     GO TO 0500-SET-ACCOUNT.
  9761
  9762 0499-STATE-NOT-FOUND.
  9763
  9764     MOVE ER-2603                TO WS-ERROR.
  9765     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9766
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 180
* EL050.cbl
  9768
  9769 0500-SET-ACCOUNT.
  9770*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9771     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9772        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9773        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9774        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9775        MOVE '3'                 TO CNTL-REC-TYPE
  9776        MOVE +0                  TO CNTL-SEQ-NO
  9777
  9778        MOVE '3'                 TO RC-SW-2
  9779        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9780
  9781        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9782           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9783           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9784           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9785                                    WS-ST-AH-PREM-TAX-I
  9786                                    WS-ST-AH-PREM-TAX-G
  9787        ELSE
  9788           IF CF-ST-LF-PREM-TAX NUMERIC
  9789              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9790           END-IF
  9791           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9792              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9793           END-IF
  9794           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9795              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9796           END-IF
  9797        END-IF
  9798        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9799     END-IF
  9800*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9801*  FOR DCC ONLY
  9802     IF PB-COMPANY-ID = 'DCC'
  9803
  9804     MOVE ' '                    TO STAT-MASTER-SW
  9805     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9806     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9807     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9808     MOVE PB-STATE               TO ELSTAT-STATE
  9809     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9810        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9811     END-IF
  9812
  9813     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9814     SET BIN-TO-GREG             TO TRUE
  9815     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9816     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9817     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9818
  9819     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9820     IF STAT-MASTER-FOUND
  9821        MOVE 'N'                 TO STAT-MASTER-SW
  9822        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9823        IF STAT-MASTER-FOUND
  9824           IF (ELSTAT-KEY-SAVE (1:12) =
  9825                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 181
* EL050.cbl
  9826              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9827                 MOVE 'F'        TO STAT-MASTER-SW
  9828              ELSE
  9829                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9830                 IF (STAT-MASTER-FOUND)
  9831                    AND (ELSTAT-KEY-SAVE (1:12) =
  9832                        SF-CONTROL-PRIMARY (1:12))
  9833                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9834                    MOVE 'F'     TO STAT-MASTER-SW
  9835                 END-IF
  9836              END-IF
  9837           END-IF
  9838        END-IF
  9839     END-IF
  9840
  9841     IF STAT-MASTER-SW = 'F'
  9842        IF SF-ST-LF-PREM-TAX NUMERIC
  9843           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9844        END-IF
  9845        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9846           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9847        END-IF
  9848        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9849           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9850        END-IF
  9851     END-IF
  9852
  9853     END-IF
  9854     IF (PB-COMPANY-ID = 'DCC')
  9855        AND (PB-ISSUE)
  9856        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9857        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9858        AND (AM-GPCD = 06)
  9859        MOVE 'Y'                 TO WS-GOOD-HIN
  9860        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9861           MOVE PB-I-VIN         TO WS-WORK-VIN
  9862           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9863              (V1 > 16)
  9864              IF WS-WORK-VIN (V1:1) NUMERIC
  9865                 MOVE WS-WORK-VIN-N (V1)
  9866                                 TO WS-ROW-B-VAL (V1)
  9867              ELSE
  9868                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9869                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9870                    OR (V2 > 26)
  9871                 END-PERFORM
  9872                 IF V2 < 27
  9873                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9874                 ELSE
  9875                    MOVE 'N'     TO WS-GOOD-HIN
  9876                 END-IF
  9877              END-IF
  9878              COMPUTE WS-ROW-D-VAL (V1) =
  9879                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9880              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9881                 WS-ROW-D-VAL (V1)
  9882           END-PERFORM
  9883           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 182
* EL050.cbl
  9884           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9885             REMAINDER WS-VIN-REMAINDER
  9886           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9887              CONTINUE
  9888           ELSE
  9889              MOVE 'N'           TO WS-GOOD-HIN
  9890           END-IF
  9891        ELSE
  9892           MOVE 'N'              TO WS-GOOD-HIN
  9893        END-IF
  9894        IF WS-GOOD-HIN NOT = 'Y'
  9895           MOVE ER-3826           TO WS-ERROR
  9896           PERFORM 9900-ERROR-FORMAT
  9897                                 THRU 9900-EXIT
  9898        END-IF
  9899     END-IF
  9900     IF (PB-COMPANY-ID = 'DCC')
  9901        AND (PB-ISSUE)
  9902        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9903        AND (AM-GPCD NOT = 06)
  9904        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9905          MOVE PB-I-VIN          TO WS-WORK-VIN
  9906          MOVE +8                TO V2
  9907          MOVE ZEROS             TO WS-VIN-TOTAL
  9908          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9909           (V1 > 17)
  9910             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9911                MOVE ER-3825     TO WS-ERROR
  9912                PERFORM 9900-ERROR-FORMAT
  9913                                 THRU 9900-EXIT
  9914             ELSE
  9915                IF V1 = 8
  9916                   MOVE 10       TO V2
  9917                END-IF
  9918                IF V1 = 9
  9919                   MOVE 0        TO V2
  9920                END-IF
  9921                IF V1 = 10
  9922                   MOVE 9        TO V2
  9923                END-IF
  9924                IF WS-WORK-VIN (V1:1) NUMERIC
  9925                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9926                    + (WS-WORK-VIN-N (V1) * V2)
  9927                ELSE
  9928                   MOVE WS-WORK-VIN (V1:1)
  9929                                 TO WS-HEX-BYTE
  9930                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9931                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9932                    + (WS-NUM (V3) * V2)
  9933                END-IF
  9934                COMPUTE V2 = V2 - 1
  9935             END-IF
  9936          END-PERFORM
  9937          MOVE ZEROS TO WS-VIN-REMAINDER
  9938          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9939             REMAINDER WS-VIN-REMAINDER
  9940          IF ((WS-WORK-VIN (9:1) = 'X')
  9941             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 183
* EL050.cbl
  9942                     OR
  9943             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9944             CONTINUE
  9945          ELSE
  9946             MOVE ER-3826        TO WS-ERROR
  9947             PERFORM 9900-ERROR-FORMAT
  9948                                 THRU 9900-EXIT
  9949          END-IF
  9950        ELSE
  9951          MOVE ER-3826           TO WS-ERROR
  9952          PERFORM 9900-ERROR-FORMAT
  9953                                 THRU 9900-EXIT
  9954        END-IF
  9955     END-IF
  9956******************************************************************
  9957******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9958******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9959******* METHODS.
  9960******************************************************************
  9961     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9962        IF PB-CANCELLATION
  9963           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9964              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9965                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9966                IF FORM-MASTER-FOUND
  9967                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9968******************************************************************
  9969
  9970     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9971     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9972
  9973     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9974     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9975     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9976     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9977
  9978
  9979     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9980     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9981     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9982
  9983     IF AM-LF-OB-RATE NOT NUMERIC
  9984         MOVE ZERO               TO AM-LF-OB-RATE.
  9985
  9986     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9987         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9988
  9989     IF AM-AH-OB-RATE NOT NUMERIC
  9990         MOVE ZERO               TO AM-AH-OB-RATE.
  9991
  9992     IF WS-LF-JOINT-INDICATOR = 'J'
  9993         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9994     ELSE
  9995         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9996
  9997     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9998
  9999     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 184
* EL050.cbl
 10000         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10001
 10002     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10003         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10004                                       WS-IG-OVRD
 10005     ELSE
 10006         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10007             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10008                                       WS-IG-OVRD
 10009         ELSE
 10010             MOVE AM-IG             TO WS-IG-OVRD-AH
 10011                                       WS-IG-OVRD.
 10012
 10013     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10014         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10015                                       WS-IG-OVRD
 10016     ELSE
 10017         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10018             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10019                                       WS-IG-OVRD
 10020         ELSE
 10021             MOVE AM-IG             TO WS-IG-OVRD-LF
 10022                                       WS-IG-OVRD.
 10023
 10024     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10025     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10026     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10027     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10028     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10029
 10030     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10031     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10032     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10033     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10034
 10035     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10036     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10037     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10038     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10039     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10040     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10041     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10042
 10043     IF WS-ACCT-AH-DEV-PCT > +0
 10044        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10045     ELSE
 10046        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10047
 10048     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10049        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10050     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10051        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10052
 10053        IF AM-EARN-METHOD-L = 'S'
 10054            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10055                                        WS-LF-REFUND-CALC.
 10056
 10057        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 185
* EL050.cbl
 10058            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10059                                        WS-LF-REFUND-CALC.
 10060
 10061     IF WS-LF-COVERAGE-TYPE = 'R'
 10062         IF AM-EARN-METHOD-R = 'R'
 10063            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10064                                    WS-LF-REFUND-CALC.
 10065     IF WS-LF-COVERAGE-TYPE = 'R'
 10066         IF AM-EARN-METHOD-R = 'P'
 10067            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10068                                    WS-LF-REFUND-CALC.
 10069     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10070         IF AM-EARN-METHOD-L = 'R'
 10071            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10072                                    WS-LF-REFUND-CALC.
 10073     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10074         IF AM-EARN-METHOD-L = 'P'
 10075            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10076                                    WS-LF-REFUND-CALC.
 10077     IF WS-LF-COVERAGE-TYPE = 'R'
 10078         IF AM-EARN-METHOD-R = 'A'
 10079            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10080                                    WS-LF-REFUND-CALC.
 10081     IF WS-LF-COVERAGE-TYPE = 'R'
 10082         IF AM-EARN-METHOD-R = 'M'
 10083            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10084                                    WS-LF-REFUND-CALC.
 10085     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10086         IF AM-EARN-METHOD-L = 'A'
 10087            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10088                                    WS-LF-REFUND-CALC.
 10089     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10090         IF AM-EARN-METHOD-L = 'M'
 10091            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10092                                    WS-LF-REFUND-CALC.
 10093
 10094     IF AM-EARN-METHOD-A = 'R'
 10095        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10096                                    WS-AH-REFUND-CALC.
 10097     IF AM-EARN-METHOD-A = 'P'
 10098        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10099                                    WS-AH-REFUND-CALC.
 10100     IF AM-EARN-METHOD-A = 'C'
 10101        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10102                                    WS-AH-REFUND-CALC.
 10103     IF AM-EARN-METHOD-A = 'A'
 10104        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10105                                    WS-AH-REFUND-CALC.
 10106     IF AM-EARN-METHOD-A = 'M'
 10107        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10108                                    WS-AH-REFUND-CALC.
 10109     IF AM-EARN-METHOD-A = 'N'
 10110        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10111                                    WS-AH-REFUND-CALC.
 10112     IF AM-EARN-METHOD-A = 'S'
 10113        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10114                                    WS-AH-REFUND-CALC.
 10115
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 186
* EL050.cbl
 10116     IF AM-TOL-PREM NOT = ZEROS
 10117        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10118                                    WS-TOL-AH-PREM.
 10119
 10120     IF AM-OVR-SHT-AMT NUMERIC AND
 10121                  AM-OVR-SHT-AMT > 0
 10122        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10123                                    EC-AM-LF-OVR-SHT-AMT
 10124                                    WS-AH-REFUND-OVS-AMT
 10125                                    EC-AM-AH-OVR-SHT-AMT.
 10126
 10127     IF AM-OVR-SHT-PCT NUMERIC AND
 10128                    AM-OVR-SHT-PCT > 0
 10129        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10130                                    EC-AM-LF-OVR-SHT-PCT
 10131                                    WS-AH-REFUND-OVS-PCT
 10132                                    EC-AM-AH-OVR-SHT-PCT.
 10133
 10134     IF AM-TOL-REF-PCT NUMERIC AND
 10135                  AM-TOL-REF-PCT > 0
 10136        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10137                                    WS-TOL-AH-REFUND-PCT.
 10138
 10139     IF AM-TOL-REF  NOT = ZEROS  AND
 10140                  AM-TOL-REF NUMERIC
 10141        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10142                                    EC-AM-LF-TOL-REFUND
 10143                                    WS-TOL-AH-REFUND
 10144                                    EC-AM-AH-TOL-REFUND.
 10145
 10146     IF AM-TOL-CLM  NOT = ZEROS
 10147        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10148                                    WS-TOL-AH-CLAIM.
 10149
 10150     IF AM-CLP-TOL-PCT NOT NUMERIC
 10151        MOVE +0                  TO AM-CLP-TOL-PCT
 10152     END-IF
 10153
 10154     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10155        MOVE +0                  TO AM-SPP-LEASE-COMM
 10156     END-IF
 10157     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10158        MOVE WS-PL-TOL-LF-PREM-PCT
 10159                                 TO WS-TOL-LF-PREM-PCT.
 10160
 10161     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10162        MOVE WS-PL-TOL-AH-PREM-PCT
 10163                                 TO WS-TOL-AH-PREM-PCT.
 10164
 10165     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10166        MOVE WS-PL-TOL-LF-REFUND-PCT
 10167                                 TO WS-TOL-LF-REFUND-PCT.
 10168
 10169     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10170        MOVE WS-PL-TOL-AH-REFUND-PCT
 10171                                 TO WS-TOL-AH-REFUND-PCT.
 10172
 10173     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 187
* EL050.cbl
 10174        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10175
 10176     IF WS-PL-REF-OVS-PCT > +0
 10177        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10178
 10179     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10180        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10181     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10182        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10183     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10184        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10185     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10186        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10187     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10188        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10189     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10190        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10191
 10192     IF WS-AH-PL-REF-OVS-AMT > +0
 10193        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10194
 10195     IF WS-AH-PL-REF-OVS-PCT > +0
 10196        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10197
 10198     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10199     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10200
 10201     IF PB-CANCELLATION
 10202        GO TO 3000-CONTINUE-EDIT.
 10203
 10204     MOVE +1 TO SUB1.
 10205     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10206     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10207
 10208     IF CF-COMPANY-ID = 'DMD'
 10209       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10210         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10211        ELSE
 10212         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10213
 10214  0525-FIND-ACCT-COMM.
 10215     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10216        NEXT SENTENCE
 10217      ELSE
 10218         ADD +1 TO SUB1
 10219         IF SUB1 LESS +11
 10220            GO TO 0525-FIND-ACCT-COMM
 10221          ELSE
 10222             GO TO 0560-EDIT-CONTINUE.
 10223
 10224     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10225     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10226                                    PB-I-LIFE-COMMISSION.
 10227***  IF PB-COMPANY-ID = 'CRI'
 10228     IF PB-PREM-ACCTNG-ONLY
 10229         GO TO 0560-EDIT-CONTINUE.
 10230
 10231     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 188
* EL050.cbl
 10232     MOVE ' '    TO WS-CTBL-READ-SW.
 10233
 10234
 10235 0530-GET-AH-COMP.
 10236     IF NO-AH-COVERAGE  OR
 10237        NO-AH-BENEFIT-MATCH
 10238           GO TO 0540-NEXT-READ-STEP.
 10239
 10240     IF AM-A-COM (SUB1) NUMERIC
 10241        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10242         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10243         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10244         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10245         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10246     ELSE
 10247          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10248          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10249          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10250          MOVE ZEROS             TO WS-SUB1
 10251                                    WS-COMMISSION
 10252          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10253          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10254          IF WS-COMMISSION > ZEROS
 10255             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10256             GO TO 0540-NEXT-READ-STEP
 10257          END-IF
 10258          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10259          IF CTBL-TABLE-FOUND
 10260             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10261                                        PB-I-AH-TERM
 10262             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10263             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10264             GO TO 0540-NEXT-READ-STEP
 10265          ELSE
 10266             IF FIRST-TIME-THROUGH
 10267                 GO TO 0530-GET-AH-COMP
 10268             ELSE
 10269                 MOVE ER-2609                TO WS-ERROR
 10270                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10271
 10272 0540-NEXT-READ-STEP.
 10273     MOVE '0540' TO CTBL-SW.
 10274     MOVE ' '    TO WS-CTBL-READ-SW.
 10275
 10276 0540-GET-LF-COMP.
 10277     IF NO-LIFE-COVERAGE  OR
 10278        NO-LF-BENEFIT-MATCH
 10279           GO TO 0560-EDIT-CONTINUE.
 10280
 10281     IF WS-LF-JOINT-INDICATOR = 'J'
 10282        IF AM-J-COM (SUB1) NUMERIC
 10283           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10284           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10285           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10286           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10287           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10288        ELSE
 10289           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 189
* EL050.cbl
 10290           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10291           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10292           MOVE ZEROS                TO WS-SUB1
 10293                                        WS-COMMISSION
 10294           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10295           IF WS-COMMISSION > ZEROS
 10296              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10297              GO TO 0560-EDIT-CONTINUE
 10298           END-IF
 10299           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10300           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10301           IF CTBL-TABLE-FOUND
 10302              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10303              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10304              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10305              GO TO 0560-EDIT-CONTINUE
 10306           ELSE
 10307              IF FIRST-TIME-THROUGH
 10308                  GO TO 0540-GET-LF-COMP
 10309              ELSE
 10310                  MOVE ER-2609                TO WS-ERROR
 10311                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10312                  GO TO 0560-EDIT-CONTINUE.
 10313
 10314     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10315        IF AM-L-COM (SUB1) NUMERIC
 10316           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10317           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10318           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10319           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10320           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10321        ELSE
 10322           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10323           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10324           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10325           MOVE ZEROS                TO WS-SUB1
 10326                                        WS-COMMISSION
 10327           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10328           IF WS-COMMISSION IS GREATER THAN ZEROS
 10329              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10330              GO TO 0560-EDIT-CONTINUE
 10331           END-IF
 10332           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10333           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10334           IF CTBL-TABLE-FOUND
 10335              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10336              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10337              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10338              GO TO 0560-EDIT-CONTINUE
 10339           ELSE
 10340              IF FIRST-TIME-THROUGH
 10341                  GO TO 0540-GET-LF-COMP
 10342              ELSE
 10343                  MOVE ER-2609                TO WS-ERROR
 10344                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10345
 10346*    GO TO 0560-EDIT-CONTINUE.
 10347
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 190
* EL050.cbl
 10348 0560-EDIT-CONTINUE.
 10349     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10350                                    WS-AH-PMF-COMM
 10351*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10352*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10353     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10354        (SUB1 > +10)
 10355        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10356           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10357           MOVE '0530'           TO CTBL-SW
 10358           MOVE ' '              TO WS-CTBL-READ-SW
 10359           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10360           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10361           MOVE '0540'           TO CTBL-SW
 10362           MOVE ' '              TO WS-CTBL-READ-SW
 10363           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10364        END-IF
 10365     END-PERFORM
 10366     GO TO 0564-EDIT-CONTINUE
 10367     .
 10368 0561-CHECK-AH.
 10369     IF (NO-AH-COVERAGE)
 10370        OR (NO-AH-BENEFIT-MATCH)
 10371        CONTINUE
 10372     ELSE
 10373        IF (AM-A-COM (SUB1) NUMERIC)
 10374           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10375           IF (AM-COM-TYP (SUB1) = 'A')
 10376              AND (WS-AH-PMF-COMM = ZEROS)
 10377              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10378           END-IF
 10379           CONTINUE
 10380        ELSE
 10381           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10382           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10383           MOVE PB-AH-OVERRIDE-L1
 10384                                 TO CTBL-BEN-TYPE
 10385           MOVE ZEROS            TO WS-SUB1
 10386                                    WS-COMMISSION
 10387           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10388           PERFORM 8300-READ-CTBL-TABLE
 10389                                 THRU 8300-EXIT
 10390           IF CTBL-TABLE-FOUND
 10391              IF (AM-COM-TYP (SUB1) = 'A')
 10392                 AND (WS-AH-PMF-COMM = ZEROS)
 10393                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10394                                        PB-I-AH-TERM
 10395                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10396                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10397              END-IF
 10398              CONTINUE
 10399           ELSE
 10400              IF FIRST-TIME-THROUGH
 10401                 GO TO 0561-CHECK-AH
 10402              ELSE
 10403                 MOVE ER-2609    TO WS-ERROR
 10404                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10405              END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 191
* EL050.cbl
 10406           END-IF
 10407        END-IF
 10408     END-IF
 10409     .
 10410 0561-EXIT.
 10411     EXIT.
 10412 0563-CHECK-LF.
 10413     IF (NO-LIFE-COVERAGE)
 10414        OR (NO-LF-BENEFIT-MATCH)
 10415        CONTINUE
 10416     ELSE
 10417        IF WS-LF-JOINT-INDICATOR = 'J'
 10418           IF AM-J-COM (SUB1) NUMERIC
 10419              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10420              IF (AM-COM-TYP (SUB1) = 'A')
 10421                 AND (WS-LF-PMF-COMM = ZEROS)
 10422                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10423              END-IF
 10424              CONTINUE
 10425           ELSE
 10426              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10427              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10428              MOVE PB-LIFE-OVERRIDE-L1
 10429                                 TO CTBL-BEN-TYPE
 10430              MOVE ZEROS         TO WS-SUB1
 10431                                    WS-COMMISSION
 10432              MOVE AM-J-COMA (SUB1)
 10433                                 TO CTBL-TABLE
 10434              PERFORM 8300-READ-CTBL-TABLE
 10435                                 THRU 8300-EXIT
 10436              IF CTBL-TABLE-FOUND
 10437                 IF (AM-COM-TYP (SUB1) = 'A')
 10438                    AND (WS-LF-PMF-COMM = ZEROS)
 10439                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10440                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10441                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10442                 END-IF
 10443                 CONTINUE
 10444              ELSE
 10445                 IF FIRST-TIME-THROUGH
 10446                    GO TO 0563-CHECK-LF
 10447                 ELSE
 10448                    MOVE ER-2609 TO WS-ERROR
 10449                    PERFORM 9900-ERROR-FORMAT
 10450                                 THRU 9900-EXIT
 10451*                   GO TO 0560-EDIT-CONTINUE
 10452                 END-IF
 10453              END-IF
 10454           END-IF
 10455        ELSE
 10456           IF AM-L-COM (SUB1) NUMERIC
 10457              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10458              IF (AM-COM-TYP (SUB1) = 'A')
 10459                 AND (WS-LF-PMF-COMM = ZEROS)
 10460                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10461              END-IF
 10462              CONTINUE
 10463           ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 192
* EL050.cbl
 10464              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10465              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10466              MOVE PB-LIFE-OVERRIDE-L1
 10467                                 TO CTBL-BEN-TYPE
 10468              MOVE ZEROS         TO WS-SUB1
 10469                                    WS-COMMISSION
 10470              MOVE AM-L-COMA (SUB1)
 10471                                 TO CTBL-TABLE
 10472              PERFORM 8300-READ-CTBL-TABLE
 10473                                 THRU 8300-EXIT
 10474              IF CTBL-TABLE-FOUND
 10475                 CONTINUE
 10476              ELSE
 10477                 IF FIRST-TIME-THROUGH
 10478                    GO TO 0563-CHECK-LF
 10479                 ELSE
 10480                    MOVE ER-2609 TO WS-ERROR
 10481                    PERFORM 9900-ERROR-FORMAT
 10482                                 THRU 9900-EXIT
 10483                 END-IF
 10484              END-IF
 10485           END-IF
 10486        END-IF
 10487     END-IF
 10488     .
 10489 0563-EXIT.
 10490     EXIT.
 10491 0564-EDIT-CONTINUE.
 10492
 10493     IF  PB-COMPANY-ID EQUAL 'DMD'
 10494         IF PB-I-NUM-BILLED EQUAL ZEROS
 10495            MOVE ER-8148       TO WS-ERROR
 10496            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10497
 10498*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10499*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10500*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10501*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10502*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10503*         IF NO-CONVERSION-ERROR
 10504*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10505*         ELSE
 10506*             IF PB-COMPANY-ID EQUAL 'HAN'
 10507*                 MOVE ZEROS     TO PB-I-AGE.
 10508     IF PB-I-BIRTHDAY > LOW-VALUES
 10509        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10510        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10511        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10512        PERFORM 8500-DATE-CONVERT
 10513                                 THRU 8500-EXIT
 10514        IF NO-CONVERSION-ERROR
 10515           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10516           IF PB-I-AGE > ZEROS
 10517              IF WS-WORK-AGE NOT = PB-I-AGE
 10518                 MOVE ER-9501    TO WS-ERROR
 10519                 PERFORM 9900-ERROR-FORMAT
 10520                                 THRU 9900-EXIT
 10521              END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 193
* EL050.cbl
 10522           ELSE
 10523              MOVE WS-WORK-AGE   TO PB-I-AGE
 10524           END-IF
 10525        END-IF
 10526     END-IF
 10527     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10528                                   WS-INS-AGE-SET
 10529     IF PB-I-AGE = ZEROS
 10530        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10531           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10532                                   WS-INS-AGE-SET
 10533           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10534
 10535     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10536                                   WS-AH-EDIT-AGE.
 10537
 10538     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10539        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10540        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10541        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10542        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10543        IF NO-CONVERSION-ERROR
 10544           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10545           IF PB-I-JOINT-AGE > 0
 10546              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10547                 MOVE ER-9503    TO WS-ERROR
 10548                 PERFORM 9900-ERROR-FORMAT
 10549                                 THRU 9900-EXIT
 10550              END-IF
 10551           ELSE
 10552              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10553           END-IF
 10554        ELSE
 10555           MOVE ZEROS            TO PB-I-JOINT-AGE
 10556        END-IF
 10557     END-IF
 10558     IF PB-I-JOINT-AGE NOT NUMERIC
 10559        MOVE ZERO               TO PB-I-JOINT-AGE.
 10560
 10561     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10562                                   WS-JNT-AGE-SET
 10563     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10564        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10565           (WS-AH-JOINT-INDICATOR = 'J')
 10566           IF PB-I-JOINT-AGE = ZEROS
 10567               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10568                                          WS-JNT-AGE-SET
 10569               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10570           END-IF
 10571        END-IF
 10572     END-IF
 10573
 10574     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10575     IF WS-LF-JOINT-INDICATOR = 'J'
 10576        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10577        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10578            IF  PB-I-JOINT-AGE = ZERO
 10579                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 194
* EL050.cbl
 10580                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10581            ELSE
 10582                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10583                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10584                    IF PB-COMPANY-ID NOT = 'LBL'
 10585                        MOVE ER-2685    TO WS-ERROR
 10586                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10587
 10588     IF WS-AH-JOINT-INDICATOR = 'J'
 10589        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10590            IF  PB-I-JOINT-AGE = ZERO
 10591                MOVE ER-2686       TO WS-ERROR
 10592                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10593            ELSE
 10594                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10595                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10596                                           WS-EDIT-AGE
 10597                    IF PB-COMPANY-ID NOT = 'LBL'
 10598                        MOVE ER-2685    TO WS-ERROR
 10599                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10600
 10601******************************************************************
 10602*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10603******************************************************************
 10604
 10605     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10606        (WS-AH-SPECIAL-CALC-CD = 'O')
 10607        NEXT SENTENCE
 10608     ELSE
 10609        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10610          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10611           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10612            WS-AH-JOINT-INDICATOR = 'J')  AND
 10613           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10614            MOVE ER-2627             TO WS-ERROR
 10615            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10616
 10617     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10618        (WS-AH-SPECIAL-CALC-CD = 'O')
 10619         NEXT SENTENCE
 10620     ELSE
 10621         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10622            WS-AH-JOINT-INDICATOR = 'J'
 10623             IF PB-I-JOINT-INSURED = SPACES
 10624                 IF PB-COMPANY-ID NOT = 'JAL'
 10625                     MOVE ER-2696    TO WS-ERROR
 10626                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10627
 10628     IF PB-COMPANY-ID NOT = 'BOA'
 10629        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10630           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10631           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10632               PB-I-JOINT-INSURED NOT = SPACES)
 10633                MOVE ER-2691         TO WS-ERROR
 10634                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10635
 10636     IF PB-COMPANY-ID = 'BOA'
 10637        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 195
* EL050.cbl
 10638           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10639            IF PB-I-JOINT-AGE NOT = ZEROS
 10640                MOVE ER-2691         TO WS-ERROR
 10641                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10642
 10643     IF PB-COMPANY-ID = 'CRI'
 10644        IF PB-I-SIG-SW = 'J'
 10645           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10646              WS-AH-JOINT-INDICATOR NOT = 'J'
 10647              MOVE ER-2675       TO WS-ERROR
 10648              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10649
 10650     IF PB-COMPANY-ID = 'CRI'
 10651        IF PB-I-SIG-SW = 'S'
 10652           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10653              WS-AH-JOINT-INDICATOR = 'J'
 10654              MOVE ER-2676       TO WS-ERROR
 10655              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10656
 10657     IF PB-COMPANY-ID = 'CVL'
 10658         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10659            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10660              MOVE ER-2783           TO WS-ERROR
 10661              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10662     IF (WS-LF-JOINT-INDICATOR = 'J')
 10663        AND (WS-AH-JOINT-INDICATOR = 'J')
 10664        AND (PB-I-LF-TERM > 120)
 10665        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10666        MOVE ER-2783             TO WS-ERROR
 10667        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10668     END-IF
 10669     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10670
 10671     IF PB-I-INDV-GRP-OVRD = 'I'
 10672        MOVE ER-2666             TO WS-ERROR
 10673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10674        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10675
 10676     IF PB-I-INDV-GRP-OVRD = 'G'
 10677        MOVE ER-2666             TO WS-ERROR
 10678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10679        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10680
 10681     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10682        NEXT SENTENCE
 10683     ELSE
 10684        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10685
 10686     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10687        IF WS-ERROR = ER-2666
 10688           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10689           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10690
 10691     IF PB-COMPANY-ID = 'CID'
 10692        IF PB-STATE = 'UT' OR 'MO'
 10693           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10694                 OR '76' OR '77')
 10695                      OR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 196
* EL050.cbl
 10696               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10697                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10698                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10699                   OR '2K' OR '2L'))
 10700              AND PB-I-INDV-GRP-CD = 'I'
 10701              MOVE ER-2721             TO WS-ERROR
 10702              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10703           END-IF
 10704        END-IF
 10705     END-IF
 10706
 10707     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10708     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10709        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10710     ELSE
 10711        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10712     END-IF
 10713
 10714*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10715*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10716     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10717                                    ACCOUNT-AH-CK-SW.
 10718
 10719     IF PB-REISSUED-CERT       OR
 10720        PB-REIN-ONLY-CERT      OR
 10721        PB-POLICY-IS-DECLINED  OR
 10722        PB-POLICY-IS-VOIDED
 10723*       OR PB-MONTHLY-CERT
 10724         GO TO 3000-CONTINUE-EDIT.
 10725
 10726     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10727        IF WS-EDIT-AGE           > +65
 10728           MOVE ER-2709          TO WS-ERROR
 10729           PERFORM 9900-ERROR-FORMAT
 10730                                 THRU 9900-EXIT
 10731        ELSE
 10732           IF WS-EDIT-AGE        > +55
 10733              MOVE ER-2718       TO WS-ERROR
 10734              PERFORM 9900-ERROR-FORMAT
 10735                                 THRU 9900-EXIT
 10736           END-IF
 10737        END-IF
 10738     IF PB-COMPANY-ID = 'DCC'
 10739        IF WS-EDIT-AGE           > +65
 10740           MOVE ER-2709          TO WS-ERROR
 10741           PERFORM 9900-ERROR-FORMAT
 10742                                 THRU 9900-EXIT
 10743        END-IF
 10744     END-IF
 10745     .
 10746
 10747 0565-LIFE-PLAN-LIMIT-EDITS.
 10748
 10749     IF NOT LF-PLAN-MASTER-FOUND
 10750        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10751                                    EC-AM-LF-MAX-TOT-BEN
 10752        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10753
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 197
* EL050.cbl
 10754     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10755
 10756     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10757         IF PL-LM-AGE (1) = ZEROS
 10758             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10759
 10760     IF NO-LF-BENEFIT-MATCH          OR
 10761        WS-LF-BENEFIT-CD = ZEROS     OR
 10762        WS-LF-SPECIAL-CALC-CD = 'M'
 10763        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10764
 10765     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10766     MOVE +1                     TO SUB2.
 10767
 10768     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10769        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10770           MOVE +5   TO SUB2
 10771           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10772              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10773              (PL-LM-AGE (SUB2) EQUAL +0)
 10774              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10775              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10776
 10777     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10778
 10779     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10780                               + PB-I-LF-ALT-BENEFIT-AMT.
 10781
 10782 0568-CHECK-LIFE-ATT-AGE.
 10783
 10784     IF PL-ATT-AGE NUMERIC AND
 10785        PL-ATT-AGE > +0
 10786        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10787     END-IF
 10788*    IF PL-ATT-AGE NUMERIC AND
 10789*       PL-ATT-AGE > +0
 10790*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10791*       IF PB-I-BIRTHDAY > LOW-VALUES
 10792*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10793*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10794*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10795*          SET BIN-PLUS-ELAPSED  TO TRUE
 10796*          PERFORM 8500-DATE-CONVERT
 10797*                                THRU 8500-EXIT
 10798*          IF NO-CONVERSION-ERROR
 10799*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10800*             MOVE ER-2669       TO WS-ERROR
 10801*             PERFORM 9900-ERROR-FORMAT
 10802*                                THRU 9900-EXIT
 10803*          END-IF
 10804*       ELSE
 10805*          IF WS-ATT-AGE >= PL-ATT-AGE
 10806*             MOVE ER-2669       TO WS-ERROR
 10807*             PERFORM 9900-ERROR-FORMAT
 10808*                                THRU 9900-EXIT
 10809*          END-IF
 10810*       END-IF
 10811*    END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 198
* EL050.cbl
 10812     .
 10813 0570-CHECK-LIFE-LIMITS.
 10814
 10815     IF PB-COMPANY-ID EQUAL 'CRI'
 10816        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10817           IF SUB2 GREATER THAN +4
 10818              MOVE ER-2637 TO WS-ERROR
 10819              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10820              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10821
 10822     IF PB-COMPANY-ID  =  'NCL'
 10823        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10824            SUB2 GREATER THAN +8
 10825             MOVE 'U'         TO PB-BATCH-ENTRY
 10826             MOVE ER-2637     TO WS-ERROR
 10827             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10828             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10829
 10830     IF SUB2 > +8
 10831        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10832           AND (PB-I-SIG-SW = 'Y')
 10833           CONTINUE
 10834        ELSE
 10835           MOVE ER-2637          TO WS-ERROR
 10836           PERFORM 9900-ERROR-FORMAT
 10837                                 THRU 9900-EXIT
 10838        END-IF
 10839        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10840     END-IF
 10841     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10842     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10843     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10844
 10845     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10846        ADD +1  TO SUB2
 10847        GO TO 0570-CHECK-LIFE-LIMITS.
 10848
 10849     IF PB-COMPANY-ID = 'NCL'
 10850         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10851
 10852     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10853        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10854        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10855           AND (PB-I-SIG-SW = 'Y')
 10856           CONTINUE
 10857        ELSE
 10858           MOVE ER-2637          TO WS-ERROR
 10859           PERFORM 9900-ERROR-FORMAT
 10860                                 THRU 9900-EXIT
 10861        END-IF
 10862     END-IF
 10863     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10864
 10865
 10866 0570-CHECK-NCL-LIFE-LIMITS.
 10867
 10868     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10869        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 199
* EL050.cbl
 10870         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10871
 10872     IF APP-CERT-USED
 10873         IF SUB2  LESS THAN  +5
 10874             MOVE +5          TO SUB2
 10875             GO TO 0570-CHECK-LIFE-LIMITS.
 10876
 10877     MOVE ER-2637             TO WS-ERROR.
 10878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10879
 10880     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10881
 10882 0575-CHECK-NCL-SIG-SWITCH.
 10883
 10884     IF NOT APP-CERT-USED
 10885         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10886
 10887     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10888        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10889        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10890        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10891         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10892
 10893     IF SUB2 GREATER THAN +4
 10894         IF PL-LM-AGE (5) = ZEROS  AND
 10895            PL-LM-AGE (6) = ZEROS  AND
 10896            PL-LM-AGE (7) = ZEROS  AND
 10897            PL-LM-AGE (8) = ZEROS
 10898             MOVE  ER-1927        TO WS-ERROR
 10899             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10900             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10901         ELSE
 10902             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10903                 MOVE  ER-1920    TO WS-ERROR
 10904                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10905
 10906     IF PB-I-SIG-SW  = 'Y'
 10907       IF NOT PB-I-POLICY-ACCEPTED  AND
 10908          NOT PB-I-POLICY-DECLINED
 10909           MOVE 'U'               TO PB-BATCH-ENTRY
 10910           MOVE  ER-1926          TO WS-ERROR
 10911           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10912
 10913
 10914 0580-AH-PLAN-LIMIT-EDITS.
 10915
 10916     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10917        IF PB-I-AH-BENEFIT-AMT > +1250
 10918           MOVE ER-2702          TO WS-ERROR
 10919           PERFORM 9900-ERROR-FORMAT
 10920                                 THRU 9900-EXIT
 10921        END-IF
 10922     END-IF
 10923
 10924     IF (PB-COMPANY-ID = 'DCC')
 10925        AND (PB-MONTHLY-CERT)
 10926        IF PB-I-AH-BENEFIT-AMT > +3000
 10927           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 200
* EL050.cbl
 10928           PERFORM 9900-ERROR-FORMAT
 10929                                 THRU 9900-EXIT
 10930        END-IF
 10931     END-IF
 10932     IF NOT AH-PLAN-MASTER-FOUND
 10933        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10934        GO TO 3000-CONTINUE-EDIT.
 10935
 10936     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10937
 10938     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10939         IF PL-LM-AGE (1) = ZEROS
 10940             GO TO 3000-CONTINUE-EDIT.
 10941
 10942     IF NO-AH-BENEFIT-MATCH          OR
 10943        WS-AH-BENEFIT-CD = ZEROS     OR
 10944        WS-AH-SPECIAL-CALC-CD = 'M'
 10945        GO TO 3000-CONTINUE-EDIT.
 10946
 10947     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10948     MOVE +1                     TO SUB2.
 10949
 10950     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10951        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10952           MOVE +5 TO SUB2
 10953           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10954              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10955              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10956              (PL-LM-AGE (SUB2) EQUAL +0)
 10957              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10958              GO TO 3000-CONTINUE-EDIT.
 10959
 10960     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10961
 10962 0590-CHECK-AH-ATT-AGE.
 10963
 10964     IF PL-ATT-AGE NUMERIC AND
 10965        PL-ATT-AGE GREATER THAN +0
 10966        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10967     END-IF
 10968*       IF WS-ATT-AGE >= PL-ATT-AGE
 10969*          MOVE ER-3054          TO WS-ERROR
 10970*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10971     .
 10972 0597-CHECK-AH-LIMITS.
 10973
 10974     IF PB-COMPANY-ID EQUAL 'CRI'
 10975        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10976           IF SUB2 GREATER THAN +4
 10977              MOVE ER-2638       TO WS-ERROR
 10978              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10979              GO TO 3000-CONTINUE-EDIT.
 10980
 10981     IF PB-COMPANY-ID  =  'NCL'
 10982        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10983            SUB2 GREATER THAN +8
 10984             MOVE 'U'            TO PB-BATCH-ENTRY
 10985             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 201
* EL050.cbl
 10986             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10987             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10988
 10989     IF SUB2 > +8
 10990        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10991           AND (PB-I-SIG-SW = 'Y')
 10992           CONTINUE
 10993        ELSE
 10994           MOVE ER-2638          TO WS-ERROR
 10995           PERFORM 9900-ERROR-FORMAT
 10996                                 THRU 9900-EXIT
 10997        END-IF
 10998        GO TO 3000-CONTINUE-EDIT
 10999     END-IF
 11000
 11001     IF PB-COMPANY-ID = 'CRI'
 11002        IF WS-ERROR = ER-2638
 11003           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11004
 11005     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11006     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11007     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11008     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11009
 11010     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11011        ADD +1                   TO SUB2
 11012        GO TO 0597-CHECK-AH-LIMITS.
 11013
 11014     IF PB-COMPANY-ID = 'NCL'
 11015         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11016
 11017     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11018        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11019        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11020                                 > PL-LM-AMT (SUB2))
 11021        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11022           AND (PB-I-SIG-SW = 'Y')
 11023           CONTINUE
 11024        ELSE
 11025           MOVE ER-2638          TO WS-ERROR
 11026           PERFORM 9900-ERROR-FORMAT
 11027                                 THRU 9900-EXIT
 11028        END-IF
 11029     END-IF
 11030
 11031     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11032         IF  WS-ERROR    EQUAL    ER-2638
 11033             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11034                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11035                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11036                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11037                MOVE  ER-1910    TO  WS-ERROR
 11038                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11039
 11040     IF PB-COMPANY-ID = 'CRI'
 11041        IF WS-ERROR = ER-2638
 11042            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11043            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 202
* EL050.cbl
 11044            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11045
 11046     GO TO 3000-CONTINUE-EDIT.
 11047
 11048 0597-CHECK-NCL-AH-LIMITS.
 11049
 11050     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11051        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11052        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11053                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11054         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11055
 11056     IF APP-CERT-USED
 11057         IF SUB2  LESS THAN  +5
 11058             MOVE +5             TO SUB2
 11059             GO TO 0597-CHECK-AH-LIMITS.
 11060
 11061     MOVE ER-2638                TO WS-ERROR.
 11062     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11063
 11064     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11065
 11066 0599-CHECK-NCL-SIG-SWITCH.
 11067
 11068     IF NOT APP-CERT-USED
 11069         GO TO 3000-CONTINUE-EDIT.
 11070
 11071     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11072        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11073        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11074        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11075         GO TO 3000-CONTINUE-EDIT.
 11076
 11077     IF SUB2 GREATER THAN +4
 11078         IF PL-LM-AGE (5) = ZEROS  AND
 11079            PL-LM-AGE (6) = ZEROS  AND
 11080            PL-LM-AGE (7) = ZEROS  AND
 11081            PL-LM-AGE (8) = ZEROS
 11082             MOVE  ER-1927        TO WS-ERROR
 11083             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11084             GO TO 3000-CONTINUE-EDIT
 11085         ELSE
 11086             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11087                 MOVE  ER-1920    TO WS-ERROR
 11088                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11089
 11090     IF PB-I-SIG-SW  = 'Y'
 11091       IF NOT PB-I-POLICY-ACCEPTED  AND
 11092          NOT PB-I-POLICY-DECLINED
 11093           MOVE 'U'               TO PB-BATCH-ENTRY
 11094           MOVE  ER-1926          TO WS-ERROR
 11095           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11096
 11097******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 203
* EL050.cbl
 11099
 11100 3000-CONTINUE-EDIT.
 11101
 11102     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11103     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11104     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11105     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11106     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11107
 11108     IF BROWSE-STARTED
 11109        PERFORM 9990-RETURN THRU 9990-EXIT
 11110        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11111
 11112     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11113        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11114        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11115        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11116*       MOVE 1                   TO DC-OPTION-CODE
 11117        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11118        IF DATE-CONVERSION-ERROR
 11119           MOVE ER-2622          TO WS-ERROR
 11120           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11121        ELSE
 11122           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11123              MOVE ER-2623       TO WS-ERROR
 11124              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11125           ELSE
 11126              MOVE ER-2622       TO WS-ERROR
 11127              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11128
 11129     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11130     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11131     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11132*    MOVE 1                      TO DC-OPTION-CODE.
 11133     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11134     IF DATE-CONVERSION-ERROR
 11135        GO TO 3005-EDIT-CONTINUE
 11136     ELSE
 11137        IF DC-ELAPSED-DAYS GREATER +180
 11138           MOVE ER-2613          TO WS-ERROR
 11139           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11140        ELSE
 11141           IF DC-ELAPSED-DAYS GREATER +90
 11142              MOVE ER-2612       TO WS-ERROR
 11143              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11144           ELSE
 11145             IF DC-ELAPSED-DAYS GREATER +60
 11146                MOVE ER-2614     TO WS-ERROR
 11147                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11148
 11149 3005-EDIT-CONTINUE.
 11150
 11151     IF PB-CANCELLATION
 11152         GO TO 3700-EDIT-CANCEL.
 11153
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 204
* EL050.cbl
 11155******************************************************************
 11156*                  E D I T   I S S U E                           *
 11157******************************************************************
 11158
 11159 3020-EDIT-ISSUE.
 11160
 11161      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11162      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11163      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11164      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11165      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11166
 11167     IF PB-ISSUE-FORCE
 11168        OR PB-ISSUE-DATE-FORCED
 11169        OR PB-FORCE-OFF
 11170        OR PB-OVERCHARGE-FORCE
 11171        CONTINUE
 11172     ELSE
 11173        MOVE ER-2670             TO WS-ERROR
 11174        PERFORM 9900-ERROR-FORMAT
 11175                                 THRU 9900-EXIT
 11176     END-IF
 11177     .
 11178 3022-SET-POLICY-STATUS.
 11179
 11180     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11181
 11182     IF (PB-REISSUED-CERT)
 11183             OR
 11184        ((PB-COMPANY-ID NOT = 'DCC')
 11185         AND (PB-MONTHLY-CERT))
 11186         MOVE '5'                TO PB-I-ENTRY-STATUS
 11187         MOVE 'E'                TO PB-BATCH-ENTRY
 11188     END-IF
 11189
 11190     IF PB-COMPANY-ID = 'DCC'
 11191        IF PB-MONTHLY-CERT
 11192           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11193        END-IF
 11194     END-IF
 11195     IF PB-POLICY-IS-DECLINED
 11196         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11197     IF PB-POLICY-IS-VOIDED
 11198         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11199     IF PB-NEEDS-UNDERWRITING
 11200         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11201     IF PB-REIN-ONLY-CERT
 11202         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11203     IF PB-PREM-ACCTNG-ONLY
 11204         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11205
 11206     MOVE SPACE                  TO PB-I-OB-FLAG.
 11207
 11208     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11209         MOVE ER-2665            TO WS-ERROR
 11210         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11211         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11212
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 205
* EL050.cbl
 11213     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11214        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11215           MOVE 'Z'             TO PB-I-OB-FLAG.
 11216
 11217     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11218        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11219           MOVE 'Z'             TO PB-I-OB-FLAG.
 11220
 11221     IF ACCOUNT-MAST-FOUND
 11222         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11223         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11224         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11225         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11226         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11227         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11228         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11229     END-IF
 11230
 11231     IF ACCOUNT-MAST-FOUND
 11232        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11233         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11234
 11235     IF (ACCOUNT-MAST-FOUND)
 11236        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11237        IF PB-REISSUED-CERT
 11238           CONTINUE
 11239        ELSE
 11240           MOVE ER-2608          TO WS-ERROR
 11241           PERFORM 9900-ERROR-FORMAT
 11242                                 THRU 9900-EXIT
 11243         END-IF
 11244     END-IF
 11245
 11246     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11247        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11248        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11249
 11250**********   DMD CUSTOM CODE FOLLOWS  **********
 11251 3024-EDIT-DMD-FIELDS.
 11252     IF PB-COMPANY-ID NOT = 'DMD'
 11253        GO TO 3025-EDIT-REINSURANCE.
 11254
 11255*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11256*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11257*** ERROR IF THEY ARE NOT EQUAL.
 11258
 11259     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11260     SET BIN-TO-GREG               TO TRUE.
 11261     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11262     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11263**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11264
 11265     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11266     SET BIN-TO-GREG               TO TRUE.
 11267     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11268     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11269**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11270
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 206
* EL050.cbl
 11271     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11272        MOVE ER-8116               TO WS-ERROR
 11273        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11274
 11275     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11276
 11277     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11278                                      WK-FULL-CERT-NO.
 11279     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11280
 11281     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11282
 11283     IF PB-VALID-LIFE
 11284        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11285     ELSE
 11286        IF PB-VALID-AH
 11287          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11288
 11289
 11290     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11291     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11292     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11293                                      DCUA-UNDRWRTR-CODE
 11294                                      DCUA-UNDRWRTR-GROUP-CODE
 11295                                      DCUA-RETURN-CODE.
 11296
 11297****************************************************************
 11298*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11299***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11300***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11301***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11302***   TO THIS RECORD.                                        ***
 11303****************************************************************
 11304     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11305     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11306     IF DCUA-SUCCESSFUL-PROCESS
 11307        GO TO 3024-EDIT-DL7-CONT.
 11308
 11309     IF DCUA-RETURN-CODE EQUAL '01'
 11310        MOVE ER-8110               TO WS-ERROR
 11311        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11313        GO TO 3024-EDIT-DL7-CONT.
 11314
 11315     IF DCUA-RETURN-CODE EQUAL '02'
 11316        MOVE ER-8111               TO WS-ERROR
 11317        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11319        GO TO 3024-EDIT-DL7-CONT.
 11320
 11321     IF DCUA-RETURN-CODE EQUAL '03'
 11322        MOVE ER-8074               TO WS-ERROR
 11323        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11324        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11325        GO TO 3024-EDIT-DL7-CONT.
 11326
 11327     IF DCUA-RETURN-CODE EQUAL '04'
 11328        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 207
* EL050.cbl
 11329        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11331        GO TO 3024-EDIT-DL7-CONT.
 11332
 11333     IF DCUA-RETURN-CODE EQUAL '05'
 11334        MOVE ER-8076               TO WS-ERROR
 11335        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11337        GO TO 3024-EDIT-DL7-CONT.
 11338
 11339     IF DCUA-RETURN-CODE EQUAL '06'
 11340        MOVE ER-8077               TO WS-ERROR
 11341        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11342        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11343        GO TO 3024-EDIT-DL7-CONT.
 11344
 11345     IF DCUA-RETURN-CODE EQUAL '07'
 11346        MOVE ER-8078               TO WS-ERROR
 11347        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11348        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11349        GO TO 3024-EDIT-DL7-CONT.
 11350
 11351     IF DCUA-RETURN-CODE EQUAL 'E1'
 11352        MOVE ER-8079               TO WS-ERROR
 11353        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11354        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11355        GO TO 3024-EDIT-DL7-CONT.
 11356
 11357     IF DCUA-RETURN-CODE EQUAL 'E2'
 11358        MOVE ER-8080               TO WS-ERROR
 11359        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11360        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11361        GO TO 3024-EDIT-DL7-CONT.
 11362
 11363     IF DCUA-RETURN-CODE EQUAL 'E3'
 11364        MOVE ER-8098               TO WS-ERROR
 11365        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11367        GO TO 3024-EDIT-DL7-CONT.
 11368
 11369     IF DCUA-RETURN-CODE EQUAL 'C1'
 11370        MOVE ER-8099               TO WS-ERROR
 11371        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11373        GO TO 3024-EDIT-DL7-CONT.
 11374
 11375     IF DCUA-RETURN-CODE EQUAL 'U1'
 11376        MOVE ER-8109               TO WS-ERROR
 11377        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11378        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11379        GO TO 3024-EDIT-DL7-CONT.
 11380
 11381     IF DCUA-RETURN-CODE EQUAL 'N1'
 11382        MOVE ER-8112               TO WS-ERROR
 11383        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11385        GO TO 3024-EDIT-DL7-CONT.
 11386
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 208
* EL050.cbl
 11387     IF DCUA-RETURN-CODE EQUAL 'N2'
 11388        MOVE ER-8113               TO WS-ERROR
 11389        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11390        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11391        GO TO 3024-EDIT-DL7-CONT.
 11392
 11393     IF DCUA-RETURN-CODE EQUAL 'N3'
 11394        MOVE ER-8114               TO WS-ERROR
 11395        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11397        GO TO 3024-EDIT-DL7-CONT.
 11398
 11399     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11400     MOVE ER-8097                  TO WS-ERROR.
 11401     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11402     GO TO 3024-EDIT-DL7-CONT.
 11403
 11404 3024-EDIT-DL7-CONT.
 11405
 11406     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11407     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11408     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11409        NEXT SENTENCE
 11410     ELSE
 11411        MOVE ER-9263               TO WS-ERROR
 11412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11413
 11414******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11415******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11416     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11417        NEXT SENTENCE
 11418     ELSE
 11419        MOVE ER-8039               TO WS-ERROR
 11420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11421
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 209
* EL050.cbl
 11423****************************************************************
 11424*** VALIDATE STATE  : DLO022                                 ***
 11425****************************************************************
 11426     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11427     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11428
 11429     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11430     IF DVSC-SUCCESSFUL-EDIT
 11431        GO TO 3024-EDIT-DL22-CONT.
 11432
 11433     IF DVSC-RETURN-CODE EQUAL '01'
 11434        MOVE ER-8300               TO WS-ERROR
 11435        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11436        GO TO 3024-EDIT-DL22-CONT.
 11437
 11438     IF DVSC-RETURN-CODE EQUAL '02'
 11439        MOVE ER-8301               TO WS-ERROR
 11440        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11441        GO TO 3024-EDIT-DL22-CONT.
 11442
 11443     IF DVSC-RETURN-CODE EQUAL '03'
 11444        MOVE ER-8302               TO WS-ERROR
 11445        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11446        GO TO 3024-EDIT-DL22-CONT.
 11447
 11448     IF DVSC-RETURN-CODE EQUAL 'N1'
 11449        MOVE ER-8304               TO WS-ERROR
 11450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11451        GO TO 3024-EDIT-DL22-CONT.
 11452
 11453     MOVE ER-8303                  TO WS-ERROR
 11454     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11455
 11456 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 210
* EL050.cbl
 11458****************************************************************
 11459*** VALIDATE LOAN OFFICER : DLO021                           ***
 11460****************************************************************
 11461
 11462     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11463     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11464     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11465     IF DVLO-SUCCESSFUL-EDIT
 11466        GO TO 3024-EDIT-DL21-CONT.
 11467
 11468     IF DVLO-RETURN-CODE EQUAL '01'
 11469        MOVE ER-8081               TO WS-ERROR
 11470        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11471        GO TO 3024-EDIT-DL21-CONT.
 11472
 11473     IF DVLO-RETURN-CODE EQUAL '02'
 11474        MOVE ER-8082               TO WS-ERROR
 11475        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11476        GO TO 3024-EDIT-DL21-CONT.
 11477
 11478     IF DVLO-RETURN-CODE EQUAL '03'
 11479        MOVE ER-8083               TO WS-ERROR
 11480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11481        GO TO 3024-EDIT-DL21-CONT.
 11482
 11483     IF DVLO-RETURN-CODE EQUAL '04'
 11484        MOVE ER-8084               TO WS-ERROR
 11485        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11486        GO TO 3024-EDIT-DL21-CONT.
 11487
 11488     IF DVLO-RETURN-CODE EQUAL '05'
 11489        MOVE ER-8085               TO WS-ERROR
 11490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11491        GO TO 3024-EDIT-DL21-CONT.
 11492
 11493     MOVE ER-7825                  TO WS-ERROR
 11494     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11495     GO TO 3024-EDIT-DL21-CONT.
 11496
 11497 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 211
* EL050.cbl
 11499
 11500****************************************************************
 11501*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11502****************************************************************
 11503
 11504     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11505     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11506     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11507     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11508     IF DIPF-SUCCESSFUL-EDIT
 11509        GO TO 3024-EDIT-DL02-CONT.
 11510
 11511     IF DIPF-RETURN-CODE EQUAL '01'
 11512        MOVE ER-8086               TO WS-ERROR
 11513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11514        GO TO 3024-EDIT-DL02-CONT.
 11515
 11516     IF DIPF-RETURN-CODE EQUAL '02'
 11517        MOVE ER-8087               TO WS-ERROR
 11518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11519        GO TO 3024-EDIT-DL02-CONT.
 11520
 11521     IF DIPF-RETURN-CODE EQUAL '03'
 11522        MOVE ER-8088               TO WS-ERROR
 11523        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11524        GO TO 3024-EDIT-DL02-CONT.
 11525
 11526     MOVE ER-8095                  TO WS-ERROR
 11527     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11528     GO TO 3024-EDIT-DL02-CONT.
 11529
 11530 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 212
* EL050.cbl
 11532
 11533****************************************************************
 11534*** VALIDATE BANK ID : DLO003                                ***
 11535****************************************************************
 11536
 11537     MOVE WK-GREG-CENT           TO WCG-CENT.
 11538     MOVE WK-GREG-YYMM           TO WCG-REST.
 11539     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11540        MOVE ER-8040               TO WS-ERROR
 11541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11542
 11543     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11544     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11545     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11546     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11547     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11548     IF DVBI-SUCCESSFUL-EDIT
 11549        GO TO 3024-EDIT-DL03-CONT.
 11550
 11551     IF DVBI-RETURN-CODE EQUAL '01'
 11552        MOVE ER-8089               TO WS-ERROR
 11553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11554        GO TO 3024-EDIT-DL03-CONT.
 11555
 11556     IF DVBI-RETURN-CODE EQUAL '02'
 11557        MOVE ER-8090               TO WS-ERROR
 11558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11559        GO TO 3024-EDIT-DL03-CONT.
 11560
 11561     IF DVBI-RETURN-CODE EQUAL '03'
 11562        MOVE ER-8091               TO WS-ERROR
 11563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11564        GO TO 3024-EDIT-DL03-CONT.
 11565
 11566     IF DVBI-RETURN-CODE EQUAL '04'
 11567        MOVE ER-8092               TO WS-ERROR
 11568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11569        GO TO 3024-EDIT-DL03-CONT.
 11570
 11571     IF DVBI-RETURN-CODE EQUAL '05'
 11572        MOVE ER-8093               TO WS-ERROR
 11573        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11574        GO TO 3024-EDIT-DL03-CONT.
 11575
 11576     IF DVBI-RETURN-CODE EQUAL '06'
 11577        MOVE ER-8094               TO WS-ERROR
 11578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11579        GO TO 3024-EDIT-DL03-CONT.
 11580
 11581     MOVE ER-8096                  TO WS-ERROR
 11582     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11583     GO TO 3024-EDIT-DL03-CONT.
 11584
 11585 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 213
* EL050.cbl
 11587
 11588     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11589        NEXT SENTENCE
 11590     ELSE
 11591        MOVE ER-8042               TO WS-ERROR
 11592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11593
 11594     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11595     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11596     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11597
 11598     IF DMPF-RETURN-CODE = '01'
 11599        MOVE ER-8067               TO WS-ERROR
 11600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601        GO TO 3024-EDIT-DL01-CONT.
 11602
 11603     IF DMPF-RETURN-CODE = '02'
 11604        MOVE ER-8068               TO WS-ERROR
 11605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11606        GO TO 3024-EDIT-DL01-CONT.
 11607
 11608     IF DMPF-RETURN-CODE = '03'
 11609        MOVE ER-8069               TO WS-ERROR
 11610        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11611        GO TO 3024-EDIT-DL01-CONT.
 11612
 11613     IF DMPF-RETURN-CODE = 'E1'
 11614        MOVE ER-8070               TO WS-ERROR
 11615        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11616        GO TO 3024-EDIT-DL01-CONT.
 11617
 11618     IF DMPF-RETURN-CODE = 'N1'
 11619        MOVE ER-8071               TO WS-ERROR
 11620        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11621        GO TO 3024-EDIT-DL01-CONT.
 11622
 11623     IF DMPF-RETURN-CODE NOT = 'OK'
 11624        MOVE ER-8072               TO WS-ERROR
 11625        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11626
 11627 3024-EDIT-DL01-CONT.
 11628******************************************************************
 11629***  VALIDATES RATE CODES : DLO017                             ***
 11630******************************************************************
 11631
 11632      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11633      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11634      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11635      IF DVRC-SUCCESSFUL-EDIT
 11636        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11637        GO TO 3024-CHECK-VALID-RATE.
 11638
 11639      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11640
 11641      IF DVRC-RETURN-CODE EQUAL '01'
 11642         MOVE ER-7817                   TO WS-ERROR
 11643         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11644         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 214
* EL050.cbl
 11645
 11646      IF DVRC-RETURN-CODE EQUAL '02'
 11647         MOVE ER-7818                   TO WS-ERROR
 11648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11649         GO TO 3025-EDIT-REINSURANCE.
 11650
 11651      IF DVRC-RETURN-CODE EQUAL '03'
 11652         MOVE ER-7819                   TO WS-ERROR
 11653         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11654         GO TO 3025-EDIT-REINSURANCE.
 11655
 11656       MOVE ER-7820                     TO WS-ERROR.
 11657       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11658       GO TO 3025-EDIT-REINSURANCE.
 11659
 11660******************************************************************
 11661***  GET PREMIUM RATES : DLO011                                ***
 11662******************************************************************
 11663
 11664 3024-CHECK-VALID-RATE.
 11665
 11666     IF VALID-RATE-CODE
 11667        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11668        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11669        MOVE SPACES                TO DPRB-RETURN-CODE
 11670        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11671     ELSE
 11672         GO TO 3025-EDIT-REINSURANCE.
 11673
 11674      IF DPRB-SUCCESSFUL-PROCESS
 11675         IF PB-VALID-LIFE
 11676             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11677             GO TO 3025-EDIT-REINSURANCE
 11678         ELSE
 11679             IF PB-VALID-AH
 11680                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11681                 GO TO 3025-EDIT-REINSURANCE.
 11682
 11683      IF DPRB-RETURN-CODE EQUAL '01'
 11684         MOVE ER-7812                   TO WS-ERROR
 11685         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11686         GO TO 3025-EDIT-REINSURANCE.
 11687
 11688      IF DPRB-RETURN-CODE EQUAL '02'
 11689         MOVE ER-7813                   TO WS-ERROR
 11690         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11691         GO TO 3025-EDIT-REINSURANCE.
 11692
 11693      IF DPRB-RETURN-CODE EQUAL '03'
 11694         MOVE ER-7814                   TO WS-ERROR
 11695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11696         GO TO 3025-EDIT-REINSURANCE.
 11697
 11698      IF DPRB-RETURN-CODE EQUAL '04'
 11699         IF NOT DPRB-1ST-TIME
 11700            MOVE ER-7815                   TO WS-ERROR
 11701            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11702            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 215
* EL050.cbl
 11703          ELSE
 11704         IF PB-VALID-LIFE
 11705            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11706          ELSE
 11707            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11708         END-IF
 11709         MOVE SPACES                TO DOCC-RETURN-CODE
 11710         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11711         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11712         IF DOCC-RETURN-CODE = 'OK'
 11713             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11714             GO TO 3024-CHECK-VALID-RATE
 11715           ELSE
 11716             MOVE ER-7823               TO WS-ERROR
 11717             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11718             GO TO 3025-EDIT-REINSURANCE.
 11719
 11720       MOVE ER-7816                     TO WS-ERROR.
 11721       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11722       GO TO 3025-EDIT-REINSURANCE.
 11723
 11724**********   DMD CUSTOM CODE ABOVE    **********
 11725
 11726 3025-EDIT-REINSURANCE.
 11727     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11728         GO TO 3027-EDIT-CONTINUE.
 11729
 11730     MOVE LOW-VALUES               TO ERREIN-KEY.
 11731     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11732     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11733                                      REIN-CODE-2
 11734                                      REIN-CODE-3.
 11735     MOVE 'A'                      TO REIN-TYPE.
 11736
 11737     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11738
 11739     MOVE '3026' TO REIN-SW.
 11740     MOVE ' '                   TO WS-REIN-READ-SW.
 11741
 11742     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11743     IF REIN-TABLE-NOT-FOUND
 11744         GO TO 3026-NO-SPEC-TABLE.
 11745
 11746     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11747     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11748                                   WS-NSP-ST-CD-LF.
 11749     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11750                                   WS-NSP-ST-CD-AH.
 11751
 11752     GO TO 3040-EDIT-CONTINUE.
 11753
 11754 3026-NO-SPEC-TABLE.
 11755
 11756     MOVE ER-2664                TO WS-ERROR.
 11757     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11758     GO TO 3040-EDIT-CONTINUE.
 11759
 11760 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 216
* EL050.cbl
 11761
 11762     IF PB-I-REIN-TABLE = SPACES
 11763       GO TO 3040-EDIT-CONTINUE.
 11764
 11765     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11766          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11767          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11768           GO TO 3040-EDIT-CONTINUE.
 11769
 11770     MOVE LOW-VALUES            TO ERREIN-KEY.
 11771     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11772     MOVE 'A'                   TO REIN-TYPE.
 11773     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11774
 11775     MOVE '3028'                TO REIN-SW.
 11776     MOVE ' '                   TO WS-REIN-READ-SW.
 11777
 11778     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11779     IF REIN-TABLE-NOT-FOUND
 11780         GO TO 3028-NO-REIN-TABLE.
 11781
 11782     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11783     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11784                                   WS-NSP-ST-CD-LF.
 11785     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11786                                   WS-NSP-ST-CD-AH.
 11787
 11788     GO TO 3040-EDIT-CONTINUE.
 11789
 11790 3028-NO-REIN-TABLE.
 11791
 11792     MOVE ER-2615                TO WS-ERROR.
 11793     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11794     GO TO 3040-EDIT-CONTINUE.
 11795
 11796 3040-EDIT-CONTINUE.
 11797
 11798     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11799         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11800
 11801     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11802         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11803
 11804     IF (NOT PB-REISSUED-CERT)
 11805        AND (NOT PB-MONTHLY-CERT)
 11806        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11807            MOVE '001'           TO PB-I-LF-TERM
 11808            MOVE 'M'             TO PB-I-INSURED-SEX.
 11809
 11810     IF (NOT PB-REISSUED-CERT)
 11811        AND (NOT PB-MONTHLY-CERT)
 11812        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11813            MOVE '001'           TO PB-I-AH-TERM
 11814            MOVE 'M'             TO PB-I-INSURED-SEX.
 11815
 11816 3040-EDIT-1ST-PMT-DT.
 11817     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11818     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 217
* EL050.cbl
 11819         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11820
 11821******************************************************************
 11822*                                                                *
 11823*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11824*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11825*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11826*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11827*                                                                *
 11828******************************************************************
 11829
 11830     IF PB-EFF-DT-PROCESSING
 11831        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11832                                    PB-I-LF-EXPIRE-DT
 11833                                    PB-I-AH-EXPIRE-DT
 11834        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11835        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11836        MOVE ZERO                TO DC-ELAPSED-DAYS
 11837        MOVE +1                  TO DC-ELAPSED-MONTHS
 11838        SET BIN-PLUS-ELAPSED     TO TRUE
 11839*       MOVE 6                   TO DC-OPTION-CODE
 11840        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11841        IF NO-CONVERSION-ERROR
 11842           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11843
 11844******************************************************************
 11845*                                                                *
 11846*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11847*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11848*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11849*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11850*                                                                *
 11851******************************************************************
 11852
 11853     IF PB-EXT-DAYS-PROCESSING
 11854          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11855                                         PB-I-LF-EXPIRE-DT
 11856                                         PB-I-AH-EXPIRE-DT
 11857          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11858          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11859          MOVE +1                     TO DC-ELAPSED-MONTHS
 11860          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11861          SET BIN-PLUS-ELAPSED        TO TRUE
 11862*         MOVE 6                      TO DC-OPTION-CODE
 11863          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11864          IF NO-CONVERSION-ERROR
 11865             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11866
 11867******************************************************************
 11868*                                                                *
 11869*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11870*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11871*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11872*        (EXPIRE DATE - (TERM -1))  *  -1.
 11873*                                                                *
 11874******************************************************************
 11875
 11876     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 218
* EL050.cbl
 11877        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11878           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11879              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11880              MOVE PB-I-AH-TERM      TO WS-TERM
 11881           ELSE
 11882              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11883              MOVE PB-I-LF-TERM      TO WS-TERM
 11884        ELSE
 11885           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11886              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11887              MOVE PB-I-LF-TERM      TO WS-TERM
 11888           ELSE
 11889              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11890              MOVE PB-I-AH-TERM      TO WS-TERM.
 11891
 11892     IF PB-EXPIRE-DT-PROCESSING
 11893        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11894        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11895        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11896        MOVE ZERO                TO DC-ELAPSED-DAYS
 11897                                    DC-ODD-DAYS-OVER
 11898          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11899          SET BIN-PLUS-ELAPSED    TO TRUE
 11900*         MOVE 6                  TO DC-OPTION-CODE
 11901          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11902          IF NO-CONVERSION-ERROR
 11903             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11904
 11905******************************************************************
 11906*                                                                *
 11907*            1ST PAYMENT DATE PROCESSING                         *
 11908*                                                                *
 11909******************************************************************
 11910
 11911     IF PB-1ST-PMT-DT-PROCESSING
 11912        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11913                                    PB-I-AH-EXPIRE-DT
 11914        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11915
 11916     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11917         NEXT SENTENCE
 11918     ELSE
 11919         MOVE ER-2680                 TO WS-ERROR
 11920         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11921         GO TO 3060-ORIG-TERM-CHECK.
 11922
 11923     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11924     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11925     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11926*    MOVE 1                      TO DC-OPTION-CODE.
 11927     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11928                                    DC-ELAPSED-DAYS
 11929                                    DC-ODD-DAYS-OVER.
 11930
 11931     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11932
 11933     IF DATE-CONVERSION-ERROR
 11934        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 219
* EL050.cbl
 11935
 11936     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11937     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11938        AND (WS-LF-COVERAGE-TYPE = 'L')
 11939        IF (DC-ELAPSED-MONTHS > 1)
 11940                      OR
 11941           ((DC-ELAPSED-MONTHS = 1)
 11942           AND (DC-ODD-DAYS-OVER > 0))
 11943           MOVE ER-2882          TO WS-ERROR
 11944           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11945        END-IF
 11946     END-IF
 11947     if dc-elapsed-months > 0
 11948        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 11949        + dc-odd-days-over
 11950     end-if
 11951     IF PB-EXT-DAYS-PROCESSING
 11952        CONTINUE
 11953     ELSE
 11954        IF DC-ELAPSED-MONTHS = +0
 11955           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11956        ELSE
 11957           IF (WS-LF-EARNINGS-CALC = '4')
 11958              AND (DC-ELAPSED-MONTHS > ZERO)
 11959              AND (DC-ELAPSED-DAYS > ZERO)
 11960              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11961           ELSE
 11962              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11963                                 THRU 6499-EXIT
 11964              MOVE WS-ODD-DAYS-OVER
 11965                                 TO PB-I-EXTENTION-DAYS
 11966           END-IF
 11967        END-IF
 11968     END-IF
 11969******************************************************************
 11970*                                                                *
 11971*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11972*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11973*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11974*            AND ANY ODD DAYS.                                   *
 11975*                                                                *
 11976******************************************************************
 11977
 11978     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11979                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11980     IF WS-LF-EARNINGS-CALC NOT = '4'
 11981        IF DC-ELAPSED-DAYS > ZEROS
 11982           MOVE ER-2681          TO WS-ERROR
 11983           PERFORM 9900-ERROR-FORMAT
 11984                                 THRU 9900-EXIT
 11985        END-IF
 11986     END-IF
 11987
 11988     IF WS-LF-EARNINGS-CALC NOT = '4'
 11989        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11990           MOVE ER-2681          TO WS-ERROR
 11991           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11992
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 220
* EL050.cbl
 11993     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11994        (PB-I-LF-TERM NOT = ZERO) AND
 11995         NOT NO-LIFE-COVERAGE
 11996          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 11997          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11998          IF WS-LF-EARNINGS-CALC = '4'
 11999             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12000             PB-I-PAY-FREQUENCY
 12001          END-IF
 12002          MOVE ZERO              TO DC-ELAPSED-DAYS
 12003                                    DC-ODD-DAYS-OVER
 12004          MOVE 1                 TO DC-END-OF-MONTH
 12005          SET BIN-PLUS-ELAPSED        TO TRUE
 12006*         MOVE 6                 TO DC-OPTION-CODE
 12007          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12008          IF NO-CONVERSION-ERROR
 12009             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12010             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12011                (WS-LF-SPECIAL-CALC-CD = 'L')
 12012                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12013                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12014                  MOVE +1             TO DC-ELAPSED-MONTHS
 12015                  SET BIN-PLUS-ELAPSED  TO TRUE
 12016*                 MOVE 6              TO DC-OPTION-CODE
 12017                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12018                  IF NO-CONVERSION-ERROR
 12019                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12020
 12021* okay, i had to move the new att age edit down here because the
 12022* expiration date could get recalculated and i need the exp date
 12023     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12024        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12025        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12026        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12027           AND ZEROS
 12028           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12029           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12030           SET ELAPSED-BETWEEN-BIN TO TRUE
 12031           PERFORM 8500-DATE-CONVERT
 12032                                 THRU 8500-EXIT
 12033           IF NO-CONVERSION-ERROR
 12034              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12035                 MOVE ER-2669       TO WS-ERROR
 12036*                PERFORM 9900-ERROR-FORMAT
 12037*                                THRU 9900-EXIT
 12038              END-IF
 12039           END-IF
 12040        ELSE
 12041           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12042           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12043              MOVE ER-2669       TO WS-ERROR
 12044*             PERFORM 9900-ERROR-FORMAT
 12045*                                THRU 9900-EXIT
 12046           ELSE
 12047              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12048                 MOVE ER-1570    TO WS-ERROR
 12049                 PERFORM 9900-ERROR-FORMAT
 12050                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 221
* EL050.cbl
 12051              END-IF
 12052           END-IF
 12053        END-IF
 12054        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12055           AND ZEROS
 12056           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12057           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12058           SET ELAPSED-BETWEEN-BIN TO TRUE
 12059           PERFORM 8500-DATE-CONVERT
 12060                                 THRU 8500-EXIT
 12061           IF NO-CONVERSION-ERROR
 12062              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12063                 MOVE ER-2669       TO WS-ERROR
 12064*                PERFORM 9900-ERROR-FORMAT
 12065*                                THRU 9900-EXIT
 12066              END-IF
 12067           END-IF
 12068        ELSE
 12069           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12070             (PB-I-LF-TERM / 12)
 12071           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12072              MOVE ER-2669       TO WS-ERROR
 12073*             PERFORM 9900-ERROR-FORMAT
 12074*                                THRU 9900-EXIT
 12075           ELSE
 12076              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12077                 MOVE ER-1571    TO WS-ERROR
 12078                 PERFORM 9900-ERROR-FORMAT
 12079                                 THRU 9900-EXIT
 12080              END-IF
 12081           END-IF
 12082        END-IF
 12083        IF WS-ERROR = ER-2669
 12084           PERFORM 9900-ERROR-FORMAT
 12085                                 THRU 9900-EXIT
 12086        END-IF
 12087     END-IF
 12088     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12089        (PB-I-AH-TERM NOT = ZERO) AND
 12090         NOT NO-AH-COVERAGE
 12091          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12092             AND (PB-COMPANY-ID = 'DCC')
 12093             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12094             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12095          ELSE
 12096             IF WS-LF-EARNINGS-CALC = '4'
 12097                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12098                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12099                PB-I-PAY-FREQUENCY
 12100             ELSE
 12101                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12102                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12103             END-IF
 12104          END-IF
 12105          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12106                                         DC-ODD-DAYS-OVER
 12107          MOVE 1                      TO DC-END-OF-MONTH
 12108          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 222
* EL050.cbl
 12109*         MOVE 6                      TO DC-OPTION-CODE
 12110          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12111          IF NO-CONVERSION-ERROR
 12112             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12113     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12114        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12115        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12116        IF PB-I-BIRTHDAY > LOW-VALUES
 12117           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12118           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12119           SET ELAPSED-BETWEEN-BIN TO TRUE
 12120           PERFORM 8500-DATE-CONVERT
 12121                                 THRU 8500-EXIT
 12122           IF NO-CONVERSION-ERROR
 12123              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12124                 MOVE ER-3054       TO WS-ERROR
 12125*                PERFORM 9900-ERROR-FORMAT
 12126*                                THRU 9900-EXIT
 12127              END-IF
 12128           END-IF
 12129        ELSE
 12130           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12131           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12132              MOVE ER-3054       TO WS-ERROR
 12133*             PERFORM 9900-ERROR-FORMAT
 12134*                                THRU 9900-EXIT
 12135           END-IF
 12136        END-IF
 12137        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12138           AND ZEROS
 12139           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12140           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12141           SET ELAPSED-BETWEEN-BIN TO TRUE
 12142           PERFORM 8500-DATE-CONVERT
 12143                                 THRU 8500-EXIT
 12144           IF NO-CONVERSION-ERROR
 12145              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12146                 MOVE ER-3054       TO WS-ERROR
 12147*                PERFORM 9900-ERROR-FORMAT
 12148*                                THRU 9900-EXIT
 12149              END-IF
 12150           END-IF
 12151        ELSE
 12152           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12153             (PB-I-AH-TERM / 12)
 12154           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12155              MOVE ER-3054       TO WS-ERROR
 12156*             PERFORM 9900-ERROR-FORMAT
 12157*                                THRU 9900-EXIT
 12158           END-IF
 12159        END-IF
 12160        IF WS-ERROR = ER-3054
 12161           PERFORM 9900-ERROR-FORMAT
 12162                                 THRU 9900-EXIT
 12163        END-IF
 12164     END-IF
 12165     MOVE SPACE                       TO DC-END-OF-MONTH.
 12166
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 223
* EL050.cbl
 12167     IF PB-COMPANY-ID = 'NCB'
 12168        GO TO 3040-EDIT-EXTENSION-DAYS.
 12169
 12170     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12171       AND
 12172        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12173        NEXT SENTENCE
 12174     ELSE
 12175        GO TO 3040-EDIT-EXTENSION-DAYS.
 12176
 12177     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12178        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12179        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12180     ELSE
 12181        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12182        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12183
 12184     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12185*    MOVE '1'      TO DC-OPTION-CODE
 12186     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12187     IF (NO-CONVERSION-ERROR)
 12188        AND (DC-ELAPSED-MONTHS > +1)
 12189        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12190        MOVE ER-2668   TO WS-ERROR
 12191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12192
 12193 3040-EDIT-EXTENSION-DAYS.
 12194
 12195     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12196        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12197         GO TO 3050-EDIT-TERM-IN-DAYS
 12198     ELSE
 12199         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12200
 12201     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12202         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12203     ELSE
 12204        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12205           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12206           MOVE ER-2681         TO WS-ERROR
 12207           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12208
 12209     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12210        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12211        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12212         GO TO 3060-ORIG-TERM-CHECK.
 12213
 12214     GO TO 3060-ORIG-TERM-CHECK.
 12215
 12216 3050-EDIT-TERM-IN-DAYS.
 12217
 12218     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12219
 12220     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12221         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12222     ELSE
 12223         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12224            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 224
* EL050.cbl
 12225            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12226
 12227     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12228                                       REMAINDER WS-WORK-TERM.
 12229     IF WS-WORK-TERM GREATER THAN ZERO
 12230         ADD +1 TO PB-I-LF-TERM.
 12231
 12232     IF NOT NO-AH-COVERAGE
 12233         MOVE ER-2684            TO WS-ERROR
 12234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12235
 12236
 12237 3060-ORIG-TERM-CHECK.
 12238
 12239******************************************************************
 12240*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12241******************************************************************
 12242
 12243     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12244        NEXT SENTENCE
 12245     ELSE
 12246        IF NOT NO-LIFE-COVERAGE
 12247           IF PB-I-LF-TERM NUMERIC
 12248              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12249              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12250              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12251                  NEXT SENTENCE
 12252           ELSE
 12253              MOVE ER-2647       TO WS-ERROR
 12254              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12255
 12256     IF NOT NO-AH-COVERAGE
 12257         IF PB-I-AH-TERM NUMERIC
 12258            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12259            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12260            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12261             NEXT SENTENCE
 12262          ELSE
 12263              MOVE ER-2658       TO WS-ERROR
 12264              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12265
 12266     IF PB-COMPANY-ID = 'NCB'
 12267        GO TO 3070-LOAN-TERM-CHECK.
 12268
 12269     IF POLICY-HAS-AH
 12270       AND
 12271        POLICY-HAS-LIFE
 12272       AND
 12273        PB-I-LF-TERM NUMERIC
 12274       AND
 12275        PB-I-AH-TERM NUMERIC
 12276        NEXT SENTENCE
 12277     ELSE
 12278        GO TO 3070-LOAN-TERM-CHECK.
 12279
 12280     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12281     IF WS-TEX-FACT-2 LESS THAN +0
 12282        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 225
* EL050.cbl
 12283
 12284     IF WS-TEX-FACT-2 GREATER THAN +1
 12285        MOVE ER-2668             TO WS-ERROR
 12286        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12287
 12288 3070-LOAN-TERM-CHECK.
 12289
 12290     IF (WS-LF-BENEFIT-CD = ZERO)
 12291         OR (NO-LF-BENEFIT-MATCH)
 12292            GO TO 3125-EDIT-PMT-FREQ.
 12293*    IF PB-COMPANY-ID NOT = 'DCC'
 12294*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12295*          AND 'V' AND 'W' AND 'X'
 12296*          GO TO 3125-EDIT-PMT-FREQ
 12297*       END-IF
 12298*    ELSE
 12299*       IF WS-AH-DCC-TRUNC = 'T'
 12300*          CONTINUE
 12301*       ELSE
 12302*          GO TO 3125-EDIT-PMT-FREQ
 12303*       END-IF
 12304*    END-IF
 12305     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12306                    OR
 12307        ((PB-COMPANY-ID = 'DCC')
 12308        AND (WS-AH-DCC-TRUNC = 'T'))
 12309        CONTINUE
 12310     ELSE
 12311        GO TO 3125-EDIT-PMT-FREQ
 12312     END-IF
 12313     IF PB-I-LOAN-TERM NOT NUMERIC
 12314         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12315
 12316     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12317        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12318*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12319        PB-I-LOAN-TERM NOT GREATER THAN +360
 12320         NEXT SENTENCE
 12321     ELSE
 12322         MOVE ER-2648            TO WS-ERROR
 12323         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12324
 12325     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12326        MOVE ER-3058             TO WS-ERROR
 12327        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12328     end-if
 12329
 12330     IF WS-STATE-ABBREVIATION = 'NC'
 12331        IF PB-I-LOAN-TERM > +59
 12332           CONTINUE
 12333        ELSE
 12334           MOVE ER-2792          TO WS-ERROR
 12335           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12336        END-IF
 12337     END-IF
 12338
 12339     .
 12340 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 226
* EL050.cbl
 12341     IF (WS-LF-BENEFIT-CD = ZERO)
 12342         OR (NO-LF-BENEFIT-MATCH)
 12343            GO TO 3127-EDIT-LOAN-OFFICER.
 12344     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12345                    OR
 12346        ((PB-COMPANY-ID = 'DCC')
 12347        AND (WS-AH-DCC-TRUNC = 'T'))
 12348                    OR
 12349         (PB-COMPANY-ID = 'AHL')
 12350        CONTINUE
 12351     ELSE
 12352        IF (PB-I-LOAN-TERM > ZEROS)
 12353           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12354           MOVE ER-1575          TO WS-ERROR
 12355           PERFORM 9900-ERROR-FORMAT
 12356                                 THRU 9900-EXIT
 12357        END-IF
 12358     END-IF
 12359     IF WS-LF-EARNINGS-CALC NOT = '4'
 12360         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12361            MOVE ER-2653         TO WS-ERROR
 12362            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12363            GO TO 3127-EDIT-LOAN-OFFICER
 12364         ELSE
 12365            GO TO 3127-EDIT-LOAN-OFFICER.
 12366
 12367     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12368         MOVE ER-2655            TO WS-ERROR
 12369         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12370         GO TO 3127-EDIT-LOAN-OFFICER.
 12371
 12372     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12373         MOVE ER-2654            TO WS-ERROR
 12374         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12375         GO TO 3127-EDIT-LOAN-OFFICER.
 12376
 12377     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12378         GIVING WS-TEX-FACT-2
 12379             REMAINDER WS-TEX-FACT-3.
 12380
 12381*    IF WS-TEX-FACT-3 NOT = ZERO
 12382*       MOVE ER-2654             TO WS-ERROR
 12383*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12384
 12385
 12386 3127-EDIT-LOAN-OFFICER.
 12387
 12388     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12389        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12390           MOVE ER-2690          TO WS-ERROR
 12391           PERFORM 9900-ERROR-FORMAT
 12392                                 THRU 9900-EXIT
 12393        ELSE
 12394           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12395           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12396           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12397           MOVE PB-SV-STATE      TO LOFC-STATE
 12398           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 227
* EL050.cbl
 12399           MOVE PB-I-LOAN-OFFICER
 12400                                 TO LOFC-CODE
 12401           PERFORM 8586-READ-LOAN-OFFICER
 12402                                 THRU 8586-EXIT
 12403           IF (NOT LOFC-MASTER-FOUND)
 12404              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12405              MOVE ER-3006       TO WS-ERROR
 12406              PERFORM 9900-ERROR-FORMAT
 12407                                 THRU 9900-EXIT
 12408           END-IF
 12409        END-IF
 12410     END-IF
 12411     .
 12412 3129-EDIT-APR.
 12413
 12414     IF (WS-LF-BENEFIT-CD = ZERO)
 12415        OR (NO-LF-BENEFIT-MATCH)
 12416        IF PB-COMPANY-ID NOT = 'DCC'
 12417           GO TO 3130-EDIT-AGE
 12418*       ELSE
 12419*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12420*             GO TO 3130-EDIT-AGE
 12421*          END-IF
 12422        END-IF
 12423     END-IF
 12424
 12425     IF (WS-STATE-ABBREVIATION = 'OH')
 12426         AND (PB-I-RATE-CLASS NOT = 'L ')
 12427         AND (PB-I-LF-TERM GREATER THAN 60)
 12428         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12429         GO TO 3129-APR-CONT.
 12430
 12431     IF (WS-STATE-ABBREVIATION = 'RI')
 12432         AND (PB-I-LF-TERM GREATER THAN 60)
 12433         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12434         GO TO 3129-APR-CONT.
 12435
 12436     IF (WS-STATE-ABBREVIATION = 'UT')
 12437         AND (PB-I-LF-TERM GREATER THAN 62)
 12438         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12439         AND (PB-CERT-EFF-DT LESS WS-830901)
 12440         GO TO 3129-APR-CONT.
 12441
 12442     IF PB-COMPANY-ID = 'LAP'
 12443        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12444           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12445              MOVE ER-2656         TO WS-ERROR
 12446              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12447              GO TO 3130-EDIT-AGE.
 12448
 12449     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12450        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12451        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12452        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12453        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12454        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12455         GO TO 3130-EDIT-AGE.
 12456
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 228
* EL050.cbl
 12457 3129-APR-CONT.
 12458     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12459         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12460         GO TO 3130-EDIT-AGE.
 12461
 12462     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12463         WS-AH-BENEFIT-CD (1:1) = 'S')
 12464        AND (PB-COMPANY-ID = 'DCC')
 12465        AND (PB-I-LOAN-APR = ZERO)
 12466        MOVE ER-2657             TO WS-ERROR
 12467        PERFORM 9900-ERROR-FORMAT
 12468                                 THRU 9900-EXIT
 12469        GO TO 3130-EDIT-AGE
 12470     END-IF
 12471     IF PB-I-LOAN-APR = ZERO
 12472        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12473     END-IF
 12474
 12475     IF PB-I-LOAN-APR = ZERO
 12476        MOVE ER-2656             TO WS-ERROR
 12477        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12478        GO TO 3130-EDIT-AGE.
 12479
 12480*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12481     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12482        MOVE ER-2657             TO WS-ERROR
 12483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12484
 12485 3130-EDIT-AGE.
 12486
 12487******************************************************************
 12488*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12489******************************************************************
 12490
 12491     IF NOT NO-LIFE-COVERAGE
 12492        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12493           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12494               MOVE ER-2628             TO WS-ERROR
 12495               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12496
 12497     IF NOT NO-AH-COVERAGE
 12498        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12499           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12500               MOVE ER-2628         TO WS-ERROR
 12501               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12502
 12503 3133-SEX-CODE.
 12504     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12505         IF WS-DEFAULT-SEX = 'M'
 12506             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12507          ELSE
 12508             IF WS-DEFAULT-SEX = 'F'
 12509             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12510
 12511     IF PB-I-INSURED-SEX = '1'
 12512         MOVE 'M' TO PB-I-INSURED-SEX.
 12513
 12514     IF PB-I-INSURED-SEX = '2'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 229
* EL050.cbl
 12515         MOVE 'F' TO PB-I-INSURED-SEX.
 12516
 12517 3134-SIG-SW-EDIT.
 12518     IF PB-I-SIG-SW = SPACE
 12519         MOVE 'N'                TO  PB-I-SIG-SW.
 12520
 12521     IF PB-COMPANY-ID = 'NCL'
 12522         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12523             NEXT SENTENCE
 12524         ELSE
 12525             MOVE ER-1923        TO  WS-ERROR
 12526             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12527     ELSE
 12528     IF PB-COMPANY-ID = 'CRI'
 12529         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12530             NEXT SENTENCE
 12531         ELSE
 12532             MOVE ER-2606        TO  WS-ERROR
 12533             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12534     ELSE
 12535     IF PB-COMPANY-ID = 'TMS'
 12536         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12537             NEXT SENTENCE
 12538         ELSE
 12539             MOVE ER-2689        TO  WS-ERROR
 12540             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12541     ELSE
 12542         IF PB-I-SIG-SW = 'Y' OR 'N'
 12543             NEXT SENTENCE
 12544         ELSE
 12545             MOVE ER-2651        TO  WS-ERROR
 12546             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12547
 12548     IF PB-COMPANY-ID = 'FLA'
 12549         IF (WS-EDIT-AGE GREATER 54  OR
 12550             WS-AH-EDIT-AGE GREATER 54)  AND
 12551            PB-I-SIG-SW = 'N'
 12552            MOVE ER-2651         TO  WS-ERROR
 12553            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12554
 12555 3135-NAME-EDIT.
 12556
 12557     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12558        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12559        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12560           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12561                                 TO PB-I-JOINT-FIRST-NAME
 12562        END-PERFORM
 12563     END-IF
 12564     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12565        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12566        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12567           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12568                                 TO PB-I-JOINT-LAST-NAME
 12569        END-PERFORM
 12570     END-IF
 12571     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12572        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 230
* EL050.cbl
 12573        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12574           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12575                                 TO PB-I-INSURED-FIRST-NAME
 12576        END-PERFORM
 12577     END-IF
 12578     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12579        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12580        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12581           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12582                                 TO PB-I-INSURED-LAST-NAME
 12583        END-PERFORM
 12584     END-IF
 12585     IF PB-I-INSURED-LAST-NAME = SPACES
 12586       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12587       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12588           MOVE ER-2660    TO WS-ERROR
 12589           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12590
 12591 3136-EDIT-SEX.
 12592
 12593******************************************************************
 12594*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12595******************************************************************
 12596
 12597     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12598        (WS-AH-SPECIAL-CALC-CD = 'O')
 12599        NEXT SENTENCE
 12600     ELSE
 12601        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12602           NEXT SENTENCE
 12603        ELSE
 12604           MOVE ER-2629            TO WS-ERROR
 12605           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12606
 12607 3137-EDIT-EFF-DATE.
 12608
 12609     IF PB-REISSUED-CERT       OR
 12610        PB-POLICY-IS-DECLINED  OR
 12611        PB-POLICY-IS-VOIDED
 12612         GO TO 3139-EDIT-COVERAGE-CODES.
 12613
 12614     MOVE SPACE                  TO WS-2671-SW
 12615                                    WS-2672-SW.
 12616
 12617     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12618         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12619             MOVE ER-2703        TO WS-ERROR
 12620             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12621             GO TO 3139-EDIT-COVERAGE-CODES.
 12622
 12623     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12624         GO TO 3139-EDIT-COVERAGE-CODES.
 12625
 12626     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12627     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12628*    MOVE '1'                    TO DC-OPTION-CODE.
 12629     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12630     MOVE +0                     TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 231
* EL050.cbl
 12631                                    DC-ELAPSED-DAYS.
 12632     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12633
 12634     IF DATE-CONVERSION-ERROR
 12635         GO TO 3139-EDIT-COVERAGE-CODES.
 12636
 12637     IF DC-ELAPSED-DAYS GREATER +180
 12638         MOVE ER-2672            TO WS-ERROR
 12639         MOVE 'Y'                TO WS-2672-SW
 12640         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12641     END-IF
 12642
 12643     IF WS-ERROR = ER-2671  AND
 12644        PB-COMPANY-ID  = 'LBL'
 12645        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12646        MOVE SPACE               TO WS-2671-SW
 12647        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12648
 12649     IF PB-ISSUE-DATE-FORCED  AND
 12650      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12651         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12652         MOVE ER-2673            TO WS-ERROR
 12653         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12654         MOVE SPACE              TO WS-2671-SW
 12655                                    WS-2672-SW.
 12656
 12657     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12658         IF PB-ISSUE-DATE-FORCED
 12659             MOVE ER-2600          TO  WS-ERROR
 12660             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12661         ELSE
 12662             MOVE ER-2692          TO  WS-ERROR
 12663             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12664
 12665
 12666 3139-EDIT-COVERAGE-CODES.
 12667
 12668     if pb-company-id not = 'AHL'
 12669        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12670           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12671           MOVE ER-2787          TO WS-ERROR
 12672           PERFORM 9900-ERROR-FORMAT
 12673                                 THRU 9900-EXIT
 12674        END-IF
 12675     end-if
 12676     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12677        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12678                                 > 250000.00
 12679           MOVE ER-2719          TO WS-ERROR
 12680           PERFORM 9900-ERROR-FORMAT
 12681                                 THRU 9900-EXIT
 12682        END-IF
 12683     END-IF
 12684
 12685     IF PB-POLICY-IS-DECLINED  OR
 12686        PB-POLICY-IS-VOIDED
 12687         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12688
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 232
* EL050.cbl
 12689     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12690        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12691         MOVE ER-2630                TO WS-ERROR
 12692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12693
 12694     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12695        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12696        PB-I-LF-PREMIUM-AMT = ZERO
 12697         GO TO 3140-CHECK-AH-FOR-ZERO.
 12698
 12699     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12700        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12701        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12702         GO TO 3140-CHECK-AH-FOR-ZERO.
 12703
 12704     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12705        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12706        MOVE ER-2631             TO WS-ERROR
 12707        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12708     END-IF
 12709
 12710
 12711******************************************************************
 12712*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12713******************************************************************
 12714
 12715     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12716        NEXT SENTENCE
 12717     ELSE
 12718        IF PB-I-LF-BENEFIT-AMT = ZERO
 12719           MOVE ER-2632             TO WS-ERROR
 12720           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12721
 12722
 12723******************************************************************
 12724*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12725******************************************************************
 12726
 12727     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12728        CONTINUE
 12729     ELSE
 12730        IF PB-I-LF-PREMIUM-AMT = ZERO
 12731           IF (NOT PB-COMP-LF-PREM)
 12732              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12733              MOVE ER-2633       TO WS-ERROR
 12734              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12735           END-IF
 12736        END-IF
 12737     END-IF
 12738     .
 12739 3140-CHECK-AH-FOR-ZERO.
 12740
 12741     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12742        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12743        PB-I-AH-PREMIUM-AMT = ZERO
 12744         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12745
 12746     IF PB-COMPANY-ID = 'CSL'  AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 233
* EL050.cbl
 12747        PB-I-AH-BENEFIT-CD = ZERO  AND
 12748        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12749        PB-I-AH-PREMIUM-AMT = ZERO
 12750         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12751
 12752     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12753        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12754        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12755         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12756
 12757     IF PB-I-AH-BENEFIT-CD = ZERO
 12758         MOVE ER-2634            TO WS-ERROR
 12759         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12760
 12761******************************************************************
 12762*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12763******************************************************************
 12764
 12765     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12766        NEXT SENTENCE
 12767     ELSE
 12768        IF PB-I-AH-BENEFIT-AMT = ZERO
 12769           MOVE ER-2635             TO WS-ERROR
 12770           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12771
 12772******************************************************************
 12773*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12774******************************************************************
 12775
 12776     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12777        NEXT SENTENCE
 12778     ELSE
 12779        IF PB-I-AH-PREMIUM-AMT = ZERO
 12780            IF NOT PB-COMP-AH-PREM
 12781                MOVE ER-2636    TO WS-ERROR
 12782                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12783
 12784
 12785 3140-EDIT-MAX-AMT-SIZES.
 12786* CUSTOM CODE FOR CLIENT    'DMD'
 12787     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12788                                     WS-RES-MUNI-TAX
 12789                                     PB-I-STATE-TAX
 12790                                     PB-I-MUNI-TAX.
 12791
 12792     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12793
 12794     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12795        GO TO 3150-RATE-OUTSTAND-BAL.
 12796
 12797     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12798        GO TO 3150-RATE-OUTSTAND-BAL.
 12799
 12800     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12801        GO TO 3150-RATE-OUTSTAND-BAL.
 12802
 12803     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12804                             OR 'RIC')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 234
* EL050.cbl
 12805        GO TO 3150-RATE-OUTSTAND-BAL.
 12806
 12807     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12808        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12809            GO TO 3150-RATE-OUTSTAND-BAL
 12810        ELSE
 12811           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12812               GO TO 3150-RATE-OUTSTAND-BAL.
 12813
 12814     IF NOT PB-NO-MONTHS-SKIPPED
 12815        GO TO 3150-RATE-OUTSTAND-BAL.
 12816
 12817     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12818        GO TO 3150-RATE-OUTSTAND-BAL.
 12819
 12820     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12821        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12822           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12823             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12824           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12825           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12826              MOVE ER-2693     TO WS-ERROR
 12827              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12828              GO TO 3150-RATE-OUTSTAND-BAL
 12829           ELSE
 12830              GO TO 3150-RATE-OUTSTAND-BAL.
 12831
 12832 3150-RATE-OUTSTAND-BAL.
 12833
 12834* DMD RATING TEST
 12835     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12836         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12837         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12838         MOVE ER-2687                 TO WS-ERROR
 12839         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12840         MOVE 'B'                     TO PB-I-OB-FLAG
 12841         GO TO 3260-EDIT-CONTINUE.
 12842
 12843     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12844         IF  WS-ERROR    EQUAL    ER-2693
 12845             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12846                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12847                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12848                 MOVE  +0            TO  WS-ERROR.
 12849
 12850     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12851         IF  WS-ERROR    EQUAL    ER-2693
 12852             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12853                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12854                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12855                 MOVE  +0            TO  WS-ERROR.
 12856
 12857     IF PLAN-MASTER-AH-SW = 'Y'
 12858        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12859            IF  WS-ERROR    EQUAL    ER-2693
 12860              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12861                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12862                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 235
* EL050.cbl
 12863                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12864                 MOVE  ER-1910           TO  WS-ERROR
 12865                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12866
 12867     IF PLAN-MASTER-AH-SW = 'Y'
 12868        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12869            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12870               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12871               MOVE  ER-1910           TO  WS-ERROR
 12872               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12873
 12874     IF PLAN-MASTER-AH-SW = 'Y'
 12875        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12876            IF  WS-ERROR    EQUAL    ER-2693
 12877                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12878                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12879                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12880                 MOVE  +0       TO  WS-ERROR.
 12881
 12882     IF WS-ERROR = ER-2693
 12883        IF PB-COMPANY-ID = 'JAL' AND
 12884           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12885           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12886           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12887
 12888     IF WS-ERROR = ER-2693
 12889        IF PB-COMPANY-ID = 'NCL'  AND
 12890           PB-I-AH-BENEFIT-CD = 'OA'
 12891           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12892           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12893
 12894     IF WS-ERROR = ER-2693
 12895        IF PB-COMPANY-ID = 'CNL' AND
 12896           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12897           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12898           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12899
 12900     IF WS-ERROR = ER-2693
 12901        IF PB-COMPANY-ID = 'HER'
 12902           IF WS-LEVEL
 12903              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12904              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12905
 12906     IF ((LF-BENEFIT-FOUND) AND
 12907         (NOT NO-LIFE-COVERAGE)  AND
 12908         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12909       OR   ((AH-BENEFIT-FOUND) AND
 12910             (NOT NO-AH-COVERAGE)    AND
 12911             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12912         NEXT SENTENCE
 12913     ELSE
 12914         GO TO 3215-EDIT-RATES.
 12915
 12916     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12917        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12918           MOVE ER-2674          TO WS-ERROR
 12919           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12920           GO TO 3215-EDIT-RATES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 236
* EL050.cbl
 12921
 12922     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12923        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12924           MOVE ER-2674          TO WS-ERROR
 12925           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12926           GO TO 3215-EDIT-RATES.
 12927
 12928     MOVE 'B'                    TO PB-I-OB-FLAG.
 12929
 12930     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12931         NEXT SENTENCE
 12932     ELSE
 12933         IF NOT NO-LIFE-COVERAGE
 12934             IF WS-ACCT-LF-OB-RT = ZERO
 12935                MOVE ER-2641    TO WS-ERROR
 12936                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12937
 12938     IF PB-COMPANY-ID = 'CRI'
 12939       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12940         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12941         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12942         IF WS-ERROR = ER-2675
 12943            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12944            MOVE ER-2687              TO WS-ERROR
 12945            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12946         ELSE
 12947            MOVE ER-2687              TO WS-ERROR
 12948            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12949
 12950
 12951     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12952         NEXT SENTENCE
 12953     ELSE
 12954       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12955            NEXT SENTENCE
 12956       ELSE
 12957         IF NOT NO-AH-COVERAGE
 12958             IF WS-ACCT-AH-OB-RT = ZERO
 12959                MOVE ER-2642    TO WS-ERROR
 12960                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12961
 12962     IF PB-COMPANY-ID = 'CRI'
 12963       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12964         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12965         IF WS-ERROR = ER-2676
 12966            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12967            MOVE ER-2687              TO WS-ERROR
 12968            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12969         ELSE
 12970            MOVE ER-2687              TO WS-ERROR
 12971            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12972
 12973     IF PB-COMPANY-ID NOT = 'GIC'
 12974         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12975            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12976     ELSE
 12977         IF PB-I-LF-PREM-CALC = ZEROS
 12978             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 237
* EL050.cbl
 12979                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12980
 12981     IF PB-COMPANY-ID NOT = 'GIC'
 12982         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12983            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12984     ELSE
 12985         IF PB-I-AH-PREM-CALC = ZEROS
 12986             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12987                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12988
 12989     MOVE ZEROS TO PB-I-MORT-CODE.
 12990
 12991     GO TO 3260-EDIT-CONTINUE.
 12992
 12993
 12994 3215-EDIT-RATES.
 12995     IF ACCOUNT-MAST-FOUND
 12996         NEXT SENTENCE
 12997     ELSE
 12998         GO TO 3999-END-EDIT.
 12999
 13000 3220-CHECK-LF-RATES.
 13001
 13002     IF PB-COMPANY-ID = 'DCC'
 13003        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13004        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13005        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13006           AND (NOT WS-LF-CASH))
 13007                           OR
 13008           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13009           AND (NOT WS-AH-CASH)))
 13010                       AND
 13011           (PB-I-ENTRY-STATUS NOT = '5')
 13012           MOVE 'M'              TO PB-BATCH-ENTRY
 13013                                    PB-I-ENTRY-STATUS
 13014        END-IF
 13015     END-IF
 13016     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13017                                    PB-I-AH-PREM-CALC
 13018                                    PB-I-LF-ALT-PREM-CALC
 13019                                    PB-I-LF-ALT-RATE
 13020                                    PB-I-LF-REI-RATE
 13021                                    PB-I-LF-ALT-REI-RATE
 13022                                    PB-I-AH-REI-RATE
 13023                                    PB-I-TOT-FEES-CALC.
 13024
 13025     IF PB-COMPANY-ID EQUAL 'DMD'
 13026        NEXT SENTENCE
 13027     ELSE
 13028        MOVE ZEROS               TO PB-I-LF-RATE
 13029                                    PB-I-AH-RATE.
 13030
 13031     IF PB-I-TOT-FEES NOT NUMERIC
 13032        MOVE ZEROS               TO PB-I-TOT-FEES
 13033     END-IF
 13034     IF PB-I-LIVES NOT NUMERIC
 13035         MOVE ZERO               TO PB-I-LIVES.
 13036
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 238
* EL050.cbl
 13037     IF PB-I-NUM-BILLED NOT NUMERIC
 13038         MOVE ZERO               TO PB-I-NUM-BILLED.
 13039
 13040     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13041        MOVE +0                  TO PB-I-LF-PREM-TAX
 13042     END-IF
 13043
 13044     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13045        MOVE +0                  TO PB-I-AH-PREM-TAX
 13046     END-IF
 13047
 13048     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13049        PB-I-PAY-FREQUENCY = ZEROS
 13050            MOVE 12 TO CP-PAY-FREQUENCY
 13051     ELSE
 13052            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13053
 13054     IF PB-I-STATE-TAX NOT NUMERIC
 13055         MOVE ZEROS               TO PB-I-STATE-TAX.
 13056
 13057     IF PB-I-MUNI-TAX NOT NUMERIC
 13058         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13059
 13060     MOVE SPACES                 TO CP-BEN-CATEGORY
 13061     IF PB-COMPANY-ID  = 'CSL'  AND
 13062        PB-I-LF-TERM NOT = ZERO
 13063        COMPUTE WS-PAYMENT-AMT =
 13064             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13065        COMPUTE WS-CSL-AMT1 =
 13066             PB-I-LF-TERM * AM-MAX-MON-BEN
 13067        COMPUTE WS-CSL-AMT2 =
 13068             WS-PAYMENT-AMT * PB-I-LF-TERM
 13069        IF CP-PAY-FREQUENCY NOT = 12
 13070           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13071           MOVE '8' TO WS-CSL-CALC-CD
 13072        ELSE
 13073           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13074              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13075               AM-MAX-TOT-BEN
 13076               MOVE '6' TO WS-CSL-CALC-CD
 13077           ELSE
 13078              IF (WS-CSL-AMT1  GREATER THAN
 13079                 AM-MAX-TOT-BEN) AND
 13080                 (WS-CSL-AMT2  GREATER THAN
 13081                 AM-MAX-TOT-BEN)
 13082                 MOVE '7' TO WS-CSL-CALC-CD
 13083              ELSE
 13084                 MOVE '5' TO WS-CSL-CALC-CD.
 13085
 13086     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13087         NEXT SENTENCE
 13088     ELSE
 13089         GO TO 3300-CHECK-AH-RATES.
 13090
 13091*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13092
 13093     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13094        IF (PB-I-LF-CRIT-PER    EQUAL +0)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 239
* EL050.cbl
 13095              OR
 13096           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13097           MOVE ER-2618          TO WS-ERROR
 13098           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13099           GO TO 3300-CHECK-AH-RATES.
 13100
 13101     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13102           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13103                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13104
 13105     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13106         MOVE ER-2687             TO WS-ERROR
 13107         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13108         MOVE 'Z000'              TO PB-I-MORT-CODE
 13109         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13110         GO TO 3300-CHECK-AH-RATES.
 13111
 13112     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13113        IF PB-I-LIVES = ZERO
 13114           MOVE ER-2688          TO WS-ERROR
 13115           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13116
 13117     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13118
 13119     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13120     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13121     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13122     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13123     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13124     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13125     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13126     MOVE '3'                    TO CP-PROCESS-TYPE.
 13127     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13128     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13129
 13130******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13131     IF PB-COMPANY-ID EQUAL 'CDL'
 13132         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13133            CP-EARN-AS-NET-PAY)
 13134             IF PB-CERT-EFF-DT GREATER  WS-931231
 13135                 MOVE '1'        TO CP-EARNING-METHOD.
 13136*******
 13137
 13138     MOVE PB-SV-STATE            TO CP-STATE.
 13139     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13140     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13141     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13142     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13143     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13144                                    CP-RATING-BENEFIT-AMT.
 13145     IF CP-STATE-STD-ABBRV = 'OR'
 13146         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13147                                         PB-I-LF-ALT-BENEFIT-AMT.
 13148     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13149     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13150     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13151     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13152     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 240
* EL050.cbl
 13153     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13154     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13155     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13156     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13157                                    CP-REMAINING-TERM
 13158                                    CP-LOAN-TERM.
 13159
 13160     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13161         NEXT SENTENCE
 13162     ELSE
 13163         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13164             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13165                                           PB-I-LF-PREMIUM-AMT.
 13166
 13167     IF PB-COMPANY-ID EQUAL 'CSL'
 13168        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13169           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13170                                         PB-I-LF-PREMIUM-AMT.
 13171
 13172     IF PB-COMPANY-ID EQUAL 'NCB'
 13173         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13174            CP-EARN-AS-NET-PAY
 13175             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13176                 PB-I-LF-PREMIUM-AMT.
 13177
 13178     IF (CP-TRUNCATED-LIFE)
 13179        or ((pb-company-id = 'AHL')
 13180           and (pb-i-loan-term > pb-i-lf-term))
 13181        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13182
 13183     IF PB-COMPANY-ID EQUAL 'CRI'
 13184        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13185
 13186     IF CP-TERM-IS-DAYS
 13187         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13188     ELSE
 13189         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13190     IF PB-COMPANY-ID = 'DCC'
 13191        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13192        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13193        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13194        IF WS-LF-BEN-CATEGORY = 'D'
 13195           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13196           MOVE PB-I-LIFE-COMMISSION
 13197                                 TO CP-DCC-ACT-COMM
 13198           MOVE WS-LF-BEN-CATEGORY
 13199                                 TO CP-BEN-CATEGORY
 13200        END-IF
 13201        IF (CP-BENEFIT-CD (1:1) = 'P')
 13202           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13203           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13204           add pb-i-ah-premium-amt to cp-original-premium
 13205        END-IF
 13206     END-IF
 13207     IF PB-COMPANY-ID = 'CSL'
 13208         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13209         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13210         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 241
* EL050.cbl
 13211
 13212     IF PB-COMPANY-ID = 'CSL'
 13213        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13214
 13215     IF (CP-SPECIAL-CALC-CD = 'H')
 13216        OR (PB-COMPANY-ID = 'DCC')
 13217         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13218                                    TO CP-ALTERNATE-BENEFIT
 13219         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13220
 13221     IF (PB-COMPANY-ID = 'CID')
 13222        AND (WS-LF-EARNINGS-CALC = 'B')
 13223        AND (CP-STATE-STD-ABBRV = 'MN')
 13224        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13225                                 TO CP-ALTERNATE-BENEFIT
 13226        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13227     END-IF
 13228     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13229     MOVE 'R'                   TO CP-RATE-FILE.
 13230     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13231
 13232     IF CP-ERROR-RATE-NOT-FOUND
 13233        MOVE ER-2641            TO WS-ERROR
 13234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13235        GO TO 3300-CHECK-AH-RATES.
 13236
 13237     IF PB-COMPANY-ID EQUAL 'CRI'
 13238        IF CP-ERROR-NO-LIMITS-CRI
 13239           IF NOT ACCOUNT-LIFE-CHECKED
 13240              MOVE ER-2607      TO WS-ERROR
 13241              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13242
 13243******************************************************************
 13244*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13245*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13246******************************************************************
 13247
 13248* CALC LIFE AGE AT EXPIRATION.
 13249
 13250     COMPUTE WS-AGE-AT-EXPIRE =
 13251          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13252
 13253*    IF PB-STATE = 'CO' OR 'UT'
 13254*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13255*        MOVE 'F'            TO PB-FATAL-FLAG
 13256*        MOVE ER-2709        TO WS-ERROR
 13257*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13258*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13259
 13260*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13261*        MOVE 'X'            TO PB-FATAL-FLAG
 13262*        MOVE ER-2718        TO WS-ERROR
 13263*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13264*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13265
 13266* CALC A & H AGE AT EXPIRATION.
 13267
 13268     COMPUTE WS-AGE-AT-EXPIRE =
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 242
* EL050.cbl
 13269          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13270
 13271*    IF PB-STATE = 'CO' OR 'UT'
 13272*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13273*        MOVE 'F'            TO PB-FATAL-FLAG
 13274*        MOVE ER-2709        TO WS-ERROR
 13275*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13276*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13277
 13278*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13279*        MOVE 'X'            TO PB-FATAL-FLAG
 13280*        MOVE ER-2718        TO WS-ERROR
 13281*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13282*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13283
 13284     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13285        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13286
 13287     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13288        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13289
 13290     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13291        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13292
 13293     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13294         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13295         MOVE ER-2639        TO WS-ERROR
 13296         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13297
 13298
 13299******************************************************************
 13300*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13301******************************************************************
 13302
 13303 PREMIUM-EDITING-IS-BYPASSED.
 13304     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13305        AND (CP-R-MAX-ATT-AGE > +0)
 13306        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13307        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13308           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13309           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13310           MOVE '1'              TO DC-OPTION-CODE
 13311           PERFORM 8500-DATE-CONVERT
 13312                                 THRU 8500-EXIT
 13313           IF NO-CONVERSION-ERROR
 13314              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13315                 MOVE ER-2661       TO WS-ERROR
 13316*                PERFORM 9900-ERROR-FORMAT
 13317*                                THRU 9900-EXIT
 13318              END-IF
 13319           END-IF
 13320        ELSE
 13321           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13322           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13323              MOVE ER-2661       TO WS-ERROR
 13324*             PERFORM 9900-ERROR-FORMAT
 13325*                                THRU 9900-EXIT
 13326           ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 243
* EL050.cbl
 13327              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13328                 MOVE ER-1570    TO WS-ERROR
 13329                 PERFORM 9900-ERROR-FORMAT
 13330                                 THRU 9900-EXIT
 13331              END-IF
 13332           END-IF
 13333        END-IF
 13334        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13335           MOVE PB-I-JOINT-BIRTHDAY
 13336                                 TO DC-BIN-DATE-1
 13337           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13338           MOVE '1'              TO DC-OPTION-CODE
 13339           PERFORM 8500-DATE-CONVERT
 13340                                 THRU 8500-EXIT
 13341           IF NO-CONVERSION-ERROR
 13342              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13343                 MOVE ER-2661       TO WS-ERROR
 13344*                PERFORM 9900-ERROR-FORMAT
 13345*                                THRU 9900-EXIT
 13346              END-IF
 13347           ELSE
 13348              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13349           END-IF
 13350        ELSE
 13351           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13352             (PB-I-LF-TERM / 12)
 13353           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13354              MOVE ER-2661       TO WS-ERROR
 13355*             PERFORM 9900-ERROR-FORMAT
 13356*                                THRU 9900-EXIT
 13357           ELSE
 13358              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13359                 MOVE ER-1571    TO WS-ERROR
 13360                 PERFORM 9900-ERROR-FORMAT
 13361                                 THRU 9900-EXIT
 13362              END-IF
 13363           END-IF
 13364        END-IF
 13365        IF WS-ERROR = ER-2661
 13366           PERFORM 9900-ERROR-FORMAT
 13367                                 THRU 9900-EXIT
 13368        END-IF
 13369     END-IF
 13370*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13371*       MOVE ER-2661             TO WS-ERROR
 13372*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13373
 13374     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13375        MOVE ER-2662             TO WS-ERROR
 13376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13377
 13378     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13379        MOVE ER-2677             TO WS-ERROR
 13380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13381
 13382     IF CP-ERROR-LOAN-TERM
 13383        MOVE ER-2648             TO WS-ERROR
 13384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 244
* EL050.cbl
 13385
 13386 3221-CHECK-ERROR-RATE-OPEN.
 13387
 13388     IF CP-ERROR-RATE-FILE-NOTOPEN
 13389         GO TO 3990-FILES-NOT-OPEN.
 13390
 13391     IF PB-COMPANY-ID NOT = 'DMD'
 13392        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13393     END-IF
 13394     .
 13395 3221-CONTINUE.
 13396     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13397                                    WS-DCC-AH-RATE
 13398     IF PB-COMPANY-ID = 'DCC'
 13399        IF WS-LF-BEN-CATEGORY = 'D'
 13400           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13401              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13402        END-IF
 13403     END-IF
 13404     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13405*   X'A4FF' = 12/31/2009
 13406     IF (PB-COMPANY-ID = 'CID')
 13407        AND (WS-LF-EARNINGS-CALC = 'B')
 13408        AND (CP-STATE-STD-ABBRV = 'MN')
 13409        AND (PB-CERT-EFF-DT > X'A4FF')
 13410        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13411     END-IF
 13412     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13413
 13414     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13415     IF (PB-COMPANY-ID = 'DCC')
 13416        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13417        AND (PB-I-POLICY-IS-MONTHLY)
 13418        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13419        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13420     END-IF
 13421     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13422     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13423     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13424     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13425     IF (PB-COMPANY-ID = 'DCC')
 13426        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13427        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13428        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13429        MOVE ER-2786             TO WS-ERROR
 13430        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13431     END-IF
 13432
 13433     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13434
 13435******************************************************************
 13436*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13437******************************************************************
 13438     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13439        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13440
 13441     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13442        GO TO 3225-CHECK-ALT-LIFE-RATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 245
* EL050.cbl
 13443     ELSE
 13444       IF PB-I-LF-RATE = ZERO
 13445          MOVE ER-2641          TO WS-ERROR
 13446          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13447
 13448 3225-CHECK-ALT-LIFE-RATE.
 13449
 13450     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13451        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13452        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13453         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13454
 13455     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13456         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13457             AND PB-COMPANY-ID NOT = 'DCC')
 13458                   OR
 13459              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13460              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13461              AND PB-COMPANY-ID NOT = 'DCC')
 13462             MOVE ER-2720        TO  WS-ERROR
 13463             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13464             GO TO 3225-RATING-CONT
 13465         ELSE
 13466             GO TO 3225-RATING-CONT.
 13467     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13468        AND (AM-GPCD = 01 OR 06 OR 15)
 13469        MOVE ER-2798             TO WS-ERROR
 13470        PERFORM 9900-ERROR-FORMAT
 13471                                 THRU 9900-EXIT
 13472*       GO TO 3225-RATING-CONT
 13473     END-IF
 13474     IF (PB-COMPANY-ID = 'CID')
 13475        AND (WS-LF-EARNINGS-CALC = 'B')
 13476        AND (CP-STATE-STD-ABBRV = 'MN')
 13477        AND (PB-CERT-EFF-DT > X'A4FF')
 13478        GO TO 3225-RATING-CONT
 13479     END-IF
 13480     IF PB-COMPANY-ID = 'DCC'
 13481        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13482           AND (PB-I-POLICY-IS-MONTHLY)
 13483           GO TO 3225-RATING-CONT
 13484        END-IF
 13485     END-IF
 13486
 13487     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13488        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13489        CP-EARN-AS-REG-BALLOON
 13490        NEXT SENTENCE
 13491     ELSE
 13492        MOVE '2'                 TO CP-EARNING-METHOD.
 13493
 13494 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13495
 13496     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13497
 13498     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13499        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13500        (CP-SPECIAL-CALC-CD EQUAL 'H')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 246
* EL050.cbl
 13501         NEXT SENTENCE
 13502     ELSE
 13503         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13504
 13505     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13506     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13507     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13508                                     CP-RATING-BENEFIT-AMT.
 13509     IF CP-STATE-STD-ABBRV = 'OR'
 13510         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13511                                         PB-I-LF-ALT-BENEFIT-AMT.
 13512     IF PB-COMPANY-ID = 'DCC'
 13513        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13514     END-IF
 13515     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13516     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13517     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13518                                    CP-REMAINING-TERM
 13519                                    CP-LOAN-TERM.
 13520     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13521        ADD +1                   TO CP-ORIGINAL-TERM
 13522                                    CP-REMAINING-TERM
 13523                                    CP-LOAN-TERM.
 13524
 13525     MOVE 'R'                   TO CP-RATE-FILE.
 13526     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13527
 13528     IF CP-ERROR-RATE-NOT-FOUND
 13529         MOVE ER-2641            TO WS-ERROR
 13530         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13531         GO TO 3300-CHECK-AH-RATES.
 13532
 13533     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13534     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13535
 13536     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13537         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13538
 13539     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13540                               + PB-I-LF-ALT-BENEFIT-AMT.
 13541
 13542     IF ACCOUNT-LIFE-CHECKED  OR
 13543        PB-POLICY-IS-VOIDED   OR
 13544        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13545        GO TO 3225-CONTINUE.
 13546
 13547     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13548        GO TO 3225-CONTINUE.
 13549
 13550     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13551                             EC-RT-LF-MAX-TOT-BEN
 13552        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13553        MOVE ER-2639       TO WS-ERROR
 13554        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13555
 13556 3225-CONTINUE.
 13557     IF PB-I-LF-ALT-RATE = ZERO
 13558         MOVE ER-2659            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 247
* EL050.cbl
 13559         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13560
 13561     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13562        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13563        MOVE ER-2698             TO WS-ERROR
 13564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13565
 13566 3225-RATING-CONT.
 13567
 13568     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13569         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13570         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13571         IF (PB-COMPANY-ID = 'DCC')
 13572            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13573            CONTINUE
 13574         ELSE
 13575            MOVE ER-2687         TO WS-ERROR
 13576            PERFORM 9900-ERROR-FORMAT
 13577                                 THRU 9900-EXIT
 13578         END-IF
 13579         GO TO 3290-EDIT-LF-REIN-RATE
 13580     END-IF
 13581
 13582* DMD RATING TEST
 13583     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13584         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13585         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13586         MOVE ER-2687                 TO WS-ERROR
 13587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13588         GO TO 3290-EDIT-LF-REIN-RATE.
 13589
 13590 3230-CLIENT-MORT-CD-SPECIALS.
 13591
 13592     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13593     SET BIN-TO-GREG          TO TRUE.
 13594*    MOVE ' '                 TO DC-OPTION-CODE.
 13595     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13596     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13597
 13598 C-POS-3230-MORT-CD.
 13599     IF PB-COMPANY-ID = 'POS' AND
 13600        PB-SV-CARRIER = '2'
 13601         NEXT SENTENCE
 13602     ELSE
 13603         GO TO C-POS-3240-MORT-CD.
 13604
 13605     IF PB-SV-GROUPING = '030'
 13606        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13607         MOVE '2350' TO PB-I-MORT-CODE
 13608      ELSE
 13609         MOVE '3300' TO PB-I-MORT-CODE.
 13610
 13611
 13612 C-POS-3240-MORT-CD.
 13613     IF PB-COMPANY-ID = 'POS' AND
 13614        PB-SV-CARRIER = '1'
 13615         NEXT SENTENCE
 13616     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 248
* EL050.cbl
 13617         GO TO 3230-CONTINUE.
 13618
 13619     IF PB-SV-STATE = '45' OR '47'
 13620        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13621         MOVE '5200' TO PB-I-MORT-CODE
 13622     ELSE
 13623         MOVE '8300' TO PB-I-MORT-CODE.
 13624
 13625 3230-CONTINUE.
 13626
 13627     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13628        GO TO 3240-CONTINUE
 13629     END-IF
 13630
 13631     IF PB-CERT-EFF-DT > WS-971231
 13632        GO TO 3240-CONTINUE
 13633     END-IF
 13634
 13635     IF LF-BENEFIT-FOUND AND
 13636        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13637         MOVE 'F250'       TO PB-I-MORT-CODE
 13638     ELSE
 13639         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13640             MOVE '7250'   TO PB-I-MORT-CODE
 13641         ELSE
 13642             MOVE '4251'   TO PB-I-MORT-CODE
 13643         END-IF
 13644     END-IF
 13645
 13646     .
 13647 3240-CONTINUE.
 13648
 13649     IF PB-COMPANY-ID NOT = 'GNL'
 13650         GO TO 3256-CONTINUE.
 13651
 13652     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13653         MOVE 'A300' TO PB-I-MORT-CODE
 13654     ELSE
 13655         MOVE '8350' TO PB-I-MORT-CODE.
 13656
 13657 3256-CONTINUE.
 13658     IF PB-COMPANY-ID NOT = 'ABL'
 13659         GO TO 3260-EDIT-CONTINUE.
 13660
 13661     IF PB-I-LF-TERM GREATER THAN 59
 13662         MOVE 'F550' TO PB-I-MORT-CODE
 13663     ELSE
 13664         MOVE 'E550' TO PB-I-MORT-CODE.
 13665
 13666 3260-EDIT-CONTINUE.
 13667     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13668
 13669 3290-EDIT-LF-REIN-RATE.
 13670     IF LF-REIN-NSP-NOT-USED
 13671         GO TO 3290-RATING-CONT.
 13672
 13673     IF PB-COMPANY-ID = 'DCC'
 13674        GO TO 3290-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 249
* EL050.cbl
 13675     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13676     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13677     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13678     MOVE '3'                   TO CP-PROCESS-TYPE.
 13679     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13680
 13681******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13682     IF PB-COMPANY-ID EQUAL 'CDL'
 13683         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13684            CP-EARN-AS-NET-PAY)
 13685             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13686*            MOVE SPACE          TO DC-OPTION-CODE
 13687             SET BIN-TO-GREG     TO TRUE
 13688             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13689***  Y2K PROJ 7744
 13690             IF DC-GREG-DATE-CYMD GREATER 19931231
 13691                 MOVE '1'        TO CP-EARNING-METHOD.
 13692***  Y2K PROJ 7744
 13693*******
 13694
 13695     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13696     MOVE PB-SV-STATE           TO CP-STATE.
 13697     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13698     MOVE ZERO                  TO CP-DEVIATION-CODE
 13699                                   CP-RATE-DEV-PCT.
 13700     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13701     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13702                                   CP-RATING-BENEFIT-AMT.
 13703
 13704************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13705     IF PB-COMPANY-ID EQUAL 'NCB'
 13706         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13707            CP-EARN-AS-NET-PAY
 13708             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13709                 PB-I-LF-PREMIUM-AMT.
 13710************
 13711
 13712     IF CP-STATE-STD-ABBRV = 'OR'
 13713         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13714                                         PB-I-LF-ALT-BENEFIT-AMT.
 13715     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13716     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13717     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13718     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13719     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13720     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13721     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13722     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13723                                   CP-REMAINING-TERM
 13724                                   CP-LOAN-TERM.
 13725     IF CP-TRUNCATED-LIFE
 13726        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13727
 13728     IF CP-TERM-IS-DAYS
 13729         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13730     ELSE
 13731         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13732
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 250
* EL050.cbl
 13733     IF PB-COMPANY-ID = 'DCC'
 13734        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13735     END-IF
 13736     IF PB-COMPANY-ID NOT = 'TIC'
 13737          MOVE ZERO          TO CP-CLASS-CODE.
 13738
 13739     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13740
 13741     MOVE 'R'                   TO CP-RATE-FILE.
 13742     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13743
 13744     IF CP-ERROR-RATE-NOT-FOUND
 13745        IF PB-I-OB
 13746           MOVE ER-2625      TO WS-ERROR
 13747           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13748           GO TO 3299-EDIT-CONTINUE
 13749        ELSE
 13750           MOVE ER-2643      TO WS-ERROR
 13751           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13752           GO TO 3299-EDIT-CONTINUE.
 13753
 13754     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13755
 13756     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13757     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13758
 13759     IF PB-I-LF-REI-RATE = ZERO
 13760         MOVE ER-2643        TO WS-ERROR
 13761         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13762
 13763 3290-CHECK-ALT-REIN-RATE.
 13764
 13765     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13766        GO TO 3290-RATING-CONT.
 13767
 13768     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13769     MOVE '2'                    TO CP-EARNING-METHOD.
 13770     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13771     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13772     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13773     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13774                                     CP-RATING-BENEFIT-AMT.
 13775     IF CP-STATE-STD-ABBRV = 'OR'
 13776         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13777                                         PB-I-LF-ALT-BENEFIT-AMT.
 13778     IF PB-COMPANY-ID = 'DCC'
 13779        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13780     END-IF
 13781     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13782     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13783     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13784                                    CP-REMAINING-TERM
 13785                                    CP-LOAN-TERM.
 13786     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13787        ADD +1                   TO CP-ORIGINAL-TERM
 13788                                    CP-REMAINING-TERM
 13789                                    CP-LOAN-TERM.
 13790
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 251
* EL050.cbl
 13791     MOVE 'R'                   TO CP-RATE-FILE.
 13792     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13793
 13794     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13795
 13796     IF PB-I-LF-ALT-REI-RATE = ZERO
 13797         MOVE ER-2643            TO WS-ERROR
 13798         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13799
 13800 3290-RATING-CONT.
 13801
 13802     IF PB-I-OB
 13803*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13804        GO TO 3300-CHECK-AH-RATES.
 13805
 13806 3299-EDIT-CONTINUE.
 13807
 13808     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13809         NEXT SENTENCE
 13810     ELSE
 13811         MOVE ER-2620           TO WS-ERROR
 13812         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13813
 13814 3300-CHECK-AH-RATES.
 13815     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13816         NEXT SENTENCE
 13817     ELSE
 13818         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13819
 13820     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13821        ((CF-COMPANY-ID = 'DMD') AND
 13822                (NO-DMD-RATING))
 13823         IF (PB-COMPANY-ID = 'DCC')
 13824            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13825            CONTINUE
 13826         ELSE
 13827            MOVE ER-2687         TO WS-ERROR
 13828            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13829         END-IF
 13830         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13831         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13832     END-IF
 13833
 13834     IF PB-I-OB
 13835        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13836
 13837     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13838         MOVE ER-2687             TO WS-ERROR
 13839         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13840         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13841         GO TO 3999-END-EDIT.
 13842
 13843*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13844
 13845     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13846        IF PB-I-AH-CRIT-PER = ZERO
 13847           IF PB-COMPANY-ID = 'DCC'
 13848              AND AM-DCC-PRODUCT-CODE = 'DDF'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 252
* EL050.cbl
 13849              CONTINUE
 13850           ELSE
 13851              MOVE ER-2618       TO WS-ERROR
 13852              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13853              GO TO 3999-END-EDIT
 13854           END-IF
 13855        END-IF
 13856     END-IF
 13857     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13858     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13859     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13860     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13861     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13862     MOVE PB-SV-STATE            TO CP-STATE.
 13863     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13864     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13865     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13866*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13867     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13868     MOVE '3'                    TO CP-PROCESS-TYPE.
 13869     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13870     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13871                                    CP-RATING-BENEFIT-AMT.
 13872     IF PB-COMPANY-ID = 'CID'
 13873               OR
 13874        CP-STATE-STD-ABBRV = 'OR'
 13875         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13876                                         PB-I-AH-TERM.
 13877     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13878        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13879           AND (PB-I-POLICY-IS-MONTHLY)
 13880           MOVE PB-I-LF-BENEFIT-AMT
 13881                                 TO CP-NET-BENEFIT-AMT
 13882           move pb-i-ah-premium-amt to cp-original-premium
 13883           add pb-i-lf-premium-amt to cp-original-premium
 13884        END-IF
 13885     END-IF
 13886     MOVE SPACES                 TO CP-BEN-CATEGORY
 13887     IF PB-COMPANY-ID = 'DCC'
 13888        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13889        EVALUATE TRUE
 13890           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13891              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13892              MOVE PB-I-LF-BENEFIT-AMT
 13893                                 TO CP-RATING-BENEFIT-AMT
 13894              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13895           WHEN WS-AH-BEN-CATEGORY = 'G'
 13896              MOVE PB-I-UNPAID-CASH-PRICE
 13897                                 TO CP-RATING-BENEFIT-AMT
 13898           WHEN WS-AH-BEN-CATEGORY = 'D'
 13899              MOVE WS-AH-PMF-COMM
 13900                                 TO CP-DCC-PMF-COMM
 13901              MOVE PB-I-AH-COMMISSION
 13902                                 TO CP-DCC-ACT-COMM
 13903        END-EVALUATE
 13904     END-IF
 13905     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13906     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 253
* EL050.cbl
 13907     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13908     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13909     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13910     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13911     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13912                                    CP-REMAINING-TERM
 13913                                    WS-WORK-TERM.
 13914     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13915
 13916     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13917     SET BIN-TO-GREG             TO TRUE.
 13918*    MOVE ' '                    TO DC-OPTION-CODE.
 13919     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13920     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13921
 13922     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13923     IF NOT VALID-SKIP-CODE
 13924         MOVE ER-2683            TO WS-ERROR
 13925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13926         GO TO 3320-RATE-CONTINUE.
 13927
 13928     IF PB-NO-MONTHS-SKIPPED
 13929         GO TO 3320-RATE-CONTINUE.
 13930
 13931     MOVE SPACE TO NUMBER-OF-MONTHS.
 13932
 13933     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13934         MOVE 'S'                TO SK-MO (6).
 13935     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13936         MOVE 'S'                TO SK-MO (7).
 13937     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13938         MOVE 'S'                TO SK-MO (8).
 13939     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13940         MOVE 'S'                TO SK-MO (9).
 13941     IF PB-I-SKIP-CODE = 'A'
 13942         MOVE 'S'                TO SK-MO (10).
 13943
 13944     MOVE 1                      TO SUB2.
 13945     MOVE PB-I-AH-TERM           TO SUB3.
 13946     MOVE WS-MONTH               TO SUB1.
 13947     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13948     GO TO 3320-RATE-CONTINUE.
 13949
 13950 3310-GET-SKIP-MO.
 13951     IF SUB1 = 13
 13952         MOVE 1                  TO SUB1.
 13953
 13954     IF SK-MO (SUB1) = 'S'
 13955         SUBTRACT 1 FROM WS-WORK-TERM.
 13956
 13957     ADD 1 TO SUB2
 13958              SUB1.
 13959
 13960 3320-RATE-CONTINUE.
 13961
 13962     IF WS-WORK-TERM = ZERO
 13963         MOVE 1                  TO WS-WORK-TERM.
 13964
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 254
* EL050.cbl
 13965     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13966                                    CP-LOAN-TERM.
 13967
 13968     IF PB-COMPANY-ID EQUAL 'DMD'
 13969         NEXT SENTENCE
 13970     ELSE
 13971         MOVE ZERO               TO PB-I-AH-RATE
 13972                                    PB-I-AH-REI-RATE.
 13973
 13974
 13975     IF PB-COMPANY-ID EQUAL 'CRI'
 13976        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13977
 13978     IF PB-COMPANY-ID = 'CSL'
 13979         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13980         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13981         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13982         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13983
 13984     IF PB-COMPANY-ID = 'DCC'
 13985        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13986           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13987              PB-I-RATE-DEV-PCT-LF
 13988        END-IF
 13989        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13990                                 TO CP-ALTERNATE-BENEFIT
 13991        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13992        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13993        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13994     END-IF
 13995     IF (PB-COMPANY-ID = 'CID')
 13996        AND (WS-LF-EARNINGS-CALC = 'B')
 13997        AND (CP-STATE-STD-ABBRV = 'MN')
 13998        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13999     ELSE
 14000        MOVE ' '                 TO CP-AH-BALLOON-SW
 14001     END-IF
 14002     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14003     MOVE 'R'                   TO CP-RATE-FILE.
 14004     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14005
 14006     IF CP-ERROR-RATE-NOT-FOUND
 14007        IF PB-I-OB
 14008           MOVE ER-2624          TO WS-ERROR
 14009           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14010           GO TO 3340-CALCULATE-PREMIUM-AMT
 14011        ELSE
 14012          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14013              NEXT SENTENCE
 14014          ELSE
 14015           MOVE ER-2642          TO WS-ERROR
 14016           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14017           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14018
 14019     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14020        CP-ERROR-DIV-BY-ZERO
 14021           MOVE ER-3782          TO WS-ERROR
 14022           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 255
* EL050.cbl
 14023
 14024     IF PB-COMPANY-ID EQUAL 'CRI'
 14025        IF CP-ERROR-NO-LIMITS-CRI
 14026           IF NOT ACCOUNT-AH-CHECKED
 14027              MOVE ER-2607          TO WS-ERROR
 14028              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14029
 14030     IF ACCOUNT-AH-CHECKED
 14031        NEXT SENTENCE
 14032     ELSE
 14033       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14034          MOVE ER-2640           TO WS-ERROR
 14035          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14036
 14037     IF PB-COMPANY-ID = 'CRI'
 14038         IF WS-ERROR = ER-2640
 14039             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14040     IF ACCOUNT-AH-CHECKED
 14041        CONTINUE
 14042     ELSE
 14043        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14044           AND (CP-R-MAX-ATT-AGE > +0)
 14045           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14046           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14047              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14048              MOVE PB-I-AH-EXPIRE-DT
 14049                                 TO DC-BIN-DATE-2
 14050              MOVE '1'           TO DC-OPTION-CODE
 14051              PERFORM 8500-DATE-CONVERT
 14052                                 THRU 8500-EXIT
 14053              IF NO-CONVERSION-ERROR
 14054                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14055                    MOVE ER-2661       TO WS-ERROR
 14056*                   PERFORM 9900-ERROR-FORMAT
 14057*                                THRU 9900-EXIT
 14058                 END-IF
 14059              END-IF
 14060           ELSE
 14061              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14062              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14063                 MOVE ER-2661    TO WS-ERROR
 14064*                PERFORM 9900-ERROR-FORMAT
 14065*                                THRU 9900-EXIT
 14066              ELSE
 14067                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14068                    MOVE ER-1570 TO WS-ERROR
 14069                    PERFORM 9900-ERROR-FORMAT
 14070                                 THRU 9900-EXIT
 14071                 END-IF
 14072              END-IF
 14073           END-IF
 14074           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14075              MOVE PB-I-JOINT-BIRTHDAY
 14076                                    TO DC-BIN-DATE-1
 14077              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14078              MOVE '1'              TO DC-OPTION-CODE
 14079              PERFORM 8500-DATE-CONVERT
 14080                                    THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 256
* EL050.cbl
 14081              IF NO-CONVERSION-ERROR
 14082                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14083                    MOVE ER-2661       TO WS-ERROR
 14084*                   PERFORM 9900-ERROR-FORMAT
 14085*                                   THRU 9900-EXIT
 14086                 END-IF
 14087              END-IF
 14088           ELSE
 14089              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14090                (PB-I-AH-TERM / 12)
 14091              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14092                 MOVE ER-2661       TO WS-ERROR
 14093*                PERFORM 9900-ERROR-FORMAT
 14094*                                   THRU 9900-EXIT
 14095              ELSE
 14096                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14097                    MOVE ER-1571 TO WS-ERROR
 14098                    PERFORM 9900-ERROR-FORMAT
 14099                                 THRU 9900-EXIT
 14100                 END-IF
 14101              END-IF
 14102           END-IF
 14103           IF WS-ERROR = ER-2661
 14104              PERFORM 9900-ERROR-FORMAT
 14105                                    THRU 9900-EXIT
 14106           END-IF
 14107        END-IF
 14108     END-IF
 14109*    IF ACCOUNT-AH-CHECKED
 14110*       NEXT SENTENCE
 14111*    ELSE
 14112*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14113*          MOVE ER-2661          TO WS-ERROR
 14114*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14115
 14116     IF ACCOUNT-AH-CHECKED
 14117        NEXT SENTENCE
 14118     ELSE
 14119        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14120           MOVE ER-2663          TO WS-ERROR
 14121           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14122
 14123     IF ACCOUNT-AH-CHECKED OR
 14124        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14125         PB-POLICY-IS-VOIDED
 14126        NEXT SENTENCE
 14127     ELSE
 14128        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14129           MOVE ER-2667            TO WS-ERROR
 14130           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14131
 14132     IF PB-COMPANY-ID = 'CRI'
 14133         IF WS-ERROR = ER-2667
 14134             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14135
 14136     IF ACCOUNT-AH-CHECKED
 14137        NEXT SENTENCE
 14138     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 257
* EL050.cbl
 14139        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14140           MOVE ER-2678            TO WS-ERROR
 14141           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14142
 14143     IF CP-ERROR-RATE-FILE-NOTOPEN
 14144         GO TO 3990-FILES-NOT-OPEN.
 14145
 14146 3321-CONTINUE.
 14147     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14148     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14149     IF (PB-COMPANY-ID = 'DCC')
 14150        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14151        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14152                                    PB-I-LF-ALT-PREM-CALC
 14153        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14154        IF WS-AH-BEN-CATEGORY = 'G'
 14155           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14156           + PB-I-ADDL-CLP)
 14157           * (1 + WS-TOL-CLP-PCT)
 14158*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14159        ELSE
 14160           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14161           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14162*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14163        END-IF
 14164        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14165                                 TO PB-I-AH-PREM-CALC
 14166        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14167           MOVE ER-8152          TO WS-ERROR
 14168           PERFORM 9900-ERROR-FORMAT
 14169                                 THRU 9900-EXIT
 14170        ELSE
 14171           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14172                 PB-I-ADDL-CLP)
 14173              MOVE ER-8148       TO WS-ERROR
 14174              PERFORM 9900-ERROR-FORMAT
 14175                                 THRU 9900-EXIT
 14176           END-IF
 14177        END-IF
 14178     END-IF
 14179     IF (PB-COMPANY-ID = 'DCC')
 14180        AND (PB-I-POLICY-IS-MONTHLY)
 14181        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14182        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14183        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14184           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14185        END-IF
 14186     END-IF
 14187     IF (PB-COMPANY-ID = 'DCC')
 14188        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14189        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14190        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14191        MOVE ER-2786             TO WS-ERROR
 14192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14193     END-IF
 14194     MOVE +0                     TO PB-I-AH-CLP
 14195     IF PB-COMPANY-ID = 'DCC'
 14196        IF WS-AH-BEN-CATEGORY = 'D'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 258
* EL050.cbl
 14197           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14198              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14199        ELSE
 14200           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14201              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14202           END-IF
 14203        END-IF
 14204     END-IF
 14205     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14206
 14207     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14208         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14209
 14210     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14211         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14212
 14213     IF PB-COMPANY-ID = 'CRI'
 14214         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14215            PB-I-PAYMENT-AMOUNT = ZERO
 14216             NEXT SENTENCE
 14217         ELSE
 14218             COMPUTE PB-I-AH-PREM-CALC =
 14219                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14220                 (CP-PREMIUM-RATE / 100)
 14221             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14222                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14223                                             PB-I-RATE-DEV-PCT-AH.
 14224
 14225     IF PB-I-AH-RATE  = ZERO
 14226       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14227           NEXT SENTENCE
 14228       ELSE
 14229         MOVE ER-2642            TO WS-ERROR
 14230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14231
 14232     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14233     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14234     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14235     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14236     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14237     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14238
 14239     IF (PB-COMPANY-ID = 'DCC')
 14240        AND (WS-AH-BEN-CATEGORY = 'G')
 14241        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14242        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14243        IF CP-DEVIATION-CODE NOT = '000'
 14244           MOVE '000'            TO CP-DEVIATION-CODE
 14245           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14246           IF NO-CP-ERROR
 14247              COMPUTE PB-I-DDF-IU-RATE-UP =
 14248              PB-I-AH-CLP - CP-CALC-PREMIUM
 14249           ELSE
 14250              MOVE ER-3057        TO WS-ERROR
 14251              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14252           END-IF
 14253        END-IF
 14254     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 259
* EL050.cbl
 14255     .
 14256 3335-EDIT-AH-REIN-NSP-RATE.
 14257     IF AH-REIN-NSP-NOT-USED
 14258         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14259
 14260     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14261     IF PB-COMPANY-ID = 'DCC'
 14262         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14263     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14264     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14265     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14266     MOVE PB-SV-STATE            TO CP-STATE.
 14267     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14268     MOVE ZERO                   TO CP-DEVIATION-CODE
 14269                                    CP-RATE-DEV-PCT.
 14270*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14271     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14272     MOVE '3'                    TO CP-PROCESS-TYPE.
 14273     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14274     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14275                                    CP-RATING-BENEFIT-AMT.
 14276     IF CP-STATE-STD-ABBRV = 'OR'
 14277         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14278                                         PB-I-AH-TERM.
 14279     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14280     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14281     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14282     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14283     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14284     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14285                                    CP-REMAINING-TERM
 14286                                    WS-WORK-TERM.
 14287     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14288     IF PB-COMPANY-ID = 'DCC'
 14289        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14290     END-IF
 14291     IF  PB-COMPANY-ID = 'TIC'
 14292         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14293            MOVE ZERO TO CP-CLASS-CODE.
 14294
 14295     IF PB-COMPANY-ID NOT = 'TIC'
 14296          MOVE ZERO          TO CP-CLASS-CODE.
 14297
 14298     MOVE ZERO               TO CP-DEVIATION-CODE.
 14299
 14300     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14301
 14302     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14303
 14304     MOVE 'R'                   TO CP-RATE-FILE.
 14305     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14306
 14307     IF CP-ERROR-RATE-NOT-FOUND
 14308         MOVE ER-2645        TO WS-ERROR
 14309         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14310         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14311
 14312     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 260
* EL050.cbl
 14313
 14314     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14315     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14316
 14317     IF PB-I-AH-REI-RATE = ZERO
 14318         MOVE ER-2645        TO WS-ERROR
 14319         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14320
 14321
 14322 3340-CALCULATE-PREMIUM-AMT.
 14323
 14324     IF PB-COMPANY-ID = 'NCL'
 14325         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14326             WS-AH-SPECIAL-CALC-CD = 'O')
 14327             GO TO 3999-END-EDIT.
 14328
 14329     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14330                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14331                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14332                         OR 'AHL'
 14333         NEXT SENTENCE
 14334     ELSE
 14335         IF WS-STATE-ABBREVIATION = 'CT'
 14336             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14337                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14338                 COMPUTE PB-I-LF-PREM-CALC =
 14339                                     PB-I-LF-PREM-CALC * .90
 14340                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14341                                     PB-I-LF-ALT-PREM-CALC * .90
 14342                 COMPUTE PB-I-AH-PREM-CALC =
 14343                                     PB-I-AH-PREM-CALC * .90.
 14344
 14345     IF PB-COMP-LF-PREM
 14346        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14347        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14348
 14349     IF PB-COMP-AH-PREM
 14350        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14351
 14352 3340-CHECK-DCC-TOT-FEES.
 14353     IF (PB-COMPANY-ID = 'DCC')
 14354        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14355        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14356        AND (PB-I-POLICY-IS-MONTHLY)
 14357        CONTINUE
 14358     ELSE
 14359        GO TO 3340-EDIT-LF-AH-TOL
 14360     END-IF
 14361     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14362     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14363     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14364        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14365           PB-I-RATE-DEV-PCT-LF
 14366     END-IF
 14367     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14368        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14369           PB-I-RATE-DEV-PCT-AH
 14370     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 261
* EL050.cbl
 14371     MOVE 'N'                    TO CP-BEN-CATEGORY
 14372     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14373
 14374     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14375     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14376     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14377     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14378     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14379     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14380     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14381     MOVE '3'                    TO CP-PROCESS-TYPE.
 14382     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14383     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14384
 14385     MOVE PB-SV-STATE            TO CP-STATE.
 14386     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14387     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14388     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14389     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14390     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14391                                    CP-RATING-BENEFIT-AMT.
 14392     IF CP-STATE-STD-ABBRV = 'OR'
 14393         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14394                                         PB-I-LF-ALT-BENEFIT-AMT.
 14395     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14396     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14397     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14398     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14399     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14400     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14401     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14402     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14403     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14404                                    CP-REMAINING-TERM
 14405                                    CP-LOAN-TERM.
 14406
 14407     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14408         NEXT SENTENCE
 14409     ELSE
 14410         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14411             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14412                                           PB-I-LF-PREMIUM-AMT.
 14413
 14414     IF CP-TRUNCATED-LIFE
 14415        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14416
 14417     IF CP-TERM-IS-DAYS
 14418         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14419     ELSE
 14420         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14421
 14422     IF PB-COMPANY-ID = 'DCC'
 14423        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14424     END-IF
 14425     IF CP-SPECIAL-CALC-CD = 'H'
 14426         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14427                                    TO CP-ALTERNATE-BENEFIT
 14428         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 262
* EL050.cbl
 14429     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14430     MOVE 'R'                    TO CP-RATE-FILE
 14431     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14432     IF NOT CP-ERROR-RATE-NOT-FOUND
 14433        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14434        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14435           AND (CP-BENEFIT-CD (1:1) = 'S')
 14436           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14437                                    PB-I-LF-PREMIUM-AMT
 14438        END-IF
 14439     ELSE
 14440        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14441     END-IF
 14442     .
 14443 3340-EDIT-LF-AH-TOL.
 14444
 14445***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14446***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14447***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14448***
 14449     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14450         PB-I-AH-PREMIUM-AMT
 14451          GIVING WS-CALC-WORK.
 14452
 14453     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14454        AND WS-CALC-WORK NOT = ZERO
 14455         MOVE ER-2649            TO WS-ERROR
 14456         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14457
 14458     SUBTRACT PB-I-LF-PREM-CALC
 14459             FROM PB-I-LF-PREMIUM-AMT
 14460                 GIVING WS-UNSIGN-WRK1.
 14461
 14462     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14463             FROM PB-I-LF-ALT-PREMIUM-AMT
 14464                 GIVING WS-UNSIGN-WRK4.
 14465
 14466     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14467                                + WS-UNSIGN-WRK4.
 14468
 14469     SUBTRACT PB-I-AH-PREM-CALC
 14470             FROM PB-I-AH-PREMIUM-AMT
 14471                 GIVING WS-UNSIGN-WRK2.
 14472
 14473******************************************************************
 14474*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14475******************************************************************
 14476
 14477     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14478         MOVE ZERO TO WS-UNSIGN-WRK1.
 14479
 14480     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14481         MOVE ZERO TO WS-UNSIGN-WRK2.
 14482
 14483     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14484             GIVING WS-UNSIGN-WRK3.
 14485
 14486 3342-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 263
* EL050.cbl
 14487
 14488     IF (PB-I-LF-RATE = ZERO  AND
 14489         PB-I-AH-RATE = ZERO)
 14490         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14491            WS-AH-SPECIAL-CALC-CD = 'O'
 14492              NEXT SENTENCE
 14493         ELSE
 14494             GO TO 3345-EDIT-CONTINUE.
 14495
 14496     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14497         NEXT SENTENCE
 14498     ELSE
 14499     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14500        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14501           IF (PB-REISSUED-CERT         OR
 14502               PB-POLICY-IS-DECLINED    OR
 14503               PB-POLICY-IS-VOIDED)
 14504              NEXT SENTENCE
 14505           ELSE
 14506              IF WS-PREM-REJECT-SW = SPACE
 14507                 MOVE ER-2652    TO WS-ERROR
 14508                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14509                 GO TO 3344-CHECK-AH
 14510              ELSE
 14511                 MOVE ER-2650    TO WS-ERROR
 14512                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14513                 GO TO 3344-CHECK-AH.
 14514
 14515***
 14516***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14517***
 14518
 14519     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14520         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14521            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14522             (1 + WS-TOL-LF-PREM-PCT)
 14523         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14524            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14525             (1 - WS-TOL-LF-PREM-PCT)
 14526     ELSE
 14527         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14528         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14529
 14530***
 14531***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14532***
 14533
 14534     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14535         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14536          WS-TOL-LF-PREM.
 14537
 14538     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14539         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14540          WS-TOL-LF-PREM.
 14541
 14542     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14543        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14544
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 264
* EL050.cbl
 14545     IF (PB-REISSUED-CERT        OR
 14546         PB-POLICY-IS-DECLINED   OR
 14547         PB-POLICY-IS-VOIDED)
 14548        NEXT SENTENCE
 14549     ELSE
 14550     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14551           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14552       OR
 14553        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14554           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14555       AND
 14556        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14557           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14558         OR
 14559          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14560           LESS WS-TOL-LF-LOW-PREM-PCT))
 14561              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14562                  MOVE ER-2652   TO  WS-ERROR
 14563                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14564              ELSE
 14565                  MOVE ER-2650   TO  WS-ERROR
 14566                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14567
 14568*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14569*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14570*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14571*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14572
 14573     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14574        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14575                      OR
 14576           ((PB-COMPANY-ID = 'DCC')
 14577           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14578           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14579           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14580        END-IF
 14581     END-IF
 14582
 14583     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14584        IF WS-COMP-MAX-CAP GREATER THAN +0
 14585           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14586              IF (PB-REISSUED-CERT         OR
 14587                  PB-POLICY-IS-DECLINED    OR
 14588                  PB-POLICY-IS-VOIDED)
 14589                 NEXT SENTENCE
 14590              ELSE
 14591                  MOVE ER-2646   TO  WS-ERROR
 14592                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14593
 14594 3344-CVL-TOLERANCE-CHECK.
 14595
 14596      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14597          GO TO 3344-CHECK-AH.
 14598
 14599      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14600          GO TO 3344-CHECK-AH.
 14601
 14602      MOVE ZERO                  TO  WS-UNSIGN-WRK5
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 265
* EL050.cbl
 14603                                     WS-UNSIGN-WRK6.
 14604
 14605      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14606          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14607                                 + PB-I-LF-PREMIUM-AMT
 14608                                 - PB-I-LF-PREM-CALC.
 14609
 14610      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14611          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14612                                 + PB-I-LF-ALT-PREMIUM-AMT
 14613                                 - PB-I-LF-ALT-PREM-CALC.
 14614
 14615      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14616          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14617              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14618                 MOVE ER-2652    TO  WS-ERROR
 14619                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14620              ELSE
 14621                 MOVE ER-2650    TO  WS-ERROR
 14622                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14623
 14624      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14625          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14626              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14627                 MOVE ER-2652    TO  WS-ERROR
 14628                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14629              ELSE
 14630                 MOVE ER-2650    TO  WS-ERROR
 14631                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14632
 14633 3344-CHECK-AH.
 14634
 14635****************************************************************
 14636***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14637***
 14638
 14639     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14640         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14641             (1 + WS-TOL-AH-PREM-PCT)
 14642         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14643             (1 - WS-TOL-AH-PREM-PCT)
 14644     ELSE
 14645         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14646         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14647
 14648***
 14649***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14650***
 14651
 14652     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14653         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14654
 14655     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14656         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14657
 14658     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14659        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14660
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 266
* EL050.cbl
 14661     IF (PB-REISSUED-CERT)
 14662        OR (PB-POLICY-IS-DECLINED)
 14663        OR (PB-POLICY-IS-VOIDED)
 14664        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14665        CONTINUE
 14666     ELSE
 14667        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14668            OR
 14669           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14670           AND
 14671           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14672           OR
 14673           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14674           IF WS-PREM-REJECT-SW = SPACE
 14675              MOVE ER-3052       TO WS-ERROR
 14676              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14677           ELSE
 14678              MOVE ER-3050       TO WS-ERROR
 14679              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14680           END-IF
 14681        END-IF
 14682     END-IF
 14683
 14684     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14685         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14686             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14687             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14688
 14689     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14690        IF WS-COMP-MAX-CAP GREATER THAN +0
 14691           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14692              IF (PB-REISSUED-CERT         OR
 14693                  PB-POLICY-IS-DECLINED    OR
 14694                  PB-POLICY-IS-VOIDED)
 14695                 NEXT SENTENCE
 14696              ELSE
 14697                  MOVE ER-2646   TO  WS-ERROR
 14698                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14699
 14700     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14701        (WS-COMP-MAX-CAP EQUAL +0)
 14702           GO TO 3345-EDIT-CONTINUE.
 14703
 14704     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14705        GREATER THAN WS-COMP-MAX-CAP
 14706           MOVE ER-2646          TO  WS-ERROR
 14707           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14708
 14709 3345-EDIT-CONTINUE.
 14710
 14711*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14712*       IF PB-ENTRY-BATCH   NUMERIC
 14713*          IF PB-ISSUE
 14714*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14715*          ELSE
 14716*              IF PB-CANCELLATION
 14717*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14718
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 267
* EL050.cbl
 14719*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14720*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14721*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14722*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14723*        ELSE
 14724*            MOVE  ER-1909            TO  WS-ERROR
 14725*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14726
 14727     IF PB-I-POLICY-ACCEPTED
 14728        IF PB-POLICY-IS-DECLINED  OR
 14729           PB-REISSUED-CERT  OR
 14730           PB-REIN-ONLY-CERT  OR
 14731           PB-POLICY-IS-VOIDED
 14732            MOVE  ER-1891         TO  WS-ERROR
 14733            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14734        ELSE
 14735            MOVE SPACE            TO  PB-BATCH-ENTRY
 14736            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14737
 14738     IF PB-I-POLICY-DECLINED
 14739        IF PB-REISSUED-CERT  OR
 14740           PB-REIN-ONLY-CERT  OR
 14741           PB-POLICY-IS-VOIDED
 14742            MOVE  ER-1906         TO  WS-ERROR
 14743            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14744        ELSE
 14745            MOVE  'D'             TO  PB-BATCH-ENTRY
 14746                                      PB-I-ENTRY-STATUS.
 14747
 14748     IF PB-I-NEEDS-UNDERWRITING
 14749        IF PB-POLICY-IS-DECLINED OR
 14750           PB-REISSUED-CERT  OR
 14751           PB-REIN-ONLY-CERT  OR
 14752           PB-POLICY-IS-VOIDED
 14753            MOVE  ER-1907         TO  WS-ERROR
 14754            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14755        ELSE
 14756            MOVE 'U'              TO  PB-BATCH-ENTRY
 14757                                      PB-I-ENTRY-STATUS.
 14758
 14759     IF PB-NEEDS-UNDERWRITING
 14760        MOVE  ER-1901             TO  WS-ERROR
 14761        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14762     IF PB-COMPANY-ID = 'DCC'
 14763        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14764        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14765        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14766           AND (NOT WS-LF-CASH))
 14767                           OR
 14768           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14769           AND (NOT WS-AH-CASH)))
 14770                       AND
 14771           (PB-I-ENTRY-STATUS NOT = '5')
 14772           MOVE 'M'              TO PB-BATCH-ENTRY
 14773                                    PB-I-ENTRY-STATUS
 14774        END-IF
 14775     END-IF
 14776     IF  PB-COMPANY-ID NOT = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 268
* EL050.cbl
 14777         GO TO 3999-END-EDIT.
 14778
 14779     IF PB-REISSUED-CERT  OR
 14780        PB-POLICY-IS-DECLINED  OR
 14781        PB-POLICY-IS-VOIDED  OR
 14782        PB-I-OB
 14783         GO TO 3999-END-EDIT.
 14784
 14785     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14786         MOVE  ER-2644            TO  WS-ERROR
 14787         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14788         GO TO 3999-END-EDIT.
 14789
 14790     MOVE 'N'                     TO  FORM-MASTER-SW.
 14791     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14792
 14793     IF NOT FORM-MASTER-FOUND
 14794         GO TO 3999-END-EDIT.
 14795
 14796     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14797                                      FORM-MASTER-AH-SW.
 14798
 14799     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14800         MOVE  +1                 TO SUB6
 14801         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14802
 14803     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14804         MOVE  +1                 TO SUB6
 14805         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14806
 14807     IF LF-FORM-MASTER-FOUND  OR
 14808        AH-FORM-MASTER-FOUND
 14809         GO TO 3360-CHECK-FORM-LIMITS
 14810     ELSE
 14811         GO TO 3999-END-EDIT.
 14812
 14813******************************************************************
 14814*                  3350-GET-ERFORM                               *
 14815*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14816*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14817******************************************************************
 14818
 14819 3350-GET-ERFORM.
 14820
 14821     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14822         GO TO  3350-ERFORM-GETMAIN.
 14823
 14824     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14825     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14826     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14827     MOVE 'Y'                     TO FORM-MASTER-SW.
 14828
 14829     IF PB-CANCELLATION
 14830         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14831            PB-SV-STATE          EQUAL   FO-STATE       AND
 14832            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14833              GO TO 3350-EXIT
 14834         ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 269
* EL050.cbl
 14835             NEXT SENTENCE
 14836     ELSE
 14837         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14838            PB-SV-STATE          EQUAL   FO-STATE       AND
 14839            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14840              GO TO 3350-EXIT.
 14841
 14842 3350-ERFORM-GETMAIN.
 14843
 14844     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14845     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14846
 14847 3350-ERFORM-READ.
 14848
 14849     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14850     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14851     IF PB-CANCELLATION
 14852         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14853     ELSE
 14854         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14855     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14856
 14857     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14858
 14859     IF FORM-MASTER-FOUND
 14860       IF PB-CANCELLATION
 14861          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14862             PB-SV-STATE          EQUAL   FO-STATE       AND
 14863             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14864              GO  TO 3350-EXIT
 14865          ELSE
 14866              NEXT SENTENCE
 14867       ELSE
 14868          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14869             PB-SV-STATE          EQUAL   FO-STATE       AND
 14870             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14871              GO  TO 3350-EXIT.
 14872
 14873     MOVE  'N'                    TO  FORM-MASTER-SW.
 14874     MOVE  ER-1895                TO  WS-ERROR.
 14875     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14876
 14877 3350-EXIT.
 14878      EXIT.
 14879
 14880******************************************************************
 14881*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14882*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14883*   VALID FOR THE POLICY FORM USED.                              *
 14884******************************************************************
 14885
 14886 3355-EDIT-FORM-LF-BENEFITS.
 14887
 14888     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14889        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14890         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14891         GO TO   3355-EXIT.
 14892
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 270
* EL050.cbl
 14893     IF  SUB6    LESS THAN   +40
 14894         ADD  +1      TO  SUB6
 14895         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14896
 14897     MOVE  ER-1896         TO  WS-ERROR.
 14898     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14899
 14900 3355-EXIT.
 14901      EXIT.
 14902
 14903******************************************************************
 14904*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14905*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14906*   VALID FOR THE POLICY FORM USED.                              *
 14907******************************************************************
 14908
 14909 3356-EDIT-FORM-AH-BENEFITS.
 14910
 14911     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14912        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14913         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14914         GO TO  3356-EXIT.
 14915
 14916      IF  SUB6    LESS THAN     +40
 14917          ADD  +1      TO  SUB6
 14918          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14919
 14920     MOVE  ER-1897         TO  WS-ERROR.
 14921     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14922
 14923 3356-EXIT.
 14924      EXIT.
 14925
 14926******************************************************************
 14927*                  3357-BENEFIT-SEARCH                           *
 14928*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14929*   CANCELLATIONS ONLY.                                          *
 14930******************************************************************
 14931 3357-BENEFIT-SEARCH.
 14932     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14933         MOVE +1                          TO SUB6
 14934         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14935
 14936     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14937         MOVE +1                          TO SUB6
 14938         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14939
 14940 3357-EXIT.
 14941     EXIT.
 14942
 14943******************************************************************
 14944*                  3358-BENEFIT-LIFE-SEARCH                      *
 14945*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14946*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14947*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14948******************************************************************
 14949 3358-BENEFIT-LIFE-SEARCH.
 14950     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 271
* EL050.cbl
 14951       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14952         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14953           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14954              IF FO-PLAN-REFUND-METHOD (SUB6)
 14955                     IS GREATER THAN SPACES
 14956                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14957                                          WS-LF-REFUND-CALC
 14958                 GO TO 3358-EXIT.
 14959
 14960     IF SUB6 LESS THAN +40
 14961         ADD +1                 TO SUB6
 14962         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14963
 14964 3358-EXIT.
 14965     EXIT.
 14966******************************************************************
 14967*                  3359-BENEFIT-AH-SEARCH                        *
 14968*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14969*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14970*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14971******************************************************************
 14972 3359-BENEFIT-AH-SEARCH.
 14973     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14974       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14975         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14976           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14977              IF FO-PLAN-REFUND-METHOD (SUB6)
 14978                      IS GREATER THAN SPACES
 14979                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14980                                          WS-AH-REFUND-CALC
 14981                 GO TO 3359-EXIT.
 14982
 14983     IF SUB6 LESS THAN +40
 14984         ADD +1                 TO SUB6
 14985         GO TO 3359-BENEFIT-AH-SEARCH.
 14986
 14987 3359-EXIT.
 14988     EXIT.
 14989
 14990******************************************************************
 14991*                  3360-CHECK-FORM-LIMITS                        *
 14992*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14993*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14994******************************************************************
 14995
 14996 3360-CHECK-FORM-LIMITS.
 14997
 14998     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14999         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15000
 15001     IF NOT LF-FORM-MASTER-FOUND
 15002         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15003
 15004 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15005
 15006     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15007       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15008        WS-LF-JOINT-INDICATOR = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 272
* EL050.cbl
 15009        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15010         IF PB-COMPANY-ID = 'NCL'
 15011            MOVE  ER-1911          TO  WS-ERROR
 15012            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15013         ELSE
 15014            MOVE  ER-1892          TO  WS-ERROR
 15015            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15016
 15017 3360-CHECK-FORM-LF-ATT-AGE.
 15018
 15019     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15020
 15021     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15022         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15023         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15024            IF PB-COMPANY-ID = 'NCL'
 15025                MOVE  ER-1913      TO  WS-ERROR
 15026                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15027            ELSE
 15028                MOVE  ER-1894      TO  WS-ERROR
 15029                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15030
 15031 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15032
 15033     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15034         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15035         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15036            IF PB-COMPANY-ID = 'NCL'
 15037                MOVE  ER-1914      TO  WS-ERROR
 15038                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15039            ELSE
 15040                MOVE  ER-1899      TO  WS-ERROR
 15041                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15042
 15043 3360-CHECK-FORM-LF-TERM-BAMT.
 15044
 15045     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15046         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15047         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15048           IF  PB-COMPANY-ID = 'NCL'
 15049               MOVE  ER-1916       TO  WS-ERROR
 15050               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15051           ELSE
 15052               MOVE  ER-1902       TO  WS-ERROR
 15053               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15054
 15055     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15056                                    PB-I-LF-ALT-BENEFIT-AMT.
 15057
 15058     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15059         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15060         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15061             IF  PB-COMPANY-ID = 'NCL'
 15062                 MOVE  ER-1918     TO  WS-ERROR
 15063                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15064             ELSE
 15065                 MOVE  ER-1904     TO  WS-ERROR
 15066                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 273
* EL050.cbl
 15067
 15068******************************************************************
 15069*                  3360-CHECK-FORM-AH-LIMITS                     *
 15070*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15071*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15072******************************************************************
 15073
 15074 3360-CHECK-FORM-AH-LIMITS.
 15075
 15076     IF NOT AH-FORM-MASTER-FOUND
 15077         GO TO 3999-END-EDIT.
 15078
 15079 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15080
 15081     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15082       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15083        WS-AH-JOINT-INDICATOR = 'J'  AND
 15084        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15085         IF PB-COMPANY-ID = 'NCL'
 15086            MOVE  ER-1912          TO  WS-ERROR
 15087            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15088         ELSE
 15089            MOVE  ER-1893          TO  WS-ERROR
 15090            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15091
 15092 3360-CHECK-FORM-AH-ATT-AGE.
 15093
 15094     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15095
 15096     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15097         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15098         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15099            IF PB-COMPANY-ID = 'NCL'
 15100                MOVE  ER-1913      TO  WS-ERROR
 15101                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15102            ELSE
 15103                MOVE  ER-1894      TO  WS-ERROR
 15104                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15105
 15106 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15107
 15108     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15109         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15110         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15111            IF PB-COMPANY-ID = 'NCL'
 15112                MOVE  ER-1915      TO  WS-ERROR
 15113                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15114            ELSE
 15115                MOVE  ER-1900      TO  WS-ERROR
 15116                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15117
 15118 3360-CHECK-FORM-AH-TERM-BAMT.
 15119
 15120     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15121         FO-AH-MAX-TERM    GREATER THAN  +0
 15122         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15123             IF  PB-COMPANY-ID = 'NCL'
 15124                 MOVE  ER-1917     TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 274
* EL050.cbl
 15125                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15126             ELSE
 15127                  MOVE  ER-1903    TO  WS-ERROR
 15128                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15129
 15130     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15131         FO-MAX-AH-AMT    GREATER THAN  +0
 15132         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15133             IF  PB-COMPANY-ID = 'NCL'
 15134                 MOVE  ER-1919     TO  WS-ERROR
 15135                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15136             ELSE
 15137                 MOVE  ER-1905     TO  WS-ERROR
 15138                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15139
 15140     GO TO 3999-END-EDIT.
 15141
 15142******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 275
* EL050.cbl
 15144******************************************************************
 15145*                  E D I T   C A N C E L                         *
 15146******************************************************************
 15147
 15148 3700-EDIT-CANCEL.
 15149     IF PB-COMPANY-ID = 'DMD'
 15150         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15151                                         WS-RES-MUNI-TAX
 15152                                         PB-CI-STATE-TAX
 15153                                         PB-CI-MUNI-TAX
 15154         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15155
 15156*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15157*       IF PB-ENTRY-BATCH  NUMERIC
 15158*          IF PB-CANCELLATION
 15159*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15160*          ELSE
 15161*             IF PB-ISSUE
 15162*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15163
 15164     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15165        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15166     END-IF
 15167*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15168*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15169
 15170     IF CM-ENTRY-STATUS = 'V'
 15171        MOVE ER-2780             TO WS-ERROR
 15172        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15173        GO TO 3999-END-EDIT.
 15174
 15175     IF CM-ENTRY-STATUS = 'D'
 15176        MOVE ER-2781             TO WS-ERROR
 15177        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15178        GO TO 3999-END-EDIT.
 15179
 15180     IF CM-ENTRY-STATUS = 'U'
 15181        MOVE ER-2782             TO WS-ERROR
 15182        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15183
 15184***************************************************************
 15185*                                                             *
 15186*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15187*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15188*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15189*   OF ANOTHER COVERAGE.                                      *
 15190*                                                             *
 15191***************************************************************
 15192
 15193     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15194                                    PB-C-AH-CANCEL-VOID-SW.
 15195
 15196     IF PB-C-LF-CANCEL-AMT = ZERO
 15197        NEXT SENTENCE
 15198     ELSE
 15199        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15200           AND
 15201           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 276
* EL050.cbl
 15202               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15203               MOVE ER-2745           TO WS-ERROR
 15204               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15205
 15206     IF PB-C-AH-CANCEL-AMT = ZERO
 15207        NEXT SENTENCE
 15208     ELSE
 15209        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15210           AND
 15211           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15212               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15213               MOVE ER-2745           TO WS-ERROR
 15214               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15215
 15216     IF WS-LF-EARNINGS-CALC = '4'
 15217        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15218
 15219     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15220     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15221     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15222     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15223     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15224     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15225
 15226     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15227                                      PB-C-AH-REF-CALC.
 15228     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15229
 15230******************************************************************
 15231*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15232*             TO VALIDATE COVERAGE.                              *
 15233******************************************************************
 15234
 15235     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15236        PB-C-LF-CANCEL-AMT = ZEROS
 15237          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15238      ELSE
 15239          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15240
 15241     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15242        PB-C-AH-CANCEL-AMT = ZEROS
 15243          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15244      ELSE
 15245          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15246
 15247     EVALUATE TRUE
 15248         WHEN PB-CANCEL-FORCE             OR
 15249              PB-CANCEL-DATE-FORCED       OR
 15250              PB-FORCE-OFF
 15251                  IF PB-COMPANY-ID = 'ACE'
 15252                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15253                  END-IF
 15254         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15255               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15256              (PB-COMPANY-ID = 'ACE' )
 15257                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15258         WHEN OTHER
 15259              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 277
* EL050.cbl
 15260                 MOVE ER-2794              TO WS-ERROR
 15261              ELSE
 15262                 MOVE ER-2749              TO WS-ERROR
 15263              END-IF
 15264              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15265     END-EVALUATE.
 15266
 15267
 15268*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15269*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15270*            MOVE  ER-1909            TO  WS-ERROR
 15271*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15272*        ELSE
 15273*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15274
 15275     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15276     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15277        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15278     ELSE
 15279        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15280     END-IF
 15281     .
 15282 3705-EDIT-CANCEL-DT.
 15283
 15284     IF LF-COVERAGE-CANCELLED
 15285        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15286         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15287         MOVE WS-CURRENT-MONTH-END
 15288                                 TO DC-BIN-DATE-2
 15289         SET ELAPSED-BETWEEN-BIN TO TRUE
 15290*        MOVE 1                  TO DC-OPTION-CODE
 15291         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15292         IF DATE-CONVERSION-ERROR
 15293            NEXT SENTENCE
 15294          ELSE
 15295             IF DC-ELAPSED-DAYS GREATER +180
 15296                IF PB-CANCEL-DATE-FORCED  OR
 15297                   PB-CANCEL-DATE-FORCED-NO-FEE
 15298                      MOVE ER-2751  TO WS-ERROR
 15299                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15300                 ELSE
 15301                   MOVE ER-2752  TO WS-ERROR
 15302                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15303
 15304     IF AH-COVERAGE-CANCELLED
 15305        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15306         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15307         MOVE WS-CURRENT-MONTH-END
 15308                                 TO DC-BIN-DATE-2
 15309         SET ELAPSED-BETWEEN-BIN TO TRUE
 15310*        MOVE 1                  TO DC-OPTION-CODE
 15311         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15312         IF DATE-CONVERSION-ERROR
 15313            NEXT SENTENCE
 15314          ELSE
 15315             IF DC-ELAPSED-DAYS GREATER +180
 15316                IF PB-CANCEL-DATE-FORCED OR
 15317                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 278
* EL050.cbl
 15318                      MOVE ER-2751  TO WS-ERROR
 15319                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15320                 ELSE
 15321                   MOVE ER-2752  TO WS-ERROR
 15322                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15323
 15324     IF WS-ERROR = ER-2752
 15325        AND (PB-COMPANY-ID = 'ABL'
 15326         OR  PB-COMPANY-ID = 'FGL'
 15327         OR  PB-COMPANY-ID = 'IST'
 15328         OR  PB-COMPANY-ID = 'JHL'
 15329         OR  PB-COMPANY-ID = 'LAP'
 15330         OR  PB-COMPANY-ID = 'LBL'
 15331         OR  PB-COMPANY-ID = 'NCB'
 15332         OR  PB-COMPANY-ID = 'NLI'
 15333         OR  PB-COMPANY-ID = 'OFI'
 15334         OR  PB-COMPANY-ID = 'PLI'
 15335         OR  PB-COMPANY-ID = 'TAO'
 15336         OR  PB-COMPANY-ID = 'TIC'
 15337         OR  PB-COMPANY-ID = 'HER'
 15338         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15339         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15340            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15341            MOVE ER-2762     TO WS-ERROR
 15342            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15343
 15344     IF LF-COVERAGE-CANCELLED
 15345        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15346        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15347             MOVE ER-2733         TO WS-ERROR
 15348             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15349
 15350     IF AH-COVERAGE-CANCELLED
 15351        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15352        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15353              MOVE ER-2733        TO WS-ERROR
 15354              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15355
 15356     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15357        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15358        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15359           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15360            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15361              IF PB-COMPANY-ID NOT = 'LAP'
 15362               MOVE ER-2704            TO WS-ERROR
 15363               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15364
 15365     IF CERT-WAS-NOT-FOUND
 15366         GO TO 3999-END-EDIT.
 15367
 15368     IF PB-COMPANY-ID EQUAL 'CDC'
 15369        IF LF-COVERAGE-CANCELLED
 15370           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15371            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15372            MOVE PB-C-LF-CANCEL-DT
 15373                                 TO DC-BIN-DATE-2
 15374            SET ELAPSED-BETWEEN-BIN TO TRUE
 15375*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 279
* EL050.cbl
 15376            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15377            IF DATE-CONVERSION-ERROR
 15378               NEXT SENTENCE
 15379             ELSE
 15380                IF DC-ELAPSED-DAYS GREATER +60
 15381                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15382
 15383     IF PB-COMPANY-ID EQUAL 'CDC'
 15384        IF AH-COVERAGE-CANCELLED
 15385           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15386            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15387            MOVE PB-C-AH-CANCEL-DT
 15388                                 TO DC-BIN-DATE-2
 15389            MOVE +0              TO DC-ELAPSED-DAYS
 15390                                    DC-ELAPSED-MONTHS
 15391            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15392*           MOVE 1               TO DC-OPTION-CODE
 15393            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15394            IF DATE-CONVERSION-ERROR
 15395               NEXT SENTENCE
 15396             ELSE
 15397                IF DC-ELAPSED-DAYS GREATER +60
 15398                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15399
 15400     MOVE +0                     TO DC-ELAPSED-DAYS
 15401                                    DC-ELAPSED-MONTHS.
 15402
 15403     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15404        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15405          MOVE 'Z'                TO PB-CI-OB-FLAG
 15406          MOVE ER-2767            TO WS-ERROR
 15407          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15408          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15409          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15410          GO TO 3775-OVER-REF-CHK
 15411        ELSE
 15412          MOVE ZEROS              TO PB-CI-LIVES
 15413                                     PB-C-LIVES
 15414          IF PB-CI-OB-FLAG NOT = 'B'
 15415             MOVE SPACE           TO PB-CI-OB-FLAG.
 15416
 15417     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15418         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15419     ELSE
 15420         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15421
 15422     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15423        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15424            MOVE ER-2760         TO WS-ERROR
 15425            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15426
 15427     IF LF-COVERAGE-CANCELLED
 15428        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15429         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15430            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15431               MOVE ER-2774       TO WS-ERROR
 15432               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15433
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 280
* EL050.cbl
 15434     IF AH-COVERAGE-CANCELLED
 15435        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15436         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15437            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15438               MOVE ER-2775       TO WS-ERROR
 15439               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15440
 15441     IF LF-COVERAGE-CANCELLED
 15442        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15443         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15444            MOVE ER-2776         TO WS-ERROR
 15445            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15446
 15447     IF AH-COVERAGE-CANCELLED
 15448        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15449         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15450            MOVE ER-2777         TO WS-ERROR
 15451            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15452
 15453     IF LF-COVERAGE-CANCELLED
 15454        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15455         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15456         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15457         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15458*        MOVE 6                    TO DC-OPTION-CODE
 15459         SET BIN-PLUS-ELAPSED      TO TRUE
 15460         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15461         IF DATE-CONVERSION-ERROR
 15462            NEXT SENTENCE
 15463          ELSE
 15464            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15465              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15466                             OR  'FIA'
 15467                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15468               ELSE
 15469                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15470                MOVE ER-2731       TO WS-ERROR
 15471                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15472
 15473 3705-EDIT-AH-CANCEL-DT.
 15474
 15475     IF AH-COVERAGE-CANCELLED
 15476        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15477         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15478         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15479         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15480*        MOVE 6                    TO DC-OPTION-CODE
 15481         SET BIN-PLUS-ELAPSED      TO TRUE
 15482         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15483         IF DATE-CONVERSION-ERROR
 15484            NEXT SENTENCE
 15485          ELSE
 15486            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15487              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15488                              OR 'FIA'
 15489                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15490              ELSE
 15491               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 281
* EL050.cbl
 15492               MOVE ER-2771       TO WS-ERROR
 15493               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15494
 15495 3705-EDIT-CONTINUED.
 15496
 15497*    IF LF-COVERAGE-CANCELLED
 15498*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15499*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15500*            MOVE ER-2727         TO WS-ERROR
 15501*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15502*
 15503*    IF AH-COVERAGE-CANCELLED
 15504*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15505*        IF PB-COMPANY-ID = 'ACE'
 15506*           MOVE ER-2727        TO WS-ERROR
 15507*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15508*        ELSE
 15509*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15510*              MOVE ER-2727     TO WS-ERROR
 15511*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15512
 15513     IF PB-COMPANY-ID = 'ACE'
 15514       IF AH-COVERAGE-CANCELLED
 15515         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15516           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15517              MOVE ER-2732      TO WS-ERROR
 15518              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15519
 15520     IF PB-COMPANY-ID      EQUAL   'HER'
 15521        IF WS-ERROR        EQUAL   ER-2727
 15522            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15523            MOVE  ER-2725          TO  WS-ERROR
 15524            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15525
 15526     IF PB-C-CLAIM-CREATED-CANCEL
 15527            MOVE ER-2748         TO WS-ERROR
 15528            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15529
 15530     IF PB-C-LAST-NAME NOT = SPACES
 15531         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15532            MOVE ER-2747         TO WS-ERROR
 15533            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15534
 15535 3710-EDIT-LUMP-SUM-PRIOR.
 15536
 15537     IF AH-COVERAGE-CANCELLED
 15538         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15539             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15540                MOVE ER-2735    TO WS-ERROR
 15541                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15542
 15543     IF LF-COVERAGE-CANCELLED
 15544         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15545             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15546                MOVE ER-2735    TO WS-ERROR
 15547                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15548
 15549 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 282
* EL050.cbl
 15550
 15551*    IF LF-COVERAGE-CANCELLED
 15552*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15553*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15554*           (NOT PB-CI-OB)
 15555*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15556*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15557*                   MOVE ER-2732  TO WS-ERROR
 15558*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15559*
 15560*    IF AH-COVERAGE-CANCELLED
 15561*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15562*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15563*           (NOT PB-CI-OB)
 15564*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15565*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15566*                   MOVE ER-2732  TO WS-ERROR
 15567*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15568
 15569     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15570         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15571            (NOT PB-COMP-LF-CANCEL)
 15572             NEXT SENTENCE
 15573         ELSE
 15574           IF PB-C-LF-CANCEL-VOIDED
 15575              NEXT SENTENCE
 15576           ELSE
 15577              MOVE ER-2753      TO WS-ERROR
 15578              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15579
 15580     IF CANCEL-FUTURE-DT
 15581         GO TO 3999-END-EDIT.
 15582
 15583 3715-GET-REMAIN-TERM-LF.
 15584
 15585     IF NO-LF-BENEFIT-MATCH  OR
 15586        WS-LF-BENEFIT-CD = ZEROS
 15587        GO TO 3730-GET-AH-REMAIN-TERM.
 15588
 15589     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15590     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15591     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15592     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15593     MOVE PB-SV-STATE            TO CP-STATE.
 15594     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15595     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15596     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15597     MOVE '2'                    TO CP-PROCESS-TYPE.
 15598     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15599     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15600     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15601     IF (PB-COMPANY-ID = 'CID')
 15602        AND (CP-STATE-STD-ABBRV = 'WI')
 15603        MOVE '7'                 TO CP-REM-TERM-METHOD
 15604        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15605     ELSE
 15606        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15607        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 283
* EL050.cbl
 15608                                 TO CP-REM-TRM-CALC-OPTION
 15609     END-IF
 15610**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15611     IF (PB-COMPANY-ID = 'CID')
 15612        AND (CP-STATE-STD-ABBRV = 'MO')
 15613        AND (PB-CERT-EFF-DT >= X'9B41')
 15614        AND (PB-CERT-EFF-DT <= X'A2FB')
 15615        MOVE '7'                 TO CP-REM-TERM-METHOD
 15616        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15617     END-IF
 15618     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15619                                    CP-LOAN-TERM.
 15620     IF CP-TRUNCATED-LIFE
 15621        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15622
 15623     IF CP-TERM-IS-DAYS
 15624         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15625     ELSE
 15626         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15627
 15628     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15629
 15630     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15631
 15632     IF LF-COVERAGE-CANCELLED
 15633        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15634        NEXT SENTENCE
 15635      ELSE
 15636          GO TO 3730-GET-AH-REMAIN-TERM.
 15637
 15638 3720-GET-LF-REFUND.
 15639
 15640     IF PB-C-LF-CANCEL-VOIDED OR
 15641        PB-C-AH-CANCEL-VOIDED
 15642        GO TO 3780-UPDATE-CANCEL-CERT.
 15643
 15644     IF PB-COMPANY-ID EQUAL 'BOA'
 15645         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15646         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15647         GO TO 3730-GET-AH-REMAIN-TERM.
 15648
 15649     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15650        (WS-AH-SPECIAL-CALC-CD = 'M')
 15651         MOVE ER-2767            TO WS-ERROR
 15652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15653         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15654         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15655         GO TO 3780-UPDATE-CANCEL-CERT.
 15656
 15657     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15658
 15659     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15660     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15661     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15662     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15663     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15664     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15665     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 284
* EL050.cbl
 15666        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15667        IF PDEF-MASTER-FOUND
 15668           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15669              (V1 > +8)
 15670              OR (PD-PROD-CODE (V1) = 'L')
 15671           END-PERFORM
 15672           IF V1 < +9
 15673              MOVE PD-MAX-AMT (V1)
 15674                           TO CP-R-MAX-TOT-BEN
 15675                              EC-AM-LF-MAX-TOT-BEN
 15676           END-IF
 15677        ELSE
 15678        MOVE ' '                 TO PDEF-MASTER-SW
 15679        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15680        MOVE PB-STATE            TO ERPDEF-STATE
 15681        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15682        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15683        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15684        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15685        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15686        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15687        IF PDEF-MASTER-FOUND
 15688           MOVE 'N'              TO PDEF-MASTER-SW
 15689           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15690           IF PDEF-MASTER-FOUND
 15691              IF (ERPDEF-KEY-SAVE (1:16) =
 15692                           PD-CONTROL-PRIMARY (1:16))
 15693                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15694                 CONTINUE
 15695              ELSE
 15696                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15697                 IF (ERPDEF-KEY-SAVE (1:16) =
 15698                           PD-CONTROL-PRIMARY (1:16))
 15699                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15700                    CONTINUE
 15701                 ELSE
 15702                    MOVE 'N'     TO PDEF-MASTER-SW
 15703                 END-IF
 15704              END-IF
 15705              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15706
 15707              IF PDEF-MASTER-FOUND
 15708                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15709                    (V1 > +8)
 15710                    OR (PD-PROD-CODE (V1) = 'L')
 15711                 END-PERFORM
 15712                 IF V1 < +9
 15713                    MOVE PD-MAX-AMT (V1)
 15714                                 TO CP-R-MAX-TOT-BEN
 15715                                    EC-AM-LF-MAX-TOT-BEN
 15716                 END-IF
 15717              END-IF
 15718           END-IF
 15719           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15720        END-IF
 15721        END-IF
 15722     END-IF
 15723     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 285
* EL050.cbl
 15724
 15725     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15726
 15727     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15728                                    PB-C-LF-REM-TERM.
 15729
 15730     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15731     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15732
 15733     IF PB-COMPANY-ID EQUAL 'FLC'
 15734        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15735           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15736           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15737                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15738                    - CM-LF-ITD-DEATH-AMT
 15739           IF PB-C-LF-REF-CALC LESS THAN +0
 15740              MOVE +0            TO PB-C-LF-REF-CALC
 15741              GO TO 3730-GET-AH-REMAIN-TERM
 15742           ELSE
 15743              GO TO 3730-GET-AH-REMAIN-TERM.
 15744
 15745     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15746                            OR '4' OR '5' OR '6' OR '8'
 15747                            OR '9' OR 'G'
 15748        MOVE PB-C-LF-REFUND-OVERRIDE
 15749                                 TO CP-EARNING-METHOD.
 15750
 15751     if pb-company-id = 'AHL'
 15752        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15753        if cp-class-code = spaces
 15754           move zeros            to cp-class-code
 15755        end-if
 15756     ELSE
 15757        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15758     END-IF
 15759*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15760     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15761     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15762                                    CP-RATING-BENEFIT-AMT.
 15763     IF CP-STATE-STD-ABBRV = 'OR'
 15764         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15765                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15766     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15767     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15768     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15769     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15770     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15771     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15772     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15773     IF WS-DEFAULT-APR NOT NUMERIC
 15774         MOVE ZEROS TO WS-DEFAULT-APR.
 15775****   N O T E   ****
 15776*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15777*      THE OH HARD CODING IN ELCRFNDP
 15778
 15779     IF PB-COMPANY-ID = 'CID'
 15780        IF CP-STATE-STD-ABBRV = 'OH'
 15781           MOVE WS-LF-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 286
* EL050.cbl
 15782                                 TO CP-EARNING-METHOD
 15783        END-IF
 15784     END-IF
 15785
 15786****   N O T E   ****
 15787
 15788     IF CP-EARN-AS-NET-PAY
 15789         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15790            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15791                MOVE WS-DEFAULT-APR
 15792                                 TO  CP-LOAN-APR
 15793                MOVE ER-3780     TO  WS-ERROR
 15794                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15795            ELSE
 15796                MOVE ER-3781     TO  WS-ERROR
 15797                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15798     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15799     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15800
 15801     IF CP-REFUND-TYPE-USED NOT = SPACE
 15802         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15803
 15804     IF CP-ERROR-RATE-IS-ZERO OR
 15805        CP-ERROR-RATE-NOT-FOUND
 15806        MOVE ER-2740             TO WS-ERROR
 15807        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15808
 15809     IF CP-ERROR-RATE-FILE-NOTOPEN
 15810        MOVE ER-2617             TO WS-ERROR
 15811        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15812
 15813     IF PB-COMPANY-ID = 'DCC'
 15814        AND PB-CI-ENTRY-STATUS = 'M'
 15815        MOVE +0                  TO PB-C-LF-REF-CALC
 15816     ELSE
 15817        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15818     END-IF
 15819
 15820     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15821         GO TO 3730-GET-AH-REMAIN-TERM.
 15822
 15823*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15824*       ADD +1                   TO PB-C-LF-REM-TERM
 15825*                                   CP-REMAINING-TERM
 15826*                                   CP-ORIGINAL-TERM.
 15827
 15828     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15829     MOVE '2'                    TO CP-EARNING-METHOD
 15830                                    CP-RATING-METHOD.
 15831     IF PB-COMPANY-ID = 'CID'
 15832        IF (CP-STATE-STD-ABBRV = 'MN')
 15833           AND (PB-CERT-EFF-DT > X'A4FF')
 15834           AND (WS-LF-EARNINGS-CALC = 'B')
 15835           MOVE '5'              TO CP-EARNING-METHOD
 15836           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15837        END-IF
 15838     END-IF
 15839     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 287
* EL050.cbl
 15840                                        CP-REMAINING-BENEFIT
 15841                                        CP-RATING-BENEFIT-AMT.
 15842     IF CP-STATE-STD-ABBRV = 'OR'
 15843         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15844                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15845     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15846     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15847
 15848     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15849
 15850     IF CP-ERROR-RATE-IS-ZERO OR
 15851        CP-ERROR-RATE-NOT-FOUND
 15852        MOVE ER-2740             TO WS-ERROR
 15853        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15854
 15855     IF CP-ERROR-RATE-FILE-NOTOPEN
 15856        MOVE ER-2617             TO WS-ERROR
 15857        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15858
 15859     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15860
 15861******************************************************************
 15862
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 288
* EL050.cbl
 15864 3730-GET-AH-REMAIN-TERM.
 15865     IF NO-AH-BENEFIT-MATCH  OR
 15866        WS-AH-BENEFIT-CD = ZEROS
 15867         GO TO 3770-CHECK-REFUNDS.
 15868
 15869     IF PB-CI-AH-LUMP-SUM-DISAB
 15870         IF  PB-C-AH-CANCEL-AMT = ZERO
 15871            IF NOT PB-COMP-AH-CANCEL
 15872             GO TO 3770-CHECK-REFUNDS.
 15873
 15874     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15875     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15876     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15877     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15878     MOVE PB-SV-STATE            TO CP-STATE.
 15879     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15880     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15881     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15882     MOVE '2'                    TO CP-PROCESS-TYPE.
 15883     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15884     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15885     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15886     IF (PB-COMPANY-ID = 'CID')
 15887        AND (CP-STATE-STD-ABBRV = 'WI')
 15888        MOVE '7'                 TO CP-REM-TERM-METHOD
 15889        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15890     ELSE
 15891        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15892        MOVE WS-REM-TRM-CALC-OPTION
 15893                                 TO CP-REM-TRM-CALC-OPTION
 15894     END-IF
 15895     IF (PB-COMPANY-ID = 'CID')
 15896        AND (CP-STATE-STD-ABBRV = 'MO')
 15897        AND (PB-CERT-EFF-DT >= X'9B41')
 15898        AND (PB-CERT-EFF-DT <= X'A2FB')
 15899        MOVE '7'                 TO CP-REM-TERM-METHOD
 15900        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15901     END-IF
 15902     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15903                                    CP-LOAN-TERM.
 15904     IF NOT CP-TERM-IS-DAYS
 15905         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15906
 15907     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15908
 15909     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15910
 15911     IF AH-COVERAGE-CANCELLED
 15912        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15913        NEXT SENTENCE
 15914      ELSE
 15915         GO TO 3770-CHECK-REFUNDS.
 15916
 15917 3740-GET-AH-REFUND.
 15918
 15919     IF PB-C-LF-CANCEL-VOIDED OR
 15920        PB-C-AH-CANCEL-VOIDED
 15921        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 289
* EL050.cbl
 15922
 15923     IF PB-COMPANY-ID = 'BOA'
 15924         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15925         GO TO 3770-CHECK-REFUNDS.
 15926
 15927     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15928*    MOVE ' '                    TO DC-OPTION-CODE
 15929     SET BIN-TO-GREG             TO TRUE
 15930     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15931     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15932                                    PB-C-AH-REM-TERM.
 15933     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15934     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15935
 15936     IF PB-COMPANY-ID EQUAL 'FLC'
 15937        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15938           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15939           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15940                    - CM-AH-ITD-AH-PMT)
 15941           IF PB-C-AH-REF-CALC LESS THAN +0
 15942              MOVE +0            TO PB-C-AH-REF-CALC
 15943              GO TO 3770-CHECK-REFUNDS
 15944           ELSE
 15945              GO TO 3770-CHECK-REFUNDS.
 15946
 15947     IF PB-COMPANY-ID = 'DCC'
 15948        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15949            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15950           MOVE 'S'              TO CP-EARNING-METHOD
 15951        END-IF
 15952     END-IF
 15953     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15954                            OR '4' OR '5' OR '6' OR '8'
 15955                            OR '9' OR 'G' OR 'S'
 15956        MOVE PB-C-AH-REFUND-OVERRIDE
 15957                                 TO CP-EARNING-METHOD.
 15958
 15959     if pb-company-id = 'AHL'
 15960        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 15961        if cp-class-code = spaces
 15962           move zeros            to cp-class-code
 15963        end-if
 15964     ELSE
 15965        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15966     END-IF
 15967*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15968     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15969     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15970                                    CP-RATING-BENEFIT-AMT.
 15971     IF CP-STATE-STD-ABBRV = 'OR'
 15972         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15973                                         PB-CI-AH-TERM.
 15974     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15975     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15976     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15977     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15978     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15979     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 290
* EL050.cbl
 15980
 15981     IF CP-STATE-STD-ABBRV = 'OH'
 15982        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15983                                AND 'CID' AND 'DCC' AND 'AHL')
 15984           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15985              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15986              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15987              MOVE '6' TO CP-EARNING-METHOD
 15988           END-IF
 15989        END-IF
 15990        IF PB-COMPANY-ID = 'CID'
 15991           IF NO-LIFE-COVERAGE
 15992              IF CP-CRITICAL-PERIOD
 15993                 MOVE '2'       TO CP-EARNING-METHOD
 15994              ELSE
 15995                 MOVE '6'       TO CP-EARNING-METHOD
 15996              END-IF
 15997           ELSE
 15998              IF WS-LF-COVERAGE-TYPE = 'L'
 15999                 MOVE '2'       TO CP-EARNING-METHOD
 16000              ELSE
 16001                 IF (PB-CI-LF-TERM > +60) OR
 16002                    (WS-LF-EARNINGS-CALC = '5')
 16003                    IF CP-CRITICAL-PERIOD
 16004                       MOVE '2'  TO CP-EARNING-METHOD
 16005                    ELSE
 16006                       MOVE '6'  TO CP-EARNING-METHOD
 16007                    END-IF
 16008                 ELSE
 16009                    MOVE '1'     TO CP-EARNING-METHOD
 16010                 END-IF
 16011              END-IF
 16012           END-IF
 16013        END-IF
 16014     END-IF
 16015
 16016*    IF CP-STATE-STD-ABBRV = 'VA'
 16017*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16018*          IF CP-ORIGINAL-TERM GREATER 61
 16019*             MOVE '6' TO CP-EARNING-METHOD
 16020*          ELSE
 16021*             MOVE '1' TO CP-EARNING-METHOD.
 16022
 16023     IF WS-DEFAULT-APR NOT NUMERIC
 16024         MOVE ZEROS TO WS-DEFAULT-APR.
 16025     IF CP-EARN-AS-NET-PAY
 16026         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16027            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16028                MOVE WS-DEFAULT-APR
 16029                                 TO  CP-LOAN-APR
 16030                MOVE ER-3780     TO  WS-ERROR
 16031                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16032            ELSE
 16033                MOVE ER-3781     TO  WS-ERROR
 16034                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16035     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16036     IF PB-COMPANY-ID = 'DCC'
 16037        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 291
* EL050.cbl
 16038        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16039        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16040     END-IF
 16041     IF PB-COMPANY-ID = 'DCC'
 16042        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16043        AND (CP-EARNING-METHOD = 'D')
 16044        AND (CP-CANCEL-REASON NOT = 'R')
 16045        CONTINUE
 16046     ELSE
 16047        GO TO 3750-CONTINUE
 16048     END-IF
 16049     MOVE ' '                    TO DD-IU-SW
 16050     IF NOT PDEF-MASTER-FOUND
 16051        MOVE ' '                 TO PDEF-MASTER-SW
 16052        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16053        MOVE PB-STATE            TO ERPDEF-STATE
 16054        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16055        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16056        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16057        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16058        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16059        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16060        IF PDEF-MASTER-FOUND
 16061           MOVE 'N'              TO PDEF-MASTER-SW
 16062           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16063           IF PDEF-MASTER-FOUND
 16064              IF (ERPDEF-KEY-SAVE (1:16) =
 16065                           PD-CONTROL-PRIMARY (1:16))
 16066                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16067                 CONTINUE
 16068              ELSE
 16069                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16070                 IF (ERPDEF-KEY-SAVE (1:16) =
 16071                           PD-CONTROL-PRIMARY (1:16))
 16072                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16073                    CONTINUE
 16074                 ELSE
 16075                    MOVE ER-2740 TO WS-ERROR
 16076                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16077                    GO TO 3770-CHECK-REFUNDS
 16078                 END-IF
 16079              END-IF
 16080           END-IF
 16081           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16082        END-IF
 16083     END-IF
 16084     IF PDEF-MASTER-FOUND
 16085        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16086           (V1 > +8)
 16087           OR (PD-PROD-CODE (V1) = 'I')
 16088        END-PERFORM
 16089        IF V1 < +9
 16090           SET DD-IU-PRESENT        TO TRUE
 16091        END-IF
 16092        IF WS-AH-DCC-TRUNC = 'T'
 16093           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16094        ELSE
 16095           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 292
* EL050.cbl
 16096        END-IF
 16097        EVALUATE TRUE
 16098           WHEN WS-TERM > +168
 16099              MOVE 15               TO V1
 16100           WHEN WS-TERM > +156
 16101              MOVE 14               TO V1
 16102           WHEN WS-TERM > +144
 16103              MOVE 13               TO V1
 16104           WHEN WS-TERM > +132
 16105              MOVE 12               TO V1
 16106           WHEN WS-TERM > +120
 16107              MOVE 11               TO V1
 16108           WHEN WS-TERM > +108
 16109              MOVE 10               TO V1
 16110           WHEN WS-TERM > +96
 16111              MOVE 9                TO V1
 16112           WHEN WS-TERM > +84
 16113              MOVE 8                TO V1
 16114           WHEN WS-TERM > +72
 16115              MOVE 7                TO V1
 16116           WHEN WS-TERM > +60
 16117              MOVE 6                TO V1
 16118           WHEN WS-TERM > +48
 16119              MOVE 5                TO V1
 16120           WHEN WS-TERM > +36
 16121              MOVE 4                TO V1
 16122           WHEN WS-TERM > +24
 16123              MOVE 3                TO V1
 16124           WHEN WS-TERM > +12
 16125              MOVE 2                TO V1
 16126           WHEN OTHER
 16127              MOVE 1                TO V1
 16128        END-EVALUATE
 16129
 16130        EVALUATE TRUE
 16131*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16132*             < +13)
 16133*             AND (DD-IU-PRESENT)
 16134*             MOVE 2                TO V2
 16135*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16136*             MOVE 1                TO V2
 16137           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16138              MOVE 2                TO V2
 16139           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16140              MOVE 3                TO V2
 16141           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16142              MOVE 4                TO V2
 16143           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16144              MOVE 5                TO V2
 16145           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16146              MOVE 6                TO V2
 16147           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16148              MOVE 7                TO V2
 16149           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16150              MOVE 8                TO V2
 16151           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16152              MOVE 9                TO V2
 16153           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 293
* EL050.cbl
 16154              MOVE 10               TO V2
 16155           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16156              MOVE 11               TO V2
 16157           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16158              MOVE 12               TO V2
 16159           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16160              MOVE 13               TO V2
 16161           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16162              MOVE 14               TO V2
 16163           WHEN OTHER
 16164              MOVE 15               TO V2
 16165        END-EVALUATE
 16166
 16167        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16168                                 TO CP-DDF-LO-FACT
 16169        MOVE PD-UEP-FACTOR (V1 V2)
 16170                                 TO CP-DDF-HI-FACT
 16171
 16172        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16173        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16174        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16175           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16176        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16177        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16178        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16179           + PD-1ST-YR-ADMIN-ALLOW
 16180
 16181        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16182*       IF PI-CLP-YN = 'Y'
 16183*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16184*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16185*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16186*       END-IF
 16187
 16188        IF DD-IU-PRESENT
 16189           MOVE 'I'              TO CP-EARNING-METHOD
 16190        END-IF
 16191        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16192                                     CP-CLP-RATE-UP
 16193        IF CP-IU-RATE-UP NOT = ZEROS
 16194           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16195              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16196           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16197              / (1 - WS-WORK-FACT)
 16198        END-IF
 16199     END-IF
 16200     .
 16201 3750-CONTINUE.
 16202     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16203
 16204     IF CP-REFUND-TYPE-USED NOT = SPACE
 16205         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16206
 16207     IF CP-ERROR-RATE-IS-ZERO OR
 16208        CP-ERROR-RATE-NOT-FOUND
 16209        MOVE ER-2740             TO WS-ERROR
 16210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16211
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 294
* EL050.cbl
 16212     IF CP-ERROR-RATE-FILE-NOTOPEN
 16213        MOVE ER-2617             TO WS-ERROR
 16214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16215     IF PB-COMPANY-ID = 'DCC'
 16216        AND PB-CI-ENTRY-STATUS = 'M'
 16217        MOVE +0                  TO PB-C-AH-REF-CALC
 16218     ELSE
 16219        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16220     END-IF
 16221     IF PB-COMPANY-ID = 'DCC'
 16222        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16223        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16224        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16225        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16226        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16227        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16228        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16229        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16230        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16231     END-IF
 16232     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 295
* EL050.cbl
 16234
 16235 3770-CHECK-REFUNDS.
 16236
 16237     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16238        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16239           MOVE ER-2766          TO WS-ERROR
 16240           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16241           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16242           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16243              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16244
 16245     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16246        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16247           MOVE ER-2766          TO WS-ERROR
 16248           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16249           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16250           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16251              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16252
 16253     IF PB-COMP-LF-CANCEL
 16254        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16255        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16256           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16257              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16258
 16259     IF PB-COMP-AH-CANCEL
 16260        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16261        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16262           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16263              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16264
 16265     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16266             GIVING WS-UNSIGN-WRK1
 16267     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16268             GIVING WS-UNSIGN-WRK2.
 16269
 16270     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16271         MOVE ZERO TO WS-UNSIGN-WRK1.
 16272
 16273     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16274         MOVE ZERO TO WS-UNSIGN-WRK2.
 16275
 16276     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16277
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 296
* EL050.cbl
 16279
 16280 3772-CONTINUE.
 16281
 16282**********************************
 16283*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16284*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16285*** DOUBLES THE TOLERANCE AMOUNT.
 16286***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16287**********************************
 16288     IF PB-COMPANY-ID = 'MON'
 16289     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16290         IF WS-REF-REJECT-SW = SPACE
 16291             MOVE ER-2754        TO WS-ERROR
 16292             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16293           ELSE
 16294             MOVE ER-2736        TO WS-ERROR
 16295             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16296**********************************
 16297
 16298 3773-CONTINUE.
 16299
 16300     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16301        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16302           MOVE ER-2723          TO WS-ERROR
 16303           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16304
 16305     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16306        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16307           MOVE ER-2724          TO WS-ERROR
 16308           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16309
 16310     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16311         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16312             (1 + WS-LF-REFUND-OVS-PCT)
 16313     ELSE
 16314         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16315
 16316     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16317         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16318             (1 - WS-TOL-LF-REFUND-PCT)
 16319     ELSE
 16320         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16321
 16322     IF (PB-COMPANY-ID = 'DCC')
 16323        AND (PB-CI-ENTRY-STATUS = 'M')
 16324        AND (PB-C-LF-CANCEL-AMT > +0)
 16325        MOVE ER-3843             TO WS-ERROR
 16326        PERFORM 9900-ERROR-FORMAT
 16327                                 THRU 9900-EXIT
 16328     END-IF
 16329     EVALUATE TRUE
 16330        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16331           CONTINUE
 16332        WHEN PB-C-LF-CANCEL-AMT = +0
 16333                 AND PB-C-LF-REF-CALC > +0
 16334           CONTINUE
 16335        WHEN WS-LF-REFUND-OVS-AMT = 0
 16336                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 297
* EL050.cbl
 16337           CONTINUE
 16338        WHEN OTHER
 16339           IF WS-TOL-LF-REFUND  = +0
 16340              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16341           END-IF
 16342           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16343                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16344                          (PB-C-LF-CANCEL-AMT))
 16345              CONTINUE
 16346           ELSE
 16347              IF WS-LF-REFUND-OVS-AMT = +0
 16348                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16349              END-IF
 16350              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16351                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16352                                       PB-C-LF-CANCEL-AMT)
 16353                 CONTINUE
 16354              ELSE
 16355                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16356                   MOVE ER-2754   TO  WS-ERROR
 16357                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16358                 ELSE
 16359                    MOVE ER-2736   TO  WS-ERROR
 16360                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16361                 END-IF
 16362              END-IF
 16363           END-IF
 16364     END-EVALUATE.
 16365
 16366     EVALUATE TRUE
 16367        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16368           CONTINUE
 16369        WHEN PB-C-LF-CANCEL-AMT = +0
 16370                 AND PB-C-LF-REF-CALC > +0
 16371           CONTINUE
 16372        WHEN OTHER
 16373           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16374               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16375              CONTINUE
 16376           ELSE
 16377              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16378               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16379                CONTINUE
 16380              ELSE
 16381                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16382                     MOVE ER-2754   TO  WS-ERROR
 16383                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16384                 ELSE
 16385                     MOVE ER-2736   TO  WS-ERROR
 16386                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16387                 END-IF
 16388              END-IF
 16389           END-IF
 16390     END-EVALUATE.
 16391
 16392     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16393         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16394             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 298
* EL050.cbl
 16395     ELSE
 16396         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16397
 16398     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16399         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16400             (1 - WS-TOL-AH-REFUND-PCT)
 16401     ELSE
 16402         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16403
 16404     IF (PB-COMPANY-ID = 'DCC')
 16405        AND (PB-CI-ENTRY-STATUS = 'M')
 16406        AND (PB-C-AH-CANCEL-AMT > +0)
 16407        MOVE ER-3843             TO WS-ERROR
 16408        PERFORM 9900-ERROR-FORMAT
 16409                                 THRU 9900-EXIT
 16410     END-IF
 16411     EVALUATE TRUE
 16412        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16413           CONTINUE
 16414*       WHEN PB-C-AH-REF-CALC = +0 AND
 16415*                  PB-C-AH-CANCEL-AMT > +0
 16416        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16417                   PB-C-AH-REF-CALC > +0
 16418           CONTINUE
 16419        WHEN WS-AH-REFUND-OVS-AMT = +0
 16420                AND WS-TOL-AH-REFUND = +0
 16421           CONTINUE
 16422        WHEN OTHER
 16423           IF WS-TOL-AH-REFUND = +0
 16424              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16425           END-IF
 16426           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16427               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16428                                         PB-C-AH-CANCEL-AMT)
 16429              CONTINUE
 16430           ELSE
 16431              IF WS-AH-REFUND-OVS-AMT = +0
 16432                 MOVE +9999999.99 TO
 16433                         WS-AH-REFUND-OVS-AMT
 16434              END-IF
 16435              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16436                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16437                                         PB-C-AH-CANCEL-AMT)
 16438                 CONTINUE
 16439              ELSE
 16440                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16441                    MOVE ER-2754   TO  WS-ERROR
 16442                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16443                 ELSE
 16444                    MOVE ER-2736   TO  WS-ERROR
 16445                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16446                 END-IF
 16447              END-IF
 16448           END-IF
 16449     END-EVALUATE.
 16450
 16451     EVALUATE TRUE
 16452        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 299
* EL050.cbl
 16453           CONTINUE
 16454*       WHEN PB-C-AH-REF-CALC > +0 AND
 16455*                  PB-C-AH-CANCEL-AMT = +0
 16456        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16457                   PB-C-AH-REF-CALC = +0
 16458           CONTINUE
 16459        WHEN OTHER
 16460           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16461               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16462              CONTINUE
 16463           ELSE
 16464              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16465                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16466                 CONTINUE
 16467              ELSE
 16468                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16469                     MOVE ER-2754   TO  WS-ERROR
 16470                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16471                 ELSE
 16472                     MOVE ER-2736   TO  WS-ERROR
 16473                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16474                 END-IF
 16475              END-IF
 16476           END-IF
 16477     END-EVALUATE.
 16478
 16479     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16480        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16481        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16482           AND  PB-C-LF-REF-CALC < +1.00
 16483           AND  PB-C-AH-REF-CALC < +1.00
 16484           CONTINUE
 16485        ELSE
 16486           IF (PB-COMPANY-ID = 'DCC')
 16487              AND (PB-CI-ENTRY-STATUS = 'M')
 16488              CONTINUE
 16489           ELSE
 16490              MOVE ER-2741       TO WS-ERROR
 16491              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16492           END-IF
 16493        END-IF
 16494     END-IF
 16495
 16496     IF (PB-C-LF-CANCEL-AMT = ZERO
 16497        AND WS-LF-BENEFIT-CD NOT = ZERO
 16498        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16499        AND PB-C-LF-REF-CALC NOT = ZERO)
 16500        OR
 16501        (PB-C-LF-CANCEL-AMT = ZERO
 16502        AND WS-LF-BENEFIT-CD NOT = ZERO
 16503        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16504             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16505                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16506                NEXT SENTENCE
 16507             ELSE
 16508                MOVE ER-2739        TO WS-ERROR
 16509                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16510
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 300
* EL050.cbl
 16511     IF (PB-C-AH-CANCEL-AMT = ZERO
 16512        AND WS-AH-BENEFIT-CD NOT = ZERO
 16513        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16514        AND PB-C-AH-REF-CALC NOT = ZERO)
 16515        OR
 16516        (PB-C-AH-CANCEL-AMT = ZERO
 16517        AND WS-AH-BENEFIT-CD NOT = ZERO
 16518        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16519             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16520                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16521                NEXT SENTENCE
 16522             ELSE
 16523                MOVE ER-2738        TO WS-ERROR
 16524                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16525
 16526 3775-OVER-REF-CHK.
 16527
 16528     IF PB-CI-ENTRY-STATUS = '5'
 16529        GO TO 3780-UPDATE-CANCEL-CERT.
 16530
 16531     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16532                              PB-CI-LF-ALT-PREMIUM-AMT.
 16533
 16534     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16535        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16536                                 PB-C-LF-REF-CALC
 16537      ELSE
 16538        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16539                                 PB-C-LF-CANCEL-AMT.
 16540
 16541     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16542        MOVE ER-2755             TO WS-ERROR
 16543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16544
 16545     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16546
 16547     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16548        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16549                                 PB-C-AH-REF-CALC
 16550      ELSE
 16551        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16552                                 PB-C-AH-CANCEL-AMT.
 16553
 16554     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16555        MOVE ER-2778             TO WS-ERROR
 16556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16557
 16558     IF PB-CI-OB-FLAG NOT = 'Z'
 16559        NEXT SENTENCE
 16560       ELSE
 16561         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16562            MOVE ER-2757           TO WS-ERROR
 16563            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16564
 16565 3780-UPDATE-CANCEL-CERT.
 16566
 16567     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16568        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 301
* EL050.cbl
 16569        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16570
 16571     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16572         MOVE ER-2729              TO WS-ERROR
 16573         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16574
 16575     IF PB-CI-LF-BENEFIT-CD = ZERO
 16576         GO TO 3780-UPDATE-CONT-1.
 16577
 16578     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16579         GO TO 3780-UPDATE-CONT-1.
 16580
 16581     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16582       AND
 16583        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16584       AND
 16585        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16586       AND
 16587        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16588            NEXT SENTENCE
 16589       ELSE
 16590        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16591          AND
 16592***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16593***       AND
 16594           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16595            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16596               MOVE ER-2730      TO WS-ERROR
 16597               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16598               GO TO 3999-END-EDIT
 16599            ELSE
 16600               GO TO 3999-END-EDIT
 16601        ELSE
 16602            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16603               MOVE ER-2765           TO WS-ERROR
 16604               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16605               GO TO 3785-CHECK-NH.
 16606*              GO TO 3999-END-EDIT.
 16607
 16608 3780-UPDATE-CONT-1.
 16609     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16610
 16611     IF PB-CI-AH-BENEFIT-CD = ZERO
 16612         GO TO 3780-UPDATE-CONT-2.
 16613
 16614     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16615         GO TO 3780-UPDATE-CONT-2.
 16616
 16617     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16618
 16619     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16620       AND
 16621        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16622       AND
 16623        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16624       AND
 16625        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16626            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 302
* EL050.cbl
 16627       ELSE
 16628        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16629          AND
 16630***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16631***       AND
 16632           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16633           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16634            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16635               MOVE ER-2773      TO WS-ERROR
 16636               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16637               GO TO 3999-END-EDIT
 16638            ELSE
 16639               GO TO 3999-END-EDIT
 16640            END-IF
 16641           ELSE
 16642             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16643                MOVE ER-2890 TO WS-ERROR
 16644                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16645                GO TO 3999-END-EDIT
 16646             ELSE
 16647                GO TO 3785-CHECK-NH
 16648             END-IF
 16649           END-IF
 16650          ELSE
 16651            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16652              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16653                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16654                   MOVE ER-2890 TO WS-ERROR
 16655                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16656                   GO TO 3999-END-EDIT
 16657                ELSE
 16658                   MOVE ER-2765 TO WS-ERROR
 16659                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16660                   GO TO 3785-CHECK-NH
 16661                END-IF
 16662              ELSE
 16663               MOVE ER-2765      TO WS-ERROR
 16664               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16665               GO TO 3785-CHECK-NH.
 16666*              GO TO 3999-END-EDIT.
 16667
 16668 3780-UPDATE-CONT-2.
 16669
 16670     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16671        AND WS-LF-BENEFIT-CD = ZERO
 16672           MOVE ER-2743           TO WS-ERROR
 16673           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16674
 16675     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16676        AND WS-AH-BENEFIT-CD = ZERO
 16677           MOVE ER-2744           TO WS-ERROR
 16678           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16679
 16680     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16681        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16682        AND
 16683        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16684         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 303
* EL050.cbl
 16685           MOVE ER-2746           TO WS-ERROR
 16686           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16687
 16688     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16689       AND
 16690        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16691             MOVE ER-2737        TO WS-ERROR
 16692             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16693
 16694     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16695       AND
 16696        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16697             MOVE ER-2737        TO WS-ERROR
 16698             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16699
 16700     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16701         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16702             OR 'CID' OR 'DCC' OR 'AHL'
 16703             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16704         ELSE
 16705             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16706                 MOVE ER-2768    TO WS-ERROR
 16707                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16708             ELSE
 16709                 MOVE ER-2756    TO WS-ERROR
 16710                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16711
 16712     IF CERT-PEND-ISSUE-RETURNED
 16713        MOVE ER-2772             TO WS-ERROR
 16714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16715 3785-CHECK-NH.
 16716     IF PB-STATE NOT = 'NH'
 16717        GO TO 3999-END-EDIT
 16718     END-IF
 16719
 16720     MOVE ER-2796                TO WS-ERROR
 16721     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16722     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16723        OR (CM-NH-INTERFACE-SW = 'Y')
 16724        MOVE ER-2793             TO WS-ERROR
 16725        PERFORM 9900-ERROR-FORMAT
 16726                                 THRU 9900-EXIT
 16727     END-IF
 16728     MOVE +0                     TO WS-PAYMENT-AMT
 16729     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16730        GO TO 3999-END-EDIT
 16731     END-IF
 16732     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16733        GO TO 3999-END-EDIT
 16734     END-IF
 16735     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16736     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16737     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16738        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16739     END-IF
 16740     MOVE '1'                    TO DC-OPTION-CODE
 16741     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16742     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 304
* EL050.cbl
 16743        IF DC-ELAPSED-DAYS < +16
 16744           GO TO 3999-END-EDIT
 16745        END-IF
 16746     END-IF
 16747     MOVE +0                     TO DC-ELAPSED-DAYS
 16748     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16749     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16750     MOVE '1'                    TO DC-OPTION-CODE
 16751     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16752     IF NO-CONVERSION-ERROR
 16753        IF DC-ELAPSED-DAYS > +30
 16754           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16755        ELSE
 16756           GO TO 3999-END-EDIT
 16757        END-IF
 16758     ELSE
 16759        GO TO 3999-END-EDIT
 16760     END-IF
 16761     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16762        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16763           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16764     IF WS-PAYMENT-AMT < 600.00
 16765        GO TO 3999-END-EDIT
 16766     END-IF
 16767     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16768
 16769     IF (ERMAIL-FOUND = ' ')
 16770         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16771         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16772        GO TO 3999-END-EDIT
 16773     END-IF
 16774     MOVE ER-2795                TO WS-ERROR
 16775     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16776
 16777     GO TO 3999-END-EDIT.
 16778******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 305
* EL050.cbl
 16780 3990-FILES-NOT-OPEN.
 16781
 16782     MOVE ER-2617                TO WS-ERROR.
 16783     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16784     GO TO 9990-RETURN.
 16785
 16786 3999-END-EDIT.
 16787
 16788     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16789
 16790     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16791         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16792         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16793             PERFORM 9250-UNLOCK-RETURN
 16794             GO TO 9990-RETURN
 16795          ELSE
 16796             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16797             GO TO 9990-RETURN.
 16798
 16799     IF PB-CANCELLATION
 16800          GO TO 9990-RETURN.
 16801
 16802     IF CERT-WAS-NOT-FOUND
 16803        MOVE SPACES              TO CERTIFICATE-MASTER.
 16804
 16805     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16806
 16807     IF CERT-WAS-FOUND
 16808         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16809             PERFORM 9250-UNLOCK-RETURN
 16810          ELSE
 16811            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16812      ELSE
 16813         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16814
 16815     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16816        IF PB-COMPANY-ID = 'DCC' AND
 16817           (PB-CARRIER = '2' OR '4' OR '6')
 16818              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16819        END-IF
 16820     END-IF.
 16821
 16822     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16823         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16824     END-IF.
 16825
 16826     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16827     IF ((PB-COMPANY-ID = 'DCC')
 16828        AND (WS-NO-SECURE-PAY))
 16829                  OR
 16830        (WS-LF-SPECIAL-CALC-CD = 'O'
 16831        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16832        SET SKIP-ADDR-EDIT       TO TRUE
 16833     END-IF
 16834     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16835        AND (NOT SKIP-ADDR-EDIT)
 16836        MOVE ER-2963             TO WS-ERROR
 16837        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 306
* EL050.cbl
 16838                                 THRU 9900-EXIT
 16839        GO TO 9990-RETURN
 16840     END-IF
 16841     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16842     IF ERPNDM-FOUND NOT = 'X'
 16843        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16844           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16845           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16846           AND (NOT SKIP-ADDR-EDIT)
 16847           MOVE ER-2694          TO WS-ERROR
 16848           PERFORM 9900-ERROR-FORMAT
 16849                                 THRU 9900-EXIT
 16850        END-IF
 16851        MOVE ' '                 TO STATE-RECORD-ERROR
 16852        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16853        MOVE PM-STATE            TO CNTL-ACCESS
 16854        MOVE '3'                 TO CNTL-REC-TYPE
 16855        MOVE +0                  TO CNTL-SEQ-NO
 16856        MOVE '0'                 TO RC-SW-2
 16857        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16858        IF (NO-STATE-RECORD)
 16859           OR (CF-RECORD-TYPE NOT = '3')
 16860           OR (PM-STATE NOT = CF-STATE-CODE)
 16861           IF (PM-STATE = SPACES)
 16862              AND (SKIP-ADDR-EDIT)
 16863              CONTINUE
 16864           ELSE
 16865              MOVE ER-2963       TO WS-ERROR
 16866              PERFORM 9900-ERROR-FORMAT
 16867                                 THRU 9900-EXIT
 16868           END-IF
 16869        END-IF
 16870        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16871           MOVE ER-2883          TO WS-ERROR
 16872           PERFORM 9900-ERROR-FORMAT
 16873                                 THRU 9900-EXIT
 16874        END-IF
 16875        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16876           MOVE ' '                 TO STATE-RECORD-ERROR
 16877           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16878           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16879           MOVE '3'                 TO CNTL-REC-TYPE
 16880           MOVE +0                  TO CNTL-SEQ-NO
 16881           MOVE '0'                 TO RC-SW-2
 16882           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16883           IF NO-STATE-RECORD
 16884              OR (CF-RECORD-TYPE NOT = '3')
 16885              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16886              MOVE ER-2964          TO WS-ERROR
 16887              PERFORM 9900-ERROR-FORMAT
 16888                                    THRU 9900-EXIT
 16889           END-IF
 16890        END-IF
 16891     ELSE
 16892        IF NOT SKIP-ADDR-EDIT
 16893           MOVE ER-2393          TO WS-ERROR
 16894           PERFORM 9900-ERROR-FORMAT
 16895                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 307
* EL050.cbl
 16896        END-IF
 16897     END-IF
 16898
 16899     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16900
 16901     IF (ERMAIL-FOUND = ' ' AND
 16902        ERPNDM-FOUND = ' ')
 16903        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16904           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16905           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16906          OR
 16907           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16908          OR
 16909           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16910           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16911           GO TO 3999-UNLOCK-ERMAIL.
 16912
 16913     IF ERPNDM-FOUND = 'X'
 16914        GO TO 3999-UNLOCK-ERMAIL.
 16915
 16916     IF PM-INSURED-LAST-NAME      = SPACES
 16917        AND PM-INSURED-FIRST-NAME = SPACES
 16918        AND PM-ADDRESS-LINE-1     = SPACES
 16919        AND PM-ADDRESS-LINE-2     = SPACES
 16920        AND PM-CITY-STATE         = SPACES
 16921        AND PM-CRED-BENE-NAME     = SPACES
 16922        AND PM-CRED-BENE-ADDR     = SPACES
 16923        AND PM-CRED-BENE-CTYST    = SPACES
 16924        GO TO 3999-UNLOCK-ERMAIL
 16925     END-IF
 16926
 16927     MOVE SPACES                 TO MAILING-DATA.
 16928
 16929     MOVE 'MA'                   TO MA-RECORD-ID.
 16930     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16931     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16932     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16933     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16934     MOVE PB-SV-STATE            TO MA-STATE.
 16935     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16936     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16937
 16938     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16939     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16940
 16941     IF ERMAIL-FOUND = ' '
 16942        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16943     ELSE
 16944        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16945        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16946        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16947
 16948     GO TO 9990-RETURN.
 16949
 16950 3999-UNLOCK-ERMAIL.
 16951     IF ERMAIL-FOUND = ' '
 16952        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16953
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 308
* EL050.cbl
 16954     GO TO 9990-RETURN.
 16955******************************************************************
 16956
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 309
* EL050.cbl
 16958 4000-UPDATE-CANCELLED-CERT.
 16959     IF CERT-WAS-NOT-FOUND
 16960        GO TO 4299-EXIT.
 16961
 16962*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16963     IF PB-C-NH-INT-ON-REFS > ZEROS
 16964        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16965     END-IF
 16966     IF PB-C-REF-INTERFACE-SW = 'Y'
 16967        MOVE PB-C-REF-INTERFACE-SW
 16968                                 TO CM-NH-INTERFACE-SW
 16969     END-IF
 16970     IF PB-C-POST-CARD-IND = 'Y'
 16971        MOVE +8                  TO SUB
 16972        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16973        IF ERMAIL-FOUND = ' '
 16974           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16975              (SUB > +7)
 16976              OR (MA-MAIL-STATUS (SUB) = '1')
 16977           END-PERFORM
 16978        END-IF
 16979        IF (SUB > +7)
 16980           OR (ERMAIL-FOUND = 'X')
 16981           MOVE ER-3789          TO WS-ERROR
 16982           PERFORM 9900-ERROR-FORMAT
 16983                                 THRU 9900-EXIT
 16984        END-IF
 16985     ELSE
 16986        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16987     END-IF
 16988     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16989
 16990     IF PB-CI-OB-FLAG = 'Z'
 16991        GO TO 4150-SUMMARY-CERT-CANCEL.
 16992
 16993     IF PB-C-LF-CANCEL-VOIDED
 16994         PERFORM 4200-REVERSE-LF-CANCEL.
 16995     IF PB-C-AH-CANCEL-VOIDED
 16996         PERFORM 4200-REVERSE-AH-CANCEL.
 16997
 16998 4100-APPLY-LF-CANCEL.
 16999
 17000     MOVE +0                     TO WS-SUB.
 17001
 17002 4100-CHECK-LF-ERRORS.
 17003
 17004     ADD +1                       TO WS-SUB.
 17005
 17006     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17007        IF LF-COVERAGE-CANCELLED
 17008           GO TO 4100-LF-CANCEL-CONT
 17009        ELSE
 17010           GO TO 4100-UPDATE-LF-COVERAGE.
 17011
 17012     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17013                                   ER-2729 OR
 17014                                   ER-2730 OR
 17015                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 310
* EL050.cbl
 17016                                   ER-2732 OR
 17017                                   ER-2737 OR
 17018                                   ER-2740 OR
 17019                                   ER-2743 OR
 17020                                   ER-2749 OR
 17021                                   ER-2750 OR
 17022                                   ER-2755 OR
 17023                                   ER-2757 OR
 17024                                   ER-2760 OR
 17025                                   ER-2772 OR
 17026                                   ER-2774 OR
 17027                                   ER-2776 OR
 17028                                   ER-2794
 17029        GO TO 4100-UPDATE-LF-COVERAGE.
 17030
 17031     GO TO 4100-CHECK-LF-ERRORS.
 17032
 17033 4100-UPDATE-LF-COVERAGE.
 17034
 17035     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17036     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17037     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17038        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17039     END-IF
 17040     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17041                                      TO CM-CREDIT-INTERFACE-SW-2.
 17042     IF CM-LF-CANCEL-DT = LOW-VALUE
 17043         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17044
 17045     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17046         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17047                                         CM-LF-STATUS-AT-CANCEL.
 17048
 17049     GO TO 4100-APPLY-AH-CANCEL.
 17050
 17051 4100-LF-CANCEL-CONT.
 17052     IF PB-C-LF-CANCEL-VOIDED
 17053         GO TO 4100-APPLY-AH-CANCEL.
 17054
 17055     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17056         GO TO 4100-APPLY-AH-CANCEL.
 17057
 17058     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17059        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17060           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17061        ELSE
 17062           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17063
 17064     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17065     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17066
 17067     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17068         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17069
 17070     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17071        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17072         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17073         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 311
* EL050.cbl
 17074
 17075     IF PB-RECORD-RETURNED
 17076        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17077      ELSE
 17078        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17079
 17080 4100-APPLY-AH-CANCEL.
 17081
 17082     MOVE +0                      TO WS-SUB.
 17083
 17084 4100-CHECK-AH-ERRORS.
 17085
 17086     ADD +1                       TO WS-SUB.
 17087
 17088     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17089        IF AH-COVERAGE-CANCELLED
 17090           GO TO 4100-AH-CANCEL-CONT
 17091        ELSE
 17092           GO TO 4100-UPDATE-AH-COVERAGE.
 17093
 17094     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17095                                   ER-2729 OR
 17096                                   ER-2732 OR
 17097                                   ER-2737 OR
 17098                                   ER-2740 OR
 17099                                   ER-2744 OR
 17100                                   ER-2749 OR
 17101                                   ER-2750 OR
 17102                                   ER-2755 OR
 17103                                   ER-2757 OR
 17104                                   ER-2760 OR
 17105                                   ER-2771 OR
 17106                                   ER-2772 OR
 17107                                   ER-2773 OR
 17108                                   ER-2775 OR
 17109                                   ER-2777 OR
 17110                                   ER-2794
 17111        GO TO 4100-UPDATE-AH-COVERAGE.
 17112
 17113     GO TO 4100-CHECK-AH-ERRORS.
 17114
 17115 4100-UPDATE-AH-COVERAGE.
 17116
 17117     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17118     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17119     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17120     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17121                                      TO CM-CREDIT-INTERFACE-SW-2.
 17122     IF CM-AH-CANCEL-DT = LOW-VALUE
 17123         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17124
 17125     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17126         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17127                                         CM-AH-STATUS-AT-CANCEL.
 17128
 17129     IF LF-COVERAGE-CANCELLED
 17130         IF PB-RECORD-RETURNED
 17131              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 312
* EL050.cbl
 17132          ELSE
 17133              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17134
 17135     GO TO 4299-EXIT.
 17136
 17137 4100-AH-CANCEL-CONT.
 17138     IF PB-C-AH-CANCEL-VOIDED
 17139         GO TO 4299-EXIT.
 17140
 17141     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17142         GO TO 4299-EXIT.
 17143
 17144     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17145        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17146           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17147        ELSE
 17148           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17149
 17150     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17151     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17152
 17153     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17154         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17155
 17156     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17157         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17158         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17159
 17160     IF PB-RECORD-RETURNED
 17161        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17162      ELSE
 17163        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17164
 17165     GO TO 4299-EXIT.
 17166
 17167 4150-SUMMARY-CERT-CANCEL.
 17168     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17169
 17170     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17171        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17172                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17173     ELSE
 17174        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17175                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17176
 17177     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17178        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17179                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17180     ELSE
 17181        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17182                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17183
 17184     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17185        NEXT SENTENCE
 17186     ELSE
 17187        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17188
 17189     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 313
* EL050.cbl
 17190
 17191 4200-REVERSE-LF-CANCEL.
 17192     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17193
 17194     IF CM-LF-CANCEL-APPLIED
 17195        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17196        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17197        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17198
 17199     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17200
 17201     IF PB-RECORD-RETURNED
 17202        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17203       ELSE
 17204        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17205
 17206 4200-REVERSE-LF-EXIT.
 17207       EXIT.
 17208
 17209 4200-REVERSE-AH-CANCEL.
 17210     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17211
 17212     IF CM-AH-CANCEL-APPLIED
 17213        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17214        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17215        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17216
 17217     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17218
 17219     IF PB-RECORD-RETURNED
 17220        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17221       ELSE
 17222        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17223
 17224 4200-REVERSE-AH-EXIT.
 17225       EXIT.
 17226
 17227 4299-EXIT.
 17228       EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 314
* EL050.cbl
 17230
 17231 4500-UPDATE-NEW-CERT.
 17232     IF CERT-WAS-FOUND
 17233         NEXT SENTENCE
 17234       ELSE
 17235         GO TO 4520-BUILD-NEW-KEY.
 17236
 17237     IF  CLASIC-CREATED-CERT
 17238         GO TO 4999-EXIT.
 17239
 17240     IF  CERT-WAS-CREATED-FOR-CLAIM
 17241         GO TO 4520-BUILD-NEW-KEY.
 17242
 17243     IF CERT-ADDED-BATCH
 17244        IF CM-RECORD-ID = 'CM'
 17245            GO TO 4999-EXIT.
 17246
 17247 4520-BUILD-NEW-KEY.
 17248* BUILD CONTROL PRIMARY
 17249
 17250     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17251                                       CM-COMPANY-CD-A1
 17252                                       CM-COMPANY-CD-A2
 17253                                       CM-COMPANY-CD-A4
 17254                                       CM-COMPANY-CD-A5.
 17255
 17256     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17257     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17258     MOVE PB-SV-STATE               TO CM-STATE.
 17259     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17260     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17261     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17262     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17263
 17264     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17265
 17266     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17267     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17268     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17269     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17270
 17271     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17272        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17273
 17274     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17275         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17276         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17277         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17278         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17279     ELSE
 17280         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17281
 17282     IF PB-COMPANY-ID   EQUAL  'CRI'
 17283         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17284         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17285         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17286         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17287         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 315
* EL050.cbl
 17288
 17289     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17290        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17291         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17292
 17293     IF PB-COMPANY-ID  = 'LBL'
 17294        IF PB-I-JOINT-COVERAGE
 17295            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17296                                           PB-I-MEMBER-NO
 17297            GO TO 4550-CONT-CERT-PROCESS.
 17298
 17299     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17300        NEXT SENTENCE
 17301     ELSE
 17302        GO TO 4540-BUILD-MEMBER-NO.
 17303
 17304******************************************************************
 17305*                                                                *
 17306*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17307*    FOR 'MON'.                                                  *
 17308*                                                                *
 17309******************************************************************
 17310
 17311     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17312     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17313     MOVE +1                     TO WS-SUB1
 17314                                    WS-SUB2.
 17315
 17316 4530-EDIT-MEMB-NAME.
 17317
 17318     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17319        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17320        ADD +1                       TO WS-SUB2.
 17321
 17322     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17323        ADD +1                       TO WS-SUB1
 17324        GO TO 4530-EDIT-MEMB-NAME.
 17325
 17326     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17327     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17328     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17329*    MOVE SPACE                      TO DC-OPTION-CODE.
 17330     SET  BIN-TO-GREG                TO TRUE.
 17331     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17332     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17333
 17334     GO TO 4550-CONT-CERT-PROCESS.
 17335
 17336******************************************************************
 17337*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17338******************************************************************
 17339
 17340 4540-BUILD-MEMBER-NO.
 17341
 17342     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17343         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17344         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17345         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 316
* EL050.cbl
 17346         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17347     ELSE
 17348         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17349
 17350     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17351        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17352         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17353
 17354 4550-CONT-CERT-PROCESS.
 17355
 17356*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17357*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17358*    ELSE
 17359*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17360
 17361     IF CERT-WAS-CREATED-FOR-CLAIM
 17362        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17363        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17364
 17365     IF CERT-AND-CLAIM-ONLINE
 17366        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17367        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17368
 17369     MOVE 'CM'                     TO CM-RECORD-ID.
 17370     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17371
 17372     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17373        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17374        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17375     ELSE
 17376        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17377        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17378
 17379     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17380     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17381     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17382     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17383     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17384     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17385     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17386                                      CM-LF-ITD-CANCEL-AMT
 17387                                      CM-LF-ITD-DEATH-AMT
 17388                                      CM-AH-ITD-AH-PMT
 17389                                      CM-AH-ITD-LUMP-PMT
 17390                                      CM-AH-ITD-CANCEL-AMT
 17391                                      CM-LF-NSP-PREMIUM-AMT
 17392                                      CM-AH-NSP-PREMIUM-AMT.
 17393*                                     CM-CLAIM-DEDUCT-WITHHELD
 17394*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17395     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17396     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17397     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17398     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17399     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17400     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17401     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17402     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17403     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 317
* EL050.cbl
 17404     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17405     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17406     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17407
 17408     IF PB-I-LIVES NOT NUMERIC
 17409         MOVE ZERO                 TO PB-I-LIVES.
 17410
 17411     IF PB-I-NUM-BILLED NOT NUMERIC
 17412         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17413
 17414     MOVE PB-I-LIVES               TO CM-LIVES.
 17415     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17416
 17417     IF PB-COMPANY-ID EQUAL  'DMD'
 17418         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17419         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17420
 17421     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17422     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17423     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17424     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17425     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17426     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17427
 17428     IF PB-I-LF-POLICY-FEE NUMERIC
 17429        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17430     ELSE
 17431        MOVE +0                    TO CM-LF-POLICY-FEE.
 17432
 17433     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17434        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17435        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17436     ELSE
 17437        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17438
 17439     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17440     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17441     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17442     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17443     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17444     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17445     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17446     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17447     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17448
 17449     IF PB-I-AH-POLICY-FEE NUMERIC
 17450        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17451     ELSE
 17452        MOVE +0                    TO CM-AH-POLICY-FEE.
 17453
 17454     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17455        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17456     ELSE
 17457        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17458
 17459     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17460     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17461
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 318
* EL050.cbl
 17462     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17463                                      CM-LF-DEATH-EXIT-DT
 17464                                      CM-AH-SETTLEMENT-EXIT-DT.
 17465
 17466*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17467*                       'TIH' OR 'OFL' OR 'FLA' OR
 17468*                       'TII' OR 'TMS' OR 'CRI' OR
 17469*                       'NCL'
 17470     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17471
 17472     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17473         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17474            MOVE '2'                TO CM-PREMIUM-TYPE.
 17475
 17476     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17477         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17478            MOVE '2'                TO CM-PREMIUM-TYPE.
 17479
 17480     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17481         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17482     ELSE
 17483         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17484         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17485
 17486     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17487     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17488     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17489     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17490     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17491     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17492     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17493     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17494
 17495     IF PB-NO-MONTHS-SKIPPED
 17496         MOVE SPACE                 TO CM-SKIP-CODE
 17497     ELSE
 17498         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17499
 17500     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17501     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17502                                       CM-LF-STATUS-AT-CANCEL.
 17503
 17504     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17505     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17506                                       CM-AH-STATUS-AT-CANCEL.
 17507
 17508     MOVE '1'                       TO CM-ENTRY-STATUS.
 17509
 17510     IF PB-REISSUED-CERT
 17511        MOVE '5'                    TO CM-ENTRY-STATUS.
 17512
 17513     IF PB-MONTHLY-CERT
 17514        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17515
 17516     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17517     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17518     IF PB-POLICY-IS-DECLINED
 17519        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 319
* EL050.cbl
 17520
 17521     IF PB-POLICY-IS-VOIDED
 17522        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17523
 17524     IF PB-NEEDS-UNDERWRITING
 17525        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17526
 17527     IF PB-REIN-ONLY-CERT
 17528        MOVE '9'                    TO CM-ENTRY-STATUS.
 17529
 17530     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17531         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17532     ELSE
 17533         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17534
 17535     IF PB-RECORD-RETURNED
 17536        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17537      ELSE
 17538        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17539
 17540     IF PB-I-MAIL-ADDRS-PRESENT
 17541        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17542
 17543     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17544                                       CM-ENTRY-DT.
 17545
 17546 4999-EXIT.
 17547     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 320
* EL050.cbl
 17549
 17550 5000-PROCESS-REPS.
 17551     MOVE ' '                    TO AGTC-MASTER-SW
 17552     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17553     MOVE CO-TYPE                TO AGTC-TYPE
 17554     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17555     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17556     IF (AGTC-MASTER-SW NOT = 'N')
 17557        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17558        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17559        PERFORM 8583-READ-ERAGTC-NEXT
 17560                                 THRU 8583-EXIT
 17561     END-IF
 17562     IF AGTC-MASTER-SW = 'N'
 17563        CONTINUE
 17564     ELSE
 17565        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17566           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17567              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17568              MOVE 'Y'           TO AGTC-MASTER-SW
 17569           END-IF
 17570        END-IF
 17571     END-IF
 17572     .
 17573 5000-EXIT.
 17574     EXIT.
 17575 6370-EDIT-INPUT-LF-CODE.
 17576     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17577        MOVE +1                  TO SUB
 17578        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17579        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17580        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17581        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17582        GO TO 6370-SEARCH-LOOP.
 17583
 17584     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17585
 17586     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17587     MOVE SPACES                 TO CNTL-ACCESS.
 17588*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17589     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17590     MOVE +0                     TO CNTL-SEQ-NO.
 17591     MOVE '4' TO RC-SW-2.
 17592     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17593
 17594     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17595        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17596        GO TO 6370-NO-LF-FOUND.
 17597
 17598     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17599     MOVE +1                     TO SUB.
 17600
 17601 6370-SEARCH-LOOP.
 17602     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17603         GO TO 6370-NO-LF-FOUND.
 17604
 17605     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17606         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 321
* EL050.cbl
 17607         GO TO 6370-HER-NET-PAY-CHECK.
 17608
 17609     ADD 1   TO SUB.
 17610*    IF SUB GREATER 120
 17611     IF SUB GREATER 200
 17612         GO TO 6370-NO-LF-FOUND.
 17613
 17614     GO TO 6370-SEARCH-LOOP.
 17615
 17616 6370-NO-LF-FOUND.
 17617
 17618     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17619
 17620 6370-HER-NET-PAY-CHECK.
 17621
 17622     IF PB-COMPANY-ID = 'CID'
 17623        IF PB-SV-STATE = 'CA' OR 'MN'
 17624           IF PB-I-LF-BENEFIT-CD = '02'
 17625              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17626           ELSE
 17627              IF PB-I-LF-BENEFIT-CD = '04'
 17628                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17629              END-IF
 17630           END-IF
 17631        END-IF
 17632     END-IF
 17633
 17634     IF PB-COMPANY-ID NOT = 'HER'
 17635         GO TO 6370-EXIT.
 17636
 17637     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17638         GO TO 6370-EXIT.
 17639
 17640     IF PB-I-LF-TERM NOT NUMERIC
 17641         MOVE ZEROS              TO PB-I-LF-TERM.
 17642
 17643     IF PB-I-LOAN-TERM NOT NUMERIC
 17644         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17645
 17646     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17647         GO TO 6370-EXIT.
 17648
 17649     IF PB-I-LF-BENEFIT-CD = '33'
 17650         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17651
 17652     IF PB-I-LF-BENEFIT-CD = '34'
 17653         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17654
 17655 6370-EXIT.
 17656     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 322
* EL050.cbl
 17658
 17659 6380-EDIT-INPUT-AH-CODE.
 17660     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17661        MOVE +1                  TO SUB
 17662        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17663        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17664        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17665        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17666        GO TO 6380-SEARCH-LOOP.
 17667
 17668     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17669
 17670     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17671     MOVE SPACES                 TO CNTL-ACCESS.
 17672     MOVE 'A'                    TO CNTL-REC-TYPE.
 17673*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17674     MOVE +0                     TO CNTL-SEQ-NO.
 17675     MOVE '5' TO RC-SW-2.
 17676     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17677
 17678     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17679        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17680        GO TO 6380-NO-AH-FOUND.
 17681
 17682     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17683     MOVE +1 TO SUB.
 17684
 17685 6380-SEARCH-LOOP.
 17686     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17687         GO TO 6380-NO-AH-FOUND.
 17688
 17689     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17690         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17691         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17692
 17693     ADD 1   TO SUB.
 17694     IF SUB GREATER THAN 96
 17695*    IF SUB GREATER THAN 300
 17696         GO TO 6380-NO-AH-FOUND.
 17697
 17698     GO TO 6380-SEARCH-LOOP.
 17699
 17700 6380-NO-AH-FOUND.
 17701
 17702     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17703
 17704     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17705         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17706     ELSE
 17707         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17708
 17709 6380-CSO-AH-ONLY-CHECKS.
 17710
 17711     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17712        NEXT SENTENCE
 17713      ELSE
 17714        GO TO 6380-EXIT.
 17715
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 323
* EL050.cbl
 17716     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17717         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17718
 17719
 17720     GO TO 6380-EXIT
 17721     .
 17722 6380-CSO-LIFE-WITH-AH-CHECKS.
 17723
 17724
 17725     .
 17726 6380-EXIT.
 17727     EXIT.
 17728
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 324
* EL050.cbl
 17730
 17731 6400-COMPUTE-EXTENSION-DAYS.
 17732
 17733******************************************************************
 17734*                                                                *
 17735*                   COMPUTE EXTENSION DAYS                       *
 17736*                                                                *
 17737*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17738*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17739*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17740*    THE EXTENSION DAYS.                                         *
 17741*                                                                *
 17742******************************************************************
 17743
 17744     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17745     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17746
 17747******************************************************************
 17748*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17749*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17750******************************************************************
 17751
 17752     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17753        COMPUTE WS-ODD-DAYS-OVER =
 17754               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17755     ELSE
 17756        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17757
 17758     IF WS-ODD-DAYS-OVER = ZEROS
 17759           GO TO 6499-EXIT
 17760     ELSE
 17761        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17762           IF WS-WDF-MONTH = 02
 17763              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17764              ADD 2       TO  WS-ODD-DAYS-OVER
 17765              GO TO 6499-EXIT
 17766           ELSE
 17767              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17768                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17769                 GO TO 6499-EXIT
 17770               ELSE
 17771                 GO TO 6499-EXIT
 17772        ELSE
 17773           GO TO 6499-EXIT.
 17774
 17775 6412-CHECK-TO-DAY.
 17776
 17777        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17778           IF WS-WDT-DAY = 28
 17779              ADD 2              TO WS-ODD-DAYS-OVER
 17780           ELSE
 17781              IF WS-WDT-DAY = 29
 17782                 ADD 1           TO WS-ODD-DAYS-OVER
 17783              ELSE
 17784                 NEXT SENTENCE
 17785        ELSE
 17786           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17787              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 325
* EL050.cbl
 17788
 17789     GO TO 6499-EXIT.
 17790
 17791
 17792 6415-CHECK-LEAP-YEAR.
 17793
 17794     IF DC-DAYS-IN-MONTH = 29
 17795        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17796
 17797 6415-EXIT.
 17798     EXIT.
 17799
 17800 6499-EXIT.
 17801      EXIT.
 17802
 17803 6500-END.
 17804     EXIT.
 17805
 17806
 17807******************************************************************
 17808************* PROCEDURE DIVISION FOR EL050 ***********************
 17809********************** ELC50PD END *******************************
 17810
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 326
* EL050.cbl
 17812
 17813**START***********************************************************
 17814*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17815*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17816******************************************************************
 17817*
 17818 6600-GET-STATE-MUNICIPAL-TAX.
 17819
 17820     IF PB-COMPANY-ID NOT = 'DMD'
 17821         GO TO 6640-EXIT.
 17822
 17823     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17824     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17825     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17826*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17827*
 17828***  Y2K PROJ 7744
 17829     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17830     SET BIN-TO-GREG          TO TRUE.
 17831     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17832
 17833     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17834
 17835     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17836     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17837
 17838
 17839* EXEC CICS HANDLE CONDITION
 17840*        INVREQ    (6610-START-BROWSE)
 17841*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17842*        NOTFND    (6630-END-OF-FILE)
 17843*    END-EXEC.
 17844*    MOVE '"$8JI                 ! # #00017826' TO DFHEIV0
 17845     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17847     MOVE X'2320233030303137383236' TO DFHEIV0(25:11)
 17848     CALL 'kxdfhei1' USING DFHEIV0
 17849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17850
 17851
 17852 6610-START-BROWSE.
 17853
 17854
 17855* EXEC CICS HANDLE CONDITION
 17856*        NOTFND    (6630-END-OF-FILE)
 17857*        DISABLED  (6630-ERRESS-PROBLEM)
 17858*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17859*        ENDFILE   (6630-END-OF-FILE)
 17860*    END-EXEC.
 17861*    MOVE '"$IcJ''                ! $ #00017834' TO DFHEIV0
 17862     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17864     MOVE X'2420233030303137383334' TO DFHEIV0(25:11)
 17865     CALL 'kxdfhei1' USING DFHEIV0
 17866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17867
 17868
 17869
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 327
* EL050.cbl
 17870* EXEC CICS STARTBR
 17871*        DATASET (FILE-ID-ERRESS)
 17872*        RIDFLD  (WS-ERRESS-KEY)
 17873*        GTEQ
 17874*    END-EXEC.
 17875     MOVE 0
 17876       TO DFHEIV11
 17877*    MOVE '&,         G          &   #00017841' TO DFHEIV0
 17878     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17879     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17880     MOVE X'2020233030303137383431' TO DFHEIV0(25:11)
 17881     CALL 'kxdfhei1' USING DFHEIV0,
 17882           FILE-ID-ERRESS,
 17883           WS-ERRESS-KEY,
 17884           DFHEIV99,
 17885           DFHEIV11,
 17886           DFHEIV99
 17887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17888
 17889
 17890 6620-READ-NEXT-ERRESS-MASTER.
 17891
 17892
 17893* EXEC CICS HANDLE CONDITION
 17894*        NOTFND    (6630-END-OF-FILE)
 17895*        ENDFILE   (6630-END-OF-FILE)
 17896*        DISABLED  (6630-ERRESS-PROBLEM)
 17897*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17898*    END-EXEC.
 17899*    MOVE '"$I''cJ                ! % #00017849' TO DFHEIV0
 17900     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17901     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17902     MOVE X'2520233030303137383439' TO DFHEIV0(25:11)
 17903     CALL 'kxdfhei1' USING DFHEIV0
 17904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17905
 17906
 17907
 17908* EXEC CICS READNEXT
 17909*        DATASET (FILE-ID-ERRESS)
 17910*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17911*        RIDFLD  (WS-ERRESS-KEY)
 17912*    END-EXEC.
 17913     MOVE LENGTH OF
 17914      RESIDENT-STATE-TAX-MASTER
 17915       TO DFHEIV12
 17916     MOVE 0
 17917       TO DFHEIV11
 17918*    MOVE '&.IL                  )   #00017856' TO DFHEIV0
 17919     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17920     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17921     MOVE X'2020233030303137383536' TO DFHEIV0(25:11)
 17922     CALL 'kxdfhei1' USING DFHEIV0,
 17923           FILE-ID-ERRESS,
 17924           RESIDENT-STATE-TAX-MASTER,
 17925           DFHEIV12,
 17926           WS-ERRESS-KEY,
 17927           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 328
* EL050.cbl
 17928           DFHEIV11,
 17929           DFHEIV99,
 17930           DFHEIV99
 17931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17932
 17933
 17934     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17935
 17936* EXEC CICS ENDBR
 17937*            DATASET (FILE-ID-ERRESS)
 17938*       END-EXEC
 17939     MOVE 0
 17940       TO DFHEIV11
 17941*    MOVE '&2                    $   #00017863' TO DFHEIV0
 17942     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17943     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17944     MOVE X'2020233030303137383633' TO DFHEIV0(25:11)
 17945     CALL 'kxdfhei1' USING DFHEIV0,
 17946           FILE-ID-ERRESS,
 17947           DFHEIV11,
 17948           DFHEIV99
 17949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17950        GO TO 6630-END-OF-FILE.
 17951
 17952     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17953        NEXT SENTENCE
 17954      ELSE
 17955        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17956
 17957*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17958*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17959*
 17960     MOVE +2                     TO WS-SUB1.
 17961
 17962     IF PB-ISSUE
 17963     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17964        MOVE +1                  TO WS-SUB1.
 17965
 17966     IF PB-CANCELLATION
 17967     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17968        MOVE +1                  TO WS-SUB1.
 17969*
 17970*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17971*
 17972***  Y2K PROJ 7744
 17973     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17974***  Y2K PROJ 7744
 17975
 17976*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17977* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17978* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17979
 17980     ADD 1                    TO WS-YEAR-YY.
 17981
 17982     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17983         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17984                              TO WS-RES-STATE-TAX
 17985         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 329
* EL050.cbl
 17986                              TO WS-RES-MUNI-TAX
 17987     ELSE
 17988         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17989                              TO WS-RES-STATE-TAX
 17990         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17991                              TO WS-RES-MUNI-TAX.
 17992
 17993*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17994
 17995     IF PB-CANCELLATION
 17996         GO TO 6640-CANCEL-TAX.
 17997
 17998     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17999         COMPUTE PB-I-STATE-TAX ROUNDED =
 18000                                   PB-I-LF-PREMIUM-AMT
 18001                                 * WS-RES-STATE-TAX
 18002         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18003                                   PB-I-LF-PREMIUM-AMT
 18004                                 * WS-RES-MUNI-TAX
 18005     ELSE
 18006     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18007         COMPUTE PB-I-STATE-TAX ROUNDED =
 18008                                   PB-I-AH-PREMIUM-AMT
 18009                                 * WS-RES-STATE-TAX
 18010         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18011                                   PB-I-AH-PREMIUM-AMT
 18012                                 * WS-RES-MUNI-TAX.
 18013
 18014
 18015* EXEC CICS ENDBR
 18016*         DATASET (FILE-ID-ERRESS)
 18017*    END-EXEC.
 18018     MOVE 0
 18019       TO DFHEIV11
 18020*    MOVE '&2                    $   #00017930' TO DFHEIV0
 18021     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18022     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18023     MOVE X'2020233030303137393330' TO DFHEIV0(25:11)
 18024     CALL 'kxdfhei1' USING DFHEIV0,
 18025           FILE-ID-ERRESS,
 18026           DFHEIV11,
 18027           DFHEIV99
 18028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18029
 18030
 18031     GO TO 6640-EXIT.
 18032
 18033 6640-CANCEL-TAX.
 18034     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18035
 18036     IF PB-C-LF-CANCEL-AMT > ZEROS
 18037         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18038                                   PB-C-LF-CANCEL-AMT
 18039                                 * WS-RES-STATE-TAX
 18040         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18041                                   PB-C-LF-CANCEL-AMT
 18042                                *  WS-RES-MUNI-TAX
 18043     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 330
* EL050.cbl
 18044     IF PB-C-AH-CANCEL-AMT > ZEROS
 18045         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18046                                   PB-C-AH-CANCEL-AMT
 18047                                 * WS-RES-STATE-TAX
 18048         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18049                                   PB-C-AH-CANCEL-AMT
 18050                                *  WS-RES-MUNI-TAX.
 18051
 18052
 18053* EXEC CICS ENDBR
 18054*         DATASET (FILE-ID-ERRESS)
 18055*    END-EXEC.
 18056     MOVE 0
 18057       TO DFHEIV11
 18058*    MOVE '&2                    $   #00017955' TO DFHEIV0
 18059     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18060     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18061     MOVE X'2020233030303137393535' TO DFHEIV0(25:11)
 18062     CALL 'kxdfhei1' USING DFHEIV0,
 18063           FILE-ID-ERRESS,
 18064           DFHEIV11,
 18065           DFHEIV99
 18066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18067
 18068
 18069     GO TO 6640-EXIT.
 18070
 18071 6630-END-OF-FILE.
 18072     MOVE ER-8002              TO WS-ERROR.
 18073     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18074
 18075     GO TO 6640-EXIT.
 18076
 18077 6630-ERRESS-PROBLEM.
 18078     MOVE ER-8044              TO WS-ERROR.
 18079     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18080
 18081 6640-EXIT.
 18082     EXIT.
 18083
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 331
* EL050.cbl
 18085 6650-GET-RES-STATE-COMM.
 18086
 18087     IF PB-COMPANY-ID NOT = 'DMD'
 18088         GO TO 6700-COMM-EXIT.
 18089
 18090     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18091     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18092     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18093     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18094     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18095     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18096     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18097
 18098*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18099*
 18100***  Y2K PROJ 7744
 18101     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18102     SET BIN-TO-GREG          TO TRUE.
 18103     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18104
 18105     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18106***  Y2K PROJ 7744
 18107
 18108     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18109
 18110
 18111* EXEC CICS HANDLE CONDITION
 18112*        INVREQ    (6660-START-BROWSE)
 18113*        DISABLED  (6690-ERRESC-PROBLEM)
 18114*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18115*        NOTFND    (6690-END-OF-FILE)
 18116*    END-EXEC.
 18117*    MOVE '"$8cJI                ! & #00018000' TO DFHEIV0
 18118     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18119     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18120     MOVE X'2620233030303138303030' TO DFHEIV0(25:11)
 18121     CALL 'kxdfhei1' USING DFHEIV0
 18122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18123
 18124
 18125
 18126* EXEC CICS RESETBR
 18127*        DATASET (FILE-ID-ERRESC)
 18128*        RIDFLD  (WS-ERRESC-KEY)
 18129*    END-EXEC.
 18130     MOVE 0
 18131       TO DFHEIV11
 18132*    MOVE '&4         G          &   #00018007' TO DFHEIV0
 18133     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18134     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18135     MOVE X'2020233030303138303037' TO DFHEIV0(25:11)
 18136     CALL 'kxdfhei1' USING DFHEIV0,
 18137           FILE-ID-ERRESC,
 18138           WS-ERRESC-KEY,
 18139           DFHEIV99,
 18140           DFHEIV11,
 18141           DFHEIV99
 18142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 332
* EL050.cbl
 18143
 18144
 18145 6660-START-BROWSE.
 18146
 18147
 18148* EXEC CICS HANDLE CONDITION
 18149*        NOTFND    (6690-END-OF-FILE)
 18150*        DISABLED  (6690-ERRESC-PROBLEM)
 18151*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18152*        ENDFILE   (6690-END-OF-FILE)
 18153*    END-EXEC.
 18154*    MOVE '"$IcJ''                ! '' #00018014' TO DFHEIV0
 18155     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18156     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18157     MOVE X'2720233030303138303134' TO DFHEIV0(25:11)
 18158     CALL 'kxdfhei1' USING DFHEIV0
 18159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18160
 18161
 18162
 18163* EXEC CICS STARTBR
 18164*        DATASET (FILE-ID-ERRESC)
 18165*        RIDFLD  (WS-ERRESC-KEY)
 18166*        GTEQ
 18167*    END-EXEC.
 18168     MOVE 0
 18169       TO DFHEIV11
 18170*    MOVE '&,         G          &   #00018021' TO DFHEIV0
 18171     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18172     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18173     MOVE X'2020233030303138303231' TO DFHEIV0(25:11)
 18174     CALL 'kxdfhei1' USING DFHEIV0,
 18175           FILE-ID-ERRESC,
 18176           WS-ERRESC-KEY,
 18177           DFHEIV99,
 18178           DFHEIV11,
 18179           DFHEIV99
 18180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18181
 18182
 18183     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18184
 18185 6670-READ-NEXT-ERRESC-MASTER.
 18186
 18187
 18188* EXEC CICS HANDLE CONDITION
 18189*        NOTFND    (6690-END-OF-FILE)
 18190*        DISABLED  (6690-ERRESC-PROBLEM)
 18191*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18192*        ENDFILE   (6690-END-OF-FILE)
 18193*    END-EXEC.
 18194*    MOVE '"$IcJ''                ! ( #00018031' TO DFHEIV0
 18195     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18197     MOVE X'2820233030303138303331' TO DFHEIV0(25:11)
 18198     CALL 'kxdfhei1' USING DFHEIV0
 18199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18200
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 333
* EL050.cbl
 18201
 18202
 18203* EXEC CICS READNEXT
 18204*        DATASET (FILE-ID-ERRESC)
 18205*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18206*        RIDFLD  (ERRESC-RECORD-KEY)
 18207*    END-EXEC.
 18208     MOVE LENGTH OF
 18209      ACCOUNT-RESIDENT-ST-COMMISSION
 18210       TO DFHEIV12
 18211     MOVE 0
 18212       TO DFHEIV11
 18213*    MOVE '&.IL                  )   #00018038' TO DFHEIV0
 18214     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18215     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18216     MOVE X'2020233030303138303338' TO DFHEIV0(25:11)
 18217     CALL 'kxdfhei1' USING DFHEIV0,
 18218           FILE-ID-ERRESC,
 18219           ACCOUNT-RESIDENT-ST-COMMISSION,
 18220           DFHEIV12,
 18221           ERRESC-RECORD-KEY,
 18222           DFHEIV99,
 18223           DFHEIV11,
 18224           DFHEIV99,
 18225           DFHEIV99
 18226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18227
 18228
 18229     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18230        NEXT SENTENCE
 18231     ELSE
 18232
 18233* EXEC CICS ENDBR
 18234*            DATASET (FILE-ID-ERRESC)
 18235*       END-EXEC
 18236     MOVE 0
 18237       TO DFHEIV11
 18238*    MOVE '&2                    $   #00018047' TO DFHEIV0
 18239     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18240     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18241     MOVE X'2020233030303138303437' TO DFHEIV0(25:11)
 18242     CALL 'kxdfhei1' USING DFHEIV0,
 18243           FILE-ID-ERRESC,
 18244           DFHEIV11,
 18245           DFHEIV99
 18246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18247        GO TO 6690-END-OF-FILE.
 18248
 18249     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18250
 18251* EXEC CICS ENDBR
 18252*            DATASET (FILE-ID-ERRESC)
 18253*       END-EXEC
 18254     MOVE 0
 18255       TO DFHEIV11
 18256*    MOVE '&2                    $   #00018053' TO DFHEIV0
 18257     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18258     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 334
* EL050.cbl
 18259     MOVE X'2020233030303138303533' TO DFHEIV0(25:11)
 18260     CALL 'kxdfhei1' USING DFHEIV0,
 18261           FILE-ID-ERRESC,
 18262           DFHEIV11,
 18263           DFHEIV99
 18264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18265        GO TO 6690-END-OF-FILE.
 18266
 18267     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18268        NEXT SENTENCE
 18269      ELSE
 18270        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18271
 18272* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18273*
 18274     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18275
 18276     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18277
 18278     IF WS-SUB1 > ZERO
 18279         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18280             PERFORM 6680-SET-COMMISSION
 18281         ELSE
 18282             PERFORM 6680-SET-TABLE-CODE.
 18283
 18284
 18285* EXEC CICS ENDBR
 18286*         DATASET (FILE-ID-ERRESC)
 18287*    END-EXEC.
 18288     MOVE 0
 18289       TO DFHEIV11
 18290*    MOVE '&2                    $   #00018075' TO DFHEIV0
 18291     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18292     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18293     MOVE X'2020233030303138303735' TO DFHEIV0(25:11)
 18294     CALL 'kxdfhei1' USING DFHEIV0,
 18295           FILE-ID-ERRESC,
 18296           DFHEIV11,
 18297           DFHEIV99
 18298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18299
 18300
 18301     GO TO 6700-COMM-EXIT.
 18302
 18303 6680-SET-TABLE-CODE.
 18304     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18305        MOVE ZEROS             TO WS-SUB1
 18306     ELSE
 18307* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18308* TO COMPUTE AH COMMISSION.
 18309        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18310        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18311        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18312        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18313        PERFORM 6680-READ-CTBL-TABLE
 18314        IF WS-CTBL-READ-SW NOT = 'Y'
 18315           MOVE ZEROS          TO WS-SUB1.
 18316
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 335
* EL050.cbl
 18317 6680-READ-CTBL-TABLE.
 18318*
 18319* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18320* TO COMPUTE LIFE COMMISSION
 18321
 18322     IF CTBL-SW = '0540'
 18323        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18324        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18325        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18326
 18327     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18328
 18329     IF CTBL-TABLE-FOUND
 18330        IF CTBL-SW = '0530'
 18331             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18332                                    * PB-I-AH-TERM
 18333             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18334             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18335        ELSE
 18336             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18337             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18338             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18339     ELSE
 18340        IF FIRST-TIME-THROUGH
 18341            GO TO 6680-READ-CTBL-TABLE
 18342        ELSE
 18343            MOVE ZEROS         TO WS-SUB1.
 18344
 18345 6680-SET-COMMISSION.
 18346     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18347           MOVE ZEROS          TO WS-SUB1
 18348       ELSE
 18349           MOVE RESC-COMMISSION-PER (WS-SUB)
 18350                               TO WS-COMMISSION
 18351           IF CTBL-SW = '0530'
 18352               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18353           ELSE
 18354               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18355
 18356 6680-SEARCH-CATEGORY.
 18357     ADD +1                   TO WS-SUB.
 18358     IF WS-SUB > +12
 18359         GO TO 6680-EXIT.
 18360
 18361     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18362          MOVE WS-SUB         TO WS-SUB1
 18363          GO TO 6680-EXIT.
 18364
 18365     GO TO 6680-SEARCH-CATEGORY.
 18366
 18367 6680-EXIT.
 18368     EXIT.
 18369
 18370 6690-END-OF-FILE.
 18371     GO TO 6700-COMM-EXIT.
 18372
 18373 6690-ERRESC-PROBLEM.
 18374      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 336
* EL050.cbl
 18375      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18376
 18377      GO TO 6700-COMM-EXIT.
 18378
 18379 6700-COMM-EXIT.
 18380     EXIT.
 18381
 18382 7000-GET-RATE.
 18383
 18384* EXEC CICS LINK
 18385*        PROGRAM    ('ELRATE')
 18386*        COMMAREA   (CALCULATION-PASS-AREA)
 18387*        LENGTH     (CP-COMM-LENGTH)
 18388*    END-EXEC.
 18389     MOVE 'ELRATE' TO DFHEIV1
 18390*    MOVE '."C                   (   #00018161' TO DFHEIV0
 18391     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18393     MOVE X'2020233030303138313631' TO DFHEIV0(25:11)
 18394     CALL 'kxdfhei1' USING DFHEIV0,
 18395           DFHEIV1,
 18396           CALCULATION-PASS-AREA,
 18397           CP-COMM-LENGTH,
 18398           DFHEIV99,
 18399           DFHEIV99,
 18400           DFHEIV99,
 18401           DFHEIV99
 18402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18403
 18404
 18405 7000-EXIT.
 18406     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 337
* EL050.cbl
 18408 7100-FIND-BENEFIT-IN-STATE.
 18409     MOVE 'N'                    TO BEN-SEARCH-SW.
 18410
 18411     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18412         VARYING SUB3 FROM 1 BY 1 UNTIL
 18413            ((SUB3 GREATER 50) OR
 18414              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18415               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18416
 18417     IF SUB3 NOT = 51
 18418         MOVE 'Y'                TO BEN-SEARCH-SW.
 18419
 18420     GO TO 7199-EXIT.
 18421
 18422 7100-BENEFIT-DUMMY.
 18423
 18424 7100-DUMMY-EXIT.
 18425     EXIT.
 18426
 18427 7199-EXIT.
 18428     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 338
* EL050.cbl
 18430 7200-FIND-BENEFIT.
 18431     MOVE 'N'                    TO BEN-SEARCH-SW.
 18432
 18433     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18434         VARYING SUB3 FROM 1 BY 1 UNTIL
 18435            ((SUB3 GREATER 8) OR
 18436            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18437
 18438     IF SUB3 NOT = 9
 18439         MOVE 'Y'                TO BEN-SEARCH-SW.
 18440
 18441     GO TO 7200-EXIT.
 18442
 18443 7200-BENEFIT-DUMMY.
 18444
 18445 7200-DUMMY-EXIT.
 18446     EXIT.
 18447
 18448 7200-EXIT.
 18449     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 339
* EL050.cbl
 18451 7250-LOOK-FOR-RESCINDED-CLAIM.
 18452     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18453                                    W-CL-COMP-CD.
 18454     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18455                                    W-CL-CERT-NO.
 18456
 18457
 18458* EXEC CICS HANDLE CONDITION
 18459*        NOTFND  (7250-CONTINUE)
 18460*        ENDFILE (7250-CONTINUE)
 18461*    END-EXEC.
 18462*    MOVE '"$I''                  ! ) #00018219' TO DFHEIV0
 18463     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18465     MOVE X'2920233030303138323139' TO DFHEIV0(25:11)
 18466     CALL 'kxdfhei1' USING DFHEIV0
 18467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18468
 18469
 18470
 18471* EXEC CICS IGNORE CONDITION
 18472*        DUPKEY
 18473*    END-EXEC.
 18474*    MOVE '"*$                   !   #00018224' TO DFHEIV0
 18475     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18476     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18477     MOVE X'2020233030303138323234' TO DFHEIV0(25:11)
 18478     CALL 'kxdfhei1' USING DFHEIV0
 18479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18480
 18481
 18482
 18483* EXEC CICS STARTBR
 18484*        DATASET   (CLMS-ID)
 18485*        RIDFLD    (ELMSTR-KEY)
 18486*        GENERIC   EQUAL
 18487*        KEYLENGTH (ELMSTR-LENGTH)
 18488*    END-EXEC.
 18489     MOVE 0
 18490       TO DFHEIV11
 18491*    MOVE '&,   KG    E          &   #00018228' TO DFHEIV0
 18492     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18493     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18494     MOVE X'2020233030303138323238' TO DFHEIV0(25:11)
 18495     CALL 'kxdfhei1' USING DFHEIV0,
 18496           CLMS-ID,
 18497           ELMSTR-KEY,
 18498           ELMSTR-LENGTH,
 18499           DFHEIV11,
 18500           DFHEIV99
 18501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18502
 18503
 18504     MOVE 'Y'                    TO W-BROWSE-SW.
 18505
 18506 7250-NEXT-CLAIM.
 18507
 18508
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 340
* EL050.cbl
 18509* EXEC CICS READNEXT
 18510*        DATASET   (CLMS-ID)
 18511*        RIDFLD    (ELMSTR-KEY)
 18512*        SET       (ADDRESS OF CLAIM-MASTER)
 18513*    END-EXEC.
 18514     MOVE 0
 18515       TO DFHEIV11
 18516*    MOVE '&.S                   )   #00018239' TO DFHEIV0
 18517     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18518     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18519     MOVE X'2020233030303138323339' TO DFHEIV0(25:11)
 18520     CALL 'kxdfhei1' USING DFHEIV0,
 18521           CLMS-ID,
 18522           DFHEIV20,
 18523           DFHEIV99,
 18524           ELMSTR-KEY,
 18525           DFHEIV99,
 18526           DFHEIV11,
 18527           DFHEIV99,
 18528           DFHEIV99
 18529     SET ADDRESS OF CLAIM-MASTER TO
 18530         DFHEIV20
 18531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18532
 18533
 18534     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18535        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18536         GO TO 7250-CONTINUE
 18537     END-IF.
 18538
 18539     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18540        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18541        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18542        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18543        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18544         GO TO 7250-NEXT-CLAIM
 18545     END-IF.
 18546
 18547     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18548        OR (CL-CLAIM-TYPE = 'I')
 18549        OR (CL-CLAIM-TYPE = 'G')
 18550          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18551              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18552              GO TO 7250-CONTINUE
 18553          END-IF
 18554     END-IF.
 18555
 18556     GO TO 7250-NEXT-CLAIM.
 18557
 18558 7250-CONTINUE.
 18559
 18560     IF W-BROWSE-SW = 'Y'
 18561
 18562* EXEC CICS ENDBR
 18563*            DATASET   (CLMS-ID)
 18564*        END-EXEC
 18565     MOVE 0
 18566       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 341
* EL050.cbl
 18567*    MOVE '&2                    $   #00018272' TO DFHEIV0
 18568     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18569     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18570     MOVE X'2020233030303138323732' TO DFHEIV0(25:11)
 18571     CALL 'kxdfhei1' USING DFHEIV0,
 18572           CLMS-ID,
 18573           DFHEIV11,
 18574           DFHEIV99
 18575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18576         MOVE 'N' TO W-BROWSE-SW
 18577     END-IF.
 18578
 18579 7250-EXIT.
 18580     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 342
* EL050.cbl
 18582 7300-CHECK-FOR-OPEN-CLMS.
 18583
 18584*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18585*    MOVE SPACES                 TO CNTL-ACCESS.
 18586*    MOVE '1'                    TO CNTL-REC-TYPE.
 18587*    MOVE +0                     TO CNTL-SEQ-NO.
 18588
 18589*    MOVE '3'                    TO RC-SW-1.
 18590*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18591
 18592*    IF NOT CF-COMPANY-MASTER
 18593*         PERFORM 0099-COMPANY-NOT-FOUND
 18594*         GO TO 7300-EXIT.
 18595
 18596     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18597                                    W-CL-COMP-CD.
 18598     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18599                                    W-CL-CERT-NO.
 18600
 18601
 18602* EXEC CICS HANDLE CONDITION
 18603*        NOTFND  (7300-CONTINUE)
 18604*        ENDFILE (7300-CONTINUE)
 18605*    END-EXEC.
 18606*    MOVE '"$I''                  ! * #00018300' TO DFHEIV0
 18607     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18608     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18609     MOVE X'2A20233030303138333030' TO DFHEIV0(25:11)
 18610     CALL 'kxdfhei1' USING DFHEIV0
 18611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18612
 18613
 18614
 18615* EXEC CICS IGNORE CONDITION
 18616*        DUPKEY
 18617*    END-EXEC.
 18618*    MOVE '"*$                   !   #00018305' TO DFHEIV0
 18619     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18621     MOVE X'2020233030303138333035' TO DFHEIV0(25:11)
 18622     CALL 'kxdfhei1' USING DFHEIV0
 18623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18624
 18625
 18626
 18627* EXEC CICS STARTBR
 18628*        DATASET   (CLMS-ID)
 18629*        RIDFLD    (ELMSTR-KEY)
 18630*        GENERIC   EQUAL
 18631*        KEYLENGTH (ELMSTR-LENGTH)
 18632*    END-EXEC.
 18633     MOVE 0
 18634       TO DFHEIV11
 18635*    MOVE '&,   KG    E          &   #00018309' TO DFHEIV0
 18636     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18637     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18638     MOVE X'2020233030303138333039' TO DFHEIV0(25:11)
 18639     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 343
* EL050.cbl
 18640           CLMS-ID,
 18641           ELMSTR-KEY,
 18642           ELMSTR-LENGTH,
 18643           DFHEIV11,
 18644           DFHEIV99
 18645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18646
 18647
 18648     MOVE 'Y'                    TO W-BROWSE-SW.
 18649
 18650 7300-NEXT-CLAIM.
 18651
 18652
 18653* EXEC CICS READNEXT
 18654*        DATASET   (CLMS-ID)
 18655*        RIDFLD    (ELMSTR-KEY)
 18656*        SET       (ADDRESS OF CLAIM-MASTER)
 18657*    END-EXEC.
 18658     MOVE 0
 18659       TO DFHEIV11
 18660*    MOVE '&.S                   )   #00018320' TO DFHEIV0
 18661     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18662     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18663     MOVE X'2020233030303138333230' TO DFHEIV0(25:11)
 18664     CALL 'kxdfhei1' USING DFHEIV0,
 18665           CLMS-ID,
 18666           DFHEIV20,
 18667           DFHEIV99,
 18668           ELMSTR-KEY,
 18669           DFHEIV99,
 18670           DFHEIV11,
 18671           DFHEIV99,
 18672           DFHEIV99
 18673     SET ADDRESS OF CLAIM-MASTER TO
 18674         DFHEIV20
 18675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18676
 18677
 18678     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18679        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18680         GO TO 7300-CONTINUE.
 18681
 18682     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18683        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18684        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18685        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18686        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18687         GO TO 7300-NEXT-CLAIM.
 18688
 18689*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18690     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18691        OR (CL-CLAIM-TYPE = 'I')
 18692        OR (CL-CLAIM-TYPE = 'G')
 18693        IF CLAIM-IS-OPEN
 18694           EVALUATE TRUE
 18695             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18696                 MOVE ER-2884      TO WS-ERROR
 18697             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 344
* EL050.cbl
 18698                 MOVE ER-2887      TO WS-ERROR
 18699             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18700                 MOVE ER-2886      TO WS-ERROR
 18701             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18702                 MOVE ER-2888      TO WS-ERROR
 18703             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18704                 MOVE ER-2885      TO WS-ERROR
 18705             WHEN OTHER
 18706                 MOVE ER-2768      TO WS-ERROR
 18707           END-EVALUATE
 18708           IF PB-C-AH-CANCEL-VOIDED OR
 18709              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18710                NOT AH-COVERAGE-CANCELLED)
 18711               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18712               MOVE ER-2768      TO WS-ERROR
 18713           END-IF
 18714           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18715           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18716              PB-FORCE-CODE NOT EQUAL '8'
 18717               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18718           END-IF
 18719           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18720           GO TO 7300-CONTINUE
 18721        ELSE
 18722           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18723*****THIS IS A RESCISSION OR REFORMATION
 18724              IF (AH-COVERAGE-CANCELLED AND
 18725                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18726                    MOVE ER-2890 TO WS-ERROR
 18727                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18728                    GO TO 7300-CONTINUE
 18729              END-IF
 18730           ELSE
 18731              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18732               AND PB-C-AH-CANCEL-DT > SPACES
 18733                 MOVE ER-2756        TO WS-ERROR
 18734                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18735                 GO TO 7300-CONTINUE
 18736              END-IF
 18737           END-IF
 18738        END-IF
 18739     ELSE
 18740*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18741        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18742           IF CLAIM-IS-OPEN
 18743              MOVE ER-2889      TO WS-ERROR
 18744              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18745              GO TO 7300-CONTINUE
 18746           ELSE
 18747              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18748*****THIS IS A RESCISSION OR REFORMATION
 18749                 IF (LF-COVERAGE-CANCELLED AND
 18750                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18751                       MOVE ER-2890 TO WS-ERROR
 18752                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18753                       GO TO 7300-CONTINUE
 18754                 END-IF
 18755              ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 345
* EL050.cbl
 18756                 IF (AH-COVERAGE-CANCELLED AND
 18757                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18758                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18759                    (LF-COVERAGE-CANCELLED AND
 18760                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18761                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18762                       MOVE ER-2965 TO WS-ERROR
 18763                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18764                       GO TO 7300-CONTINUE
 18765                 END-IF
 18766                 IF LF-COVERAGE-CANCELLED
 18767                  IF CL-TOTAL-PAID-AMT > 0
 18768                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18769                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18770                        MOVE ER-2891 TO WS-ERROR
 18771                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18772                        GO TO 7300-CONTINUE
 18773                      END-IF
 18774                    ELSE
 18775                      MOVE ER-2892 TO WS-ERROR
 18776                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18777                      GO TO 7300-CONTINUE
 18778                    END-IF
 18779                  END-IF
 18780                 END-IF
 18781              END-IF
 18782           END-IF
 18783        END-IF
 18784     END-IF
 18785
 18786     GO TO 7300-NEXT-CLAIM.
 18787
 18788 7300-CONTINUE.
 18789
 18790     IF W-BROWSE-SW = 'Y'
 18791
 18792* EXEC CICS ENDBR
 18793*            DATASET   (CLMS-ID)
 18794*        END-EXEC.
 18795     MOVE 0
 18796       TO DFHEIV11
 18797*    MOVE '&2                    $   #00018439' TO DFHEIV0
 18798     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18799     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18800     MOVE X'2020233030303138343339' TO DFHEIV0(25:11)
 18801     CALL 'kxdfhei1' USING DFHEIV0,
 18802           CLMS-ID,
 18803           DFHEIV11,
 18804           DFHEIV99
 18805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18806
 18807
 18808 7300-EXIT.
 18809     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 346
* EL050.cbl
 18811
 18812 7400-GET-REMAIN-TERM.
 18813
 18814* EXEC CICS LINK
 18815*        PROGRAM    ('ELRTRM')
 18816*        COMMAREA   (CALCULATION-PASS-AREA)
 18817*        LENGTH     (CP-COMM-LENGTH)
 18818*    END-EXEC.
 18819     MOVE 'ELRTRM' TO DFHEIV1
 18820*    MOVE '."C                   (   #00018448' TO DFHEIV0
 18821     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18823     MOVE X'2020233030303138343438' TO DFHEIV0(25:11)
 18824     CALL 'kxdfhei1' USING DFHEIV0,
 18825           DFHEIV1,
 18826           CALCULATION-PASS-AREA,
 18827           CP-COMM-LENGTH,
 18828           DFHEIV99,
 18829           DFHEIV99,
 18830           DFHEIV99,
 18831           DFHEIV99
 18832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18833
 18834
 18835 7400-EXIT.
 18836     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 347
* EL050.cbl
 18838
 18839 7500-GET-REMAIN-AMOUNT.
 18840
 18841* EXEC CICS LINK
 18842*        PROGRAM    ('ELRAMT')
 18843*        COMMAREA   (CALCULATION-PASS-AREA)
 18844*        LENGTH     (CP-COMM-LENGTH)
 18845*    END-EXEC.
 18846     MOVE 'ELRAMT' TO DFHEIV1
 18847*    MOVE '."C                   (   #00018459' TO DFHEIV0
 18848     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18850     MOVE X'2020233030303138343539' TO DFHEIV0(25:11)
 18851     CALL 'kxdfhei1' USING DFHEIV0,
 18852           DFHEIV1,
 18853           CALCULATION-PASS-AREA,
 18854           CP-COMM-LENGTH,
 18855           DFHEIV99,
 18856           DFHEIV99,
 18857           DFHEIV99,
 18858           DFHEIV99
 18859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18860
 18861
 18862 7500-EXIT.
 18863     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 348
* EL050.cbl
 18865
 18866 7600-GET-REFUND.
 18867
 18868* EXEC CICS LINK
 18869*        PROGRAM    ('ELRFND')
 18870*        COMMAREA   (CALCULATION-PASS-AREA)
 18871*        LENGTH     (CP-COMM-LENGTH)
 18872*    END-EXEC.
 18873     MOVE 'ELRFND' TO DFHEIV1
 18874*    MOVE '."C                   (   #00018470' TO DFHEIV0
 18875     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18877     MOVE X'2020233030303138343730' TO DFHEIV0(25:11)
 18878     CALL 'kxdfhei1' USING DFHEIV0,
 18879           DFHEIV1,
 18880           CALCULATION-PASS-AREA,
 18881           CP-COMM-LENGTH,
 18882           DFHEIV99,
 18883           DFHEIV99,
 18884           DFHEIV99,
 18885           DFHEIV99
 18886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18887
 18888
 18889 7600-EXIT.
 18890     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 349
* EL050.cbl
 18892 7700-CALL-DL1.
 18893
 18894* EXEC CICS LINK
 18895*        PROGRAM    ('DLO001')
 18896*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18897*        LENGTH     (DLO001-COMM-LENGTH)
 18898*    END-EXEC.
 18899     MOVE 'DLO001' TO DFHEIV1
 18900*    MOVE '."C                   (   #00018480' TO DFHEIV0
 18901     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18902     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18903     MOVE X'2020233030303138343830' TO DFHEIV0(25:11)
 18904     CALL 'kxdfhei1' USING DFHEIV0,
 18905           DFHEIV1,
 18906           WS-DLO-MASTER-POLICY-FORM,
 18907           DLO001-COMM-LENGTH,
 18908           DFHEIV99,
 18909           DFHEIV99,
 18910           DFHEIV99,
 18911           DFHEIV99
 18912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18913
 18914
 18915 7700-EXIT.
 18916     EXIT.
 18917
 18918 7710-CALL-DL2.
 18919
 18920* EXEC CICS LINK
 18921*        PROGRAM    ('DLO002')
 18922*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18923*        LENGTH     (DLO002-COMM-LENGTH)
 18924*    END-EXEC.
 18925     MOVE 'DLO002' TO DFHEIV1
 18926*    MOVE '."C                   (   #00018490' TO DFHEIV0
 18927     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18928     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18929     MOVE X'2020233030303138343930' TO DFHEIV0(25:11)
 18930     CALL 'kxdfhei1' USING DFHEIV0,
 18931           DFHEIV1,
 18932           WS-DLO-INTERNAL-POLICY-FORM,
 18933           DLO002-COMM-LENGTH,
 18934           DFHEIV99,
 18935           DFHEIV99,
 18936           DFHEIV99,
 18937           DFHEIV99
 18938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18939
 18940
 18941 7710-EXIT.
 18942     EXIT.
 18943
 18944 7720-CALL-DL3.
 18945
 18946* EXEC CICS LINK
 18947*        PROGRAM    ('DLO003')
 18948*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18949*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 350
* EL050.cbl
 18950*    END-EXEC.
 18951     MOVE 'DLO003' TO DFHEIV1
 18952*    MOVE '."C                   (   #00018500' TO DFHEIV0
 18953     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18955     MOVE X'2020233030303138353030' TO DFHEIV0(25:11)
 18956     CALL 'kxdfhei1' USING DFHEIV0,
 18957           DFHEIV1,
 18958           WS-DLO-VALID-BANK-ID,
 18959           DLO003-COMM-LENGTH,
 18960           DFHEIV99,
 18961           DFHEIV99,
 18962           DFHEIV99,
 18963           DFHEIV99
 18964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18965
 18966
 18967 7720-EXIT.
 18968     EXIT.
 18969
 18970 7730-CALL-DL7.
 18971
 18972* EXEC CICS LINK
 18973*        PROGRAM    ('DLO007')
 18974*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18975*        LENGTH     (DLO007-COMM-LENGTH)
 18976*    END-EXEC.
 18977     MOVE 'DLO007' TO DFHEIV1
 18978*    MOVE '."C                   (   #00018510' TO DFHEIV0
 18979     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18980     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18981     MOVE X'2020233030303138353130' TO DFHEIV0(25:11)
 18982     CALL 'kxdfhei1' USING DFHEIV0,
 18983           DFHEIV1,
 18984           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18985           DLO007-COMM-LENGTH,
 18986           DFHEIV99,
 18987           DFHEIV99,
 18988           DFHEIV99,
 18989           DFHEIV99
 18990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18991
 18992
 18993 7730-EXIT.
 18994     EXIT.
 18995
 18996 7740-CALL-DL11.
 18997
 18998* EXEC CICS LINK
 18999*        PROGRAM    ('DLO011')
 19000*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19001*        LENGTH     (DLO011-COMM-LENGTH)
 19002*    END-EXEC.
 19003     MOVE 'DLO011' TO DFHEIV1
 19004*    MOVE '."C                   (   #00018520' TO DFHEIV0
 19005     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19006     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19007     MOVE X'2020233030303138353230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 351
* EL050.cbl
 19008     CALL 'kxdfhei1' USING DFHEIV0,
 19009           DFHEIV1,
 19010           WS-DLO-PREM-RATES-BEN-TYPE,
 19011           DLO011-COMM-LENGTH,
 19012           DFHEIV99,
 19013           DFHEIV99,
 19014           DFHEIV99,
 19015           DFHEIV99
 19016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19017
 19018
 19019 7740-EXIT.
 19020     EXIT.
 19021
 19022 7750-CALL-DL17.
 19023
 19024* EXEC CICS LINK
 19025*        PROGRAM    ('DLO017')
 19026*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19027*        LENGTH     (DLO017-COMM-LENGTH)
 19028*    END-EXEC.
 19029     MOVE 'DLO017' TO DFHEIV1
 19030*    MOVE '."C                   (   #00018530' TO DFHEIV0
 19031     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19032     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19033     MOVE X'2020233030303138353330' TO DFHEIV0(25:11)
 19034     CALL 'kxdfhei1' USING DFHEIV0,
 19035           DFHEIV1,
 19036           WS-DLO-VALID-RATE-CODE,
 19037           DLO017-COMM-LENGTH,
 19038           DFHEIV99,
 19039           DFHEIV99,
 19040           DFHEIV99,
 19041           DFHEIV99
 19042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19043
 19044
 19045 7750-EXIT.
 19046     EXIT.
 19047
 19048 7755-CALL-DL19.
 19049
 19050* EXEC CICS LINK
 19051*        PROGRAM    ('DLO019')
 19052*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19053*        LENGTH     (DLO019-COMM-LENGTH)
 19054*    END-EXEC.
 19055     MOVE 'DLO019' TO DFHEIV1
 19056*    MOVE '."C                   (   #00018540' TO DFHEIV0
 19057     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19059     MOVE X'2020233030303138353430' TO DFHEIV0(25:11)
 19060     CALL 'kxdfhei1' USING DFHEIV0,
 19061           DFHEIV1,
 19062           WS-DLO-ORIG-COV-CAT,
 19063           DLO019-COMM-LENGTH,
 19064           DFHEIV99,
 19065           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 352
* EL050.cbl
 19066           DFHEIV99,
 19067           DFHEIV99
 19068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19069
 19070
 19071 7755-EXIT.
 19072     EXIT.
 19073
 19074 7760-CALL-DL21.
 19075
 19076* EXEC CICS LINK
 19077*        PROGRAM    ('DLO021')
 19078*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19079*        LENGTH     (DLO021-COMM-LENGTH)
 19080*    END-EXEC.
 19081     MOVE 'DLO021' TO DFHEIV1
 19082*    MOVE '."C                   (   #00018550' TO DFHEIV0
 19083     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19084     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19085     MOVE X'2020233030303138353530' TO DFHEIV0(25:11)
 19086     CALL 'kxdfhei1' USING DFHEIV0,
 19087           DFHEIV1,
 19088           WS-DLO-VALID-LOAN-OFFICER,
 19089           DLO021-COMM-LENGTH,
 19090           DFHEIV99,
 19091           DFHEIV99,
 19092           DFHEIV99,
 19093           DFHEIV99
 19094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19095
 19096
 19097 7760-EXIT.
 19098     EXIT.
 19099
 19100 7770-CALL-DL22.
 19101
 19102* EXEC CICS LINK
 19103*        PROGRAM    ('DLO022')
 19104*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19105*        LENGTH     (DLO022-COMM-LENGTH)
 19106*    END-EXEC.
 19107     MOVE 'DLO022' TO DFHEIV1
 19108*    MOVE '."C                   (   #00018560' TO DFHEIV0
 19109     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19110     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19111     MOVE X'2020233030303138353630' TO DFHEIV0(25:11)
 19112     CALL 'kxdfhei1' USING DFHEIV0,
 19113           DFHEIV1,
 19114           WS-DLO-VALID-STATE-CODE,
 19115           DLO022-COMM-LENGTH,
 19116           DFHEIV99,
 19117           DFHEIV99,
 19118           DFHEIV99,
 19119           DFHEIV99
 19120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19121
 19122
 19123 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 353
* EL050.cbl
 19124     EXIT.
 19125
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 354
* EL050.cbl
 19127
 19128 7800-REWRITE-CERT.
 19129******************************************************************
 19130*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19131*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19132******************************************************************
 19133
 19134     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19135        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19136        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19137        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19138
 19139* EXEC CICS REWRITE
 19140*                  DATASET (CERT-ID)
 19141*                  FROM    (CERTIFICATE-MASTER)
 19142*              END-EXEC
 19143     MOVE LENGTH OF
 19144      CERTIFICATE-MASTER
 19145       TO DFHEIV11
 19146*    MOVE '&& L                  %   #00018581' TO DFHEIV0
 19147     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19148     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19149     MOVE X'2020233030303138353831' TO DFHEIV0(25:11)
 19150     CALL 'kxdfhei1' USING DFHEIV0,
 19151           CERT-ID,
 19152           CERTIFICATE-MASTER,
 19153           DFHEIV11,
 19154           DFHEIV99
 19155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19156        GO TO 7800-EXIT.
 19157
 19158       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19159       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19160
 19161 7800-EXIT.
 19162      EXIT.
 19163
 19164 7900-DELETE-CERT.
 19165
 19166* EXEC CICS DELETE
 19167*        DATASET (CERT-ID)
 19168*    END-EXEC.
 19169*    MOVE '&(                    &   #00018594' TO DFHEIV0
 19170     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19171     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19172     MOVE X'2020233030303138353934' TO DFHEIV0(25:11)
 19173     CALL 'kxdfhei1' USING DFHEIV0,
 19174           CERT-ID,
 19175           DFHEIV99,
 19176           DFHEIV99,
 19177           DFHEIV99,
 19178           DFHEIV99
 19179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19180
 19181
 19182 7900-EXIT.
 19183     EXIT.
 19184
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 355
* EL050.cbl
 19185 8000-WRITE-CERT.
 19186
 19187* EXEC CICS HANDLE CONDITION
 19188*        DUPKEY    (8000-FREE-MAIN)
 19189*    END-EXEC.
 19190*    MOVE '"$$                   ! + #00018602' TO DFHEIV0
 19191     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19193     MOVE X'2B20233030303138363032' TO DFHEIV0(25:11)
 19194     CALL 'kxdfhei1' USING DFHEIV0
 19195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19196
 19197
 19198
 19199* EXEC CICS WRITE
 19200*        DATASET     (CERT-ID)
 19201*        FROM        (CERTIFICATE-MASTER)
 19202*        RIDFLD      (ELCERT-KEY)
 19203*    END-EXEC.
 19204     MOVE LENGTH OF
 19205      CERTIFICATE-MASTER
 19206       TO DFHEIV11
 19207*    MOVE '&$ L                  ''   #00018606' TO DFHEIV0
 19208     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19209     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19210     MOVE X'2020233030303138363036' TO DFHEIV0(25:11)
 19211     CALL 'kxdfhei1' USING DFHEIV0,
 19212           CERT-ID,
 19213           CERTIFICATE-MASTER,
 19214           DFHEIV11,
 19215           ELCERT-KEY,
 19216           DFHEIV99,
 19217           DFHEIV99
 19218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19219
 19220
 19221 8000-FREE-MAIN.
 19222
 19223 8000-EXIT.
 19224      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 356
* EL050.cbl
 19226
 19227 8100-READ-ERPNDM.
 19228
 19229* EXEC CICS HANDLE CONDITION
 19230*         NOTFND     (8100-NOTFND)
 19231*         ENDFILE    (8100-NOTFND)
 19232*    END-EXEC.
 19233*    MOVE '"$I''                  ! , #00018619' TO DFHEIV0
 19234     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19236     MOVE X'2C20233030303138363139' TO DFHEIV0(25:11)
 19237     CALL 'kxdfhei1' USING DFHEIV0
 19238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19239
 19240
 19241     MOVE SPACES                 TO ERPNDM-FOUND.
 19242     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19243
 19244
 19245* EXEC CICS READ
 19246*         DATASET   (FILE-ERPNDM)
 19247*         RIDFLD    (PM-CONTROL-PRIMARY)
 19248*         INTO      (PENDING-MAILING-DATA)
 19249*    END-EXEC.
 19250     MOVE LENGTH OF
 19251      PENDING-MAILING-DATA
 19252       TO DFHEIV11
 19253*    MOVE '&"IL       E          (   #00018627' TO DFHEIV0
 19254     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19256     MOVE X'2020233030303138363237' TO DFHEIV0(25:11)
 19257     CALL 'kxdfhei1' USING DFHEIV0,
 19258           FILE-ERPNDM,
 19259           PENDING-MAILING-DATA,
 19260           DFHEIV11,
 19261           PM-CONTROL-PRIMARY,
 19262           DFHEIV99,
 19263           DFHEIV99,
 19264           DFHEIV99
 19265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19266
 19267
 19268     GO TO 8100-EXIT.
 19269
 19270 8100-NOTFND.
 19271
 19272     MOVE 'X'                    TO ERPNDM-FOUND.
 19273     MOVE ER-2694                TO WS-ERROR.
 19274     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19275     MOVE ER-2883                TO WS-ERROR
 19276     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19277     .
 19278 8100-EXIT.
 19279     EXIT.
 19280
 19281 8110-READ-ERMAIL.
 19282
 19283* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 357
* EL050.cbl
 19284*         NOTFND     (8110-NOTFND)
 19285*         ENDFILE    (8110-NOTFND)
 19286*    END-EXEC.
 19287*    MOVE '"$I''                  ! - #00018647' TO DFHEIV0
 19288     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19290     MOVE X'2D20233030303138363437' TO DFHEIV0(25:11)
 19291     CALL 'kxdfhei1' USING DFHEIV0
 19292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19293
 19294
 19295     MOVE SPACES                 TO ERMAIL-FOUND.
 19296     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19297     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19298     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19299     MOVE PB-SV-STATE            TO MA-STATE.
 19300
 19301
 19302* EXEC CICS READ
 19303*         UPDATE
 19304*         DATASET   (FILE-ERMAIL)
 19305*         RIDFLD    (MA-CONTROL-PRIMARY)
 19306*         INTO      (MAILING-DATA)
 19307*    END-EXEC.
 19308     MOVE LENGTH OF
 19309      MAILING-DATA
 19310       TO DFHEIV11
 19311*    MOVE '&"IL       EU         (   #00018658' TO DFHEIV0
 19312     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19313     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19314     MOVE X'2020233030303138363538' TO DFHEIV0(25:11)
 19315     CALL 'kxdfhei1' USING DFHEIV0,
 19316           FILE-ERMAIL,
 19317           MAILING-DATA,
 19318           DFHEIV11,
 19319           MA-CONTROL-PRIMARY,
 19320           DFHEIV99,
 19321           DFHEIV99,
 19322           DFHEIV99
 19323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19324
 19325
 19326     GO TO 8110-EXIT.
 19327
 19328 8110-NOTFND.
 19329     MOVE 'X'                    TO ERMAIL-FOUND.
 19330
 19331 8110-EXIT.
 19332     EXIT.
 19333
 19334 8120-REWRITE-ERMAIL.
 19335
 19336* EXEC CICS REWRITE
 19337*         DATASET    (FILE-ERMAIL)
 19338*         FROM       (MAILING-DATA)
 19339*    END-EXEC.
 19340     MOVE LENGTH OF
 19341      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 358
* EL050.cbl
 19342       TO DFHEIV11
 19343*    MOVE '&& L                  %   #00018674' TO DFHEIV0
 19344     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19345     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19346     MOVE X'2020233030303138363734' TO DFHEIV0(25:11)
 19347     CALL 'kxdfhei1' USING DFHEIV0,
 19348           FILE-ERMAIL,
 19349           MAILING-DATA,
 19350           DFHEIV11,
 19351           DFHEIV99
 19352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19353
 19354
 19355 8120-EXIT.
 19356     EXIT.
 19357
 19358 8130-WRITE-ERMAIL.
 19359
 19360* EXEC CICS HANDLE CONDITION
 19361*         DUPKEY   (8130-EXIT)
 19362*    END-EXEC.
 19363*    MOVE '"$$                   ! . #00018683' TO DFHEIV0
 19364     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19365     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19366     MOVE X'2E20233030303138363833' TO DFHEIV0(25:11)
 19367     CALL 'kxdfhei1' USING DFHEIV0
 19368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19369
 19370
 19371
 19372* EXEC CICS WRITE
 19373*         DATASET     (FILE-ERMAIL)
 19374*         RIDFLD      (MA-CONTROL-PRIMARY)
 19375*         FROM        (MAILING-DATA)
 19376*    END-EXEC.
 19377     MOVE LENGTH OF
 19378      MAILING-DATA
 19379       TO DFHEIV11
 19380*    MOVE '&$ L                  ''   #00018687' TO DFHEIV0
 19381     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19382     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19383     MOVE X'2020233030303138363837' TO DFHEIV0(25:11)
 19384     CALL 'kxdfhei1' USING DFHEIV0,
 19385           FILE-ERMAIL,
 19386           MAILING-DATA,
 19387           DFHEIV11,
 19388           MA-CONTROL-PRIMARY,
 19389           DFHEIV99,
 19390           DFHEIV99
 19391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19392
 19393
 19394 8130-EXIT.
 19395     EXIT.
 19396
 19397 8140-UNLOCK-ERMAIL.
 19398
 19399* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 359
* EL050.cbl
 19400*         DATASET   (FILE-ERMAIL)
 19401*    END-EXEC.
 19402*    MOVE '&*                    #   #00018697' TO DFHEIV0
 19403     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19404     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19405     MOVE X'2020233030303138363937' TO DFHEIV0(25:11)
 19406     CALL 'kxdfhei1' USING DFHEIV0,
 19407           FILE-ERMAIL,
 19408           DFHEIV99
 19409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19410
 19411
 19412 8140-EXIT.
 19413     EXIT.
 19414
 19415 8180-UPDATE-VIN-NUMBER.
 19416
 19417* EXEC CICS HANDLE CONDITION
 19418*        NOTFND   (8180-NOTFND)
 19419*    END-EXEC.
 19420*    MOVE '"$I                   ! / #00018705' TO DFHEIV0
 19421     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19422     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19423     MOVE X'2F20233030303138373035' TO DFHEIV0(25:11)
 19424     CALL 'kxdfhei1' USING DFHEIV0
 19425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19426
 19427
 19428     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19429     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19430
 19431
 19432* EXEC CICS READ
 19433*        UPDATE
 19434*        DATASET  (CRTT-ID)
 19435*        RIDFLD   (WS-ELCRTT-KEY)
 19436*        INTO     (CERTIFICATE-TRAILERS)
 19437*    END-EXEC.
 19438     MOVE LENGTH OF
 19439      CERTIFICATE-TRAILERS
 19440       TO DFHEIV11
 19441*    MOVE '&"IL       EU         (   #00018712' TO DFHEIV0
 19442     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19443     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19444     MOVE X'2020233030303138373132' TO DFHEIV0(25:11)
 19445     CALL 'kxdfhei1' USING DFHEIV0,
 19446           CRTT-ID,
 19447           CERTIFICATE-TRAILERS,
 19448           DFHEIV11,
 19449           WS-ELCRTT-KEY,
 19450           DFHEIV99,
 19451           DFHEIV99,
 19452           DFHEIV99
 19453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19454
 19455
 19456     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19457         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 360
* EL050.cbl
 19458
 19459* EXEC CICS REWRITE
 19460*           DATASET  (CRTT-ID)
 19461*           FROM     (CERTIFICATE-TRAILERS)
 19462*        END-EXEC
 19463     MOVE LENGTH OF
 19464      CERTIFICATE-TRAILERS
 19465       TO DFHEIV11
 19466*    MOVE '&& L                  %   #00018721' TO DFHEIV0
 19467     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19468     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19469     MOVE X'2020233030303138373231' TO DFHEIV0(25:11)
 19470     CALL 'kxdfhei1' USING DFHEIV0,
 19471           CRTT-ID,
 19472           CERTIFICATE-TRAILERS,
 19473           DFHEIV11,
 19474           DFHEIV99
 19475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19476     ELSE
 19477
 19478* EXEC CICS UNLOCK
 19479*          DATASET  (CRTT-ID)
 19480*       END-EXEC
 19481*    MOVE '&*                    #   #00018726' TO DFHEIV0
 19482     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19483     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19484     MOVE X'2020233030303138373236' TO DFHEIV0(25:11)
 19485     CALL 'kxdfhei1' USING DFHEIV0,
 19486           CRTT-ID,
 19487           DFHEIV99
 19488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19489     END-IF.
 19490
 19491     GO TO 8180-EXIT.
 19492
 19493 8180-NOTFND.
 19494
 19495     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19496     MOVE 'CS'         TO CS-RECORD-ID.
 19497     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19498     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19499     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19500     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19501
 19502* EXEC CICS WRITE
 19503*       DATASET  (CRTT-ID)
 19504*       RIDFLD   (WS-ELCRTT-KEY)
 19505*       FROM     (CERTIFICATE-TRAILERS)
 19506*    END-EXEC.
 19507     MOVE LENGTH OF
 19508      CERTIFICATE-TRAILERS
 19509       TO DFHEIV11
 19510*    MOVE '&$ L                  ''   #00018741' TO DFHEIV0
 19511     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19512     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19513     MOVE X'2020233030303138373431' TO DFHEIV0(25:11)
 19514     CALL 'kxdfhei1' USING DFHEIV0,
 19515           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 361
* EL050.cbl
 19516           CERTIFICATE-TRAILERS,
 19517           DFHEIV11,
 19518           WS-ELCRTT-KEY,
 19519           DFHEIV99,
 19520           DFHEIV99
 19521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19522
 19523
 19524 8180-EXIT.
 19525     EXIT.
 19526
 19527 8190-UPDATE-REFUND-CLAIM-FLAG.
 19528
 19529* EXEC CICS HANDLE CONDITION
 19530*        NOTFND   (8190-NOTFND)
 19531*    END-EXEC.
 19532*    MOVE '"$I                   ! 0 #00018751' TO DFHEIV0
 19533     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19535     MOVE X'3020233030303138373531' TO DFHEIV0(25:11)
 19536     CALL 'kxdfhei1' USING DFHEIV0
 19537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19538
 19539
 19540     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19541     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19542
 19543
 19544* EXEC CICS READ
 19545*        UPDATE
 19546*        DATASET  (CRTT-ID)
 19547*        RIDFLD   (WS-ELCRTT-KEY)
 19548*        INTO     (CERTIFICATE-TRAILERS)
 19549*    END-EXEC.
 19550     MOVE LENGTH OF
 19551      CERTIFICATE-TRAILERS
 19552       TO DFHEIV11
 19553*    MOVE '&"IL       EU         (   #00018758' TO DFHEIV0
 19554     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19555     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19556     MOVE X'2020233030303138373538' TO DFHEIV0(25:11)
 19557     CALL 'kxdfhei1' USING DFHEIV0,
 19558           CRTT-ID,
 19559           CERTIFICATE-TRAILERS,
 19560           DFHEIV11,
 19561           WS-ELCRTT-KEY,
 19562           DFHEIV99,
 19563           DFHEIV99,
 19564           DFHEIV99
 19565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19566
 19567
 19568     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19569
 19570* EXEC CICS REWRITE
 19571*       DATASET  (CRTT-ID)
 19572*       FROM     (CERTIFICATE-TRAILERS)
 19573*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 362
* EL050.cbl
 19574     MOVE LENGTH OF
 19575      CERTIFICATE-TRAILERS
 19576       TO DFHEIV11
 19577*    MOVE '&& L                  %   #00018766' TO DFHEIV0
 19578     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19579     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19580     MOVE X'2020233030303138373636' TO DFHEIV0(25:11)
 19581     CALL 'kxdfhei1' USING DFHEIV0,
 19582           CRTT-ID,
 19583           CERTIFICATE-TRAILERS,
 19584           DFHEIV11,
 19585           DFHEIV99
 19586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19587
 19588
 19589     GO TO 8190-EXIT.
 19590
 19591 8190-NOTFND.
 19592
 19593     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19594     MOVE 'CS'         TO CS-RECORD-ID.
 19595     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19596     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19597     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19598     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19599
 19600* EXEC CICS WRITE
 19601*       DATASET  (CRTT-ID)
 19602*       RIDFLD   (WS-ELCRTT-KEY)
 19603*       FROM     (CERTIFICATE-TRAILERS)
 19604*    END-EXEC.
 19605     MOVE LENGTH OF
 19606      CERTIFICATE-TRAILERS
 19607       TO DFHEIV11
 19608*    MOVE '&$ L                  ''   #00018781' TO DFHEIV0
 19609     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19610     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19611     MOVE X'2020233030303138373831' TO DFHEIV0(25:11)
 19612     CALL 'kxdfhei1' USING DFHEIV0,
 19613           CRTT-ID,
 19614           CERTIFICATE-TRAILERS,
 19615           DFHEIV11,
 19616           WS-ELCRTT-KEY,
 19617           DFHEIV99,
 19618           DFHEIV99
 19619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19620
 19621
 19622 8190-EXIT.
 19623     EXIT.
 19624
 19625 8195-UPDATE-AGE-FLAGS.
 19626
 19627* EXEC CICS HANDLE CONDITION
 19628*        NOTFND   (8195-NOTFND)
 19629*    END-EXEC.
 19630*    MOVE '"$I                   ! 1 #00018791' TO DFHEIV0
 19631     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 363
* EL050.cbl
 19632     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19633     MOVE X'3120233030303138373931' TO DFHEIV0(25:11)
 19634     CALL 'kxdfhei1' USING DFHEIV0
 19635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19636
 19637
 19638     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19639     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19640
 19641
 19642* EXEC CICS READ
 19643*        UPDATE
 19644*        DATASET  (CRTT-ID)
 19645*        RIDFLD   (WS-ELCRTT-KEY)
 19646*        INTO     (CERTIFICATE-TRAILERS)
 19647*    END-EXEC.
 19648     MOVE LENGTH OF
 19649      CERTIFICATE-TRAILERS
 19650       TO DFHEIV11
 19651*    MOVE '&"IL       EU         (   #00018798' TO DFHEIV0
 19652     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19653     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19654     MOVE X'2020233030303138373938' TO DFHEIV0(25:11)
 19655     CALL 'kxdfhei1' USING DFHEIV0,
 19656           CRTT-ID,
 19657           CERTIFICATE-TRAILERS,
 19658           DFHEIV11,
 19659           WS-ELCRTT-KEY,
 19660           DFHEIV99,
 19661           DFHEIV99,
 19662           DFHEIV99
 19663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19664
 19665
 19666     IF WS-INS-AGE-SET = 'Y'
 19667        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19668     END-IF
 19669     IF WS-JNT-AGE-SET = 'Y'
 19670        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19671     END-IF
 19672
 19673
 19674* EXEC CICS REWRITE
 19675*       DATASET  (CRTT-ID)
 19676*       FROM     (CERTIFICATE-TRAILERS)
 19677*    END-EXEC.
 19678     MOVE LENGTH OF
 19679      CERTIFICATE-TRAILERS
 19680       TO DFHEIV11
 19681*    MOVE '&& L                  %   #00018812' TO DFHEIV0
 19682     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19683     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19684     MOVE X'2020233030303138383132' TO DFHEIV0(25:11)
 19685     CALL 'kxdfhei1' USING DFHEIV0,
 19686           CRTT-ID,
 19687           CERTIFICATE-TRAILERS,
 19688           DFHEIV11,
 19689           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 364
* EL050.cbl
 19690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19691
 19692
 19693     GO TO 8195-EXIT.
 19694
 19695 8195-NOTFND.
 19696
 19697     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19698     MOVE 'CS'         TO CS-RECORD-ID.
 19699     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19700     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19701     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19702     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19703     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19704
 19705* EXEC CICS WRITE
 19706*       DATASET  (CRTT-ID)
 19707*       RIDFLD   (WS-ELCRTT-KEY)
 19708*       FROM     (CERTIFICATE-TRAILERS)
 19709*    END-EXEC.
 19710     MOVE LENGTH OF
 19711      CERTIFICATE-TRAILERS
 19712       TO DFHEIV11
 19713*    MOVE '&$ L                  ''   #00018828' TO DFHEIV0
 19714     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19715     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19716     MOVE X'2020233030303138383238' TO DFHEIV0(25:11)
 19717     CALL 'kxdfhei1' USING DFHEIV0,
 19718           CRTT-ID,
 19719           CERTIFICATE-TRAILERS,
 19720           DFHEIV11,
 19721           WS-ELCRTT-KEY,
 19722           DFHEIV99,
 19723           DFHEIV99
 19724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19725
 19726
 19727 8195-EXIT.
 19728     EXIT.
 19729
 19730 8200-READ-REIN-TABLE.
 19731
 19732* EXEC CICS HANDLE CONDITION
 19733*         NOTFND   (8200-NOTFND)
 19734*    END-EXEC.
 19735*    MOVE '"$I                   ! 2 #00018838' TO DFHEIV0
 19736     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19737     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19738     MOVE X'3220233030303138383338' TO DFHEIV0(25:11)
 19739     CALL 'kxdfhei1' USING DFHEIV0
 19740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19741
 19742
 19743
 19744* EXEC CICS READ
 19745*        DATASET     (REIN-ID)
 19746*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19747*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 365
* EL050.cbl
 19748*    END-EXEC.
 19749*    MOVE '&"S        E          (   #00018842' TO DFHEIV0
 19750     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19751     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19752     MOVE X'2020233030303138383432' TO DFHEIV0(25:11)
 19753     CALL 'kxdfhei1' USING DFHEIV0,
 19754           REIN-ID,
 19755           DFHEIV20,
 19756           DFHEIV99,
 19757           ERREIN-KEY,
 19758           DFHEIV99,
 19759           DFHEIV99,
 19760           DFHEIV99
 19761     SET ADDRESS OF REINSURANCE-RECORD TO
 19762         DFHEIV20
 19763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19764
 19765
 19766     GO TO 8200-EXIT.
 19767
 19768 8200-NOTFND.
 19769     MOVE 'N'             TO WS-REIN-READ-SW.
 19770
 19771 8200-EXIT.
 19772      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 366
* EL050.cbl
 19774
 19775 8300-READ-CTBL-TABLE.
 19776
 19777* EXEC CICS HANDLE CONDITION
 19778*        NOTFND    (8300-NOTFND)
 19779*        DISABLED  (8300-ERRESS-PROBLEM)
 19780*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19781*        ENDFILE   (8300-NOTFND)
 19782*    END-EXEC.
 19783*    MOVE '"$IcJ''                ! 3 #00018858' TO DFHEIV0
 19784     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19786     MOVE X'3320233030303138383538' TO DFHEIV0(25:11)
 19787     CALL 'kxdfhei1' USING DFHEIV0
 19788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19789
 19790
 19791
 19792* EXEC CICS READ
 19793*        DATASET     (CTBL-ID)
 19794*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19795*        RIDFLD      (ERCTBL-KEY)
 19796*    END-EXEC.
 19797*    MOVE '&"S        E          (   #00018865' TO DFHEIV0
 19798     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19800     MOVE X'2020233030303138383635' TO DFHEIV0(25:11)
 19801     CALL 'kxdfhei1' USING DFHEIV0,
 19802           CTBL-ID,
 19803           DFHEIV20,
 19804           DFHEIV99,
 19805           ERCTBL-KEY,
 19806           DFHEIV99,
 19807           DFHEIV99,
 19808           DFHEIV99
 19809     SET ADDRESS OF COMM-TABLE-RECORD TO
 19810         DFHEIV20
 19811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19812
 19813
 19814     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19815
 19816     GO TO 8300-EXIT.
 19817
 19818 8300-NOTFND.
 19819
 19820     IF CTBL-SW = '0530'
 19821         MOVE 'AA'                     TO WS-AH-COMP-CD
 19822         MOVE '0550'                   TO CTBL-SW
 19823         MOVE '1'                      TO WS-CTBL-READ-SW
 19824         GO TO 8300-EXIT.
 19825
 19826     IF CTBL-SW = '0540'
 19827         MOVE 'AA'                     TO WS-LF-COMP-CD
 19828         MOVE '0550'                   TO CTBL-SW
 19829         MOVE '1'                      TO WS-CTBL-READ-SW
 19830         GO TO 8300-EXIT.
 19831
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 367
* EL050.cbl
 19832     IF CTBL-SW = '0550'
 19833         MOVE '2'                      TO WS-CTBL-READ-SW
 19834         GO TO 8300-EXIT.
 19835
 19836     GO TO 8300-EXIT.
 19837
 19838 8300-ERRESS-PROBLEM.
 19839
 19840      MOVE ER-8050              TO WS-ERROR.
 19841      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19842
 19843     GO TO 8300-EXIT.
 19844
 19845 8300-EXIT.
 19846      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 368
* EL050.cbl
 19848
 19849
 19850 8400-GETMAIN-ERFORM.
 19851
 19852
 19853* EXEC CICS   GETMAIN
 19854*        LENGTH  (500)
 19855*        SET     (ADDRESS OF FORM-MASTER)
 19856*    END-EXEC.
 19857     MOVE 500
 19858       TO DFHEIV11
 19859*    MOVE '," L                  $   #00018909' TO DFHEIV0
 19860     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19861     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19862     MOVE X'2020233030303138393039' TO DFHEIV0(25:11)
 19863     CALL 'kxdfhei1' USING DFHEIV0,
 19864           DFHEIV20,
 19865           DFHEIV11,
 19866           DFHEIV99
 19867     SET ADDRESS OF FORM-MASTER TO
 19868         DFHEIV20
 19869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19870
 19871
 19872     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19873
 19874 8400-EXIT.
 19875      EXIT.
 19876
 19877 8450-READ-FORM-MASTER.
 19878
 19879
 19880* EXEC CICS  HANDLE CONDITION
 19881*        NOTFND   (8450-FORM-NOT-FOUND)
 19882*        ENDFILE  (8450-FORM-NOT-FOUND)
 19883*    END-EXEC.
 19884*    MOVE '"$I''                  ! 4 #00018921' TO DFHEIV0
 19885     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19887     MOVE X'3420233030303138393231' TO DFHEIV0(25:11)
 19888     CALL 'kxdfhei1' USING DFHEIV0
 19889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19890
 19891
 19892
 19893* EXEC CICS   READ
 19894*        DATASET   (FORM-ID)
 19895*        RIDFLD    (ERFORM-KEY)
 19896*        INTO      (FORM-MASTER)
 19897*        GTEQ
 19898*    END-EXEC.
 19899     MOVE LENGTH OF
 19900      FORM-MASTER
 19901       TO DFHEIV11
 19902*    MOVE '&"IL       G          (   #00018926' TO DFHEIV0
 19903     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19904     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19905     MOVE X'2020233030303138393236' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 369
* EL050.cbl
 19906     CALL 'kxdfhei1' USING DFHEIV0,
 19907           FORM-ID,
 19908           FORM-MASTER,
 19909           DFHEIV11,
 19910           ERFORM-KEY,
 19911           DFHEIV99,
 19912           DFHEIV99,
 19913           DFHEIV99
 19914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19915
 19916
 19917     MOVE  'Y'           TO  FORM-MASTER-SW.
 19918
 19919     GO TO  8450-EXIT.
 19920
 19921 8450-FORM-NOT-FOUND.
 19922
 19923     MOVE  'N'           TO  FORM-MASTER-SW.
 19924
 19925 8450-EXIT.
 19926      EXIT.
 19927
 19928 8500-DATE-CONVERT.
 19929
 19930* EXEC CICS LINK
 19931*        PROGRAM    ('ELDATCV')
 19932*        COMMAREA   (DATE-CONVERSION-DATA)
 19933*        LENGTH     (DC-COMM-LENGTH)
 19934*    END-EXEC.
 19935     MOVE 'ELDATCV' TO DFHEIV1
 19936*    MOVE '."C                   (   #00018945' TO DFHEIV0
 19937     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19938     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19939     MOVE X'2020233030303138393435' TO DFHEIV0(25:11)
 19940     CALL 'kxdfhei1' USING DFHEIV0,
 19941           DFHEIV1,
 19942           DATE-CONVERSION-DATA,
 19943           DC-COMM-LENGTH,
 19944           DFHEIV99,
 19945           DFHEIV99,
 19946           DFHEIV99,
 19947           DFHEIV99
 19948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19949
 19950
 19951 8500-EXIT.
 19952     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 370
* EL050.cbl
 19954
 19955 8555-RELOAD-CONTROL-FILE.
 19956     CONTINUE.
 19957
 19958 8555-EXIT.
 19959     EXIT.
 19960
 19961 8557-GETMAIN-ERPLAN.
 19962
 19963
 19964* EXEC CICS GETMAIN
 19965*        LENGTH    (840)
 19966*        SET       (ADDRESS OF PLAN-RECORDS)
 19967*    END-EXEC.
 19968     MOVE 840
 19969       TO DFHEIV11
 19970*    MOVE '," L                  $   #00018963' TO DFHEIV0
 19971     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19972     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19973     MOVE X'2020233030303138393633' TO DFHEIV0(25:11)
 19974     CALL 'kxdfhei1' USING DFHEIV0,
 19975           DFHEIV20,
 19976           DFHEIV11,
 19977           DFHEIV99
 19978     SET ADDRESS OF PLAN-RECORDS TO
 19979         DFHEIV20
 19980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19981
 19982
 19983     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19984
 19985 8557-EXIT.
 19986     EXIT.
 19987
 19988 8560-GETMAIN.
 19989
 19990* EXEC CICS GETMAIN
 19991*        LENGTH    (2000)
 19992*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19993*    END-EXEC.
 19994     MOVE 2000
 19995       TO DFHEIV11
 19996*    MOVE '," L                  $   #00018974' TO DFHEIV0
 19997     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19998     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19999     MOVE X'2020233030303138393734' TO DFHEIV0(25:11)
 20000     CALL 'kxdfhei1' USING DFHEIV0,
 20001           DFHEIV20,
 20002           DFHEIV11,
 20003           DFHEIV99
 20004     SET ADDRESS OF ACCOUNT-MASTER TO
 20005         DFHEIV20
 20006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20007
 20008
 20009     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20010
 20011 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 371
* EL050.cbl
 20012     EXIT.
 20013
 20014 8570-START-ACCOUNT-MASTER.
 20015
 20016* EXEC CICS HANDLE CONDITION
 20017*        NOTFND    (0199-ACCT-NOT-FOUND)
 20018*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20019*    END-EXEC.
 20020*    MOVE '"$I''                  ! 5 #00018985' TO DFHEIV0
 20021     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20022     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20023     MOVE X'3520233030303138393835' TO DFHEIV0(25:11)
 20024     CALL 'kxdfhei1' USING DFHEIV0
 20025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20026
 20027
 20028
 20029* EXEC CICS STARTBR
 20030*        DATASET    (ACCT-ID)
 20031*        RIDFLD     (ERACCT-KEY)
 20032*        GTEQ
 20033*    END-EXEC.
 20034     MOVE 0
 20035       TO DFHEIV11
 20036*    MOVE '&,         G          &   #00018990' TO DFHEIV0
 20037     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20038     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20039     MOVE X'2020233030303138393930' TO DFHEIV0(25:11)
 20040     CALL 'kxdfhei1' USING DFHEIV0,
 20041           ACCT-ID,
 20042           ERACCT-KEY,
 20043           DFHEIV99,
 20044           DFHEIV11,
 20045           DFHEIV99
 20046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20047
 20048
 20049 8570-EXIT.
 20050     EXIT.
 20051
 20052 8580-READ-ACCOUNT-MASTER.
 20053
 20054* EXEC CICS HANDLE CONDITION
 20055*        NOTFND    (0199-ACCT-NOT-FOUND)
 20056*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20057*    END-EXEC.
 20058*    MOVE '"$I''                  ! 6 #00019000' TO DFHEIV0
 20059     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20060     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20061     MOVE X'3620233030303139303030' TO DFHEIV0(25:11)
 20062     CALL 'kxdfhei1' USING DFHEIV0
 20063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20064
 20065
 20066
 20067* EXEC CICS READNEXT
 20068*        DATASET     (ACCT-ID)
 20069*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 372
* EL050.cbl
 20070*        RIDFLD      (ERACCT-KEY)
 20071*    END-EXEC.
 20072     MOVE LENGTH OF
 20073      ACCOUNT-MASTER
 20074       TO DFHEIV12
 20075     MOVE 0
 20076       TO DFHEIV11
 20077*    MOVE '&.IL                  )   #00019005' TO DFHEIV0
 20078     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20079     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20080     MOVE X'2020233030303139303035' TO DFHEIV0(25:11)
 20081     CALL 'kxdfhei1' USING DFHEIV0,
 20082           ACCT-ID,
 20083           ACCOUNT-MASTER,
 20084           DFHEIV12,
 20085           ERACCT-KEY,
 20086           DFHEIV99,
 20087           DFHEIV11,
 20088           DFHEIV99,
 20089           DFHEIV99
 20090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20091
 20092
 20093 8580-EXIT.
 20094     EXIT.
 20095
 20096 8582-READ-COMPENSATION-MASTER.
 20097
 20098* EXEC CICS HANDLE CONDITION
 20099*        NOTFND    (8582-COMP-NOT-FOUND)
 20100*        ENDFILE   (8582-COMP-NOT-FOUND)
 20101*    END-EXEC.
 20102*    MOVE '"$I''                  ! 7 #00019015' TO DFHEIV0
 20103     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20105     MOVE X'3720233030303139303135' TO DFHEIV0(25:11)
 20106     CALL 'kxdfhei1' USING DFHEIV0
 20107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20108
 20109
 20110
 20111* EXEC CICS READ
 20112*        DATASET     (COMP-ID)
 20113*        INTO        (COMPENSATION-MASTER)
 20114*        RIDFLD      (ERCOMP-KEY)
 20115*    END-EXEC.
 20116     MOVE LENGTH OF
 20117      COMPENSATION-MASTER
 20118       TO DFHEIV11
 20119*    MOVE '&"IL       E          (   #00019020' TO DFHEIV0
 20120     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20121     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20122     MOVE X'2020233030303139303230' TO DFHEIV0(25:11)
 20123     CALL 'kxdfhei1' USING DFHEIV0,
 20124           COMP-ID,
 20125           COMPENSATION-MASTER,
 20126           DFHEIV11,
 20127           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 373
* EL050.cbl
 20128           DFHEIV99,
 20129           DFHEIV99,
 20130           DFHEIV99
 20131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20132
 20133
 20134     MOVE 'Y'                    TO COMP-MASTER-SW
 20135
 20136     GO TO 8582-EXIT
 20137     .
 20138 8582-COMP-NOT-FOUND.
 20139
 20140     MOVE 'N'                    TO COMP-MASTER-SW.
 20141
 20142 8582-EXIT.
 20143     EXIT.
 20144
 20145 8583-READ-ERAGTC.
 20146
 20147* EXEC CICS HANDLE CONDITION
 20148*        NOTFND    (8583-AGTC-NOT-FOUND)
 20149*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20150*    END-EXEC.
 20151*    MOVE '"$I''                  ! 8 #00019038' TO DFHEIV0
 20152     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20154     MOVE X'3820233030303139303338' TO DFHEIV0(25:11)
 20155     CALL 'kxdfhei1' USING DFHEIV0
 20156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20157
 20158
 20159
 20160* EXEC CICS STARTBR
 20161*        DATASET    (AGTC-ID)
 20162*        RIDFLD     (ERAGTC-KEY)
 20163*        GTEQ
 20164*    END-EXEC.
 20165     MOVE 0
 20166       TO DFHEIV11
 20167*    MOVE '&,         G          &   #00019043' TO DFHEIV0
 20168     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20169     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20170     MOVE X'2020233030303139303433' TO DFHEIV0(25:11)
 20171     CALL 'kxdfhei1' USING DFHEIV0,
 20172           AGTC-ID,
 20173           ERAGTC-KEY,
 20174           DFHEIV99,
 20175           DFHEIV11,
 20176           DFHEIV99
 20177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20178
 20179
 20180 8583-READ-ERAGTC-NEXT.
 20181
 20182* EXEC CICS READNEXT
 20183*        DATASET     (AGTC-ID)
 20184*        INTO        (AGENT-COMMISSIONS)
 20185*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 374
* EL050.cbl
 20186*    END-EXEC.
 20187     MOVE LENGTH OF
 20188      AGENT-COMMISSIONS
 20189       TO DFHEIV12
 20190     MOVE 0
 20191       TO DFHEIV11
 20192*    MOVE '&.IL                  )   #00019050' TO DFHEIV0
 20193     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20194     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20195     MOVE X'2020233030303139303530' TO DFHEIV0(25:11)
 20196     CALL 'kxdfhei1' USING DFHEIV0,
 20197           AGTC-ID,
 20198           AGENT-COMMISSIONS,
 20199           DFHEIV12,
 20200           ERAGTC-KEY,
 20201           DFHEIV99,
 20202           DFHEIV11,
 20203           DFHEIV99,
 20204           DFHEIV99
 20205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20206
 20207
 20208*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20209
 20210     GO TO 8583-EXIT
 20211     .
 20212 8583-AGTC-NOT-FOUND.
 20213
 20214     MOVE 'N'                    TO AGTC-MASTER-SW.
 20215
 20216 8583-EXIT.
 20217     EXIT.
 20218
 20219 8584-READ-BANK-CROSS-REF.
 20220
 20221* EXEC CICS HANDLE CONDITION
 20222*        NOTFND    (8584-BXRF-NOT-FOUND)
 20223*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20224*    END-EXEC.
 20225*    MOVE '"$I''                  ! 9 #00019068' TO DFHEIV0
 20226     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20227     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20228     MOVE X'3920233030303139303638' TO DFHEIV0(25:11)
 20229     CALL 'kxdfhei1' USING DFHEIV0
 20230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20231
 20232
 20233
 20234* EXEC CICS READ
 20235*        DATASET     (BXRF-ID)
 20236*        INTO        (BANK-CROSS-REFERENCE)
 20237*        RIDFLD      (ERBXRF-KEY)
 20238*        LENGTH      (BXRF-REC-LENGTH)
 20239*    END-EXEC.
 20240*    MOVE '&"IL       E          (   #00019073' TO DFHEIV0
 20241     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20243     MOVE X'2020233030303139303733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 375
* EL050.cbl
 20244     CALL 'kxdfhei1' USING DFHEIV0,
 20245           BXRF-ID,
 20246           BANK-CROSS-REFERENCE,
 20247           BXRF-REC-LENGTH,
 20248           ERBXRF-KEY,
 20249           DFHEIV99,
 20250           DFHEIV99,
 20251           DFHEIV99
 20252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20253
 20254
 20255     MOVE 'Y'                    TO BXRF-MASTER-SW
 20256
 20257     GO TO 8584-EXIT
 20258     .
 20259 8584-BXRF-NOT-FOUND.
 20260
 20261     MOVE 'N'                    TO BXRF-MASTER-SW.
 20262
 20263 8584-EXIT.
 20264     EXIT.
 20265
 20266 8585-READ-PLAN-MASTER.
 20267
 20268
 20269* EXEC CICS HANDLE CONDITION
 20270*        NOTFND    (8585-PLAN-NOT-FOUND)
 20271*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20272*    END-EXEC.
 20273*    MOVE '"$I''                  ! : #00019093' TO DFHEIV0
 20274     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20275     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20276     MOVE X'3A20233030303139303933' TO DFHEIV0(25:11)
 20277     CALL 'kxdfhei1' USING DFHEIV0
 20278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20279
 20280
 20281
 20282* EXEC CICS READ
 20283*        DATASET     (PLAN-ID)
 20284*        INTO        (PLAN-MASTER)
 20285*        RIDFLD      (ERPLAN-KEY)
 20286*    END-EXEC.
 20287     MOVE LENGTH OF
 20288      PLAN-MASTER
 20289       TO DFHEIV11
 20290*    MOVE '&"IL       E          (   #00019098' TO DFHEIV0
 20291     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20292     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20293     MOVE X'2020233030303139303938' TO DFHEIV0(25:11)
 20294     CALL 'kxdfhei1' USING DFHEIV0,
 20295           PLAN-ID,
 20296           PLAN-MASTER,
 20297           DFHEIV11,
 20298           ERPLAN-KEY,
 20299           DFHEIV99,
 20300           DFHEIV99,
 20301           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 376
* EL050.cbl
 20302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20303
 20304
 20305     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20306
 20307     GO TO 8585-EXIT.
 20308
 20309 8585-PLAN-NOT-FOUND.
 20310
 20311     MOVE 'N'                    TO PLAN-MASTER-SW.
 20312
 20313 8585-EXIT.
 20314     EXIT.
 20315
 20316 8586-READ-LOAN-OFFICER.
 20317
 20318* EXEC CICS READ
 20319*        DATASET     (LOFC-ID)
 20320*        INTO        (LOAN-OFFICER-MASTER)
 20321*        RIDFLD      (ERLOFC-KEY)
 20322*        RESP        (WS-RESPONSE)
 20323*    END-EXEC
 20324     MOVE LENGTH OF
 20325      LOAN-OFFICER-MASTER
 20326       TO DFHEIV11
 20327*    MOVE '&"IL       E          (  N#00019116' TO DFHEIV0
 20328     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20329     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20330     MOVE X'204E233030303139313136' TO DFHEIV0(25:11)
 20331     CALL 'kxdfhei1' USING DFHEIV0,
 20332           LOFC-ID,
 20333           LOAN-OFFICER-MASTER,
 20334           DFHEIV11,
 20335           ERLOFC-KEY,
 20336           DFHEIV99,
 20337           DFHEIV99,
 20338           DFHEIV99
 20339     MOVE EIBRESP  TO WS-RESPONSE
 20340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20341
 20342     IF WS-RESP-NORMAL
 20343        MOVE 'Y'                 TO LOFC-MASTER-SW
 20344     ELSE
 20345        MOVE 'N'                 TO LOFC-MASTER-SW
 20346     END-IF
 20347     .
 20348 8586-EXIT.
 20349     EXIT.
 20350 8587-START-ERPDEF.
 20351
 20352* EXEC CICS STARTBR
 20353*       DATASET   (PDEF-ID)
 20354*       RIDFLD    (ERPDEF-KEY)
 20355*       GTEQ
 20356*       RESP      (WS-RESPONSE)
 20357*    END-EXEC
 20358     MOVE 0
 20359       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 377
* EL050.cbl
 20360*    MOVE '&,         G          &  N#00019132' TO DFHEIV0
 20361     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20362     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20363     MOVE X'204E233030303139313332' TO DFHEIV0(25:11)
 20364     CALL 'kxdfhei1' USING DFHEIV0,
 20365           PDEF-ID,
 20366           ERPDEF-KEY,
 20367           DFHEIV99,
 20368           DFHEIV11,
 20369           DFHEIV99
 20370     MOVE EIBRESP  TO WS-RESPONSE
 20371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20372     IF WS-RESP-NORMAL
 20373        MOVE 'Y'                 TO PDEF-MASTER-SW
 20374     ELSE
 20375        MOVE 'N'                 TO PDEF-MASTER-SW
 20376     END-IF
 20377     .
 20378 8587-EXIT.
 20379     EXIT.
 20380 8588-READ-ERPDEF.
 20381
 20382* EXEC CICS READNEXT
 20383*       DATASET   (PDEF-ID)
 20384*       RIDFLD    (ERPDEF-KEY)
 20385*       INTO      (PRODUCT-MASTER)
 20386*       RESP      (WS-RESPONSE)
 20387*    END-EXEC
 20388     MOVE LENGTH OF
 20389      PRODUCT-MASTER
 20390       TO DFHEIV12
 20391     MOVE 0
 20392       TO DFHEIV11
 20393*    MOVE '&.IL                  )  N#00019147' TO DFHEIV0
 20394     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20395     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20396     MOVE X'204E233030303139313437' TO DFHEIV0(25:11)
 20397     CALL 'kxdfhei1' USING DFHEIV0,
 20398           PDEF-ID,
 20399           PRODUCT-MASTER,
 20400           DFHEIV12,
 20401           ERPDEF-KEY,
 20402           DFHEIV99,
 20403           DFHEIV11,
 20404           DFHEIV99,
 20405           DFHEIV99
 20406     MOVE EIBRESP  TO WS-RESPONSE
 20407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20408     IF WS-RESP-NORMAL
 20409        MOVE 'Y'                 TO PDEF-MASTER-SW
 20410     ELSE
 20411        MOVE 'N'                 TO PDEF-MASTER-SW
 20412     END-IF
 20413     .
 20414 8588-EXIT.
 20415     EXIT.
 20416 8589-ENDBR-ERPDEF.
 20417
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 378
* EL050.cbl
 20418* EXEC CICS ENDBR
 20419*       DATASET   (PDEF-ID)
 20420*    END-EXEC
 20421     MOVE 0
 20422       TO DFHEIV11
 20423*    MOVE '&2                    $   #00019162' TO DFHEIV0
 20424     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20425     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20426     MOVE X'2020233030303139313632' TO DFHEIV0(25:11)
 20427     CALL 'kxdfhei1' USING DFHEIV0,
 20428           PDEF-ID,
 20429           DFHEIV11,
 20430           DFHEIV99
 20431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20432     .
 20433 8589-EXIT.
 20434     EXIT.
 20435 8590-READ-CERT-MASTER.
 20436     IF PB-COMPANY-ID = 'UCL'
 20437         GO TO 8690-READ-CERT-MASTER-UCL.
 20438
 20439
 20440* EXEC CICS HANDLE CONDITION
 20441*         NOTFND    (0299-CERT-NOT-FOUND)
 20442*    END-EXEC.
 20443*    MOVE '"$I                   ! ; #00019172' TO DFHEIV0
 20444     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20446     MOVE X'3B20233030303139313732' TO DFHEIV0(25:11)
 20447     CALL 'kxdfhei1' USING DFHEIV0
 20448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20449
 20450
 20451
 20452* EXEC CICS READ
 20453*        DATASET     (CERT-ID)
 20454*        INTO        (CERTIFICATE-MASTER)
 20455*        RIDFLD      (ELCERT-KEY)
 20456*        UPDATE
 20457*    END-EXEC.
 20458     MOVE LENGTH OF
 20459      CERTIFICATE-MASTER
 20460       TO DFHEIV11
 20461*    MOVE '&"IL       EU         (   #00019176' TO DFHEIV0
 20462     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20463     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20464     MOVE X'2020233030303139313736' TO DFHEIV0(25:11)
 20465     CALL 'kxdfhei1' USING DFHEIV0,
 20466           CERT-ID,
 20467           CERTIFICATE-MASTER,
 20468           DFHEIV11,
 20469           ELCERT-KEY,
 20470           DFHEIV99,
 20471           DFHEIV99,
 20472           DFHEIV99
 20473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20474
 20475
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 379
* EL050.cbl
 20476 8590-EXIT.
 20477     EXIT.
 20478
 20479 8690-READ-CERT-MASTER-UCL.
 20480
 20481* EXEC CICS HANDLE CONDITION
 20482*         NOTFND    (8700-READ-CERT-MASTER)
 20483*    END-EXEC.
 20484*    MOVE '"$I                   ! < #00019187' TO DFHEIV0
 20485     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20487     MOVE X'3C20233030303139313837' TO DFHEIV0(25:11)
 20488     CALL 'kxdfhei1' USING DFHEIV0
 20489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20490
 20491
 20492 8690-READ-CERT-CONT.
 20493
 20494* EXEC CICS READ
 20495*        DATASET     (CERT-ID)
 20496*        INTO        (CERTIFICATE-MASTER)
 20497*        RIDFLD      (ELCERT-KEY)
 20498*        UPDATE
 20499*    END-EXEC.
 20500     MOVE LENGTH OF
 20501      CERTIFICATE-MASTER
 20502       TO DFHEIV11
 20503*    MOVE '&"IL       EU         (   #00019192' TO DFHEIV0
 20504     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20505     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20506     MOVE X'2020233030303139313932' TO DFHEIV0(25:11)
 20507     CALL 'kxdfhei1' USING DFHEIV0,
 20508           CERT-ID,
 20509           CERTIFICATE-MASTER,
 20510           DFHEIV11,
 20511           ELCERT-KEY,
 20512           DFHEIV99,
 20513           DFHEIV99,
 20514           DFHEIV99
 20515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20516
 20517
 20518     GO TO 8590-EXIT.
 20519
 20520 8700-READ-CERT-MASTER.
 20521     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20522     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20523
 20524* EXEC CICS HANDLE CONDITION
 20525*         DUPKEY    (8720-COMP-ACCOUNTS)
 20526*         ENDFILE   (8730-END-BROWSE)
 20527*         NOTFND    (8740-NOT-FOUND)
 20528*    END-EXEC.
 20529*    MOVE '"$$''I                 ! = #00019204' TO DFHEIV0
 20530     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20531     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20532     MOVE X'3D20233030303139323034' TO DFHEIV0(25:11)
 20533     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 380
* EL050.cbl
 20534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20535
 20536
 20537
 20538* EXEC CICS STARTBR
 20539*        DATASET     ('ELCERT5')
 20540*        RIDFLD      (ELCERT2-KEY)
 20541*        EQUAL
 20542*    END-EXEC.
 20543     MOVE 'ELCERT5' TO DFHEIV1
 20544     MOVE 0
 20545       TO DFHEIV11
 20546*    MOVE '&,         E          &   #00019210' TO DFHEIV0
 20547     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20548     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20549     MOVE X'2020233030303139323130' TO DFHEIV0(25:11)
 20550     CALL 'kxdfhei1' USING DFHEIV0,
 20551           DFHEIV1,
 20552           ELCERT2-KEY,
 20553           DFHEIV99,
 20554           DFHEIV11,
 20555           DFHEIV99
 20556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20557
 20558
 20559 8710-READ-NEXT.
 20560
 20561* EXEC CICS READNEXT
 20562*        DATASET     ('ELCERT5')
 20563*        INTO        (CERTIFICATE-MASTER)
 20564*        RIDFLD      (ELCERT2-KEY)
 20565*    END-EXEC.
 20566     MOVE LENGTH OF
 20567      CERTIFICATE-MASTER
 20568       TO DFHEIV12
 20569     MOVE 'ELCERT5' TO DFHEIV1
 20570     MOVE 0
 20571       TO DFHEIV11
 20572*    MOVE '&.IL                  )   #00019217' TO DFHEIV0
 20573     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20574     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20575     MOVE X'2020233030303139323137' TO DFHEIV0(25:11)
 20576     CALL 'kxdfhei1' USING DFHEIV0,
 20577           DFHEIV1,
 20578           CERTIFICATE-MASTER,
 20579           DFHEIV12,
 20580           ELCERT2-KEY,
 20581           DFHEIV99,
 20582           DFHEIV11,
 20583           DFHEIV99,
 20584           DFHEIV99
 20585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20586
 20587
 20588 8720-COMP-ACCOUNTS.
 20589
 20590* EXEC CICS ENTER
 20591*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 381
* EL050.cbl
 20592*         FROM (PB-C-LAST-NAME)
 20593*    END-EXEC.
 20594     MOVE 001
 20595       TO DFHEIV11
 20596*    MOVE ':$F                   %   #00019224' TO DFHEIV0
 20597     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20598     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20599     MOVE X'2020233030303139323234' TO DFHEIV0(25:11)
 20600     CALL 'kxdfhei1' USING DFHEIV0,
 20601           DFHEIV11,
 20602           PB-C-LAST-NAME,
 20603           DFHEIV99,
 20604           DFHEIV99
 20605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20606
 20607
 20608
 20609* EXEC CICS ENTER
 20610*         TRACEID (002)
 20611*         FROM (CM-INSURED-LAST-NAME)
 20612*    END-EXEC.
 20613     MOVE 002
 20614       TO DFHEIV11
 20615*    MOVE ':$F                   %   #00019229' TO DFHEIV0
 20616     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20617     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20618     MOVE X'2020233030303139323239' TO DFHEIV0(25:11)
 20619     CALL 'kxdfhei1' USING DFHEIV0,
 20620           DFHEIV11,
 20621           CM-INSURED-LAST-NAME,
 20622           DFHEIV99,
 20623           DFHEIV99
 20624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20625
 20626
 20627     IF PB-CERT-NO NOT = CM-CERT-NO
 20628         GO TO 8730-END-BROWSE.
 20629
 20630     IF PB-ACCOUNT = CM-ACCOUNT
 20631         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20632             MOVE ER-2799        TO WS-ERROR
 20633             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20634             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20635             GO TO 8730-END-BROWSE.
 20636
 20637     GO TO 8710-READ-NEXT.
 20638
 20639 8730-END-BROWSE.
 20640
 20641* EXEC CICS ENDBR
 20642*         DATASET    ('ELCERT5')
 20643*    END-EXEC.
 20644     MOVE 'ELCERT5' TO DFHEIV1
 20645     MOVE 0
 20646       TO DFHEIV11
 20647*    MOVE '&2                    $   #00019247' TO DFHEIV0
 20648     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20649     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 382
* EL050.cbl
 20650     MOVE X'2020233030303139323437' TO DFHEIV0(25:11)
 20651     CALL 'kxdfhei1' USING DFHEIV0,
 20652           DFHEIV1,
 20653           DFHEIV11,
 20654           DFHEIV99
 20655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20656
 20657
 20658 8740-NOT-FOUND.
 20659     GO TO 0299-CERT-NOT-FOUND.
 20660
 20661 8750-START-ELSTAT.
 20662
 20663* EXEC CICS STARTBR
 20664*       DATASET   (STAT-ID)
 20665*       RIDFLD    (ELSTAT-KEY)
 20666*       GTEQ
 20667*       RESP      (WS-RESPONSE)
 20668*    END-EXEC
 20669     MOVE 0
 20670       TO DFHEIV11
 20671*    MOVE '&,         G          &  N#00019255' TO DFHEIV0
 20672     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20673     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20674     MOVE X'204E233030303139323535' TO DFHEIV0(25:11)
 20675     CALL 'kxdfhei1' USING DFHEIV0,
 20676           STAT-ID,
 20677           ELSTAT-KEY,
 20678           DFHEIV99,
 20679           DFHEIV11,
 20680           DFHEIV99
 20681     MOVE EIBRESP  TO WS-RESPONSE
 20682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20683     IF WS-RESP-NORMAL
 20684        MOVE 'Y'                 TO STAT-MASTER-SW
 20685     ELSE
 20686        MOVE 'N'                 TO STAT-MASTER-SW
 20687     END-IF
 20688     .
 20689 8750-EXIT.
 20690     EXIT.
 20691 8752-READ-ELSTAT.
 20692
 20693* EXEC CICS READNEXT
 20694*       DATASET   (STAT-ID)
 20695*       RIDFLD    (ELSTAT-KEY)
 20696*       INTO      (STATE-FILE)
 20697*       RESP      (WS-RESPONSE)
 20698*    END-EXEC
 20699     MOVE LENGTH OF
 20700      STATE-FILE
 20701       TO DFHEIV12
 20702     MOVE 0
 20703       TO DFHEIV11
 20704*    MOVE '&.IL                  )  N#00019270' TO DFHEIV0
 20705     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20706     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20707     MOVE X'204E233030303139323730' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 383
* EL050.cbl
 20708     CALL 'kxdfhei1' USING DFHEIV0,
 20709           STAT-ID,
 20710           STATE-FILE,
 20711           DFHEIV12,
 20712           ELSTAT-KEY,
 20713           DFHEIV99,
 20714           DFHEIV11,
 20715           DFHEIV99,
 20716           DFHEIV99
 20717     MOVE EIBRESP  TO WS-RESPONSE
 20718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20719     IF WS-RESP-NORMAL
 20720        MOVE 'Y'                 TO STAT-MASTER-SW
 20721     ELSE
 20722        MOVE 'N'                 TO STAT-MASTER-SW
 20723     END-IF
 20724     .
 20725 8752-EXIT.
 20726     EXIT.
 20727 8800-GET-COMP-RATE.
 20728     MOVE +1 TO IB.
 20729     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20730         ADD +9 TO IB
 20731         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20732             ADD +9 TO IB
 20733             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20734                MOVE ZEROS       TO WS-WK-RATE
 20735                GO TO 8800-EXIT.
 20736
 20737     IF PB-I-AGE GREATER CT-AGE (1)
 20738         ADD +3 TO IB
 20739         IF PB-I-AGE GREATER CT-AGE (2)
 20740             ADD +3 TO IB
 20741             IF PB-I-AGE GREATER CT-AGE (3)
 20742                MOVE ZEROS       TO WS-WK-RATE
 20743                GO TO 8800-EXIT.
 20744
 20745     IF WS-WORK-TERM GREATER CT-TRM (1)
 20746         ADD +1 TO IB
 20747         IF WS-WORK-TERM GREATER CT-TRM (2)
 20748             ADD +1 TO IB
 20749             IF WS-WORK-TERM GREATER CT-TRM (3)
 20750                MOVE ZEROS       TO WS-WK-RATE
 20751                GO TO 8800-EXIT.
 20752
 20753     IF CT-RT (IB) NOT NUMERIC
 20754         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20755         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20756         GO TO 8800-GET-COMP-RATE.
 20757
 20758     MOVE CT-RT (IB) TO WS-WK-RATE.
 20759
 20760 8800-EXIT.
 20761     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 384
* EL050.cbl
 20763 8900-ADDRESS-FILE.
 20764     IF ERACCT-FILE-ADDRESSED
 20765         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20766         GO TO 8900-ADDRESS-EXIT.
 20767
 20768     IF ELCNTL-FILE-ADDRESSED
 20769         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20770         GO TO 8900-ADDRESS-EXIT.
 20771
 20772     IF ERPLAN-FILE-ADDRESSED
 20773         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20774         GO TO 8900-ADDRESS-EXIT.
 20775
 20776     IF ERFORM-FILE-ADDRESSED
 20777         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20778         GO TO 8900-ADDRESS-EXIT.
 20779
 20780 8900-ADDRESS-EXIT.
 20781     EXIT.
 20782
 20783 9000-READ-CONTROL.
 20784
 20785* EXEC CICS HANDLE CONDITION
 20786*        NOTFND    (9000-NOTFND)
 20787*    END-EXEC.
 20788*    MOVE '"$I                   ! > #00019341' TO DFHEIV0
 20789     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20791     MOVE X'3E20233030303139333431' TO DFHEIV0(25:11)
 20792     CALL 'kxdfhei1' USING DFHEIV0
 20793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20794
 20795
 20796
 20797* EXEC CICS READ
 20798*        DATASET     (CNTL-ID)
 20799*        SET         (ADDRESS OF CONTROL-FILE)
 20800*        RIDFLD      (ELCNTL-KEY)
 20801*        GTEQ
 20802*    END-EXEC.
 20803*    MOVE '&"S        G          (   #00019345' TO DFHEIV0
 20804     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20806     MOVE X'2020233030303139333435' TO DFHEIV0(25:11)
 20807     CALL 'kxdfhei1' USING DFHEIV0,
 20808           CNTL-ID,
 20809           DFHEIV20,
 20810           DFHEIV99,
 20811           ELCNTL-KEY,
 20812           DFHEIV99,
 20813           DFHEIV99,
 20814           DFHEIV99
 20815     SET ADDRESS OF CONTROL-FILE TO
 20816         DFHEIV20
 20817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20818
 20819
 20820     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 385
* EL050.cbl
 20821
 20822 9000-NOTFND.
 20823     IF RC-SW-1 = '1'
 20824        MOVE ER-2616              TO WS-ERROR
 20825        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20826        GO TO 9000-EXIT.
 20827
 20828     IF RC-SW-1 = '2'
 20829        MOVE ER-2602              TO WS-ERROR
 20830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20831
 20832 9000-EXIT.
 20833      EXIT.
 20834
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 386
* EL050.cbl
 20836 9100-READ-CONTROL.
 20837
 20838* EXEC CICS HANDLE CONDITION
 20839*        NOTFND  (9100-NOTFND)
 20840*        ENDFILE (9100-NOTFND)
 20841*    END-EXEC.
 20842*    MOVE '"$I''                  ! ? #00019369' TO DFHEIV0
 20843     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20845     MOVE X'3F20233030303139333639' TO DFHEIV0(25:11)
 20846     CALL 'kxdfhei1' USING DFHEIV0
 20847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20848
 20849
 20850
 20851* EXEC CICS READ
 20852*        DATASET     (CNTL-ID)
 20853*        INTO        (CONTROL-FILE)
 20854*        RIDFLD      (ELCNTL-KEY)
 20855*        GTEQ
 20856*    END-EXEC.
 20857     MOVE LENGTH OF
 20858      CONTROL-FILE
 20859       TO DFHEIV11
 20860*    MOVE '&"IL       G          (   #00019374' TO DFHEIV0
 20861     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20863     MOVE X'2020233030303139333734' TO DFHEIV0(25:11)
 20864     CALL 'kxdfhei1' USING DFHEIV0,
 20865           CNTL-ID,
 20866           CONTROL-FILE,
 20867           DFHEIV11,
 20868           ELCNTL-KEY,
 20869           DFHEIV99,
 20870           DFHEIV99,
 20871           DFHEIV99
 20872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20873
 20874
 20875     GO TO 9100-EXIT.
 20876
 20877 9100-NOTFND.
 20878     IF RC-SW-2 = '0'
 20879        MOVE '1'                  TO STATE-RECORD-ERROR
 20880        GO TO 9100-EXIT
 20881     END-IF
 20882     IF RC-SW-2 = '1'
 20883        MOVE '1'                  TO LF-BENEFIT-ERROR
 20884        MOVE ER-2604              TO WS-ERROR
 20885        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20886        GO TO 9100-EXIT.
 20887
 20888     IF RC-SW-2 = '2'
 20889        MOVE '1'                  TO AH-BENEFIT-ERROR
 20890        MOVE ER-2605              TO WS-ERROR
 20891        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20892        GO TO 9100-EXIT.
 20893
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 387
* EL050.cbl
 20894     IF RC-SW-2 = '3'
 20895         MOVE ER-2603           TO WS-ERROR
 20896         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20897         GO TO 9100-EXIT.
 20898
 20899     IF RC-SW-2 = '4'
 20900         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20901         GO TO 9100-EXIT.
 20902
 20903     IF RC-SW-2 = '5'
 20904         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20905         IF WS-AH-INPUT-CD-1 = SPACE
 20906             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20907         ELSE
 20908             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20909
 20910 9100-EXIT.
 20911      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 388
* EL050.cbl
 20913 9200-CONTROL-GETMAIN.
 20914
 20915* EXEC CICS GETMAIN
 20916*         LENGTH   (750)
 20917*         SET      (ADDRESS OF CONTROL-FILE)
 20918*    END-EXEC.
 20919     MOVE 750
 20920       TO DFHEIV11
 20921*    MOVE '," L                  $   #00019420' TO DFHEIV0
 20922     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20923     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20924     MOVE X'2020233030303139343230' TO DFHEIV0(25:11)
 20925     CALL 'kxdfhei1' USING DFHEIV0,
 20926           DFHEIV20,
 20927           DFHEIV11,
 20928           DFHEIV99
 20929     SET ADDRESS OF CONTROL-FILE TO
 20930         DFHEIV20
 20931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20932
 20933
 20934     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20935
 20936 9200-EXIT.
 20937     EXIT.
 20938
 20939 9250-UNLOCK-RETURN.
 20940
 20941* EXEC CICS UNLOCK
 20942*        DATASET   (CERT-ID)
 20943*    END-EXEC.
 20944*    MOVE '&*                    #   #00019431' TO DFHEIV0
 20945     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20946     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20947     MOVE X'2020233030303139343331' TO DFHEIV0(25:11)
 20948     CALL 'kxdfhei1' USING DFHEIV0,
 20949           CERT-ID,
 20950           DFHEIV99
 20951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20952
 20953
 20954 9300-ABEND.
 20955     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20956
 20957
 20958* EXEC CICS LINK
 20959*        PROGRAM   ('EL004')
 20960*        COMMAREA  (WS-ERROR-LINE)
 20961*        LENGTH    (72)
 20962*    END-EXEC.
 20963     MOVE 'EL004' TO DFHEIV1
 20964     MOVE 72
 20965       TO DFHEIV11
 20966*    MOVE '."C                   (   #00019438' TO DFHEIV0
 20967     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20969     MOVE X'2020233030303139343338' TO DFHEIV0(25:11)
 20970     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 389
* EL050.cbl
 20971           DFHEIV1,
 20972           WS-ERROR-LINE,
 20973           DFHEIV11,
 20974           DFHEIV99,
 20975           DFHEIV99,
 20976           DFHEIV99,
 20977           DFHEIV99
 20978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20979
 20980
 20981     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20982
 20983
 20984* EXEC CICS ABEND
 20985*        ABCODE ('EL50')
 20986*    END-EXEC.
 20987     MOVE 'EL50' TO DFHEIV5
 20988*    MOVE '.,A                   "   #00019446' TO DFHEIV0
 20989     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20990     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20991     MOVE X'2020233030303139343436' TO DFHEIV0(25:11)
 20992     CALL 'kxdfhei1' USING DFHEIV0,
 20993           DFHEIV5
 20994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20995
 20996
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 390
* EL050.cbl
 20998
 20999******************************************************************
 21000*                                                                *
 21001*            E R R O R   F O R M A T   R O U T I N E             *
 21002*                                                                *
 21003******************************************************************
 21004
 21005 9900-ERROR-FORMAT.
 21006
 21007     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21008                    PB-COMMON-ERROR (2) OR
 21009                    PB-COMMON-ERROR (3) OR
 21010                    PB-COMMON-ERROR (4) OR
 21011                    PB-COMMON-ERROR (5) OR
 21012                    PB-COMMON-ERROR (6) OR
 21013                    PB-COMMON-ERROR (7) OR
 21014                    PB-COMMON-ERROR (8) OR
 21015                    PB-COMMON-ERROR (9) OR
 21016                    PB-COMMON-ERROR (10)
 21017        GO TO 9900-EXIT.
 21018
 21019     IF PB-NO-OF-ERRORS = +10
 21020        GO TO 9900-EXIT.
 21021
 21022     ADD +1  TO PB-NO-OF-ERRORS.
 21023     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21024                                       (PB-NO-OF-ERRORS).
 21025 9900-EXIT.
 21026     EXIT.
 21027
 21028 9990-RETURN.
 21029     IF BROWSE-STARTED
 21030
 21031* EXEC CICS ENDBR
 21032*            DATASET  (ACCT-ID)
 21033*       END-EXEC.
 21034     MOVE 0
 21035       TO DFHEIV11
 21036*    MOVE '&2                    $   #00019483' TO DFHEIV0
 21037     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21038     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21039     MOVE X'2020233030303139343833' TO DFHEIV0(25:11)
 21040     CALL 'kxdfhei1' USING DFHEIV0,
 21041           ACCT-ID,
 21042           DFHEIV11,
 21043           DFHEIV99
 21044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21045
 21046
 21047 9990-EXIT.
 21048     EXIT.
 21049
 21050
 21051****Check for CRTO record, add one if not found.
 21052 9991-CHECK-FOR-ELCRTO.
 21053
 21054* EXEC CICS HANDLE CONDITION
 21055*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 391
* EL050.cbl
 21056*         ENDFILE (9991-CRTO-NOT-FOUND)
 21057*     END-EXEC.
 21058*    MOVE '"$I''                  ! @ #00019493' TO DFHEIV0
 21059     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21060     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21061     MOVE X'4020233030303139343933' TO DFHEIV0(25:11)
 21062     CALL 'kxdfhei1' USING DFHEIV0
 21063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21064
 21065     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21066     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21067     MOVE +0                     TO ELCRTO-SEQ-NO
 21068
 21069
 21070* EXEC CICS READ
 21071*       DATASET   ('ELCRTO')
 21072*       INTO      (ORIGINAL-CERTIFICATE)
 21073*       RIDFLD    (ELCRTO-KEY)
 21074*       GTEQ
 21075*       RESP      (WS-RESPONSE)
 21076*    END-EXEC
 21077     MOVE LENGTH OF
 21078      ORIGINAL-CERTIFICATE
 21079       TO DFHEIV11
 21080     MOVE 'ELCRTO' TO DFHEIV1
 21081*    MOVE '&"IL       G          (  N#00019501' TO DFHEIV0
 21082     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21083     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21084     MOVE X'204E233030303139353031' TO DFHEIV0(25:11)
 21085     CALL 'kxdfhei1' USING DFHEIV0,
 21086           DFHEIV1,
 21087           ORIGINAL-CERTIFICATE,
 21088           DFHEIV11,
 21089           ELCRTO-KEY,
 21090           DFHEIV99,
 21091           DFHEIV99,
 21092           DFHEIV99
 21093     MOVE EIBRESP  TO WS-RESPONSE
 21094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21095
 21096     IF WS-RESP-NORMAL
 21097        AND (OC-CONTROL-PRIMARY (1:33) =
 21098                 PB-CONTROL-BY-ACCOUNT (1:33))
 21099        AND (OC-RECORD-TYPE =  'I')
 21100           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21101               GO TO 9991-CHECK-INDICATORS
 21102           ELSE
 21103               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21104               GO TO 9991-CRTO-ADD-REC
 21105           END-IF
 21106     END-IF.
 21107
 21108 9991-CRTO-NOT-FOUND.
 21109
 21110     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21111     MOVE 'OC'                TO OC-RECORD-ID
 21112     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21113                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 392
* EL050.cbl
 21114     MOVE +4096               TO OC-KEY-SEQ-NO.
 21115
 21116 9991-CRTO-ADD-REC.
 21117
 21118     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21119     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21120     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21121     MOVE 'I'                 TO OC-RECORD-TYPE
 21122     IF PB-ISSUE
 21123         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21124         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21125         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21126         MOVE PB-I-AGE               TO OC-INS-AGE
 21127         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21128         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21129         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21130         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21131         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21132         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21133         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21134         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21135         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21136         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21137         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21138         IF PB-I-JOINT-COMMISSION > +0
 21139             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21140         ELSE
 21141             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21142         END-IF
 21143         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21144         MOVE +0                     TO OC-LF-CANCEL-AMT
 21145                                        OC-LF-ITD-CANCEL-AMT
 21146         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21147         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21148         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21149         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21150         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21151         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21152         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21153         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21154         MOVE +0                     TO OC-AH-CANCEL-AMT
 21155                                        OC-AH-ITD-CANCEL-AMT
 21156         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21157         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21158         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21159     ELSE
 21160         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21161         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21162         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21163         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21164         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21165         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21166         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21167         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21168         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21169          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21170             MOVE SPACES             TO OC-LF-BENCD
 21171             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 393
* EL050.cbl
 21172                                        OC-LF-BEN-AMT
 21173                                        OC-LF-PRM-AMT
 21174                                        OC-LF-ALT-BEN-AMT
 21175                                        OC-LF-ALT-PRM-AMT
 21176                                        OC-LF-COMM-PCT
 21177                                        OC-LF-CANCEL-AMT
 21178             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21179             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21180         ELSE
 21181             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21182             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21183             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21184             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21185             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21186             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21187             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21188             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21189             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21190             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21191         END-IF
 21192         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21193         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21194          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21195             MOVE SPACES             TO OC-AH-BENCD
 21196             MOVE ZEROS              TO OC-AH-TERM
 21197                                        OC-AH-BEN-AMT
 21198                                        OC-AH-PRM-AMT
 21199                                        OC-AH-COMM-PCT
 21200                                        OC-AH-CANCEL-AMT
 21201                                        OC-AH-CP
 21202             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21203             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21204         ELSE
 21205             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21206             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21207             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21208             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21209             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21210             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21211             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21212             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21213             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21214         END-IF
 21215         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21216         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21217         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21218         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21219     END-IF
 21220     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21221
 21222     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21223
 21224
 21225* EXEC CICS READ
 21226*         DATASET   (FILE-ERMAIL)
 21227*         RIDFLD    (MA-CONTROL-PRIMARY)
 21228*         INTO      (MAILING-DATA)
 21229*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 394
* EL050.cbl
 21230*    END-EXEC
 21231     MOVE LENGTH OF
 21232      MAILING-DATA
 21233       TO DFHEIV11
 21234*    MOVE '&"IL       E          (  N#00019637' TO DFHEIV0
 21235     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21236     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21237     MOVE X'204E233030303139363337' TO DFHEIV0(25:11)
 21238     CALL 'kxdfhei1' USING DFHEIV0,
 21239           FILE-ERMAIL,
 21240           MAILING-DATA,
 21241           DFHEIV11,
 21242           MA-CONTROL-PRIMARY,
 21243           DFHEIV99,
 21244           DFHEIV99,
 21245           DFHEIV99
 21246     MOVE EIBRESP  TO WS-RESPONSE
 21247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21248
 21249     IF WS-RESP-NORMAL
 21250         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21251     END-IF.
 21252
 21253     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21254     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21255
 21256
 21257* EXEC CICS READ
 21258*         DATASET  (CRTT-ID)
 21259*         RIDFLD   (WS-ELCRTT-KEY)
 21260*         INTO     (CERTIFICATE-TRAILERS)
 21261*         RESP     (WS-RESPONSE)
 21262*    END-EXEC
 21263     MOVE LENGTH OF
 21264      CERTIFICATE-TRAILERS
 21265       TO DFHEIV11
 21266*    MOVE '&"IL       E          (  N#00019651' TO DFHEIV0
 21267     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21269     MOVE X'204E233030303139363531' TO DFHEIV0(25:11)
 21270     CALL 'kxdfhei1' USING DFHEIV0,
 21271           CRTT-ID,
 21272           CERTIFICATE-TRAILERS,
 21273           DFHEIV11,
 21274           WS-ELCRTT-KEY,
 21275           DFHEIV99,
 21276           DFHEIV99,
 21277           DFHEIV99
 21278     MOVE EIBRESP  TO WS-RESPONSE
 21279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21280
 21281     IF WS-RESP-NORMAL
 21282         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21283         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21284     END-IF.
 21285
 21286
 21287* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 395
* EL050.cbl
 21288*       DATASET   ('ELCRTO')
 21289*       FROM      (ORIGINAL-CERTIFICATE)
 21290*       RIDFLD    (OC-CONTROL-PRIMARY)
 21291*       RESP      (WS-RESPONSE)
 21292*    END-EXEC.
 21293     MOVE LENGTH OF
 21294      ORIGINAL-CERTIFICATE
 21295       TO DFHEIV11
 21296     MOVE 'ELCRTO' TO DFHEIV1
 21297*    MOVE '&$ L                  ''  N#00019663' TO DFHEIV0
 21298     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21299     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21300     MOVE X'204E233030303139363633' TO DFHEIV0(25:11)
 21301     CALL 'kxdfhei1' USING DFHEIV0,
 21302           DFHEIV1,
 21303           ORIGINAL-CERTIFICATE,
 21304           DFHEIV11,
 21305           OC-CONTROL-PRIMARY,
 21306           DFHEIV99,
 21307           DFHEIV99
 21308     MOVE EIBRESP  TO WS-RESPONSE
 21309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21310
 21311
 21312     GO TO 9991-EXIT.
 21313
 21314 9991-CHECK-INDICATORS.
 21315
 21316     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21317         GO TO 9991-EXIT
 21318     END-IF.
 21319
 21320     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21321         GO TO 9991-EXIT
 21322     END-IF.
 21323
 21324
 21325* EXEC CICS READ
 21326*       DATASET   ('ELCRTO')
 21327*       INTO      (ORIGINAL-CERTIFICATE)
 21328*       RIDFLD    (OC-CONTROL-PRIMARY)
 21329*       UPDATE
 21330*       RESP      (WS-RESPONSE)
 21331*    END-EXEC
 21332     MOVE LENGTH OF
 21333      ORIGINAL-CERTIFICATE
 21334       TO DFHEIV11
 21335     MOVE 'ELCRTO' TO DFHEIV1
 21336*    MOVE '&"IL       EU         (  N#00019682' TO DFHEIV0
 21337     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21338     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21339     MOVE X'204E233030303139363832' TO DFHEIV0(25:11)
 21340     CALL 'kxdfhei1' USING DFHEIV0,
 21341           DFHEIV1,
 21342           ORIGINAL-CERTIFICATE,
 21343           DFHEIV11,
 21344           OC-CONTROL-PRIMARY,
 21345           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 396
* EL050.cbl
 21346           DFHEIV99,
 21347           DFHEIV99
 21348     MOVE EIBRESP  TO WS-RESPONSE
 21349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21350     IF WS-RESP-NORMAL
 21351        IF PB-ISSUE
 21352          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21353          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21354          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21355          MOVE PB-I-AGE               TO OC-INS-AGE
 21356          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21357          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21358          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21359          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21360          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21361          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21362          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21363          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21364          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21365          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21366          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21367          IF PB-I-JOINT-COMMISSION > +0
 21368              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21369          ELSE
 21370              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21371          END-IF
 21372          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21373          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21374          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21375          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21376          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21377          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21378          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21379          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21380          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21381
 21382          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21383
 21384* EXEC CICS READ
 21385*             DATASET   (FILE-ERMAIL)
 21386*             RIDFLD    (MA-CONTROL-PRIMARY)
 21387*             INTO      (MAILING-DATA)
 21388*             RESP      (WS-RESPONSE)
 21389*         END-EXEC
 21390     MOVE LENGTH OF
 21391      MAILING-DATA
 21392       TO DFHEIV11
 21393*    MOVE '&"IL       E          (  N#00019722' TO DFHEIV0
 21394     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21395     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21396     MOVE X'204E233030303139373232' TO DFHEIV0(25:11)
 21397     CALL 'kxdfhei1' USING DFHEIV0,
 21398           FILE-ERMAIL,
 21399           MAILING-DATA,
 21400           DFHEIV11,
 21401           MA-CONTROL-PRIMARY,
 21402           DFHEIV99,
 21403           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 397
* EL050.cbl
 21404           DFHEIV99
 21405     MOVE EIBRESP  TO WS-RESPONSE
 21406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21407          IF WS-RESP-NORMAL
 21408             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21409          END-IF
 21410
 21411          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21412          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21413
 21414* EXEC CICS READ
 21415*             DATASET  (CRTT-ID)
 21416*             RIDFLD   (WS-ELCRTT-KEY)
 21417*             INTO     (CERTIFICATE-TRAILERS)
 21418*             RESP     (WS-RESPONSE)
 21419*         END-EXEC
 21420     MOVE LENGTH OF
 21421      CERTIFICATE-TRAILERS
 21422       TO DFHEIV11
 21423*    MOVE '&"IL       E          (  N#00019734' TO DFHEIV0
 21424     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21425     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21426     MOVE X'204E233030303139373334' TO DFHEIV0(25:11)
 21427     CALL 'kxdfhei1' USING DFHEIV0,
 21428           CRTT-ID,
 21429           CERTIFICATE-TRAILERS,
 21430           DFHEIV11,
 21431           WS-ELCRTT-KEY,
 21432           DFHEIV99,
 21433           DFHEIV99,
 21434           DFHEIV99
 21435     MOVE EIBRESP  TO WS-RESPONSE
 21436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21437          IF WS-RESP-NORMAL
 21438             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21439                               OC-INS-AGE-DEFAULT-FLAG
 21440             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21441                               OC-JNT-AGE-DEFAULT-FLAG
 21442          END-IF
 21443
 21444        ELSE
 21445          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21446             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21447             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21448             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21449          END-IF
 21450          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21451             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21452             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21453             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21454          END-IF
 21455          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21456        END-IF
 21457
 21458* EXEC CICS REWRITE
 21459*          DATASET   ('ELCRTO')
 21460*          FROM      (ORIGINAL-CERTIFICATE)
 21461*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 398
* EL050.cbl
 21462*       END-EXEC
 21463     MOVE LENGTH OF
 21464      ORIGINAL-CERTIFICATE
 21465       TO DFHEIV11
 21466     MOVE 'ELCRTO' TO DFHEIV1
 21467*    MOVE '&& L                  %  N#00019760' TO DFHEIV0
 21468     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21469     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21470     MOVE X'204E233030303139373630' TO DFHEIV0(25:11)
 21471     CALL 'kxdfhei1' USING DFHEIV0,
 21472           DFHEIV1,
 21473           ORIGINAL-CERTIFICATE,
 21474           DFHEIV11,
 21475           DFHEIV99
 21476     MOVE EIBRESP  TO WS-RESPONSE
 21477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21478     END-IF.
 21479
 21480 9991-EXIT.
 21481     EXIT.
 21482
 21483
 21484 9999-RETURN.
 21485     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21486
 21487
 21488* EXEC CICS RETURN
 21489*    END-EXEC.
 21490*    MOVE '.(                    ''   #00019774' TO DFHEIV0
 21491     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21492     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21493     MOVE X'2020233030303139373734' TO DFHEIV0(25:11)
 21494     CALL 'kxdfhei1' USING DFHEIV0,
 21495           DFHEIV99,
 21496           DFHEIV99,
 21497           DFHEIV99,
 21498           DFHEIV99,
 21499           DFHEIV99,
 21500           DFHEIV99
 21501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21502
 21503
 21504
 21505* GOBACK.
 21506     MOVE '9%                    "   ' TO DFHEIV0
 21507     MOVE 'EL050' TO DFHEIV1
 21508     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21509     GOBACK.
 21510
 21511 9999-DFHBACK SECTION.
 21512     MOVE '9%                    "   ' TO DFHEIV0
 21513     MOVE 'EL050' TO DFHEIV1
 21514     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21515     GOBACK.
 21516 9999-DFHEXIT.
 21517     IF DFHEIGDJ EQUAL 0001
 21518         NEXT SENTENCE
 21519     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 399
* EL050.cbl
 21520         GO TO 9300-ABEND,
 21521               3990-FILES-NOT-OPEN
 21522         DEPENDING ON DFHEIGDI
 21523     ELSE IF DFHEIGDJ EQUAL 3
 21524         GO TO 6610-START-BROWSE,
 21525               6630-ERRESS-PROBLEM,
 21526               6630-END-OF-FILE
 21527         DEPENDING ON DFHEIGDI
 21528     ELSE IF DFHEIGDJ EQUAL 4
 21529         GO TO 6630-END-OF-FILE,
 21530               6630-ERRESS-PROBLEM,
 21531               6630-ERRESS-PROBLEM,
 21532               6630-END-OF-FILE
 21533         DEPENDING ON DFHEIGDI
 21534     ELSE IF DFHEIGDJ EQUAL 5
 21535         GO TO 6630-END-OF-FILE,
 21536               6630-END-OF-FILE,
 21537               6630-ERRESS-PROBLEM,
 21538               6630-ERRESS-PROBLEM
 21539         DEPENDING ON DFHEIGDI
 21540     ELSE IF DFHEIGDJ EQUAL 6
 21541         GO TO 6660-START-BROWSE,
 21542               6690-ERRESC-PROBLEM,
 21543               6690-ERRESC-PROBLEM,
 21544               6690-END-OF-FILE
 21545         DEPENDING ON DFHEIGDI
 21546     ELSE IF DFHEIGDJ EQUAL 7
 21547         GO TO 6690-END-OF-FILE,
 21548               6690-ERRESC-PROBLEM,
 21549               6690-ERRESC-PROBLEM,
 21550               6690-END-OF-FILE
 21551         DEPENDING ON DFHEIGDI
 21552     ELSE IF DFHEIGDJ EQUAL 8
 21553         GO TO 6690-END-OF-FILE,
 21554               6690-ERRESC-PROBLEM,
 21555               6690-ERRESC-PROBLEM,
 21556               6690-END-OF-FILE
 21557         DEPENDING ON DFHEIGDI
 21558     ELSE IF DFHEIGDJ EQUAL 9
 21559         GO TO 7250-CONTINUE,
 21560               7250-CONTINUE
 21561         DEPENDING ON DFHEIGDI
 21562     ELSE IF DFHEIGDJ EQUAL 10
 21563         GO TO 7300-CONTINUE,
 21564               7300-CONTINUE
 21565         DEPENDING ON DFHEIGDI
 21566     ELSE IF DFHEIGDJ EQUAL 11
 21567         GO TO 8000-FREE-MAIN
 21568         DEPENDING ON DFHEIGDI
 21569     ELSE IF DFHEIGDJ EQUAL 12
 21570         GO TO 8100-NOTFND,
 21571               8100-NOTFND
 21572         DEPENDING ON DFHEIGDI
 21573     ELSE IF DFHEIGDJ EQUAL 13
 21574         GO TO 8110-NOTFND,
 21575               8110-NOTFND
 21576         DEPENDING ON DFHEIGDI
 21577     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 400
* EL050.cbl
 21578         GO TO 8130-EXIT
 21579         DEPENDING ON DFHEIGDI
 21580     ELSE IF DFHEIGDJ EQUAL 15
 21581         GO TO 8180-NOTFND
 21582         DEPENDING ON DFHEIGDI
 21583     ELSE IF DFHEIGDJ EQUAL 16
 21584         GO TO 8190-NOTFND
 21585         DEPENDING ON DFHEIGDI
 21586     ELSE IF DFHEIGDJ EQUAL 17
 21587         GO TO 8195-NOTFND
 21588         DEPENDING ON DFHEIGDI
 21589     ELSE IF DFHEIGDJ EQUAL 18
 21590         GO TO 8200-NOTFND
 21591         DEPENDING ON DFHEIGDI
 21592     ELSE IF DFHEIGDJ EQUAL 19
 21593         GO TO 8300-NOTFND,
 21594               8300-ERRESS-PROBLEM,
 21595               8300-ERRESS-PROBLEM,
 21596               8300-NOTFND
 21597         DEPENDING ON DFHEIGDI
 21598     ELSE IF DFHEIGDJ EQUAL 20
 21599         GO TO 8450-FORM-NOT-FOUND,
 21600               8450-FORM-NOT-FOUND
 21601         DEPENDING ON DFHEIGDI
 21602     ELSE IF DFHEIGDJ EQUAL 21
 21603         GO TO 0199-ACCT-NOT-FOUND,
 21604               0199-ACCT-NOT-FOUND
 21605         DEPENDING ON DFHEIGDI
 21606     ELSE IF DFHEIGDJ EQUAL 22
 21607         GO TO 0199-ACCT-NOT-FOUND,
 21608               0199-ACCT-NOT-FOUND
 21609         DEPENDING ON DFHEIGDI
 21610     ELSE IF DFHEIGDJ EQUAL 23
 21611         GO TO 8582-COMP-NOT-FOUND,
 21612               8582-COMP-NOT-FOUND
 21613         DEPENDING ON DFHEIGDI
 21614     ELSE IF DFHEIGDJ EQUAL 24
 21615         GO TO 8583-AGTC-NOT-FOUND,
 21616               8583-AGTC-NOT-FOUND
 21617         DEPENDING ON DFHEIGDI
 21618     ELSE IF DFHEIGDJ EQUAL 25
 21619         GO TO 8584-BXRF-NOT-FOUND,
 21620               8584-BXRF-NOT-FOUND
 21621         DEPENDING ON DFHEIGDI
 21622     ELSE IF DFHEIGDJ EQUAL 26
 21623         GO TO 8585-PLAN-NOT-FOUND,
 21624               8585-PLAN-NOT-FOUND
 21625         DEPENDING ON DFHEIGDI
 21626     ELSE IF DFHEIGDJ EQUAL 27
 21627         GO TO 0299-CERT-NOT-FOUND
 21628         DEPENDING ON DFHEIGDI
 21629     ELSE IF DFHEIGDJ EQUAL 28
 21630         GO TO 8700-READ-CERT-MASTER
 21631         DEPENDING ON DFHEIGDI
 21632     ELSE IF DFHEIGDJ EQUAL 29
 21633         GO TO 8720-COMP-ACCOUNTS,
 21634               8730-END-BROWSE,
 21635               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 401
* EL050.cbl
 21636         DEPENDING ON DFHEIGDI
 21637     ELSE IF DFHEIGDJ EQUAL 30
 21638         GO TO 9000-NOTFND
 21639         DEPENDING ON DFHEIGDI
 21640     ELSE IF DFHEIGDJ EQUAL 31
 21641         GO TO 9100-NOTFND,
 21642               9100-NOTFND
 21643         DEPENDING ON DFHEIGDI
 21644     ELSE IF DFHEIGDJ EQUAL 32
 21645         GO TO 9991-CRTO-NOT-FOUND,
 21646               9991-CRTO-NOT-FOUND
 21647         DEPENDING ON DFHEIGDI.
 21648     MOVE '9%                    "   ' TO DFHEIV0
 21649     MOVE 'EL050' TO DFHEIV1
 21650     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21651     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39992     Code:       87455
