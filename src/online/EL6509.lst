* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   1
* EL6509.cbl
* Options: int("EL6509.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6509.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6509.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6509.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6509.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/06/95 08:37:08.
     7*                            VMOD=2.005.
     8*
     9*AUTHOR.           LOGIC,INC.
    10*                  DALLAS,TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   2
* EL6509.cbl
    14*            *                                                   *
    15*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22*
    23*REMARKS.     TRANSACTION - EXDA - ACCOUNT NOTE MAINTENANCE.
    24*
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    34*                              ADJUSTED REDEFINES EL6509AI FILLER
    35* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
    36*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
    37* 110209  CR2008092300001  AJRA  DELETE TEMP STORE ON INITIAL BUIL
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   3
* EL6509.cbl
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*     EL6509 WORKING STORAGE   *'.
    47 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.005 ***********'.
    48
    49*    COPY ELCSCTM.
    50******************************************************************
    51*                                                                *
    52*                                                                *
    53*                            ELCSCTM                             *
    54*                            VMOD=2.001                          *
    55*                                                                *
    56*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    57*                                                                *
    58******************************************************************
    59 01  SECURITY-MESSAGE.
    60     12  FILLER                          PIC X(30)
    61            VALUE '** LOGIC SECURITY VIOLATION -'.
    62     12  SM-READ                         PIC X(6).
    63     12  FILLER                          PIC X(5)
    64            VALUE ' PGM='.
    65     12  SM-PGM                          PIC X(6).
    66     12  FILLER                          PIC X(5)
    67            VALUE ' OPR='.
    68     12  SM-PROCESSOR-ID                 PIC X(4).
    69     12  FILLER                          PIC X(6)
    70            VALUE ' TERM='.
    71     12  SM-TERMID                       PIC X(4).
    72     12  FILLER                          PIC XX   VALUE SPACE.
    73     12  SM-JUL-DATE                     PIC 9(5).
    74     12  FILLER                          PIC X    VALUE SPACE.
    75     12  SM-TIME                         PIC 99.99.
    76
    77*    COPY ELCSCRTY.
    78******************************************************************
    79*                                                                *
    80*                                                                *
    81*                            ELCSCRTY                            *
    82*                            VMOD=2.001                          *
    83*                                                                *
    84*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    85*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    86*        SAVED IN PI-SECURITY-ADDRESS.                           *
    87*                                                                *
    88******************************************************************
    89 01  SECURITY-CONTROL.
    90     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    91     12  FILLER                       PIC XX    VALUE 'SC'.
    92     12  SC-CREDIT-CODES.
    93         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    94             20  SC-CREDIT-DISPLAY    PIC X.
    95             20  SC-CREDIT-UPDATE     PIC X.
    96     12  SC-CLAIMS-CODES.
    97         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    98             20  SC-CLAIMS-DISPLAY    PIC X.
    99             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   4
* EL6509.cbl
   100
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   5
* EL6509.cbl
   102 01  STANDARD-AREAS.
   103     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   104     12  MAP-NAME                PIC X(8)    VALUE 'EL6509A'.
   105     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6509S '.
   106     12  SCRN-NUMBER             PIC X(4)    VALUE '650I'.
   107     12  TRANS-ID                PIC X(4)    VALUE 'EXDA'.
   108     12  W-PRINT-TRANS           PIC X(4)    VALUE 'EXDB'.
   109     12  THIS-PGM                PIC X(8)    VALUE 'EL6509'.
   110     12  PGM-NAME                PIC X(8).
   111     12  PGM-EL650               PIC X(8)    VALUE 'EL650'.
   112
   113     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   114     12  ELCNTL-FILE-ID          PIC X(8)    VALUE 'ELCNTL'.
   115     12  QID.
   116         16  QID-TERM            PIC X(4).
   117         16  FILLER              PIC X(4)    VALUE '650I'.
   118     12  QID-ITEM                PIC S9(4)   COMP VALUE +0.
   119     12  SC-ITEM                 PIC S9(4)   COMP VALUE +1.
   120
   121 01  WORK-AREA.
   122     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   123     12  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   124
   125     12  FN-CONVERT              PIC XX.
   126     12  FN-BIN REDEFINES FN-CONVERT  PIC S9(4)  COMP.
   127
   128     12  ERACNT-LENGTH           PIC S9(4)   COMP VALUE +120.
   129     12  ERACNT-KEY-LENGTH       PIC S9(4)   COMP VALUE +23.
   130     12  ERACNT-START-LENGTH     PIC S9(4)   COMP VALUE +21.
   131     12  ERACNT-KEY.
   132         16  ERACNT-PARTIAL-KEY.
   133             20 ERACNT-COMPANY-CD    PIC X.
   134             20 ERACNT-CARRIER       PIC X.
   135             20 ERACNT-GROUPING      PIC X(06).
   136             20 ERACNT-STATE         PIC XX.
   137             20 ERACNT-ACCOUNT       PIC X(10).
   138             20 ERACNT-REC-TYP       PIC X.
   139         16 ERACNT-SEQ           PIC S9(4) COMP.
   140     12  SV-PRIOR-KEY.
   141         20 SV-COMPANY-CD            PIC X.
   142         20 SV-CARRIER               PIC X.
   143         20 SV-GROUPING              PIC X(06).
   144         20 SV-STATE                 PIC XX.
   145         20 SV-ACCOUNT               PIC X(10).
   146         20 SV-REC-TYP               PIC X.
   147         20 SV-SEQ                   PIC S9(4) COMP.
   148     12  W-START-BR              PIC X       VALUE SPACES.
   149     12  VG-CNTL-KEY.
   150         20 VG-CARRIER               PIC X.
   151         20 VG-GROUPING              PIC X(06).
   152         20 VG-STATE                 PIC XX.
   153         20 VG-ACCOUNT               PIC X(10).
   154     12  W-WORK-CONT.
   155         16  W-WORK-PRIME        PIC X(14)   VALUE SPACES.
   156         16  FILLER              PIC X       VALUE '-'.
   157         16  W-WORK-SFX          PIC X       VALUE SPACES.
   158     12  ELCNTL-KEY.
   159         16  ELCNTL-COMPANY      PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   6
* EL6509.cbl
   160         16  ELCNTL-REC-TYPE     PIC X.
   161         16  FILLER              PIC X(4).
   162         16  ELCNTL-SEQ-NO       PIC S9(4)   COMP.
   163     12  TIME-IN                 PIC S9(7).
   164     12  TIME-SPLIT REDEFINES TIME-IN.
   165         16  FILLER              PIC X.
   166         16  TIME-OUT            PIC 99V99.
   167         16  FILLER              PIC 9(2).
   168     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   169     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   170     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   171     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   172     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   173     12  MAX-LINES               PIC 999     VALUE 300.
   174     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 12.
   175     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   176     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0  COMP-3.
   177     12  TS-LENGTH               PIC S9(4)   VALUE +3600 COMP.
   178     12  ROLL-COUNTER            PIC S999    VALUE +0 COMP-3.
   179     12  TEMP-CURR-LINE          PIC S9(3)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   7
* EL6509.cbl
   181 01  ERROR-MESSAGES.
   182     12  ER-0000             PIC X(04)       VALUE '0000'.
   183     12  ER-0004             PIC X(04)       VALUE '0004'.
   184     12  ER-0006             PIC X(04)       VALUE '0006'.
   185     12  ER-0008             PIC X(04)       VALUE '0008'.
   186     12  ER-0023             PIC X(04)       VALUE '0023'.
   187     12  ER-0029             PIC X(04)       VALUE '0029'.
   188     12  ER-0030             PIC X(04)       VALUE '0030'.
   189     12  ER-0031             PIC X(04)       VALUE '0031'.
   190     12  ER-0032             PIC X(04)       VALUE '0032'.
   191     12  ER-0033             PIC X(04)       VALUE '0033'.
   192     12  ER-0041             PIC X(04)       VALUE '0041'.
   193     12  ER-0044             PIC X(04)       VALUE '0044'.
   194     12  ER-0045             PIC X(04)       VALUE '0045'.
   195     12  ER-0047             PIC X(04)       VALUE '0047'.
   196     12  ER-0048             PIC X(04)       VALUE '0048'.
   197     12  ER-0049             PIC X(04)       VALUE '0049'.
   198     12  ER-0050             PIC X(04)       VALUE '0050'.
   199     12  ER-0051             PIC X(04)       VALUE '0051'.
   200     12  ER-0066             PIC X(04)       VALUE '0066'.
   201     12  ER-0067             PIC X(04)       VALUE '0067'.
   202     12  ER-0069             PIC X(04)       VALUE '0069'.
   203     12  ER-0070             PIC X(04)       VALUE '0070'.
   204     12  ER-0140             PIC X(04)       VALUE '0140'.
   205     12  ER-0412             PIC X(04)       VALUE '0412'.
   206     12  ER-0413             PIC X(04)       VALUE '0413'.
   207     12  ER-3784             PIC X(04)       VALUE '3784'.
   208     12  ER-3786             PIC X(04)       VALUE '3786'.
   209     12  ER-3787             PIC X(04)       VALUE '3787'.
   210     12  ER-3788             PIC X(04)       VALUE '3788'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   8
* EL6509.cbl
   212*                       COPY ELCLOGOF.
   213******************************************************************
   214*                                                                *
   215*                                                                *
   216*                            ELCLOGOF.                           *
   217*                            VMOD=2.001                          *
   218*                                                                *
   219*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   220*                                                                *
   221******************************************************************
   222 01  CLASIC-LOGOFF.
   223     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   224     12  LOGOFF-TEXT.
   225         16  FILLER          PIC X(5)    VALUE SPACES.
   226         16  LOGOFF-MSG.
   227             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   228             20  FILLER      PIC X       VALUE SPACES.
   229             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   230         16  FILLER          PIC X(80)
   231           VALUE '* YOU ARE NOW LOGGED OFF'.
   232         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   233         16  FILLER          PIC X       VALUE QUOTE.
   234         16  LOGOFF-SYS-MSG  PIC X(17)
   235           VALUE 'S CLAS-IC SYSTEM '.
   236     12  TEXT-MESSAGES.
   237         16  UNACCESS-MSG    PIC X(29)
   238             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   239         16  PGMIDERR-MSG    PIC X(17)
   240             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   9
* EL6509.cbl
   242*                       COPY ELCAID.
   243******************************************************************
   244*                                                                *
   245*                            ELCAID.                             *
   246*                            VMOD=2.001                          *
   247*                                                                *
   248*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   249*                                                                *
   250*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   251*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   252******************************************************************
   253
   254 01  DFHAID.
   255   02  DFHNULL   PIC  X  VALUE  ' '.
   256   02  DFHENTER  PIC  X  VALUE  QUOTE.
   257   02  DFHCLEAR  PIC  X  VALUE  '_'.
   258   02  DFHPEN    PIC  X  VALUE  '='.
   259   02  DFHOPID   PIC  X  VALUE  'W'.
   260   02  DFHPA1    PIC  X  VALUE  '%'.
   261   02  DFHPA2    PIC  X  VALUE  '>'.
   262   02  DFHPA3    PIC  X  VALUE  ','.
   263   02  DFHPF1    PIC  X  VALUE  '1'.
   264   02  DFHPF2    PIC  X  VALUE  '2'.
   265   02  DFHPF3    PIC  X  VALUE  '3'.
   266   02  DFHPF4    PIC  X  VALUE  '4'.
   267   02  DFHPF5    PIC  X  VALUE  '5'.
   268   02  DFHPF6    PIC  X  VALUE  '6'.
   269   02  DFHPF7    PIC  X  VALUE  '7'.
   270   02  DFHPF8    PIC  X  VALUE  '8'.
   271   02  DFHPF9    PIC  X  VALUE  '9'.
   272   02  DFHPF10   PIC  X  VALUE  ':'.
   273   02  DFHPF11   PIC  X  VALUE  '#'.
   274   02  DFHPF12   PIC  X  VALUE  '@'.
   275   02  DFHPF13   PIC  X  VALUE  'A'.
   276   02  DFHPF14   PIC  X  VALUE  'B'.
   277   02  DFHPF15   PIC  X  VALUE  'C'.
   278   02  DFHPF16   PIC  X  VALUE  'D'.
   279   02  DFHPF17   PIC  X  VALUE  'E'.
   280   02  DFHPF18   PIC  X  VALUE  'F'.
   281   02  DFHPF19   PIC  X  VALUE  'G'.
   282   02  DFHPF20   PIC  X  VALUE  'H'.
   283   02  DFHPF21   PIC  X  VALUE  'I'.
   284*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   285   02  DFHPF22   PIC  X  VALUE  '['.
   286   02  DFHPF23   PIC  X  VALUE  '.'.
   287   02  DFHPF24   PIC  X  VALUE  '<'.
   288   02  DFHMSRE   PIC  X  VALUE  'X'.
   289   02  DFHSTRF   PIC  X  VALUE  'h'.
   290   02  DFHTRIG   PIC  X  VALUE  '"'.
   291 01  FILLER  REDEFINES DFHAID.
   292     12  FILLER                  PIC X(8).
   293     12  PF-VALUES OCCURS 24 TIMES       PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  10
* EL6509.cbl
   295*                       COPY ELCEMIB.
   296******************************************************************
   297*                                                                *
   298*                                                                *
   299*                            ELCEMIB.                            *
   300*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   301*                            VMOD=2.005                          *
   302*                                                                *
   303*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   304*                                                                *
   305******************************************************************
   306 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   307     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   308     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   309     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   310     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   311     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   312     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   313     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   314     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   315     12  EMI-SWITCH1             PIC X        VALUE '1'.
   316         88  EMI-NO-ERRORS                    VALUE '1'.
   317         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   318         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   319     12  EMI-SWITCH2             PIC X        VALUE '1'.
   320         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   321     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   322         88  EMI-AREA1-EMPTY                  VALUE '1'.
   323         88  EMI-AREA1-FULL                   VALUE '2'.
   324     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   325         88  EMI-AREA2-EMPTY                  VALUE '1'.
   326         88  EMI-AREA2-FULL                   VALUE '2'.
   327     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   328         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   329         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   330         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   331         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   332         88  EMI-BYPASS-FATALS                VALUE 'X'.
   333     12  EMI-ERROR-LINES.
   334         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   335         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   336         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   337         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   338             20  EMI-ERR-CODES OCCURS 10 TIMES.
   339                 24  EMI-ERR-NUM         PIC X(4).
   340                 24  EMI-FILLER          PIC X.
   341                 24  EMI-SEV             PIC X.
   342                 24  FILLER              PIC X.
   343             20  FILLER                  PIC X(02).
   344     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   345         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   346             20  EMI-ERROR-NUMBER    PIC X(4).
   347             20  EMI-FILL            PIC X.
   348             20  EMI-SEVERITY        PIC X.
   349             20  FILLER              PIC X.
   350             20  EMI-ERROR-TEXT.
   351                 24  EMI-TEXT-VARIABLE   PIC X(10).
   352                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  11
* EL6509.cbl
   353     12  EMI-SEVERITY-SAVE           PIC X.
   354         88  EMI-NOTE                    VALUE 'N'.
   355         88  EMI-WARNING                 VALUE 'W'.
   356         88  EMI-FORCABLE                VALUE 'F'.
   357         88  EMI-FATAL                   VALUE 'X'.
   358     12  EMI-MESSAGE-FLAG            PIC X.
   359         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   360         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   361     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   362     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   363         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   364         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   365         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   366     12  emi-claim-no                pic x(7).
   367     12  emi-claim-type              pic x(6).
   368     12  FILLER                      PIC X(124)  VALUE SPACES.
   369     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   370     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   371     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   372     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  12
* EL6509.cbl
   374*                       COPY ELCINTF.
   375******************************************************************
   376*                                                                *
   377*                                                                *
   378*                            ELCINTF.                            *
   379*                            VMOD=2.017                          *
   380*                                                                *
   381*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   382*                                                                *
   383*       LENGTH = 1024                                            *
   384*                                                                *
   385******************************************************************
   386*                   C H A N G E   L O G
   387*
   388* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   389*-----------------------------------------------------------------
   390*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   391* EFFECTIVE    NUMBER
   392*-----------------------------------------------------------------
   393* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   394******************************************************************
   395 01  PROGRAM-INTERFACE-BLOCK.
   396     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   397     12  PI-CALLING-PROGRAM              PIC X(8).
   398     12  PI-SAVED-PROGRAM-1              PIC X(8).
   399     12  PI-SAVED-PROGRAM-2              PIC X(8).
   400     12  PI-SAVED-PROGRAM-3              PIC X(8).
   401     12  PI-SAVED-PROGRAM-4              PIC X(8).
   402     12  PI-SAVED-PROGRAM-5              PIC X(8).
   403     12  PI-SAVED-PROGRAM-6              PIC X(8).
   404     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   405     12  PI-COMPANY-ID                   PIC XXX.
   406     12  PI-COMPANY-CD                   PIC X.
   407
   408     12  PI-COMPANY-PASSWORD             PIC X(8).
   409
   410     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   411
   412     12  PI-CONTROL-IN-PROGRESS.
   413         16  PI-CARRIER                  PIC X.
   414         16  PI-GROUPING                 PIC X(6).
   415         16  PI-STATE                    PIC XX.
   416         16  PI-ACCOUNT                  PIC X(10).
   417         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   418                                         PIC X(10).
   419         16  PI-CLAIM-CERT-GRP.
   420             20  PI-CLAIM-NO             PIC X(7).
   421             20  PI-CERT-NO.
   422                 25  PI-CERT-PRIME       PIC X(10).
   423                 25  PI-CERT-SFX         PIC X.
   424             20  PI-CERT-EFF-DT          PIC XX.
   425         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   426             20  PI-PLAN-CODE            PIC X(2).
   427             20  PI-REVISION-NUMBER      PIC X(3).
   428             20  PI-PLAN-EFF-DT          PIC X(2).
   429             20  PI-PLAN-EXP-DT          PIC X(2).
   430             20  FILLER                  PIC X(11).
   431         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  13
* EL6509.cbl
   432             20  PI-OE-REFERENCE-1.
   433                 25  PI-OE-REF-1-PRIME   PIC X(18).
   434                 25  PI-OE-REF-1-SUFF    PIC XX.
   435
   436     12  PI-SESSION-IN-PROGRESS          PIC X.
   437         88  CLAIM-SESSION                   VALUE '1'.
   438         88  CREDIT-SESSION                  VALUE '2'.
   439         88  WARRANTY-SESSION                VALUE '3'.
   440         88  MORTGAGE-SESSION                VALUE '4'.
   441         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   442
   443
   444*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   445
   446     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   447     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   448
   449     12  PI-CREDIT-USER                  PIC X.
   450         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   451         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   452
   453     12  PI-CLAIM-USER                   PIC X.
   454         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   455         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   456
   457     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   458         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   459         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   460         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   461         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   462         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   463
   464     12  PI-PROCESSOR-ID                 PIC X(4).
   465
   466     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   467
   468     12  PI-MEMBER-CAPTION               PIC X(10).
   469
   470     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   471         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   472
   473     12  PI-LIFE-OVERRIDE-L1             PIC X.
   474     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   475     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   476     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   477
   478     12  PI-AH-OVERRIDE-L1               PIC X.
   479     12  PI-AH-OVERRIDE-L2               PIC XX.
   480     12  PI-AH-OVERRIDE-L6               PIC X(6).
   481     12  PI-AH-OVERRIDE-L12              PIC X(12).
   482
   483     12  PI-NEW-SYSTEM                   PIC X(2).
   484
   485     12  PI-PRIMARY-CERT-NO              PIC X(11).
   486     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   487         88  PI-USES-PAID-TO                 VALUE '1'.
   488     12  PI-CRDTCRD-SYSTEM.
   489         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  14
* EL6509.cbl
   490             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   491             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   492         16  PI-CC-MONTH-END-DT          PIC XX.
   493     12  PI-PROCESSOR-PRINTER            PIC X(4).
   494
   495     12  PI-OE-REFERENCE-2.
   496         16  PI-OE-REF-2-PRIME           PIC X(10).
   497         16  PI-OE-REF-2-SUFF            PIC X.
   498
   499     12  PI-REM-TRM-CALC-OPTION          PIC X.
   500
   501     12  PI-LANGUAGE-TYPE                PIC X.
   502             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   503             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   504             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   505
   506     12  PI-POLICY-LINKAGE-IND           PIC X.
   507         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   508         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   509                                                   LOW-VALUES.
   510
   511     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   512     12  PI-CLAIM-PW-SESSION             PIC X(1).
   513         88  PI-CLAIM-CREDIT                 VALUE '1'.
   514         88  PI-CLAIM-CONVEN                 VALUE '2'.
   515
   516     12  PI-PROCESSOR-CSR-IND            PIC X.
   517         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   518         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   519
   520     12  FILLER                          PIC X(3).
   521
   522     12  PI-SYSTEM-LEVEL                 PIC X(145).
   523
   524     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   525         PI-SYSTEM-LEVEL.
   526
   527         16  PI-ENTRY-CODES.
   528             20  PI-ENTRY-CD-1           PIC X.
   529             20  PI-ENTRY-CD-2           PIC X.
   530
   531         16  PI-RETURN-CODES.
   532             20  PI-RETURN-CD-1          PIC X.
   533             20  PI-RETURN-CD-2          PIC X.
   534
   535         16  PI-UPDATE-STATUS-SAVE.
   536             20  PI-UPDATE-BY            PIC X(4).
   537             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   538
   539         16  PI-LOWER-CASE-LETTERS       PIC X.
   540             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   541
   542*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   543*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   544*            88  CARRIER-CLM-CNTL            VALUE '2'.
   545
   546         16  PI-CERT-ACCESS-CONTROL      PIC X.
   547             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  15
* EL6509.cbl
   548             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   549             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   550             88  ACCNT-CNTL                  VALUE '3'.
   551             88  CARR-ACCNT-CNTL             VALUE '4'.
   552
   553         16  PI-PROCESSOR-CAP-LIST.
   554             20  PI-SYSTEM-CONTROLS.
   555                24 PI-SYSTEM-DISPLAY     PIC X.
   556                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   557                24 PI-SYSTEM-MODIFY      PIC X.
   558                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   559             20  FILLER                  PIC XX.
   560             20  PI-DISPLAY-CAP          PIC X.
   561                 88  DISPLAY-CAP             VALUE 'Y'.
   562             20  PI-MODIFY-CAP           PIC X.
   563                 88  MODIFY-CAP              VALUE 'Y'.
   564             20  PI-MSG-AT-LOGON-CAP     PIC X.
   565                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   566             20  PI-FORCE-CAP            PIC X.
   567                 88  FORCE-CAP               VALUE 'Y'.
   568
   569         16  PI-PROGRAM-CONTROLS.
   570             20  PI-PGM-PRINT-OPT        PIC X.
   571             20  PI-PGM-FORMAT-OPT       PIC X.
   572             20  PI-PGM-PROCESS-OPT      PIC X.
   573             20  PI-PGM-TOTALS-OPT       PIC X.
   574
   575         16  PI-HELP-INTERFACE.
   576             20  PI-LAST-ERROR-NO        PIC X(4).
   577             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   578
   579         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   580             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   581
   582         16  PI-CR-CONTROL-IN-PROGRESS.
   583             20  PI-CR-CARRIER           PIC X.
   584             20  PI-CR-GROUPING          PIC X(6).
   585             20  PI-CR-STATE             PIC XX.
   586             20  PI-CR-ACCOUNT           PIC X(10).
   587             20  PI-CR-FIN-RESP          PIC X(10).
   588             20  PI-CR-TYPE              PIC X.
   589
   590         16  PI-CR-BATCH-NUMBER          PIC X(6).
   591
   592         16  PI-CR-MONTH-END-DT          PIC XX.
   593
   594         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   595             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   596             88  PI-ZERO-CARRIER             VALUE '1'.
   597             88  PI-ZERO-GROUPING            VALUE '2'.
   598             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   599
   600         16  PI-CARRIER-SECURITY         PIC X.
   601             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   602
   603         16  PI-ACCOUNT-SECURITY         PIC X(10).
   604             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   605             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  16
* EL6509.cbl
   606
   607         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   608             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   609                                         INDEXED BY PI-ACCESS-NDX
   610                                         PIC X.
   611
   612         16  PI-GA-BILLING-CONTROL       PIC X.
   613             88  PI-GA-BILLING               VALUE '1'.
   614
   615         16  PI-MAIL-PROCESSING          PIC X.
   616             88  PI-MAIL-YES                 VALUE 'Y'.
   617
   618         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   619
   620         16  PI-AR-SYSTEM.
   621             20  PI-AR-PROCESSING-CNTL   PIC X.
   622                 88  PI-AR-PROCESSING        VALUE 'Y'.
   623             20  PI-AR-SUMMARY-CODE      PIC X(6).
   624             20  PI-AR-MONTH-END-DT      PIC XX.
   625
   626         16  PI-MP-SYSTEM.
   627             20  PI-MORTGAGE-USER            PIC X.
   628                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   629                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   630             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   631                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   632                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   633                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   634                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   635                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   636             20  PI-MP-MONTH-END-DT          PIC XX.
   637             20  PI-MP-REFERENCE-NO.
   638                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   639                 24  PI-MP-REFERENCE-SFX     PIC XX.
   640
   641         16  PI-LABEL-CONTROL            PIC X(01).
   642             88  PI-CREATE-LABELS                    VALUE 'Y'.
   643             88  PI-BYPASS-LABELS                    VALUE 'N'.
   644
   645         16  PI-BILL-GROUPING-CODE       PIC X(01).
   646             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   647
   648         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   649             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   650             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   651
   652         16  FILLER                      PIC X(14).
   653
   654     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   655******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  17
* EL6509.cbl
   657*                       COPY ELC650PI.
   658******************************************************************
   659*
   660*                            ELC650PI.
   661*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   662*                            VMOD=2.007
   663*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
   664*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
   665* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
   666*
   667******************************************************************
   668******************************************************************
   669*                   C H A N G E   L O G
   670*
   671* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   672*-----------------------------------------------------------------
   673*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   674* EFFECTIVE    NUMBER
   675*-----------------------------------------------------------------
   676* 101916  IR2016101900001  PEMA  Inc tot line to 3 bytes
   677
   678     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   679         16  PI-MAINT                   PIC X.
   680         16  PI-PREV-ACCOUNT            PIC X(20).
   681         16  PI-PREV-VG-ACCOUNT         PIC X(20).
   682         16  PI-ACCT-KEY.
   683             20  PI-ACCT-CCGSA-KEY.
   684                 24  PI-ACCT-CO             PIC X.
   685                 24  PI-ACCT-CARRIER        PIC X.
   686                 24  PI-ACCT-GROUPING       PIC X(6).
   687                 24  PI-ACCT-STATE          PIC XX.
   688                 24  PI-ACCT-ACCOUNT        PIC X(10).
   689             20  PI-ACCT-EXP-DT           PIC XX.
   690             20  PI-ACCT-REST-OF-EXP      PIC X(4).
   691         16  PI-ACCT-ID                 PIC X(8).
   692         16  PI-PLAN-KEY.
   693             20  PI-PLAN-ACCT-KEY.
   694                 24  PI-PLAN-COMPANY-CD PIC X.
   695                 24  PI-PLAN-CARRIER    PIC X.
   696                 24  PI-PLAN-GROUP      PIC X(6).
   697                 24  PI-PLAN-STATE      PIC X(2).
   698                 24  PI-PLAN-ACCOUNT    PIC X(10).
   699             20  PI-PLAN-BEN-TYPE       PIC X.
   700             20  PI-PLAN-BEN            PIC XX.
   701             20  PI-PLAN-REVISION       PIC X(3).
   702         16  PI-WS-STATE                PIC XX.
   703         16  PI-WS-CLASS                PIC XX.
   704         16  PI-WS-DEV                  PIC X(3).
   705         16  PI-WS-TYPE                 PIC X.
   706         16  PI-WS-PLAN                 PIC XX.
   707
   708         16  PI-ERPNDB-ALT-KEY.
   709             20  PI-PB-COMPANY-CD-A1    PIC X.
   710             20  PI-PB-CARRIER          PIC X.
   711             20  PI-PB-GROUPING         PIC X(6).
   712             20  PI-PB-STATE            PIC XX.
   713             20  PI-PB-ACCOUNT          PIC X(10).
   714             20  PI-PB-CERT-EFF-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  18
* EL6509.cbl
   715             20  PI-PB-CERT-NO          PIC X(10).
   716             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
   717             20  PI-PB-RECORD-TYPE      PIC X.
   718
   719         16  PI-DATE-RANGE-TABLE.
   720             20  PI-TABLE-ENT OCCURS 32 TIMES
   721                            INDEXED BY T-INDEX.
   722                 24  PI-BIN-EFF-DT          PIC XX.
   723                 24  PI-BIN-EXP-DT          PIC XX.
   724                 24  PI-BIN-MAINT-DT        PIC XX.
   725                 24  PI-BIN-LO-CERT         PIC XX.
   726                 24  PI-BIN-AR-HI-CERT      PIC XX.
   727                 24  PI-BIN-HI-CERT         PIC XX.
   728         16  PI-PAGE-NUMBER             PIC S9.
   729             88  PI-FST-PAGE               VALUE +1.
   730             88  PI-2ND-PAGE               VALUE +2.
   731             88  PI-3RD-PAGE               VALUE +3.
   732             88  PI-LST-PAGE               VALUE +4.
   733         16  PI-TOTAL-LINES             PIC S999.
   734         16  PI-LINE-SELECTED    PIC S9.
   735***  Y2K PROJ 7744
   736         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
   737         16  BIN-EFFCHG-SAVE     PIC XX.
   738         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
   739***  Y2K PROJ 7744
   740         16  BIN-EXPCHG-SAVE     PIC XX.
   741         16  PI-RECORD-ADDED-SW  PIC X.
   742             88  PI-RECORD-ADDED            VALUE '1'.
   743             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
   744         16  PI-ACCNAME          PIC X(30).
   745         16  PI-COMM-POINTER     PIC S9(8)   COMP.
   746         16  PI-SV-MAINT         PIC X.
   747         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   748         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   749         16  PI-UPDATE-SW        PIC X.
   750             88  PI-CHANGES-MADE             VALUE '1'.
   751         16  PI-NOTE-TYPE        PIC X.
   752             88  PI-ACCT-NOTE                VALUE '1'.
   753         16  PI-DMD-FILE-SW      PIC X.
   754             88  END-OF-FILE                 VALUE 'E'.
   755             88  INTO-NEXT-BENEFITS          VALUE 'I'.
   756             88  FIRST-OCCURS                VALUE 'F'.
   757         16  PI-DMD-OCCURS       PIC S999.
   758         16  PI-DMD-SCREEN       PIC X.
   759             88  SCREEN-1-DISPLAYED  VALUE '1'.
   760             88  SCREEN-2-DISPLAYED  VALUE '2'.
   761             88  SCREEN-3-DISPLAYED  VALUE '3'.
   762         16  PI-NAMEFLG          PIC X.
   763         16  PI-EL650-DEL-SW     PIC X.
   764         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
   765         16  PI-DCC-PROD-CODE    PIC XXX.
   766         16  FILLER              PIC X(34).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  19
* EL6509.cbl
   769*                          COPY ELCATTR.
   770******************************************************************
   771*                                                                *
   772*                            ELCATTR.                            *
   773*                            VMOD=2.001                          *
   774*                                                                *
   775*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   776*                                                                *
   777*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   778*                                                                *
   779*                   POS 1   P=PROTECTED                          *
   780*                           U=UNPROTECTED                        *
   781*                           S=ASKIP                              *
   782*                   POS 2   A=ALPHA/NUMERIC                      *
   783*                           N=NUMERIC                            *
   784*                   POS 3   N=NORMAL                             *
   785*                           B=BRIGHT                             *
   786*                           D=DARK                               *
   787*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   788*                           OF=MODIFIED DATA TAG OFF             *
   789*                                                                *
   790*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   791******************************************************************
   792 01  ATTRIBUTE-LIST.
   793     12  AL-PABOF            PIC X       VALUE 'Y'.
   794     12  AL-PABON            PIC X       VALUE 'Z'.
   795     12  AL-PADOF            PIC X       VALUE '%'.
   796     12  AL-PADON            PIC X       VALUE '_'.
   797     12  AL-PANOF            PIC X       VALUE '-'.
   798     12  AL-PANON            PIC X       VALUE '/'.
   799     12  AL-SABOF            PIC X       VALUE '8'.
   800     12  AL-SABON            PIC X       VALUE '9'.
   801     12  AL-SADOF            PIC X       VALUE '@'.
   802     12  AL-SADON            PIC X       VALUE QUOTE.
   803     12  AL-SANOF            PIC X       VALUE '0'.
   804     12  AL-SANON            PIC X       VALUE '1'.
   805     12  AL-UABOF            PIC X       VALUE 'H'.
   806     12  AL-UABON            PIC X       VALUE 'I'.
   807     12  AL-UADOF            PIC X       VALUE '<'.
   808     12  AL-UADON            PIC X       VALUE '('.
   809     12  AL-UANOF            PIC X       VALUE ' '.
   810     12  AL-UANON            PIC X       VALUE 'A'.
   811     12  AL-UNBOF            PIC X       VALUE 'Q'.
   812     12  AL-UNBON            PIC X       VALUE 'R'.
   813     12  AL-UNDOF            PIC X       VALUE '*'.
   814     12  AL-UNDON            PIC X       VALUE ')'.
   815     12  AL-UNNOF            PIC X       VALUE '&'.
   816     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  20
* EL6509.cbl
   818*                          COPY ELCDATE.
   819******************************************************************
   820*                                                                *
   821*                                                                *
   822*                            ELCDATE.                            *
   823*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   824*                            VMOD=2.003
   825*                                                                *
   826*                                                                *
   827*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   828*                 LENGTH = 200                                   *
   829******************************************************************
   830
   831 01  DATE-CONVERSION-DATA.
   832     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   833     12  DC-OPTION-CODE                PIC X.
   834         88  BIN-TO-GREG                VALUE ' '.
   835         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   836         88  EDIT-GREG-TO-BIN           VALUE '2'.
   837         88  YMD-GREG-TO-BIN            VALUE '3'.
   838         88  MDY-GREG-TO-BIN            VALUE '4'.
   839         88  JULIAN-TO-BIN              VALUE '5'.
   840         88  BIN-PLUS-ELAPSED           VALUE '6'.
   841         88  FIND-CENTURY               VALUE '7'.
   842         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   843         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   844         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   845         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   846         88  JULIAN-TO-BIN-3            VALUE 'C'.
   847         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   848         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   849         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   850         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   851         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   852         88  CHECK-LEAP-YEAR            VALUE 'H'.
   853         88  BIN-3-TO-GREG              VALUE 'I'.
   854         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   855         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   856         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   857         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   858         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   859         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   860         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   861         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   862         88  THREE-CHARACTER-BIN
   863                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   864         88  GREGORIAN-TO-BIN
   865                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   866         88  BIN-TO-GREGORIAN
   867                  VALUES ' ' '1' 'I' '8' 'G'.
   868         88  JULIAN-TO-BINARY
   869                  VALUES '5' 'C' 'E' 'F'.
   870     12  DC-ERROR-CODE                 PIC X.
   871         88  NO-CONVERSION-ERROR        VALUE ' '.
   872         88  DATE-CONVERSION-ERROR
   873                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   874         88  DATE-IS-ZERO               VALUE '1'.
   875         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  21
* EL6509.cbl
   876         88  DATE-IS-INVALID            VALUE '3'.
   877         88  DATE1-GREATER-DATE2        VALUE '4'.
   878         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   879         88  DATE-INVALID-OPTION        VALUE '9'.
   880         88  INVALID-CENTURY            VALUE 'A'.
   881         88  ONLY-CENTURY               VALUE 'B'.
   882         88  ONLY-LEAP-YEAR             VALUE 'C'.
   883         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   884     12  DC-END-OF-MONTH               PIC X.
   885         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   886     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   887         88  USE-NORMAL-PROCESS         VALUE ' '.
   888         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   889         88  ADJUST-UP-100-YRS          VALUE '2'.
   890     12  FILLER                        PIC X.
   891     12  DC-CONVERSION-DATES.
   892         16  DC-BIN-DATE-1             PIC XX.
   893         16  DC-BIN-DATE-2             PIC XX.
   894         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   895         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   896                       DC-GREG-DATE-1-EDIT.
   897             20  DC-EDIT1-MONTH        PIC 99.
   898             20  SLASH1-1              PIC X.
   899             20  DC-EDIT1-DAY          PIC 99.
   900             20  SLASH1-2              PIC X.
   901             20  DC-EDIT1-YEAR         PIC 99.
   902         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   903         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   904                     DC-GREG-DATE-2-EDIT.
   905             20  DC-EDIT2-MONTH        PIC 99.
   906             20  SLASH2-1              PIC X.
   907             20  DC-EDIT2-DAY          PIC 99.
   908             20  SLASH2-2              PIC X.
   909             20  DC-EDIT2-YEAR         PIC 99.
   910         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   911         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   912                     DC-GREG-DATE-1-YMD.
   913             20  DC-YMD-YEAR           PIC 99.
   914             20  DC-YMD-MONTH          PIC 99.
   915             20  DC-YMD-DAY            PIC 99.
   916         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   917         16  DC-GREG-DATE-1-MDY-R REDEFINES
   918                      DC-GREG-DATE-1-MDY.
   919             20  DC-MDY-MONTH          PIC 99.
   920             20  DC-MDY-DAY            PIC 99.
   921             20  DC-MDY-YEAR           PIC 99.
   922         16  DC-GREG-DATE-1-ALPHA.
   923             20  DC-ALPHA-MONTH        PIC X(10).
   924             20  DC-ALPHA-DAY          PIC 99.
   925             20  FILLER                PIC XX.
   926             20  DC-ALPHA-CENTURY.
   927                 24 DC-ALPHA-CEN-N     PIC 99.
   928             20  DC-ALPHA-YEAR         PIC 99.
   929         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   930         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   931         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   932         16  DC-JULIAN-DATE            PIC 9(05).
   933         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  22
* EL6509.cbl
   934                                       PIC 9(05).
   935         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   936             20  DC-JULIAN-YEAR        PIC 99.
   937             20  DC-JULIAN-DAYS        PIC 999.
   938         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   939         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   940         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   941     12  DATE-CONVERSION-VARIBLES.
   942         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   943         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   944             20  FILLER                PIC 9(3).
   945             20  HOLD-CEN-1-CCYY.
   946                 24  HOLD-CEN-1-CC     PIC 99.
   947                 24  HOLD-CEN-1-YY     PIC 99.
   948             20  HOLD-CEN-1-MO         PIC 99.
   949             20  HOLD-CEN-1-DA         PIC 99.
   950         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   951             20  HOLD-CEN-1-R-MO       PIC 99.
   952             20  HOLD-CEN-1-R-DA       PIC 99.
   953             20  HOLD-CEN-1-R-CCYY.
   954                 24  HOLD-CEN-1-R-CC   PIC 99.
   955                 24  HOLD-CEN-1-R-YY   PIC 99.
   956             20  FILLER                PIC 9(3).
   957         16  HOLD-CENTURY-1-X.
   958             20  FILLER                PIC X(3)  VALUE SPACES.
   959             20  HOLD-CEN-1-X-CCYY.
   960                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   961                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   962             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   963             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   964         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   965             20  HOLD-CEN-1-R-X-MO     PIC XX.
   966             20  HOLD-CEN-1-R-X-DA     PIC XX.
   967             20  HOLD-CEN-1-R-X-CCYY.
   968                 24  HOLD-CEN-1-R-X-CC PIC XX.
   969                 24  HOLD-CEN-1-R-X-YY PIC XX.
   970             20  FILLER                PIC XXX.
   971         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   972         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   973         16  DC-JULIAN-DATE-1          PIC 9(07).
   974         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   975             20  DC-JULIAN-1-CCYY.
   976                 24  DC-JULIAN-1-CC    PIC 99.
   977                 24  DC-JULIAN-1-YR    PIC 99.
   978             20  DC-JULIAN-DA-1        PIC 999.
   979         16  DC-JULIAN-DATE-2          PIC 9(07).
   980         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   981             20  DC-JULIAN-2-CCYY.
   982                 24  DC-JULIAN-2-CC    PIC 99.
   983                 24  DC-JULIAN-2-YR    PIC 99.
   984             20  DC-JULIAN-DA-2        PIC 999.
   985         16  DC-GREG-DATE-A-EDIT.
   986             20  DC-EDITA-MONTH        PIC 99.
   987             20  SLASHA-1              PIC X VALUE '/'.
   988             20  DC-EDITA-DAY          PIC 99.
   989             20  SLASHA-2              PIC X VALUE '/'.
   990             20  DC-EDITA-CCYY.
   991                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  23
* EL6509.cbl
   992                 24  DC-EDITA-YEAR     PIC 99.
   993         16  DC-GREG-DATE-B-EDIT.
   994             20  DC-EDITB-MONTH        PIC 99.
   995             20  SLASHB-1              PIC X VALUE '/'.
   996             20  DC-EDITB-DAY          PIC 99.
   997             20  SLASHB-2              PIC X VALUE '/'.
   998             20  DC-EDITB-CCYY.
   999                 24  DC-EDITB-CENT     PIC 99.
  1000                 24  DC-EDITB-YEAR     PIC 99.
  1001         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1002         16  DC-GREG-DATE-CYMD-R REDEFINES
  1003                              DC-GREG-DATE-CYMD.
  1004             20  DC-CYMD-CEN           PIC 99.
  1005             20  DC-CYMD-YEAR          PIC 99.
  1006             20  DC-CYMD-MONTH         PIC 99.
  1007             20  DC-CYMD-DAY           PIC 99.
  1008         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1009         16  DC-GREG-DATE-MDCY-R REDEFINES
  1010                              DC-GREG-DATE-MDCY.
  1011             20  DC-MDCY-MONTH         PIC 99.
  1012             20  DC-MDCY-DAY           PIC 99.
  1013             20  DC-MDCY-CEN           PIC 99.
  1014             20  DC-MDCY-YEAR          PIC 99.
  1015    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1016        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1017    12  DC-EL310-DATE                  PIC X(21).
  1018    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  24
* EL6509.cbl
  1020*                          COPY EL6509S.
  1021 01  EL6509AI.
  1022     05  FILLER            PIC  X(0012).
  1023*    -------------------------------
  1024     05  DATEL PIC S9(0004) COMP.
  1025     05  DATEF PIC  X(0001).
  1026     05  FILLER REDEFINES DATEF.
  1027         10  DATEA PIC  X(0001).
  1028     05  DATEI PIC  X(0008).
  1029*    -------------------------------
  1030     05  TIMEL PIC S9(0004) COMP.
  1031     05  TIMEF PIC  X(0001).
  1032     05  FILLER REDEFINES TIMEF.
  1033         10  TIMEA PIC  X(0001).
  1034     05  TIMEI PIC  X(0005).
  1035*    -------------------------------
  1036     05  CMPNYIDL PIC S9(0004) COMP.
  1037     05  CMPNYIDF PIC  X(0001).
  1038     05  FILLER REDEFINES CMPNYIDF.
  1039         10  CMPNYIDA PIC  X(0001).
  1040     05  CMPNYIDI PIC  X(0003).
  1041*    -------------------------------
  1042     05  USERIDL PIC S9(0004) COMP.
  1043     05  USERIDF PIC  X(0001).
  1044     05  FILLER REDEFINES USERIDF.
  1045         10  USERIDA PIC  X(0001).
  1046     05  USERIDI PIC  X(0004).
  1047*    -------------------------------
  1048     05  CARRL PIC S9(0004) COMP.
  1049     05  CARRF PIC  X(0001).
  1050     05  FILLER REDEFINES CARRF.
  1051         10  CARRA PIC  X(0001).
  1052     05  CARRI PIC  X(0001).
  1053*    -------------------------------
  1054     05  GROUPL PIC S9(0004) COMP.
  1055     05  GROUPF PIC  X(0001).
  1056     05  FILLER REDEFINES GROUPF.
  1057         10  GROUPA PIC  X(0001).
  1058     05  GROUPI PIC  X(0006).
  1059*    -------------------------------
  1060     05  STATEL PIC S9(0004) COMP.
  1061     05  STATEF PIC  X(0001).
  1062     05  FILLER REDEFINES STATEF.
  1063         10  STATEA PIC  X(0001).
  1064     05  STATEI PIC  X(0002).
  1065*    -------------------------------
  1066     05  ACCTL PIC S9(0004) COMP.
  1067     05  ACCTF PIC  X(0001).
  1068     05  FILLER REDEFINES ACCTF.
  1069         10  ACCTA PIC  X(0001).
  1070     05  ACCTI PIC  X(0010).
  1071*    -------------------------------
  1072     05  NAMEL PIC S9(0004) COMP.
  1073     05  NAMEF PIC  X(0001).
  1074     05  FILLER REDEFINES NAMEF.
  1075         10  NAMEA PIC  X(0001).
  1076     05  NAMEI PIC  X(0030).
  1077*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  25
* EL6509.cbl
  1078     05  TOTL PIC S9(0004) COMP.
  1079     05  TOTF PIC  X(0001).
  1080     05  FILLER REDEFINES TOTF.
  1081         10  TOTA PIC  X(0001).
  1082     05  TOTI PIC  999.
  1083*    -------------------------------
  1084     05  L1L PIC S9(0004) COMP.
  1085     05  L1F PIC  X(0001).
  1086     05  FILLER REDEFINES L1F.
  1087         10  L1A PIC  X(0001).
  1088     05  L1I PIC  X(0003).
  1089*    -------------------------------
  1090     05  TEXT1L PIC S9(0004) COMP.
  1091     05  TEXT1F PIC  X(0001).
  1092     05  FILLER REDEFINES TEXT1F.
  1093         10  TEXT1A PIC  X(0001).
  1094     05  TEXT1I PIC  X(0060).
  1095*    -------------------------------
  1096     05  MTBY1L PIC S9(0004) COMP.
  1097     05  MTBY1F PIC  X(0001).
  1098     05  FILLER REDEFINES MTBY1F.
  1099         10  MTBY1A PIC  X(0001).
  1100     05  MTBY1I PIC  X(0004).
  1101*    -------------------------------
  1102     05  MTDT1L PIC S9(0004) COMP.
  1103     05  MTDT1F PIC  X(0001).
  1104     05  FILLER REDEFINES MTDT1F.
  1105         10  MTDT1A PIC  X(0001).
  1106     05  MTDT1I PIC  X(0006).
  1107*    -------------------------------
  1108     05  L2L PIC S9(0004) COMP.
  1109     05  L2F PIC  X(0001).
  1110     05  FILLER REDEFINES L2F.
  1111         10  L2A PIC  X(0001).
  1112     05  L2I PIC  X(0003).
  1113*    -------------------------------
  1114     05  TEXT2L PIC S9(0004) COMP.
  1115     05  TEXT2F PIC  X(0001).
  1116     05  FILLER REDEFINES TEXT2F.
  1117         10  TEXT2A PIC  X(0001).
  1118     05  TEXT2I PIC  X(0060).
  1119*    -------------------------------
  1120     05  MTBY2L PIC S9(0004) COMP.
  1121     05  MTBY2F PIC  X(0001).
  1122     05  FILLER REDEFINES MTBY2F.
  1123         10  MTBY2A PIC  X(0001).
  1124     05  MTBY2I PIC  X(0004).
  1125*    -------------------------------
  1126     05  MTDT2L PIC S9(0004) COMP.
  1127     05  MTDT2F PIC  X(0001).
  1128     05  FILLER REDEFINES MTDT2F.
  1129         10  MTDT2A PIC  X(0001).
  1130     05  MTDT2I PIC  X(0006).
  1131*    -------------------------------
  1132     05  L3L PIC S9(0004) COMP.
  1133     05  L3F PIC  X(0001).
  1134     05  FILLER REDEFINES L3F.
  1135         10  L3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  26
* EL6509.cbl
  1136     05  L3I PIC  X(0003).
  1137*    -------------------------------
  1138     05  TEXT3L PIC S9(0004) COMP.
  1139     05  TEXT3F PIC  X(0001).
  1140     05  FILLER REDEFINES TEXT3F.
  1141         10  TEXT3A PIC  X(0001).
  1142     05  TEXT3I PIC  X(0060).
  1143*    -------------------------------
  1144     05  MTBY3L PIC S9(0004) COMP.
  1145     05  MTBY3F PIC  X(0001).
  1146     05  FILLER REDEFINES MTBY3F.
  1147         10  MTBY3A PIC  X(0001).
  1148     05  MTBY3I PIC  X(0004).
  1149*    -------------------------------
  1150     05  MTDT3L PIC S9(0004) COMP.
  1151     05  MTDT3F PIC  X(0001).
  1152     05  FILLER REDEFINES MTDT3F.
  1153         10  MTDT3A PIC  X(0001).
  1154     05  MTDT3I PIC  X(0006).
  1155*    -------------------------------
  1156     05  L4L PIC S9(0004) COMP.
  1157     05  L4F PIC  X(0001).
  1158     05  FILLER REDEFINES L4F.
  1159         10  L4A PIC  X(0001).
  1160     05  L4I PIC  X(0003).
  1161*    -------------------------------
  1162     05  TEXT4L PIC S9(0004) COMP.
  1163     05  TEXT4F PIC  X(0001).
  1164     05  FILLER REDEFINES TEXT4F.
  1165         10  TEXT4A PIC  X(0001).
  1166     05  TEXT4I PIC  X(0060).
  1167*    -------------------------------
  1168     05  MTBY4L PIC S9(0004) COMP.
  1169     05  MTBY4F PIC  X(0001).
  1170     05  FILLER REDEFINES MTBY4F.
  1171         10  MTBY4A PIC  X(0001).
  1172     05  MTBY4I PIC  X(0004).
  1173*    -------------------------------
  1174     05  MTDT4L PIC S9(0004) COMP.
  1175     05  MTDT4F PIC  X(0001).
  1176     05  FILLER REDEFINES MTDT4F.
  1177         10  MTDT4A PIC  X(0001).
  1178     05  MTDT4I PIC  X(0006).
  1179*    -------------------------------
  1180     05  L5L PIC S9(0004) COMP.
  1181     05  L5F PIC  X(0001).
  1182     05  FILLER REDEFINES L5F.
  1183         10  L5A PIC  X(0001).
  1184     05  L5I PIC  X(0003).
  1185*    -------------------------------
  1186     05  TEXT5L PIC S9(0004) COMP.
  1187     05  TEXT5F PIC  X(0001).
  1188     05  FILLER REDEFINES TEXT5F.
  1189         10  TEXT5A PIC  X(0001).
  1190     05  TEXT5I PIC  X(0060).
  1191*    -------------------------------
  1192     05  MTBY5L PIC S9(0004) COMP.
  1193     05  MTBY5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  27
* EL6509.cbl
  1194     05  FILLER REDEFINES MTBY5F.
  1195         10  MTBY5A PIC  X(0001).
  1196     05  MTBY5I PIC  X(0004).
  1197*    -------------------------------
  1198     05  MTDT5L PIC S9(0004) COMP.
  1199     05  MTDT5F PIC  X(0001).
  1200     05  FILLER REDEFINES MTDT5F.
  1201         10  MTDT5A PIC  X(0001).
  1202     05  MTDT5I PIC  X(0006).
  1203*    -------------------------------
  1204     05  L6L PIC S9(0004) COMP.
  1205     05  L6F PIC  X(0001).
  1206     05  FILLER REDEFINES L6F.
  1207         10  L6A PIC  X(0001).
  1208     05  L6I PIC  X(0003).
  1209*    -------------------------------
  1210     05  TEXT6L PIC S9(0004) COMP.
  1211     05  TEXT6F PIC  X(0001).
  1212     05  FILLER REDEFINES TEXT6F.
  1213         10  TEXT6A PIC  X(0001).
  1214     05  TEXT6I PIC  X(0060).
  1215*    -------------------------------
  1216     05  MTBY6L PIC S9(0004) COMP.
  1217     05  MTBY6F PIC  X(0001).
  1218     05  FILLER REDEFINES MTBY6F.
  1219         10  MTBY6A PIC  X(0001).
  1220     05  MTBY6I PIC  X(0004).
  1221*    -------------------------------
  1222     05  MTDT6L PIC S9(0004) COMP.
  1223     05  MTDT6F PIC  X(0001).
  1224     05  FILLER REDEFINES MTDT6F.
  1225         10  MTDT6A PIC  X(0001).
  1226     05  MTDT6I PIC  X(0006).
  1227*    -------------------------------
  1228     05  L7L PIC S9(0004) COMP.
  1229     05  L7F PIC  X(0001).
  1230     05  FILLER REDEFINES L7F.
  1231         10  L7A PIC  X(0001).
  1232     05  L7I PIC  X(0003).
  1233*    -------------------------------
  1234     05  TEXT7L PIC S9(0004) COMP.
  1235     05  TEXT7F PIC  X(0001).
  1236     05  FILLER REDEFINES TEXT7F.
  1237         10  TEXT7A PIC  X(0001).
  1238     05  TEXT7I PIC  X(0060).
  1239*    -------------------------------
  1240     05  MTBY7L PIC S9(0004) COMP.
  1241     05  MTBY7F PIC  X(0001).
  1242     05  FILLER REDEFINES MTBY7F.
  1243         10  MTBY7A PIC  X(0001).
  1244     05  MTBY7I PIC  X(0004).
  1245*    -------------------------------
  1246     05  MTDT7L PIC S9(0004) COMP.
  1247     05  MTDT7F PIC  X(0001).
  1248     05  FILLER REDEFINES MTDT7F.
  1249         10  MTDT7A PIC  X(0001).
  1250     05  MTDT7I PIC  X(0006).
  1251*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  28
* EL6509.cbl
  1252     05  L8L PIC S9(0004) COMP.
  1253     05  L8F PIC  X(0001).
  1254     05  FILLER REDEFINES L8F.
  1255         10  L8A PIC  X(0001).
  1256     05  L8I PIC  X(0003).
  1257*    -------------------------------
  1258     05  TEXT8L PIC S9(0004) COMP.
  1259     05  TEXT8F PIC  X(0001).
  1260     05  FILLER REDEFINES TEXT8F.
  1261         10  TEXT8A PIC  X(0001).
  1262     05  TEXT8I PIC  X(0060).
  1263*    -------------------------------
  1264     05  MTBY8L PIC S9(0004) COMP.
  1265     05  MTBY8F PIC  X(0001).
  1266     05  FILLER REDEFINES MTBY8F.
  1267         10  MTBY8A PIC  X(0001).
  1268     05  MTBY8I PIC  X(0004).
  1269*    -------------------------------
  1270     05  MTDT8L PIC S9(0004) COMP.
  1271     05  MTDT8F PIC  X(0001).
  1272     05  FILLER REDEFINES MTDT8F.
  1273         10  MTDT8A PIC  X(0001).
  1274     05  MTDT8I PIC  X(0006).
  1275*    -------------------------------
  1276     05  L9L PIC S9(0004) COMP.
  1277     05  L9F PIC  X(0001).
  1278     05  FILLER REDEFINES L9F.
  1279         10  L9A PIC  X(0001).
  1280     05  L9I PIC  X(0003).
  1281*    -------------------------------
  1282     05  TEXT9L PIC S9(0004) COMP.
  1283     05  TEXT9F PIC  X(0001).
  1284     05  FILLER REDEFINES TEXT9F.
  1285         10  TEXT9A PIC  X(0001).
  1286     05  TEXT9I PIC  X(0060).
  1287*    -------------------------------
  1288     05  MTBY9L PIC S9(0004) COMP.
  1289     05  MTBY9F PIC  X(0001).
  1290     05  FILLER REDEFINES MTBY9F.
  1291         10  MTBY9A PIC  X(0001).
  1292     05  MTBY9I PIC  X(0004).
  1293*    -------------------------------
  1294     05  MTDT9L PIC S9(0004) COMP.
  1295     05  MTDT9F PIC  X(0001).
  1296     05  FILLER REDEFINES MTDT9F.
  1297         10  MTDT9A PIC  X(0001).
  1298     05  MTDT9I PIC  X(0006).
  1299*    -------------------------------
  1300     05  L10L PIC S9(0004) COMP.
  1301     05  L10F PIC  X(0001).
  1302     05  FILLER REDEFINES L10F.
  1303         10  L10A PIC  X(0001).
  1304     05  L10I PIC  X(0003).
  1305*    -------------------------------
  1306     05  TEXT10L PIC S9(0004) COMP.
  1307     05  TEXT10F PIC  X(0001).
  1308     05  FILLER REDEFINES TEXT10F.
  1309         10  TEXT10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  29
* EL6509.cbl
  1310     05  TEXT10I PIC  X(0060).
  1311*    -------------------------------
  1312     05  MTBY10L PIC S9(0004) COMP.
  1313     05  MTBY10F PIC  X(0001).
  1314     05  FILLER REDEFINES MTBY10F.
  1315         10  MTBY10A PIC  X(0001).
  1316     05  MTBY10I PIC  X(0004).
  1317*    -------------------------------
  1318     05  MTDT10L PIC S9(0004) COMP.
  1319     05  MTDT10F PIC  X(0001).
  1320     05  FILLER REDEFINES MTDT10F.
  1321         10  MTDT10A PIC  X(0001).
  1322     05  MTDT10I PIC  X(0006).
  1323*    -------------------------------
  1324     05  L11L PIC S9(0004) COMP.
  1325     05  L11F PIC  X(0001).
  1326     05  FILLER REDEFINES L11F.
  1327         10  L11A PIC  X(0001).
  1328     05  L11I PIC  X(0003).
  1329*    -------------------------------
  1330     05  TEXT11L PIC S9(0004) COMP.
  1331     05  TEXT11F PIC  X(0001).
  1332     05  FILLER REDEFINES TEXT11F.
  1333         10  TEXT11A PIC  X(0001).
  1334     05  TEXT11I PIC  X(0060).
  1335*    -------------------------------
  1336     05  MTBY11L PIC S9(0004) COMP.
  1337     05  MTBY11F PIC  X(0001).
  1338     05  FILLER REDEFINES MTBY11F.
  1339         10  MTBY11A PIC  X(0001).
  1340     05  MTBY11I PIC  X(0004).
  1341*    -------------------------------
  1342     05  MTDT11L PIC S9(0004) COMP.
  1343     05  MTDT11F PIC  X(0001).
  1344     05  FILLER REDEFINES MTDT11F.
  1345         10  MTDT11A PIC  X(0001).
  1346     05  MTDT11I PIC  X(0006).
  1347*    -------------------------------
  1348     05  L12L PIC S9(0004) COMP.
  1349     05  L12F PIC  X(0001).
  1350     05  FILLER REDEFINES L12F.
  1351         10  L12A PIC  X(0001).
  1352     05  L12I PIC  X(0003).
  1353*    -------------------------------
  1354     05  TEXT12L PIC S9(0004) COMP.
  1355     05  TEXT12F PIC  X(0001).
  1356     05  FILLER REDEFINES TEXT12F.
  1357         10  TEXT12A PIC  X(0001).
  1358     05  TEXT12I PIC  X(0060).
  1359*    -------------------------------
  1360     05  MTBY12L PIC S9(0004) COMP.
  1361     05  MTBY12F PIC  X(0001).
  1362     05  FILLER REDEFINES MTBY12F.
  1363         10  MTBY12A PIC  X(0001).
  1364     05  MTBY12I PIC  X(0004).
  1365*    -------------------------------
  1366     05  MTDT12L PIC S9(0004) COMP.
  1367     05  MTDT12F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  30
* EL6509.cbl
  1368     05  FILLER REDEFINES MTDT12F.
  1369         10  MTDT12A PIC  X(0001).
  1370     05  MTDT12I PIC  X(0006).
  1371*    -------------------------------
  1372     05  ERRMSGBL PIC S9(0004) COMP.
  1373     05  ERRMSGBF PIC  X(0001).
  1374     05  FILLER REDEFINES ERRMSGBF.
  1375         10  ERRMSGBA PIC  X(0001).
  1376     05  ERRMSGBI PIC  X(0072).
  1377*    -------------------------------
  1378     05  FUNCTL PIC S9(0004) COMP.
  1379     05  FUNCTF PIC  X(0001).
  1380     05  FILLER REDEFINES FUNCTF.
  1381         10  FUNCTA PIC  X(0001).
  1382     05  FUNCTI PIC  X(0001).
  1383*    -------------------------------
  1384     05  LINE1L PIC S9(0004) COMP.
  1385     05  LINE1F PIC  X(0001).
  1386     05  FILLER REDEFINES LINE1F.
  1387         10  LINE1A PIC  X(0001).
  1388     05  LINE1I PIC  999.
  1389*    -------------------------------
  1390     05  LINE2L PIC S9(0004) COMP.
  1391     05  LINE2F PIC  X(0001).
  1392     05  FILLER REDEFINES LINE2F.
  1393         10  LINE2A PIC  X(0001).
  1394     05  LINE2I PIC  999.
  1395*    -------------------------------
  1396     05  PFENTERL PIC S9(0004) COMP.
  1397     05  PFENTERF PIC  X(0001).
  1398     05  FILLER REDEFINES PFENTERF.
  1399         10  PFENTERA PIC  X(0001).
  1400     05  PFENTERI PIC  99.
  1401 01  EL6509AO REDEFINES EL6509AI.
  1402     05  FILLER            PIC  X(0012).
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  DATEO PIC  X(0008).
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  TIMEO PIC  99.99.
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  CMPNYIDO PIC  X(0003).
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(0003).
  1414     05  USERIDO PIC  X(0004).
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  CARRO PIC  X(0001).
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
  1420     05  GROUPO PIC  X(0006).
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  STATEO PIC  X(0002).
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  31
* EL6509.cbl
  1426     05  ACCTO PIC  X(0010).
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
  1429     05  NAMEO PIC  X(0030).
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  TOTO PIC  X(0003).
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  L1O PIC  X(0003).
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  TEXT1O PIC  X(0060).
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  MTBY1O PIC  X(0004).
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  MTDT1O PIC  X(0006).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  L2O PIC  X(0003).
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  TEXT2O PIC  X(0060).
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  MTBY2O PIC  X(0004).
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  MTDT2O PIC  X(0006).
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  L3O PIC  X(0003).
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  TEXT3O PIC  X(0060).
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  MTBY3O PIC  X(0004).
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  MTDT3O PIC  X(0006).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  L4O PIC  X(0003).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  TEXT4O PIC  X(0060).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  MTBY4O PIC  X(0004).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  MTDT4O PIC  X(0006).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  L5O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  32
* EL6509.cbl
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  TEXT5O PIC  X(0060).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  MTBY5O PIC  X(0004).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  MTDT5O PIC  X(0006).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  L6O PIC  X(0003).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  TEXT6O PIC  X(0060).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  MTBY6O PIC  X(0004).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  MTDT6O PIC  X(0006).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  L7O PIC  X(0003).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  TEXT7O PIC  X(0060).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  MTBY7O PIC  X(0004).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  MTDT7O PIC  X(0006).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  L8O PIC  X(0003).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  TEXT8O PIC  X(0060).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  MTBY8O PIC  X(0004).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  MTDT8O PIC  X(0006).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  L9O PIC  X(0003).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  TEXT9O PIC  X(0060).
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  MTBY9O PIC  X(0004).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  MTDT9O PIC  X(0006).
  1541*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  33
* EL6509.cbl
  1542     05  FILLER            PIC  X(0003).
  1543     05  L10O PIC  X(0003).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  TEXT10O PIC  X(0060).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  MTBY10O PIC  X(0004).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  MTDT10O PIC  X(0006).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  L11O PIC  X(0003).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  TEXT11O PIC  X(0060).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  MTBY11O PIC  X(0004).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  MTDT11O PIC  X(0006).
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  L12O PIC  X(0003).
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  TEXT12O PIC  X(0060).
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  MTBY12O PIC  X(0004).
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  MTDT12O PIC  X(0006).
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  ERRMSGBO PIC  X(0072).
  1580*    -------------------------------
  1581     05  FILLER            PIC  X(0003).
  1582     05  FUNCTO PIC  X(0001).
  1583*    -------------------------------
  1584     05  FILLER            PIC  X(0003).
  1585     05  LINE1O PIC  X(0003).
  1586*    -------------------------------
  1587     05  FILLER            PIC  X(0003).
  1588     05  LINE2O PIC  X(0003).
  1589*    -------------------------------
  1590     05  FILLER            PIC  X(0003).
  1591     05  PFENTERO PIC  X(0002).
  1592*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  34
* EL6509.cbl
  1594 01  EL6509R REDEFINES EL6509AI.
  1595     12  FILLER                  PIC X(114).
  1596     12  SC-ALL-LINES.
  1597      14 SC-LINES OCCURS 12 TIMES INDEXED BY SC-INDX.
  1598         16  SC-LINL             PIC S9(4)   COMP.
  1599         16  SC-LINA             PIC X.
  1600         16  SC-LIN              PIC Z99.
  1601         16  SC-TEXTL            PIC S9(4)   COMP.
  1602         16  SC-TEXTA            PIC X.
  1603         16  SC-TEXT             PIC X(60).
  1604         16  SC-MAINT-BYL        PIC S9(4)   COMP.
  1605         16  SC-MAINT-BYA        PIC X.
  1606         16  SC-MAINT-BY         PIC XXXX.
  1607         16  SC-MAINT-DTL        PIC S9(4)   COMP.
  1608         16  SC-MAINT-DTA        PIC X.
  1609         16  SC-MAINT-DT         PIC X(6).
  1610     12  FILLER                  PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  35
* EL6509.cbl
  1612 01  RECORD-TABLE                PIC X(21600) VALUE SPACES.
  1613 01  REC-TABLE  REDEFINES RECORD-TABLE.
  1614     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX PIC X(3600).
  1615 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  1616     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  1617         16  REC-TEXT                    PIC X(60).
  1618         16  REC-LAST-MAINT-BY           PIC XXXX.
  1619         16  REC-LAST-MAINT-DT           PIC XX.
  1620         16  REC-LAST-MAINT-HHMMSS       PIC S9(7) COMP-3.
  1621         16  REC-PC                      PIC X(2).
  1622
  1623 01  TS-WORK-AREA                        PIC X(3600).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  36
* EL6509.cbl
  1625
  1626****************************************************************
  1627*
  1628* Copyright (c) 2007 by Clerity Solutions, Inc.
  1629* All rights reserved.
  1630*
  1631****************************************************************
  1632 01  DFHEIV.
  1633   02  DFHEIV0               PIC X(35).
  1634   02  DFHEIV1               PIC X(08).
  1635   02  DFHEIV2               PIC X(08).
  1636   02  DFHEIV3               PIC X(08).
  1637   02  DFHEIV4               PIC X(06).
  1638   02  DFHEIV5               PIC X(04).
  1639   02  DFHEIV6               PIC X(04).
  1640   02  DFHEIV7               PIC X(02).
  1641   02  DFHEIV8               PIC X(02).
  1642   02  DFHEIV9               PIC X(01).
  1643   02  DFHEIV10              PIC S9(7) COMP-3.
  1644   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1645   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1646   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1647   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1648   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1649   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1650   02  DFHEIV17              PIC X(04).
  1651   02  DFHEIV18              PIC X(04).
  1652   02  DFHEIV19              PIC X(04).
  1653   02  DFHEIV20              USAGE IS POINTER.
  1654   02  DFHEIV21              USAGE IS POINTER.
  1655   02  DFHEIV22              USAGE IS POINTER.
  1656   02  DFHEIV23              USAGE IS POINTER.
  1657   02  DFHEIV24              USAGE IS POINTER.
  1658   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1659   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1660   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1661   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1662   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1663   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1664   02  FILLER                PIC X(02).
  1665   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1666   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1667   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1668   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1669   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1670 LINKAGE  SECTION.
  1671*****************************************************************
  1672*                                                               *
  1673* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1674* All rights reserved.                                          *
  1675*                                                               *
  1676*****************************************************************
  1677 01  dfheiblk.
  1678     02  eibtime          pic s9(7) comp-3.
  1679     02  eibdate          pic s9(7) comp-3.
  1680     02  eibtrnid         pic x(4).
  1681     02  eibtaskn         pic s9(7) comp-3.
  1682     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  37
* EL6509.cbl
  1683     02  dfheigdi         pic s9(4) comp.
  1684     02  eibcposn         pic s9(4) comp.
  1685     02  eibcalen         pic s9(4) comp.
  1686     02  eibaid           pic x(1).
  1687     02  eibfiller1       pic x(1).
  1688     02  eibfn            pic x(2).
  1689     02  eibfiller2       pic x(2).
  1690     02  eibrcode         pic x(6).
  1691     02  eibfiller3       pic x(2).
  1692     02  eibds            pic x(8).
  1693     02  eibreqid         pic x(8).
  1694     02  eibrsrce         pic x(8).
  1695     02  eibsync          pic x(1).
  1696     02  eibfree          pic x(1).
  1697     02  eibrecv          pic x(1).
  1698     02  eibsend          pic x(1).
  1699     02  eibatt           pic x(1).
  1700     02  eibeoc           pic x(1).
  1701     02  eibfmh           pic x(1).
  1702     02  eibcompl         pic x(1).
  1703     02  eibsig           pic x(1).
  1704     02  eibconf          pic x(1).
  1705     02  eiberr           pic x(1).
  1706     02  eibrldbk         pic x(1).
  1707     02  eiberrcd         pic x(4).
  1708     02  eibsynrb         pic x(1).
  1709     02  eibnodat         pic x(1).
  1710     02  eibfiller5       pic x(2).
  1711     02  eibresp          pic 9(09) comp.
  1712     02  eibresp2         pic 9(09) comp.
  1713     02  dfheigdj         pic s9(4) comp.
  1714     02  dfheigdk         pic s9(4) comp.
  1715 01  DFHCOMMAREA                 PIC X(1500).
  1716
  1717*         COPY ERCACNT.
  1718******************************************************************
  1719*                                                                *
  1720*                                                                *
  1721*                            ERCACNT.                            *
  1722*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1723*                            VMOD=2.002                          *
  1724*                                                                *
  1725*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1726*                                                                *
  1727*   FILE TYPE = VSAM,KSDS                                        *
  1728*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1729*                                                                *
  1730*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1731*       ALTERNATE INDEX = NONE                                   *
  1732*                                                                *
  1733*                                                                *
  1734*   LOG = YES                                                    *
  1735*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1736******************************************************************
  1737*                   C H A N G E   L O G
  1738*
  1739* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1740*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  38
* EL6509.cbl
  1741*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1742* EFFECTIVE    NUMBER
  1743*-----------------------------------------------------------------
  1744* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1745*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1746******************************************************************
  1747 01  NOTE-FILE.
  1748     12  NT-FILE-ID                  PIC XX.
  1749         88  VALID-NOTE-ID              VALUE 'NT'.
  1750
  1751     12  NT-CONTROL-PRIMARY.
  1752         16  NT-COMPANY-CD           PIC X.
  1753         16  NT-ACCT-NOTE-KEY.
  1754             18  NT-CARRIER              PIC X.
  1755             18  NT-GROUPING             PIC X(06).
  1756             18  NT-STATE                PIC XX.
  1757             18  NT-ACCOUNT              PIC X(10).
  1758         16  NT-RECORD-TYPE          PIC X.
  1759              88  ACCT-NOTE          VALUE '1'.
  1760              88  ACCT-BRANCH-LOC    VALUE '2'.
  1761              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1762         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1763
  1764     12  NT-LAST-MAINT-DT            PIC XX.
  1765     12  NT-LAST-MAINT-BY            PIC X(4).
  1766     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1767
  1768*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1769*     SEQUENCE NUMBERS
  1770     12  NT-NOTE-INFORMATION.
  1771         16  NT-NOTE-LINE            PIC X(60).
  1772         16  FILLER                  PIC X(25).
  1773*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1774     12  NT-LOCATION-INFORMATION REDEFINES
  1775                         NT-NOTE-INFORMATION.
  1776         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1777         16  FILLER                  PIC X(25).
  1778*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1779*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1780*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1781*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1782*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1783*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1784*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1785     12  NT-SHIPPING-INFORMATION REDEFINES
  1786                         NT-NOTE-INFORMATION.
  1787         16  NT-SHIPPING-LINE        PIC X(60).
  1788         16  NT-SHIP-STATE           PIC XX.
  1789         16  NT-SHIP-ZIP             PIC X(10).
  1790         16  FILLER                  PIC X(13).
  1791*****************************************************************
  1792*         COPY ELCCNTL.
  1793******************************************************************
  1794*                                                                *
  1795*                                                                *
  1796*                            ELCCNTL.                            *
  1797*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1798*                            VMOD=2.059                          *
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  39
* EL6509.cbl
  1799*                                                                *
  1800*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1801*                                                                *
  1802*   FILE TYPE = VSAM,KSDS                                        *
  1803*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1804*                                                                *
  1805*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1806*       ALTERNATE INDEX = NONE                                   *
  1807*                                                                *
  1808*   LOG = YES                                                    *
  1809*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1810******************************************************************
  1811*                   C H A N G E   L O G
  1812*
  1813* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1814*-----------------------------------------------------------------
  1815*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1816* EFFECTIVE    NUMBER
  1817*-----------------------------------------------------------------
  1818* 082503                   PEMA  ADD BENEFIT GROUP
  1819* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1820* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1821* 092705    2005050300006  PEMA  ADD SPP LEASES
  1822* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1823* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1824* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1825* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1826* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1827* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1828* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1829* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1830* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1831* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1832******************************************************************
  1833*
  1834 01  CONTROL-FILE.
  1835     12  CF-RECORD-ID                       PIC XX.
  1836         88  VALID-CF-ID                        VALUE 'CF'.
  1837
  1838     12  CF-CONTROL-PRIMARY.
  1839         16  CF-COMPANY-ID                  PIC XXX.
  1840         16  CF-RECORD-TYPE                 PIC X.
  1841             88  CF-COMPANY-MASTER              VALUE '1'.
  1842             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1843             88  CF-STATE-MASTER                VALUE '3'.
  1844             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1845             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1846             88  CF-CARRIER-MASTER              VALUE '6'.
  1847             88  CF-MORTALITY-MASTER            VALUE '7'.
  1848             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1849             88  CF-TERMINAL-MASTER             VALUE '9'.
  1850             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1851             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1852             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1853             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1854             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1855             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1856             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  40
* EL6509.cbl
  1857             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1858             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1859         16  CF-ACCESS-CD-GENL              PIC X(4).
  1860         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1861             20  CF-PROCESSOR               PIC X(4).
  1862         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1863             20  CF-STATE-CODE              PIC XX.
  1864             20  FILLER                     PIC XX.
  1865         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1866             20  FILLER                     PIC XX.
  1867             20  CF-HI-BEN-IN-REC           PIC XX.
  1868         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1869             20  FILLER                     PIC XXX.
  1870             20  CF-CARRIER-CNTL            PIC X.
  1871         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1872             20  FILLER                     PIC XX.
  1873             20  CF-HI-TYPE-IN-REC          PIC 99.
  1874         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1875             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1876                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1877             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1878             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1879         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1880             20  FILLER                     PIC X.
  1881             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1882         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1883             20  FILLER                     PIC XX.
  1884             20  CF-MORTGAGE-PLAN           PIC XX.
  1885         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1886
  1887     12  CF-LAST-MAINT-DT                   PIC XX.
  1888     12  CF-LAST-MAINT-BY                   PIC X(4).
  1889     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1890
  1891     12  CF-RECORD-BODY                     PIC X(728).
  1892
  1893
  1894****************************************************************
  1895*             COMPANY MASTER RECORD                            *
  1896****************************************************************
  1897
  1898     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1899         16  CF-COMPANY-ADDRESS.
  1900             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1901             20  CF-CL-IN-CARE-OF           PIC X(30).
  1902             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1903             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1904             20  CF-CL-CITY-STATE           PIC X(30).
  1905             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1906             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1907         16  CF-COMPANY-CD                  PIC X.
  1908         16  CF-COMPANY-PASSWORD            PIC X(8).
  1909         16  CF-SECURITY-OPTION             PIC X.
  1910             88  ALL-SECURITY                   VALUE '1'.
  1911             88  COMPANY-VERIFY                 VALUE '2'.
  1912             88  PROCESSOR-VERIFY               VALUE '3'.
  1913             88  NO-SECURITY                    VALUE '4'.
  1914             88  ALL-BUT-TERM                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  41
* EL6509.cbl
  1915         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1916             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1917         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1918             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1919         16  CF-INFORCE-LOCATION            PIC X.
  1920             88  CERTS-ARE-ONLINE               VALUE '1'.
  1921             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1922             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1923         16  CF-LOWER-CASE-LETTERS          PIC X.
  1924         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1925             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1926             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1927             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1928             88  CF-ACCNT-CNTL                  VALUE '3'.
  1929             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1930
  1931         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1932         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1933
  1934         16  CF-LGX-CREDIT-USER             PIC X.
  1935             88  CO-IS-NOT-USER                 VALUE 'N'.
  1936             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1937
  1938         16 CF-CREDIT-CALC-CODES.
  1939             20  CF-CR-REM-TERM-CALC PIC X.
  1940               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1941               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1942               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1943               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1944               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1945               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1946               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1947             20  CF-CR-R78-METHOD           PIC X.
  1948               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1949               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1950
  1951         16  CF-CLAIM-CONTROL-COUNTS.
  1952             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1953                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1954
  1955             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1956                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1957
  1958             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1959                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1960
  1961             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1962                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1963
  1964         16  CF-CURRENT-MONTH-END           PIC XX.
  1965
  1966         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1967             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1968             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1969             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1970             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1971                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1972                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  42
* EL6509.cbl
  1973             20  CF-CO-PREM-REJECT-SW       PIC X.
  1974                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1975                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1976             20  CF-CO-REF-REJECT-SW        PIC X.
  1977                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1978                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1979
  1980         16  CF-CO-REPORTING-DT             PIC XX.
  1981         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1982         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1983           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1984           88  CF-CO-MONTH-END                  VALUE '1'.
  1985
  1986         16  CF-LGX-CLAIM-USER              PIC X.
  1987             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1988             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1989
  1990         16  CF-CREDIT-EDIT-CONTROLS.
  1991             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1992             20  CF-MIN-AGE                 PIC 99.
  1993             20  CF-DEFAULT-AGE             PIC 99.
  1994             20  CF-MIN-TERM                PIC S999      COMP-3.
  1995             20  CF-MAX-TERM                PIC S999      COMP-3.
  1996             20  CF-DEFAULT-SEX             PIC X.
  1997             20  CF-JOINT-AGE-INPUT         PIC X.
  1998                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1999             20  CF-BIRTH-DATE-INPUT        PIC X.
  2000                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2001             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2002                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2003                 88  CF-ZERO-CARRIER            VALUE '1'.
  2004                 88  CF-ZERO-GROUPING           VALUE '2'.
  2005                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2006             20  CF-EDIT-SW                 PIC X.
  2007                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2008             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2009             20  CF-CR-PR-METHOD            PIC X.
  2010               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2011               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2012             20  FILLER                     PIC X.
  2013
  2014         16  CF-CREDIT-MISC-CONTROLS.
  2015             20  CF-REIN-TABLE-SW           PIC X.
  2016                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2017             20  CF-COMP-TABLE-SW           PIC X.
  2018                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2019             20  CF-EXPERIENCE-RETENTION-AGE
  2020                                            PIC S9        COMP-3.
  2021             20  CF-CONVERSION-DT           PIC XX.
  2022             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2023             20  CF-RUN-FREQUENCY-SW        PIC X.
  2024                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2025                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2026
  2027             20  CF-CR-CHECK-NO-CONTROL.
  2028                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2029                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2030                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  43
* EL6509.cbl
  2031                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2032                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2033                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2034
  2035                 24  CF-CR-CHECK-COUNT       REDEFINES
  2036                     CF-CR-CHECK-COUNTER      PIC X(4).
  2037
  2038                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2039                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2040
  2041                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2042                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2043                 24  CF-MAIL-PROCESSING       PIC X.
  2044                     88  MAIL-PROCESSING          VALUE 'Y'.
  2045
  2046         16  CF-MISC-SYSTEM-CONTROL.
  2047             20  CF-SYSTEM-C                 PIC X.
  2048                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2049             20  CF-SYSTEM-D                 PIC X.
  2050                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2051             20  CF-SOC-SEC-NO-SW            PIC X.
  2052                 88  SOC-SEC-NO-USED             VALUE '1'.
  2053             20  CF-MEMBER-NO-SW             PIC X.
  2054                 88  MEMBER-NO-USED              VALUE '1'.
  2055             20  CF-TAX-ID-NUMBER            PIC X(11).
  2056             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2057             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2058                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2059                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2060                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2061                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2062             20  CF-SYSTEM-E                 PIC X.
  2063                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2064
  2065         16  CF-LGX-LIFE-USER               PIC X.
  2066             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2067             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2068
  2069         16  CF-CR-MONTH-END-DT             PIC XX.
  2070
  2071         16  CF-FILE-MAINT-DATES.
  2072             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2073                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2074             20  CF-LAST-BATCH       REDEFINES
  2075                 CF-LAST-BATCH-NO               PIC X(4).
  2076             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2077             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2078             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2079             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2080             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2081             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2082             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2083             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2084             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2085             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2086
  2087         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2088         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  44
* EL6509.cbl
  2089
  2090         16  CF-ALT-MORT-CODE               PIC X(4).
  2091         16  CF-MEMBER-CAPTION              PIC X(10).
  2092
  2093         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2094             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2095             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2096             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2097             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2098             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2099
  2100         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2101
  2102         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2103         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2104         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2105         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2106
  2107         16  CF-AH-OVERRIDE-L1              PIC X.
  2108         16  CF-AH-OVERRIDE-L2              PIC XX.
  2109         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2110         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2111
  2112         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2113         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2114
  2115         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2116         16  CF-AR-LAST-EL860-DT            PIC XX.
  2117         16  CF-MP-MONTH-END-DT             PIC XX.
  2118
  2119         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2120         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2121             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2122
  2123         16  CF-AR-MONTH-END-DT             PIC XX.
  2124
  2125         16  CF-CRDTCRD-USER                PIC X.
  2126             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2127             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2128
  2129         16  CF-CC-MONTH-END-DT             PIC XX.
  2130
  2131         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2132
  2133         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2134             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2135             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2136             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2137         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2138         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2139         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2140         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2141             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2142             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2143         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2144         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2145         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2146             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  45
* EL6509.cbl
  2147         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2148
  2149         16  CF-CL-ZIP-CODE.
  2150             20  CF-CL-ZIP-PRIME.
  2151                 24  CF-CL-ZIP-1ST          PIC X.
  2152                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2153                 24  FILLER                 PIC X(4).
  2154             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2155         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2156             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2157             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2158             20  FILLER                     PIC XXX.
  2159
  2160         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2161         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2162         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2163         16  CF-CO-OPTION-START-DATE        PIC XX.
  2164         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2165           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2166                                                      '3' '4'.
  2167           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2168           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2169           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2170           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2171           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2172           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2173
  2174         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2175
  2176         16  CF-PAYMENT-APPROVAL-LEVELS.
  2177             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2178             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2179             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2180             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2181             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2182             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2183
  2184         16  CF-END-USER-REPORTING-USER     PIC X.
  2185             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2186             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2187
  2188         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2189             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2190             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2191
  2192         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2193
  2194         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2195         16  FILLER                         PIC X.
  2196
  2197         16  CF-CREDIT-ARCHIVE-CNTL.
  2198             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2199             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2200             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2201
  2202         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2203
  2204         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  46
* EL6509.cbl
  2205             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2206             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2207
  2208         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2209             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2210             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2211
  2212         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2213
  2214         16  CF-CO-ACH-ID-CODE              PIC  X.
  2215             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2216             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2217             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2218         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2219         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2220         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2221         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2222         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2223         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2224         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2225         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2226         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2227                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2228         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2229                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2230
  2231         16  CF-CO-OVER-SHORT.
  2232             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2233             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2234
  2235*         16  FILLER                         PIC X(102).
  2236         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2237             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2238             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2239
  2240         16  CF-AH-APPROVAL-DAYS.
  2241             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2242             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2243             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2244             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2245
  2246         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2247
  2248         16  CF-APPROV-LEV-5.
  2249             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2250             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2251             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2252
  2253         16  FILLER                         PIC X(68).
  2254****************************************************************
  2255*             PROCESSOR/USER RECORD                            *
  2256****************************************************************
  2257
  2258     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2259         16  CF-PROCESSOR-NAME              PIC X(30).
  2260         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2261         16  CF-PROCESSOR-TITLE             PIC X(26).
  2262         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  47
* EL6509.cbl
  2263                 88  MESSAGE-YES                VALUE 'Y'.
  2264                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2265
  2266*****************************************************
  2267****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2268****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2269****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2270****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2271*****************************************************
  2272
  2273         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2274             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2275             20  CF-APPLICATION-FORCE       PIC X.
  2276             20  CF-INDIVIDUAL-APP.
  2277                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2278                     28  CF-BROWSE-APP      PIC X.
  2279                     28  CF-UPDATE-APP      PIC X.
  2280
  2281         16  CF-CURRENT-TERM-ON             PIC X(4).
  2282         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2283             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2284             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2285             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2286             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2287             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2288             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2289             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2290         16  CF-PROCESSOR-CARRIER           PIC X.
  2291             88  NO-CARRIER-SECURITY            VALUE ' '.
  2292         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2293             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2294         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2295             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2296         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2297             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2298
  2299         16  CF-PROC-SYS-ACCESS-SW.
  2300             20  CF-PROC-CREDIT-CLAIMS-SW.
  2301                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2302                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2303                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2304                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2305             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2306                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2307                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2308             20  CF-PROC-LIFE-GNRLDGR-SW.
  2309                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2310                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2311                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2312                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2313             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2314                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2315                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2316         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2317             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2318             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2319         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2320
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  48
* EL6509.cbl
  2321         16  CF-APPROVAL-LEVEL                  PIC X.
  2322             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2323             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2324             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2325             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2326             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2327
  2328         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2329
  2330         16  CF-LANGUAGE-TYPE                   PIC X.
  2331             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2332             88  CF-LANG-IS-FR                      VALUE 'F'.
  2333
  2334         16  CF-CSR-IND                         PIC X.
  2335         16  FILLER                             PIC X(239).
  2336
  2337****************************************************************
  2338*             PROCESSOR/REMINDERS RECORD                       *
  2339****************************************************************
  2340
  2341     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2342         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2343             20  CF-START-REMIND-DT         PIC XX.
  2344             20  CF-END-REMIND-DT           PIC XX.
  2345             20  CF-REMINDER-TEXT           PIC X(50).
  2346         16  FILLER                         PIC X(296).
  2347
  2348
  2349****************************************************************
  2350*             STATE MASTER RECORD                              *
  2351****************************************************************
  2352
  2353     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2354         16  CF-STATE-ABBREVIATION          PIC XX.
  2355         16  CF-STATE-NAME                  PIC X(25).
  2356         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2357         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2358             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2359             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2360             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2361             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2362                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2363                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2364             20  CF-ST-PREM-REJECT-SW       PIC X.
  2365                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2366                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2367             20  CF-ST-REF-REJECT-SW        PIC X.
  2368                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2369                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2370         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2371         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2372         16  CF-ST-REFUND-RULES.
  2373             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2374             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2375             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2376         16  CF-ST-FST-PMT-EXTENSION.
  2377             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2378             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  49
* EL6509.cbl
  2379                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2380                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2381                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2382                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2383         16  CF-ST-STATE-CALL.
  2384             20  CF-ST-CALL-UNEARNED        PIC X.
  2385             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2386             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2387         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2388             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2389             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2390         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2391         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2392         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2393         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2394         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2395         16  FILLER                         PIC X.
  2396         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2397             20  CF-ST-BENEFIT-CD           PIC XX.
  2398             20  CF-ST-BENEFIT-KIND         PIC X.
  2399                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2400                 88  CF-ST-AH-KIND              VALUE 'A'.
  2401             20  CF-ST-REM-TERM-CALC        PIC X.
  2402                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2403                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2404                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2405                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2406                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2407                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2408                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2409                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2410
  2411             20  CF-ST-REFUND-CALC          PIC X.
  2412                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2413                 88  ST-REFD-BY-R78             VALUE '1'.
  2414                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2415                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2416                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2417                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2418                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2419                 88  ST-REFD-UTAH               VALUE '7'.
  2420                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2421                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2422                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2423
  2424             20  CF-ST-EARNING-CALC         PIC X.
  2425                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2426                 88  ST-EARN-BY-R78             VALUE '1'.
  2427                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2428                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2429                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2430                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2431                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2432                 88  ST-EARN-MEAN               VALUE '8'.
  2433                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2434
  2435             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2436                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  50
* EL6509.cbl
  2437                 88  ST-OVRD-BY-R78             VALUE '1'.
  2438                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2439                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2440                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2441                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2442                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2443                 88  ST-OVRD-MEAN               VALUE '8'.
  2444                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2445             20  cf-st-extra-periods        pic 9.
  2446*            20  FILLER                     PIC X.
  2447
  2448         16  CF-ST-COMMISSION-CAPS.
  2449             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2450             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2451             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2452             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2453         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2454                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2455
  2456         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2457
  2458         16  CF-ST-STATUTORY-INTEREST.
  2459             20  CF-ST-STAT-DATE-FROM       PIC X.
  2460                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2461                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2462             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2463             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2464             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2465             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2466             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2467
  2468         16  CF-ST-OVER-SHORT.
  2469             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2470             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2471
  2472         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2473
  2474         16  CF-ST-RT-CALC                  PIC X.
  2475
  2476         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2477         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2478         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2479         16  CF-ST-RF-LR-CALC               PIC X.
  2480         16  CF-ST-RF-LL-CALC               PIC X.
  2481         16  CF-ST-RF-LN-CALC               PIC X.
  2482         16  CF-ST-RF-AH-CALC               PIC X.
  2483         16  CF-ST-RF-CP-CALC               PIC X.
  2484*        16  FILLER                         PIC X(206).
  2485*CIDMOD         16  FILLER                         PIC X(192).
  2486         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2487             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2488         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2489         16  CF-ST-VFY-2ND-BENE             PIC X.
  2490         16  CF-ST-CAUSAL-STATE             PIC X.
  2491         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2492         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2493         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2494             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  51
* EL6509.cbl
  2495         16  CF-ST-NET-ONLY-STATE           PIC X.
  2496             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2497         16  FILLER                         PIC X(181).
  2498
  2499****************************************************************
  2500*             BENEFIT MASTER RECORD                            *
  2501****************************************************************
  2502
  2503     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2504         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2505             20  CF-BENEFIT-CODE            PIC XX.
  2506             20  CF-BENEFIT-NUMERIC  REDEFINES
  2507                 CF-BENEFIT-CODE            PIC XX.
  2508             20  CF-BENEFIT-ALPHA           PIC XXX.
  2509             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2510             20  CF-BENEFIT-COMMENT         PIC X(10).
  2511
  2512             20  CF-LF-COVERAGE-TYPE        PIC X.
  2513                 88  CF-REDUCING                VALUE 'R'.
  2514                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2515
  2516             20  CF-SPECIAL-CALC-CD         PIC X.
  2517                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2518                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2519                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2520                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2521                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2522                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2523                 88  CF-FARM-PLAN               VALUE 'F'.
  2524                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2525                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2526                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2527                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2528                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2529                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2530                 88  CF-PRUDENTIAL              VALUE 'P'.
  2531                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2532                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2533                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2534                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2535                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2536                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2537
  2538             20  CF-JOINT-INDICATOR         PIC X.
  2539                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2540
  2541*            20  FILLER                     PIC X(12).
  2542             20  cf-maximum-benefits        pic s999 comp-3.
  2543             20  FILLER                     PIC X(09).
  2544             20  CF-BENEFIT-CATEGORY        PIC X.
  2545             20  CF-LOAN-TYPE               PIC X(8).
  2546
  2547             20  CF-CO-REM-TERM-CALC        PIC X.
  2548                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2549                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2550                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2551                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2552                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  52
* EL6509.cbl
  2553
  2554             20  CF-CO-EARNINGS-CALC        PIC X.
  2555                 88  CO-EARN-BY-R78             VALUE '1'.
  2556                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2557                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2558                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2559                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2560                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2561                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2562                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2563
  2564             20  CF-CO-REFUND-CALC          PIC X.
  2565                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2566                 88  CO-REFD-BY-R78             VALUE '1'.
  2567                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2568                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2569                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2570                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2571                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2572                 88  CO-REFD-MEAN               VALUE '8'.
  2573                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2574                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2575                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2576
  2577             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2578                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2579                 88  CO-OVRD-BY-R78             VALUE '1'.
  2580                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2581                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2582                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2583                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2584                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2585                 88  CO-OVRD-MEAN               VALUE '8'.
  2586                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2587
  2588             20  CF-CO-BEN-I-G-CD           PIC X.
  2589                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2590                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2591                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2592
  2593         16  FILLER                         PIC X(304).
  2594
  2595
  2596****************************************************************
  2597*             CARRIER MASTER RECORD                            *
  2598****************************************************************
  2599
  2600     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2601         16  CF-ADDRESS-DATA.
  2602             20  CF-MAIL-TO-NAME            PIC X(30).
  2603             20  CF-IN-CARE-OF              PIC X(30).
  2604             20  CF-ADDRESS-LINE-1          PIC X(30).
  2605             20  CF-ADDRESS-LINE-2          PIC X(30).
  2606             20  CF-CITY-STATE              PIC X(30).
  2607             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2608             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2609
  2610         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  53
* EL6509.cbl
  2611             20  CF-CLAIM-NO-METHOD         PIC X.
  2612                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2613                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2614                 88  CLAIM-NO-SEQ               VALUE '3'.
  2615                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2616             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2617                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2618                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2619                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2620
  2621         16  CF-CHECK-NO-CONTROL.
  2622             20  CF-CHECK-NO-METHOD         PIC X.
  2623                 88  CHECK-NO-MANUAL            VALUE '1'.
  2624                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2625                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2626                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2627             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2628                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2629
  2630         16  CF-DOMICILE-STATE              PIC XX.
  2631
  2632         16  CF-EXPENSE-CONTROLS.
  2633             20  CF-EXPENSE-METHOD          PIC X.
  2634                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2635                 88  DOLLARS-PER-PMT            VALUE '2'.
  2636                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2637                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2638             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2639             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2640
  2641         16  CF-CORRESPONDENCE-CONTROL.
  2642             20  CF-LETTER-RESEND-OPT       PIC X.
  2643                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2644                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2645             20  FILLER                     PIC X(4).
  2646
  2647         16  CF-RESERVE-CONTROLS.
  2648             20  CF-MANUAL-SW               PIC X.
  2649                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2650             20  CF-FUTURE-SW               PIC X.
  2651                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2652             20  CF-PTC-SW                  PIC X.
  2653                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2654             20  CF-IBNR-SW                 PIC X.
  2655                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2656             20  CF-PTC-LF-SW               PIC X.
  2657                 88  CF-LF-PTC-USED             VALUE '1'.
  2658             20  CF-CDT-ACCESS-METHOD       PIC X.
  2659                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2660                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2661                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2662             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2663
  2664         16  CF-CLAIM-CALC-METHOD           PIC X.
  2665             88  360-PLUS-MONTHS                VALUE '1'.
  2666             88  365-PLUS-MONTHS                VALUE '2'.
  2667             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2668             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  54
* EL6509.cbl
  2669             88  365-DAILY                      VALUE '5'.
  2670
  2671         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2672         16  FILLER                         PIC X(11).
  2673
  2674         16  CF-LIMIT-AMOUNTS.
  2675             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2676             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2677             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2678             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2679             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2680             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2681             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2682             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2683             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2684             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2685
  2686         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2687         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2688         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2689
  2690         16  CF-ZIP-CODE.
  2691             20  CF-ZIP-PRIME.
  2692                 24  CF-ZIP-1ST             PIC X.
  2693                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2694                 24  FILLER                 PIC X(4).
  2695             20  CF-ZIP-PLUS4               PIC X(4).
  2696         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2697             20  CF-CAN-POSTAL-1            PIC XXX.
  2698             20  CF-CAN-POSTAL-2            PIC XXX.
  2699             20  FILLER                     PIC XXX.
  2700
  2701         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2702         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2703         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2704
  2705         16  CF-RATING-SWITCH               PIC X.
  2706             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2707             88  CF-NO-RATING                   VALUE 'N'.
  2708
  2709         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2710
  2711         16  CF-CARRIER-OVER-SHORT.
  2712             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2713             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2714
  2715         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2716         16  CF-SECPAY-SWITCH               PIC X.
  2717             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2718             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2719         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2720         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2721         16  FILLER                         PIC X(444).
  2722*        16  FILLER                         PIC X(452).
  2723
  2724
  2725****************************************************************
  2726*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  55
* EL6509.cbl
  2727****************************************************************
  2728
  2729     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2730         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2731                                INDEXED BY CF-MORT-NDX.
  2732             20  CF-MORT-TABLE              PIC X(5).
  2733             20  CF-MORT-TABLE-TYPE         PIC X.
  2734                 88  CF-MORT-JOINT              VALUE 'J'.
  2735                 88  CF-MORT-SINGLE             VALUE 'S'.
  2736                 88  CF-MORT-COMBINED           VALUE 'C'.
  2737                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2738                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2739             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2740             20  CF-MORT-AGE-METHOD         PIC XX.
  2741                 88  CF-AGE-LAST                VALUE 'AL'.
  2742                 88  CF-AGE-NEAR                VALUE 'AN'.
  2743             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2744             20  CF-MORT-ADJUSTMENT-DIRECTION
  2745                                            PIC X.
  2746                 88  CF-MINUS                   VALUE '-'.
  2747                 88  CF-PLUS                    VALUE '+'.
  2748             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2749             20  CF-MORT-JOINT-CODE         PIC X.
  2750                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2751             20  CF-MORT-PC-Q               PIC X.
  2752                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2753             20  CF-MORT-TABLE-CODE         PIC X(4).
  2754             20  CF-MORT-COMMENTS           PIC X(15).
  2755             20  FILLER                     PIC X(14).
  2756
  2757         16  FILLER                         PIC X(251).
  2758
  2759
  2760****************************************************************
  2761*             BUSSINESS TYPE MASTER RECORD                     *
  2762****************************************************************
  2763
  2764     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2765* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2766* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2767* AND RECORD 05 IS TYPES 81-99
  2768         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2769             20  CF-BUSINESS-TITLE          PIC  X(19).
  2770             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2771                                            PIC S9V9(4) COMP-3.
  2772             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2773             20  FILLER                     PIC  X.
  2774         16  FILLER                         PIC  X(248).
  2775
  2776
  2777****************************************************************
  2778*             TERMINAL MASTER RECORD                           *
  2779****************************************************************
  2780
  2781     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2782
  2783         16  CF-COMPANY-TERMINALS.
  2784             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  56
* EL6509.cbl
  2785                                  PIC X(4).
  2786         16  FILLER               PIC X(248).
  2787
  2788
  2789****************************************************************
  2790*             LIFE EDIT MASTER RECORD                          *
  2791****************************************************************
  2792
  2793     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2794         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2795             20  CF-LIFE-CODE-IN            PIC XX.
  2796             20  CF-LIFE-CODE-OUT           PIC XX.
  2797         16  FILLER                         PIC X(248).
  2798
  2799
  2800****************************************************************
  2801*             AH EDIT MASTER RECORD                            *
  2802****************************************************************
  2803
  2804     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2805         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2806             20  CF-AH-CODE-IN              PIC XXX.
  2807             20  CF-AH-CODE-OUT             PIC XX.
  2808         16  FILLER                         PIC X(248).
  2809
  2810
  2811****************************************************************
  2812*             CREDIBILITY TABLES                               *
  2813****************************************************************
  2814
  2815     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2816         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2817                             INDEXED BY CF-CRDB-NDX.
  2818             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2819             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2820             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2821         16  FILLER                         PIC  X(332).
  2822
  2823
  2824****************************************************************
  2825*             REPORT CUSTOMIZATION RECORD                      *
  2826****************************************************************
  2827
  2828     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2829         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2830             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2831             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2832             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2833**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2834****       A T-TRANSFER.                                   ****
  2835             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2836
  2837         16  FILLER                         PIC XX.
  2838
  2839         16  CF-CARRIER-CNTL-OPT.
  2840             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2841                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2842                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  57
* EL6509.cbl
  2843             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2844                                            PIC X.
  2845         16  CF-GROUP-CNTL-OPT.
  2846             20  CF-GROUP-OPT-SEQ           PIC 9.
  2847                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2848                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2849             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2850                                            PIC X(6).
  2851         16  CF-STATE-CNTL-OPT.
  2852             20  CF-STATE-OPT-SEQ           PIC 9.
  2853                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2854                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2855             20  CF-STATE-SELECT OCCURS 3 TIMES
  2856                                            PIC XX.
  2857         16  CF-ACCOUNT-CNTL-OPT.
  2858             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2859                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2860                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2861             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2862                                            PIC X(10).
  2863         16  CF-BUS-TYP-CNTL-OPT.
  2864             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2865                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2866                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2867             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2868                                            PIC XX.
  2869         16  CF-LF-TYP-CNTL-OPT.
  2870             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2871                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2872                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2873             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2874                                            PIC XX.
  2875         16  CF-AH-TYP-CNTL-OPT.
  2876             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2877                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2878                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2879             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2880                                            PIC XX.
  2881         16  CF-REPTCD1-CNTL-OPT.
  2882             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2883                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2884                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2885             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2886                                            PIC X(10).
  2887         16  CF-REPTCD2-CNTL-OPT.
  2888             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2889                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2890                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2891             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2892                                            PIC X(10).
  2893         16  CF-USER1-CNTL-OPT.
  2894             20  CF-USER1-OPT-SEQ           PIC 9.
  2895                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2896                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2897             20  CF-USER1-SELECT OCCURS 3 TIMES
  2898                                            PIC X(10).
  2899         16  CF-USER2-CNTL-OPT.
  2900             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  58
* EL6509.cbl
  2901                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2902                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2903             20  CF-USER2-SELECT OCCURS 3 TIMES
  2904                                            PIC X(10).
  2905         16  CF-USER3-CNTL-OPT.
  2906             20  CF-USER3-OPT-SEQ           PIC 9.
  2907                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2908                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2909             20  CF-USER3-SELECT OCCURS 3 TIMES
  2910                                            PIC X(10).
  2911         16  CF-USER4-CNTL-OPT.
  2912             20  CF-USER4-OPT-SEQ           PIC 9.
  2913                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2914                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2915             20  CF-USER4-SELECT OCCURS 3 TIMES
  2916                                            PIC X(10).
  2917         16  CF-USER5-CNTL-OPT.
  2918             20  CF-USER5-OPT-SEQ           PIC 9.
  2919                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2920                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2921             20  CF-USER5-SELECT OCCURS 3 TIMES
  2922                                            PIC X(10).
  2923         16  CF-REINS-CNTL-OPT.
  2924             20  CF-REINS-OPT-SEQ           PIC 9.
  2925                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2926                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2927             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2928                 24  CF-REINS-PRIME         PIC XXX.
  2929                 24  CF-REINS-SUB           PIC XXX.
  2930
  2931         16  CF-AGENT-CNTL-OPT.
  2932             20  CF-AGENT-OPT-SEQ           PIC 9.
  2933                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2934                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2935             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2936                                            PIC X(10).
  2937
  2938         16  FILLER                         PIC X(43).
  2939
  2940         16  CF-LOSS-RATIO-SELECT.
  2941             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2942             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2943         16  CF-ENTRY-DATE-SELECT.
  2944             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2945             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2946         16  CF-EFFECTIVE-DATE-SELECT.
  2947             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2948             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2949
  2950         16  CF-EXCEPTION-LIST-IND          PIC X.
  2951             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2952
  2953         16  FILLER                         PIC X(318).
  2954
  2955****************************************************************
  2956*                  EXCEPTION REPORTING RECORD                  *
  2957****************************************************************
  2958
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  59
* EL6509.cbl
  2959     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2960         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2961             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2962
  2963         16  CF-COMBINED-LIFE-AH-OPT.
  2964             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2965             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2966             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2967             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2968
  2969         16  CF-LIFE-OPT.
  2970             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2971             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2972             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2973             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2974             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2975             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2976             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2977             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2978             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2979             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2980
  2981         16  CF-AH-OPT.
  2982             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2983             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2984             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2985             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2986             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2987             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2988             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2989             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2990             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2991             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2992
  2993         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2994             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2995             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2996             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2997
  2998         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2999
  3000         16  FILLER                         PIC X(673).
  3001
  3002
  3003****************************************************************
  3004*             MORTGAGE SYSTEM PLAN RECORD                      *
  3005****************************************************************
  3006
  3007     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3008         16  CF-PLAN-TYPE                   PIC X.
  3009             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3010             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3011             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3012         16  CF-PLAN-ABBREV                 PIC XXX.
  3013         16  CF-PLAN-DESCRIPT               PIC X(10).
  3014         16  CF-PLAN-NOTES                  PIC X(20).
  3015         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3016         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  60
* EL6509.cbl
  3017             20  CF-PLAN-TERM-DATA.
  3018                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3019                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3020             20  CF-PLAN-AGE-DATA.
  3021                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3022                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3023                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3024             20  CF-PLAN-BENEFIT-DATA.
  3025                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3026                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3027                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3028                                            PIC S9(7)V99  COMP-3.
  3029         16  CF-PLAN-POLICY-FORMS.
  3030             20  CF-POLICY-FORM             PIC X(12).
  3031             20  CF-MASTER-APPLICATION      PIC X(12).
  3032             20  CF-MASTER-POLICY           PIC X(12).
  3033         16  CF-PLAN-RATING.
  3034             20  CF-RATE-CODE               PIC X(5).
  3035             20  CF-SEX-RATING              PIC X.
  3036                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3037                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3038             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3039             20  CF-SUB-STD-TYPE            PIC X.
  3040                 88  CF-PCT-OF-PREM            VALUE '1'.
  3041                 88  CF-PCT-OF-BENE            VALUE '2'.
  3042         16  CF-PLAN-PREM-TOLERANCES.
  3043             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3044             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3045         16  CF-PLAN-PYMT-TOLERANCES.
  3046             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3047             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3048         16  CF-PLAN-MISC-DATA.
  3049             20  FILLER                     PIC X.
  3050             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3051             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3052         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3053         16  CF-PLAN-IND-GRP                PIC X.
  3054             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3055                                                     '1'.
  3056             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3057                                                     '2'.
  3058         16  CF-MIB-SEARCH-SW               PIC X.
  3059             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3060             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3061             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3062             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3063         16  CF-ALPHA-SEARCH-SW             PIC X.
  3064             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3065             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3066             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3067             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3068             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3069             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3070             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3071             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3072             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3073             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3074                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  61
* EL6509.cbl
  3075                                                     'X' 'Y' 'Z'.
  3076         16  CF-EFF-DT-RULE-SW              PIC X.
  3077             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3078             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3079             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3080             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3081             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3082         16  FILLER                         PIC X(4).
  3083         16  CF-HEALTH-QUESTIONS            PIC X.
  3084             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3085         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3086         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3087         16  CF-PLAN-SNGL-JNT               PIC X.
  3088             88  CF-COMBINED-PLAN              VALUE 'C'.
  3089             88  CF-JNT-PLAN                   VALUE 'J'.
  3090             88  CF-SNGL-PLAN                  VALUE 'S'.
  3091         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3092         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3093         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3094         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3095         16  CF-RERATE-CNTL                 PIC  X.
  3096             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3097             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3098             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3099             88  CF-AUTO-RECALC                 VALUE '4'.
  3100         16  CF-BENEFIT-TYPE                PIC  X.
  3101             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3102             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3103         16  CF-POLICY-FEE                  PIC S999V99
  3104                                                    COMP-3.
  3105         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3106         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3107         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3108         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3109         16  FILLER                         PIC  X(32).
  3110         16  CF-TERMINATION-FORM            PIC  X(04).
  3111         16  FILLER                         PIC  X(08).
  3112         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3113                                                       COMP-3.
  3114         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3115         16  CF-ISSUE-LETTER                PIC  X(4).
  3116         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3117         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3118             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3119             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3120         16  CF-MP-REFUND-CALC              PIC X.
  3121             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3122             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3123             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3124             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3125             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3126             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3127             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3128             88  CF-MP-REFD-MEAN                VALUE '8'.
  3129         16  CF-ALT-RATE-CODE               PIC  X(5).
  3130
  3131
  3132         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  62
* EL6509.cbl
  3133****************************************************************
  3134*             MORTGAGE COMPANY MASTER RECORD                   *
  3135****************************************************************
  3136
  3137     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3138         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3139         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3140             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3141             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3142             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3143             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3144             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3145
  3146         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3147         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3148         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3149         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3150         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3151
  3152         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3153             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3154         16  CF-MP-RECON-USE-IND            PIC X(1).
  3155             88  CF-MP-USE-RECON             VALUE 'Y'.
  3156         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3157             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3158         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3159             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3160             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3161         16  FILLER                         PIC X(1).
  3162         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3163             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3164         16  CF-MORTG-MIB-VERSION           PIC X.
  3165             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3166             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3167             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3168         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3169             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3170                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3171             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3172                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3173             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3174                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3175             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3176                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3177             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3178                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3179             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3180                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3181         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3182         16  FILLER                         PIC X(7).
  3183         16  CF-MORTG-DESTINATION-SYMBOL.
  3184             20  CF-MORTG-MIB-COMM          PIC X(5).
  3185             20  CF-MORTG-MIB-TERM          PIC X(5).
  3186         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3187             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3188         16  FILLER                         PIC X(03).
  3189         16  CF-MP-CHECK-NO-CONTROL.
  3190             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  63
* EL6509.cbl
  3191                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3192                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3193                                                ' ' LOW-VALUES.
  3194                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3195                                               VALUE '3'.
  3196         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3197         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3198         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3199             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3200                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3201             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3202                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3203             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3204                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3205             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3206                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3207             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3208                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3209             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3210                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3211         16  CF-MORTG-BILLING-AREA.
  3212             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3213                                            PIC X.
  3214         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3215         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3216         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3217         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3218             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3219             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3220         16  FILLER                         PIC X.
  3221         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3222             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3223             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3224         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3225         16  FILLER                         PIC X(8).
  3226         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3227         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3228         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3229         16  CF-ACH-COMPANY-ID.
  3230             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3231                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3232                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3233                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3234             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3235         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3236             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3237         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3238             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3239             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3240         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3241         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3242         16  FILLER                         PIC X(536).
  3243
  3244****************************************************************
  3245*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3246****************************************************************
  3247
  3248     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  64
* EL6509.cbl
  3249         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3250             20  CF-FEMALE-HEIGHT.
  3251                 24  CF-FEMALE-FT           PIC 99.
  3252                 24  CF-FEMALE-IN           PIC 99.
  3253             20  CF-FEMALE-MIN-WT           PIC 999.
  3254             20  CF-FEMALE-MAX-WT           PIC 999.
  3255         16  FILLER                         PIC X(428).
  3256
  3257     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3258         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3259             20  CF-MALE-HEIGHT.
  3260                 24  CF-MALE-FT             PIC 99.
  3261                 24  CF-MALE-IN             PIC 99.
  3262             20  CF-MALE-MIN-WT             PIC 999.
  3263             20  CF-MALE-MAX-WT             PIC 999.
  3264         16  FILLER                         PIC X(428).
  3265******************************************************************
  3266*             AUTOMATIC ACTIVITY RECORD                          *
  3267******************************************************************
  3268     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3269         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3270             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3271             20  CF-SYS-LETTER-ID           PIC X(04).
  3272             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3273             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3274             20  CF-SYS-RESET-SW            PIC X(01).
  3275             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3276             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3277
  3278         16  FILLER                         PIC X(50).
  3279
  3280         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3281             20  CF-USER-ACTIVE-SW          PIC X(01).
  3282             20  CF-USER-LETTER-ID          PIC X(04).
  3283             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3284             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3285             20  CF-USER-RESET-SW           PIC X(01).
  3286             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3287             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3288             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3289
  3290         16  FILLER                         PIC X(246).
  3291 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA NOTE-FILE
  3292                          CONTROL-FILE.
  3293 0000-DFHEXIT SECTION.
  3294     MOVE '9#                    $   ' TO DFHEIV0.
  3295     MOVE 'EL6509' TO DFHEIV1.
  3296     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3297
  3298     MOVE EIBTRMID               TO QID-TERM.
  3299     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  3300     MOVE '5'                    TO DC-OPTION-CODE.
  3301     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3302     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  3303     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  3304
  3305     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK
  3306     IF EIBCALEN = ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  65
* EL6509.cbl
  3307         GO TO 8800-UNAUTHORIZED-ACCESS.
  3308
  3309     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3310        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3311           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3312           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3313           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3314           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3315           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3316           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3317           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3318           MOVE THIS-PGM TO PI-CALLING-PROGRAM
  3319        ELSE
  3320           MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3321           MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3322           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3323           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3324           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3325           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3326           MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3327           MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  3328
  3329     MOVE LOW-VALUES TO EL6509AI.
  3330     MOVE SPACES                 TO  ERACNT-KEY.
  3331
  3332     IF PI-RETURN-TO-PROGRAM = PGM-EL650
  3333        OR PI-ACCT-NOTE
  3334        MOVE '1'                 TO  ERACNT-REC-TYP
  3335        MOVE 'A'                 TO  PI-NOTE-TYPE
  3336        MOVE PI-ACCT-CARRIER     TO  ERACNT-CARRIER
  3337                                     PI-CR-CARRIER
  3338                                     VG-CARRIER
  3339        MOVE PI-ACCT-GROUPING    TO  ERACNT-GROUPING
  3340                                     VG-GROUPING
  3341                                     PI-CR-GROUPING
  3342        MOVE PI-ACCT-STATE       TO  ERACNT-STATE
  3343                                     PI-CR-STATE
  3344                                     VG-STATE
  3345        MOVE PI-ACCT-ACCOUNT     TO  ERACNT-ACCOUNT
  3346                                     PI-CR-ACCOUNT
  3347                                     VG-ACCOUNT.
  3348
  3349     IF ACCNT-CNTL
  3350         MOVE SPACES             TO  ERACNT-CARRIER
  3351                                     VG-CARRIER
  3352                                     ERACNT-GROUPING
  3353                                     VG-GROUPING
  3354                                     ERACNT-STATE
  3355                                     VG-STATE.
  3356
  3357     IF ST-ACCNT-CNTL
  3358         MOVE SPACES             TO  ERACNT-CARRIER
  3359                                     VG-CARRIER
  3360                                     VG-GROUPING
  3361                                     ERACNT-GROUPING.
  3362
  3363     IF CARR-ACCNT-CNTL
  3364         MOVE SPACES             TO  ERACNT-GROUPING
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  66
* EL6509.cbl
  3365                                     ERACNT-STATE
  3366                                     VG-STATE.
  3367
  3368     IF CARR-ST-ACCNT-CNTL
  3369         MOVE SPACES             TO  ERACNT-GROUPING.
  3370
  3371     MOVE PI-COMPANY-CD          TO  ERACNT-COMPANY-CD.
  3372     MOVE ZEROS                  TO  ERACNT-SEQ.
  3373     MOVE ERACNT-PARTIAL-KEY     TO  SV-PRIOR-KEY.
  3374
  3375     IF EIBTRNID NOT = TRANS-ID
  3376        MOVE '0'                 TO  PI-UPDATE-SW
  3377        IF PI-PROCESSOR-ID NOT = 'LGXX'
  3378
  3379* EXEC CICS READQ TS
  3380*                    QUEUE (PI-SECURITY-TEMP-STORE-ID)
  3381*                    INTO (SECURITY-CONTROL)
  3382*                    LENGTH (SC-COMM-LENGTH)
  3383*                    ITEM  (SC-ITEM)
  3384*                    END-EXEC
  3385*    MOVE '*$II   L              ''   #00003374' TO DFHEIV0
  3386     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3387     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3388     MOVE X'2020233030303033333734' TO DFHEIV0(25:11)
  3389     CALL 'kxdfhei1' USING DFHEIV0,
  3390           PI-SECURITY-TEMP-STORE-ID,
  3391           SECURITY-CONTROL,
  3392           SC-COMM-LENGTH,
  3393           SC-ITEM,
  3394           DFHEIV99,
  3395           DFHEIV99
  3396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3397          MOVE SC-CREDIT-DISPLAY (25) TO PI-DISPLAY-CAP
  3398          MOVE SC-CREDIT-UPDATE (25)  TO PI-MODIFY-CAP.
  3399
  3400     IF NOT DISPLAY-CAP
  3401         MOVE 'READ'             TO  SM-READ
  3402         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3403         MOVE ER-0070            TO  EMI-ERROR
  3404         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3405         GO TO 8100-SEND-INITIAL-MAP.
  3406
  3407
  3408* EXEC CICS HANDLE AID
  3409*         CLEAR(9400-CLEAR)
  3410*    END-EXEC.
  3411*    MOVE '"&=                  V! " #00003390' TO DFHEIV0
  3412     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  3413     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  3414     MOVE X'2220233030303033333930' TO DFHEIV0(25:11)
  3415     CALL 'kxdfhei1' USING DFHEIV0
  3416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3417
  3418
  3419
  3420* EXEC CICS HANDLE CONDITION
  3421*         ERROR(9990-ABEND)
  3422*         PGMIDERR(9600-PGMID-ERROR)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  67
* EL6509.cbl
  3423*    END-EXEC.
  3424*    MOVE '"$.L                  ! # #00003394' TO DFHEIV0
  3425     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  3426     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3427     MOVE X'2320233030303033333934' TO DFHEIV0(25:11)
  3428     CALL 'kxdfhei1' USING DFHEIV0
  3429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3430
  3431
  3432     IF EIBTRNID NOT = TRANS-ID
  3433         GO TO 7000-BUILD-TABLE.
  3434
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  68
* EL6509.cbl
  3436 2000-RECEIVE.
  3437     IF EIBAID = DFHPA1 OR
  3438        EIBAID = DFHPA2 OR
  3439        EIBAID = DFHPA3
  3440           MOVE ER-0008 TO EMI-ERROR
  3441           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3442           GO TO 8200-SEND-DATAONLY.
  3443
  3444
  3445* EXEC CICS RECEIVE
  3446*         MAP(MAP-NAME)
  3447*         MAPSET(MAPSET-NAME)
  3448*         INTO(EL6509AI)
  3449*         END-EXEC.
  3450     MOVE LENGTH OF
  3451      EL6509AI
  3452       TO DFHEIV11
  3453*    MOVE '8"T I  L              ''   #00003411' TO DFHEIV0
  3454     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3455     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3456     MOVE X'2020233030303033343131' TO DFHEIV0(25:11)
  3457     CALL 'kxdfhei1' USING DFHEIV0,
  3458           MAP-NAME,
  3459           EL6509AI,
  3460           DFHEIV11,
  3461           MAPSET-NAME,
  3462           DFHEIV99,
  3463           DFHEIV99
  3464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3465
  3466
  3467     IF PFENTERL = ZEROS
  3468        GO TO 2001-CHECK-PFKEYS.
  3469
  3470     IF EIBAID NOT = DFHENTER
  3471        MOVE ER-0004             TO EMI-ERROR
  3472        GO TO 2002-INPUT-ERROR.
  3473
  3474     IF PFENTERI NUMERIC AND
  3475        (PFENTERI > 00 AND  < 25)
  3476        MOVE PF-VALUES (PFENTERI) TO EIBAID
  3477        ELSE
  3478        MOVE ER-0029 TO EMI-ERROR
  3479        GO TO 2002-INPUT-ERROR.
  3480
  3481 2001-CHECK-PFKEYS.
  3482     IF EIBAID = DFHPF23
  3483        GO TO 9000-RETURN-CICS.
  3484
  3485     IF EIBAID = DFHPF24
  3486        GO TO 9200-RETURN-MAIN-MENU.
  3487
  3488     IF EIBAID = DFHPF12
  3489        GO TO 9500-PF12.
  3490
  3491     IF FUNCTL NOT = ZEROS AND EIBAID NOT = DFHENTER
  3492        IF FUNCTI = 'A' OR = SPACES
  3493           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  69
* EL6509.cbl
  3494           ELSE
  3495           MOVE ER-0050          TO EMI-ERROR
  3496           MOVE -1 TO FUNCTL
  3497           MOVE AL-UABON TO FUNCTA PFENTERA
  3498           GO TO 2002-INPUT-ERROR.
  3499
  3500     IF EIBAID = DFHPF1
  3501        MOVE NUM-LINES-PER-SCREEN TO ROLL-COUNTER
  3502        GO TO 7400-PAGE-ROUTINE.
  3503
  3504     IF EIBAID = DFHPF2
  3505        SUBTRACT NUM-LINES-PER-SCREEN FROM ROLL-COUNTER
  3506        GO TO 7400-PAGE-ROUTINE.
  3507
  3508     IF EIBAID = DFHPF3
  3509        MOVE 5                   TO ROLL-COUNTER
  3510        GO TO 7400-PAGE-ROUTINE.
  3511
  3512     IF EIBAID = DFHPF4
  3513        MOVE -5                  TO ROLL-COUNTER
  3514        GO TO 7400-PAGE-ROUTINE.
  3515
  3516     IF EIBAID = DFHPF8
  3517        GO TO 4500-SAVE-DATA.
  3518
  3519     IF EIBAID = DFHENTER
  3520        GO TO 2003-EDIT-DATA.
  3521
  3522     MOVE ER-0029                TO EMI-ERROR.
  3523
  3524 2002-INPUT-ERROR.
  3525     MOVE -1                     TO PFENTERL
  3526     MOVE AL-UNBON               TO PFENTERA
  3527     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3528     GO TO 8200-SEND-DATAONLY.
  3529
  3530 2003-EDIT-DATA.
  3531
  3532     IF FUNCTI = 'L'
  3533         NEXT SENTENCE
  3534     ELSE
  3535         IF NOT MODIFY-CAP
  3536             MOVE 'UPDATE'       TO  SM-READ
  3537             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3538             MOVE ER-0070        TO  EMI-ERROR
  3539             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3540             GO TO 8100-SEND-INITIAL-MAP.
  3541
  3542     IF FUNCTL = ZEROS OR FUNCTI = SPACES
  3543        GO TO 4000-CHANGE-ROUTINE.
  3544
  3545     IF (FUNCTI = 'S' OR = 'D' OR = 'Q' OR
  3546                = 'I' OR = 'A' OR = 'L')
  3547         NEXT SENTENCE
  3548     ELSE
  3549         MOVE ER-0023            TO EMI-ERROR
  3550         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3551         MOVE AL-UABON           TO FUNCTA
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  70
* EL6509.cbl
  3552         MOVE -1                 TO FUNCTL
  3553         GO TO 8200-SEND-DATAONLY.
  3554
  3555     IF FUNCTI = 'D'  OR = 'I' OR = 'L'
  3556        PERFORM 2500-LINE-CHECK THRU 2599-EXIT
  3557        ELSE
  3558        IF LINE1L NOT = ZEROS OR
  3559           LINE2L NOT = ZEROS
  3560           MOVE ER-0030          TO EMI-ERROR
  3561           MOVE -1               TO LINE1L
  3562           MOVE AL-UNBON         TO LINE1A LINE2A
  3563           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3564           GO TO 8200-SEND-DATAONLY.
  3565
  3566     IF FUNCTI = 'A'
  3567        GO TO 5000-ADD-NEW-LINES.
  3568     IF FUNCTI = 'Q'
  3569        GO TO 9410-RETURN.
  3570     IF FUNCTI = 'S'
  3571        GO TO 4500-SAVE-DATA.
  3572     IF PI-TOTAL-LINES = 0
  3573        MOVE ER-0048             TO EMI-ERROR
  3574        MOVE -1                  TO FUNCTL
  3575        MOVE AL-UNBON            TO FUNCTA
  3576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3577        GO TO 8200-SEND-DATAONLY.
  3578     IF FUNCTI = 'L'
  3579        GO TO 5500-LOOKUP.
  3580     IF FUNCTI = 'D'
  3581        GO TO 3000-DELETE-LINES.
  3582
  3583     GO TO 3500-INSERT-LINES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  71
* EL6509.cbl
  3585 2500-LINE-CHECK.
  3586     IF LINE1L = ZEROS AND
  3587        LINE2L = ZEROS
  3588        MOVE ER-0069             TO EMI-ERROR
  3589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3590        MOVE -1                  TO LINE1L
  3591        GO TO 8200-SEND-DATAONLY.
  3592
  3593     IF LINE1L NOT = ZEROS
  3594        IF LINE1I NOT NUMERIC OR
  3595           LINE1I > PI-TOTAL-LINES
  3596           MOVE ER-0031          TO EMI-ERROR
  3597           MOVE AL-UNBON         TO LINE1A
  3598           MOVE -1               TO LINE1L
  3599           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3600           GO TO 8200-SEND-DATAONLY
  3601         ELSE
  3602           IF LINE2L = ZEROS
  3603              MOVE 1             TO LINE2I
  3604              IF FUNCTI = 'I'
  3605                  GO TO 2510-MAX-CHECK
  3606               ELSE NEXT SENTENCE
  3607           ELSE
  3608              IF FUNCTI = 'I'
  3609                 GO TO 2510-MAX-CHECK
  3610              ELSE
  3611                 IF LINE2I NOT NUMERIC
  3612                    MOVE AL-UNBON TO LINE2A
  3613                    MOVE ER-0032  TO EMI-ERROR
  3614                    MOVE -1       TO LINE2L
  3615                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3616                    GO TO 8200-SEND-DATAONLY
  3617                 ELSE
  3618                    NEXT SENTENCE
  3619     ELSE
  3620        IF LINE2L = ZEROS
  3621           NEXT SENTENCE
  3622         ELSE
  3623           MOVE -1               TO LINE2L
  3624           MOVE ER-0041          TO EMI-ERROR
  3625           MOVE AL-UNBON         TO LINE2A
  3626           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3627           GO TO 8200-SEND-DATAONLY.
  3628     GO TO 2599-EXIT.
  3629 2510-MAX-CHECK.
  3630     IF LINE2I NOT NUMERIC
  3631        MOVE -1                  TO LINE2L
  3632        MOVE ER-0032             TO EMI-ERROR
  3633        MOVE AL-UNBON            TO LINE2A
  3634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3635        GO TO 8200-SEND-DATAONLY
  3636        ELSE
  3637        COMPUTE ROLL-COUNTER = LINE2I + PI-TOTAL-LINES
  3638        IF ROLL-COUNTER GREATER THAN MAX-LINES
  3639           MOVE -1               TO LINE2L
  3640           MOVE ER-0044          TO EMI-ERROR
  3641           MOVE AL-UNBON         TO LINE2A
  3642           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  72
* EL6509.cbl
  3643           GO TO 8200-SEND-DATAONLY.
  3644 2599-EXIT.
  3645      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  73
* EL6509.cbl
  3647 3000-DELETE-LINES.
  3648     IF LINE2L = ZEROS AND LINE2I = 1
  3649        MOVE LINE1I              TO LINE2I.
  3650
  3651     IF LINE2I > PI-TOTAL-LINES OR < LINE1I
  3652        MOVE ER-0049             TO EMI-ERROR
  3653        MOVE AL-UNBON            TO LINE2A
  3654        MOVE -1                  TO LINE2L
  3655        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3656        GO TO 8200-SEND-DATAONLY.
  3657
  3658     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3659     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3660             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3661             SC-INDX > NUM-LINES-PER-SCREEN
  3662     SET TB-INDX TO LINE1I.
  3663
  3664     PERFORM 3050-CHECK-FOR-CURRENT-DATE
  3665        UNTIL TB-INDX > LINE2I.
  3666
  3667     IF NOT EMI-NO-ERRORS
  3668        GO TO 8200-SEND-DATAONLY.
  3669
  3670     SET TB-INDX TO LINE1I
  3671     COMPUTE ROLL-COUNTER = LINE2I - LINE1I + 1.
  3672
  3673     IF LINE2I NOT = PI-TOTAL-LINES
  3674        SET TB-INDX1 TO LINE2I
  3675        SET TB-INDX1 UP BY 1
  3676        PERFORM 3100-DELETE-TABLE-ENTRIES
  3677                UNTIL TB-INDX1 > PI-TOTAL-LINES.
  3678
  3679     PERFORM 3150-BLANK-TABLE-ENTRIES
  3680             ROLL-COUNTER TIMES
  3681     SUBTRACT ROLL-COUNTER FROM PI-TOTAL-LINES
  3682
  3683     IF PI-CURRENT-LINE > PI-TOTAL-LINES
  3684        MOVE PI-TOTAL-LINES      TO PI-CURRENT-LINE
  3685        SUBTRACT 1 FROM PI-CURRENT-LINE.
  3686
  3687     SET TB-INDX  TO PI-CURRENT-LINE
  3688     MOVE LOW-VALUES             TO EL6509AI
  3689
  3690     IF PI-CURRENT-LINE > ZERO
  3691         PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3692             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3693             SC-INDX > NUM-LINES-PER-SCREEN
  3694         PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT.
  3695
  3696     MOVE '1'                    TO PI-UPDATE-SW.
  3697     IF PI-TOTAL-LINES = ZEROS
  3698        MOVE ZEROS               TO PI-CURRENT-LINE.
  3699     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  74
* EL6509.cbl
  3701
  3702 3050-CHECK-FOR-CURRENT-DATE.
  3703     IF (REC-LAST-MAINT-DT (TB-INDX) = SAVE-BIN-DATE)
  3704        OR (PI-PROCESSOR-ID = 'PEMA' OR 'AJRA')
  3705        NEXT SENTENCE
  3706     ELSE
  3707        MOVE ER-3786             TO EMI-ERROR
  3708        MOVE AL-UNBON            TO FUNCTA
  3709        MOVE -1                  TO FUNCTL
  3710        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3711        GO TO 8200-SEND-DATAONLY.
  3712
  3713     IF REC-LAST-MAINT-BY (TB-INDX) = PI-PROCESSOR-ID
  3714        OR (PI-PROCESSOR-ID = 'PEMA' OR 'AJRA')
  3715        NEXT SENTENCE
  3716     ELSE
  3717        MOVE ER-3787             TO EMI-ERROR
  3718        MOVE AL-UNBON            TO FUNCTA
  3719        MOVE -1                  TO FUNCTL
  3720        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3721        GO TO 8200-SEND-DATAONLY.
  3722
  3723     SET TB-INDX TB-INDX1 UP BY 1.
  3724
  3725 3100-DELETE-TABLE-ENTRIES.
  3726     MOVE REC-ENT (TB-INDX1)     TO REC-ENT (TB-INDX)
  3727     SET TB-INDX TB-INDX1 UP BY 1.
  3728
  3729 3150-BLANK-TABLE-ENTRIES.
  3730     MOVE SPACES                 TO REC-ENT (TB-INDX).
  3731     MOVE LOW-VALUES             TO REC-LAST-MAINT-DT (TB-INDX).
  3732     MOVE ZERO                 TO REC-LAST-MAINT-HHMMSS (TB-INDX).
  3733     SET TB-INDX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  75
* EL6509.cbl
  3735 3500-INSERT-LINES.
  3736
  3737     PERFORM 7450-SET-INDX THRU 7450-EXIT
  3738     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3739             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3740             SC-INDX > NUM-LINES-PER-SCREEN
  3741
  3742     IF NOT EMI-NO-ERRORS
  3743        GO TO 8200-SEND-DATAONLY.
  3744
  3745     SET TB-INDX TO PI-TOTAL-LINES
  3746     ADD LINE2I TO PI-TOTAL-LINES
  3747     SET TB-INDX1 TO PI-TOTAL-LINES
  3748     PERFORM 3600-INSERT-TABLE-ENTRIES
  3749             UNTIL TB-INDX = LINE1I
  3750     SET TB-INDX UP BY 1.
  3751
  3752     COMPUTE ROLL-COUNTER = PI-CURRENT-LINE + NUM-LINES-PER-SCREEN
  3753     IF TB-INDX NOT LESS THAN ROLL-COUNTER OR
  3754                    LESS THAN PI-CURRENT-LINE
  3755        SET SC-INDX TO 1
  3756        SET SC-INDX DOWN BY 1
  3757     ELSE
  3758        SET ROLL-COUNTER TO TB-INDX
  3759        COMPUTE ROLL-COUNTER = ROLL-COUNTER - PI-CURRENT-LINE
  3760                  + 1
  3761        SET SC-INDX TO ROLL-COUNTER.
  3762
  3763     PERFORM 3150-BLANK-TABLE-ENTRIES LINE2I TIMES
  3764     SET TB-INDX TO PI-CURRENT-LINE
  3765     MOVE LOW-VALUES             TO EL6509AI
  3766
  3767     IF SC-INDX NOT = ZERO
  3768        MOVE -1 TO SC-TEXTL (SC-INDX).
  3769
  3770     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3771            VARYING SC-INDX FROM 1 BY 1 UNTIL
  3772            SC-INDX > NUM-LINES-PER-SCREEN
  3773     PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT
  3774     MOVE '1'                    TO PI-UPDATE-SW.
  3775     GO TO 8100-SEND-INITIAL-MAP.
  3776
  3777 3600-INSERT-TABLE-ENTRIES.
  3778     MOVE REC-ENT (TB-INDX)      TO REC-ENT (TB-INDX1)
  3779     SET TB-INDX TB-INDX1 DOWN BY 1.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  76
* EL6509.cbl
  3781
  3782 4000-CHANGE-ROUTINE.
  3783     PERFORM 7450-SET-INDX THRU 7450-EXIT
  3784     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3785             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3786             SC-INDX > NUM-LINES-PER-SCREEN.
  3787
  3788     IF NOT EMI-NO-ERRORS
  3789        GO TO 8200-SEND-DATAONLY.
  3790
  3791     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT
  3792     MOVE SPACES                 TO ERRMSGBO
  3793     GO TO 8200-SEND-DATAONLY.
  3794
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  77
* EL6509.cbl
  3796 4500-SAVE-DATA.
  3797     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3798     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3799             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3800             SC-INDX > NUM-LINES-PER-SCREEN.
  3801     IF NOT EMI-NO-ERRORS
  3802        GO TO 8200-SEND-DATAONLY.
  3803
  3804
  3805* EXEC CICS HANDLE CONDITION
  3806*         NOTFND(4610-ENDBR)
  3807*         NOTOPEN(6000-NOT-OPEN)
  3808*         ENDFILE(4610-ENDBR)
  3809*         END-EXEC.
  3810*    MOVE '"$IJ''                 ! $ #00003754' TO DFHEIV0
  3811     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3813     MOVE X'2420233030303033373534' TO DFHEIV0(25:11)
  3814     CALL 'kxdfhei1' USING DFHEIV0
  3815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3816
  3817
  3818 4610-LOOP.
  3819
  3820* EXEC CICS READ
  3821*        DATASET (ERACNT-FILE-ID)
  3822*        RIDFLD  (ERACNT-KEY)
  3823*        SET     (ADDRESS OF NOTE-FILE)
  3824*        GTEQ
  3825*        END-EXEC.
  3826*    MOVE '&"S        G          (   #00003761' TO DFHEIV0
  3827     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3828     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3829     MOVE X'2020233030303033373631' TO DFHEIV0(25:11)
  3830     CALL 'kxdfhei1' USING DFHEIV0,
  3831           ERACNT-FILE-ID,
  3832           DFHEIV20,
  3833           DFHEIV99,
  3834           ERACNT-KEY,
  3835           DFHEIV99,
  3836           DFHEIV99,
  3837           DFHEIV99
  3838     SET ADDRESS OF NOTE-FILE TO
  3839         DFHEIV20
  3840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3841
  3842
  3843     MOVE NT-CONTROL-PRIMARY     TO ERACNT-KEY.
  3844
  3845     IF ERACNT-PARTIAL-KEY NOT = SV-PRIOR-KEY
  3846         MOVE SV-PRIOR-KEY       TO ERACNT-PARTIAL-KEY
  3847         GO TO 4610-ENDBR.
  3848
  3849
  3850* EXEC CICS DELETE
  3851*        DATASET (ERACNT-FILE-ID)
  3852*        RIDFLD  (ERACNT-KEY)
  3853*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  78
* EL6509.cbl
  3854*    MOVE '&(  R                 &   #00003774' TO DFHEIV0
  3855     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3856     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3857     MOVE X'2020233030303033373734' TO DFHEIV0(25:11)
  3858     CALL 'kxdfhei1' USING DFHEIV0,
  3859           ERACNT-FILE-ID,
  3860           ERACNT-KEY,
  3861           DFHEIV99,
  3862           DFHEIV99,
  3863           DFHEIV99
  3864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3865
  3866
  3867     GO TO 4610-LOOP.
  3868 4610-ENDBR.
  3869
  3870* EXEC CICS GETMAIN
  3871*         LENGTH(ERACNT-LENGTH)
  3872*         SET(ADDRESS OF NOTE-FILE)
  3873*         INITIMG(GETMAIN-SPACE)
  3874*         END-EXEC.
  3875*    MOVE ',"IL                  $   #00003781' TO DFHEIV0
  3876     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3877     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3878     MOVE X'2020233030303033373831' TO DFHEIV0(25:11)
  3879     CALL 'kxdfhei1' USING DFHEIV0,
  3880           DFHEIV20,
  3881           ERACNT-LENGTH,
  3882           GETMAIN-SPACE
  3883     SET ADDRESS OF NOTE-FILE TO
  3884         DFHEIV20
  3885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3886
  3887
  3888     PERFORM 4700-WRITE-FILE THRU 4799-EXIT
  3889             VARYING TB-INDX FROM 1 BY 1 UNTIL
  3890             TB-INDX > PI-TOTAL-LINES.
  3891
  3892     IF EIBAID = DFHPF8
  3893           GO TO 9550-START-PRINT.
  3894
  3895     GO TO 9410-RETURN.
  3896
  3897 4700-WRITE-FILE.
  3898     MOVE SPACES                 TO  NOTE-FILE.
  3899     ADD 1 TO ERACNT-SEQ
  3900     MOVE ERACNT-KEY             TO  NT-CONTROL-PRIMARY.
  3901     MOVE  'NT'                  TO  NT-FILE-ID.
  3902     MOVE REC-TEXT (TB-INDX)     TO  NT-NOTE-LINE
  3903     MOVE REC-LAST-MAINT-BY (TB-INDX)
  3904                                 TO  NT-LAST-MAINT-BY.
  3905     MOVE REC-LAST-MAINT-HHMMSS (TB-INDX)
  3906                                 TO  NT-LAST-MAINT-HHMMSS.
  3907     MOVE REC-LAST-MAINT-DT (TB-INDX)
  3908                                 TO  NT-LAST-MAINT-DT.
  3909
  3910
  3911* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  79
* EL6509.cbl
  3912*         DATASET(ERACNT-FILE-ID)
  3913*         FROM(NOTE-FILE)
  3914*         RIDFLD(ERACNT-KEY)
  3915*         END-EXEC.
  3916     MOVE LENGTH OF
  3917      NOTE-FILE
  3918       TO DFHEIV11
  3919*    MOVE '&$ L                  ''   #00003809' TO DFHEIV0
  3920     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3921     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3922     MOVE X'2020233030303033383039' TO DFHEIV0(25:11)
  3923     CALL 'kxdfhei1' USING DFHEIV0,
  3924           ERACNT-FILE-ID,
  3925           NOTE-FILE,
  3926           DFHEIV11,
  3927           ERACNT-KEY,
  3928           DFHEIV99,
  3929           DFHEIV99
  3930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3931
  3932 4799-EXIT.
  3933      EXIT.
  3934
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  80
* EL6509.cbl
  3936 5000-ADD-NEW-LINES.
  3937     PERFORM 7450-SET-INDX THRU 7450-EXIT
  3938     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3939             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3940             SC-INDX > NUM-LINES-PER-SCREEN
  3941
  3942     IF NOT EMI-NO-ERRORS
  3943        GO TO 8200-SEND-DATAONLY.
  3944
  3945     MOVE PI-TOTAL-LINES         TO  PI-CURRENT-LINE
  3946     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT
  3947     MOVE LOW-VALUES             TO  EL6509AI
  3948     SET TB-INDX TO PI-CURRENT-LINE
  3949     MOVE 'A'                    TO FUNCTI
  3950     MOVE -1                     TO  SC-TEXTL (2)
  3951     MOVE AL-UANON               TO  FUNCTA
  3952     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3953             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3954             SC-INDX > NUM-LINES-PER-SCREEN
  3955     MOVE '1'                              TO PI-UPDATE-SW.
  3956     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  81
* EL6509.cbl
  3958 5500-LOOKUP.
  3959     PERFORM 7500-READ-TS THRU 7599-EXIT
  3960     SET TB-INDX TO PI-CURRENT-LINE
  3961     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3962             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3963             SC-INDX > NUM-LINES-PER-SCREEN
  3964
  3965     IF NOT EMI-NO-ERRORS
  3966        GO TO 8200-SEND-DATAONLY.
  3967
  3968     MOVE LINE1I                 TO  PI-CURRENT-LINE
  3969     SET TB-INDX TO PI-CURRENT-LINE
  3970     MOVE LOW-VALUES             TO  EL6509AI
  3971     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3972             VARYING SC-INDX FROM 1 BY 1
  3973             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  3974     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3975     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  82
* EL6509.cbl
  3977 6000-NOT-OPEN.
  3978     MOVE ER-3788                TO  EMI-ERROR.
  3979     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3980
  3981     IF EIBAID = DFHCLEAR
  3982         GO TO 9410-RETURN
  3983     ELSE
  3984         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  83
* EL6509.cbl
  3986 7000-BUILD-TABLE.
  3987
  3988     SET TB-INDX TO 1.
  3989     MOVE ZEROS                  TO  PI-TOTAL-LINES
  3990                                     PI-CURRENT-LINE
  3991                                     PI-TEMP-STOR-ITEMS
  3992                                     PI-UPDATE-SW.
  3993     MOVE LOW-VALUES             TO  EL6509AI.
  3994     PERFORM 7500-READ-TS THRU 7599-EXIT
  3995
  3996****IF TEMP STORAGE IS FOUND, DELETE IT.
  3997     IF PI-TEMP-STOR-ITEMS NOT = ZERO
  3998        PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  3999*00792         MOVE ER-0140             TO  EMI-ERROR
  4000*00793         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4001*00794         MULTIPLY PI-TEMP-STOR-ITEMS BY TS-NUM-REC-IN-GROUP
  4002*00795                  PI-TOTAL-LINES
  4003*00796         MOVE 1                   TO  PI-CURRENT-LINE
  4004*00797         SET TB-INDX TO 1
  4005*00798         PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  4006*00799                 VARYING SC-INDX FROM 1
  4007*00800                 BY 1 UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  4008*00801         GO TO 8100-SEND-INITIAL-MAP.
  4009     END-IF.
  4010
  4011
  4012* EXEC CICS HANDLE CONDITION
  4013*         NOTFND(7010-ENDBR)
  4014*         NOTOPEN(6000-NOT-OPEN)
  4015*         ENDFILE(7010-ENDBR)
  4016*    END-EXEC.
  4017*    MOVE '"$IJ''                 ! % #00003893' TO DFHEIV0
  4018     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  4019     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4020     MOVE X'2520233030303033383933' TO DFHEIV0(25:11)
  4021     CALL 'kxdfhei1' USING DFHEIV0
  4022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4023
  4024
  4025
  4026* EXEC CICS STARTBR
  4027*         DATASET(ERACNT-FILE-ID)
  4028*         RIDFLD(ERACNT-KEY)
  4029*         KEYLENGTH(ERACNT-START-LENGTH)
  4030*         GENERIC
  4031*         GTEQ
  4032*    END-EXEC.
  4033     MOVE 0
  4034       TO DFHEIV11
  4035*    MOVE '&,   KG    G          &   #00003899' TO DFHEIV0
  4036     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4037     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4038     MOVE X'2020233030303033383939' TO DFHEIV0(25:11)
  4039     CALL 'kxdfhei1' USING DFHEIV0,
  4040           ERACNT-FILE-ID,
  4041           ERACNT-KEY,
  4042           ERACNT-START-LENGTH,
  4043           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  84
* EL6509.cbl
  4044           DFHEIV99
  4045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4046
  4047
  4048 7001-LOOP.
  4049
  4050* EXEC CICS READNEXT
  4051*         SET(ADDRESS OF NOTE-FILE)
  4052*         DATASET(ERACNT-FILE-ID)
  4053*         RIDFLD(ERACNT-KEY)
  4054*         END-EXEC.
  4055     MOVE 0
  4056       TO DFHEIV11
  4057*    MOVE '&.S                   )   #00003908' TO DFHEIV0
  4058     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4059     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4060     MOVE X'2020233030303033393038' TO DFHEIV0(25:11)
  4061     CALL 'kxdfhei1' USING DFHEIV0,
  4062           ERACNT-FILE-ID,
  4063           DFHEIV20,
  4064           DFHEIV99,
  4065           ERACNT-KEY,
  4066           DFHEIV99,
  4067           DFHEIV11,
  4068           DFHEIV99,
  4069           DFHEIV99
  4070     SET ADDRESS OF NOTE-FILE TO
  4071         DFHEIV20
  4072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4073
  4074
  4075     IF NT-COMPANY-CD NOT = SV-COMPANY-CD
  4076         GO TO 7010-ENDBR.
  4077
  4078     IF (NT-CARRIER = SV-CARRIER)
  4079        AND (NT-GROUPING = SV-GROUPING)
  4080        AND (NT-STATE = SV-STATE)
  4081        AND (NT-ACCOUNT = SV-ACCOUNT)
  4082        AND (NT-RECORD-TYPE = '1')
  4083          MOVE NT-NOTE-LINE TO REC-TEXT (TB-INDX)
  4084          MOVE NT-LAST-MAINT-BY TO REC-LAST-MAINT-BY (TB-INDX)
  4085          MOVE NT-LAST-MAINT-DT TO REC-LAST-MAINT-DT (TB-INDX)
  4086          MOVE NT-LAST-MAINT-HHMMSS TO
  4087                         REC-LAST-MAINT-HHMMSS (TB-INDX)
  4088          SET TB-INDX UP BY 1
  4089          GO TO 7001-LOOP.
  4090 7010-ENDBR.
  4091     IF TB-INDX = 1
  4092         MOVE ER-0006            TO EMI-ERROR
  4093         MOVE 'A'                TO FUNCTI
  4094         MOVE -1                 TO SC-TEXTL (1)
  4095         MOVE AL-UANON           TO FUNCTA
  4096         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4097         MOVE ZEROS              TO PI-TOTAL-LINES
  4098         GO TO 8100-SEND-INITIAL-MAP.
  4099
  4100
  4101* EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  85
* EL6509.cbl
  4102*         DATASET(ERACNT-FILE-ID)
  4103*         END-EXEC.
  4104     MOVE 0
  4105       TO DFHEIV11
  4106*    MOVE '&2                    $   #00003939' TO DFHEIV0
  4107     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4108     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4109     MOVE X'2020233030303033393339' TO DFHEIV0(25:11)
  4110     CALL 'kxdfhei1' USING DFHEIV0,
  4111           ERACNT-FILE-ID,
  4112           DFHEIV11,
  4113           DFHEIV99
  4114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4115
  4116
  4117     SET TB-INDX DOWN BY 1.
  4118     SET PI-TOTAL-LINES TO TB-INDX.
  4119     MOVE 1                      TO PI-CURRENT-LINE.
  4120
  4121 7050-FORMAT-LINES.
  4122     SET TB-INDX TO PI-CURRENT-LINE.
  4123     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  4124             VARYING SC-INDX FROM 1
  4125             BY 1 UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  4126     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT
  4127     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  86
* EL6509.cbl
  4129 7100-FORMAT-SCREEN.
  4130     IF TB-INDX > PI-TOTAL-LINES
  4131        IF FUNCTI NOT = 'A'
  4132           MOVE AL-PANON         TO SC-TEXTA (SC-INDX).
  4133
  4134     IF TB-INDX > PI-TOTAL-LINES
  4135         GO TO 7100-EXIT.
  4136
  4137     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  4138     MOVE REC-LAST-MAINT-BY (TB-INDX)
  4139                                 TO SC-MAINT-BY (SC-INDX).
  4140     PERFORM 7110-FORMAT-DATE  THRU 7110-EXIT.
  4141     SET ROLL-COUNTER TO TB-INDX.
  4142     MOVE ROLL-COUNTER           TO SC-LIN (SC-INDX).
  4143
  4144     IF NOT MODIFY-CAP
  4145         MOVE AL-PANOF           TO SC-TEXTA (SC-INDX)
  4146         SET TB-INDX UP BY 1
  4147         GO TO 7100-EXIT.
  4148
  4149     IF (REC-LAST-MAINT-BY (TB-INDX) NOT = SPACES AND LOW-VALUES)
  4150          AND
  4151        (REC-LAST-MAINT-BY (TB-INDX) NOT EQUAL PI-PROCESSOR-ID)
  4152          AND
  4153        (PI-PROCESSOR-ID NOT = 'PEMA' AND 'AJRA')
  4154           MOVE AL-PANOF         TO SC-TEXTA (SC-INDX)
  4155           SET TB-INDX UP BY 1
  4156           GO TO 7100-EXIT.
  4157
  4158     IF (REC-LAST-MAINT-DT (TB-INDX) = SAVE-BIN-DATE OR
  4159                              LOW-VALUES OR SPACES)
  4160        OR (PI-PROCESSOR-ID = 'PEMA' OR 'AJRA')
  4161           SET TB-INDX UP BY 1
  4162        ELSE
  4163           MOVE AL-PANOF         TO SC-TEXTA (SC-INDX)
  4164           SET TB-INDX UP BY 1.
  4165
  4166 7100-EXIT.
  4167      EXIT.
  4168
  4169 7110-FORMAT-DATE.
  4170     IF REC-LAST-MAINT-DT (TB-INDX) = LOW-VALUES OR SPACES
  4171            NEXT SENTENCE
  4172      ELSE
  4173        MOVE REC-LAST-MAINT-DT (TB-INDX)
  4174                                 TO DC-BIN-DATE-1
  4175        MOVE SPACES              TO DC-OPTION-CODE
  4176        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4177        MOVE DC-GREG-DATE-1-MDY  TO SC-MAINT-DT (SC-INDX).
  4178
  4179 7110-EXIT.  EXIT.
  4180
  4181 7200-PUT-TEMP-STOR.
  4182     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  4183     SET TS-INDX TO 1
  4184     MOVE 0                      TO PI-TEMP-STOR-ITEMS
  4185     PERFORM 7300-WRITE-TS THRU 7399-EXIT
  4186             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  87
* EL6509.cbl
  4187             UNTIL TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
  4188 7249-EXIT.
  4189      EXIT.
  4190 7250-DELETE-TEMP-STOR.
  4191
  4192* EXEC CICS HANDLE CONDITION
  4193*         QIDERR(7299-EXIT)
  4194*         END-EXEC.
  4195*    MOVE '"$N                   ! & #00004017' TO DFHEIV0
  4196     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4198     MOVE X'2620233030303034303137' TO DFHEIV0(25:11)
  4199     CALL 'kxdfhei1' USING DFHEIV0
  4200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4201
  4202
  4203* EXEC CICS DELETEQ TS
  4204*         QUEUE(QID)
  4205*         END-EXEC.
  4206*    MOVE '*&                    #   #00004020' TO DFHEIV0
  4207     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4208     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4209     MOVE X'2020233030303034303230' TO DFHEIV0(25:11)
  4210     CALL 'kxdfhei1' USING DFHEIV0,
  4211           QID,
  4212           DFHEIV99
  4213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4214
  4215 7299-EXIT.
  4216     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  88
* EL6509.cbl
  4218 7300-WRITE-TS.
  4219     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA
  4220     SET TS-INDX UP BY 1
  4221     ADD 1 TO PI-TEMP-STOR-ITEMS
  4222
  4223* EXEC CICS WRITEQ TS
  4224*         FROM(TS-WORK-AREA)
  4225*         QUEUE(QID)
  4226*         LENGTH(TS-LENGTH)
  4227*         ITEM(PI-TEMP-STOR-ITEMS)
  4228*         END-EXEC.
  4229*    MOVE '*" I                  ''   #00004030' TO DFHEIV0
  4230     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  4231     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4232     MOVE X'2020233030303034303330' TO DFHEIV0(25:11)
  4233     CALL 'kxdfhei1' USING DFHEIV0,
  4234           QID,
  4235           TS-WORK-AREA,
  4236           TS-LENGTH,
  4237           PI-TEMP-STOR-ITEMS,
  4238           DFHEIV99,
  4239           DFHEIV99
  4240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4241
  4242 7399-EXIT.
  4243     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  89
* EL6509.cbl
  4245 7400-PAGE-ROUTINE.
  4246
  4247     IF PFENTERL NOT = ZEROS
  4248        MOVE -1                  TO PFENTERL
  4249        ELSE
  4250        MOVE -1                  TO FUNCTL.
  4251
  4252     IF PI-TOTAL-LINES = 0
  4253        MOVE ER-0047             TO EMI-ERROR
  4254        MOVE -1                  TO FUNCTL
  4255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4256        GO TO 8200-SEND-DATAONLY.
  4257
  4258     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
  4259
  4260     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  4261        MOVE ER-0067             TO EMI-ERROR
  4262        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4263        MOVE 1 TO TEMP-CURR-LINE.
  4264
  4265     IF TEMP-CURR-LINE GREATER THAN PI-TOTAL-LINES
  4266        MOVE ER-0066             TO EMI-ERROR
  4267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4268        COMPUTE TEMP-CURR-LINE = PI-TOTAL-LINES + 1
  4269                               - NUM-LINES-PER-SCREEN
  4270        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  4271           MOVE 1                TO TEMP-CURR-LINE.
  4272
  4273     PERFORM 7450-SET-INDX THRU 7450-EXIT
  4274     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  4275             VARYING SC-INDX FROM 1 BY 1 UNTIL
  4276             SC-INDX > NUM-LINES-PER-SCREEN
  4277
  4278     IF EMI-ERROR = ER-0066 OR = ER-0067 OR = ZEROS
  4279        NEXT SENTENCE
  4280        ELSE
  4281        GO TO 8200-SEND-DATAONLY.
  4282
  4283     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE
  4284     SET TB-INDX TO PI-CURRENT-LINE
  4285     MOVE LOW-VALUES             TO EL6509AI
  4286     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  4287             VARYING SC-INDX FROM 1 BY 1
  4288             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  4289     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  4290     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  90
* EL6509.cbl
  4292
  4293 7450-SET-INDX.
  4294     IF PI-CURRENT-LINE = 0 AND PI-TOTAL-LINES = 0
  4295        SET TB-INDX TO 1
  4296     ELSE
  4297        PERFORM 7500-READ-TS THRU 7599-EXIT
  4298        IF PI-CURRENT-LINE = 0
  4299           SET TB-INDX TO 1
  4300        ELSE
  4301           SET TB-INDX TO PI-CURRENT-LINE.
  4302 7450-EXIT.
  4303      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  91
* EL6509.cbl
  4305 7500-READ-TS.
  4306
  4307* EXEC CICS HANDLE CONDITION
  4308*         QIDERR(7590-TS-QIDERR)
  4309*         ITEMERR(7585-QID-ITEMERR)
  4310*         END-EXEC.
  4311*    MOVE '"$N<                  ! '' #00004100' TO DFHEIV0
  4312     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  4313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4314     MOVE X'2720233030303034313030' TO DFHEIV0(25:11)
  4315     CALL 'kxdfhei1' USING DFHEIV0
  4316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4317
  4318     SET TS-INDX TO 1.
  4319     MOVE 1                      TO QID-ITEM.
  4320 7501-LOOP.
  4321
  4322* EXEC CICS READQ TS
  4323*         INTO(TS-WORK-AREA)
  4324*         QUEUE(QID)
  4325*         LENGTH(TS-LENGTH)
  4326*         ITEM(QID-ITEM)
  4327*         END-EXEC.
  4328*    MOVE '*$II   L              ''   #00004107' TO DFHEIV0
  4329     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4330     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4331     MOVE X'2020233030303034313037' TO DFHEIV0(25:11)
  4332     CALL 'kxdfhei1' USING DFHEIV0,
  4333           QID,
  4334           TS-WORK-AREA,
  4335           TS-LENGTH,
  4336           QID-ITEM,
  4337           DFHEIV99,
  4338           DFHEIV99
  4339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4340
  4341     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
  4342     SET TS-INDX UP BY 1.
  4343     ADD 1 TO QID-ITEM.
  4344     GO TO 7501-LOOP.
  4345
  4346 7585-QID-ITEMERR.
  4347     IF EIBTRNID NOT = TRANS-ID
  4348        SUBTRACT 1 FROM QID-ITEM
  4349        MOVE QID-ITEM            TO PI-TEMP-STOR-ITEMS.
  4350        GO TO 7599-EXIT.
  4351
  4352 7590-TS-QIDERR.
  4353     IF EIBTRNID = TRANS-ID
  4354        AND EIBAID = DFHCLEAR
  4355           GO TO 9410-RETURN.
  4356     IF EIBTRNID = TRANS-ID
  4357        MOVE ER-0033             TO EMI-ERROR
  4358        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4359        GO TO 8100-SEND-INITIAL-MAP.
  4360
  4361 7599-EXIT.
  4362      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  92
* EL6509.cbl
  4363
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  93
* EL6509.cbl
  4365 7600-UPDATE-TABLE-FROM-SCREEN.
  4366
  4367     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  4368         IF TB-INDX NOT > PI-TOTAL-LINES
  4369             PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  4370             SET TB-INDX UP BY 1
  4371         ELSE
  4372             IF PI-TOTAL-LINES = MAX-LINES
  4373                 MOVE ER-0051    TO EMI-ERROR
  4374                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4375                 GO TO 8200-SEND-DATAONLY
  4376             ELSE
  4377                 PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  4378                 SET TB-INDX UP BY 1
  4379                 ADD 1 TO PI-TOTAL-LINES
  4380     ELSE
  4381        IF TB-INDX NOT > PI-TOTAL-LINES
  4382           SET TB-INDX UP BY 1.
  4383
  4384 7699-EXIT.
  4385      EXIT.
  4386
  4387 7700-MOVE-DATA.
  4388     MOVE '1'                    TO PI-UPDATE-SW.
  4389
  4390     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  4391         MOVE SC-TEXT (SC-INDX)  TO REC-TEXT (TB-INDX).
  4392
  4393     IF REC-LAST-MAINT-DT (TB-INDX) = LOW-VALUES OR SPACES
  4394        MOVE PI-PROCESSOR-ID     TO REC-LAST-MAINT-BY (TB-INDX)
  4395                                  SC-MAINT-BY (SC-INDX)
  4396        MOVE EIBTIME            TO REC-LAST-MAINT-HHMMSS (TB-INDX)
  4397        MOVE SAVE-BIN-DATE       TO REC-LAST-MAINT-DT (TB-INDX).
  4398
  4399     PERFORM 7110-FORMAT-DATE.
  4400
  4401 7700-EXIT.
  4402      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  94
* EL6509.cbl
  4404 8100-SEND-INITIAL-MAP.
  4405     MOVE SAVE-DATE              TO DATEO.
  4406     MOVE EIBTIME                TO TIME-IN.
  4407     MOVE TIME-OUT               TO TIMEO.
  4408     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  4409     MOVE PI-PROCESSOR-ID        TO USERIDO.
  4410     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGBO.
  4411     MOVE VG-CARRIER             TO CARRO.
  4412     MOVE VG-GROUPING            TO GROUPO.
  4413     MOVE VG-STATE               TO STATEO.
  4414     MOVE VG-ACCOUNT             TO ACCTO.
  4415     MOVE PI-TOTAL-LINES         TO TOTI.
  4416     MOVE PI-ACCNAME             TO NAMEO.
  4417     MOVE -1                     TO FUNCTL.
  4418
  4419
  4420* EXEC CICS SEND
  4421*         MAP(MAP-NAME)
  4422*         MAPSET(MAPSET-NAME)
  4423*         FROM(EL6509AO)
  4424*         ERASE
  4425*         CURSOR
  4426*         END-EXEC.
  4427     MOVE LENGTH OF
  4428      EL6509AO
  4429       TO DFHEIV12
  4430     MOVE -1
  4431       TO DFHEIV11
  4432*    MOVE '8$     CT  E    H L F ,   #00004191' TO DFHEIV0
  4433     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4434     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4435     MOVE X'2020233030303034313931' TO DFHEIV0(25:11)
  4436     CALL 'kxdfhei1' USING DFHEIV0,
  4437           MAP-NAME,
  4438           EL6509AO,
  4439           DFHEIV12,
  4440           MAPSET-NAME,
  4441           DFHEIV99,
  4442           DFHEIV99,
  4443           DFHEIV99,
  4444           DFHEIV11,
  4445           DFHEIV99,
  4446           DFHEIV99,
  4447           DFHEIV99
  4448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4449
  4450
  4451     GO TO 9100-RETURN-TRAN.
  4452
  4453 8200-SEND-DATAONLY.
  4454     MOVE EIBTIME                TO TIME-IN
  4455     MOVE TIME-OUT               TO TIMEO
  4456     MOVE PI-COMPANY-ID          TO CMPNYIDO
  4457     MOVE PI-PROCESSOR-ID        TO USERIDO
  4458     MOVE PI-TOTAL-LINES         TO TOTI
  4459
  4460     IF NOT EMI-NO-ERRORS
  4461        MOVE EMI-MESSAGE-AREA (1) TO ERRMSGBO
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  95
* EL6509.cbl
  4462        ELSE
  4463        MOVE -1                  TO FUNCTL.
  4464
  4465
  4466* EXEC CICS SEND
  4467*         MAP(MAP-NAME)
  4468*         MAPSET(MAPSET-NAME)
  4469*         FROM(EL6509AO)
  4470*         DATAONLY
  4471*         CURSOR
  4472*         END-EXEC.
  4473     MOVE LENGTH OF
  4474      EL6509AO
  4475       TO DFHEIV12
  4476     MOVE -1
  4477       TO DFHEIV11
  4478*    MOVE '8$D    CT       H L F ,   #00004213' TO DFHEIV0
  4479     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4480     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4481     MOVE X'2020233030303034323133' TO DFHEIV0(25:11)
  4482     CALL 'kxdfhei1' USING DFHEIV0,
  4483           MAP-NAME,
  4484           EL6509AO,
  4485           DFHEIV12,
  4486           MAPSET-NAME,
  4487           DFHEIV99,
  4488           DFHEIV99,
  4489           DFHEIV99,
  4490           DFHEIV11,
  4491           DFHEIV99,
  4492           DFHEIV99,
  4493           DFHEIV99
  4494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4495
  4496
  4497     GO TO 9100-RETURN-TRAN.
  4498
  4499 8300-SEND-TEXT.
  4500
  4501* EXEC CICS SEND TEXT
  4502*         FROM(LOGOFF-TEXT)
  4503*         ERASE
  4504*         FREEKB
  4505*         LENGTH(LOGOFF-LENGTH)
  4506*         END-EXEC.
  4507*    MOVE '8&      T  E F  H   F -   #00004224' TO DFHEIV0
  4508     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4509     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4510     MOVE X'2020233030303034323234' TO DFHEIV0(25:11)
  4511     CALL 'kxdfhei1' USING DFHEIV0,
  4512           LOGOFF-TEXT,
  4513           LOGOFF-LENGTH,
  4514           DFHEIV99,
  4515           DFHEIV99,
  4516           DFHEIV99,
  4517           DFHEIV99,
  4518           DFHEIV99,
  4519           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  96
* EL6509.cbl
  4520           DFHEIV99,
  4521           DFHEIV99,
  4522           DFHEIV99,
  4523           DFHEIV99
  4524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4525
  4526
  4527     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  4528
  4529
  4530* EXEC CICS RETURN
  4531*         END-EXEC.
  4532*    MOVE '.(                    ''   #00004233' TO DFHEIV0
  4533     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4534     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4535     MOVE X'2020233030303034323333' TO DFHEIV0(25:11)
  4536     CALL 'kxdfhei1' USING DFHEIV0,
  4537           DFHEIV99,
  4538           DFHEIV99,
  4539           DFHEIV99,
  4540           DFHEIV99,
  4541           DFHEIV99,
  4542           DFHEIV99
  4543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4544
  4545
  4546 8800-UNAUTHORIZED-ACCESS.
  4547     MOVE UNACCESS-MSG           TO LOGOFF-MSG
  4548     GO TO 8300-SEND-TEXT.
  4549
  4550 9000-RETURN-CICS.
  4551     IF PI-CHANGES-MADE
  4552        MOVE ER-0045             TO EMI-ERROR
  4553        MOVE -1                  TO FUNCTL
  4554        MOVE SPACES              TO PFENTERO
  4555        MOVE AL-UNNOF            TO PFENTERA
  4556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4557        GO TO 8200-SEND-DATAONLY.
  4558
  4559     MOVE EIBAID                 TO PI-ENTRY-CD-1
  4560     MOVE XCTL-005               TO PGM-NAME.
  4561     GO TO 9300-XCTL.
  4562
  4563 9100-RETURN-TRAN.
  4564     MOVE SCRN-NUMBER            TO PI-CURRENT-SCREEN-NO
  4565     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
  4566
  4567* EXEC CICS RETURN
  4568*         TRANSID(TRANS-ID)
  4569*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4570*         LENGTH(PI-COMM-LENGTH)
  4571*         END-EXEC.
  4572*    MOVE '.(CT                  ''   #00004256' TO DFHEIV0
  4573     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4574     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4575     MOVE X'2020233030303034323536' TO DFHEIV0(25:11)
  4576     CALL 'kxdfhei1' USING DFHEIV0,
  4577           TRANS-ID,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  97
* EL6509.cbl
  4578           PROGRAM-INTERFACE-BLOCK,
  4579           PI-COMM-LENGTH,
  4580           DFHEIV99,
  4581           DFHEIV99,
  4582           DFHEIV99
  4583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4584
  4585
  4586
  4587 9200-RETURN-MAIN-MENU.
  4588     IF PI-CHANGES-MADE
  4589        MOVE -1                  TO FUNCTL
  4590        MOVE SPACES              TO PFENTERO
  4591        MOVE AL-UNNOF            TO PFENTERA
  4592        MOVE ER-0045             TO EMI-ERROR
  4593        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4594        GO TO 8200-SEND-DATAONLY.
  4595
  4596     MOVE XCTL-126               TO PGM-NAME.
  4597
  4598 9300-XCTL.
  4599     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  4600
  4601* EXEC CICS XCTL
  4602*         PROGRAM  (PGM-NAME)
  4603*         COMMAREA (PROGRAM-INTERFACE-BLOCK)
  4604*         LENGTH   (PI-COMM-LENGTH)
  4605*         END-EXEC.
  4606*    MOVE '.$C                   %   #00004276' TO DFHEIV0
  4607     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4608     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4609     MOVE X'2020233030303034323736' TO DFHEIV0(25:11)
  4610     CALL 'kxdfhei1' USING DFHEIV0,
  4611           PGM-NAME,
  4612           PROGRAM-INTERFACE-BLOCK,
  4613           PI-COMM-LENGTH,
  4614           DFHEIV99
  4615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4616
  4617
  4618 9400-CLEAR.
  4619
  4620     IF PI-CHANGES-MADE
  4621         MOVE ER-0045            TO EMI-ERROR
  4622         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4623         IF PI-CURRENT-LINE GREATER THAN ZERO
  4624             PERFORM 7500-READ-TS THRU 7599-EXIT
  4625             SET TB-INDX TO PI-CURRENT-LINE
  4626             PERFORM 7100-FORMAT-SCREEN  THRU  7100-EXIT
  4627                 VARYING SC-INDX FROM 1 BY 1 UNTIL
  4628                 SC-INDX GREATER NUM-LINES-PER-SCREEN
  4629         END-IF
  4630         GO TO 8100-SEND-INITIAL-MAP.
  4631
  4632 9410-RETURN.
  4633     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
  4634     GO TO 9300-XCTL.
  4635
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  98
* EL6509.cbl
  4636 9500-PF12.
  4637     IF PI-CHANGES-MADE
  4638        MOVE -1                  TO FUNCTL
  4639        MOVE SPACES              TO PFENTERO
  4640        MOVE AL-UNNOF            TO PFENTERA
  4641        MOVE ER-0045             TO EMI-ERROR
  4642        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4643        GO TO 8200-SEND-DATAONLY.
  4644
  4645     MOVE 'EL010'                TO PGM-NAME
  4646     GO TO 9300-XCTL.
  4647
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  99
* EL6509.cbl
  4649 9550-START-PRINT.
  4650     PERFORM 7200-PUT-TEMP-STOR     THRU 7249-EXIT.
  4651
  4652     MOVE SPACES                 TO  ELCNTL-KEY.
  4653     MOVE PI-COMPANY-ID          TO  ELCNTL-COMPANY.
  4654     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  4655     MOVE ZEROS                  TO  ELCNTL-SEQ-NO.
  4656
  4657
  4658* EXEC CICS HANDLE CONDITION
  4659*              NOTFND(9410-RETURN)
  4660*              END-EXEC.
  4661*    MOVE '"$I                   ! ( #00004321' TO DFHEIV0
  4662     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4664     MOVE X'2820233030303034333231' TO DFHEIV0(25:11)
  4665     CALL 'kxdfhei1' USING DFHEIV0
  4666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4667
  4668
  4669
  4670* EXEC CICS READ DATASET(ELCNTL-FILE-ID)
  4671*                   SET (ADDRESS OF CONTROL-FILE)
  4672*                   RIDFLD(ELCNTL-KEY)
  4673*                   END-EXEC.
  4674*    MOVE '&"S        E          (   #00004325' TO DFHEIV0
  4675     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4676     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4677     MOVE X'2020233030303034333235' TO DFHEIV0(25:11)
  4678     CALL 'kxdfhei1' USING DFHEIV0,
  4679           ELCNTL-FILE-ID,
  4680           DFHEIV20,
  4681           DFHEIV99,
  4682           ELCNTL-KEY,
  4683           DFHEIV99,
  4684           DFHEIV99,
  4685           DFHEIV99
  4686     SET ADDRESS OF CONTROL-FILE TO
  4687         DFHEIV20
  4688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4689
  4690
  4691
  4692* EXEC CICS HANDLE CONDITION
  4693*                TERMIDERR (9560-BAD-TERMID)
  4694*                TRANSIDERR (9570-BAD-TRANSID)
  4695*                END-EXEC.
  4696*    MOVE '"$[\                  ! ) #00004330' TO DFHEIV0
  4697     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  4698     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4699     MOVE X'2920233030303034333330' TO DFHEIV0(25:11)
  4700     CALL 'kxdfhei1' USING DFHEIV0
  4701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4702
  4703
  4704     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  4705*        MOVE EIBTRMID       TO CF-FORMS-PRINTER-ID
  4706
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 100
* EL6509.cbl
  4707* EXEC CICS START
  4708*                  TRANSID (W-PRINT-TRANS)
  4709*                  TERMID (CF-FORMS-PRINTER-ID)
  4710*                  FROM (PROGRAM-INTERFACE-BLOCK)
  4711*                  LENGTH (PI-COMM-LENGTH)
  4712*        END-EXEC
  4713*    MOVE '0( LF                 1   #00004337' TO DFHEIV0
  4714     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  4715     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  4716     MOVE X'2020233030303034333337' TO DFHEIV0(25:11)
  4717     CALL 'kxdfhei1' USING DFHEIV0,
  4718           DFHEIV99,
  4719           W-PRINT-TRANS,
  4720           DFHEIV99,
  4721           PROGRAM-INTERFACE-BLOCK,
  4722           PI-COMM-LENGTH,
  4723           DFHEIV99,
  4724           DFHEIV99,
  4725           DFHEIV99,
  4726           DFHEIV99,
  4727           DFHEIV99,
  4728           DFHEIV99,
  4729           DFHEIV99,
  4730           DFHEIV99,
  4731           DFHEIV99,
  4732           DFHEIV99,
  4733           DFHEIV99
  4734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4735     ELSE
  4736
  4737* EXEC CICS START
  4738*                  TRANSID (W-PRINT-TRANS)
  4739*                  TERMID (CF-FORMS-PRINTER-ID)
  4740*                  FROM (PROGRAM-INTERFACE-BLOCK)
  4741*                  LENGTH (PI-COMM-LENGTH)
  4742*        END-EXEC.
  4743*    MOVE '0( LFT                1   #00004344' TO DFHEIV0
  4744     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  4745     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  4746     MOVE X'2020233030303034333434' TO DFHEIV0(25:11)
  4747     CALL 'kxdfhei1' USING DFHEIV0,
  4748           DFHEIV99,
  4749           W-PRINT-TRANS,
  4750           DFHEIV99,
  4751           PROGRAM-INTERFACE-BLOCK,
  4752           PI-COMM-LENGTH,
  4753           CF-FORMS-PRINTER-ID,
  4754           DFHEIV99,
  4755           DFHEIV99,
  4756           DFHEIV99,
  4757           DFHEIV99,
  4758           DFHEIV99,
  4759           DFHEIV99,
  4760           DFHEIV99,
  4761           DFHEIV99,
  4762           DFHEIV99,
  4763           DFHEIV99
  4764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 101
* EL6509.cbl
  4765
  4766
  4767     MOVE -1 TO LINE1L.
  4768     MOVE ER-3784    TO EMI-ERROR
  4769     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4770     GO TO 8200-SEND-DATAONLY.
  4771
  4772 9560-BAD-TERMID.
  4773     MOVE ER-0412    TO EMI-ERROR
  4774     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4775     GO TO 8200-SEND-DATAONLY.
  4776
  4777 9570-BAD-TRANSID.
  4778     MOVE ER-0413    TO EMI-ERROR
  4779     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4780     GO TO 8200-SEND-DATAONLY.
  4781
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 102
* EL6509.cbl
  4783 9600-PGMID-ERROR.
  4784
  4785* EXEC CICS HANDLE CONDITION
  4786*         PGMIDERR(8300-SEND-TEXT)
  4787*         END-EXEC.
  4788*    MOVE '"$L                   ! * #00004368' TO DFHEIV0
  4789     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4791     MOVE X'2A20233030303034333638' TO DFHEIV0(25:11)
  4792     CALL 'kxdfhei1' USING DFHEIV0
  4793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4794
  4795
  4796     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  4797     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  4798     MOVE XCTL-005               TO  PGM-NAME.
  4799     MOVE PGM-NAME               TO  LOGOFF-PGM.
  4800     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  4801
  4802     GO TO 9300-XCTL.
  4803
  4804 9700-LINK-DATE-CONVERT.
  4805
  4806     MOVE LINK-ELDATCV           TO  PGM-NAME.
  4807
  4808* EXEC CICS LINK
  4809*        PROGRAM    (PGM-NAME)
  4810*        COMMAREA   (DATE-CONVERSION-DATA)
  4811*        LENGTH     (DC-COMM-LENGTH)
  4812*        END-EXEC.
  4813*    MOVE '."C                   (   #00004383' TO DFHEIV0
  4814     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4815     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4816     MOVE X'2020233030303034333833' TO DFHEIV0(25:11)
  4817     CALL 'kxdfhei1' USING DFHEIV0,
  4818           PGM-NAME,
  4819           DATE-CONVERSION-DATA,
  4820           DC-COMM-LENGTH,
  4821           DFHEIV99,
  4822           DFHEIV99,
  4823           DFHEIV99,
  4824           DFHEIV99
  4825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4826
  4827
  4828 9700-EXIT.
  4829     EXIT.
  4830
  4831 9900-ERROR-FORMAT.
  4832     IF NOT EMI-ERRORS-COMPLETE
  4833        MOVE LINK-001            TO  PGM-NAME
  4834
  4835* EXEC CICS LINK
  4836*            PROGRAM(PGM-NAME)
  4837*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4838*            LENGTH(EMI-COMM-LENGTH)
  4839*            END-EXEC.
  4840*    MOVE '."C                   (   #00004395' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 103
* EL6509.cbl
  4841     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4842     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4843     MOVE X'2020233030303034333935' TO DFHEIV0(25:11)
  4844     CALL 'kxdfhei1' USING DFHEIV0,
  4845           PGM-NAME,
  4846           ERROR-MESSAGE-INTERFACE-BLOCK,
  4847           EMI-COMM-LENGTH,
  4848           DFHEIV99,
  4849           DFHEIV99,
  4850           DFHEIV99,
  4851           DFHEIV99
  4852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4853
  4854 9900-EXIT.       EXIT.
  4855
  4856 9990-ABEND.
  4857     MOVE LINK-004               TO  PGM-NAME.
  4858     MOVE DFHEIBLK               TO  EMI-LINE1.
  4859
  4860
  4861* EXEC CICS LINK
  4862*        PROGRAM   (PGM-NAME)
  4863*        COMMAREA  (EMI-LINE1)
  4864*        LENGTH    (72)
  4865*        END-EXEC.
  4866     MOVE 72
  4867       TO DFHEIV11
  4868*    MOVE '."C                   (   #00004406' TO DFHEIV0
  4869     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4870     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4871     MOVE X'2020233030303034343036' TO DFHEIV0(25:11)
  4872     CALL 'kxdfhei1' USING DFHEIV0,
  4873           PGM-NAME,
  4874           EMI-LINE1,
  4875           DFHEIV11,
  4876           DFHEIV99,
  4877           DFHEIV99,
  4878           DFHEIV99,
  4879           DFHEIV99
  4880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4881
  4882
  4883     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSGBO.
  4884     MOVE -1                     TO  FUNCTL.
  4885
  4886     GO TO 8100-SEND-INITIAL-MAP.
  4887
  4888
  4889* GOBACK.
  4890     MOVE '9%                    "   ' TO DFHEIV0
  4891     MOVE 'EL6509' TO DFHEIV1
  4892     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4893     GOBACK.
  4894
  4895 9995-SECURITY-VIOLATION.
  4896*                                COPY ELCSCTP.
  4897******************************************************************
  4898*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 104
* EL6509.cbl
  4899*                            ELCSCTP                             *
  4900*                            VMOD=2.001                          *
  4901*                                                                *
  4902*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4903******************************************************************
  4904
  4905
  4906     MOVE EIBDATE          TO SM-JUL-DATE.
  4907     MOVE EIBTRMID         TO SM-TERMID.
  4908     MOVE THIS-PGM         TO SM-PGM.
  4909     MOVE EIBTIME          TO TIME-IN.
  4910     MOVE TIME-OUT         TO SM-TIME.
  4911     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4912
  4913
  4914* EXEC CICS LINK
  4915*         PROGRAM  ('EL003')
  4916*         COMMAREA (SECURITY-MESSAGE)
  4917*         LENGTH   (80)
  4918*    END-EXEC.
  4919     MOVE 'EL003' TO DFHEIV1
  4920     MOVE 80
  4921       TO DFHEIV11
  4922*    MOVE '."C                   (   #00004437' TO DFHEIV0
  4923     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4924     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4925     MOVE X'2020233030303034343337' TO DFHEIV0(25:11)
  4926     CALL 'kxdfhei1' USING DFHEIV0,
  4927           DFHEIV1,
  4928           SECURITY-MESSAGE,
  4929           DFHEIV11,
  4930           DFHEIV99,
  4931           DFHEIV99,
  4932           DFHEIV99,
  4933           DFHEIV99
  4934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4935
  4936
  4937******************************************************************
  4938
  4939
  4940 9995-EXIT.
  4941     EXIT.
  4942
  4943 9999-DFHBACK SECTION.
  4944     MOVE '9%                    "   ' TO DFHEIV0
  4945     MOVE 'EL6509' TO DFHEIV1
  4946     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4947     GOBACK.
  4948 9999-DFHEXIT.
  4949     IF DFHEIGDJ EQUAL 0001
  4950         NEXT SENTENCE
  4951     ELSE IF DFHEIGDJ EQUAL 2
  4952         GO TO 9400-CLEAR
  4953         DEPENDING ON DFHEIGDI
  4954     ELSE IF DFHEIGDJ EQUAL 3
  4955         GO TO 9990-ABEND,
  4956               9600-PGMID-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 105
* EL6509.cbl
  4957         DEPENDING ON DFHEIGDI
  4958     ELSE IF DFHEIGDJ EQUAL 4
  4959         GO TO 4610-ENDBR,
  4960               6000-NOT-OPEN,
  4961               4610-ENDBR
  4962         DEPENDING ON DFHEIGDI
  4963     ELSE IF DFHEIGDJ EQUAL 5
  4964         GO TO 7010-ENDBR,
  4965               6000-NOT-OPEN,
  4966               7010-ENDBR
  4967         DEPENDING ON DFHEIGDI
  4968     ELSE IF DFHEIGDJ EQUAL 6
  4969         GO TO 7299-EXIT
  4970         DEPENDING ON DFHEIGDI
  4971     ELSE IF DFHEIGDJ EQUAL 7
  4972         GO TO 7590-TS-QIDERR,
  4973               7585-QID-ITEMERR
  4974         DEPENDING ON DFHEIGDI
  4975     ELSE IF DFHEIGDJ EQUAL 8
  4976         GO TO 9410-RETURN
  4977         DEPENDING ON DFHEIGDI
  4978     ELSE IF DFHEIGDJ EQUAL 9
  4979         GO TO 9560-BAD-TERMID,
  4980               9570-BAD-TRANSID
  4981         DEPENDING ON DFHEIGDI
  4982     ELSE IF DFHEIGDJ EQUAL 10
  4983         GO TO 8300-SEND-TEXT
  4984         DEPENDING ON DFHEIGDI.
  4985     MOVE '9%                    "   ' TO DFHEIV0
  4986     MOVE 'EL6509' TO DFHEIV1
  4987     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4988     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       30112     Code:       11715
