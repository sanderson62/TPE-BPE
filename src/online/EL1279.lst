* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page   1
* EL1279.cbl
* Options: int("EL1279.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1279.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1279.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1279.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL1279.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/06/95 08:37:08.
     7*                            VMOD=2.005.
     8*
     9*AUTHOR.           LOGIC,INC.
    10*                  DALLAS,TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page   2
* EL1279.cbl
    14*            *                                                   *
    15*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22*
    23*REMARKS.     TRANSACTION - EXXF - CERTIFICATE NOTE MAINTENANCE.
    24*
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 100109   2008101400003   AJRA  NEW CERT NOTE SCREEN
    34* 010416   2015072900002   TANA  ADD PF7 TO CLAIM MEMO SCREEN
    35* 102020 IR2020101300001   PEMA  Correct billing notes
    36******************************************************************
    37*
    38 ENVIRONMENT DIVISION.
    39
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page   3
* EL1279.cbl
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*     EL1279 WORKING STORAGE   *'.
    46 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.005 ***********'.
    47
    48*    COPY ELCSCTM.
    49******************************************************************
    50*                                                                *
    51*                                                                *
    52*                            ELCSCTM                             *
    53*                            VMOD=2.001                          *
    54*                                                                *
    55*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    56*                                                                *
    57******************************************************************
    58 01  SECURITY-MESSAGE.
    59     12  FILLER                          PIC X(30)
    60            VALUE '** LOGIC SECURITY VIOLATION -'.
    61     12  SM-READ                         PIC X(6).
    62     12  FILLER                          PIC X(5)
    63            VALUE ' PGM='.
    64     12  SM-PGM                          PIC X(6).
    65     12  FILLER                          PIC X(5)
    66            VALUE ' OPR='.
    67     12  SM-PROCESSOR-ID                 PIC X(4).
    68     12  FILLER                          PIC X(6)
    69            VALUE ' TERM='.
    70     12  SM-TERMID                       PIC X(4).
    71     12  FILLER                          PIC XX   VALUE SPACE.
    72     12  SM-JUL-DATE                     PIC 9(5).
    73     12  FILLER                          PIC X    VALUE SPACE.
    74     12  SM-TIME                         PIC 99.99.
    75
    76*    COPY ELCSCRTY.
    77******************************************************************
    78*                                                                *
    79*                                                                *
    80*                            ELCSCRTY                            *
    81*                            VMOD=2.001                          *
    82*                                                                *
    83*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    84*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    85*        SAVED IN PI-SECURITY-ADDRESS.                           *
    86*                                                                *
    87******************************************************************
    88 01  SECURITY-CONTROL.
    89     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    90     12  FILLER                       PIC XX    VALUE 'SC'.
    91     12  SC-CREDIT-CODES.
    92         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    93             20  SC-CREDIT-DISPLAY    PIC X.
    94             20  SC-CREDIT-UPDATE     PIC X.
    95     12  SC-CLAIMS-CODES.
    96         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    97             20  SC-CLAIMS-DISPLAY    PIC X.
    98             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page   4
* EL1279.cbl
    99
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page   5
* EL1279.cbl
   101 01  STANDARD-AREAS.
   102     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   103     12  MAP-NAME                PIC X(8)    VALUE 'EL1279A'.
   104     12  MAPSET-NAME             PIC X(8)    VALUE 'EL1279S '.
   105     12  SCRN-NUMBER             PIC X(4)    VALUE '127I'.
   106     12  TRANS-ID                PIC X(4)    VALUE 'EXXF'.
   107     12  THIS-PGM                PIC X(8)    VALUE 'EL1279'.
   108     12  PGM-NAME                PIC X(8).
   109     12  PGM-EL1276              PIC X(8)    VALUE 'EL1276'.
   110     12  pgm-el6311              pic x(8)    value 'EL6311'.
   111     12  pgm-el690               pic x(8)    value 'EL690'.
   112     12  pgm-el691               pic x(8)    value 'EL691'.
   113
   114     12  PGM-EL1284              PIC X(8)    VALUE 'EL1284'.
   115     12  ERCNOT-FILE-ID          PIC X(8)    VALUE 'ERCNOT'.
   116     12  ELCERT-FILE-ID          PIC X(8)    VALUE 'ELCERT'.
   117     12  QID.
   118         16  QID-TERM            PIC X(4).
   119         16  FILLER              PIC X(4)    VALUE '127I'.
   120     12  QID-ITEM                PIC S9(4)   COMP VALUE +0.
   121     12  SC-ITEM                 PIC S9(4)   COMP VALUE +1.
   122     12  WS-LINE                 PIC 9(3)    VALUE 0.
   123     12  WS-BLANK-LINES          PIC S9(4)   COMP VALUE +0.
   124
   125 01  WORK-AREA.
   126     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   127     12  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   128
   129     12  ERCNOT-LENGTH           PIC S9(4)   COMP VALUE +150.
   130     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   131     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   132     12  ERCNOT-KEY.
   133         16  ERCNOT-PARTIAL-KEY.
   134             20 ERCNOT-COMPANY-CD    PIC X.
   135             20 ERCNOT-CARRIER       PIC X.
   136             20 ERCNOT-GROUPING      PIC X(06).
   137             20 ERCNOT-STATE         PIC XX.
   138             20 ERCNOT-ACCOUNT       PIC X(10).
   139             20 ERCNOT-EFF-DT        PIC XX.
   140             20 ERCNOT-CERT-NO.
   141                25 ERCNOT-CERT-PRIME PIC X(10).
   142                25 ERCNOT-CERT-SFX   PIC X.
   143             20 ERCNOT-REC-TYP       PIC X.
   144         16 ERCNOT-SEQ           PIC S9(4) COMP.
   145     12  SV-PRIOR-KEY.
   146         20 SV-COMPANY-CD            PIC X.
   147         20 SV-CARRIER               PIC X.
   148         20 SV-GROUPING              PIC X(06).
   149         20 SV-STATE                 PIC XX.
   150         20 SV-ACCOUNT               PIC X(10).
   151         20 SV-EFF-DT                PIC XX.
   152         20 SV-CERT-NO.
   153            25 SV-CERT-PRIME         PIC X(10).
   154            25 SV-CERT-SFX           PIC X(1).
   155         20 SV-REC-TYP               PIC X.
   156     12  ELCERT-KEY.
   157         16  ELCERT-COMPANY-CD        PIC X.
   158         16  ELCERT-CARRIER           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page   6
* EL1279.cbl
   159         16  ELCERT-GROUPING          PIC X(6).
   160         16  ELCERT-STATE             PIC XX.
   161         16  ELCERT-ACCOUNT           PIC X(10).
   162         16  ELCERT-EFF-DT            PIC XX.
   163         16  ELCERT-CERT-NO.
   164             20  ELCERT-CERT-PRIME    PIC X(10).
   165             20  ELCERT-CERT-SFX      PIC X.
   166
   167     12  TIME-IN                 PIC S9(7).
   168     12  TIME-SPLIT REDEFINES TIME-IN.
   169         16  FILLER              PIC X.
   170         16  TIME-OUT            PIC 99V99.
   171         16  FILLER              PIC X(2).
   172     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   173     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   174     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   175     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   176     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   177     12  MAX-LINES               PIC 999     VALUE 300.
   178     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 10.
   179     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   180     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0  COMP-3.
   181     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   182     12  ROLL-COUNTER            PIC S999    VALUE +0 COMP-3.
   183     12  TEMP-CURR-LINE          PIC S9(3)   COMP-3.
   184     12  WS-SUB                  PIC S9(3)   COMP-3.
   185     12  WS-SUB1                 PIC S9(3)   COMP-3.
   186     12  WS-SCREEN-LINE          PIC X       VALUE 'N'.
   187         88 SCREEN-LINE-FOUND                VALUE 'Y'.
   188
   189     12  SCR-CLAIM-NOTE-TYPE.
   190         16  FILLER              PIC X(50)   VALUE
   191         '***********    C L A I M   C E R T   N O T E S    '.
   192         16  FILLER              PIC X(13)   VALUE
   193         '*************'.
   194     12  SCR-CERT-NOTE-TYPE.
   195         16  FILLER              PIC X(50)   VALUE
   196         '***********  C E R T I F I C A T E     N O T E S  '.
   197         16  FILLER              PIC X(13)   VALUE
   198         '*************'.
   199     12  SCR-PF6-CLAIM           PIC X(15)   VALUE
   200         'PF6=CLAIM NOTES'.
   201     12  SCR-PF6-CERT            PIC X(15)   VALUE
   202         'PF6=CERT NOTES'.
   203     12  SCR-CLAIM-YN            PIC X(12)   VALUE
   204         'CLAIM NOTES:'.
   205     12  SCR-CERT-YN             PIC X(12)   VALUE
   206         ' CERT NOTES:'.
   207
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page   7
* EL1279.cbl
   209 01  ERROR-MESSAGES.
   210     12  ER-0000             PIC X(04)       VALUE '0000'.
   211     12  ER-0004             PIC X(04)       VALUE '0004'.
   212     12  ER-0006             PIC X(04)       VALUE '0006'.
   213     12  ER-0008             PIC X(04)       VALUE '0008'.
   214     12  ER-0023             PIC X(04)       VALUE '0023'.
   215     12  ER-0029             PIC X(04)       VALUE '0029'.
   216     12  ER-0030             PIC X(04)       VALUE '0030'.
   217     12  ER-0031             PIC X(04)       VALUE '0031'.
   218     12  ER-0032             PIC X(04)       VALUE '0032'.
   219     12  ER-0033             PIC X(04)       VALUE '0033'.
   220     12  ER-0041             PIC X(04)       VALUE '0041'.
   221     12  ER-0044             PIC X(04)       VALUE '0044'.
   222     12  ER-0045             PIC X(04)       VALUE '0045'.
   223     12  ER-0047             PIC X(04)       VALUE '0047'.
   224     12  ER-0048             PIC X(04)       VALUE '0048'.
   225     12  ER-0049             PIC X(04)       VALUE '0049'.
   226     12  ER-0050             PIC X(04)       VALUE '0050'.
   227     12  ER-0051             PIC X(04)       VALUE '0051'.
   228     12  ER-0066             PIC X(04)       VALUE '0066'.
   229     12  ER-0067             PIC X(04)       VALUE '0067'.
   230     12  ER-0069             PIC X(04)       VALUE '0069'.
   231     12  ER-0070             PIC X(04)       VALUE '0070'.
   232     12  ER-0140             PIC X(04)       VALUE '0140'.
   233     12  ER-2954             PIC X(04)       VALUE '2954'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page   8
* EL1279.cbl
   235*                       COPY ELCLOGOF.
   236******************************************************************
   237*                                                                *
   238*                                                                *
   239*                            ELCLOGOF.                           *
   240*                            VMOD=2.001                          *
   241*                                                                *
   242*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   243*                                                                *
   244******************************************************************
   245 01  CLASIC-LOGOFF.
   246     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   247     12  LOGOFF-TEXT.
   248         16  FILLER          PIC X(5)    VALUE SPACES.
   249         16  LOGOFF-MSG.
   250             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   251             20  FILLER      PIC X       VALUE SPACES.
   252             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   253         16  FILLER          PIC X(80)
   254           VALUE '* YOU ARE NOW LOGGED OFF'.
   255         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   256         16  FILLER          PIC X       VALUE QUOTE.
   257         16  LOGOFF-SYS-MSG  PIC X(17)
   258           VALUE 'S CLAS-IC SYSTEM '.
   259     12  TEXT-MESSAGES.
   260         16  UNACCESS-MSG    PIC X(29)
   261             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   262         16  PGMIDERR-MSG    PIC X(17)
   263             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page   9
* EL1279.cbl
   265*                       COPY ELCAID.
   266******************************************************************
   267*                                                                *
   268*                            ELCAID.                             *
   269*                            VMOD=2.001                          *
   270*                                                                *
   271*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   272*                                                                *
   273*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   274*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   275******************************************************************
   276
   277 01  DFHAID.
   278   02  DFHNULL   PIC  X  VALUE  ' '.
   279   02  DFHENTER  PIC  X  VALUE  QUOTE.
   280   02  DFHCLEAR  PIC  X  VALUE  '_'.
   281   02  DFHPEN    PIC  X  VALUE  '='.
   282   02  DFHOPID   PIC  X  VALUE  'W'.
   283   02  DFHPA1    PIC  X  VALUE  '%'.
   284   02  DFHPA2    PIC  X  VALUE  '>'.
   285   02  DFHPA3    PIC  X  VALUE  ','.
   286   02  DFHPF1    PIC  X  VALUE  '1'.
   287   02  DFHPF2    PIC  X  VALUE  '2'.
   288   02  DFHPF3    PIC  X  VALUE  '3'.
   289   02  DFHPF4    PIC  X  VALUE  '4'.
   290   02  DFHPF5    PIC  X  VALUE  '5'.
   291   02  DFHPF6    PIC  X  VALUE  '6'.
   292   02  DFHPF7    PIC  X  VALUE  '7'.
   293   02  DFHPF8    PIC  X  VALUE  '8'.
   294   02  DFHPF9    PIC  X  VALUE  '9'.
   295   02  DFHPF10   PIC  X  VALUE  ':'.
   296   02  DFHPF11   PIC  X  VALUE  '#'.
   297   02  DFHPF12   PIC  X  VALUE  '@'.
   298   02  DFHPF13   PIC  X  VALUE  'A'.
   299   02  DFHPF14   PIC  X  VALUE  'B'.
   300   02  DFHPF15   PIC  X  VALUE  'C'.
   301   02  DFHPF16   PIC  X  VALUE  'D'.
   302   02  DFHPF17   PIC  X  VALUE  'E'.
   303   02  DFHPF18   PIC  X  VALUE  'F'.
   304   02  DFHPF19   PIC  X  VALUE  'G'.
   305   02  DFHPF20   PIC  X  VALUE  'H'.
   306   02  DFHPF21   PIC  X  VALUE  'I'.
   307*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   308   02  DFHPF22   PIC  X  VALUE  '['.
   309   02  DFHPF23   PIC  X  VALUE  '.'.
   310   02  DFHPF24   PIC  X  VALUE  '<'.
   311   02  DFHMSRE   PIC  X  VALUE  'X'.
   312   02  DFHSTRF   PIC  X  VALUE  'h'.
   313   02  DFHTRIG   PIC  X  VALUE  '"'.
   314 01  FILLER  REDEFINES DFHAID.
   315     12  FILLER                  PIC X(8).
   316     12  PF-VALUES OCCURS 24 TIMES       PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  10
* EL1279.cbl
   318*                       COPY ELCEMIB.
   319******************************************************************
   320*                                                                *
   321*                                                                *
   322*                            ELCEMIB.                            *
   323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   324*                            VMOD=2.005                          *
   325*                                                                *
   326*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   327*                                                                *
   328******************************************************************
   329 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   330     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   331     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   332     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   333     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   334     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   335     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   336     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   337     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   338     12  EMI-SWITCH1             PIC X        VALUE '1'.
   339         88  EMI-NO-ERRORS                    VALUE '1'.
   340         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   341         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   342     12  EMI-SWITCH2             PIC X        VALUE '1'.
   343         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   344     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   345         88  EMI-AREA1-EMPTY                  VALUE '1'.
   346         88  EMI-AREA1-FULL                   VALUE '2'.
   347     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   348         88  EMI-AREA2-EMPTY                  VALUE '1'.
   349         88  EMI-AREA2-FULL                   VALUE '2'.
   350     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   351         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   352         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   353         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   354         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   355         88  EMI-BYPASS-FATALS                VALUE 'X'.
   356     12  EMI-ERROR-LINES.
   357         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   358         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   359         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   360         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   361             20  EMI-ERR-CODES OCCURS 10 TIMES.
   362                 24  EMI-ERR-NUM         PIC X(4).
   363                 24  EMI-FILLER          PIC X.
   364                 24  EMI-SEV             PIC X.
   365                 24  FILLER              PIC X.
   366             20  FILLER                  PIC X(02).
   367     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   368         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   369             20  EMI-ERROR-NUMBER    PIC X(4).
   370             20  EMI-FILL            PIC X.
   371             20  EMI-SEVERITY        PIC X.
   372             20  FILLER              PIC X.
   373             20  EMI-ERROR-TEXT.
   374                 24  EMI-TEXT-VARIABLE   PIC X(10).
   375                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  11
* EL1279.cbl
   376     12  EMI-SEVERITY-SAVE           PIC X.
   377         88  EMI-NOTE                    VALUE 'N'.
   378         88  EMI-WARNING                 VALUE 'W'.
   379         88  EMI-FORCABLE                VALUE 'F'.
   380         88  EMI-FATAL                   VALUE 'X'.
   381     12  EMI-MESSAGE-FLAG            PIC X.
   382         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   383         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   384     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   385     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   386         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   387         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   388         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   389     12  emi-claim-no                pic x(7).
   390     12  emi-claim-type              pic x(6).
   391     12  FILLER                      PIC X(124)  VALUE SPACES.
   392     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   393     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   394     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   395     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  12
* EL1279.cbl
   397*                       COPY ELCINTF.
   398******************************************************************
   399*                                                                *
   400*                                                                *
   401*                            ELCINTF.                            *
   402*                            VMOD=2.017                          *
   403*                                                                *
   404*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   405*                                                                *
   406*       LENGTH = 1024                                            *
   407*                                                                *
   408******************************************************************
   409*                   C H A N G E   L O G
   410*
   411* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   412*-----------------------------------------------------------------
   413*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   414* EFFECTIVE    NUMBER
   415*-----------------------------------------------------------------
   416* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   417******************************************************************
   418 01  PROGRAM-INTERFACE-BLOCK.
   419     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   420     12  PI-CALLING-PROGRAM              PIC X(8).
   421     12  PI-SAVED-PROGRAM-1              PIC X(8).
   422     12  PI-SAVED-PROGRAM-2              PIC X(8).
   423     12  PI-SAVED-PROGRAM-3              PIC X(8).
   424     12  PI-SAVED-PROGRAM-4              PIC X(8).
   425     12  PI-SAVED-PROGRAM-5              PIC X(8).
   426     12  PI-SAVED-PROGRAM-6              PIC X(8).
   427     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   428     12  PI-COMPANY-ID                   PIC XXX.
   429     12  PI-COMPANY-CD                   PIC X.
   430
   431     12  PI-COMPANY-PASSWORD             PIC X(8).
   432
   433     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   434
   435     12  PI-CONTROL-IN-PROGRESS.
   436         16  PI-CARRIER                  PIC X.
   437         16  PI-GROUPING                 PIC X(6).
   438         16  PI-STATE                    PIC XX.
   439         16  PI-ACCOUNT                  PIC X(10).
   440         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   441                                         PIC X(10).
   442         16  PI-CLAIM-CERT-GRP.
   443             20  PI-CLAIM-NO             PIC X(7).
   444             20  PI-CERT-NO.
   445                 25  PI-CERT-PRIME       PIC X(10).
   446                 25  PI-CERT-SFX         PIC X.
   447             20  PI-CERT-EFF-DT          PIC XX.
   448         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   449             20  PI-PLAN-CODE            PIC X(2).
   450             20  PI-REVISION-NUMBER      PIC X(3).
   451             20  PI-PLAN-EFF-DT          PIC X(2).
   452             20  PI-PLAN-EXP-DT          PIC X(2).
   453             20  FILLER                  PIC X(11).
   454         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  13
* EL1279.cbl
   455             20  PI-OE-REFERENCE-1.
   456                 25  PI-OE-REF-1-PRIME   PIC X(18).
   457                 25  PI-OE-REF-1-SUFF    PIC XX.
   458
   459     12  PI-SESSION-IN-PROGRESS          PIC X.
   460         88  CLAIM-SESSION                   VALUE '1'.
   461         88  CREDIT-SESSION                  VALUE '2'.
   462         88  WARRANTY-SESSION                VALUE '3'.
   463         88  MORTGAGE-SESSION                VALUE '4'.
   464         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   465
   466
   467*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   468
   469     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   470     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   471
   472     12  PI-CREDIT-USER                  PIC X.
   473         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   474         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   475
   476     12  PI-CLAIM-USER                   PIC X.
   477         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   478         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   479
   480     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   481         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   482         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   483         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   484         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   485         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   486
   487     12  PI-PROCESSOR-ID                 PIC X(4).
   488
   489     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   490
   491     12  PI-MEMBER-CAPTION               PIC X(10).
   492
   493     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   494         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   495
   496     12  PI-LIFE-OVERRIDE-L1             PIC X.
   497     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   498     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   499     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   500
   501     12  PI-AH-OVERRIDE-L1               PIC X.
   502     12  PI-AH-OVERRIDE-L2               PIC XX.
   503     12  PI-AH-OVERRIDE-L6               PIC X(6).
   504     12  PI-AH-OVERRIDE-L12              PIC X(12).
   505
   506     12  PI-NEW-SYSTEM                   PIC X(2).
   507
   508     12  PI-PRIMARY-CERT-NO              PIC X(11).
   509     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   510         88  PI-USES-PAID-TO                 VALUE '1'.
   511     12  PI-CRDTCRD-SYSTEM.
   512         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  14
* EL1279.cbl
   513             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   514             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   515         16  PI-CC-MONTH-END-DT          PIC XX.
   516     12  PI-PROCESSOR-PRINTER            PIC X(4).
   517
   518     12  PI-OE-REFERENCE-2.
   519         16  PI-OE-REF-2-PRIME           PIC X(10).
   520         16  PI-OE-REF-2-SUFF            PIC X.
   521
   522     12  PI-REM-TRM-CALC-OPTION          PIC X.
   523
   524     12  PI-LANGUAGE-TYPE                PIC X.
   525             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   526             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   527             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   528
   529     12  PI-POLICY-LINKAGE-IND           PIC X.
   530         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   531         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   532                                                   LOW-VALUES.
   533
   534     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   535     12  PI-CLAIM-PW-SESSION             PIC X(1).
   536         88  PI-CLAIM-CREDIT                 VALUE '1'.
   537         88  PI-CLAIM-CONVEN                 VALUE '2'.
   538
   539     12  PI-PROCESSOR-CSR-IND            PIC X.
   540         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   541         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   542
   543     12  FILLER                          PIC X(3).
   544
   545     12  PI-SYSTEM-LEVEL                 PIC X(145).
   546
   547     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   548         PI-SYSTEM-LEVEL.
   549
   550         16  PI-ENTRY-CODES.
   551             20  PI-ENTRY-CD-1           PIC X.
   552             20  PI-ENTRY-CD-2           PIC X.
   553
   554         16  PI-RETURN-CODES.
   555             20  PI-RETURN-CD-1          PIC X.
   556             20  PI-RETURN-CD-2          PIC X.
   557
   558         16  PI-UPDATE-STATUS-SAVE.
   559             20  PI-UPDATE-BY            PIC X(4).
   560             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   561
   562         16  PI-LOWER-CASE-LETTERS       PIC X.
   563             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   564
   565*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   566*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   567*            88  CARRIER-CLM-CNTL            VALUE '2'.
   568
   569         16  PI-CERT-ACCESS-CONTROL      PIC X.
   570             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  15
* EL1279.cbl
   571             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   572             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   573             88  ACCNT-CNTL                  VALUE '3'.
   574             88  CARR-ACCNT-CNTL             VALUE '4'.
   575
   576         16  PI-PROCESSOR-CAP-LIST.
   577             20  PI-SYSTEM-CONTROLS.
   578                24 PI-SYSTEM-DISPLAY     PIC X.
   579                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   580                24 PI-SYSTEM-MODIFY      PIC X.
   581                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   582             20  FILLER                  PIC XX.
   583             20  PI-DISPLAY-CAP          PIC X.
   584                 88  DISPLAY-CAP             VALUE 'Y'.
   585             20  PI-MODIFY-CAP           PIC X.
   586                 88  MODIFY-CAP              VALUE 'Y'.
   587             20  PI-MSG-AT-LOGON-CAP     PIC X.
   588                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   589             20  PI-FORCE-CAP            PIC X.
   590                 88  FORCE-CAP               VALUE 'Y'.
   591
   592         16  PI-PROGRAM-CONTROLS.
   593             20  PI-PGM-PRINT-OPT        PIC X.
   594             20  PI-PGM-FORMAT-OPT       PIC X.
   595             20  PI-PGM-PROCESS-OPT      PIC X.
   596             20  PI-PGM-TOTALS-OPT       PIC X.
   597
   598         16  PI-HELP-INTERFACE.
   599             20  PI-LAST-ERROR-NO        PIC X(4).
   600             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   601
   602         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   603             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   604
   605         16  PI-CR-CONTROL-IN-PROGRESS.
   606             20  PI-CR-CARRIER           PIC X.
   607             20  PI-CR-GROUPING          PIC X(6).
   608             20  PI-CR-STATE             PIC XX.
   609             20  PI-CR-ACCOUNT           PIC X(10).
   610             20  PI-CR-FIN-RESP          PIC X(10).
   611             20  PI-CR-TYPE              PIC X.
   612
   613         16  PI-CR-BATCH-NUMBER          PIC X(6).
   614
   615         16  PI-CR-MONTH-END-DT          PIC XX.
   616
   617         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   618             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   619             88  PI-ZERO-CARRIER             VALUE '1'.
   620             88  PI-ZERO-GROUPING            VALUE '2'.
   621             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   622
   623         16  PI-CARRIER-SECURITY         PIC X.
   624             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   625
   626         16  PI-ACCOUNT-SECURITY         PIC X(10).
   627             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   628             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  16
* EL1279.cbl
   629
   630         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   631             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   632                                         INDEXED BY PI-ACCESS-NDX
   633                                         PIC X.
   634
   635         16  PI-GA-BILLING-CONTROL       PIC X.
   636             88  PI-GA-BILLING               VALUE '1'.
   637
   638         16  PI-MAIL-PROCESSING          PIC X.
   639             88  PI-MAIL-YES                 VALUE 'Y'.
   640
   641         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   642
   643         16  PI-AR-SYSTEM.
   644             20  PI-AR-PROCESSING-CNTL   PIC X.
   645                 88  PI-AR-PROCESSING        VALUE 'Y'.
   646             20  PI-AR-SUMMARY-CODE      PIC X(6).
   647             20  PI-AR-MONTH-END-DT      PIC XX.
   648
   649         16  PI-MP-SYSTEM.
   650             20  PI-MORTGAGE-USER            PIC X.
   651                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   652                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   653             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   654                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   655                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   656                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   657                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   658                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   659             20  PI-MP-MONTH-END-DT          PIC XX.
   660             20  PI-MP-REFERENCE-NO.
   661                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   662                 24  PI-MP-REFERENCE-SFX     PIC XX.
   663
   664         16  PI-LABEL-CONTROL            PIC X(01).
   665             88  PI-CREATE-LABELS                    VALUE 'Y'.
   666             88  PI-BYPASS-LABELS                    VALUE 'N'.
   667
   668         16  PI-BILL-GROUPING-CODE       PIC X(01).
   669             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   670
   671         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   672             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   673             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   674
   675         16  FILLER                      PIC X(14).
   676
   677     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   678******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  17
* EL1279.cbl
   680     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   681         16  FILLER              PIC X(318).
   682         16  PI-TOTAL-LINES      PIC S9(3).
   683         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   684         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   685         16  PI-UPDATE-SW        PIC X.
   686             88  PI-CHANGES-MADE             VALUE '1'.
   687         16  PI-PF5-PRESSED      PIC X.
   688             88 PF5-PRESSED                  VALUE 'Y'.
   689         16  PI-PF6-PRESSED      PIC X.
   690             88 PF6-PRESSED                  VALUE 'Y'.
   691         16  PI-CURR-NOTE-REC-TYPE PIC X.
   692             88 PI-CERT-NOTE                 VALUE '1'.
   693             88 PI-CLAIM-NOTE                VALUE '2'.
   694         16  PI-BILLING-NOTES-EXIST PIC X.
   695         16  PI-CERT-NOTES-EXIST    PIC X.
   696         16  PI-CLAIM-NOTES-EXIST   PIC X.
   697         16  PI-SET-NOTE-CHANGE  PIC X.
   698             88 PI-CHANGE-IN-NOTE-TYPE       VALUE 'Y'.
   699         16  pi-iss-can-trans    pic x.
   700             88  pi-from-issue     value '1'.
   701             88  pi-from-cancel    value '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  18
* EL1279.cbl
   703*                          COPY ELCATTR.
   704******************************************************************
   705*                                                                *
   706*                            ELCATTR.                            *
   707*                            VMOD=2.001                          *
   708*                                                                *
   709*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   710*                                                                *
   711*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   712*                                                                *
   713*                   POS 1   P=PROTECTED                          *
   714*                           U=UNPROTECTED                        *
   715*                           S=ASKIP                              *
   716*                   POS 2   A=ALPHA/NUMERIC                      *
   717*                           N=NUMERIC                            *
   718*                   POS 3   N=NORMAL                             *
   719*                           B=BRIGHT                             *
   720*                           D=DARK                               *
   721*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   722*                           OF=MODIFIED DATA TAG OFF             *
   723*                                                                *
   724*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   725******************************************************************
   726 01  ATTRIBUTE-LIST.
   727     12  AL-PABOF            PIC X       VALUE 'Y'.
   728     12  AL-PABON            PIC X       VALUE 'Z'.
   729     12  AL-PADOF            PIC X       VALUE '%'.
   730     12  AL-PADON            PIC X       VALUE '_'.
   731     12  AL-PANOF            PIC X       VALUE '-'.
   732     12  AL-PANON            PIC X       VALUE '/'.
   733     12  AL-SABOF            PIC X       VALUE '8'.
   734     12  AL-SABON            PIC X       VALUE '9'.
   735     12  AL-SADOF            PIC X       VALUE '@'.
   736     12  AL-SADON            PIC X       VALUE QUOTE.
   737     12  AL-SANOF            PIC X       VALUE '0'.
   738     12  AL-SANON            PIC X       VALUE '1'.
   739     12  AL-UABOF            PIC X       VALUE 'H'.
   740     12  AL-UABON            PIC X       VALUE 'I'.
   741     12  AL-UADOF            PIC X       VALUE '<'.
   742     12  AL-UADON            PIC X       VALUE '('.
   743     12  AL-UANOF            PIC X       VALUE ' '.
   744     12  AL-UANON            PIC X       VALUE 'A'.
   745     12  AL-UNBOF            PIC X       VALUE 'Q'.
   746     12  AL-UNBON            PIC X       VALUE 'R'.
   747     12  AL-UNDOF            PIC X       VALUE '*'.
   748     12  AL-UNDON            PIC X       VALUE ')'.
   749     12  AL-UNNOF            PIC X       VALUE '&'.
   750     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  19
* EL1279.cbl
   752*                          COPY ELCDATE.
   753******************************************************************
   754*                                                                *
   755*                                                                *
   756*                            ELCDATE.                            *
   757*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   758*                            VMOD=2.003
   759*                                                                *
   760*                                                                *
   761*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   762*                 LENGTH = 200                                   *
   763******************************************************************
   764
   765 01  DATE-CONVERSION-DATA.
   766     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   767     12  DC-OPTION-CODE                PIC X.
   768         88  BIN-TO-GREG                VALUE ' '.
   769         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   770         88  EDIT-GREG-TO-BIN           VALUE '2'.
   771         88  YMD-GREG-TO-BIN            VALUE '3'.
   772         88  MDY-GREG-TO-BIN            VALUE '4'.
   773         88  JULIAN-TO-BIN              VALUE '5'.
   774         88  BIN-PLUS-ELAPSED           VALUE '6'.
   775         88  FIND-CENTURY               VALUE '7'.
   776         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   777         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   778         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   779         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   780         88  JULIAN-TO-BIN-3            VALUE 'C'.
   781         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   782         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   783         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   784         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   785         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   786         88  CHECK-LEAP-YEAR            VALUE 'H'.
   787         88  BIN-3-TO-GREG              VALUE 'I'.
   788         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   789         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   790         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   791         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   792         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   793         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   794         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   795         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   796         88  THREE-CHARACTER-BIN
   797                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   798         88  GREGORIAN-TO-BIN
   799                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   800         88  BIN-TO-GREGORIAN
   801                  VALUES ' ' '1' 'I' '8' 'G'.
   802         88  JULIAN-TO-BINARY
   803                  VALUES '5' 'C' 'E' 'F'.
   804     12  DC-ERROR-CODE                 PIC X.
   805         88  NO-CONVERSION-ERROR        VALUE ' '.
   806         88  DATE-CONVERSION-ERROR
   807                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   808         88  DATE-IS-ZERO               VALUE '1'.
   809         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  20
* EL1279.cbl
   810         88  DATE-IS-INVALID            VALUE '3'.
   811         88  DATE1-GREATER-DATE2        VALUE '4'.
   812         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   813         88  DATE-INVALID-OPTION        VALUE '9'.
   814         88  INVALID-CENTURY            VALUE 'A'.
   815         88  ONLY-CENTURY               VALUE 'B'.
   816         88  ONLY-LEAP-YEAR             VALUE 'C'.
   817         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   818     12  DC-END-OF-MONTH               PIC X.
   819         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   820     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   821         88  USE-NORMAL-PROCESS         VALUE ' '.
   822         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   823         88  ADJUST-UP-100-YRS          VALUE '2'.
   824     12  FILLER                        PIC X.
   825     12  DC-CONVERSION-DATES.
   826         16  DC-BIN-DATE-1             PIC XX.
   827         16  DC-BIN-DATE-2             PIC XX.
   828         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   829         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   830                       DC-GREG-DATE-1-EDIT.
   831             20  DC-EDIT1-MONTH        PIC 99.
   832             20  SLASH1-1              PIC X.
   833             20  DC-EDIT1-DAY          PIC 99.
   834             20  SLASH1-2              PIC X.
   835             20  DC-EDIT1-YEAR         PIC 99.
   836         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   837         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   838                     DC-GREG-DATE-2-EDIT.
   839             20  DC-EDIT2-MONTH        PIC 99.
   840             20  SLASH2-1              PIC X.
   841             20  DC-EDIT2-DAY          PIC 99.
   842             20  SLASH2-2              PIC X.
   843             20  DC-EDIT2-YEAR         PIC 99.
   844         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   845         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   846                     DC-GREG-DATE-1-YMD.
   847             20  DC-YMD-YEAR           PIC 99.
   848             20  DC-YMD-MONTH          PIC 99.
   849             20  DC-YMD-DAY            PIC 99.
   850         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   851         16  DC-GREG-DATE-1-MDY-R REDEFINES
   852                      DC-GREG-DATE-1-MDY.
   853             20  DC-MDY-MONTH          PIC 99.
   854             20  DC-MDY-DAY            PIC 99.
   855             20  DC-MDY-YEAR           PIC 99.
   856         16  DC-GREG-DATE-1-ALPHA.
   857             20  DC-ALPHA-MONTH        PIC X(10).
   858             20  DC-ALPHA-DAY          PIC 99.
   859             20  FILLER                PIC XX.
   860             20  DC-ALPHA-CENTURY.
   861                 24 DC-ALPHA-CEN-N     PIC 99.
   862             20  DC-ALPHA-YEAR         PIC 99.
   863         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   864         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   865         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   866         16  DC-JULIAN-DATE            PIC 9(05).
   867         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  21
* EL1279.cbl
   868                                       PIC 9(05).
   869         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   870             20  DC-JULIAN-YEAR        PIC 99.
   871             20  DC-JULIAN-DAYS        PIC 999.
   872         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   873         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   874         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   875     12  DATE-CONVERSION-VARIBLES.
   876         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   877         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   878             20  FILLER                PIC 9(3).
   879             20  HOLD-CEN-1-CCYY.
   880                 24  HOLD-CEN-1-CC     PIC 99.
   881                 24  HOLD-CEN-1-YY     PIC 99.
   882             20  HOLD-CEN-1-MO         PIC 99.
   883             20  HOLD-CEN-1-DA         PIC 99.
   884         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   885             20  HOLD-CEN-1-R-MO       PIC 99.
   886             20  HOLD-CEN-1-R-DA       PIC 99.
   887             20  HOLD-CEN-1-R-CCYY.
   888                 24  HOLD-CEN-1-R-CC   PIC 99.
   889                 24  HOLD-CEN-1-R-YY   PIC 99.
   890             20  FILLER                PIC 9(3).
   891         16  HOLD-CENTURY-1-X.
   892             20  FILLER                PIC X(3)  VALUE SPACES.
   893             20  HOLD-CEN-1-X-CCYY.
   894                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   895                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   896             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   897             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   898         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   899             20  HOLD-CEN-1-R-X-MO     PIC XX.
   900             20  HOLD-CEN-1-R-X-DA     PIC XX.
   901             20  HOLD-CEN-1-R-X-CCYY.
   902                 24  HOLD-CEN-1-R-X-CC PIC XX.
   903                 24  HOLD-CEN-1-R-X-YY PIC XX.
   904             20  FILLER                PIC XXX.
   905         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   906         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   907         16  DC-JULIAN-DATE-1          PIC 9(07).
   908         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   909             20  DC-JULIAN-1-CCYY.
   910                 24  DC-JULIAN-1-CC    PIC 99.
   911                 24  DC-JULIAN-1-YR    PIC 99.
   912             20  DC-JULIAN-DA-1        PIC 999.
   913         16  DC-JULIAN-DATE-2          PIC 9(07).
   914         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   915             20  DC-JULIAN-2-CCYY.
   916                 24  DC-JULIAN-2-CC    PIC 99.
   917                 24  DC-JULIAN-2-YR    PIC 99.
   918             20  DC-JULIAN-DA-2        PIC 999.
   919         16  DC-GREG-DATE-A-EDIT.
   920             20  DC-EDITA-MONTH        PIC 99.
   921             20  SLASHA-1              PIC X VALUE '/'.
   922             20  DC-EDITA-DAY          PIC 99.
   923             20  SLASHA-2              PIC X VALUE '/'.
   924             20  DC-EDITA-CCYY.
   925                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  22
* EL1279.cbl
   926                 24  DC-EDITA-YEAR     PIC 99.
   927         16  DC-GREG-DATE-B-EDIT.
   928             20  DC-EDITB-MONTH        PIC 99.
   929             20  SLASHB-1              PIC X VALUE '/'.
   930             20  DC-EDITB-DAY          PIC 99.
   931             20  SLASHB-2              PIC X VALUE '/'.
   932             20  DC-EDITB-CCYY.
   933                 24  DC-EDITB-CENT     PIC 99.
   934                 24  DC-EDITB-YEAR     PIC 99.
   935         16  DC-GREG-DATE-CYMD         PIC 9(08).
   936         16  DC-GREG-DATE-CYMD-R REDEFINES
   937                              DC-GREG-DATE-CYMD.
   938             20  DC-CYMD-CEN           PIC 99.
   939             20  DC-CYMD-YEAR          PIC 99.
   940             20  DC-CYMD-MONTH         PIC 99.
   941             20  DC-CYMD-DAY           PIC 99.
   942         16  DC-GREG-DATE-MDCY         PIC 9(08).
   943         16  DC-GREG-DATE-MDCY-R REDEFINES
   944                              DC-GREG-DATE-MDCY.
   945             20  DC-MDCY-MONTH         PIC 99.
   946             20  DC-MDCY-DAY           PIC 99.
   947             20  DC-MDCY-CEN           PIC 99.
   948             20  DC-MDCY-YEAR          PIC 99.
   949    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   950        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   951    12  DC-EL310-DATE                  PIC X(21).
   952    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  23
* EL1279.cbl
   954*                          COPY EL1279S.
   955 01  EL1279AI.
   956     05  FILLER            PIC  X(0012).
   957*    -------------------------------
   958     05  DATEL PIC S9(0004) COMP.
   959     05  DATEF PIC  X(0001).
   960     05  FILLER REDEFINES DATEF.
   961         10  DATEA PIC  X(0001).
   962     05  DATEI PIC  X(0008).
   963*    -------------------------------
   964     05  TIMEL PIC S9(0004) COMP.
   965     05  TIMEF PIC  X(0001).
   966     05  FILLER REDEFINES TIMEF.
   967         10  TIMEA PIC  X(0001).
   968     05  TIMEI PIC  X(0005).
   969*    -------------------------------
   970     05  CMPNYIDL PIC S9(0004) COMP.
   971     05  CMPNYIDF PIC  X(0001).
   972     05  FILLER REDEFINES CMPNYIDF.
   973         10  CMPNYIDA PIC  X(0001).
   974     05  CMPNYIDI PIC  X(0003).
   975*    -------------------------------
   976     05  USERIDL PIC S9(0004) COMP.
   977     05  USERIDF PIC  X(0001).
   978     05  FILLER REDEFINES USERIDF.
   979         10  USERIDA PIC  X(0001).
   980     05  USERIDI PIC  X(0004).
   981*    -------------------------------
   982     05  FCERTL PIC S9(0004) COMP.
   983     05  FCERTF PIC  X(0001).
   984     05  FILLER REDEFINES FCERTF.
   985         10  FCERTA PIC  X(0001).
   986     05  FCERTI PIC  X(0010).
   987*    -------------------------------
   988     05  FCRTSFXL PIC S9(0004) COMP.
   989     05  FCRTSFXF PIC  X(0001).
   990     05  FILLER REDEFINES FCRTSFXF.
   991         10  FCRTSFXA PIC  X(0001).
   992     05  FCRTSFXI PIC  X(0001).
   993*    -------------------------------
   994     05  FACOUNTL PIC S9(0004) COMP.
   995     05  FACOUNTF PIC  X(0001).
   996     05  FILLER REDEFINES FACOUNTF.
   997         10  FACOUNTA PIC  X(0001).
   998     05  FACOUNTI PIC  X(0010).
   999*    -------------------------------
  1000     05  FSTL PIC S9(0004) COMP.
  1001     05  FSTF PIC  X(0001).
  1002     05  FILLER REDEFINES FSTF.
  1003         10  FSTA PIC  X(0001).
  1004     05  FSTI PIC  X(0002).
  1005*    -------------------------------
  1006     05  FCARRIRL PIC S9(0004) COMP.
  1007     05  FCARRIRF PIC  X(0001).
  1008     05  FILLER REDEFINES FCARRIRF.
  1009         10  FCARRIRA PIC  X(0001).
  1010     05  FCARRIRI PIC  X(0001).
  1011*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  24
* EL1279.cbl
  1012     05  FGROUPL PIC S9(0004) COMP.
  1013     05  FGROUPF PIC  X(0001).
  1014     05  FILLER REDEFINES FGROUPF.
  1015         10  FGROUPA PIC  X(0001).
  1016     05  FGROUPI PIC  X(0006).
  1017*    -------------------------------
  1018     05  FEFFDTL PIC S9(0004) COMP.
  1019     05  FEFFDTF PIC  X(0001).
  1020     05  FILLER REDEFINES FEFFDTF.
  1021         10  FEFFDTA PIC  X(0001).
  1022     05  FEFFDTI PIC  X(0008).
  1023*    -------------------------------
  1024     05  TOTL PIC S9(0004) COMP.
  1025     05  TOTF PIC  X(0001).
  1026     05  FILLER REDEFINES TOTF.
  1027         10  TOTA PIC  X(0001).
  1028     05  TOTI PIC  X(0003).
  1029*    -------------------------------
  1030     05  FBILLYNL PIC S9(0004) COMP.
  1031     05  FBILLYNF PIC  X(0001).
  1032     05  FILLER REDEFINES FBILLYNF.
  1033         10  FBILLYNA PIC  X(0001).
  1034     05  FBILLYNI PIC  X(0003).
  1035*    -------------------------------
  1036     05  FTYPEYNL PIC S9(0004) COMP.
  1037     05  FTYPEYNF PIC  X(0001).
  1038     05  FILLER REDEFINES FTYPEYNF.
  1039         10  FTYPEYNA PIC  X(0001).
  1040     05  FTYPEYNI PIC  X(0012).
  1041*    -------------------------------
  1042     05  FCERTYNL PIC S9(0004) COMP.
  1043     05  FCERTYNF PIC  X(0001).
  1044     05  FILLER REDEFINES FCERTYNF.
  1045         10  FCERTYNA PIC  X(0001).
  1046     05  FCERTYNI PIC  X(0003).
  1047*    -------------------------------
  1048     05  FTYPEL PIC S9(0004) COMP.
  1049     05  FTYPEF PIC  X(0001).
  1050     05  FILLER REDEFINES FTYPEF.
  1051         10  FTYPEA PIC  X(0001).
  1052     05  FTYPEI PIC  X(0063).
  1053*    -------------------------------
  1054     05  LN1L PIC S9(0004) COMP.
  1055     05  LN1F PIC  X(0001).
  1056     05  FILLER REDEFINES LN1F.
  1057         10  LN1A PIC  X(0001).
  1058     05  LN1I PIC  X(0003).
  1059*    -------------------------------
  1060     05  FNLINE1L PIC S9(0004) COMP.
  1061     05  FNLINE1F PIC  X(0001).
  1062     05  FILLER REDEFINES FNLINE1F.
  1063         10  FNLINE1A PIC  X(0001).
  1064     05  FNLINE1I PIC  X(0063).
  1065*    -------------------------------
  1066     05  MTBY1L PIC S9(0004) COMP.
  1067     05  MTBY1F PIC  X(0001).
  1068     05  FILLER REDEFINES MTBY1F.
  1069         10  MTBY1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  25
* EL1279.cbl
  1070     05  MTBY1I PIC  X(0004).
  1071*    -------------------------------
  1072     05  MTDT1L PIC S9(0004) COMP.
  1073     05  MTDT1F PIC  X(0001).
  1074     05  FILLER REDEFINES MTDT1F.
  1075         10  MTDT1A PIC  X(0001).
  1076     05  MTDT1I PIC  X(0006).
  1077*    -------------------------------
  1078     05  LN2L PIC S9(0004) COMP.
  1079     05  LN2F PIC  X(0001).
  1080     05  FILLER REDEFINES LN2F.
  1081         10  LN2A PIC  X(0001).
  1082     05  LN2I PIC  X(0003).
  1083*    -------------------------------
  1084     05  FNLINE2L PIC S9(0004) COMP.
  1085     05  FNLINE2F PIC  X(0001).
  1086     05  FILLER REDEFINES FNLINE2F.
  1087         10  FNLINE2A PIC  X(0001).
  1088     05  FNLINE2I PIC  X(0063).
  1089*    -------------------------------
  1090     05  MTBY2L PIC S9(0004) COMP.
  1091     05  MTBY2F PIC  X(0001).
  1092     05  FILLER REDEFINES MTBY2F.
  1093         10  MTBY2A PIC  X(0001).
  1094     05  MTBY2I PIC  X(0004).
  1095*    -------------------------------
  1096     05  MTDT2L PIC S9(0004) COMP.
  1097     05  MTDT2F PIC  X(0001).
  1098     05  FILLER REDEFINES MTDT2F.
  1099         10  MTDT2A PIC  X(0001).
  1100     05  MTDT2I PIC  X(0006).
  1101*    -------------------------------
  1102     05  LN3L PIC S9(0004) COMP.
  1103     05  LN3F PIC  X(0001).
  1104     05  FILLER REDEFINES LN3F.
  1105         10  LN3A PIC  X(0001).
  1106     05  LN3I PIC  X(0003).
  1107*    -------------------------------
  1108     05  FNLINE3L PIC S9(0004) COMP.
  1109     05  FNLINE3F PIC  X(0001).
  1110     05  FILLER REDEFINES FNLINE3F.
  1111         10  FNLINE3A PIC  X(0001).
  1112     05  FNLINE3I PIC  X(0063).
  1113*    -------------------------------
  1114     05  MTBY3L PIC S9(0004) COMP.
  1115     05  MTBY3F PIC  X(0001).
  1116     05  FILLER REDEFINES MTBY3F.
  1117         10  MTBY3A PIC  X(0001).
  1118     05  MTBY3I PIC  X(0004).
  1119*    -------------------------------
  1120     05  MTDT3L PIC S9(0004) COMP.
  1121     05  MTDT3F PIC  X(0001).
  1122     05  FILLER REDEFINES MTDT3F.
  1123         10  MTDT3A PIC  X(0001).
  1124     05  MTDT3I PIC  X(0006).
  1125*    -------------------------------
  1126     05  LN4L PIC S9(0004) COMP.
  1127     05  LN4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  26
* EL1279.cbl
  1128     05  FILLER REDEFINES LN4F.
  1129         10  LN4A PIC  X(0001).
  1130     05  LN4I PIC  X(0003).
  1131*    -------------------------------
  1132     05  FNLINE4L PIC S9(0004) COMP.
  1133     05  FNLINE4F PIC  X(0001).
  1134     05  FILLER REDEFINES FNLINE4F.
  1135         10  FNLINE4A PIC  X(0001).
  1136     05  FNLINE4I PIC  X(0063).
  1137*    -------------------------------
  1138     05  MTBY4L PIC S9(0004) COMP.
  1139     05  MTBY4F PIC  X(0001).
  1140     05  FILLER REDEFINES MTBY4F.
  1141         10  MTBY4A PIC  X(0001).
  1142     05  MTBY4I PIC  X(0004).
  1143*    -------------------------------
  1144     05  MTDT4L PIC S9(0004) COMP.
  1145     05  MTDT4F PIC  X(0001).
  1146     05  FILLER REDEFINES MTDT4F.
  1147         10  MTDT4A PIC  X(0001).
  1148     05  MTDT4I PIC  X(0006).
  1149*    -------------------------------
  1150     05  LN5L PIC S9(0004) COMP.
  1151     05  LN5F PIC  X(0001).
  1152     05  FILLER REDEFINES LN5F.
  1153         10  LN5A PIC  X(0001).
  1154     05  LN5I PIC  X(0003).
  1155*    -------------------------------
  1156     05  FNLINE5L PIC S9(0004) COMP.
  1157     05  FNLINE5F PIC  X(0001).
  1158     05  FILLER REDEFINES FNLINE5F.
  1159         10  FNLINE5A PIC  X(0001).
  1160     05  FNLINE5I PIC  X(0063).
  1161*    -------------------------------
  1162     05  MTBY5L PIC S9(0004) COMP.
  1163     05  MTBY5F PIC  X(0001).
  1164     05  FILLER REDEFINES MTBY5F.
  1165         10  MTBY5A PIC  X(0001).
  1166     05  MTBY5I PIC  X(0004).
  1167*    -------------------------------
  1168     05  MTDT5L PIC S9(0004) COMP.
  1169     05  MTDT5F PIC  X(0001).
  1170     05  FILLER REDEFINES MTDT5F.
  1171         10  MTDT5A PIC  X(0001).
  1172     05  MTDT5I PIC  X(0006).
  1173*    -------------------------------
  1174     05  LN6L PIC S9(0004) COMP.
  1175     05  LN6F PIC  X(0001).
  1176     05  FILLER REDEFINES LN6F.
  1177         10  LN6A PIC  X(0001).
  1178     05  LN6I PIC  X(0003).
  1179*    -------------------------------
  1180     05  FNLINE6L PIC S9(0004) COMP.
  1181     05  FNLINE6F PIC  X(0001).
  1182     05  FILLER REDEFINES FNLINE6F.
  1183         10  FNLINE6A PIC  X(0001).
  1184     05  FNLINE6I PIC  X(0063).
  1185*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  27
* EL1279.cbl
  1186     05  MTBY6L PIC S9(0004) COMP.
  1187     05  MTBY6F PIC  X(0001).
  1188     05  FILLER REDEFINES MTBY6F.
  1189         10  MTBY6A PIC  X(0001).
  1190     05  MTBY6I PIC  X(0004).
  1191*    -------------------------------
  1192     05  MTDT6L PIC S9(0004) COMP.
  1193     05  MTDT6F PIC  X(0001).
  1194     05  FILLER REDEFINES MTDT6F.
  1195         10  MTDT6A PIC  X(0001).
  1196     05  MTDT6I PIC  X(0006).
  1197*    -------------------------------
  1198     05  LN7L PIC S9(0004) COMP.
  1199     05  LN7F PIC  X(0001).
  1200     05  FILLER REDEFINES LN7F.
  1201         10  LN7A PIC  X(0001).
  1202     05  LN7I PIC  X(0003).
  1203*    -------------------------------
  1204     05  FNLINE7L PIC S9(0004) COMP.
  1205     05  FNLINE7F PIC  X(0001).
  1206     05  FILLER REDEFINES FNLINE7F.
  1207         10  FNLINE7A PIC  X(0001).
  1208     05  FNLINE7I PIC  X(0063).
  1209*    -------------------------------
  1210     05  MTBY7L PIC S9(0004) COMP.
  1211     05  MTBY7F PIC  X(0001).
  1212     05  FILLER REDEFINES MTBY7F.
  1213         10  MTBY7A PIC  X(0001).
  1214     05  MTBY7I PIC  X(0004).
  1215*    -------------------------------
  1216     05  MTDT7L PIC S9(0004) COMP.
  1217     05  MTDT7F PIC  X(0001).
  1218     05  FILLER REDEFINES MTDT7F.
  1219         10  MTDT7A PIC  X(0001).
  1220     05  MTDT7I PIC  X(0006).
  1221*    -------------------------------
  1222     05  LN8L PIC S9(0004) COMP.
  1223     05  LN8F PIC  X(0001).
  1224     05  FILLER REDEFINES LN8F.
  1225         10  LN8A PIC  X(0001).
  1226     05  LN8I PIC  X(0003).
  1227*    -------------------------------
  1228     05  FNLINE8L PIC S9(0004) COMP.
  1229     05  FNLINE8F PIC  X(0001).
  1230     05  FILLER REDEFINES FNLINE8F.
  1231         10  FNLINE8A PIC  X(0001).
  1232     05  FNLINE8I PIC  X(0063).
  1233*    -------------------------------
  1234     05  MTBY8L PIC S9(0004) COMP.
  1235     05  MTBY8F PIC  X(0001).
  1236     05  FILLER REDEFINES MTBY8F.
  1237         10  MTBY8A PIC  X(0001).
  1238     05  MTBY8I PIC  X(0004).
  1239*    -------------------------------
  1240     05  MTDT8L PIC S9(0004) COMP.
  1241     05  MTDT8F PIC  X(0001).
  1242     05  FILLER REDEFINES MTDT8F.
  1243         10  MTDT8A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  28
* EL1279.cbl
  1244     05  MTDT8I PIC  X(0006).
  1245*    -------------------------------
  1246     05  LN9L PIC S9(0004) COMP.
  1247     05  LN9F PIC  X(0001).
  1248     05  FILLER REDEFINES LN9F.
  1249         10  LN9A PIC  X(0001).
  1250     05  LN9I PIC  X(0003).
  1251*    -------------------------------
  1252     05  FNLINE9L PIC S9(0004) COMP.
  1253     05  FNLINE9F PIC  X(0001).
  1254     05  FILLER REDEFINES FNLINE9F.
  1255         10  FNLINE9A PIC  X(0001).
  1256     05  FNLINE9I PIC  X(0063).
  1257*    -------------------------------
  1258     05  MTBY9L PIC S9(0004) COMP.
  1259     05  MTBY9F PIC  X(0001).
  1260     05  FILLER REDEFINES MTBY9F.
  1261         10  MTBY9A PIC  X(0001).
  1262     05  MTBY9I PIC  X(0004).
  1263*    -------------------------------
  1264     05  MTDT9L PIC S9(0004) COMP.
  1265     05  MTDT9F PIC  X(0001).
  1266     05  FILLER REDEFINES MTDT9F.
  1267         10  MTDT9A PIC  X(0001).
  1268     05  MTDT9I PIC  X(0006).
  1269*    -------------------------------
  1270     05  LN10L PIC S9(0004) COMP.
  1271     05  LN10F PIC  X(0001).
  1272     05  FILLER REDEFINES LN10F.
  1273         10  LN10A PIC  X(0001).
  1274     05  LN10I PIC  X(0003).
  1275*    -------------------------------
  1276     05  FNLIN10L PIC S9(0004) COMP.
  1277     05  FNLIN10F PIC  X(0001).
  1278     05  FILLER REDEFINES FNLIN10F.
  1279         10  FNLIN10A PIC  X(0001).
  1280     05  FNLIN10I PIC  X(0063).
  1281*    -------------------------------
  1282     05  MTBY10L PIC S9(0004) COMP.
  1283     05  MTBY10F PIC  X(0001).
  1284     05  FILLER REDEFINES MTBY10F.
  1285         10  MTBY10A PIC  X(0001).
  1286     05  MTBY10I PIC  X(0004).
  1287*    -------------------------------
  1288     05  MTDT10L PIC S9(0004) COMP.
  1289     05  MTDT10F PIC  X(0001).
  1290     05  FILLER REDEFINES MTDT10F.
  1291         10  MTDT10A PIC  X(0001).
  1292     05  MTDT10I PIC  X(0006).
  1293*    -------------------------------
  1294     05  ERRMSGBL PIC S9(0004) COMP.
  1295     05  ERRMSGBF PIC  X(0001).
  1296     05  FILLER REDEFINES ERRMSGBF.
  1297         10  ERRMSGBA PIC  X(0001).
  1298     05  ERRMSGBI PIC  X(0072).
  1299*    -------------------------------
  1300     05  FUNCTL PIC S9(0004) COMP.
  1301     05  FUNCTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  29
* EL1279.cbl
  1302     05  FILLER REDEFINES FUNCTF.
  1303         10  FUNCTA PIC  X(0001).
  1304     05  FUNCTI PIC  X(0001).
  1305*    -------------------------------
  1306     05  LINE1L PIC S9(0004) COMP.
  1307     05  LINE1F PIC  X(0001).
  1308     05  FILLER REDEFINES LINE1F.
  1309         10  LINE1A PIC  X(0001).
  1310     05  LINE1I PIC  999.
  1311*    -------------------------------
  1312     05  LINE2L PIC S9(0004) COMP.
  1313     05  LINE2F PIC  X(0001).
  1314     05  FILLER REDEFINES LINE2F.
  1315         10  LINE2A PIC  X(0001).
  1316     05  LINE2I PIC  999.
  1317*    -------------------------------
  1318     05  PFENTERL PIC S9(0004) COMP.
  1319     05  PFENTERF PIC  X(0001).
  1320     05  FILLER REDEFINES PFENTERF.
  1321         10  PFENTERA PIC  X(0001).
  1322     05  PFENTERI PIC  99.
  1323*    -------------------------------
  1324     05  PF6NOTEL PIC S9(0004) COMP.
  1325     05  PF6NOTEF PIC  X(0001).
  1326     05  FILLER REDEFINES PF6NOTEF.
  1327         10  PF6NOTEA PIC  X(0001).
  1328     05  PF6NOTEI PIC  X(0014).
  1329 01  EL1279AO REDEFINES EL1279AI.
  1330     05  FILLER            PIC  X(0012).
  1331*    -------------------------------
  1332     05  FILLER            PIC  X(0003).
  1333     05  DATEO PIC  X(0008).
  1334*    -------------------------------
  1335     05  FILLER            PIC  X(0003).
  1336     05  TIMEO PIC  99.99.
  1337*    -------------------------------
  1338     05  FILLER            PIC  X(0003).
  1339     05  CMPNYIDO PIC  X(0003).
  1340*    -------------------------------
  1341     05  FILLER            PIC  X(0003).
  1342     05  USERIDO PIC  X(0004).
  1343*    -------------------------------
  1344     05  FILLER            PIC  X(0003).
  1345     05  FCERTO PIC  X(0010).
  1346*    -------------------------------
  1347     05  FILLER            PIC  X(0003).
  1348     05  FCRTSFXO PIC  X(0001).
  1349*    -------------------------------
  1350     05  FILLER            PIC  X(0003).
  1351     05  FACOUNTO PIC  X(0010).
  1352*    -------------------------------
  1353     05  FILLER            PIC  X(0003).
  1354     05  FSTO PIC  X(0002).
  1355*    -------------------------------
  1356     05  FILLER            PIC  X(0003).
  1357     05  FCARRIRO PIC  X(0001).
  1358*    -------------------------------
  1359     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  30
* EL1279.cbl
  1360     05  FGROUPO PIC  X(0006).
  1361*    -------------------------------
  1362     05  FILLER            PIC  X(0003).
  1363     05  FEFFDTO PIC  X(0008).
  1364*    -------------------------------
  1365     05  FILLER            PIC  X(0003).
  1366     05  TOTO PIC  ZZ9.
  1367*    -------------------------------
  1368     05  FILLER            PIC  X(0003).
  1369     05  FBILLYNO PIC  X(0003).
  1370*    -------------------------------
  1371     05  FILLER            PIC  X(0003).
  1372     05  FTYPEYNO PIC  X(0012).
  1373*    -------------------------------
  1374     05  FILLER            PIC  X(0003).
  1375     05  FCERTYNO PIC  X(0003).
  1376*    -------------------------------
  1377     05  FILLER            PIC  X(0003).
  1378     05  FTYPEO PIC  X(0063).
  1379*    -------------------------------
  1380     05  FILLER            PIC  X(0003).
  1381     05  LN1O PIC  ZZ9.
  1382*    -------------------------------
  1383     05  FILLER            PIC  X(0003).
  1384     05  FNLINE1O PIC  X(0063).
  1385*    -------------------------------
  1386     05  FILLER            PIC  X(0003).
  1387     05  MTBY1O PIC  X(0004).
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(0003).
  1390     05  MTDT1O PIC  X(0006).
  1391*    -------------------------------
  1392     05  FILLER            PIC  X(0003).
  1393     05  LN2O PIC  ZZ9.
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(0003).
  1396     05  FNLINE2O PIC  X(0063).
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(0003).
  1399     05  MTBY2O PIC  X(0004).
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(0003).
  1402     05  MTDT2O PIC  X(0006).
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  LN3O PIC  ZZ9.
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  FNLINE3O PIC  X(0063).
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  MTBY3O PIC  X(0004).
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(0003).
  1414     05  MTDT3O PIC  X(0006).
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  LN4O PIC  ZZ9.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  31
* EL1279.cbl
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
  1420     05  FNLINE4O PIC  X(0063).
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  MTBY4O PIC  X(0004).
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(0003).
  1426     05  MTDT4O PIC  X(0006).
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
  1429     05  LN5O PIC  ZZ9.
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  FNLINE5O PIC  X(0063).
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  MTBY5O PIC  X(0004).
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  MTDT5O PIC  X(0006).
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  LN6O PIC  ZZ9.
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  FNLINE6O PIC  X(0063).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  MTBY6O PIC  X(0004).
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  MTDT6O PIC  X(0006).
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  LN7O PIC  ZZ9.
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  FNLINE7O PIC  X(0063).
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  MTBY7O PIC  X(0004).
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  MTDT7O PIC  X(0006).
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  LN8O PIC  ZZ9.
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  FNLINE8O PIC  X(0063).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  MTBY8O PIC  X(0004).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  MTDT8O PIC  X(0006).
  1475*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  32
* EL1279.cbl
  1476     05  FILLER            PIC  X(0003).
  1477     05  LN9O PIC  ZZ9.
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  FNLINE9O PIC  X(0063).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  MTBY9O PIC  X(0004).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  MTDT9O PIC  X(0006).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  LN10O PIC  ZZ9.
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  FNLIN10O PIC  X(0063).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  MTBY10O PIC  X(0004).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  MTDT10O PIC  X(0006).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  ERRMSGBO PIC  X(0072).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  FUNCTO PIC  X(0001).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  LINE1O PIC  X(0003).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  LINE2O PIC  X(0003).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  PFENTERO PIC  X(0002).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  PF6NOTEO PIC  X(0014).
  1517*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  33
* EL1279.cbl
  1519 01  EL1279R REDEFINES EL1279AI.
  1520     12  FILLER                  PIC X(202).
  1521     12  SC-ALL-LINES.
  1522      14 SC-LINES OCCURS 10 TIMES INDEXED BY SC-INDX.
  1523         16  SC-LINL             PIC S9(4)   COMP.
  1524         16  SC-LINA             PIC X.
  1525         16  SC-LIN              PIC ZZ9.
  1526         16  SC-TEXTL            PIC S9(4)   COMP.
  1527         16  SC-TEXTA            PIC X.
  1528         16  SC-TEXT             PIC X(63).
  1529         16  SC-MTBYL            PIC S9(4)   COMP.
  1530         16  SC-MTBYA            PIC X.
  1531         16  SC-MTBY             PIC X(4).
  1532         16  SC-MTDTL            PIC S9(4)   COMP.
  1533         16  SC-MTDTA            PIC X.
  1534         16  SC-MTDT             PIC X(6).
  1535     12  FILLER                  PIC X(116).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  34
* EL1279.cbl
  1537 01  RECORD-TABLE                PIC X(21900) VALUE SPACES.
  1538 01  REC-TABLE  REDEFINES RECORD-TABLE.
  1539     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX PIC X(3650).
  1540 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  1541     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  1542         16  REC-TEXT                    PIC X(63).
  1543         16  REC-LAST-MAINT-BY           PIC XXXX.
  1544         16  REC-LAST-MAINT-DT           PIC XX.
  1545         16  REC-LAST-MAINT-HHMMSS       PIC S9(7) COMP-3.
  1546
  1547 01  TS-WORK-AREA                        PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  35
* EL1279.cbl
  1549
  1550****************************************************************
  1551*
  1552* Copyright (c) 2007-2013 Dell Inc.
  1553* All rights reserved.
  1554*
  1555****************************************************************
  1556 01  DFHEIV.
  1557   02  DFHEIV0               PIC X(35).
  1558   02  DFHEIV1               PIC X(08).
  1559   02  DFHEIV2               PIC X(08).
  1560   02  DFHEIV3               PIC X(08).
  1561   02  DFHEIV4               PIC X(06).
  1562   02  DFHEIV5               PIC X(04).
  1563   02  DFHEIV6               PIC X(04).
  1564   02  DFHEIV7               PIC X(02).
  1565   02  DFHEIV8               PIC X(02).
  1566   02  DFHEIV9               PIC X(01).
  1567   02  DFHEIV10              PIC S9(7) COMP-3.
  1568   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1569   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1570   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1571   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1572   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1573   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1574   02  DFHEIV17              PIC X(04).
  1575   02  DFHEIV18              PIC X(04).
  1576   02  DFHEIV19              PIC X(04).
  1577   02  DFHEIV20              USAGE IS POINTER.
  1578   02  DFHEIV21              USAGE IS POINTER.
  1579   02  DFHEIV22              USAGE IS POINTER.
  1580   02  DFHEIV23              USAGE IS POINTER.
  1581   02  DFHEIV24              USAGE IS POINTER.
  1582   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1583   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1584   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1585   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1586   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1587   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1588   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1589   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1590   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1591   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1592   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1593   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1594   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1595   02  FILLER                PIC X(02).
  1596   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1597   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1598   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1599   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1600   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1601   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1602   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1603 LINKAGE  SECTION.
  1604*****************************************************************
  1605*                                                               *
  1606* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  36
* EL1279.cbl
  1607* All rights reserved.                                          *
  1608*                                                               *
  1609*****************************************************************
  1610 01  dfheiblk.
  1611     02  eibtime          pic s9(7) comp-3.
  1612     02  eibdate          pic s9(7) comp-3.
  1613     02  eibtrnid         pic x(4).
  1614     02  eibtaskn         pic s9(7) comp-3.
  1615     02  eibtrmid         pic x(4).
  1616     02  dfheigdi         pic s9(4) comp.
  1617     02  eibcposn         pic s9(4) comp.
  1618     02  eibcalen         pic s9(4) comp.
  1619     02  eibaid           pic x(1).
  1620     02  eibfiller1       pic x(1).
  1621     02  eibfn            pic x(2).
  1622     02  eibfiller2       pic x(2).
  1623     02  eibrcode         pic x(6).
  1624     02  eibfiller3       pic x(2).
  1625     02  eibds            pic x(8).
  1626     02  eibreqid         pic x(8).
  1627     02  eibrsrce         pic x(8).
  1628     02  eibsync          pic x(1).
  1629     02  eibfree          pic x(1).
  1630     02  eibrecv          pic x(1).
  1631     02  eibsend          pic x(1).
  1632     02  eibatt           pic x(1).
  1633     02  eibeoc           pic x(1).
  1634     02  eibfmh           pic x(1).
  1635     02  eibcompl         pic x(1).
  1636     02  eibsig           pic x(1).
  1637     02  eibconf          pic x(1).
  1638     02  eiberr           pic x(1).
  1639     02  eibrldbk         pic x(1).
  1640     02  eiberrcd         pic x(4).
  1641     02  eibsynrb         pic x(1).
  1642     02  eibnodat         pic x(1).
  1643     02  eibfiller5       pic x(2).
  1644     02  eibresp          pic s9(8) comp.
  1645     02  eibresp2         pic s9(8) comp.
  1646     02  dfheigdj         pic s9(4) comp.
  1647     02  dfheigdk         pic s9(4) comp.
  1648 01  DFHCOMMAREA                 PIC X(1500).
  1649
  1650*         COPY ERCCNOT.
  1651******************************************************************
  1652*                                                                *
  1653*                            ERCCNOT                             *
  1654*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1655*                            VMOD=2.003                          *
  1656*                                                                *
  1657*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1658*                                                                *
  1659*        FILE TYPE= VSAM,KSDS                                    *
  1660*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1661*                                                                *
  1662*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1663*                                                                *
  1664*        LOG = YES                                               *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  37
* EL1279.cbl
  1665*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1666*                                                                *
  1667******************************************************************
  1668*                   C H A N G E   L O G
  1669*
  1670* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1671*-----------------------------------------------------------------
  1672*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1673* EFFECTIVE    NUMBER
  1674*-----------------------------------------------------------------
  1675* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1676******************************************************************
  1677
  1678 01  CERT-NOTE-FILE.
  1679     12  CZ-RECORD-ID                PIC  XX.
  1680         88  VALID-CZ-ID                  VALUE 'CZ'.
  1681
  1682     12  CZ-CONTROL-PRIMARY.
  1683         16  CZ-COMPANY-CD           PIC X.
  1684         16  CZ-CARRIER              PIC X.
  1685         16  CZ-GROUPING.
  1686             20 CZ-GROUPING-PREFIX   PIC XXX.
  1687             20 CZ-GROUPING-PRIME    PIC XXX.
  1688         16  CZ-STATE                PIC XX.
  1689         16  CZ-ACCOUNT.
  1690             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1691             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1692         16  CZ-CERT-EFF-DT          PIC XX.
  1693         16  CZ-CERT-NO.
  1694             20  CZ-CERT-PRIME       PIC X(10).
  1695             20  CZ-CERT-SFX         PIC X.
  1696         16  CZ-RECORD-TYPE          PIC X.
  1697             88  CERT-NOTE           VALUE '1'.
  1698             88  CLAIM-CERT-NOTE     VALUE '2'.
  1699         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1700
  1701     12  CZ-LAST-MAINT-DT            PIC XX.
  1702     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1703     12  CZ-LAST-MAINT-USER          PIC X(4).
  1704
  1705     12  CZ-NOTE-INFORMATION.
  1706         16  CZ-NOTE                 PIC X(63).
  1707         16  FILLER                  PIC X(39).
  1708******************************************************************
  1709
  1710*         COPY ELCCERT.
  1711******************************************************************
  1712*                                                                *
  1713*                            ELCCERT.                            *
  1714*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1715*                            VMOD=2.013                          *
  1716*                                                                *
  1717*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1718*                                                                *
  1719*   FILE TYPE = VSAM,KSDS                                        *
  1720*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1721*                                                                *
  1722*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  38
* EL1279.cbl
  1723*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1724*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1725*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1726*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1727*                                                                *
  1728*   LOG = YES                                                    *
  1729*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1730******************************************************************
  1731*                   C H A N G E   L O G
  1732*
  1733* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1734*-----------------------------------------------------------------
  1735*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1736* EFFECTIVE    NUMBER
  1737*-----------------------------------------------------------------
  1738* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1739* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1740* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1741* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1742* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1743* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1744* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1745* 032612  CR2011110200001  PEMA  AHL CHANGES
  1746* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1747* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1748* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  1749******************************************************************
  1750
  1751 01  CERTIFICATE-MASTER.
  1752     12  CM-RECORD-ID                      PIC XX.
  1753         88  VALID-CM-ID                      VALUE 'CM'.
  1754
  1755     12  CM-CONTROL-PRIMARY.
  1756         16  CM-COMPANY-CD                 PIC X.
  1757         16  CM-CARRIER                    PIC X.
  1758         16  CM-GROUPING.
  1759             20  CM-GROUPING-PREFIX        PIC X(3).
  1760             20  CM-GROUPING-PRIME         PIC X(3).
  1761         16  CM-STATE                      PIC XX.
  1762         16  CM-ACCOUNT.
  1763             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1764             20  CM-ACCOUNT-PRIME          PIC X(6).
  1765         16  CM-CERT-EFF-DT                PIC XX.
  1766         16  CM-CERT-NO.
  1767             20  CM-CERT-PRIME             PIC X(10).
  1768             20  CM-CERT-SFX               PIC X.
  1769
  1770     12  CM-CONTROL-BY-NAME.
  1771         16  CM-COMPANY-CD-A1              PIC X.
  1772         16  CM-INSURED-LAST-NAME          PIC X(15).
  1773         16  CM-INSURED-INITIALS.
  1774             20  CM-INSURED-INITIAL1       PIC X.
  1775             20  CM-INSURED-INITIAL2       PIC X.
  1776
  1777     12  CM-CONTROL-BY-SSN.
  1778         16  CM-COMPANY-CD-A2              PIC X.
  1779         16  CM-SOC-SEC-NO.
  1780             20  CM-SSN-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  39
* EL1279.cbl
  1781             20  CM-SSN-ACCOUNT            PIC X(6).
  1782             20  CM-SSN-LN3.
  1783                 25  CM-INSURED-INITIALS-A2.
  1784                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1785                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1786                 25 CM-PART-LAST-NAME-A2         PIC X.
  1787
  1788     12  CM-CONTROL-BY-CERT-NO.
  1789         16  CM-COMPANY-CD-A4              PIC X.
  1790         16  CM-CERT-NO-A4                 PIC X(11).
  1791
  1792     12  CM-CONTROL-BY-MEMB.
  1793         16  CM-COMPANY-CD-A5              PIC X.
  1794         16  CM-MEMBER-NO.
  1795             20  CM-MEMB-STATE             PIC XX.
  1796             20  CM-MEMB-ACCOUNT           PIC X(6).
  1797             20  CM-MEMB-LN4.
  1798                 25  CM-INSURED-INITIALS-A5.
  1799                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1800                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1801                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1802
  1803     12  CM-INSURED-PROFILE-DATA.
  1804         16  CM-INSURED-FIRST-NAME.
  1805             20  CM-INSURED-1ST-INIT       PIC X.
  1806             20  FILLER                    PIC X(9).
  1807         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1808         16  CM-INSURED-SEX                PIC X.
  1809             88  CM-SEX-MALE                  VALUE 'M'.
  1810             88  CM-SEX-FEMAL                 VALUE 'F'.
  1811         16  CM-INSURED-JOINT-AGE          PIC 99.
  1812         16  CM-JOINT-INSURED-NAME.
  1813             20  CM-JT-LAST-NAME           PIC X(15).
  1814             20  CM-JT-FIRST-NAME.
  1815                 24  CM-JT-1ST-INIT        PIC X.
  1816                 24  FILLER                PIC X(9).
  1817             20  CM-JT-INITIAL             PIC X.
  1818
  1819     12  CM-LIFE-DATA.
  1820         16  CM-LF-BENEFIT-CD              PIC XX.
  1821         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1822         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1823         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1824         16  CM-LF-DEV-CODE                PIC XXX.
  1825         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1826         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1827         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1828         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1829         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1830         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1831         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1832         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1833         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1834         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1835         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1836         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1837         16  cm-temp-epiq                  pic xx.
  1838             88  EPIQ-CLASS                  value 'EQ'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  40
* EL1279.cbl
  1839*        16  FILLER                        PIC XX.
  1840
  1841     12  CM-AH-DATA.
  1842         16  CM-AH-BENEFIT-CD              PIC XX.
  1843         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1844         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1845         16  CM-AH-DEV-CODE                PIC XXX.
  1846         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1847         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1848         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1849         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1850         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1851         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1852         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1853         16  CM-AH-PAID-THRU-DT            PIC XX.
  1854             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1855         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1856         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1857         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1858         16  FILLER                        PIC X.
  1859
  1860     12  CM-LOAN-INFORMATION.
  1861         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1862         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1863                                           PIC S9(5)V99  COMP-3.
  1864         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1865         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1866         16  CM-PAY-FREQUENCY              PIC S99.
  1867         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1868         16  CM-RATE-CLASS                 PIC XX.
  1869         16  CM-BENEFICIARY                PIC X(25).
  1870         16  CM-POLICY-FORM-NO             PIC X(12).
  1871         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1872         16  CM-LAST-ADD-ON-DT             PIC XX.
  1873         16  CM-DEDUCTIBLE-AMOUNTS.
  1874             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1875             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1876         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1877             20  CM-RESIDENT-STATE         PIC XX.
  1878             20  CM-RATE-CODE              PIC X(4).
  1879             20  FILLER                    PIC XX.
  1880         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1881             20  CM-LOAN-OFFICER           PIC X(5).
  1882             20  FILLER                    PIC XXX.
  1883         16  CM-CSR-CODE                   PIC XXX.
  1884         16  CM-UNDERWRITING-CODE          PIC X.
  1885             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1886         16  CM-POST-CARD-IND              PIC X.
  1887         16  CM-REF-INTERFACE-SW           PIC X.
  1888         16  CM-PREMIUM-TYPE               PIC X.
  1889             88  CM-SING-PRM                  VALUE '1'.
  1890             88  CM-O-B-COVERAGE              VALUE '2'.
  1891             88  CM-OPEN-END                  VALUE '3'.
  1892         16  CM-IND-GRP-TYPE               PIC X.
  1893             88  CM-INDIVIDUAL                VALUE 'I'.
  1894             88  CM-GROUP                     VALUE 'G'.
  1895         16  CM-SKIP-CODE                  PIC X.
  1896             88  NO-MONTHS-SKIPPED            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  41
* EL1279.cbl
  1897             88  SKIP-JULY                    VALUE '1'.
  1898             88  SKIP-AUGUST                  VALUE '2'.
  1899             88  SKIP-SEPTEMBER               VALUE '3'.
  1900             88  SKIP-JULY-AUG                VALUE '4'.
  1901             88  SKIP-AUG-SEPT                VALUE '5'.
  1902             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1903             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1904             88  SKIP-JUNE                    VALUE '8'.
  1905             88  SKIP-JUNE-JULY               VALUE '9'.
  1906             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1907             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1908         16  CM-PAYMENT-MODE               PIC X.
  1909             88  PAY-MONTHLY                  VALUE SPACE.
  1910             88  PAY-WEEKLY                   VALUE '1'.
  1911             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1912             88  PAY-BI-WEEKLY                VALUE '3'.
  1913             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1914         16  CM-LOAN-NUMBER                PIC X(8).
  1915         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1916         16  CM-OLD-LOF                    PIC XXX.
  1917*        16  CM-LOAN-OFFICER               PIC XXX.
  1918         16  CM-REIN-TABLE                 PIC XXX.
  1919         16  CM-SPECIAL-REIN-CODE          PIC X.
  1920         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1921         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1922         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1923
  1924     12  CM-STATUS-DATA.
  1925         16  CM-ENTRY-STATUS               PIC X.
  1926         16  CM-ENTRY-DT                   PIC XX.
  1927
  1928         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1929         16  CM-LF-CANCEL-DT               PIC XX.
  1930         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1931
  1932         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1933         16  CM-LF-DEATH-DT                PIC XX.
  1934         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1935
  1936         16  CM-LF-CURRENT-STATUS          PIC X.
  1937             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1938                                                'M' '4' '5' '9'.
  1939             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1940             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1941             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1942             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1943             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1944             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1945             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1946             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1947             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1948             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1949             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1950             88  CM-LF-DECLINED               VALUE 'D'.
  1951             88  CM-LF-VOIDED                 VALUE 'V'.
  1952
  1953         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1954         16  CM-AH-CANCEL-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  42
* EL1279.cbl
  1955         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1956
  1957         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1958         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1959         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1960
  1961         16  CM-AH-CURRENT-STATUS          PIC X.
  1962             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1963                                                'M' '4' '5' '9'.
  1964             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1965             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1966             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1967             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1968             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1969             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1970             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1971             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1972             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1973             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1974             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1975             88  CM-AH-DECLINED               VALUE 'D'.
  1976             88  CM-AH-VOIDED                 VALUE 'V'.
  1977
  1978         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1979             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1980             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1981             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1982         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1983
  1984         16  CM-ENTRY-BATCH                PIC X(6).
  1985         16  CM-LF-EXIT-BATCH              PIC X(6).
  1986         16  CM-AH-EXIT-BATCH              PIC X(6).
  1987         16  CM-LAST-MONTH-END             PIC XX.
  1988
  1989     12  CM-NOTE-SW                        PIC X.
  1990         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1991         88  CERT-NOTES-PRESENT               VALUE '1'.
  1992         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1993         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1994         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1995         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1996         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1997         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1998     12  CM-COMP-EXCP-SW                   PIC X.
  1999         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2000         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2001     12  CM-INSURED-ADDRESS-SW             PIC X.
  2002         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2003         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2004
  2005*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2006     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2007     12  FILLER                            PIC X.
  2008
  2009*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2010     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2011     12  FILLER                            PIC X.
  2012*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  43
* EL1279.cbl
  2013     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2014
  2015     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2016         88  CERT-ADDED-BATCH                 VALUE ' '.
  2017         88  CERT-ADDED-ONLINE                VALUE '1'.
  2018         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2019         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2020         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2021     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2022         88  CERT-AS-LOADED                   VALUE ' '.
  2023         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2024         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2025         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2026         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2027         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2028         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2029         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2030
  2031     12  CM-ACCOUNT-COMM-PCTS.
  2032         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2033         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2034
  2035     12  CM-USER-FIELD                     PIC X.
  2036     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2037     12  CM-CLP-STATE                      PIC XX.
  2038     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2039     12  CM-USER-RESERVED                  PIC XXX.
  2040     12  FILLER REDEFINES CM-USER-RESERVED.
  2041         16  CM-AH-CLASS-CD                PIC XX.
  2042         16  F                             PIC X.
  2043******************************************************************
  2044
  2045 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CERT-NOTE-FILE
  2046                          CERTIFICATE-MASTER.
  2047 0000-DFHEXIT SECTION.
  2048     MOVE '9#                    $   ' TO DFHEIV0.
  2049     MOVE 'EL1279' TO DFHEIV1.
  2050     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2051     MOVE EIBTRMID               TO QID-TERM.
  2052     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2053     MOVE '5'                    TO DC-OPTION-CODE.
  2054     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2055     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  2056     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  2057
  2058     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK
  2059     IF EIBCALEN = ZEROS
  2060         GO TO 8800-UNAUTHORIZED-ACCESS
  2061     END-IF.
  2062
  2063     IF PI-CALLING-PROGRAM = pgm-el6311 or pgm-el690 or pgm-el691
  2064        move pi-program-work-area(1:1)
  2065                                 to pi-iss-can-trans
  2066     end-if
  2067     IF PI-CALLING-PROGRAM NOT = THIS-PGM AND PGM-EL1276
  2068         PERFORM 4900-SET-NOTES-FLAG THRU 4900-EXIT
  2069         IF CLAIM-SESSION
  2070             SET PI-CLAIM-NOTE TO TRUE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  44
* EL1279.cbl
  2071         ELSE
  2072             SET PI-CERT-NOTE TO TRUE
  2073         END-IF
  2074     END-IF.
  2075
  2076     IF PI-CALLING-PROGRAM = PGM-EL1276
  2077         MOVE THIS-PGM           TO PI-CALLING-PROGRAM
  2078         MOVE 'N'                TO PI-PF5-PRESSED
  2079         MOVE 'N'                TO PI-PF6-PRESSED
  2080     END-IF.
  2081
  2082     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2083        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2084           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2085           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2086           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2087           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2088           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2089           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2090           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2091           MOVE THIS-PGM TO PI-CALLING-PROGRAM
  2092        ELSE
  2093           MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2094           MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2095           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2096           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2097           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2098           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2099           MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2100           MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2101        END-IF
  2102     END-IF.
  2103
  2104 1000-START.
  2105
  2106     MOVE LOW-VALUES TO EL1279AI.
  2107     MOVE SPACES                 TO  ERCNOT-KEY
  2108                                     ELCERT-KEY.
  2109
  2110     MOVE PI-COMPANY-CD          TO  ERCNOT-COMPANY-CD
  2111                                     ELCERT-COMPANY-CD.
  2112     MOVE PI-CARRIER             TO  ERCNOT-CARRIER
  2113                                     ELCERT-CARRIER.
  2114     MOVE PI-GROUPING            TO  ERCNOT-GROUPING
  2115                                     ELCERT-GROUPING.
  2116     MOVE PI-STATE               TO  ERCNOT-STATE
  2117                                     ELCERT-STATE.
  2118     MOVE PI-ACCOUNT             TO  ERCNOT-ACCOUNT
  2119                                     ELCERT-ACCOUNT.
  2120     MOVE PI-CERT-EFF-DT         TO  ERCNOT-EFF-DT
  2121                                     ELCERT-EFF-DT.
  2122     MOVE PI-CERT-PRIME          TO  ERCNOT-CERT-PRIME
  2123                                     ELCERT-CERT-PRIME.
  2124     MOVE PI-CERT-SFX            TO  ERCNOT-CERT-SFX
  2125                                     ELCERT-CERT-SFX.
  2126     MOVE PI-CURR-NOTE-REC-TYPE  TO  ERCNOT-REC-TYP
  2127     MOVE ZEROS                  TO  ERCNOT-SEQ.
  2128     MOVE ERCNOT-PARTIAL-KEY     TO  SV-PRIOR-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  45
* EL1279.cbl
  2129
  2130     IF EIBTRNID NOT = TRANS-ID
  2131        MOVE '0'                 TO  PI-UPDATE-SW
  2132        IF PI-PROCESSOR-ID NOT = 'LGXX'
  2133
  2134* EXEC CICS READQ TS
  2135*                    QUEUE (PI-SECURITY-TEMP-STORE-ID)
  2136*                    INTO (SECURITY-CONTROL)
  2137*                    LENGTH (SC-COMM-LENGTH)
  2138*                    ITEM  (SC-ITEM)
  2139*           END-EXEC
  2140*    MOVE '*$II   L              ''   #00002129' TO DFHEIV0
  2141     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2142     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2143     MOVE X'2020233030303032313239' TO DFHEIV0(25:11)
  2144     CALL 'kxdfhei1' USING DFHEIV0,
  2145           PI-SECURITY-TEMP-STORE-ID,
  2146           SECURITY-CONTROL,
  2147           SC-COMM-LENGTH,
  2148           SC-ITEM,
  2149           DFHEIV99,
  2150           DFHEIV99
  2151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2152          MOVE SC-CREDIT-DISPLAY (32) TO PI-DISPLAY-CAP
  2153          MOVE SC-CREDIT-UPDATE (32)  TO PI-MODIFY-CAP
  2154        END-IF
  2155     END-IF.
  2156
  2157     IF NOT DISPLAY-CAP
  2158         MOVE 'READ'             TO  SM-READ
  2159         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2160         MOVE ER-0070            TO  EMI-ERROR
  2161         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2162         GO TO 8100-SEND-INITIAL-MAP
  2163     END-IF.
  2164
  2165
  2166* EXEC CICS HANDLE AID
  2167*         CLEAR(9400-CLEAR)
  2168*    END-EXEC.
  2169*    MOVE '"&=                  V! " #00002148' TO DFHEIV0
  2170     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  2171     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2172     MOVE X'2220233030303032313438' TO DFHEIV0(25:11)
  2173     CALL 'kxdfhei1' USING DFHEIV0
  2174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2175
  2176
  2177
  2178* EXEC CICS HANDLE CONDITION
  2179*         ERROR(9990-ABEND)
  2180*         PGMIDERR(9600-PGMID-ERROR)
  2181*    END-EXEC.
  2182*    MOVE '"$.L                  ! # #00002152' TO DFHEIV0
  2183     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  2184     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2185     MOVE X'2320233030303032313532' TO DFHEIV0(25:11)
  2186     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  46
* EL1279.cbl
  2187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2188
  2189
  2190     IF EIBTRNID NOT = TRANS-ID
  2191         GO TO 7000-BUILD-TABLE
  2192     END-IF.
  2193
  2194     IF PI-CHANGE-IN-NOTE-TYPE
  2195         GO TO 7000-BUILD-TABLE
  2196     END-IF.
  2197
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  47
* EL1279.cbl
  2199 2000-RECEIVE.
  2200     IF EIBAID = DFHPA1 OR
  2201        EIBAID = DFHPA2 OR
  2202        EIBAID = DFHPA3
  2203           MOVE ER-0008 TO EMI-ERROR
  2204           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2205           GO TO 8200-SEND-DATAONLY
  2206     END-IF.
  2207
  2208
  2209* EXEC CICS RECEIVE
  2210*         MAP(MAP-NAME)
  2211*         MAPSET(MAPSET-NAME)
  2212*         INTO(EL1279AI)
  2213*    END-EXEC.
  2214     MOVE LENGTH OF
  2215      EL1279AI
  2216       TO DFHEIV11
  2217*    MOVE '8"T I  L              ''   #00002175' TO DFHEIV0
  2218     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2219     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2220     MOVE X'2020233030303032313735' TO DFHEIV0(25:11)
  2221     CALL 'kxdfhei1' USING DFHEIV0,
  2222           MAP-NAME,
  2223           EL1279AI,
  2224           DFHEIV11,
  2225           MAPSET-NAME,
  2226           DFHEIV99,
  2227           DFHEIV99
  2228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2229
  2230
  2231     IF PFENTERL = ZEROS
  2232        GO TO 2001-CHECK-PFKEYS
  2233     END-IF.
  2234
  2235     IF EIBAID NOT = DFHENTER
  2236        MOVE ER-0004             TO EMI-ERROR
  2237        GO TO 2002-INPUT-ERROR
  2238     END-IF.
  2239
  2240     IF PFENTERI NUMERIC AND
  2241        (PFENTERI > 00 AND  < 25)
  2242        MOVE PF-VALUES (PFENTERI) TO EIBAID
  2243     ELSE
  2244        MOVE ER-0029 TO EMI-ERROR
  2245        GO TO 2002-INPUT-ERROR
  2246     END-IF.
  2247
  2248 2001-CHECK-PFKEYS.
  2249     IF EIBAID = DFHPF23
  2250        GO TO 9000-RETURN-CICS
  2251     END-IF.
  2252
  2253     IF EIBAID = DFHPF24
  2254        GO TO 9200-RETURN-MAIN-MENU
  2255     END-IF.
  2256
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  48
* EL1279.cbl
  2257     IF EIBAID = DFHPF12
  2258        GO TO 9500-PF12
  2259     END-IF.
  2260
  2261     IF EIBAID = DFHPF5
  2262        IF PI-CHANGES-MADE
  2263            SET PF5-PRESSED          TO TRUE
  2264            MOVE -1                  TO FUNCTL
  2265            MOVE SPACES              TO PFENTERO
  2266            MOVE AL-UNNOF            TO PFENTERA
  2267            MOVE ER-0045             TO EMI-ERROR
  2268            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2269            GO TO 8200-SEND-DATAONLY
  2270         ELSE
  2271            MOVE PGM-EL1276         TO PGM-NAME
  2272            GO TO 9300-XCTL
  2273         END-IF
  2274     END-IF.
  2275
  2276     IF EIBAID = DFHPF6
  2277        IF PI-CHANGES-MADE
  2278            SET PF6-PRESSED          TO TRUE
  2279            MOVE -1                  TO FUNCTL
  2280            MOVE SPACES              TO PFENTERO
  2281            MOVE AL-UNNOF            TO PFENTERA
  2282            MOVE ER-0045             TO EMI-ERROR
  2283            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2284            GO TO 8200-SEND-DATAONLY
  2285         ELSE
  2286            IF PI-CLAIM-NOTE
  2287                SET PI-CERT-NOTE    TO TRUE
  2288            ELSE
  2289                SET PI-CLAIM-NOTE   TO TRUE
  2290            END-IF
  2291            SET PI-CHANGE-IN-NOTE-TYPE TO TRUE
  2292            GO TO 1000-START
  2293         END-IF
  2294     END-IF.
  2295
  2296     IF EIBAID = DFHPF7
  2297         MOVE PGM-EL1284          TO PGM-NAME
  2298         GO TO 9300-XCTL.
  2299
  2300     IF FUNCTL NOT = ZEROS AND EIBAID NOT = DFHENTER
  2301        IF FUNCTI = 'A' OR = SPACES
  2302           NEXT SENTENCE
  2303        ELSE
  2304           MOVE ER-0050          TO EMI-ERROR
  2305           MOVE -1 TO FUNCTL
  2306           MOVE AL-UABON TO FUNCTA PFENTERA
  2307           GO TO 2002-INPUT-ERROR
  2308        END-IF
  2309     END-IF.
  2310
  2311     IF EIBAID = DFHPF1
  2312        MOVE NUM-LINES-PER-SCREEN TO ROLL-COUNTER
  2313        GO TO 7400-PAGE-ROUTINE
  2314     END-IF.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  49
* EL1279.cbl
  2315
  2316     IF EIBAID = DFHPF2
  2317        SUBTRACT NUM-LINES-PER-SCREEN FROM ROLL-COUNTER
  2318        GO TO 7400-PAGE-ROUTINE
  2319     END-IF.
  2320
  2321     IF EIBAID = DFHPF3
  2322        MOVE 5                   TO ROLL-COUNTER
  2323        GO TO 7400-PAGE-ROUTINE
  2324     END-IF.
  2325
  2326     IF EIBAID = DFHPF4
  2327        MOVE -5                  TO ROLL-COUNTER
  2328        GO TO 7400-PAGE-ROUTINE
  2329     END-IF.
  2330
  2331     IF EIBAID = DFHENTER
  2332        GO TO 2003-EDIT-DATA
  2333     END-IF.
  2334
  2335     MOVE ER-0029                TO EMI-ERROR.
  2336
  2337 2002-INPUT-ERROR.
  2338     MOVE -1                     TO PFENTERL
  2339     MOVE AL-UNBON               TO PFENTERA
  2340     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2341     GO TO 8200-SEND-DATAONLY.
  2342
  2343 2003-EDIT-DATA.
  2344
  2345     IF FUNCTI = 'L'
  2346         NEXT SENTENCE
  2347     ELSE
  2348         IF NOT MODIFY-CAP
  2349             MOVE 'UPDATE'       TO  SM-READ
  2350             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2351             MOVE ER-0070        TO  EMI-ERROR
  2352             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2353             GO TO 8100-SEND-INITIAL-MAP
  2354         END-IF
  2355     END-IF.
  2356
  2357     IF FUNCTL = ZEROS OR FUNCTI = SPACES
  2358        GO TO 4000-CHANGE-ROUTINE
  2359     END-IF.
  2360
  2361     IF (FUNCTI = 'S' OR = 'D' OR = 'Q' OR
  2362                = 'I' OR = 'A' OR = 'L')
  2363         NEXT SENTENCE
  2364     ELSE
  2365         MOVE ER-0023            TO EMI-ERROR
  2366         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2367         MOVE AL-UABON           TO FUNCTA
  2368         MOVE -1                 TO FUNCTL
  2369         GO TO 8200-SEND-DATAONLY
  2370     END-IF.
  2371
  2372     IF FUNCTI = 'D'  OR = 'I' OR = 'L'
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  50
* EL1279.cbl
  2373        PERFORM 2500-LINE-CHECK THRU 2599-EXIT
  2374     ELSE
  2375        IF LINE1L NOT = ZEROS OR
  2376           LINE2L NOT = ZEROS
  2377           MOVE ER-0030          TO EMI-ERROR
  2378           MOVE -1               TO LINE1L
  2379           MOVE AL-UNBON         TO LINE1A LINE2A
  2380           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2381           GO TO 8200-SEND-DATAONLY
  2382        END-IF
  2383     END-IF.
  2384
  2385     IF FUNCTI = 'A'
  2386        GO TO 5000-ADD-NEW-LINES
  2387     END-IF.
  2388     IF FUNCTI = 'Q'
  2389        GO TO 9410-RETURN
  2390     END-IF.
  2391     IF FUNCTI = 'S'
  2392        GO TO 4500-SAVE-DATA
  2393     END-IF.
  2394     IF PI-TOTAL-LINES = 0
  2395        MOVE ER-0048             TO EMI-ERROR
  2396        MOVE -1                  TO FUNCTL
  2397        MOVE AL-UNBON            TO FUNCTA
  2398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2399        GO TO 8200-SEND-DATAONLY
  2400     END-IF.
  2401     IF FUNCTI = 'L'
  2402        GO TO 5500-LOOKUP
  2403     END-IF.
  2404     IF FUNCTI = 'D'
  2405        GO TO 3000-DELETE-LINES
  2406     END-IF.
  2407
  2408     GO TO 3500-INSERT-LINES.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  51
* EL1279.cbl
  2410 2500-LINE-CHECK.
  2411     IF LINE1L = ZEROS AND
  2412        LINE2L = ZEROS
  2413        MOVE ER-0069             TO EMI-ERROR
  2414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2415        MOVE -1                  TO LINE1L
  2416        GO TO 8200-SEND-DATAONLY
  2417     END-IF.
  2418
  2419     IF LINE1L NOT = ZEROS
  2420        IF LINE1I = ZERO AND FUNCTI EQUAL 'L'
  2421            MOVE 1               TO LINE1I
  2422        END-IF
  2423        IF LINE1I = ZERO AND FUNCTI EQUAL 'D'
  2424           MOVE ER-0049          TO EMI-ERROR
  2425           MOVE AL-UNBON         TO LINE1A
  2426           MOVE -1               TO LINE1L
  2427           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2428           GO TO 8200-SEND-DATAONLY
  2429        END-IF
  2430        IF LINE1I NOT NUMERIC OR
  2431           LINE1I > PI-TOTAL-LINES
  2432           MOVE ER-0031          TO EMI-ERROR
  2433           MOVE AL-UNBON         TO LINE1A
  2434           MOVE -1               TO LINE1L
  2435           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2436           GO TO 8200-SEND-DATAONLY
  2437        ELSE
  2438           IF LINE2L = ZEROS
  2439              MOVE 1             TO LINE2I
  2440              IF FUNCTI = 'I'
  2441                  GO TO 2510-MAX-CHECK
  2442              ELSE
  2443                  NEXT SENTENCE
  2444              END-IF
  2445           ELSE
  2446              IF FUNCTI = 'I'
  2447                 GO TO 2510-MAX-CHECK
  2448              ELSE
  2449                 IF LINE2I NOT NUMERIC
  2450                    MOVE AL-UNBON TO LINE2A
  2451                    MOVE ER-0032  TO EMI-ERROR
  2452                    MOVE -1       TO LINE2L
  2453                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2454                    GO TO 8200-SEND-DATAONLY
  2455                 ELSE
  2456                    NEXT SENTENCE
  2457                 END-IF
  2458              END-IF
  2459           END-IF
  2460        END-IF
  2461     ELSE
  2462        IF LINE2L = ZEROS
  2463           NEXT SENTENCE
  2464        ELSE
  2465           MOVE -1               TO LINE2L
  2466           MOVE ER-0041          TO EMI-ERROR
  2467           MOVE AL-UNBON         TO LINE2A
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  52
* EL1279.cbl
  2468           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2469           GO TO 8200-SEND-DATAONLY
  2470        END-IF
  2471     END-IF.
  2472     GO TO 2599-EXIT.
  2473 2510-MAX-CHECK.
  2474     IF LINE2I NOT NUMERIC
  2475        MOVE -1                  TO LINE2L
  2476        MOVE ER-0032             TO EMI-ERROR
  2477        MOVE AL-UNBON            TO LINE2A
  2478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2479        GO TO 8200-SEND-DATAONLY
  2480     ELSE
  2481        COMPUTE ROLL-COUNTER = LINE2I + PI-TOTAL-LINES
  2482        IF ROLL-COUNTER GREATER THAN MAX-LINES
  2483           MOVE -1               TO LINE2L
  2484           MOVE ER-0044          TO EMI-ERROR
  2485           MOVE AL-UNBON         TO LINE2A
  2486           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2487           GO TO 8200-SEND-DATAONLY
  2488        END-IF
  2489     END-IF.
  2490 2599-EXIT.
  2491      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  53
* EL1279.cbl
  2493 3000-DELETE-LINES.
  2494     IF LINE2L = ZEROS AND LINE2I = 1
  2495        MOVE LINE1I              TO LINE2I
  2496     END-IF.
  2497
  2498     IF LINE2I > PI-TOTAL-LINES OR < LINE1I
  2499        MOVE ER-0049             TO EMI-ERROR
  2500        MOVE AL-UNBON            TO LINE2A
  2501        MOVE -1                  TO LINE2L
  2502        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2503        GO TO 8200-SEND-DATAONLY
  2504     END-IF.
  2505
  2506     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2507     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2508             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2509             SC-INDX > NUM-LINES-PER-SCREEN
  2510     SET TB-INDX TO LINE1I.
  2511
  2512     IF NOT EMI-NO-ERRORS
  2513        GO TO 8200-SEND-DATAONLY
  2514     END-IF.
  2515
  2516     SET TB-INDX TO LINE1I
  2517     COMPUTE ROLL-COUNTER = LINE2I - LINE1I + 1.
  2518
  2519     IF LINE2I NOT = PI-TOTAL-LINES
  2520        SET TB-INDX1 TO LINE2I
  2521        SET TB-INDX1 UP BY 1
  2522        PERFORM 3100-DELETE-TABLE-ENTRIES
  2523                UNTIL TB-INDX1 > PI-TOTAL-LINES
  2524     END-IF.
  2525
  2526     PERFORM 3150-BLANK-TABLE-ENTRIES
  2527             ROLL-COUNTER TIMES.
  2528     SUBTRACT ROLL-COUNTER FROM PI-TOTAL-LINES.
  2529
  2530     IF PI-CURRENT-LINE > PI-TOTAL-LINES
  2531        MOVE PI-TOTAL-LINES      TO PI-CURRENT-LINE
  2532        SUBTRACT 1 FROM PI-CURRENT-LINE
  2533     END-IF.
  2534
  2535     SET TB-INDX  TO PI-CURRENT-LINE
  2536     MOVE LOW-VALUES             TO EL1279AI
  2537
  2538     IF PI-CURRENT-LINE > ZERO
  2539         PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2540             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2541             SC-INDX > NUM-LINES-PER-SCREEN
  2542         PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT
  2543     END-IF.
  2544
  2545     MOVE '1'                    TO PI-UPDATE-SW.
  2546     IF PI-TOTAL-LINES = ZEROS
  2547        MOVE ZEROS               TO PI-CURRENT-LINE
  2548     END-IF.
  2549     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  54
* EL1279.cbl
  2551
  2552 3100-DELETE-TABLE-ENTRIES.
  2553     MOVE REC-ENT (TB-INDX1)     TO REC-ENT (TB-INDX)
  2554     SET TB-INDX TB-INDX1 UP BY 1.
  2555
  2556 3150-BLANK-TABLE-ENTRIES.
  2557     MOVE SPACES               TO REC-ENT (TB-INDX).
  2558     MOVE SAVE-BIN-DATE        TO REC-LAST-MAINT-DT (TB-INDX).
  2559     MOVE EIBTIME              TO REC-LAST-MAINT-HHMMSS (TB-INDX).
  2560     MOVE PI-PROCESSOR-ID      TO REC-LAST-MAINT-BY (TB-INDX).
  2561     SET TB-INDX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  55
* EL1279.cbl
  2563 3500-INSERT-LINES.
  2564
  2565     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2566     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2567             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2568             SC-INDX > NUM-LINES-PER-SCREEN.
  2569
  2570     IF NOT EMI-NO-ERRORS
  2571        GO TO 8200-SEND-DATAONLY
  2572     END-IF.
  2573
  2574     SET TB-INDX TO PI-TOTAL-LINES.
  2575     ADD LINE2I TO PI-TOTAL-LINES.
  2576     SET TB-INDX1 TO PI-TOTAL-LINES.
  2577     PERFORM 3600-INSERT-TABLE-ENTRIES
  2578             UNTIL TB-INDX = LINE1I.
  2579     SET TB-INDX UP BY 1.
  2580
  2581     IF LINE1I EQUAL ZERO
  2582         SET PI-CURRENT-LINE TO 1
  2583     ELSE
  2584         SET PI-CURRENT-LINE TO LINE1I
  2585     END-IF.
  2586
  2587     COMPUTE ROLL-COUNTER = PI-CURRENT-LINE +
  2588                            NUM-LINES-PER-SCREEN.
  2589     IF TB-INDX NOT LESS THAN ROLL-COUNTER OR
  2590                    LESS THAN PI-CURRENT-LINE
  2591        SET SC-INDX TO 1
  2592        SET SC-INDX DOWN BY 1
  2593     ELSE
  2594        SET ROLL-COUNTER TO TB-INDX
  2595        COMPUTE ROLL-COUNTER = ROLL-COUNTER - PI-CURRENT-LINE
  2596                  + 1
  2597        SET SC-INDX TO ROLL-COUNTER
  2598     END-IF.
  2599
  2600     PERFORM 3150-BLANK-TABLE-ENTRIES LINE2I TIMES.
  2601     SET TB-INDX TO PI-CURRENT-LINE.
  2602     MOVE LOW-VALUES             TO EL1279AI.
  2603
  2604     IF SC-INDX NOT = ZERO
  2605        MOVE -1 TO SC-TEXTL (SC-INDX)
  2606     END-IF.
  2607
  2608     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2609            VARYING SC-INDX FROM 1 BY 1 UNTIL
  2610            SC-INDX > NUM-LINES-PER-SCREEN.
  2611     PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT.
  2612     MOVE '1'                    TO PI-UPDATE-SW.
  2613     GO TO 8100-SEND-INITIAL-MAP.
  2614
  2615 3600-INSERT-TABLE-ENTRIES.
  2616     MOVE REC-ENT (TB-INDX)      TO REC-ENT (TB-INDX1).
  2617     SET TB-INDX TB-INDX1 DOWN BY 1.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  56
* EL1279.cbl
  2619
  2620 4000-CHANGE-ROUTINE.
  2621     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2622     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2623             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2624             SC-INDX > NUM-LINES-PER-SCREEN.
  2625
  2626     IF NOT EMI-NO-ERRORS
  2627        GO TO 8200-SEND-DATAONLY
  2628     END-IF.
  2629
  2630     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  2631     MOVE SPACES                 TO ERRMSGBO.
  2632     GO TO 8200-SEND-DATAONLY.
  2633
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  57
* EL1279.cbl
  2635 4500-SAVE-DATA.
  2636     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2637     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2638             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2639             SC-INDX > NUM-LINES-PER-SCREEN.
  2640     IF NOT EMI-NO-ERRORS
  2641        GO TO 8200-SEND-DATAONLY
  2642     END-IF.
  2643
  2644
  2645* EXEC CICS HANDLE CONDITION
  2646*         NOTFND(4610-ENDBR)
  2647*         NOTOPEN(6000-NOT-OPEN)
  2648*         ENDFILE(4610-ENDBR)
  2649*    END-EXEC.
  2650*    MOVE '"$IJ''                 ! $ #00002594' TO DFHEIV0
  2651     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  2652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2653     MOVE X'2420233030303032353934' TO DFHEIV0(25:11)
  2654     CALL 'kxdfhei1' USING DFHEIV0
  2655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2656
  2657
  2658 4610-LOOP.
  2659
  2660* EXEC CICS READ
  2661*        DATASET (ERCNOT-FILE-ID)
  2662*        RIDFLD  (ERCNOT-KEY)
  2663*        SET     (ADDRESS OF CERT-NOTE-FILE)
  2664*        GTEQ
  2665*    END-EXEC.
  2666*    MOVE '&"S        G          (   #00002601' TO DFHEIV0
  2667     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2669     MOVE X'2020233030303032363031' TO DFHEIV0(25:11)
  2670     CALL 'kxdfhei1' USING DFHEIV0,
  2671           ERCNOT-FILE-ID,
  2672           DFHEIV20,
  2673           DFHEIV99,
  2674           ERCNOT-KEY,
  2675           DFHEIV99,
  2676           DFHEIV99,
  2677           DFHEIV99
  2678     SET ADDRESS OF CERT-NOTE-FILE TO
  2679         DFHEIV20
  2680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2681
  2682
  2683     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  2684
  2685     IF ERCNOT-PARTIAL-KEY NOT = SV-PRIOR-KEY
  2686         MOVE SV-PRIOR-KEY       TO ERCNOT-PARTIAL-KEY
  2687         GO TO 4610-ENDBR
  2688     END-IF.
  2689
  2690
  2691* EXEC CICS DELETE
  2692*        DATASET (ERCNOT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  58
* EL1279.cbl
  2693*        RIDFLD  (ERCNOT-KEY)
  2694*    END-EXEC.
  2695*    MOVE '&(  R                 &   #00002615' TO DFHEIV0
  2696     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  2697     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2698     MOVE X'2020233030303032363135' TO DFHEIV0(25:11)
  2699     CALL 'kxdfhei1' USING DFHEIV0,
  2700           ERCNOT-FILE-ID,
  2701           ERCNOT-KEY,
  2702           DFHEIV99,
  2703           DFHEIV99,
  2704           DFHEIV99
  2705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2706
  2707
  2708     GO TO 4610-LOOP.
  2709 4610-ENDBR.
  2710
  2711* EXEC CICS GETMAIN
  2712*         LENGTH(ERCNOT-LENGTH)
  2713*         SET(ADDRESS OF CERT-NOTE-FILE)
  2714*         INITIMG(GETMAIN-SPACE)
  2715*    END-EXEC.
  2716*    MOVE ',"IL                  $   #00002622' TO DFHEIV0
  2717     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  2718     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2719     MOVE X'2020233030303032363232' TO DFHEIV0(25:11)
  2720     CALL 'kxdfhei1' USING DFHEIV0,
  2721           DFHEIV20,
  2722           ERCNOT-LENGTH,
  2723           GETMAIN-SPACE
  2724     SET ADDRESS OF CERT-NOTE-FILE TO
  2725         DFHEIV20
  2726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2727
  2728
  2729     MOVE ZERO                   TO  ERCNOT-SEQ.
  2730     MOVE ZERO                   TO  WS-BLANK-LINES.
  2731
  2732     PERFORM 4700-WRITE-FILE THRU 4799-EXIT
  2733             VARYING TB-INDX FROM 1 BY 1 UNTIL
  2734             TB-INDX > PI-TOTAL-LINES.
  2735
  2736     SUBTRACT WS-BLANK-LINES FROM PI-TOTAL-LINES.
  2737
  2738     PERFORM 4800-CERTIFICATE-UPDATE THRU 4899-EXIT.
  2739
  2740     GO TO 9410-RETURN.
  2741
  2742 4700-WRITE-FILE.
  2743     IF PI-CERT-NOTE AND REC-TEXT (TB-INDX)  EQUAL SPACES
  2744         ADD +1                  TO  WS-BLANK-LINES
  2745         GO TO 4799-EXIT
  2746     END-IF.
  2747
  2748     MOVE SPACES                 TO  CERT-NOTE-FILE.
  2749     ADD 1                       TO  ERCNOT-SEQ.
  2750     MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  59
* EL1279.cbl
  2751     MOVE  'CZ'                  TO  CZ-RECORD-ID.
  2752     MOVE REC-TEXT (TB-INDX)     TO  CZ-NOTE.
  2753     MOVE REC-LAST-MAINT-BY (TB-INDX)
  2754                                 TO  CZ-LAST-MAINT-USER.
  2755     MOVE REC-LAST-MAINT-HHMMSS (TB-INDX)
  2756                                 TO  CZ-LAST-MAINT-HHMMSS.
  2757     MOVE REC-LAST-MAINT-DT (TB-INDX)
  2758                                 TO  CZ-LAST-MAINT-DT.
  2759
  2760
  2761* EXEC CICS WRITE
  2762*         DATASET(ERCNOT-FILE-ID)
  2763*         FROM(CERT-NOTE-FILE)
  2764*         RIDFLD(ERCNOT-KEY)
  2765*    END-EXEC.
  2766     MOVE LENGTH OF
  2767      CERT-NOTE-FILE
  2768       TO DFHEIV11
  2769*    MOVE '&$ L                  ''   #00002659' TO DFHEIV0
  2770     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2772     MOVE X'2020233030303032363539' TO DFHEIV0(25:11)
  2773     CALL 'kxdfhei1' USING DFHEIV0,
  2774           ERCNOT-FILE-ID,
  2775           CERT-NOTE-FILE,
  2776           DFHEIV11,
  2777           ERCNOT-KEY,
  2778           DFHEIV99,
  2779           DFHEIV99
  2780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2781
  2782 4799-EXIT.
  2783      EXIT.
  2784
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  60
* EL1279.cbl
  2786 4800-CERTIFICATE-UPDATE.
  2787
  2788
  2789* EXEC CICS HANDLE CONDITION
  2790*        NOTFND   (4899-EXIT)
  2791*    END-EXEC.
  2792*    MOVE '"$I                   ! % #00002670' TO DFHEIV0
  2793     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2794     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2795     MOVE X'2520233030303032363730' TO DFHEIV0(25:11)
  2796     CALL 'kxdfhei1' USING DFHEIV0
  2797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2798
  2799
  2800
  2801* EXEC CICS READ
  2802*    EQUAL
  2803*    DATASET   (ELCERT-FILE-ID)
  2804*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  2805*    RIDFLD    (ELCERT-KEY)
  2806*    UPDATE
  2807*    END-EXEC.
  2808*    MOVE '&"S        EU         (   #00002674' TO DFHEIV0
  2809     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2810     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2811     MOVE X'2020233030303032363734' TO DFHEIV0(25:11)
  2812     CALL 'kxdfhei1' USING DFHEIV0,
  2813           ELCERT-FILE-ID,
  2814           DFHEIV20,
  2815           DFHEIV99,
  2816           ELCERT-KEY,
  2817           DFHEIV99,
  2818           DFHEIV99,
  2819           DFHEIV99
  2820     SET ADDRESS OF CERTIFICATE-MASTER TO
  2821         DFHEIV20
  2822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2823
  2824
  2825     IF PI-TOTAL-LINES > 0
  2826        IF PI-CERT-NOTE
  2827           MOVE 'Y'           TO PI-CERT-NOTES-EXIST
  2828           IF CM-NOTE-SW = ' '
  2829              MOVE '1'        TO CM-NOTE-SW
  2830           ELSE
  2831             IF CM-NOTE-SW = '2'
  2832                MOVE '3'      TO CM-NOTE-SW
  2833             ELSE
  2834               IF CM-NOTE-SW = '4'
  2835                  MOVE '5'    TO CM-NOTE-SW
  2836               ELSE
  2837                 IF CM-NOTE-SW = '6'
  2838                    MOVE '7'  TO CM-NOTE-SW
  2839                 END-IF
  2840               END-IF
  2841             END-IF
  2842           END-IF
  2843        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  61
* EL1279.cbl
  2844           MOVE 'Y'           TO PI-CLAIM-NOTES-EXIST
  2845           IF CM-NOTE-SW = ' '
  2846              MOVE '4'        TO CM-NOTE-SW
  2847           ELSE
  2848             IF CM-NOTE-SW = '1'
  2849                MOVE '5'      TO CM-NOTE-SW
  2850             ELSE
  2851               IF CM-NOTE-SW = '2'
  2852                  MOVE '6'    TO CM-NOTE-SW
  2853               ELSE
  2854                 IF CM-NOTE-SW = '3'
  2855                    MOVE '7'  TO CM-NOTE-SW
  2856                 END-IF
  2857               END-IF
  2858             END-IF
  2859           END-IF
  2860        END-IF
  2861     ELSE
  2862        IF PI-CERT-NOTE
  2863           MOVE 'N'           TO PI-CERT-NOTES-EXIST
  2864           IF CM-NOTE-SW = '1'
  2865              MOVE ' '        TO CM-NOTE-SW
  2866           ELSE
  2867             IF CM-NOTE-SW = '3'
  2868                MOVE '2'      TO CM-NOTE-SW
  2869             ELSE
  2870               IF CM-NOTE-SW = '5'
  2871                  MOVE '4'    TO CM-NOTE-SW
  2872               ELSE
  2873                 IF CM-NOTE-SW = '7'
  2874                    MOVE '6'  TO CM-NOTE-SW
  2875                 END-IF
  2876               END-IF
  2877             END-IF
  2878           END-IF
  2879        ELSE
  2880           MOVE 'N'           TO PI-CLAIM-NOTES-EXIST
  2881           IF CM-NOTE-SW = '4'
  2882              MOVE ' '        TO CM-NOTE-SW
  2883           ELSE
  2884             IF CM-NOTE-SW = '5'
  2885                MOVE '1'      TO CM-NOTE-SW
  2886             ELSE
  2887               IF CM-NOTE-SW = '6'
  2888                  MOVE '2'    TO CM-NOTE-SW
  2889               ELSE
  2890                 IF CM-NOTE-SW = '7'
  2891                    MOVE '3'  TO CM-NOTE-SW
  2892                 END-IF
  2893               END-IF
  2894             END-IF
  2895           END-IF
  2896        END-IF
  2897     END-IF.
  2898
  2899
  2900
  2901* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  62
* EL1279.cbl
  2902*        FROM      (CERTIFICATE-MASTER)
  2903*        DATASET   (ELCERT-FILE-ID)
  2904*    END-EXEC.
  2905     MOVE LENGTH OF
  2906      CERTIFICATE-MASTER
  2907       TO DFHEIV11
  2908*    MOVE '&& L                  %   #00002757' TO DFHEIV0
  2909     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2910     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2911     MOVE X'2020233030303032373537' TO DFHEIV0(25:11)
  2912     CALL 'kxdfhei1' USING DFHEIV0,
  2913           ELCERT-FILE-ID,
  2914           CERTIFICATE-MASTER,
  2915           DFHEIV11,
  2916           DFHEIV99
  2917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2918
  2919
  2920 4899-EXIT.
  2921      EXIT.
  2922
  2923 4900-SET-NOTES-FLAG.
  2924
  2925
  2926* EXEC CICS HANDLE CONDITION
  2927*        NOTFND   (4900-EXIT)
  2928*    END-EXEC.
  2929*    MOVE '"$I                   ! & #00002767' TO DFHEIV0
  2930     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2931     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2932     MOVE X'2620233030303032373637' TO DFHEIV0(25:11)
  2933     CALL 'kxdfhei1' USING DFHEIV0
  2934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2935
  2936
  2937     MOVE SPACES                 TO  ELCERT-KEY.
  2938     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  2939     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  2940     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  2941     MOVE PI-STATE               TO  ELCERT-STATE.
  2942     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  2943     MOVE PI-CERT-EFF-DT         TO  ELCERT-EFF-DT.
  2944     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  2945     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  2946
  2947
  2948* EXEC CICS READ
  2949*    EQUAL
  2950*    DATASET   (ELCERT-FILE-ID)
  2951*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  2952*    RIDFLD    (ELCERT-KEY)
  2953*    END-EXEC.
  2954*    MOVE '&"S        E          (   #00002781' TO DFHEIV0
  2955     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2956     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2957     MOVE X'2020233030303032373831' TO DFHEIV0(25:11)
  2958     CALL 'kxdfhei1' USING DFHEIV0,
  2959           ELCERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  63
* EL1279.cbl
  2960           DFHEIV20,
  2961           DFHEIV99,
  2962           ELCERT-KEY,
  2963           DFHEIV99,
  2964           DFHEIV99,
  2965           DFHEIV99
  2966     SET ADDRESS OF CERTIFICATE-MASTER TO
  2967         DFHEIV20
  2968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2969
  2970
  2971     MOVE 'N'                    TO PI-BILLING-NOTES-EXIST
  2972                                    PI-CERT-NOTES-EXIST
  2973                                    PI-CLAIM-NOTES-EXIST.
  2974     IF CM-NOTE-SW EQUAL '2' OR '3' OR '6' OR '7'
  2975          MOVE 'Y'               TO PI-BILLING-NOTES-EXIST
  2976     END-IF.
  2977     IF CM-NOTE-SW EQUAL '1' OR '3' OR '5' OR '7'
  2978          MOVE 'Y'               TO PI-CERT-NOTES-EXIST
  2979     END-IF.
  2980     IF CM-NOTE-SW EQUAL '4' OR '5' OR '6' OR '7'
  2981          MOVE 'Y'               TO PI-CLAIM-NOTES-EXIST
  2982     END-IF.
  2983
  2984
  2985 4900-EXIT.
  2986      EXIT.
  2987
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  64
* EL1279.cbl
  2989 5000-ADD-NEW-LINES.
  2990     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2991     MOVE 'N'                    TO WS-SCREEN-LINE.
  2992     MOVE 1                      TO WS-SUB.
  2993     MOVE ZERO                   TO WS-SUB1.
  2994     PERFORM VARYING SC-INDX FROM NUM-LINES-PER-SCREEN BY -1
  2995             UNTIL SCREEN-LINE-FOUND OR SC-INDX < 1
  2996         IF SC-TEXT (SC-INDX) >  SPACES
  2997             SET WS-SUB          TO SC-INDX
  2998             MOVE 'Y'            TO WS-SCREEN-LINE
  2999         END-IF
  3000     END-PERFORM.
  3001     IF PI-TOTAL-LINES = 0
  3002         MOVE 1                  TO WS-SUB1
  3003     ELSE
  3004         MOVE 2                  TO WS-SUB1
  3005     END-IF.
  3006     PERFORM VARYING SC-INDX FROM WS-SUB1 BY 1
  3007             UNTIL SC-INDX GREATER THAN WS-SUB
  3008         IF SC-TEXTL (SC-INDX) EQUAL ZEROS
  3009             MOVE 1      TO SC-TEXTL (SC-INDX)
  3010             MOVE SPACES TO SC-TEXT (SC-INDX)
  3011             MOVE LOW-VALUES TO SC-MTBY (SC-INDX)
  3012                                SC-MTDT (SC-INDX)
  3013         END-IF
  3014     END-PERFORM.
  3015     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3016             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3017             SC-INDX > NUM-LINES-PER-SCREEN.
  3018
  3019     IF NOT EMI-NO-ERRORS
  3020        GO TO 8200-SEND-DATAONLY
  3021     END-IF.
  3022
  3023     MOVE PI-TOTAL-LINES         TO  PI-CURRENT-LINE.
  3024     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3025     MOVE LOW-VALUES             TO  EL1279AI.
  3026     SET TB-INDX TO PI-CURRENT-LINE.
  3027     MOVE 'A'                    TO FUNCTI.
  3028     MOVE -1                     TO  SC-TEXTL (2).
  3029     MOVE AL-UANON               TO  FUNCTA.
  3030     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3031             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3032             SC-INDX > NUM-LINES-PER-SCREEN.
  3033     MOVE '1'                    TO PI-UPDATE-SW.
  3034     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  65
* EL1279.cbl
  3036 5500-LOOKUP.
  3037     PERFORM 7500-READ-TS THRU 7599-EXIT.
  3038     SET TB-INDX TO PI-CURRENT-LINE.
  3039     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3040             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3041             SC-INDX > NUM-LINES-PER-SCREEN.
  3042
  3043     IF NOT EMI-NO-ERRORS
  3044        GO TO 8200-SEND-DATAONLY
  3045     END-IF.
  3046
  3047     MOVE LINE1I                 TO  PI-CURRENT-LINE.
  3048     SET TB-INDX                 TO PI-CURRENT-LINE.
  3049     MOVE LOW-VALUES             TO  EL1279AI.
  3050     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3051             VARYING SC-INDX FROM 1 BY 1
  3052             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3053     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3054     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  66
* EL1279.cbl
  3056 6000-NOT-OPEN.
  3057     MOVE ER-2954                TO  EMI-ERROR.
  3058     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3059
  3060     IF EIBAID = DFHCLEAR
  3061         GO TO 9410-RETURN
  3062     ELSE
  3063         GO TO 8100-SEND-INITIAL-MAP
  3064     END-IF.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  67
* EL1279.cbl
  3066 7000-BUILD-TABLE.
  3067
  3068     SET TB-INDX TO 1.
  3069     MOVE ZEROS                  TO  PI-TOTAL-LINES
  3070                                     PI-CURRENT-LINE
  3071                                     PI-TEMP-STOR-ITEMS
  3072                                     PI-UPDATE-SW.
  3073     MOVE LOW-VALUES             TO  EL1279AI.
  3074
  3075****IF TEMP STORAGE EXISTS, DELETE IT.
  3076     IF PI-CHANGE-IN-NOTE-TYPE
  3077         MOVE 'N' TO PI-SET-NOTE-CHANGE
  3078     ELSE
  3079         PERFORM 7500-READ-TS THRU 7599-EXIT
  3080     END-IF.
  3081
  3082     IF PI-TEMP-STOR-ITEMS NOT = ZERO
  3083        PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  3084     END-IF.
  3085
  3086
  3087* EXEC CICS HANDLE CONDITION
  3088*         NOTFND(7010-ENDBR)
  3089*         NOTOPEN(6000-NOT-OPEN)
  3090*         ENDFILE(7010-ENDBR)
  3091*    END-EXEC.
  3092*    MOVE '"$IJ''                 ! '' #00002903' TO DFHEIV0
  3093     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3094     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3095     MOVE X'2720233030303032393033' TO DFHEIV0(25:11)
  3096     CALL 'kxdfhei1' USING DFHEIV0
  3097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3098
  3099
  3100
  3101* EXEC CICS STARTBR
  3102*         DATASET(ERCNOT-FILE-ID)
  3103*         RIDFLD(ERCNOT-KEY)
  3104*         KEYLENGTH(ERCNOT-START-LENGTH)
  3105*         GENERIC
  3106*         GTEQ
  3107*    END-EXEC.
  3108     MOVE 0
  3109       TO DFHEIV11
  3110*    MOVE '&,   KG    G          &   #00002909' TO DFHEIV0
  3111     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3112     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3113     MOVE X'2020233030303032393039' TO DFHEIV0(25:11)
  3114     CALL 'kxdfhei1' USING DFHEIV0,
  3115           ERCNOT-FILE-ID,
  3116           ERCNOT-KEY,
  3117           ERCNOT-START-LENGTH,
  3118           DFHEIV11,
  3119           DFHEIV99
  3120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3121
  3122
  3123 7001-LOOP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  68
* EL1279.cbl
  3124
  3125* EXEC CICS READNEXT
  3126*         SET(ADDRESS OF CERT-NOTE-FILE)
  3127*         DATASET(ERCNOT-FILE-ID)
  3128*         RIDFLD(ERCNOT-KEY)
  3129*    END-EXEC.
  3130     MOVE 0
  3131       TO DFHEIV11
  3132*    MOVE '&.S                   )   #00002918' TO DFHEIV0
  3133     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3134     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3135     MOVE X'2020233030303032393138' TO DFHEIV0(25:11)
  3136     CALL 'kxdfhei1' USING DFHEIV0,
  3137           ERCNOT-FILE-ID,
  3138           DFHEIV20,
  3139           DFHEIV99,
  3140           ERCNOT-KEY,
  3141           DFHEIV99,
  3142           DFHEIV11,
  3143           DFHEIV99,
  3144           DFHEIV99
  3145     SET ADDRESS OF CERT-NOTE-FILE TO
  3146         DFHEIV20
  3147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3148
  3149
  3150     IF CZ-COMPANY-CD NOT = SV-COMPANY-CD
  3151         GO TO 7010-ENDBR
  3152     END-IF.
  3153
  3154     IF (CZ-CARRIER = SV-CARRIER)
  3155        AND (CZ-GROUPING = SV-GROUPING)
  3156        AND (CZ-STATE = SV-STATE)
  3157        AND (CZ-ACCOUNT = SV-ACCOUNT)
  3158        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  3159        AND (CZ-CERT-NO = SV-CERT-NO)
  3160        AND (CZ-RECORD-TYPE = PI-CURR-NOTE-REC-TYPE)
  3161          MOVE CZ-NOTE TO REC-TEXT (TB-INDX)
  3162          MOVE CZ-LAST-MAINT-USER TO REC-LAST-MAINT-BY (TB-INDX)
  3163          MOVE CZ-LAST-MAINT-DT TO REC-LAST-MAINT-DT (TB-INDX)
  3164          MOVE CZ-LAST-MAINT-HHMMSS TO
  3165                         REC-LAST-MAINT-HHMMSS (TB-INDX)
  3166          SET TB-INDX UP BY 1
  3167          GO TO 7001-LOOP
  3168     END-IF.
  3169 7010-ENDBR.
  3170     IF TB-INDX = 1
  3171         MOVE ER-0006            TO EMI-ERROR
  3172         MOVE 'A'                TO FUNCTI
  3173         MOVE -1                 TO SC-TEXTL (1)
  3174         MOVE AL-UANON           TO FUNCTA
  3175         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3176         MOVE ZEROS              TO PI-TOTAL-LINES
  3177         GO TO 8100-SEND-INITIAL-MAP
  3178     END-IF.
  3179
  3180
  3181* EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  69
* EL1279.cbl
  3182*         DATASET(ERCNOT-FILE-ID)
  3183*    END-EXEC.
  3184     MOVE 0
  3185       TO DFHEIV11
  3186*    MOVE '&2                    $   #00002954' TO DFHEIV0
  3187     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3188     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3189     MOVE X'2020233030303032393534' TO DFHEIV0(25:11)
  3190     CALL 'kxdfhei1' USING DFHEIV0,
  3191           ERCNOT-FILE-ID,
  3192           DFHEIV11,
  3193           DFHEIV99
  3194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3195
  3196
  3197     SET TB-INDX DOWN BY 1.
  3198     SET PI-TOTAL-LINES TO TB-INDX.
  3199     MOVE 1                      TO PI-CURRENT-LINE.
  3200
  3201 7050-FORMAT-LINES.
  3202     SET TB-INDX TO PI-CURRENT-LINE.
  3203     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3204             VARYING SC-INDX FROM 1
  3205             BY 1 UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3206     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3207     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  70
* EL1279.cbl
  3209 7100-FORMAT-SCREEN.
  3210     IF TB-INDX > PI-TOTAL-LINES
  3211        IF FUNCTI NOT = 'A'
  3212           MOVE AL-PANON         TO SC-TEXTA (SC-INDX)
  3213        END-IF
  3214     END-IF.
  3215
  3216     IF TB-INDX > PI-TOTAL-LINES
  3217         GO TO 7100-EXIT
  3218     END-IF.
  3219
  3220     SET WS-LINE TO TB-INDX.
  3221     MOVE WS-LINE TO SC-LIN (SC-INDX).
  3222     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  3223     MOVE REC-LAST-MAINT-BY (TB-INDX) TO SC-MTBY (SC-INDX).
  3224     MOVE REC-LAST-MAINT-DT (TB-INDX) TO DC-BIN-DATE-1.
  3225     MOVE ' '                    TO DC-OPTION-CODE.
  3226     PERFORM 9700-LINK-DATE-CONVERT.
  3227     MOVE DC-GREG-DATE-1-MDY     TO SC-MTDT (SC-INDX).
  3228     SET ROLL-COUNTER TO TB-INDX.
  3229
  3230     IF NOT MODIFY-CAP
  3231         MOVE AL-PANOF           TO SC-TEXTA (SC-INDX)
  3232         SET TB-INDX UP BY 1
  3233         GO TO 7100-EXIT
  3234     END-IF.
  3235
  3236     SET TB-INDX UP BY 1.
  3237
  3238 7100-EXIT.
  3239      EXIT.
  3240
  3241 7200-PUT-TEMP-STOR.
  3242     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3243     SET TS-INDX TO 1.
  3244     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
  3245     PERFORM 7300-WRITE-TS THRU 7399-EXIT
  3246             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
  3247             UNTIL TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
  3248 7249-EXIT.
  3249      EXIT.
  3250 7250-DELETE-TEMP-STOR.
  3251
  3252* EXEC CICS HANDLE CONDITION
  3253*         QIDERR(7299-EXIT)
  3254*    END-EXEC.
  3255*    MOVE '"$N                   ! ( #00003012' TO DFHEIV0
  3256     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3258     MOVE X'2820233030303033303132' TO DFHEIV0(25:11)
  3259     CALL 'kxdfhei1' USING DFHEIV0
  3260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3261
  3262
  3263* EXEC CICS DELETEQ TS
  3264*         QUEUE(QID)
  3265*    END-EXEC.
  3266*    MOVE '*&                    #   #00003015' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  71
* EL1279.cbl
  3267     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3268     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3269     MOVE X'2020233030303033303135' TO DFHEIV0(25:11)
  3270     CALL 'kxdfhei1' USING DFHEIV0,
  3271           QID,
  3272           DFHEIV99
  3273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3274
  3275 7299-EXIT.
  3276     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  72
* EL1279.cbl
  3278 7300-WRITE-TS.
  3279     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
  3280     SET TS-INDX UP BY 1.
  3281     ADD 1 TO PI-TEMP-STOR-ITEMS.
  3282
  3283* EXEC CICS WRITEQ TS
  3284*         FROM(TS-WORK-AREA)
  3285*         QUEUE(QID)
  3286*         LENGTH(TS-LENGTH)
  3287*         ITEM(PI-TEMP-STOR-ITEMS)
  3288*    END-EXEC.
  3289*    MOVE '*" I   L              ''   #00003025' TO DFHEIV0
  3290     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
  3291     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3292     MOVE X'2020233030303033303235' TO DFHEIV0(25:11)
  3293     CALL 'kxdfhei1' USING DFHEIV0,
  3294           QID,
  3295           TS-WORK-AREA,
  3296           TS-LENGTH,
  3297           PI-TEMP-STOR-ITEMS,
  3298           DFHEIV99,
  3299           DFHEIV99
  3300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3301
  3302 7399-EXIT.
  3303     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  73
* EL1279.cbl
  3305 7400-PAGE-ROUTINE.
  3306
  3307     IF PFENTERL NOT = ZEROS
  3308        MOVE -1                  TO PFENTERL
  3309        ELSE
  3310        MOVE -1                  TO FUNCTL
  3311     END-IF.
  3312
  3313     IF PI-TOTAL-LINES = 0
  3314        MOVE ER-0047             TO EMI-ERROR
  3315        MOVE -1                  TO FUNCTL
  3316        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3317        GO TO 8200-SEND-DATAONLY
  3318     END-IF.
  3319
  3320     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
  3321
  3322     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3323        MOVE ER-0067             TO EMI-ERROR
  3324        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3325        MOVE 1 TO TEMP-CURR-LINE
  3326     END-IF.
  3327
  3328     IF TEMP-CURR-LINE GREATER THAN PI-TOTAL-LINES
  3329        MOVE ER-0066             TO EMI-ERROR
  3330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3331        COMPUTE TEMP-CURR-LINE = PI-TOTAL-LINES + 1
  3332                               - NUM-LINES-PER-SCREEN
  3333        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3334           MOVE 1                TO TEMP-CURR-LINE
  3335        END-IF
  3336     END-IF.
  3337
  3338     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3339     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3340             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3341             SC-INDX > NUM-LINES-PER-SCREEN.
  3342
  3343     IF EMI-ERROR = ER-0066 OR = ER-0067 OR = ZEROS
  3344        NEXT SENTENCE
  3345     ELSE
  3346        GO TO 8200-SEND-DATAONLY
  3347     END-IF.
  3348
  3349     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
  3350     SET TB-INDX TO PI-CURRENT-LINE.
  3351     MOVE LOW-VALUES             TO EL1279AI.
  3352     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3353             VARYING SC-INDX FROM 1 BY 1
  3354             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3355     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3356     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  74
* EL1279.cbl
  3358
  3359 7450-SET-INDX.
  3360     IF PI-CURRENT-LINE = 0 AND PI-TOTAL-LINES = 0
  3361        SET TB-INDX TO 1
  3362     ELSE
  3363        PERFORM 7500-READ-TS THRU 7599-EXIT
  3364        IF PI-CURRENT-LINE = 0
  3365           SET TB-INDX TO 1
  3366        ELSE
  3367           SET TB-INDX TO PI-CURRENT-LINE
  3368        END-IF
  3369     END-IF.
  3370 7450-EXIT.
  3371      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  75
* EL1279.cbl
  3373 7500-READ-TS.
  3374
  3375* EXEC CICS HANDLE CONDITION
  3376*         QIDERR(7590-TS-QIDERR)
  3377*         ITEMERR(7585-QID-ITEMERR)
  3378*    END-EXEC.
  3379*    MOVE '"$N<                  ! ) #00003103' TO DFHEIV0
  3380     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  3381     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3382     MOVE X'2920233030303033313033' TO DFHEIV0(25:11)
  3383     CALL 'kxdfhei1' USING DFHEIV0
  3384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3385
  3386     SET TS-INDX TO 1.
  3387     MOVE 1                      TO QID-ITEM.
  3388 7501-LOOP.
  3389
  3390* EXEC CICS READQ TS
  3391*         INTO(TS-WORK-AREA)
  3392*         QUEUE(QID)
  3393*         LENGTH(TS-LENGTH)
  3394*         ITEM(QID-ITEM)
  3395*    END-EXEC.
  3396*    MOVE '*$II   L              ''   #00003110' TO DFHEIV0
  3397     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3398     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3399     MOVE X'2020233030303033313130' TO DFHEIV0(25:11)
  3400     CALL 'kxdfhei1' USING DFHEIV0,
  3401           QID,
  3402           TS-WORK-AREA,
  3403           TS-LENGTH,
  3404           QID-ITEM,
  3405           DFHEIV99,
  3406           DFHEIV99
  3407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3408
  3409     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
  3410     SET TS-INDX UP BY 1.
  3411     ADD 1 TO QID-ITEM.
  3412     GO TO 7501-LOOP.
  3413
  3414 7585-QID-ITEMERR.
  3415     IF EIBTRNID NOT = TRANS-ID
  3416        SUBTRACT 1 FROM QID-ITEM
  3417        MOVE QID-ITEM            TO PI-TEMP-STOR-ITEMS
  3418     END-IF.
  3419     GO TO 7599-EXIT.
  3420
  3421 7590-TS-QIDERR.
  3422     IF EIBTRNID = TRANS-ID
  3423        AND EIBAID = DFHCLEAR
  3424           GO TO 9410-RETURN
  3425     END-IF.
  3426     IF EIBTRNID = TRANS-ID
  3427        MOVE ER-0033             TO EMI-ERROR
  3428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3429        GO TO 8100-SEND-INITIAL-MAP
  3430     END-IF.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  76
* EL1279.cbl
  3431
  3432 7599-EXIT.
  3433      EXIT.
  3434
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  77
* EL1279.cbl
  3436 7600-UPDATE-TABLE-FROM-SCREEN.
  3437
  3438     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3439         IF TB-INDX NOT > PI-TOTAL-LINES
  3440             PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3441             SET TB-INDX UP BY 1
  3442         ELSE
  3443             IF PI-TOTAL-LINES = MAX-LINES
  3444                 MOVE ER-0051    TO EMI-ERROR
  3445                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3446                 GO TO 8200-SEND-DATAONLY
  3447             ELSE
  3448                 PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3449                 SET TB-INDX UP BY 1
  3450                 ADD 1 TO PI-TOTAL-LINES
  3451             END-IF
  3452         END-IF
  3453     ELSE
  3454        IF TB-INDX NOT > PI-TOTAL-LINES
  3455           SET TB-INDX UP BY 1
  3456        END-IF
  3457     END-IF.
  3458
  3459 7699-EXIT.
  3460      EXIT.
  3461
  3462 7700-MOVE-DATA.
  3463     MOVE '1'                    TO PI-UPDATE-SW.
  3464
  3465     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3466        MOVE SC-TEXT (SC-INDX)  TO REC-TEXT (TB-INDX)
  3467        MOVE PI-PROCESSOR-ID    TO REC-LAST-MAINT-BY (TB-INDX)
  3468        MOVE EIBTIME            TO REC-LAST-MAINT-HHMMSS (TB-INDX)
  3469        MOVE SAVE-BIN-DATE      TO REC-LAST-MAINT-DT (TB-INDX)
  3470     END-IF.
  3471
  3472 7700-EXIT.
  3473      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  78
* EL1279.cbl
  3475 8100-SEND-INITIAL-MAP.
  3476     MOVE SAVE-DATE              TO DATEO.
  3477     MOVE EIBTIME                TO TIME-IN.
  3478     MOVE TIME-OUT               TO TIMEO.
  3479     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3480     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3481     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGBO.
  3482     MOVE PI-CARRIER             TO FCARRIRO.
  3483     MOVE PI-GROUPING            TO FGROUPO.
  3484     MOVE PI-STATE               TO FSTO.
  3485     MOVE PI-ACCOUNT             TO FACOUNTO.
  3486     MOVE PI-CERT-PRIME          TO FCERTO.
  3487     MOVE PI-CERT-SFX            TO FCRTSFXO.
  3488     MOVE  ' '                   TO DC-OPTION-CODE.
  3489     MOVE PI-CERT-EFF-DT         TO DC-BIN-DATE-1.
  3490     PERFORM 9700-LINK-DATE-CONVERT.
  3491     MOVE DC-GREG-DATE-1-EDIT    TO FEFFDTO.
  3492     MOVE PI-TOTAL-LINES         TO TOTO.
  3493     IF PI-CLAIM-NOTE
  3494         MOVE SCR-CLAIM-NOTE-TYPE TO FTYPEO
  3495         MOVE SCR-PF6-CERT        TO PF6NOTEO
  3496         MOVE SCR-CERT-YN         TO FTYPEYNO
  3497         IF PI-CERT-NOTES-EXIST = 'Y'
  3498             MOVE 'YES'           TO FCERTYNO
  3499         ELSE
  3500             MOVE 'NO '           TO FCERTYNO
  3501         END-IF
  3502     ELSE
  3503         MOVE SCR-CERT-NOTE-TYPE TO FTYPEO
  3504         MOVE SCR-PF6-CLAIM      TO PF6NOTEO
  3505         MOVE SCR-CLAIM-YN       TO FTYPEYNO
  3506         IF PI-CLAIM-NOTES-EXIST = 'Y'
  3507             MOVE 'YES'           TO FCERTYNO
  3508         ELSE
  3509             MOVE 'NO '           TO FCERTYNO
  3510         END-IF
  3511     END-IF.
  3512     IF PI-BILLING-NOTES-EXIST = 'Y'
  3513         MOVE 'YES'           TO FBILLYNO
  3514     ELSE
  3515         MOVE 'NO '           TO FBILLYNO
  3516     END-IF
  3517
  3518     MOVE -1                     TO FUNCTL.
  3519
  3520
  3521* EXEC CICS SEND
  3522*         MAP(MAP-NAME)
  3523*         MAPSET(MAPSET-NAME)
  3524*         FROM(EL1279AO)
  3525*         ERASE
  3526*         CURSOR
  3527*    END-EXEC.
  3528     MOVE LENGTH OF
  3529      EL1279AO
  3530       TO DFHEIV12
  3531     MOVE -1
  3532       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  79
* EL1279.cbl
  3533*    MOVE '8$     CT  E    H L F ,   #00003227' TO DFHEIV0
  3534     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3535     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3536     MOVE X'2020233030303033323237' TO DFHEIV0(25:11)
  3537     CALL 'kxdfhei1' USING DFHEIV0,
  3538           MAP-NAME,
  3539           EL1279AO,
  3540           DFHEIV12,
  3541           MAPSET-NAME,
  3542           DFHEIV99,
  3543           DFHEIV99,
  3544           DFHEIV99,
  3545           DFHEIV11,
  3546           DFHEIV99,
  3547           DFHEIV99,
  3548           DFHEIV99
  3549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3550
  3551
  3552     GO TO 9100-RETURN-TRAN.
  3553
  3554 8200-SEND-DATAONLY.
  3555     MOVE EIBTIME                TO TIME-IN.
  3556     MOVE TIME-OUT               TO TIMEO.
  3557     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3558     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3559     MOVE PI-TOTAL-LINES         TO TOTO.
  3560
  3561     IF NOT EMI-NO-ERRORS
  3562        MOVE EMI-MESSAGE-AREA (1) TO ERRMSGBO
  3563     ELSE
  3564        MOVE -1                  TO FUNCTL
  3565     END-IF.
  3566
  3567
  3568* EXEC CICS SEND
  3569*         MAP(MAP-NAME)
  3570*         MAPSET(MAPSET-NAME)
  3571*         FROM(EL1279AO)
  3572*         DATAONLY
  3573*         CURSOR
  3574*    END-EXEC.
  3575     MOVE LENGTH OF
  3576      EL1279AO
  3577       TO DFHEIV12
  3578     MOVE -1
  3579       TO DFHEIV11
  3580*    MOVE '8$D    CT       H L F ,   #00003250' TO DFHEIV0
  3581     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3582     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3583     MOVE X'2020233030303033323530' TO DFHEIV0(25:11)
  3584     CALL 'kxdfhei1' USING DFHEIV0,
  3585           MAP-NAME,
  3586           EL1279AO,
  3587           DFHEIV12,
  3588           MAPSET-NAME,
  3589           DFHEIV99,
  3590           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  80
* EL1279.cbl
  3591           DFHEIV99,
  3592           DFHEIV11,
  3593           DFHEIV99,
  3594           DFHEIV99,
  3595           DFHEIV99
  3596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3597
  3598
  3599     GO TO 9100-RETURN-TRAN.
  3600
  3601 8300-SEND-TEXT.
  3602
  3603* EXEC CICS SEND TEXT
  3604*         FROM(LOGOFF-TEXT)
  3605*         ERASE
  3606*         FREEKB
  3607*         LENGTH(LOGOFF-LENGTH)
  3608*    END-EXEC.
  3609*    MOVE '8&      T  E F  H   F -   #00003261' TO DFHEIV0
  3610     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3611     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3612     MOVE X'2020233030303033323631' TO DFHEIV0(25:11)
  3613     CALL 'kxdfhei1' USING DFHEIV0,
  3614           LOGOFF-TEXT,
  3615           LOGOFF-LENGTH,
  3616           DFHEIV99,
  3617           DFHEIV99,
  3618           DFHEIV99,
  3619           DFHEIV99,
  3620           DFHEIV99,
  3621           DFHEIV99,
  3622           DFHEIV99,
  3623           DFHEIV99,
  3624           DFHEIV99,
  3625           DFHEIV99
  3626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3627
  3628
  3629     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3630
  3631
  3632* EXEC CICS RETURN
  3633*    END-EXEC.
  3634*    MOVE '.(                    ''   #00003270' TO DFHEIV0
  3635     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3636     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3637     MOVE X'2020233030303033323730' TO DFHEIV0(25:11)
  3638     CALL 'kxdfhei1' USING DFHEIV0,
  3639           DFHEIV99,
  3640           DFHEIV99,
  3641           DFHEIV99,
  3642           DFHEIV99,
  3643           DFHEIV99,
  3644           DFHEIV99
  3645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3646
  3647
  3648 8800-UNAUTHORIZED-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  81
* EL1279.cbl
  3649     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3650     GO TO 8300-SEND-TEXT.
  3651
  3652 9000-RETURN-CICS.
  3653     IF PI-CHANGES-MADE
  3654        MOVE ER-0045             TO EMI-ERROR
  3655        MOVE -1                  TO FUNCTL
  3656        MOVE SPACES              TO PFENTERO
  3657        MOVE AL-UNNOF            TO PFENTERA
  3658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3659        GO TO 8200-SEND-DATAONLY
  3660     END-IF.
  3661
  3662     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3663     MOVE XCTL-005               TO PGM-NAME.
  3664     GO TO 9300-XCTL.
  3665
  3666 9100-RETURN-TRAN.
  3667     MOVE SCRN-NUMBER            TO PI-CURRENT-SCREEN-NO.
  3668     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3669
  3670* EXEC CICS RETURN
  3671*         TRANSID(TRANS-ID)
  3672*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  3673*         LENGTH(PI-COMM-LENGTH)
  3674*    END-EXEC.
  3675*    MOVE '.(CT                  ''   #00003294' TO DFHEIV0
  3676     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3677     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3678     MOVE X'2020233030303033323934' TO DFHEIV0(25:11)
  3679     CALL 'kxdfhei1' USING DFHEIV0,
  3680           TRANS-ID,
  3681           PROGRAM-INTERFACE-BLOCK,
  3682           PI-COMM-LENGTH,
  3683           DFHEIV99,
  3684           DFHEIV99,
  3685           DFHEIV99
  3686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3687
  3688
  3689
  3690 9200-RETURN-MAIN-MENU.
  3691     IF PI-CHANGES-MADE
  3692        MOVE -1                  TO FUNCTL
  3693        MOVE SPACES              TO PFENTERO
  3694        MOVE AL-UNNOF            TO PFENTERA
  3695        MOVE ER-0045             TO EMI-ERROR
  3696        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3697        GO TO 8200-SEND-DATAONLY
  3698     END-IF.
  3699
  3700     MOVE XCTL-126               TO PGM-NAME.
  3701
  3702 9300-XCTL.
  3703     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3704
  3705* EXEC CICS XCTL
  3706*         PROGRAM  (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  82
* EL1279.cbl
  3707*         COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3708*         LENGTH   (PI-COMM-LENGTH)
  3709*    END-EXEC.
  3710*    MOVE '.$C                   %   #00003315' TO DFHEIV0
  3711     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3712     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3713     MOVE X'2020233030303033333135' TO DFHEIV0(25:11)
  3714     CALL 'kxdfhei1' USING DFHEIV0,
  3715           PGM-NAME,
  3716           PROGRAM-INTERFACE-BLOCK,
  3717           PI-COMM-LENGTH,
  3718           DFHEIV99
  3719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3720
  3721
  3722 9400-CLEAR.
  3723
  3724     IF PI-CHANGES-MADE
  3725         MOVE ER-0045            TO EMI-ERROR
  3726         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3727         IF PI-CURRENT-LINE GREATER THAN ZERO
  3728             PERFORM 7500-READ-TS THRU 7599-EXIT
  3729             SET TB-INDX TO PI-CURRENT-LINE
  3730             PERFORM 7100-FORMAT-SCREEN  THRU  7100-EXIT
  3731                 VARYING SC-INDX FROM 1 BY 1 UNTIL
  3732                 SC-INDX GREATER NUM-LINES-PER-SCREEN
  3733         END-IF
  3734         GO TO 8100-SEND-INITIAL-MAP
  3735     END-IF.
  3736
  3737 9410-RETURN.
  3738     IF PF5-PRESSED
  3739         MOVE PGM-EL1276           TO PGM-NAME
  3740     ELSE
  3741         IF PF6-PRESSED
  3742             IF PI-CLAIM-NOTE
  3743                 SET PI-CERT-NOTE  TO TRUE
  3744             ELSE
  3745                 SET PI-CLAIM-NOTE TO TRUE
  3746             END-IF
  3747             SET PI-CHANGE-IN-NOTE-TYPE TO TRUE
  3748             MOVE 'N'              TO PI-PF6-PRESSED
  3749             GO TO 1000-START
  3750         ELSE
  3751             MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
  3752         END-IF
  3753     END-IF.
  3754     GO TO 9300-XCTL.
  3755
  3756 9500-PF12.
  3757     IF PI-CHANGES-MADE
  3758        MOVE -1                  TO FUNCTL
  3759        MOVE SPACES              TO PFENTERO
  3760        MOVE AL-UNNOF            TO PFENTERA
  3761        MOVE ER-0045             TO EMI-ERROR
  3762        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3763        GO TO 8200-SEND-DATAONLY
  3764     END-IF.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  83
* EL1279.cbl
  3765
  3766     MOVE 'EL010'                TO PGM-NAME.
  3767     GO TO 9300-XCTL.
  3768
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  84
* EL1279.cbl
  3770
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  85
* EL1279.cbl
  3772 9600-PGMID-ERROR.
  3773
  3774* EXEC CICS HANDLE CONDITION
  3775*         PGMIDERR(8300-SEND-TEXT)
  3776*    END-EXEC.
  3777*    MOVE '"$L                   ! * #00003372' TO DFHEIV0
  3778     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3780     MOVE X'2A20233030303033333732' TO DFHEIV0(25:11)
  3781     CALL 'kxdfhei1' USING DFHEIV0
  3782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3783
  3784
  3785     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  3786     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  3787     MOVE XCTL-005               TO  PGM-NAME.
  3788     MOVE PGM-NAME               TO  LOGOFF-PGM.
  3789     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  3790
  3791     GO TO 9300-XCTL.
  3792
  3793 9700-LINK-DATE-CONVERT.
  3794
  3795     MOVE LINK-ELDATCV           TO  PGM-NAME.
  3796
  3797* EXEC CICS LINK
  3798*        PROGRAM    (PGM-NAME)
  3799*        COMMAREA   (DATE-CONVERSION-DATA)
  3800*        LENGTH     (DC-COMM-LENGTH)
  3801*    END-EXEC.
  3802*    MOVE '."C                   (   #00003387' TO DFHEIV0
  3803     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3805     MOVE X'2020233030303033333837' TO DFHEIV0(25:11)
  3806     CALL 'kxdfhei1' USING DFHEIV0,
  3807           PGM-NAME,
  3808           DATE-CONVERSION-DATA,
  3809           DC-COMM-LENGTH,
  3810           DFHEIV99,
  3811           DFHEIV99,
  3812           DFHEIV99,
  3813           DFHEIV99
  3814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3815
  3816
  3817 9700-EXIT.
  3818     EXIT.
  3819
  3820 9900-ERROR-FORMAT.
  3821     IF NOT EMI-ERRORS-COMPLETE
  3822        MOVE LINK-001            TO  PGM-NAME
  3823
  3824* EXEC CICS LINK
  3825*            PROGRAM(PGM-NAME)
  3826*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  3827*            LENGTH(EMI-COMM-LENGTH)
  3828*       END-EXEC
  3829*    MOVE '."C                   (   #00003399' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  86
* EL1279.cbl
  3830     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3831     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3832     MOVE X'2020233030303033333939' TO DFHEIV0(25:11)
  3833     CALL 'kxdfhei1' USING DFHEIV0,
  3834           PGM-NAME,
  3835           ERROR-MESSAGE-INTERFACE-BLOCK,
  3836           EMI-COMM-LENGTH,
  3837           DFHEIV99,
  3838           DFHEIV99,
  3839           DFHEIV99,
  3840           DFHEIV99
  3841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3842     END-IF.
  3843 9900-EXIT.
  3844     EXIT.
  3845
  3846 9990-ABEND.
  3847     MOVE LINK-004               TO  PGM-NAME.
  3848     MOVE DFHEIBLK               TO  EMI-LINE1.
  3849
  3850
  3851* EXEC CICS LINK
  3852*        PROGRAM   (PGM-NAME)
  3853*        COMMAREA  (EMI-LINE1)
  3854*        LENGTH    (72)
  3855*    END-EXEC.
  3856     MOVE 72
  3857       TO DFHEIV11
  3858*    MOVE '."C                   (   #00003412' TO DFHEIV0
  3859     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3860     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3861     MOVE X'2020233030303033343132' TO DFHEIV0(25:11)
  3862     CALL 'kxdfhei1' USING DFHEIV0,
  3863           PGM-NAME,
  3864           EMI-LINE1,
  3865           DFHEIV11,
  3866           DFHEIV99,
  3867           DFHEIV99,
  3868           DFHEIV99,
  3869           DFHEIV99
  3870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3871
  3872
  3873     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSGBO.
  3874     MOVE -1                     TO  FUNCTL.
  3875
  3876     GO TO 8100-SEND-INITIAL-MAP.
  3877
  3878
  3879* GOBACK.
  3880     MOVE '9%                    "   ' TO DFHEIV0
  3881     MOVE 'EL1279' TO DFHEIV1
  3882     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3883     GOBACK.
  3884
  3885 9995-SECURITY-VIOLATION.
  3886*                                COPY ELCSCTP.
  3887******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  87
* EL1279.cbl
  3888*                                                                *
  3889*                            ELCSCTP                             *
  3890*                            VMOD=2.001                          *
  3891*                                                                *
  3892*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3893******************************************************************
  3894
  3895
  3896     MOVE EIBDATE          TO SM-JUL-DATE.
  3897     MOVE EIBTRMID         TO SM-TERMID.
  3898     MOVE THIS-PGM         TO SM-PGM.
  3899     MOVE EIBTIME          TO TIME-IN.
  3900     MOVE TIME-OUT         TO SM-TIME.
  3901     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3902
  3903
  3904* EXEC CICS LINK
  3905*         PROGRAM  ('EL003')
  3906*         COMMAREA (SECURITY-MESSAGE)
  3907*         LENGTH   (80)
  3908*    END-EXEC.
  3909     MOVE 'EL003' TO DFHEIV1
  3910     MOVE 80
  3911       TO DFHEIV11
  3912*    MOVE '."C                   (   #00003443' TO DFHEIV0
  3913     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3914     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3915     MOVE X'2020233030303033343433' TO DFHEIV0(25:11)
  3916     CALL 'kxdfhei1' USING DFHEIV0,
  3917           DFHEIV1,
  3918           SECURITY-MESSAGE,
  3919           DFHEIV11,
  3920           DFHEIV99,
  3921           DFHEIV99,
  3922           DFHEIV99,
  3923           DFHEIV99
  3924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3925
  3926
  3927******************************************************************
  3928
  3929
  3930 9995-EXIT.
  3931     EXIT.
  3932
  3933 9999-DFHBACK SECTION.
  3934     MOVE '9%                    "   ' TO DFHEIV0
  3935     MOVE 'EL1279' TO DFHEIV1
  3936     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3937     GOBACK.
  3938 9999-DFHEXIT.
  3939     IF DFHEIGDJ EQUAL 0001
  3940         NEXT SENTENCE
  3941     ELSE IF DFHEIGDJ EQUAL 2
  3942         GO TO 9400-CLEAR
  3943         DEPENDING ON DFHEIGDI
  3944     ELSE IF DFHEIGDJ EQUAL 3
  3945         GO TO 9990-ABEND,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:48 Page  88
* EL1279.cbl
  3946               9600-PGMID-ERROR
  3947         DEPENDING ON DFHEIGDI
  3948     ELSE IF DFHEIGDJ EQUAL 4
  3949         GO TO 4610-ENDBR,
  3950               6000-NOT-OPEN,
  3951               4610-ENDBR
  3952         DEPENDING ON DFHEIGDI
  3953     ELSE IF DFHEIGDJ EQUAL 5
  3954         GO TO 4899-EXIT
  3955         DEPENDING ON DFHEIGDI
  3956     ELSE IF DFHEIGDJ EQUAL 6
  3957         GO TO 4900-EXIT
  3958         DEPENDING ON DFHEIGDI
  3959     ELSE IF DFHEIGDJ EQUAL 7
  3960         GO TO 7010-ENDBR,
  3961               6000-NOT-OPEN,
  3962               7010-ENDBR
  3963         DEPENDING ON DFHEIGDI
  3964     ELSE IF DFHEIGDJ EQUAL 8
  3965         GO TO 7299-EXIT
  3966         DEPENDING ON DFHEIGDI
  3967     ELSE IF DFHEIGDJ EQUAL 9
  3968         GO TO 7590-TS-QIDERR,
  3969               7585-QID-ITEMERR
  3970         DEPENDING ON DFHEIGDI
  3971     ELSE IF DFHEIGDJ EQUAL 10
  3972         GO TO 8300-SEND-TEXT
  3973         DEPENDING ON DFHEIGDI.
  3974     MOVE '9%                    "   ' TO DFHEIV0
  3975     MOVE 'EL1279' TO DFHEIV1
  3976     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3977     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       31152     Code:       12441
