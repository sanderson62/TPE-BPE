* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   1
* EL630.cbl
* Options: int("EL630.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL630.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL630.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL630.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL630.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/19/94 08:59:00.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.046.
     9
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   2
* EL630.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXA5 - NEW BUSINESS - DATA ENTRY.
    25*
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 103001    2001100100006  SMVA  CHECK FOR ? MARKS ANYWHERE IN
    35*                              BATCH NUMBER
    36* 072308  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
    37* 111109  CR2008100900003  AJRA  ADD NEW CERT NOTE TABLE
    38* 030310  CR2009031200002  PEMA  OPEN LOAN OFFICER ON 6301
    39* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    40* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    41* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
    42******************************************************************
    43
    44 ENVIRONMENT DIVISION.
    45
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   3
* EL630.cbl
    47 DATA DIVISION.
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*    EL630 WORKING STORAGE     *'.
    53 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    54
    55*    COPY ELCSCTM.
    56******************************************************************
    57*                                                                *
    58*                                                                *
    59*                            ELCSCTM                             *
    60*                            VMOD=2.001                          *
    61*                                                                *
    62*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    63*                                                                *
    64******************************************************************
    65 01  SECURITY-MESSAGE.
    66     12  FILLER                          PIC X(30)
    67            VALUE '** LOGIC SECURITY VIOLATION -'.
    68     12  SM-READ                         PIC X(6).
    69     12  FILLER                          PIC X(5)
    70            VALUE ' PGM='.
    71     12  SM-PGM                          PIC X(6).
    72     12  FILLER                          PIC X(5)
    73            VALUE ' OPR='.
    74     12  SM-PROCESSOR-ID                 PIC X(4).
    75     12  FILLER                          PIC X(6)
    76            VALUE ' TERM='.
    77     12  SM-TERMID                       PIC X(4).
    78     12  FILLER                          PIC XX   VALUE SPACE.
    79     12  SM-JUL-DATE                     PIC 9(5).
    80     12  FILLER                          PIC X    VALUE SPACE.
    81     12  SM-TIME                         PIC 99.99.
    82
    83*    COPY ELCSCRTY.
    84******************************************************************
    85*                                                                *
    86*                                                                *
    87*                            ELCSCRTY                            *
    88*                            VMOD=2.001                          *
    89*                                                                *
    90*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    91*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    92*        SAVED IN PI-SECURITY-ADDRESS.                           *
    93*                                                                *
    94******************************************************************
    95 01  SECURITY-CONTROL.
    96     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    97     12  FILLER                       PIC XX    VALUE 'SC'.
    98     12  SC-CREDIT-CODES.
    99         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   100             20  SC-CREDIT-DISPLAY    PIC X.
   101             20  SC-CREDIT-UPDATE     PIC X.
   102     12  SC-CLAIMS-CODES.
   103         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   104             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   4
* EL630.cbl
   105             20  SC-CLAIMS-UPDATE     PIC X.
   106
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   5
* EL630.cbl
   108
   109 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1900.
   110 01  STANDARD-AREAS.
   111     12  SC-ITEM                 PIC S9(4) COMP VALUE +1.
   112     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   113     12  MAP-NAME                PIC X(8)    VALUE 'EL630A'.
   114     12  MAPSET-NAME             PIC X(8)    VALUE 'EL630S '.
   115     12  SCREEN-NUMBER           PIC X(4)    VALUE '630A'.
   116     12  TRANS-ID                PIC X(4)    VALUE 'EXA5'.
   117     12  EDIT-TRANS              PIC X(4)    VALUE 'EXEB'.
   118     12  PASS-AREA-LEN           PIC S9(4)   COMP VALUE +16.
   119     12  THIS-PGM                PIC X(8)    VALUE 'EL630'.
   120     12  PGM-NAME                PIC X(8)    VALUE SPACES.
   121     12  TIME-IN                 PIC S9(7)   VALUE ZEROS.
   122     12  TIME-OUT-R  REDEFINES TIME-IN.
   123         16  FILLER              PIC X.
   124         16  TIME-OUT            PIC 99V99.
   125         16  FILLER              PIC X(2).
   126     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   127     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   128     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   129     12  XCTL-6301               PIC X(8)    VALUE 'EL6301'.
   130     12  XCTL-6302               PIC X(8)    VALUE 'EL6302'.
   131     12  XCTL-633                PIC X(8)    VALUE 'EL633'.
   132     12  XCTL-633DMD             PIC X(8)    VALUE 'EL633DMD'.
   133     12  XCTL-635                PIC X(8)    VALUE 'EL635'.
   134     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   135     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   136     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   137     12  ELCNTL-FILE-ID          PIC X(8)    VALUE 'ELCNTL'.
   138     12  ERPNDB-FILE-ID          PIC X(8)    VALUE 'ERPNDB'.
   139     12  ERACCT-FILE-ID          PIC X(8)    VALUE 'ERACCT'.
   140     12  ERACCT2-FILE-ID         PIC X(8)    VALUE 'ERACCT2'.
   141     12  ELCERT-FILE-ID          PIC X(8)    VALUE 'ELCERT'.
   142     12  ERNOTE-FILE-ID          PIC X(8)    VALUE 'ERNOTE'.
   143     12  ERCNOT-FILE-ID          PIC X(8)    VALUE 'ERCNOT'.
   144     12  ERMAIL-FILE-ID          PIC X(8)    VALUE 'ERMAIL'.
   145     12  ERCOMP-FILE-ID          PIC X(8)    VALUE 'ERCOMP'.
   146     12  ERPNDM-FILE-ID          PIC X(8)    VALUE 'ERPNDM'.
   147     12  ERRQST-FILE-ID          PIC X(8)    VALUE 'ERRQST'.
   148     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   149     12  WS-CURRENT-DT           PIC X(8)    VALUE SPACES.
   150     12  WS-CURRENT-YMD          PIC 9(6)    VALUE ZEROS.
   151     12  WS-SYNC-CNTR            PIC S9(3)   VALUE +0 COMP-3.
   152     12  WS-SUB1                 PIC S9(4)   VALUE +0 COMP.
   153     12  WS-SUB2                 PIC S9(4)   VALUE +0 COMP.
   154     12  PIC6-SUB                PIC S9(04)  VALUE +0 COMP.
   155     12  WS-AR-REPORTING         PIC X       VALUE SPACE.
   156         88  AR-NET-REPORT               VALUE 'N'.
   157         88  AR-GROSS-REPORT             VALUE 'G'.
   158     12  WS-COMP-MASTER-ERROR-SW PIC X       VALUE SPACE.
   159         88  WS-COMP-MASTER-ERROR        VALUE 'Y'.
   160
   161     12  WS-UPDATE-REFERENCE-SW  PIC X       VALUE SPACE.
   162         88  WS-UPDATE-REFERENCE         VALUE 'Y'.
   163
   164     12  WS-SWITCH               PIC X(01)   VALUE SPACE.
   165         88  QUESTION-MARK-FOUND             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   6
* EL630.cbl
   166
   167     12  WS-RECORD-FOUND-SW      PIC X       VALUE SPACE.
   168         88  RECORD-FOUND                VALUE 'Y'.
   169         88  RECORD-NOT-FOUND            VALUE 'N'.
   170
   171     12  WS-ON1-SW1              PIC X(01)   VALUE 'Y'.
   172     12  WS-ON1-SW2              PIC X(01)   VALUE 'Y'.
   173     12  WS-ON1-SW3              PIC X(01)   VALUE 'Y'.
   174     12  WS-ON1-SW4              PIC X(01)   VALUE 'Y'.
   175     12  WS-ON1-SW5              PIC X(01)   VALUE 'Y'.
   176     12  WS-ON1-SW6              PIC X(01)   VALUE 'Y'.
   177     12  WS-ON1-SW7              PIC X(01)   VALUE 'Y'.
   178
   179     12  WS-ERPNDB-RECORD        PIC X(585)  VALUE SPACES.
   180
   181 01  BATCH-TO-PROCESS.
   182     05  EDIT-COMPANY-CD         PIC X       VALUE LOW-VALUES.
   183     05  EDIT-BATCH              PIC X(6)    VALUE SPACES.
   184     05  EDIT-COMPANY-ID         PIC XXX     VALUE SPACES.
   185     05  EDIT-RESTART-BATCH      PIC X(6)    VALUE SPACES.
   186
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   7
* EL630.cbl
   188 01  ERROR-MESSAGES.
   189     12  ER-0008                 PIC X(4)    VALUE '0008'.
   190     12  ER-0023                 PIC X(4)    VALUE '0023'.
   191     12  ER-0029                 PIC X(4)    VALUE '0029'.
   192     12  ER-0070                 PIC X(4)    VALUE '0070'.
   193     12  ER-0194                 PIC X(4)    VALUE '0194'.
   194     12  ER-0195                 PIC X(4)    VALUE '0195'.
   195     12  ER-0196                 PIC X(4)    VALUE '0196'.
   196     12  ER-0197                 PIC X(4)    VALUE '0197'.
   197     12  ER-0340                 PIC X(4)    VALUE '0340'.
   198     12  ER-0587                 PIC X(4)    VALUE '0587'.
   199     12  ER-0905                 PIC X(4)    VALUE '0905'.
   200     12  ER-2119                 PIC X(4)    VALUE '2119'.
   201     12  ER-2126                 PIC X(4)    VALUE '2126'.
   202     12  ER-2132                 PIC X(4)    VALUE '2132'.
   203     12  ER-2201                 PIC X(4)    VALUE '2201'.
   204     12  ER-2208                 PIC X(4)    VALUE '2208'.
   205     12  ER-2209                 PIC X(4)    VALUE '2209'.
   206     12  ER-2210                 PIC X(4)    VALUE '2210'.
   207     12  ER-2211                 PIC X(4)    VALUE '2211'.
   208     12  ER-2212                 PIC X(4)    VALUE '2212'.
   209     12  ER-2213                 PIC X(4)    VALUE '2213'.
   210     12  ER-2214                 PIC X(4)    VALUE '2214'.
   211     12  ER-2215                 PIC X(4)    VALUE '2215'.
   212     12  ER-2216                 PIC X(4)    VALUE '2216'.
   213     12  ER-2229                 PIC X(4)    VALUE '2229'.
   214     12  ER-2242                 PIC X(4)    VALUE '2242'.
   215     12  ER-2248                 PIC X(4)    VALUE '2248'.
   216     12  ER-2370                 PIC X(4)    VALUE '2370'.
   217     12  ER-2371                 PIC X(4)    VALUE '2371'.
   218     12  ER-2402                 PIC X(4)    VALUE '2402'.
   219     12  ER-2422                 PIC X(4)    VALUE '2422'.
   220     12  ER-2800                 PIC X(4)    VALUE '2800'.
   221     12  ER-2880                 PIC X(4)    VALUE '2880'.
   222     12  ER-2990                 PIC X(4)    VALUE '2990'.
   223
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   8
* EL630.cbl
   225 01  ACCESS-KEYS.
   226     12  ELCNTL-KEY.
   227         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   228         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   229         16  CNTL-ACCESS.
   230             20  CNTL-STATE      PIC XX    VALUE SPACES.
   231             20  FILLER          PIC X     VALUE SPACES.
   232             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   233         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   234
   235     12  ERPNDB-KEY.
   236         16  PNDB-COMP-CD        PIC X     VALUE SPACE.
   237         16  PNDB-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   238         16  PNDB-BATCH-SEQ      PIC S9(4) VALUE +0 COMP.
   239         16  PNDB-BATCH-CHG-SEQ  PIC S9(4) VALUE +0 COMP.
   240
   241     12  ERACCT-KEY.
   242         16  ERACCT-COMP-KEY.
   243             20  ACCT-CO         PIC X     VALUE SPACES.
   244             20  ACCT-CARRIER    PIC X     VALUE SPACES.
   245             20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
   246             20  ACCT-STATE      PIC XX    VALUE SPACES.
   247             20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
   248         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   249         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   250     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   251
   252     12  ELCERT-KEY.
   253         16  CERT-COMPANY-CD     PIC X     VALUE SPACES.
   254         16  CERT-CARRIER        PIC X     VALUE SPACES.
   255         16  CERT-GROUPING       PIC X(6)  VALUE SPACES.
   256         16  CERT-STATE          PIC XX    VALUE SPACES.
   257         16  FILLER              PIC X(23) VALUE SPACES.
   258
   259     12  ernote-generic-key-len  pic s9(4) comp value +33.
   260     12  ernote-key.
   261         16  ernote-company-cd   pic x     value spaces.
   262         16  ernote-carrier      pic x     value spaces.
   263         16  ernote-grouping     pic x(6)  value spaces.
   264         16  ernote-state        pic xx    value spaces.
   265         16  ernote-account      pic x(10) value spaces.
   266         16  ernote-cert-eff-dt  pic xx    value spaces.
   267         16  ernote-cert-no      pic x(11) value spaces.
   268         16  ernote-rec-type     pic x     value spaces.
   269     12  ERCOMP-KEY.
   270         16  ERCOMP-COMP-CD      PIC X     VALUE SPACE.
   271         16  ERCOMP-CARRIER      PIC X     VALUE SPACES.
   272         16  ERCOMP-GROUPING     PIC X(6)  VALUE SPACES.
   273         16  ERCOMP-FIN-RESP     PIC X(10) VALUE SPACES.
   274         16  ERCOMP-ACCT         PIC X(10) VALUE SPACES.
   275         16  ERCOMP-RECORD-TYPE  PIC X     VALUE SPACES.
   276
   277     12  ERRQST-KEY.
   278         16  ERRQST-COMP-CD      PIC X     VALUE SPACE.
   279         16  ERRQST-ENTRY-BATCH  PIC X(6)  VALUE SPACES.
   280
   281     12  ERCNOT-KEY.
   282         16  ERCNOT-PART-KEY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   9
* EL630.cbl
   283             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   284             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   285             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   286             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   287             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   288             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   289             20  ERCNOT-CERT-NO.
   290                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   291                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   292         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   293         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   294
   295
   296 01  FILLER.
   297     12  W-RESPONSE              PIC S9(8)   COMP.
   298         88  RESP-NORMAL               VALUE +00.
   299         88  RESP-NOTFND               VALUE +13.
   300         88  RESP-DUPREC               VALUE +14.
   301         88  RESP-DUPKEY               VALUE +15.
   302         88  RESP-NOTOPEN              VALUE +19.
   303         88  RESP-ENDFILE              VALUE +20.
   304         88  resp-lengtherr            value +22.
   305     12  WS-DEEDIT-FIELD         PIC S9(8)V99 VALUE ZEROS.
   306     12  WS-DT-DEEDIT-FIELD REDEFINES
   307         WS-DEEDIT-FIELD         PIC X(10).
   308     12  WS-DEEDIT-FIELD-DATE  REDEFINES  WS-DEEDIT-FIELD.
   309         16   FILLER                           PIC X(04).
   310         16   WS-DEEDIT-FIELD-DATE-OUT         PIC X(06).
   311     12  QUESTION-MARKS          PIC X(6)      VALUE '??????'.
   312     12  QUESTION-MARK           PIC X(01)     VALUE '?'.
   313     12  WS-BATCH-NO             PIC 9(6)      VALUE ZEROS.
   314     12  WS-OBAL                 PIC S9(8)V99  VALUE ZEROS.
   315     12  WS-OCNT                 PIC S9(5)     VALUE ZEROS.
   316     12  WS-DELETE-CNT           PIC S9(5)     VALUE ZEROS.
   317     12  WS-PF1-SW               PIC X         VALUE SPACES.
   318         88  WS-PF1                            VALUE 'Y'.
   319
   320     12  WS-SAV-PNDB-KEY.
   321         16  WS-SAV-COMP-CD        PIC X       VALUE LOW-VALUES.
   322         16  WS-SAV-ENTRY-BATCH    PIC X(6)       VALUE SPACES.
   323         16  WS-SAV-BATCH-SEQ      PIC S9(4) COMP VALUE ZEROS.
   324         16  WS-SAV-BATCH-CHG-SEQ  PIC S9(4) COMP VALUE ZEROS.
   325
   326     12  DATE-TEST-AREA          PIC 9(6)         VALUE ZEROS.
   327     12  DATE-TEST-AREA-R  REDEFINES DATE-TEST-AREA.
   328         16  DATE-TEST-MM        PIC 99.
   329         16  DATE-TEST-DD        PIC 99.
   330         16  DATE-TEST-YY        PIC 99.
   331     12  DIVIDE-RESULT           PIC 99           VALUE ZEROS.
   332     12  DIVIDE-REMAINDER        PIC 9            VALUE 0.
   333     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   334         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   335     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   336         88 CERT-ADDRESS-PRESENT     VALUE 'Y'.
   337     12  WS-PRM-HEADER.
   338         16  WS-PRM-OVERRIDE     PIC XX           VALUE SPACES.
   339         16  FILLER              PIC X(8)  VALUE '-PREMIUM'.
   340     12  WS-REFUND-HEADER.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  10
* EL630.cbl
   341         16  WS-REFUND-OVERRIDE  PIC XX    VALUE SPACES.
   342         16  FILLER              PIC X(7)  VALUE '-REFUND'.
   343
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  11
* EL630.cbl
   345
   346*    COPY ELCDATE.
   347******************************************************************
   348*                                                                *
   349*                                                                *
   350*                            ELCDATE.                            *
   351*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   352*                            VMOD=2.003
   353*                                                                *
   354*                                                                *
   355*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   356*                 LENGTH = 200                                   *
   357******************************************************************
   358
   359 01  DATE-CONVERSION-DATA.
   360     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   361     12  DC-OPTION-CODE                PIC X.
   362         88  BIN-TO-GREG                VALUE ' '.
   363         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   364         88  EDIT-GREG-TO-BIN           VALUE '2'.
   365         88  YMD-GREG-TO-BIN            VALUE '3'.
   366         88  MDY-GREG-TO-BIN            VALUE '4'.
   367         88  JULIAN-TO-BIN              VALUE '5'.
   368         88  BIN-PLUS-ELAPSED           VALUE '6'.
   369         88  FIND-CENTURY               VALUE '7'.
   370         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   371         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   372         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   373         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   374         88  JULIAN-TO-BIN-3            VALUE 'C'.
   375         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   376         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   377         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   378         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   379         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   380         88  CHECK-LEAP-YEAR            VALUE 'H'.
   381         88  BIN-3-TO-GREG              VALUE 'I'.
   382         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   383         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   384         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   385         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   386         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   387         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   388         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   389         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   390         88  THREE-CHARACTER-BIN
   391                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   392         88  GREGORIAN-TO-BIN
   393                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   394         88  BIN-TO-GREGORIAN
   395                  VALUES ' ' '1' 'I' '8' 'G'.
   396         88  JULIAN-TO-BINARY
   397                  VALUES '5' 'C' 'E' 'F'.
   398     12  DC-ERROR-CODE                 PIC X.
   399         88  NO-CONVERSION-ERROR        VALUE ' '.
   400         88  DATE-CONVERSION-ERROR
   401                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   402         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  12
* EL630.cbl
   403         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   404         88  DATE-IS-INVALID            VALUE '3'.
   405         88  DATE1-GREATER-DATE2        VALUE '4'.
   406         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   407         88  DATE-INVALID-OPTION        VALUE '9'.
   408         88  INVALID-CENTURY            VALUE 'A'.
   409         88  ONLY-CENTURY               VALUE 'B'.
   410         88  ONLY-LEAP-YEAR             VALUE 'C'.
   411         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   412     12  DC-END-OF-MONTH               PIC X.
   413         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   414     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   415         88  USE-NORMAL-PROCESS         VALUE ' '.
   416         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   417         88  ADJUST-UP-100-YRS          VALUE '2'.
   418     12  FILLER                        PIC X.
   419     12  DC-CONVERSION-DATES.
   420         16  DC-BIN-DATE-1             PIC XX.
   421         16  DC-BIN-DATE-2             PIC XX.
   422         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   423         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   424                       DC-GREG-DATE-1-EDIT.
   425             20  DC-EDIT1-MONTH        PIC 99.
   426             20  SLASH1-1              PIC X.
   427             20  DC-EDIT1-DAY          PIC 99.
   428             20  SLASH1-2              PIC X.
   429             20  DC-EDIT1-YEAR         PIC 99.
   430         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   431         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   432                     DC-GREG-DATE-2-EDIT.
   433             20  DC-EDIT2-MONTH        PIC 99.
   434             20  SLASH2-1              PIC X.
   435             20  DC-EDIT2-DAY          PIC 99.
   436             20  SLASH2-2              PIC X.
   437             20  DC-EDIT2-YEAR         PIC 99.
   438         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   439         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   440                     DC-GREG-DATE-1-YMD.
   441             20  DC-YMD-YEAR           PIC 99.
   442             20  DC-YMD-MONTH          PIC 99.
   443             20  DC-YMD-DAY            PIC 99.
   444         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   445         16  DC-GREG-DATE-1-MDY-R REDEFINES
   446                      DC-GREG-DATE-1-MDY.
   447             20  DC-MDY-MONTH          PIC 99.
   448             20  DC-MDY-DAY            PIC 99.
   449             20  DC-MDY-YEAR           PIC 99.
   450         16  DC-GREG-DATE-1-ALPHA.
   451             20  DC-ALPHA-MONTH        PIC X(10).
   452             20  DC-ALPHA-DAY          PIC 99.
   453             20  FILLER                PIC XX.
   454             20  DC-ALPHA-CENTURY.
   455                 24 DC-ALPHA-CEN-N     PIC 99.
   456             20  DC-ALPHA-YEAR         PIC 99.
   457         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   458         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   459         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   460         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  13
* EL630.cbl
   461         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   462                                       PIC 9(05).
   463         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   464             20  DC-JULIAN-YEAR        PIC 99.
   465             20  DC-JULIAN-DAYS        PIC 999.
   466         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   467         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   468         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   469     12  DATE-CONVERSION-VARIBLES.
   470         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   471         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   472             20  FILLER                PIC 9(3).
   473             20  HOLD-CEN-1-CCYY.
   474                 24  HOLD-CEN-1-CC     PIC 99.
   475                 24  HOLD-CEN-1-YY     PIC 99.
   476             20  HOLD-CEN-1-MO         PIC 99.
   477             20  HOLD-CEN-1-DA         PIC 99.
   478         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   479             20  HOLD-CEN-1-R-MO       PIC 99.
   480             20  HOLD-CEN-1-R-DA       PIC 99.
   481             20  HOLD-CEN-1-R-CCYY.
   482                 24  HOLD-CEN-1-R-CC   PIC 99.
   483                 24  HOLD-CEN-1-R-YY   PIC 99.
   484             20  FILLER                PIC 9(3).
   485         16  HOLD-CENTURY-1-X.
   486             20  FILLER                PIC X(3)  VALUE SPACES.
   487             20  HOLD-CEN-1-X-CCYY.
   488                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   489                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   490             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   491             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   492         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   493             20  HOLD-CEN-1-R-X-MO     PIC XX.
   494             20  HOLD-CEN-1-R-X-DA     PIC XX.
   495             20  HOLD-CEN-1-R-X-CCYY.
   496                 24  HOLD-CEN-1-R-X-CC PIC XX.
   497                 24  HOLD-CEN-1-R-X-YY PIC XX.
   498             20  FILLER                PIC XXX.
   499         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   500         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   501         16  DC-JULIAN-DATE-1          PIC 9(07).
   502         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   503             20  DC-JULIAN-1-CCYY.
   504                 24  DC-JULIAN-1-CC    PIC 99.
   505                 24  DC-JULIAN-1-YR    PIC 99.
   506             20  DC-JULIAN-DA-1        PIC 999.
   507         16  DC-JULIAN-DATE-2          PIC 9(07).
   508         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   509             20  DC-JULIAN-2-CCYY.
   510                 24  DC-JULIAN-2-CC    PIC 99.
   511                 24  DC-JULIAN-2-YR    PIC 99.
   512             20  DC-JULIAN-DA-2        PIC 999.
   513         16  DC-GREG-DATE-A-EDIT.
   514             20  DC-EDITA-MONTH        PIC 99.
   515             20  SLASHA-1              PIC X VALUE '/'.
   516             20  DC-EDITA-DAY          PIC 99.
   517             20  SLASHA-2              PIC X VALUE '/'.
   518             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  14
* EL630.cbl
   519                 24  DC-EDITA-CENT     PIC 99.
   520                 24  DC-EDITA-YEAR     PIC 99.
   521         16  DC-GREG-DATE-B-EDIT.
   522             20  DC-EDITB-MONTH        PIC 99.
   523             20  SLASHB-1              PIC X VALUE '/'.
   524             20  DC-EDITB-DAY          PIC 99.
   525             20  SLASHB-2              PIC X VALUE '/'.
   526             20  DC-EDITB-CCYY.
   527                 24  DC-EDITB-CENT     PIC 99.
   528                 24  DC-EDITB-YEAR     PIC 99.
   529         16  DC-GREG-DATE-CYMD         PIC 9(08).
   530         16  DC-GREG-DATE-CYMD-R REDEFINES
   531                              DC-GREG-DATE-CYMD.
   532             20  DC-CYMD-CEN           PIC 99.
   533             20  DC-CYMD-YEAR          PIC 99.
   534             20  DC-CYMD-MONTH         PIC 99.
   535             20  DC-CYMD-DAY           PIC 99.
   536         16  DC-GREG-DATE-MDCY         PIC 9(08).
   537         16  DC-GREG-DATE-MDCY-R REDEFINES
   538                              DC-GREG-DATE-MDCY.
   539             20  DC-MDCY-MONTH         PIC 99.
   540             20  DC-MDCY-DAY           PIC 99.
   541             20  DC-MDCY-CEN           PIC 99.
   542             20  DC-MDCY-YEAR          PIC 99.
   543    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   544        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   545    12  DC-EL310-DATE                  PIC X(21).
   546    12  FILLER                         PIC X(28).
   547
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  15
* EL630.cbl
   549*    COPY ELCLOGOF.
   550******************************************************************
   551*                                                                *
   552*                                                                *
   553*                            ELCLOGOF.                           *
   554*                            VMOD=2.001                          *
   555*                                                                *
   556*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   557*                                                                *
   558******************************************************************
   559 01  CLASIC-LOGOFF.
   560     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   561     12  LOGOFF-TEXT.
   562         16  FILLER          PIC X(5)    VALUE SPACES.
   563         16  LOGOFF-MSG.
   564             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   565             20  FILLER      PIC X       VALUE SPACES.
   566             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   567         16  FILLER          PIC X(80)
   568           VALUE '* YOU ARE NOW LOGGED OFF'.
   569         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   570         16  FILLER          PIC X       VALUE QUOTE.
   571         16  LOGOFF-SYS-MSG  PIC X(17)
   572           VALUE 'S CLAS-IC SYSTEM '.
   573     12  TEXT-MESSAGES.
   574         16  UNACCESS-MSG    PIC X(29)
   575             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   576         16  PGMIDERR-MSG    PIC X(17)
   577             VALUE 'PROGRAM NOT FOUND'.
   578
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  16
* EL630.cbl
   580*    COPY ELCATTR.
   581******************************************************************
   582*                                                                *
   583*                            ELCATTR.                            *
   584*                            VMOD=2.001                          *
   585*                                                                *
   586*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   587*                                                                *
   588*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   589*                                                                *
   590*                   POS 1   P=PROTECTED                          *
   591*                           U=UNPROTECTED                        *
   592*                           S=ASKIP                              *
   593*                   POS 2   A=ALPHA/NUMERIC                      *
   594*                           N=NUMERIC                            *
   595*                   POS 3   N=NORMAL                             *
   596*                           B=BRIGHT                             *
   597*                           D=DARK                               *
   598*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   599*                           OF=MODIFIED DATA TAG OFF             *
   600*                                                                *
   601*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   602******************************************************************
   603 01  ATTRIBUTE-LIST.
   604     12  AL-PABOF            PIC X       VALUE 'Y'.
   605     12  AL-PABON            PIC X       VALUE 'Z'.
   606     12  AL-PADOF            PIC X       VALUE '%'.
   607     12  AL-PADON            PIC X       VALUE '_'.
   608     12  AL-PANOF            PIC X       VALUE '-'.
   609     12  AL-PANON            PIC X       VALUE '/'.
   610     12  AL-SABOF            PIC X       VALUE '8'.
   611     12  AL-SABON            PIC X       VALUE '9'.
   612     12  AL-SADOF            PIC X       VALUE '@'.
   613     12  AL-SADON            PIC X       VALUE QUOTE.
   614     12  AL-SANOF            PIC X       VALUE '0'.
   615     12  AL-SANON            PIC X       VALUE '1'.
   616     12  AL-UABOF            PIC X       VALUE 'H'.
   617     12  AL-UABON            PIC X       VALUE 'I'.
   618     12  AL-UADOF            PIC X       VALUE '<'.
   619     12  AL-UADON            PIC X       VALUE '('.
   620     12  AL-UANOF            PIC X       VALUE ' '.
   621     12  AL-UANON            PIC X       VALUE 'A'.
   622     12  AL-UNBOF            PIC X       VALUE 'Q'.
   623     12  AL-UNBON            PIC X       VALUE 'R'.
   624     12  AL-UNDOF            PIC X       VALUE '*'.
   625     12  AL-UNDON            PIC X       VALUE ')'.
   626     12  AL-UNNOF            PIC X       VALUE '&'.
   627     12  AL-UNNON            PIC X       VALUE 'J'.
   628
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  17
* EL630.cbl
   630*    COPY ELCEMIB.
   631******************************************************************
   632*                                                                *
   633*                                                                *
   634*                            ELCEMIB.                            *
   635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   636*                            VMOD=2.005                          *
   637*                                                                *
   638*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   639*                                                                *
   640******************************************************************
   641 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   642     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   643     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   644     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   645     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   646     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   647     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   648     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   649     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   650     12  EMI-SWITCH1             PIC X        VALUE '1'.
   651         88  EMI-NO-ERRORS                    VALUE '1'.
   652         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   653         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   654     12  EMI-SWITCH2             PIC X        VALUE '1'.
   655         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   656     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   657         88  EMI-AREA1-EMPTY                  VALUE '1'.
   658         88  EMI-AREA1-FULL                   VALUE '2'.
   659     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   660         88  EMI-AREA2-EMPTY                  VALUE '1'.
   661         88  EMI-AREA2-FULL                   VALUE '2'.
   662     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   663         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   664         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   665         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   666         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   667         88  EMI-BYPASS-FATALS                VALUE 'X'.
   668     12  EMI-ERROR-LINES.
   669         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   670         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   671         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   672         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   673             20  EMI-ERR-CODES OCCURS 10 TIMES.
   674                 24  EMI-ERR-NUM         PIC X(4).
   675                 24  EMI-FILLER          PIC X.
   676                 24  EMI-SEV             PIC X.
   677                 24  FILLER              PIC X.
   678             20  FILLER                  PIC X(02).
   679     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   680         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   681             20  EMI-ERROR-NUMBER    PIC X(4).
   682             20  EMI-FILL            PIC X.
   683             20  EMI-SEVERITY        PIC X.
   684             20  FILLER              PIC X.
   685             20  EMI-ERROR-TEXT.
   686                 24  EMI-TEXT-VARIABLE   PIC X(10).
   687                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  18
* EL630.cbl
   688     12  EMI-SEVERITY-SAVE           PIC X.
   689         88  EMI-NOTE                    VALUE 'N'.
   690         88  EMI-WARNING                 VALUE 'W'.
   691         88  EMI-FORCABLE                VALUE 'F'.
   692         88  EMI-FATAL                   VALUE 'X'.
   693     12  EMI-MESSAGE-FLAG            PIC X.
   694         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   695         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   696     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   697     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   698         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   699         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   700         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   701     12  emi-claim-no                pic x(7).
   702     12  emi-claim-type              pic x(6).
   703     12  FILLER                      PIC X(124)  VALUE SPACES.
   704     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   705     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   706     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   707     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   708
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  19
* EL630.cbl
   710*    COPY ELCINTF.
   711******************************************************************
   712*                                                                *
   713*                                                                *
   714*                            ELCINTF.                            *
   715*                            VMOD=2.017                          *
   716*                                                                *
   717*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   718*                                                                *
   719*       LENGTH = 1024                                            *
   720*                                                                *
   721******************************************************************
   722*                   C H A N G E   L O G
   723*
   724* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   725*-----------------------------------------------------------------
   726*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   727* EFFECTIVE    NUMBER
   728*-----------------------------------------------------------------
   729* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   730******************************************************************
   731 01  PROGRAM-INTERFACE-BLOCK.
   732     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   733     12  PI-CALLING-PROGRAM              PIC X(8).
   734     12  PI-SAVED-PROGRAM-1              PIC X(8).
   735     12  PI-SAVED-PROGRAM-2              PIC X(8).
   736     12  PI-SAVED-PROGRAM-3              PIC X(8).
   737     12  PI-SAVED-PROGRAM-4              PIC X(8).
   738     12  PI-SAVED-PROGRAM-5              PIC X(8).
   739     12  PI-SAVED-PROGRAM-6              PIC X(8).
   740     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   741     12  PI-COMPANY-ID                   PIC XXX.
   742     12  PI-COMPANY-CD                   PIC X.
   743
   744     12  PI-COMPANY-PASSWORD             PIC X(8).
   745
   746     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   747
   748     12  PI-CONTROL-IN-PROGRESS.
   749         16  PI-CARRIER                  PIC X.
   750         16  PI-GROUPING                 PIC X(6).
   751         16  PI-STATE                    PIC XX.
   752         16  PI-ACCOUNT                  PIC X(10).
   753         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   754                                         PIC X(10).
   755         16  PI-CLAIM-CERT-GRP.
   756             20  PI-CLAIM-NO             PIC X(7).
   757             20  PI-CERT-NO.
   758                 25  PI-CERT-PRIME       PIC X(10).
   759                 25  PI-CERT-SFX         PIC X.
   760             20  PI-CERT-EFF-DT          PIC XX.
   761         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   762             20  PI-PLAN-CODE            PIC X(2).
   763             20  PI-REVISION-NUMBER      PIC X(3).
   764             20  PI-PLAN-EFF-DT          PIC X(2).
   765             20  PI-PLAN-EXP-DT          PIC X(2).
   766             20  FILLER                  PIC X(11).
   767         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  20
* EL630.cbl
   768             20  PI-OE-REFERENCE-1.
   769                 25  PI-OE-REF-1-PRIME   PIC X(18).
   770                 25  PI-OE-REF-1-SUFF    PIC XX.
   771
   772     12  PI-SESSION-IN-PROGRESS          PIC X.
   773         88  CLAIM-SESSION                   VALUE '1'.
   774         88  CREDIT-SESSION                  VALUE '2'.
   775         88  WARRANTY-SESSION                VALUE '3'.
   776         88  MORTGAGE-SESSION                VALUE '4'.
   777         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   778
   779
   780*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   781
   782     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   783     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   784
   785     12  PI-CREDIT-USER                  PIC X.
   786         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   787         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   788
   789     12  PI-CLAIM-USER                   PIC X.
   790         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   791         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   792
   793     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   794         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   795         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   796         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   797         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   798         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   799
   800     12  PI-PROCESSOR-ID                 PIC X(4).
   801
   802     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   803
   804     12  PI-MEMBER-CAPTION               PIC X(10).
   805
   806     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   807         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   808
   809     12  PI-LIFE-OVERRIDE-L1             PIC X.
   810     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   811     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   812     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   813
   814     12  PI-AH-OVERRIDE-L1               PIC X.
   815     12  PI-AH-OVERRIDE-L2               PIC XX.
   816     12  PI-AH-OVERRIDE-L6               PIC X(6).
   817     12  PI-AH-OVERRIDE-L12              PIC X(12).
   818
   819     12  PI-NEW-SYSTEM                   PIC X(2).
   820
   821     12  PI-PRIMARY-CERT-NO              PIC X(11).
   822     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   823         88  PI-USES-PAID-TO                 VALUE '1'.
   824     12  PI-CRDTCRD-SYSTEM.
   825         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  21
* EL630.cbl
   826             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   827             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   828         16  PI-CC-MONTH-END-DT          PIC XX.
   829     12  PI-PROCESSOR-PRINTER            PIC X(4).
   830
   831     12  PI-OE-REFERENCE-2.
   832         16  PI-OE-REF-2-PRIME           PIC X(10).
   833         16  PI-OE-REF-2-SUFF            PIC X.
   834
   835     12  PI-REM-TRM-CALC-OPTION          PIC X.
   836
   837     12  PI-LANGUAGE-TYPE                PIC X.
   838             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   839             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   840             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   841
   842     12  PI-POLICY-LINKAGE-IND           PIC X.
   843         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   844         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   845                                                   LOW-VALUES.
   846
   847     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   848     12  PI-CLAIM-PW-SESSION             PIC X(1).
   849         88  PI-CLAIM-CREDIT                 VALUE '1'.
   850         88  PI-CLAIM-CONVEN                 VALUE '2'.
   851
   852     12  PI-PROCESSOR-CSR-IND            PIC X.
   853         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   854         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   855
   856     12  FILLER                          PIC X(3).
   857
   858     12  PI-SYSTEM-LEVEL                 PIC X(145).
   859
   860     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   861         PI-SYSTEM-LEVEL.
   862
   863         16  PI-ENTRY-CODES.
   864             20  PI-ENTRY-CD-1           PIC X.
   865             20  PI-ENTRY-CD-2           PIC X.
   866
   867         16  PI-RETURN-CODES.
   868             20  PI-RETURN-CD-1          PIC X.
   869             20  PI-RETURN-CD-2          PIC X.
   870
   871         16  PI-UPDATE-STATUS-SAVE.
   872             20  PI-UPDATE-BY            PIC X(4).
   873             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   874
   875         16  PI-LOWER-CASE-LETTERS       PIC X.
   876             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   877
   878*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   879*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   880*            88  CARRIER-CLM-CNTL            VALUE '2'.
   881
   882         16  PI-CERT-ACCESS-CONTROL      PIC X.
   883             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  22
* EL630.cbl
   884             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   885             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   886             88  ACCNT-CNTL                  VALUE '3'.
   887             88  CARR-ACCNT-CNTL             VALUE '4'.
   888
   889         16  PI-PROCESSOR-CAP-LIST.
   890             20  PI-SYSTEM-CONTROLS.
   891                24 PI-SYSTEM-DISPLAY     PIC X.
   892                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   893                24 PI-SYSTEM-MODIFY      PIC X.
   894                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   895             20  FILLER                  PIC XX.
   896             20  PI-DISPLAY-CAP          PIC X.
   897                 88  DISPLAY-CAP             VALUE 'Y'.
   898             20  PI-MODIFY-CAP           PIC X.
   899                 88  MODIFY-CAP              VALUE 'Y'.
   900             20  PI-MSG-AT-LOGON-CAP     PIC X.
   901                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   902             20  PI-FORCE-CAP            PIC X.
   903                 88  FORCE-CAP               VALUE 'Y'.
   904
   905         16  PI-PROGRAM-CONTROLS.
   906             20  PI-PGM-PRINT-OPT        PIC X.
   907             20  PI-PGM-FORMAT-OPT       PIC X.
   908             20  PI-PGM-PROCESS-OPT      PIC X.
   909             20  PI-PGM-TOTALS-OPT       PIC X.
   910
   911         16  PI-HELP-INTERFACE.
   912             20  PI-LAST-ERROR-NO        PIC X(4).
   913             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   914
   915         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   916             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   917
   918         16  PI-CR-CONTROL-IN-PROGRESS.
   919             20  PI-CR-CARRIER           PIC X.
   920             20  PI-CR-GROUPING          PIC X(6).
   921             20  PI-CR-STATE             PIC XX.
   922             20  PI-CR-ACCOUNT           PIC X(10).
   923             20  PI-CR-FIN-RESP          PIC X(10).
   924             20  PI-CR-TYPE              PIC X.
   925
   926         16  PI-CR-BATCH-NUMBER          PIC X(6).
   927
   928         16  PI-CR-MONTH-END-DT          PIC XX.
   929
   930         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   931             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   932             88  PI-ZERO-CARRIER             VALUE '1'.
   933             88  PI-ZERO-GROUPING            VALUE '2'.
   934             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   935
   936         16  PI-CARRIER-SECURITY         PIC X.
   937             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   938
   939         16  PI-ACCOUNT-SECURITY         PIC X(10).
   940             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   941             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  23
* EL630.cbl
   942
   943         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   944             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   945                                         INDEXED BY PI-ACCESS-NDX
   946                                         PIC X.
   947
   948         16  PI-GA-BILLING-CONTROL       PIC X.
   949             88  PI-GA-BILLING               VALUE '1'.
   950
   951         16  PI-MAIL-PROCESSING          PIC X.
   952             88  PI-MAIL-YES                 VALUE 'Y'.
   953
   954         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   955
   956         16  PI-AR-SYSTEM.
   957             20  PI-AR-PROCESSING-CNTL   PIC X.
   958                 88  PI-AR-PROCESSING        VALUE 'Y'.
   959             20  PI-AR-SUMMARY-CODE      PIC X(6).
   960             20  PI-AR-MONTH-END-DT      PIC XX.
   961
   962         16  PI-MP-SYSTEM.
   963             20  PI-MORTGAGE-USER            PIC X.
   964                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   965                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   966             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   967                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   968                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   969                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   970                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   971                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   972             20  PI-MP-MONTH-END-DT          PIC XX.
   973             20  PI-MP-REFERENCE-NO.
   974                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   975                 24  PI-MP-REFERENCE-SFX     PIC XX.
   976
   977         16  PI-LABEL-CONTROL            PIC X(01).
   978             88  PI-CREATE-LABELS                    VALUE 'Y'.
   979             88  PI-BYPASS-LABELS                    VALUE 'N'.
   980
   981         16  PI-BILL-GROUPING-CODE       PIC X(01).
   982             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   983
   984         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   985             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   986             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   987
   988         16  FILLER                      PIC X(14).
   989
   990     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   991******************************************************************
   992*    COPY ELC630PI.
   993******************************************************************
   994*                                                                *
   995*                            ELC630PI                            *
   996*                            VMOD=2.014                          *
   997*                                                                *
   998* - PI-PROGRAM-WORK-AREA FOR THE DATA-ENTRY SUB-SYSTEM -         *
   999*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  24
* EL630.cbl
  1000*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  1001*                                                                *
  1002*               EL630 - EL6301 - EL6302                          *
  1003******************************************************************
  1004*                   C H A N G E   L O G
  1005*
  1006* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1007*-----------------------------------------------------------------
  1008*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1009* EFFECTIVE    NUMBER
  1010*-----------------------------------------------------------------
  1011* 072308  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  1012* 030310  CR2009031200002  PEMA  OPEN LOAN OFFICER FIELD
  1013* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1014******************************************************************
  1015
  1016     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1017         16  PI-AM-NAME                  PIC X(30).
  1018         16  PI-MAP-NAME                 PIC X(8).
  1019         16  PI-BATCH-AMOUNTS    COMP-3.
  1020             20  PI-LF-ISS-REMITTED      PIC S9(8)V99.
  1021             20  PI-LF-ISS-ENTERED       PIC S9(8)V99.
  1022             20  PI-LF-CAN-REMITTED      PIC S9(8)V99.
  1023             20  PI-LF-CAN-ENTERED       PIC S9(8)V99.
  1024             20  PI-AH-ISS-REMITTED      PIC S9(8)V99.
  1025             20  PI-AH-ISS-ENTERED       PIC S9(8)V99.
  1026             20  PI-AH-CAN-REMITTED      PIC S9(8)V99.
  1027             20  PI-AH-CAN-ENTERED       PIC S9(8)V99.
  1028             20  PI-ISS-CNT-REMITTED     PIC S9(5).
  1029             20  PI-ISS-CNT-ENTERED      PIC S9(5).
  1030             20  PI-CAN-CNT-REMITTED     PIC S9(5).
  1031             20  PI-CAN-CNT-ENTERED      PIC S9(5).
  1032         16  PI-MAINT-FUNC               PIC X.
  1033         16  PI-ERROR-SW                 PIC X.
  1034             88  PI-DATA-ERRORS              VALUE 'Y'.
  1035         16  PI-UPDATE-SW                PIC X.
  1036             88  PI-DATA-UPDATED             VALUE 'Y'.
  1037         16  PI-DISPLAY-SW               PIC X.
  1038             88  PI-LAST-FUNC-DISPLAY        VALUE 'Y'.
  1039         16  PI-SAVE-CALLING-PGM         PIC X(8).
  1040         16  PI-LAST-SEQ-NO-ADDED        PIC S9(4) COMP.
  1041         16  PI-NEXT-DISPLAY-SEQ-NO      PIC S9(4) COMP.
  1042         16  PI-SAV-CARRIER              PIC X.
  1043         16  PI-SAV-GROUPING             PIC X(6).
  1044         16  PI-SAV-STATE                PIC XX.
  1045         16  PI-SAV-ACCOUNT              PIC X(10).
  1046         16  PI-SAV-CERT-EFF-DT          PIC XX.
  1047         16  PI-SAV-CERT-NO.
  1048             20  PI-SAV-CERT-PRIME       PIC X(14).
  1049             20  PI-SAV-CERT-SFX         PIC X.
  1050         16  PI-PYAJ-REFERENCE REDEFINES PI-SAV-CERT-NO.
  1051             20  PI-SAV-PYAJ-REFERENCE   PIC X(12).
  1052             20  FILLER                  PIC X(3).
  1053         16  PI-SAV-ENDING-ERPNDB-KEY.
  1054             20  PI-SAV-COMP-CD          PIC X.
  1055             20  PI-SAV-ENTRY-BATCH      PIC X(6).
  1056             20  PI-SAV-BATCH-SEQ        PIC S9(4) COMP.
  1057             20  PI-SAV-BATCH-CHG-SEQ    PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  25
* EL630.cbl
  1058         16  PI-SAV-REFERENCE            PIC X(12).
  1059         16  PI-SAV-FULL-CONTROL.
  1060             20  PI-SAV-FC-CARRIER       PIC X.
  1061             20  PI-SAV-FC-GROUPING      PIC X(6).
  1062             20  PI-SAV-FC-STATE         PIC XX.
  1063         16  PI-VERIFY-DELETE-SW         PIC X.
  1064             88  PI-DELETE-IS-OK             VALUE 'Y'.
  1065         16  PI-EL630-FIRST-TIME-SW      PIC X.
  1066             88  PI-EL630-FIRST-TIME         VALUE SPACE.
  1067         16  PI-CREDIT-EDIT-CONTROLS.
  1068             20  PI-MIN-PREMIUM          PIC S9(3)V99  COMP-3.
  1069             20  PI-MIN-AGE              PIC 99.
  1070             20  PI-DEFAULT-AGE          PIC 99.
  1071             20  PI-MIN-TERM             PIC S9(3)     COMP-3.
  1072             20  PI-MAX-TERM             PIC S9(3)     COMP-3.
  1073             20  PI-DEFAULT-SEX          PIC X.
  1074             20  PI-JOINT-AGE-INPUT      PIC X.
  1075                 88 PI-JOINT-AGE-IS-INPUT       VALUE '1'.
  1076             20  PI-BIRTH-DATE-INPUT     PIC X.
  1077                 88 PI-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1078         16  PI-KEYED-SWITCHES.
  1079             20  PI-ISS-SUFFIX-KEYED-SW  PIC X.
  1080                 88  PI-ISS-SUFFIX-KEYED     VALUE 'Y'.
  1081             20  PI-CAN-SUFFIX-KEYED-SW  PIC X.
  1082                 88  PI-CAN-SUFFIX-KEYED     VALUE 'Y'.
  1083             20  PI-IG-KEYED-SW          PIC X.
  1084                 88  PI-IG-KEYED             VALUE 'Y'.
  1085             20  PI-APR-KEYED-SW         PIC X.
  1086                 88  PI-APR-KEYED            VALUE 'Y'.
  1087*            20  PI-FREQ-KEYED-SW        PIC X.
  1088*                88  PI-FREQ-KEYED           VALUE 'Y'.
  1089             20  PI-VIN-KEYED-SW         PIC X.
  1090                 88  PI-VIN-KEYED            VALUE 'Y'.
  1091             20  PI-SIG-KEYED-SW         PIC X.
  1092                 88  PI-SIG-KEYED            VALUE 'Y'.
  1093             20  PI-LFRT-KEYED-SW        PIC X.
  1094                 88  PI-LFRT-KEYED           VALUE 'Y'.
  1095             20  PI-AHRT-KEYED-SW        PIC X.
  1096                 88  PI-AHRT-KEYED           VALUE 'Y'.
  1097             20  PI-SSNUM-KEYED-SW       PIC X.
  1098                 88  PI-SSNUM-KEYED          VALUE 'Y'.
  1099             20  PI-JNT-SSNUM-KEYED-SW   PIC X.
  1100                 88  PI-JNT-SSNUM-KEYED      VALUE 'Y'.
  1101             20  PI-MEMBER-KEYED-SW      PIC X.
  1102                 88  PI-MEMBER-KEYED         VALUE 'Y'.
  1103             20  PI-MODE-KEYED-SW        PIC X.
  1104                 88  PI-MODE-KEYED           VALUE 'Y'.
  1105             20  PI-PMTS-KEYED-SW        PIC X.
  1106                 88  PI-PMTS-KEYED           VALUE 'Y'.
  1107             20  PI-LN-OFFICER-KEYED-SW  PIC X.
  1108                 88  PI-LN-OFFICER-KEYED     VALUE 'Y'.
  1109             20  PI-ENTRY-KEYED-SW       PIC X.
  1110                 88  PI-ENTRY-KEYED          VALUE 'Y'.
  1111             20  PI-FORCE-KEYED-SW       PIC X.
  1112                 88  PI-FORCE-KEYED          VALUE 'Y'.
  1113             20  PI-RINCD-KEYED-SW       PIC X.
  1114                 88  PI-RINCD-KEYED          VALUE 'Y'.
  1115             20  PI-BILLCD-KEYED-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  26
* EL630.cbl
  1116                 88  PI-BILLCD-KEYED         VALUE 'Y'.
  1117             20  PI-RTCLS-KEYED-SW       PIC X.
  1118                 88  PI-RTCLS-KEYED          VALUE 'Y'.
  1119             20  PI-LNTRM-KEYED-SW       PIC X.
  1120                 88  PI-LNTRM-KEYED          VALUE 'Y'.
  1121             20  PI-EXPIR-KEYED-SW       PIC X.
  1122                 88  PI-EXPIR-KEYED          VALUE 'Y'.
  1123             20  PI-PMT-KEYED-SW         PIC X.
  1124                 88  PI-PMT-KEYED            VALUE 'Y'.
  1125             20  PI-1ST-PMT-KEYED-SW     PIC X.
  1126                 88  PI-1ST-PMT-KEYED        VALUE 'Y'.
  1127             20  PI-DAYS-KEYED-SW        PIC X.
  1128                 88  PI-DAYS-KEYED           VALUE 'Y'.
  1129             20  PI-SKPCD-KEYED-SW       PIC X.
  1130                 88  PI-SKPCD-KEYED          VALUE 'Y'.
  1131             20  PI-JNT-AGE-KEYED-SW     PIC X.
  1132                 88  PI-JNT-AGE-KEYED        VALUE 'Y'.
  1133             20  PI-JNT-NAME-KEYED-SW    PIC X.
  1134                 88  PI-JNT-NAME-KEYED       VALUE 'Y'.
  1135             20  PI-ISS-LIVES-KEYED-SW   PIC X.
  1136                 88  PI-ISS-LIVES-KEYED      VALUE 'Y'.
  1137             20  PI-CAN-LIVES-KEYED-SW   PIC X.
  1138                 88  PI-CAN-LIVES-KEYED      VALUE 'Y'.
  1139             20  PI-PAYEE-KEYED-SW       PIC X.
  1140                 88  PI-PAYEE-KEYED          VALUE 'Y'.
  1141             20  PI-CHK-REQ-KEYED-SW     PIC X.
  1142                 88  PI-CHK-REQ-KEYED        VALUE 'Y'.
  1143             20  PI-ZIP4-KEYED-SW        PIC X.
  1144                 88  PI-ZIP4-KEYED           VALUE 'Y'.
  1145             20  PI-POLICY-KEYED-SW      PIC X.
  1146                 88  PI-POLICY-KEYED         VALUE 'Y'.
  1147             20  PI-EXPIRE-KEYED-SW      PIC X.
  1148                 88  PI-EXPIRE-KEYED         VALUE 'Y'.
  1149             20  PI-CRIT-PERD-KEYED-SW    PIC X.
  1150                 88  PI-CRIT-PERD-KEYED      VALUE 'Y'.
  1151             20  PI-BENEFICIARY-KEYED-SW PIC X.
  1152                 88  PI-BENEFICIARY-KEYED    VALUE 'Y'.
  1153             20  PI-PHONE-KEYED-SW       PIC X.
  1154                 88  PI-PHONE-KEYED          VALUE 'Y'.
  1155             20  PI-ALT-BEN-KEYED-SW     PIC X.
  1156                 88  PI-ALT-BEN-KEYED        VALUE 'Y'.
  1157             20  PI-ALT-PREM-KEYED-SW    PIC X.
  1158                 88  PI-ALT-PREM-KEYED       VALUE 'Y'.
  1159             20  PI-REFUND-MTHD-KEYED-SW PIC X.
  1160                 88  PI-REFUND-MTHD-KEYED    VALUE 'Y'.
  1161         16  PI-ACCT-LOW-EFF-DT          PIC XX.
  1162         16  PI-ACCT-HIGH-EXP-DT         PIC XX.
  1163         16  PI-BATCH-EOF-SW             PIC X.
  1164             88  PI-BATCH-EOF                VALUE 'Y'.
  1165         16  PI-NB-MONTH-END-DT          PIC XX.
  1166         16  PI-ISSUE-ADDED-SW           PIC X.
  1167             88  PI-ISSUE-ADDED              VALUE 'Y'.
  1168         16  PI-BROWSE-SW                PIC X.
  1169             88  PI-BROWSE                   VALUE 'Y'.
  1170         16  PI-ACCT-AGENT-ERROR-SW      PIC X.
  1171             88  PI-ACCT-AGENT-ERROR         VALUE 'Y'.
  1172         16  PI-FIN-RESP-ERROR-SW        PIC X.
  1173             88  PI-FIN-RESP-ERROR           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  27
* EL630.cbl
  1174         16  PI-CAN-REA-KEYED-SW         PIC X.
  1175             88  PI-CAN-REA-KEYED            VALUE 'Y'.
  1176         16  PI-AM-EDIT-LOAN-OFC         PIC X.
  1177         16  PI-AM-ADDR1                 PIC X(30).
  1178         16  PI-AM-ADDR2                 PIC X(30).
  1179         16  PI-AM-CITYST.
  1180             20  PI-AM-CITY              PIC X(28).
  1181             20  PI-AM-STATE             PIC XX.
  1182         16  PI-AM-ZIP                   PIC X(9).
  1183         16  FILLER                      PIC X(290).
  1184*        16  FILLER                      PIC X(390).
  1185     12  PI-MISC.
  1186         16  PI-ACCT-DATE-RANGES OCCURS 32 TIMES.
  1187             20  PI-ACCT-EFF-DT          PIC XX.
  1188             20  PI-ACCT-EXP-DT          PIC XX.
  1189             20  PI-REMIT-AGENT          PIC X(10).
  1190             20  PI-ACCT-AGENT           PIC X(10).
  1191         16  PI-ACCOUNT-AGENT            PIC X(10).
  1192         16  PI-FIN-RESP                 PIC X(10).
  1193         16  PI-SUMMARY-CODE             PIC X(6).
  1194         16  PI-SUB                      PIC S9(4) COMP.
  1195         16  PI-COMP-CARRIER             PIC X.
  1196         16  PI-COMP-GROUPING            PIC X(6).
  1197         16  PI-ACCT-AGENT-PROCESSED-SW  PIC X.
  1198             88  PI-ACCT-AGENT-PROCESSED     VALUE 'Y'.
  1199         16  PI-CLEAR-ERROR-SW           PIC X.
  1200             88  PI-CLEAR-ERROR              VALUE 'Y'.
  1201         16  PI-AGE-KEYED-SW             PIC X.
  1202             88  PI-AGE-KEYED                VALUE 'Y'.
  1203         16  PI-BIRTHDT-KEYED-SW         PIC X.
  1204             88  PI-BIRTHDT-KEYED            VALUE 'Y'.
  1205         16  PI-RECEIVED-DT              PIC XX.
  1206         16  PI-CSR-ID                   PIC X(4).
  1207
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  28
* EL630.cbl
  1209          16  FILLER              PIC X(390).
  1210
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  29
* EL630.cbl
  1212*    COPY ELCAID.
  1213******************************************************************
  1214*                                                                *
  1215*                            ELCAID.                             *
  1216*                            VMOD=2.001                          *
  1217*                                                                *
  1218*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1219*                                                                *
  1220*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1221*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1222******************************************************************
  1223
  1224 01  DFHAID.
  1225   02  DFHNULL   PIC  X  VALUE  ' '.
  1226   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1227   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1228   02  DFHPEN    PIC  X  VALUE  '='.
  1229   02  DFHOPID   PIC  X  VALUE  'W'.
  1230   02  DFHPA1    PIC  X  VALUE  '%'.
  1231   02  DFHPA2    PIC  X  VALUE  '>'.
  1232   02  DFHPA3    PIC  X  VALUE  ','.
  1233   02  DFHPF1    PIC  X  VALUE  '1'.
  1234   02  DFHPF2    PIC  X  VALUE  '2'.
  1235   02  DFHPF3    PIC  X  VALUE  '3'.
  1236   02  DFHPF4    PIC  X  VALUE  '4'.
  1237   02  DFHPF5    PIC  X  VALUE  '5'.
  1238   02  DFHPF6    PIC  X  VALUE  '6'.
  1239   02  DFHPF7    PIC  X  VALUE  '7'.
  1240   02  DFHPF8    PIC  X  VALUE  '8'.
  1241   02  DFHPF9    PIC  X  VALUE  '9'.
  1242   02  DFHPF10   PIC  X  VALUE  ':'.
  1243   02  DFHPF11   PIC  X  VALUE  '#'.
  1244   02  DFHPF12   PIC  X  VALUE  '@'.
  1245   02  DFHPF13   PIC  X  VALUE  'A'.
  1246   02  DFHPF14   PIC  X  VALUE  'B'.
  1247   02  DFHPF15   PIC  X  VALUE  'C'.
  1248   02  DFHPF16   PIC  X  VALUE  'D'.
  1249   02  DFHPF17   PIC  X  VALUE  'E'.
  1250   02  DFHPF18   PIC  X  VALUE  'F'.
  1251   02  DFHPF19   PIC  X  VALUE  'G'.
  1252   02  DFHPF20   PIC  X  VALUE  'H'.
  1253   02  DFHPF21   PIC  X  VALUE  'I'.
  1254*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1255   02  DFHPF22   PIC  X  VALUE  '['.
  1256   02  DFHPF23   PIC  X  VALUE  '.'.
  1257   02  DFHPF24   PIC  X  VALUE  '<'.
  1258   02  DFHMSRE   PIC  X  VALUE  'X'.
  1259   02  DFHSTRF   PIC  X  VALUE  'h'.
  1260   02  DFHTRIG   PIC  X  VALUE  '"'.
  1261 01  FILLER    REDEFINES DFHAID.
  1262     12  FILLER              PIC X(8).
  1263     12  PF-VALUES           PIC X       OCCURS 2.
  1264     12  FILLER              PIC X(25).
  1265
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  30
* EL630.cbl
  1267*    COPY EL630S.
  1268 01  EL630AI.
  1269     05  FILLER            PIC  X(0012).
  1270*    -------------------------------
  1271     05  DATEL PIC S9(0004) COMP.
  1272     05  DATEF PIC  X(0001).
  1273     05  FILLER REDEFINES DATEF.
  1274         10  DATEA PIC  X(0001).
  1275     05  DATEI PIC  X(0008).
  1276*    -------------------------------
  1277     05  TIMEL PIC S9(0004) COMP.
  1278     05  TIMEF PIC  X(0001).
  1279     05  FILLER REDEFINES TIMEF.
  1280         10  TIMEA PIC  X(0001).
  1281     05  TIMEI PIC  X(0005).
  1282*    -------------------------------
  1283     05  MAINTL PIC S9(0004) COMP.
  1284     05  MAINTF PIC  X(0001).
  1285     05  FILLER REDEFINES MAINTF.
  1286         10  MAINTA PIC  X(0001).
  1287     05  MAINTI PIC  X(0001).
  1288*    -------------------------------
  1289     05  REFHDGL PIC S9(0004) COMP.
  1290     05  REFHDGF PIC  X(0001).
  1291     05  FILLER REDEFINES REFHDGF.
  1292         10  REFHDGA PIC  X(0001).
  1293     05  REFHDGI PIC  X(0015).
  1294*    -------------------------------
  1295     05  CARRHDGL PIC S9(0004) COMP.
  1296     05  CARRHDGF PIC  X(0001).
  1297     05  FILLER REDEFINES CARRHDGF.
  1298         10  CARRHDGA PIC  X(0001).
  1299     05  CARRHDGI PIC  X(0007).
  1300*    -------------------------------
  1301     05  GRPHDGL PIC S9(0004) COMP.
  1302     05  GRPHDGF PIC  X(0001).
  1303     05  FILLER REDEFINES GRPHDGF.
  1304         10  GRPHDGA PIC  X(0001).
  1305     05  GRPHDGI PIC  X(0008).
  1306*    -------------------------------
  1307     05  STHDGL PIC S9(0004) COMP.
  1308     05  STHDGF PIC  X(0001).
  1309     05  FILLER REDEFINES STHDGF.
  1310         10  STHDGA PIC  X(0001).
  1311     05  STHDGI PIC  X(0005).
  1312*    -------------------------------
  1313     05  BATCHL PIC S9(0004) COMP.
  1314     05  BATCHF PIC  X(0001).
  1315     05  FILLER REDEFINES BATCHF.
  1316         10  BATCHA PIC  X(0001).
  1317     05  BATCHI PIC  X(0006).
  1318*    -------------------------------
  1319     05  REFL PIC S9(0004) COMP.
  1320     05  REFF PIC  X(0001).
  1321     05  FILLER REDEFINES REFF.
  1322         10  REFA PIC  X(0001).
  1323     05  REFI PIC  X(0012).
  1324*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  31
* EL630.cbl
  1325     05  CARRIERL PIC S9(0004) COMP.
  1326     05  CARRIERF PIC  X(0001).
  1327     05  FILLER REDEFINES CARRIERF.
  1328         10  CARRIERA PIC  X(0001).
  1329     05  CARRIERI PIC  X(0001).
  1330*    -------------------------------
  1331     05  GROUPL PIC S9(0004) COMP.
  1332     05  GROUPF PIC  X(0001).
  1333     05  FILLER REDEFINES GROUPF.
  1334         10  GROUPA PIC  X(0001).
  1335     05  GROUPI PIC  X(0006).
  1336*    -------------------------------
  1337     05  STATEL PIC S9(0004) COMP.
  1338     05  STATEF PIC  X(0001).
  1339     05  FILLER REDEFINES STATEF.
  1340         10  STATEA PIC  X(0001).
  1341     05  STATEI PIC  X(0002).
  1342*    -------------------------------
  1343     05  ACCOUNTL PIC S9(0004) COMP.
  1344     05  ACCOUNTF PIC  X(0001).
  1345     05  FILLER REDEFINES ACCOUNTF.
  1346         10  ACCOUNTA PIC  X(0001).
  1347     05  ACCOUNTI PIC  X(0010).
  1348*    -------------------------------
  1349     05  LFPHDGL PIC S9(0004) COMP.
  1350     05  LFPHDGF PIC  X(0001).
  1351     05  FILLER REDEFINES LFPHDGF.
  1352         10  LFPHDGA PIC  X(0001).
  1353     05  LFPHDGI PIC  X(0010).
  1354*    -------------------------------
  1355     05  AHPHDGL PIC S9(0004) COMP.
  1356     05  AHPHDGF PIC  X(0001).
  1357     05  FILLER REDEFINES AHPHDGF.
  1358         10  AHPHDGA PIC  X(0001).
  1359     05  AHPHDGI PIC  X(0010).
  1360*    -------------------------------
  1361     05  LFRHDGL PIC S9(0004) COMP.
  1362     05  LFRHDGF PIC  X(0001).
  1363     05  FILLER REDEFINES LFRHDGF.
  1364         10  LFRHDGA PIC  X(0001).
  1365     05  LFRHDGI PIC  X(0009).
  1366*    -------------------------------
  1367     05  AHRHDGL PIC S9(0004) COMP.
  1368     05  AHRHDGF PIC  X(0001).
  1369     05  FILLER REDEFINES AHRHDGF.
  1370         10  AHRHDGA PIC  X(0001).
  1371     05  AHRHDGI PIC  X(0009).
  1372*    -------------------------------
  1373     05  EISSCNTL PIC S9(0004) COMP.
  1374     05  EISSCNTF PIC  X(0001).
  1375     05  FILLER REDEFINES EISSCNTF.
  1376         10  EISSCNTA PIC  X(0001).
  1377     05  EISSCNTI PIC  S9(6).
  1378*    -------------------------------
  1379     05  ELFISSL PIC S9(0004) COMP.
  1380     05  ELFISSF PIC  X(0001).
  1381     05  FILLER REDEFINES ELFISSF.
  1382         10  ELFISSA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  32
* EL630.cbl
  1383     05  ELFISSI PIC  S9(10)V9(2).
  1384*    -------------------------------
  1385     05  EAHISSL PIC S9(0004) COMP.
  1386     05  EAHISSF PIC  X(0001).
  1387     05  FILLER REDEFINES EAHISSF.
  1388         10  EAHISSA PIC  X(0001).
  1389     05  EAHISSI PIC  S9(10)V9(2).
  1390*    -------------------------------
  1391     05  ECANCNTL PIC S9(0004) COMP.
  1392     05  ECANCNTF PIC  X(0001).
  1393     05  FILLER REDEFINES ECANCNTF.
  1394         10  ECANCNTA PIC  X(0001).
  1395     05  ECANCNTI PIC  S9(6).
  1396*    -------------------------------
  1397     05  ELFCANL PIC S9(0004) COMP.
  1398     05  ELFCANF PIC  X(0001).
  1399     05  FILLER REDEFINES ELFCANF.
  1400         10  ELFCANA PIC  X(0001).
  1401     05  ELFCANI PIC  S9(8)V9(2).
  1402*    -------------------------------
  1403     05  EAHCANL PIC S9(0004) COMP.
  1404     05  EAHCANF PIC  X(0001).
  1405     05  FILLER REDEFINES EAHCANF.
  1406         10  EAHCANA PIC  X(0001).
  1407     05  EAHCANI PIC  S9(8)V9(2).
  1408*    -------------------------------
  1409     05  AISSCNTL PIC S9(0004) COMP.
  1410     05  AISSCNTF PIC  X(0001).
  1411     05  FILLER REDEFINES AISSCNTF.
  1412         10  AISSCNTA PIC  X(0001).
  1413     05  AISSCNTI PIC  S9(6).
  1414*    -------------------------------
  1415     05  ALFISSL PIC S9(0004) COMP.
  1416     05  ALFISSF PIC  X(0001).
  1417     05  FILLER REDEFINES ALFISSF.
  1418         10  ALFISSA PIC  X(0001).
  1419     05  ALFISSI PIC  S9(10)V9(2).
  1420*    -------------------------------
  1421     05  AAHISSL PIC S9(0004) COMP.
  1422     05  AAHISSF PIC  X(0001).
  1423     05  FILLER REDEFINES AAHISSF.
  1424         10  AAHISSA PIC  X(0001).
  1425     05  AAHISSI PIC  S9(10)V9(2).
  1426*    -------------------------------
  1427     05  ACANCNTL PIC S9(0004) COMP.
  1428     05  ACANCNTF PIC  X(0001).
  1429     05  FILLER REDEFINES ACANCNTF.
  1430         10  ACANCNTA PIC  X(0001).
  1431     05  ACANCNTI PIC  S9(6).
  1432*    -------------------------------
  1433     05  ALFCANL PIC S9(0004) COMP.
  1434     05  ALFCANF PIC  X(0001).
  1435     05  FILLER REDEFINES ALFCANF.
  1436         10  ALFCANA PIC  X(0001).
  1437     05  ALFCANI PIC  S9(8)V9(2).
  1438*    -------------------------------
  1439     05  AAHCANL PIC S9(0004) COMP.
  1440     05  AAHCANF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  33
* EL630.cbl
  1441     05  FILLER REDEFINES AAHCANF.
  1442         10  AAHCANA PIC  X(0001).
  1443     05  AAHCANI PIC  S9(8)V9(2).
  1444*    -------------------------------
  1445     05  OISSCNTL PIC S9(0004) COMP.
  1446     05  OISSCNTF PIC  X(0001).
  1447     05  FILLER REDEFINES OISSCNTF.
  1448         10  OISSCNTA PIC  X(0001).
  1449     05  OISSCNTI PIC  S9(6).
  1450*    -------------------------------
  1451     05  OLFISSL PIC S9(0004) COMP.
  1452     05  OLFISSF PIC  X(0001).
  1453     05  FILLER REDEFINES OLFISSF.
  1454         10  OLFISSA PIC  X(0001).
  1455     05  OLFISSI PIC  S9(10)V9(2).
  1456*    -------------------------------
  1457     05  OAHISSL PIC S9(0004) COMP.
  1458     05  OAHISSF PIC  X(0001).
  1459     05  FILLER REDEFINES OAHISSF.
  1460         10  OAHISSA PIC  X(0001).
  1461     05  OAHISSI PIC  S9(10)V9(2).
  1462*    -------------------------------
  1463     05  OCANCNTL PIC S9(0004) COMP.
  1464     05  OCANCNTF PIC  X(0001).
  1465     05  FILLER REDEFINES OCANCNTF.
  1466         10  OCANCNTA PIC  X(0001).
  1467     05  OCANCNTI PIC  S9(6).
  1468*    -------------------------------
  1469     05  OLFCANL PIC S9(0004) COMP.
  1470     05  OLFCANF PIC  X(0001).
  1471     05  FILLER REDEFINES OLFCANF.
  1472         10  OLFCANA PIC  X(0001).
  1473     05  OLFCANI PIC  S9(8)V9(2).
  1474*    -------------------------------
  1475     05  OAHCANL PIC S9(0004) COMP.
  1476     05  OAHCANF PIC  X(0001).
  1477     05  FILLER REDEFINES OAHCANF.
  1478         10  OAHCANA PIC  X(0001).
  1479     05  OAHCANI PIC  S9(8)V9(2).
  1480*    -------------------------------
  1481     05  RECEVDTL PIC S9(0004) COMP.
  1482     05  RECEVDTF PIC  X(0001).
  1483     05  FILLER REDEFINES RECEVDTF.
  1484         10  RECEVDTA PIC  X(0001).
  1485     05  RECEVDTI PIC  X(0008).
  1486*    -------------------------------
  1487     05  MNTHNDTL PIC S9(0004) COMP.
  1488     05  MNTHNDTF PIC  X(0001).
  1489     05  FILLER REDEFINES MNTHNDTF.
  1490         10  MNTHNDTA PIC  X(0001).
  1491     05  MNTHNDTI PIC  X(0008).
  1492*    -------------------------------
  1493     05  ERRMSG1L PIC S9(0004) COMP.
  1494     05  ERRMSG1F PIC  X(0001).
  1495     05  FILLER REDEFINES ERRMSG1F.
  1496         10  ERRMSG1A PIC  X(0001).
  1497     05  ERRMSG1I PIC  X(0076).
  1498*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  34
* EL630.cbl
  1499     05  ERRMSG2L PIC S9(0004) COMP.
  1500     05  ERRMSG2F PIC  X(0001).
  1501     05  FILLER REDEFINES ERRMSG2F.
  1502         10  ERRMSG2A PIC  X(0001).
  1503     05  ERRMSG2I PIC  X(0076).
  1504*    -------------------------------
  1505     05  PFENTERL PIC S9(0004) COMP.
  1506     05  PFENTERF PIC  X(0001).
  1507     05  FILLER REDEFINES PFENTERF.
  1508         10  PFENTERA PIC  X(0001).
  1509     05  PFENTERI PIC  9(2).
  1510*    -------------------------------
  1511     05  PF5L PIC S9(0004) COMP.
  1512     05  PF5F PIC  X(0001).
  1513     05  FILLER REDEFINES PF5F.
  1514         10  PF5A PIC  X(0001).
  1515     05  PF5I PIC  X(0015).
  1516 01  EL630AO REDEFINES EL630AI.
  1517     05  FILLER            PIC  X(0012).
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  DATEO PIC  X(0008).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
  1523     05  TIMEO PIC  99.99.
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  MAINTO PIC  X(0001).
  1527*    -------------------------------
  1528     05  FILLER            PIC  X(0003).
  1529     05  REFHDGO PIC  X(0015).
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  CARRHDGO PIC  X(0007).
  1533*    -------------------------------
  1534     05  FILLER            PIC  X(0003).
  1535     05  GRPHDGO PIC  X(0008).
  1536*    -------------------------------
  1537     05  FILLER            PIC  X(0003).
  1538     05  STHDGO PIC  X(0005).
  1539*    -------------------------------
  1540     05  FILLER            PIC  X(0003).
  1541     05  BATCHO PIC  X(0006).
  1542*    -------------------------------
  1543     05  FILLER            PIC  X(0003).
  1544     05  REFO PIC  X(0012).
  1545*    -------------------------------
  1546     05  FILLER            PIC  X(0003).
  1547     05  CARRIERO PIC  X(0001).
  1548*    -------------------------------
  1549     05  FILLER            PIC  X(0003).
  1550     05  GROUPO PIC  X(0006).
  1551*    -------------------------------
  1552     05  FILLER            PIC  X(0003).
  1553     05  STATEO PIC  X(0002).
  1554*    -------------------------------
  1555     05  FILLER            PIC  X(0003).
  1556     05  ACCOUNTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  35
* EL630.cbl
  1557*    -------------------------------
  1558     05  FILLER            PIC  X(0003).
  1559     05  LFPHDGO PIC  X(0010).
  1560*    -------------------------------
  1561     05  FILLER            PIC  X(0003).
  1562     05  AHPHDGO PIC  X(0010).
  1563*    -------------------------------
  1564     05  FILLER            PIC  X(0003).
  1565     05  LFRHDGO PIC  X(0009).
  1566*    -------------------------------
  1567     05  FILLER            PIC  X(0003).
  1568     05  AHRHDGO PIC  X(0009).
  1569*    -------------------------------
  1570     05  FILLER            PIC  X(0003).
  1571     05  EISSCNTO PIC  Z(5)-.
  1572*    -------------------------------
  1573     05  FILLER            PIC  X(0003).
  1574     05  ELFISSO PIC  Z(8).99-.
  1575*    -------------------------------
  1576     05  FILLER            PIC  X(0003).
  1577     05  EAHISSO PIC  Z(8).99-.
  1578*    -------------------------------
  1579     05  FILLER            PIC  X(0003).
  1580     05  ECANCNTO PIC  Z(5)-.
  1581*    -------------------------------
  1582     05  FILLER            PIC  X(0003).
  1583     05  ELFCANO PIC  Z(6).99-.
  1584*    -------------------------------
  1585     05  FILLER            PIC  X(0003).
  1586     05  EAHCANO PIC  Z(6).99-.
  1587*    -------------------------------
  1588     05  FILLER            PIC  X(0003).
  1589     05  AISSCNTO PIC  Z(5)-.
  1590*    -------------------------------
  1591     05  FILLER            PIC  X(0003).
  1592     05  ALFISSO PIC  Z(8).99-.
  1593*    -------------------------------
  1594     05  FILLER            PIC  X(0003).
  1595     05  AAHISSO PIC  Z(8).99-.
  1596*    -------------------------------
  1597     05  FILLER            PIC  X(0003).
  1598     05  ACANCNTO PIC  Z(5)-.
  1599*    -------------------------------
  1600     05  FILLER            PIC  X(0003).
  1601     05  ALFCANO PIC  Z(6).99-.
  1602*    -------------------------------
  1603     05  FILLER            PIC  X(0003).
  1604     05  AAHCANO PIC  Z(6).99-.
  1605*    -------------------------------
  1606     05  FILLER            PIC  X(0003).
  1607     05  OISSCNTO PIC  Z(5)-.
  1608*    -------------------------------
  1609     05  FILLER            PIC  X(0003).
  1610     05  OLFISSO PIC  Z(8).99-.
  1611*    -------------------------------
  1612     05  FILLER            PIC  X(0003).
  1613     05  OAHISSO PIC  Z(8).99-.
  1614*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  36
* EL630.cbl
  1615     05  FILLER            PIC  X(0003).
  1616     05  OCANCNTO PIC  Z(5)-.
  1617*    -------------------------------
  1618     05  FILLER            PIC  X(0003).
  1619     05  OLFCANO PIC  Z(6).99-.
  1620*    -------------------------------
  1621     05  FILLER            PIC  X(0003).
  1622     05  OAHCANO PIC  Z(6).99-.
  1623*    -------------------------------
  1624     05  FILLER            PIC  X(0003).
  1625     05  RECEVDTO PIC  X(0008).
  1626*    -------------------------------
  1627     05  FILLER            PIC  X(0003).
  1628     05  MNTHNDTO PIC  X(0008).
  1629*    -------------------------------
  1630     05  FILLER            PIC  X(0003).
  1631     05  ERRMSG1O PIC  X(0076).
  1632*    -------------------------------
  1633     05  FILLER            PIC  X(0003).
  1634     05  ERRMSG2O PIC  X(0076).
  1635*    -------------------------------
  1636     05  FILLER            PIC  X(0003).
  1637     05  PFENTERO PIC  X(0002).
  1638*    -------------------------------
  1639     05  FILLER            PIC  X(0003).
  1640     05  PF5O PIC  X(0015).
  1641*    -------------------------------
  1642
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  37
* EL630.cbl
  1644****************************************************************
  1645*
  1646* Copyright (c) 2007-2013 Dell Inc.
  1647* All rights reserved.
  1648*
  1649****************************************************************
  1650 01  DFHEIV.
  1651   02  DFHEIV0               PIC X(35).
  1652   02  DFHEIV1               PIC X(08).
  1653   02  DFHEIV2               PIC X(08).
  1654   02  DFHEIV3               PIC X(08).
  1655   02  DFHEIV4               PIC X(06).
  1656   02  DFHEIV5               PIC X(04).
  1657   02  DFHEIV6               PIC X(04).
  1658   02  DFHEIV7               PIC X(02).
  1659   02  DFHEIV8               PIC X(02).
  1660   02  DFHEIV9               PIC X(01).
  1661   02  DFHEIV10              PIC S9(7) COMP-3.
  1662   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1663   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1664   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1665   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1666   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1667   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1668   02  DFHEIV17              PIC X(04).
  1669   02  DFHEIV18              PIC X(04).
  1670   02  DFHEIV19              PIC X(04).
  1671   02  DFHEIV20              USAGE IS POINTER.
  1672   02  DFHEIV21              USAGE IS POINTER.
  1673   02  DFHEIV22              USAGE IS POINTER.
  1674   02  DFHEIV23              USAGE IS POINTER.
  1675   02  DFHEIV24              USAGE IS POINTER.
  1676   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1677   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1678   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1679   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1680   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1681   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1682   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1683   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1684   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1685   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1686   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1687   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1688   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1689   02  FILLER                PIC X(02).
  1690   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1691   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1692   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1693   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1694   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1695   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1696   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1697 LINKAGE  SECTION.
  1698*****************************************************************
  1699*                                                               *
  1700* Copyright (c) 2007-2013 Dell Inc.                             *
  1701* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  38
* EL630.cbl
  1702*                                                               *
  1703*****************************************************************
  1704 01  dfheiblk.
  1705     02  eibtime          pic s9(7) comp-3.
  1706     02  eibdate          pic s9(7) comp-3.
  1707     02  eibtrnid         pic x(4).
  1708     02  eibtaskn         pic s9(7) comp-3.
  1709     02  eibtrmid         pic x(4).
  1710     02  dfheigdi         pic s9(4) comp.
  1711     02  eibcposn         pic s9(4) comp.
  1712     02  eibcalen         pic s9(4) comp.
  1713     02  eibaid           pic x(1).
  1714     02  eibfiller1       pic x(1).
  1715     02  eibfn            pic x(2).
  1716     02  eibfiller2       pic x(2).
  1717     02  eibrcode         pic x(6).
  1718     02  eibfiller3       pic x(2).
  1719     02  eibds            pic x(8).
  1720     02  eibreqid         pic x(8).
  1721     02  eibrsrce         pic x(8).
  1722     02  eibsync          pic x(1).
  1723     02  eibfree          pic x(1).
  1724     02  eibrecv          pic x(1).
  1725     02  eibsend          pic x(1).
  1726     02  eibatt           pic x(1).
  1727     02  eibeoc           pic x(1).
  1728     02  eibfmh           pic x(1).
  1729     02  eibcompl         pic x(1).
  1730     02  eibsig           pic x(1).
  1731     02  eibconf          pic x(1).
  1732     02  eiberr           pic x(1).
  1733     02  eibrldbk         pic x(1).
  1734     02  eiberrcd         pic x(4).
  1735     02  eibsynrb         pic x(1).
  1736     02  eibnodat         pic x(1).
  1737     02  eibfiller5       pic x(2).
  1738     02  eibresp          pic s9(8) comp.
  1739     02  eibresp2         pic s9(8) comp.
  1740     02  dfheigdj         pic s9(4) comp.
  1741     02  dfheigdk         pic s9(4) comp.
  1742 01  DFHCOMMAREA             PIC X(1900).
  1743
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  39
* EL630.cbl
  1745
  1746*    COPY ELCCNTL.
  1747******************************************************************
  1748*                                                                *
  1749*                                                                *
  1750*                            ELCCNTL.                            *
  1751*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1752*                            VMOD=2.059                          *
  1753*                                                                *
  1754*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1755*                                                                *
  1756*   FILE TYPE = VSAM,KSDS                                        *
  1757*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1758*                                                                *
  1759*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1760*       ALTERNATE INDEX = NONE                                   *
  1761*                                                                *
  1762*   LOG = YES                                                    *
  1763*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1764******************************************************************
  1765*                   C H A N G E   L O G
  1766*
  1767* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1768*-----------------------------------------------------------------
  1769*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1770* EFFECTIVE    NUMBER
  1771*-----------------------------------------------------------------
  1772* 082503                   PEMA  ADD BENEFIT GROUP
  1773* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1774* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1775* 092705    2005050300006  PEMA  ADD SPP LEASES
  1776* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1777* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1778* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1779* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1780* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1781* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1782* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1783* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1784* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1785* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1786* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1787******************************************************************
  1788*
  1789 01  CONTROL-FILE.
  1790     12  CF-RECORD-ID                       PIC XX.
  1791         88  VALID-CF-ID                        VALUE 'CF'.
  1792
  1793     12  CF-CONTROL-PRIMARY.
  1794         16  CF-COMPANY-ID                  PIC XXX.
  1795         16  CF-RECORD-TYPE                 PIC X.
  1796             88  CF-COMPANY-MASTER              VALUE '1'.
  1797             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1798             88  CF-STATE-MASTER                VALUE '3'.
  1799             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1800             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1801             88  CF-CARRIER-MASTER              VALUE '6'.
  1802             88  CF-MORTALITY-MASTER            VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  40
* EL630.cbl
  1803             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1804             88  CF-TERMINAL-MASTER             VALUE '9'.
  1805             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1806             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1807             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1808             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1809             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1810             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1811             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1812             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1813             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1814         16  CF-ACCESS-CD-GENL              PIC X(4).
  1815         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1816             20  CF-PROCESSOR               PIC X(4).
  1817         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1818             20  CF-STATE-CODE              PIC XX.
  1819             20  FILLER                     PIC XX.
  1820         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1821             20  FILLER                     PIC XX.
  1822             20  CF-HI-BEN-IN-REC           PIC XX.
  1823         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1824             20  FILLER                     PIC XXX.
  1825             20  CF-CARRIER-CNTL            PIC X.
  1826         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1827             20  FILLER                     PIC XX.
  1828             20  CF-HI-TYPE-IN-REC          PIC 99.
  1829         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1830             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1831                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1832             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1833             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1834         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1835             20  FILLER                     PIC X.
  1836             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1837         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1838             20  FILLER                     PIC XX.
  1839             20  CF-MORTGAGE-PLAN           PIC XX.
  1840         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1841
  1842     12  CF-LAST-MAINT-DT                   PIC XX.
  1843     12  CF-LAST-MAINT-BY                   PIC X(4).
  1844     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1845
  1846     12  CF-RECORD-BODY                     PIC X(728).
  1847
  1848
  1849****************************************************************
  1850*             COMPANY MASTER RECORD                            *
  1851****************************************************************
  1852
  1853     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1854         16  CF-COMPANY-ADDRESS.
  1855             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1856             20  CF-CL-IN-CARE-OF           PIC X(30).
  1857             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1858             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1859             20  CF-CL-CITY-STATE           PIC X(30).
  1860             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  41
* EL630.cbl
  1861             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1862         16  CF-COMPANY-CD                  PIC X.
  1863         16  CF-COMPANY-PASSWORD            PIC X(8).
  1864         16  CF-SECURITY-OPTION             PIC X.
  1865             88  ALL-SECURITY                   VALUE '1'.
  1866             88  COMPANY-VERIFY                 VALUE '2'.
  1867             88  PROCESSOR-VERIFY               VALUE '3'.
  1868             88  NO-SECURITY                    VALUE '4'.
  1869             88  ALL-BUT-TERM                   VALUE '5'.
  1870         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1871             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1872         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1873             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1874         16  CF-INFORCE-LOCATION            PIC X.
  1875             88  CERTS-ARE-ONLINE               VALUE '1'.
  1876             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1877             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1878         16  CF-LOWER-CASE-LETTERS          PIC X.
  1879         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1880             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1881             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1882             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1883             88  CF-ACCNT-CNTL                  VALUE '3'.
  1884             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1885
  1886         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1887         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1888
  1889         16  CF-LGX-CREDIT-USER             PIC X.
  1890             88  CO-IS-NOT-USER                 VALUE 'N'.
  1891             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1892
  1893         16 CF-CREDIT-CALC-CODES.
  1894             20  CF-CR-REM-TERM-CALC PIC X.
  1895               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1896               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1897               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1898               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1899               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1900               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1901               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1902             20  CF-CR-R78-METHOD           PIC X.
  1903               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1904               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1905
  1906         16  CF-CLAIM-CONTROL-COUNTS.
  1907             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1908                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1909
  1910             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1911                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1912
  1913             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1914                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1915
  1916             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1917                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1918
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  42
* EL630.cbl
  1919         16  CF-CURRENT-MONTH-END           PIC XX.
  1920
  1921         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1922             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1923             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1924             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1925             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1926                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1927                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1928             20  CF-CO-PREM-REJECT-SW       PIC X.
  1929                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1930                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1931             20  CF-CO-REF-REJECT-SW        PIC X.
  1932                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1933                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1934
  1935         16  CF-CO-REPORTING-DT             PIC XX.
  1936         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1937         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1938           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1939           88  CF-CO-MONTH-END                  VALUE '1'.
  1940
  1941         16  CF-LGX-CLAIM-USER              PIC X.
  1942             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1943             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1944
  1945         16  CF-CREDIT-EDIT-CONTROLS.
  1946             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1947             20  CF-MIN-AGE                 PIC 99.
  1948             20  CF-DEFAULT-AGE             PIC 99.
  1949             20  CF-MIN-TERM                PIC S999      COMP-3.
  1950             20  CF-MAX-TERM                PIC S999      COMP-3.
  1951             20  CF-DEFAULT-SEX             PIC X.
  1952             20  CF-JOINT-AGE-INPUT         PIC X.
  1953                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1954             20  CF-BIRTH-DATE-INPUT        PIC X.
  1955                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1956             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1957                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1958                 88  CF-ZERO-CARRIER            VALUE '1'.
  1959                 88  CF-ZERO-GROUPING           VALUE '2'.
  1960                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1961             20  CF-EDIT-SW                 PIC X.
  1962                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1963             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1964             20  CF-CR-PR-METHOD            PIC X.
  1965               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1966               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1967             20  FILLER                     PIC X.
  1968
  1969         16  CF-CREDIT-MISC-CONTROLS.
  1970             20  CF-REIN-TABLE-SW           PIC X.
  1971                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1972             20  CF-COMP-TABLE-SW           PIC X.
  1973                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1974             20  CF-EXPERIENCE-RETENTION-AGE
  1975                                            PIC S9        COMP-3.
  1976             20  CF-CONVERSION-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  43
* EL630.cbl
  1977             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1978             20  CF-RUN-FREQUENCY-SW        PIC X.
  1979                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1980                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1981
  1982             20  CF-CR-CHECK-NO-CONTROL.
  1983                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1984                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1985                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1986                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1987                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1988                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1989
  1990                 24  CF-CR-CHECK-COUNT       REDEFINES
  1991                     CF-CR-CHECK-COUNTER      PIC X(4).
  1992
  1993                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1994                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1995
  1996                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1997                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1998                 24  CF-MAIL-PROCESSING       PIC X.
  1999                     88  MAIL-PROCESSING          VALUE 'Y'.
  2000
  2001         16  CF-MISC-SYSTEM-CONTROL.
  2002             20  CF-SYSTEM-C                 PIC X.
  2003                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2004             20  CF-SYSTEM-D                 PIC X.
  2005                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2006             20  CF-SOC-SEC-NO-SW            PIC X.
  2007                 88  SOC-SEC-NO-USED             VALUE '1'.
  2008             20  CF-MEMBER-NO-SW             PIC X.
  2009                 88  MEMBER-NO-USED              VALUE '1'.
  2010             20  CF-TAX-ID-NUMBER            PIC X(11).
  2011             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2012             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2013                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2014                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2015                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2016                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2017             20  CF-SYSTEM-E                 PIC X.
  2018                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2019
  2020         16  CF-LGX-LIFE-USER               PIC X.
  2021             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2022             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2023
  2024         16  CF-CR-MONTH-END-DT             PIC XX.
  2025
  2026         16  CF-FILE-MAINT-DATES.
  2027             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2028                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2029             20  CF-LAST-BATCH       REDEFINES
  2030                 CF-LAST-BATCH-NO               PIC X(4).
  2031             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2032             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2033             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2034             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  44
* EL630.cbl
  2035             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2036             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2037             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2038             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2039             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2040             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2041
  2042         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2043         16  FILLER                         PIC X.
  2044
  2045         16  CF-ALT-MORT-CODE               PIC X(4).
  2046         16  CF-MEMBER-CAPTION              PIC X(10).
  2047
  2048         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2049             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2050             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2051             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2052             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2053             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2054
  2055         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2056
  2057         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2058         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2059         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2060         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2061
  2062         16  CF-AH-OVERRIDE-L1              PIC X.
  2063         16  CF-AH-OVERRIDE-L2              PIC XX.
  2064         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2065         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2066
  2067         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2068         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2069
  2070         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2071         16  CF-AR-LAST-EL860-DT            PIC XX.
  2072         16  CF-MP-MONTH-END-DT             PIC XX.
  2073
  2074         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2075         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2076             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2077
  2078         16  CF-AR-MONTH-END-DT             PIC XX.
  2079
  2080         16  CF-CRDTCRD-USER                PIC X.
  2081             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2082             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2083
  2084         16  CF-CC-MONTH-END-DT             PIC XX.
  2085
  2086         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2087
  2088         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2089             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2090             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2091             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2092         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  45
* EL630.cbl
  2093         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2094         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2095         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2096             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2097             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2098         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2099         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2100         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2101             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2102         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2103
  2104         16  CF-CL-ZIP-CODE.
  2105             20  CF-CL-ZIP-PRIME.
  2106                 24  CF-CL-ZIP-1ST          PIC X.
  2107                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2108                 24  FILLER                 PIC X(4).
  2109             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2110         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2111             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2112             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2113             20  FILLER                     PIC XXX.
  2114
  2115         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2116         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2117         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2118         16  CF-CO-OPTION-START-DATE        PIC XX.
  2119         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2120           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2121                                                      '3' '4'.
  2122           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2123           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2124           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2125           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2126           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2127           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2128
  2129         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2130
  2131         16  CF-PAYMENT-APPROVAL-LEVELS.
  2132             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2133             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2134             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2135             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2136             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2137             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2138
  2139         16  CF-END-USER-REPORTING-USER     PIC X.
  2140             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2141             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2142
  2143         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2144             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2145             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2146
  2147         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2148
  2149         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2150         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  46
* EL630.cbl
  2151
  2152         16  CF-CREDIT-ARCHIVE-CNTL.
  2153             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2154             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2155             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2156
  2157         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2158
  2159         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2160             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2161             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2162
  2163         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2164             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2165             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2166
  2167         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2168
  2169         16  CF-CO-ACH-ID-CODE              PIC  X.
  2170             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2171             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2172             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2173         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2174         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2175         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2176         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2177         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2178         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2179         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2180         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2181         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2182                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2183         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2184                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2185
  2186         16  CF-CO-OVER-SHORT.
  2187             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2188             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2189
  2190*         16  FILLER                         PIC X(102).
  2191         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2192             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2193             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2194
  2195         16  CF-AH-APPROVAL-DAYS.
  2196             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2197             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2198             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2199             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2200
  2201         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2202
  2203         16  CF-APPROV-LEV-5.
  2204             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2205             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2206             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2207
  2208         16  FILLER                         PIC X(68).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  47
* EL630.cbl
  2209****************************************************************
  2210*             PROCESSOR/USER RECORD                            *
  2211****************************************************************
  2212
  2213     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2214         16  CF-PROCESSOR-NAME              PIC X(30).
  2215         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2216         16  CF-PROCESSOR-TITLE             PIC X(26).
  2217         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2218                 88  MESSAGE-YES                VALUE 'Y'.
  2219                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2220
  2221*****************************************************
  2222****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2223****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2224****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2225****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2226*****************************************************
  2227
  2228         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2229             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2230             20  CF-APPLICATION-FORCE       PIC X.
  2231             20  CF-INDIVIDUAL-APP.
  2232                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2233                     28  CF-BROWSE-APP      PIC X.
  2234                     28  CF-UPDATE-APP      PIC X.
  2235
  2236         16  CF-CURRENT-TERM-ON             PIC X(4).
  2237         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2238             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2239             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2240             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2241             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2242             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2243             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2244             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2245         16  CF-PROCESSOR-CARRIER           PIC X.
  2246             88  NO-CARRIER-SECURITY            VALUE ' '.
  2247         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2248             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2249         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2250             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2251         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2252             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2253
  2254         16  CF-PROC-SYS-ACCESS-SW.
  2255             20  CF-PROC-CREDIT-CLAIMS-SW.
  2256                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2257                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2258                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2259                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2260             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2261                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2262                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2263             20  CF-PROC-LIFE-GNRLDGR-SW.
  2264                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2265                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2266                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  48
* EL630.cbl
  2267                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2268             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2269                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2270                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2271         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2272             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2273             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2274         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2275
  2276         16  CF-APPROVAL-LEVEL                  PIC X.
  2277             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2278             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2279             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2280             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2281             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2282
  2283         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2284
  2285         16  CF-LANGUAGE-TYPE                   PIC X.
  2286             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2287             88  CF-LANG-IS-FR                      VALUE 'F'.
  2288
  2289         16  CF-CSR-IND                         PIC X.
  2290         16  FILLER                             PIC X(239).
  2291
  2292****************************************************************
  2293*             PROCESSOR/REMINDERS RECORD                       *
  2294****************************************************************
  2295
  2296     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2297         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2298             20  CF-START-REMIND-DT         PIC XX.
  2299             20  CF-END-REMIND-DT           PIC XX.
  2300             20  CF-REMINDER-TEXT           PIC X(50).
  2301         16  FILLER                         PIC X(296).
  2302
  2303
  2304****************************************************************
  2305*             STATE MASTER RECORD                              *
  2306****************************************************************
  2307
  2308     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2309         16  CF-STATE-ABBREVIATION          PIC XX.
  2310         16  CF-STATE-NAME                  PIC X(25).
  2311         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2312         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2313             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2314             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2315             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2316             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2317                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2318                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2319             20  CF-ST-PREM-REJECT-SW       PIC X.
  2320                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2321                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2322             20  CF-ST-REF-REJECT-SW        PIC X.
  2323                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2324                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  49
* EL630.cbl
  2325         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2326         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2327         16  CF-ST-REFUND-RULES.
  2328             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2329             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2330             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2331         16  CF-ST-FST-PMT-EXTENSION.
  2332             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2333             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2334                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2335                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2336                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2337                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2338         16  CF-ST-STATE-CALL.
  2339             20  CF-ST-CALL-UNEARNED        PIC X.
  2340             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2341             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2342         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2343             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2344             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2345         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2346         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2347         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2348         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2349         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2350         16  FILLER                         PIC X.
  2351         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2352             20  CF-ST-BENEFIT-CD           PIC XX.
  2353             20  CF-ST-BENEFIT-KIND         PIC X.
  2354                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2355                 88  CF-ST-AH-KIND              VALUE 'A'.
  2356             20  CF-ST-REM-TERM-CALC        PIC X.
  2357                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2358                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2359                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2360                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2361                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2362                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2363                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2364                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2365
  2366             20  CF-ST-REFUND-CALC          PIC X.
  2367                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2368                 88  ST-REFD-BY-R78             VALUE '1'.
  2369                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2370                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2371                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2372                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2373                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2374                 88  ST-REFD-UTAH               VALUE '7'.
  2375                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2376                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2377                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2378
  2379             20  CF-ST-EARNING-CALC         PIC X.
  2380                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2381                 88  ST-EARN-BY-R78             VALUE '1'.
  2382                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  50
* EL630.cbl
  2383                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2384                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2385                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2386                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2387                 88  ST-EARN-MEAN               VALUE '8'.
  2388                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2389
  2390             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2391                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2392                 88  ST-OVRD-BY-R78             VALUE '1'.
  2393                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2394                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2395                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2396                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2397                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2398                 88  ST-OVRD-MEAN               VALUE '8'.
  2399                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2400             20  cf-st-extra-periods        pic 9.
  2401*            20  FILLER                     PIC X.
  2402
  2403         16  CF-ST-COMMISSION-CAPS.
  2404             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2405             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2406             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2407             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2408         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2409                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2410                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2411                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2412
  2413         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2414
  2415         16  CF-ST-STATUTORY-INTEREST.
  2416             20  CF-ST-STAT-DATE-FROM       PIC X.
  2417                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2418                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2419             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2420             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2421             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2422             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2423             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2424
  2425         16  CF-ST-OVER-SHORT.
  2426             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2427             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2428
  2429         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2430
  2431         16  CF-ST-RT-CALC                  PIC X.
  2432
  2433         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2434         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2435         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2436         16  CF-ST-RF-LR-CALC               PIC X.
  2437         16  CF-ST-RF-LL-CALC               PIC X.
  2438         16  CF-ST-RF-LN-CALC               PIC X.
  2439         16  CF-ST-RF-AH-CALC               PIC X.
  2440         16  CF-ST-RF-CP-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  51
* EL630.cbl
  2441*        16  FILLER                         PIC X(206).
  2442*CIDMOD         16  FILLER                         PIC X(192).
  2443         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2444             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2445         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2446         16  CF-ST-VFY-2ND-BENE             PIC X.
  2447         16  CF-ST-CAUSAL-STATE             PIC X.
  2448         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2449         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2450         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2451             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2452         16  CF-ST-NET-ONLY-STATE           PIC X.
  2453             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2454         16  cf-commission-cap-required     pic x.
  2455         16  CF-ST-GA-COMMISSION-CAPS.
  2456             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2457             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2458             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2459             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2460         16  CF-ST-TOT-COMMISSION-CAPS.
  2461             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2462             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2463             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2464             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2465         16  FILLER                         PIC X(156).
  2466
  2467****************************************************************
  2468*             BENEFIT MASTER RECORD                            *
  2469****************************************************************
  2470
  2471     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2472         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2473             20  CF-BENEFIT-CODE            PIC XX.
  2474             20  CF-BENEFIT-NUMERIC  REDEFINES
  2475                 CF-BENEFIT-CODE            PIC XX.
  2476             20  CF-BENEFIT-ALPHA           PIC XXX.
  2477             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2478             20  CF-BENEFIT-COMMENT         PIC X(10).
  2479
  2480             20  CF-LF-COVERAGE-TYPE        PIC X.
  2481                 88  CF-REDUCING                VALUE 'R'.
  2482                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2483
  2484             20  CF-SPECIAL-CALC-CD         PIC X.
  2485                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2486                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2487                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2488                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2489                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2490                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2491                 88  CF-FARM-PLAN               VALUE 'F'.
  2492                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2493                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2494                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2495                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2496                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2497                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2498                 88  CF-PRUDENTIAL              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  52
* EL630.cbl
  2499                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2500                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2501                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2502                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2503                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2504                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2505
  2506             20  CF-JOINT-INDICATOR         PIC X.
  2507                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2508
  2509*            20  FILLER                     PIC X(12).
  2510             20  cf-maximum-benefits        pic s999 comp-3.
  2511             20  FILLER                     PIC X(09).
  2512             20  CF-BENEFIT-CATEGORY        PIC X.
  2513             20  CF-LOAN-TYPE               PIC X(8).
  2514
  2515             20  CF-CO-REM-TERM-CALC        PIC X.
  2516                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2517                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2518                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2519                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2520                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2521
  2522             20  CF-CO-EARNINGS-CALC        PIC X.
  2523                 88  CO-EARN-BY-R78             VALUE '1'.
  2524                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2525                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2526                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2527                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2528                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2529                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2530                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2531
  2532             20  CF-CO-REFUND-CALC          PIC X.
  2533                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2534                 88  CO-REFD-BY-R78             VALUE '1'.
  2535                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2536                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2537                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2538                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2539                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2540                 88  CO-REFD-MEAN               VALUE '8'.
  2541                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2542                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2543                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2544
  2545             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2546                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2547                 88  CO-OVRD-BY-R78             VALUE '1'.
  2548                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2549                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2550                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2551                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2552                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2553                 88  CO-OVRD-MEAN               VALUE '8'.
  2554                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2555
  2556             20  CF-CO-BEN-I-G-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  53
* EL630.cbl
  2557                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2558                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2559                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2560
  2561         16  FILLER                         PIC X(304).
  2562
  2563
  2564****************************************************************
  2565*             CARRIER MASTER RECORD                            *
  2566****************************************************************
  2567
  2568     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2569         16  CF-ADDRESS-DATA.
  2570             20  CF-MAIL-TO-NAME            PIC X(30).
  2571             20  CF-IN-CARE-OF              PIC X(30).
  2572             20  CF-ADDRESS-LINE-1          PIC X(30).
  2573             20  CF-ADDRESS-LINE-2          PIC X(30).
  2574             20  CF-CITY-STATE              PIC X(30).
  2575             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2576             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2577
  2578         16  CF-CLAIM-NO-CONTROL.
  2579             20  CF-CLAIM-NO-METHOD         PIC X.
  2580                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2581                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2582                 88  CLAIM-NO-SEQ               VALUE '3'.
  2583                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2584             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2585                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2586                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2587                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2588
  2589         16  CF-CHECK-NO-CONTROL.
  2590             20  CF-CHECK-NO-METHOD         PIC X.
  2591                 88  CHECK-NO-MANUAL            VALUE '1'.
  2592                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2593                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2594                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2595             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2596                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2597
  2598         16  CF-DOMICILE-STATE              PIC XX.
  2599
  2600         16  CF-EXPENSE-CONTROLS.
  2601             20  CF-EXPENSE-METHOD          PIC X.
  2602                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2603                 88  DOLLARS-PER-PMT            VALUE '2'.
  2604                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2605                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2606             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2607             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2608
  2609         16  CF-CORRESPONDENCE-CONTROL.
  2610             20  CF-LETTER-RESEND-OPT       PIC X.
  2611                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2612                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2613             20  FILLER                     PIC X(4).
  2614
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  54
* EL630.cbl
  2615         16  CF-RESERVE-CONTROLS.
  2616             20  CF-MANUAL-SW               PIC X.
  2617                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2618             20  CF-FUTURE-SW               PIC X.
  2619                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2620             20  CF-PTC-SW                  PIC X.
  2621                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2622             20  CF-IBNR-SW                 PIC X.
  2623                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2624             20  CF-PTC-LF-SW               PIC X.
  2625                 88  CF-LF-PTC-USED             VALUE '1'.
  2626             20  CF-CDT-ACCESS-METHOD       PIC X.
  2627                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2628                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2629                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2630             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2631
  2632         16  CF-CLAIM-CALC-METHOD           PIC X.
  2633             88  360-PLUS-MONTHS                VALUE '1'.
  2634             88  365-PLUS-MONTHS                VALUE '2'.
  2635             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2636             88  360-DAILY                      VALUE '4'.
  2637             88  365-DAILY                      VALUE '5'.
  2638
  2639         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2640         16  FILLER                         PIC X(11).
  2641
  2642         16  CF-LIMIT-AMOUNTS.
  2643             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2644             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2645             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2646             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2647             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2648             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2649             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2650             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2651             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2652             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2653
  2654         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2655         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2656         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2657
  2658         16  CF-ZIP-CODE.
  2659             20  CF-ZIP-PRIME.
  2660                 24  CF-ZIP-1ST             PIC X.
  2661                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2662                 24  FILLER                 PIC X(4).
  2663             20  CF-ZIP-PLUS4               PIC X(4).
  2664         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2665             20  CF-CAN-POSTAL-1            PIC XXX.
  2666             20  CF-CAN-POSTAL-2            PIC XXX.
  2667             20  FILLER                     PIC XXX.
  2668
  2669         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2670         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2671         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2672
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  55
* EL630.cbl
  2673         16  CF-RATING-SWITCH               PIC X.
  2674             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2675             88  CF-NO-RATING                   VALUE 'N'.
  2676
  2677         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2678
  2679         16  CF-CARRIER-OVER-SHORT.
  2680             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2681             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2682
  2683         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2684         16  CF-SECPAY-SWITCH               PIC X.
  2685             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2686             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2687         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2688         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2689         16  FILLER                         PIC X(444).
  2690*        16  FILLER                         PIC X(452).
  2691
  2692
  2693****************************************************************
  2694*             MORTALITY MASTER RECORD                          *
  2695****************************************************************
  2696
  2697     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2698         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2699                                INDEXED BY CF-MORT-NDX.
  2700             20  CF-MORT-TABLE              PIC X(5).
  2701             20  CF-MORT-TABLE-TYPE         PIC X.
  2702                 88  CF-MORT-JOINT              VALUE 'J'.
  2703                 88  CF-MORT-SINGLE             VALUE 'S'.
  2704                 88  CF-MORT-COMBINED           VALUE 'C'.
  2705                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2706                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2707             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2708             20  CF-MORT-AGE-METHOD         PIC XX.
  2709                 88  CF-AGE-LAST                VALUE 'AL'.
  2710                 88  CF-AGE-NEAR                VALUE 'AN'.
  2711             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2712             20  CF-MORT-ADJUSTMENT-DIRECTION
  2713                                            PIC X.
  2714                 88  CF-MINUS                   VALUE '-'.
  2715                 88  CF-PLUS                    VALUE '+'.
  2716             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2717             20  CF-MORT-JOINT-CODE         PIC X.
  2718                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2719             20  CF-MORT-PC-Q               PIC X.
  2720                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2721             20  CF-MORT-TABLE-CODE         PIC X(4).
  2722             20  CF-MORT-COMMENTS           PIC X(15).
  2723             20  FILLER                     PIC X(14).
  2724
  2725         16  FILLER                         PIC X(251).
  2726
  2727
  2728****************************************************************
  2729*             BUSSINESS TYPE MASTER RECORD                     *
  2730****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  56
* EL630.cbl
  2731
  2732     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2733* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2734* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2735* AND RECORD 05 IS TYPES 81-99
  2736         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2737             20  CF-BUSINESS-TITLE          PIC  X(19).
  2738             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2739                                            PIC S9V9(4) COMP-3.
  2740             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2741             20  FILLER                     PIC  X.
  2742         16  FILLER                         PIC  X(248).
  2743
  2744
  2745****************************************************************
  2746*             TERMINAL MASTER RECORD                           *
  2747****************************************************************
  2748
  2749     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2750
  2751         16  CF-COMPANY-TERMINALS.
  2752             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2753                                  PIC X(4).
  2754         16  FILLER               PIC X(248).
  2755
  2756
  2757****************************************************************
  2758*             LIFE EDIT MASTER RECORD                          *
  2759****************************************************************
  2760
  2761     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2762         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2763             20  CF-LIFE-CODE-IN            PIC XX.
  2764             20  CF-LIFE-CODE-OUT           PIC XX.
  2765         16  FILLER                         PIC X(248).
  2766
  2767
  2768****************************************************************
  2769*             AH EDIT MASTER RECORD                            *
  2770****************************************************************
  2771
  2772     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2773         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2774             20  CF-AH-CODE-IN              PIC XXX.
  2775             20  CF-AH-CODE-OUT             PIC XX.
  2776         16  FILLER                         PIC X(248).
  2777
  2778
  2779****************************************************************
  2780*             CREDIBILITY TABLES                               *
  2781****************************************************************
  2782
  2783     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2784         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2785                             INDEXED BY CF-CRDB-NDX.
  2786             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2787             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2788             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  57
* EL630.cbl
  2789         16  FILLER                         PIC  X(332).
  2790
  2791
  2792****************************************************************
  2793*             REPORT CUSTOMIZATION RECORD                      *
  2794****************************************************************
  2795
  2796     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2797         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2798             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2799             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2800             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2801**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2802****       A T-TRANSFER.                                   ****
  2803             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2804
  2805         16  FILLER                         PIC XX.
  2806
  2807         16  CF-CARRIER-CNTL-OPT.
  2808             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2809                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2810                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2811             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2812                                            PIC X.
  2813         16  CF-GROUP-CNTL-OPT.
  2814             20  CF-GROUP-OPT-SEQ           PIC 9.
  2815                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2816                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2817             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2818                                            PIC X(6).
  2819         16  CF-STATE-CNTL-OPT.
  2820             20  CF-STATE-OPT-SEQ           PIC 9.
  2821                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2822                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2823             20  CF-STATE-SELECT OCCURS 3 TIMES
  2824                                            PIC XX.
  2825         16  CF-ACCOUNT-CNTL-OPT.
  2826             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2827                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2828                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2829             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2830                                            PIC X(10).
  2831         16  CF-BUS-TYP-CNTL-OPT.
  2832             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2833                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2834                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2835             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2836                                            PIC XX.
  2837         16  CF-LF-TYP-CNTL-OPT.
  2838             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2839                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2840                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2841             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2842                                            PIC XX.
  2843         16  CF-AH-TYP-CNTL-OPT.
  2844             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2845                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2846                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  58
* EL630.cbl
  2847             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2848                                            PIC XX.
  2849         16  CF-REPTCD1-CNTL-OPT.
  2850             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2851                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2852                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2853             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2854                                            PIC X(10).
  2855         16  CF-REPTCD2-CNTL-OPT.
  2856             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2857                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2858                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2859             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2860                                            PIC X(10).
  2861         16  CF-USER1-CNTL-OPT.
  2862             20  CF-USER1-OPT-SEQ           PIC 9.
  2863                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2864                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2865             20  CF-USER1-SELECT OCCURS 3 TIMES
  2866                                            PIC X(10).
  2867         16  CF-USER2-CNTL-OPT.
  2868             20  CF-USER2-OPT-SEQ           PIC 9.
  2869                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2870                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2871             20  CF-USER2-SELECT OCCURS 3 TIMES
  2872                                            PIC X(10).
  2873         16  CF-USER3-CNTL-OPT.
  2874             20  CF-USER3-OPT-SEQ           PIC 9.
  2875                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2876                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2877             20  CF-USER3-SELECT OCCURS 3 TIMES
  2878                                            PIC X(10).
  2879         16  CF-USER4-CNTL-OPT.
  2880             20  CF-USER4-OPT-SEQ           PIC 9.
  2881                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2882                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2883             20  CF-USER4-SELECT OCCURS 3 TIMES
  2884                                            PIC X(10).
  2885         16  CF-USER5-CNTL-OPT.
  2886             20  CF-USER5-OPT-SEQ           PIC 9.
  2887                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2888                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2889             20  CF-USER5-SELECT OCCURS 3 TIMES
  2890                                            PIC X(10).
  2891         16  CF-REINS-CNTL-OPT.
  2892             20  CF-REINS-OPT-SEQ           PIC 9.
  2893                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2894                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2895             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2896                 24  CF-REINS-PRIME         PIC XXX.
  2897                 24  CF-REINS-SUB           PIC XXX.
  2898
  2899         16  CF-AGENT-CNTL-OPT.
  2900             20  CF-AGENT-OPT-SEQ           PIC 9.
  2901                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2902                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2903             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2904                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  59
* EL630.cbl
  2905
  2906         16  FILLER                         PIC X(43).
  2907
  2908         16  CF-LOSS-RATIO-SELECT.
  2909             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2910             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2911         16  CF-ENTRY-DATE-SELECT.
  2912             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2913             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2914         16  CF-EFFECTIVE-DATE-SELECT.
  2915             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2916             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2917
  2918         16  CF-EXCEPTION-LIST-IND          PIC X.
  2919             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2920
  2921         16  FILLER                         PIC X(318).
  2922
  2923****************************************************************
  2924*                  EXCEPTION REPORTING RECORD                  *
  2925****************************************************************
  2926
  2927     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2928         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2929             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2930
  2931         16  CF-COMBINED-LIFE-AH-OPT.
  2932             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2933             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2934             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2935             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2936
  2937         16  CF-LIFE-OPT.
  2938             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2939             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2940             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2941             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2942             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2943             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2944             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2945             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2946             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2947             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2948
  2949         16  CF-AH-OPT.
  2950             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2951             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2952             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2953             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2954             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2955             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2956             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2957             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2958             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2959             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2960
  2961         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2962             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  60
* EL630.cbl
  2963             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2964             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2965
  2966         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2967
  2968         16  FILLER                         PIC X(673).
  2969
  2970
  2971****************************************************************
  2972*             MORTGAGE SYSTEM PLAN RECORD                      *
  2973****************************************************************
  2974
  2975     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2976         16  CF-PLAN-TYPE                   PIC X.
  2977             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2978             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2979             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2980         16  CF-PLAN-ABBREV                 PIC XXX.
  2981         16  CF-PLAN-DESCRIPT               PIC X(10).
  2982         16  CF-PLAN-NOTES                  PIC X(20).
  2983         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2984         16  CF-PLAN-UNDERWRITING.
  2985             20  CF-PLAN-TERM-DATA.
  2986                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2987                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2988             20  CF-PLAN-AGE-DATA.
  2989                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2990                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2991                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2992             20  CF-PLAN-BENEFIT-DATA.
  2993                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2994                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2995                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2996                                            PIC S9(7)V99  COMP-3.
  2997         16  CF-PLAN-POLICY-FORMS.
  2998             20  CF-POLICY-FORM             PIC X(12).
  2999             20  CF-MASTER-APPLICATION      PIC X(12).
  3000             20  CF-MASTER-POLICY           PIC X(12).
  3001         16  CF-PLAN-RATING.
  3002             20  CF-RATE-CODE               PIC X(5).
  3003             20  CF-SEX-RATING              PIC X.
  3004                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3005                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3006             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3007             20  CF-SUB-STD-TYPE            PIC X.
  3008                 88  CF-PCT-OF-PREM            VALUE '1'.
  3009                 88  CF-PCT-OF-BENE            VALUE '2'.
  3010         16  CF-PLAN-PREM-TOLERANCES.
  3011             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3012             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3013         16  CF-PLAN-PYMT-TOLERANCES.
  3014             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3015             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3016         16  CF-PLAN-MISC-DATA.
  3017             20  FILLER                     PIC X.
  3018             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3019             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3020         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  61
* EL630.cbl
  3021         16  CF-PLAN-IND-GRP                PIC X.
  3022             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3023                                                     '1'.
  3024             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3025                                                     '2'.
  3026         16  CF-MIB-SEARCH-SW               PIC X.
  3027             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3028             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3029             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3030             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3031         16  CF-ALPHA-SEARCH-SW             PIC X.
  3032             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3033             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3034             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3035             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3036             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3037             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3038             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3039             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3040             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3041             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3042                                                     'A' 'B' 'C'
  3043                                                     'X' 'Y' 'Z'.
  3044         16  CF-EFF-DT-RULE-SW              PIC X.
  3045             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3046             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3047             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3048             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3049             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3050         16  FILLER                         PIC X(4).
  3051         16  CF-HEALTH-QUESTIONS            PIC X.
  3052             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3053         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3054         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3055         16  CF-PLAN-SNGL-JNT               PIC X.
  3056             88  CF-COMBINED-PLAN              VALUE 'C'.
  3057             88  CF-JNT-PLAN                   VALUE 'J'.
  3058             88  CF-SNGL-PLAN                  VALUE 'S'.
  3059         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3060         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3061         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3062         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3063         16  CF-RERATE-CNTL                 PIC  X.
  3064             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3065             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3066             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3067             88  CF-AUTO-RECALC                 VALUE '4'.
  3068         16  CF-BENEFIT-TYPE                PIC  X.
  3069             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3070             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3071         16  CF-POLICY-FEE                  PIC S999V99
  3072                                                    COMP-3.
  3073         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3074         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3075         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3076         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3077         16  FILLER                         PIC  X(32).
  3078         16  CF-TERMINATION-FORM            PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  62
* EL630.cbl
  3079         16  FILLER                         PIC  X(08).
  3080         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3081                                                       COMP-3.
  3082         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3083         16  CF-ISSUE-LETTER                PIC  X(4).
  3084         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3085         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3086             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3087             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3088         16  CF-MP-REFUND-CALC              PIC X.
  3089             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3090             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3091             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3092             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3093             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3094             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3095             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3096             88  CF-MP-REFD-MEAN                VALUE '8'.
  3097         16  CF-ALT-RATE-CODE               PIC  X(5).
  3098
  3099
  3100         16  FILLER                         PIC X(498).
  3101****************************************************************
  3102*             MORTGAGE COMPANY MASTER RECORD                   *
  3103****************************************************************
  3104
  3105     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3106         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3107         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3108             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3109             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3110             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3111             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3112             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3113
  3114         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3115         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3116         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3117         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3118         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3119
  3120         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3121             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3122         16  CF-MP-RECON-USE-IND            PIC X(1).
  3123             88  CF-MP-USE-RECON             VALUE 'Y'.
  3124         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3125             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3126         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3127             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3128             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3129         16  FILLER                         PIC X(1).
  3130         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3131             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3132         16  CF-MORTG-MIB-VERSION           PIC X.
  3133             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3134             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3135             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3136         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  63
* EL630.cbl
  3137             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3138                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3139             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3140                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3141             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3142                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3143             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3144                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3145             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3146                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3147             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3148                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3149         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3150         16  FILLER                         PIC X(7).
  3151         16  CF-MORTG-DESTINATION-SYMBOL.
  3152             20  CF-MORTG-MIB-COMM          PIC X(5).
  3153             20  CF-MORTG-MIB-TERM          PIC X(5).
  3154         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3155             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3156         16  FILLER                         PIC X(03).
  3157         16  CF-MP-CHECK-NO-CONTROL.
  3158             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3159                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3160                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3161                                                ' ' LOW-VALUES.
  3162                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3163                                               VALUE '3'.
  3164         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3165         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3166         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3167             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3168                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3169             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3170                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3171             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3172                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3173             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3174                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3175             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3176                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3177             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3178                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3179         16  CF-MORTG-BILLING-AREA.
  3180             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3181                                            PIC X.
  3182         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3183         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3184         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3185         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3186             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3187             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3188         16  FILLER                         PIC X.
  3189         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3190             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3191             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3192         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3193         16  FILLER                         PIC X(8).
  3194         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  64
* EL630.cbl
  3195         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3196         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3197         16  CF-ACH-COMPANY-ID.
  3198             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3199                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3200                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3201                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3202             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3203         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3204             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3205         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3206             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3207             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3208         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3209         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3210         16  FILLER                         PIC X(536).
  3211
  3212****************************************************************
  3213*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3214****************************************************************
  3215
  3216     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3217         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3218             20  CF-FEMALE-HEIGHT.
  3219                 24  CF-FEMALE-FT           PIC 99.
  3220                 24  CF-FEMALE-IN           PIC 99.
  3221             20  CF-FEMALE-MIN-WT           PIC 999.
  3222             20  CF-FEMALE-MAX-WT           PIC 999.
  3223         16  FILLER                         PIC X(428).
  3224
  3225     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3226         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3227             20  CF-MALE-HEIGHT.
  3228                 24  CF-MALE-FT             PIC 99.
  3229                 24  CF-MALE-IN             PIC 99.
  3230             20  CF-MALE-MIN-WT             PIC 999.
  3231             20  CF-MALE-MAX-WT             PIC 999.
  3232         16  FILLER                         PIC X(428).
  3233******************************************************************
  3234*             AUTOMATIC ACTIVITY RECORD                          *
  3235******************************************************************
  3236     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3237         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3238             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3239             20  CF-SYS-LETTER-ID           PIC X(04).
  3240             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3241             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3242             20  CF-SYS-RESET-SW            PIC X(01).
  3243             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3244             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3245
  3246         16  FILLER                         PIC X(50).
  3247
  3248         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3249             20  CF-USER-ACTIVE-SW          PIC X(01).
  3250             20  CF-USER-LETTER-ID          PIC X(04).
  3251             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3252             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  65
* EL630.cbl
  3253             20  CF-USER-RESET-SW           PIC X(01).
  3254             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3255             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3256             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3257
  3258         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  66
* EL630.cbl
  3260*    COPY ERCPNDB.
  3261******************************************************************
  3262*                                                                *
  3263*                                                                *
  3264*                            ERCPNDB.                            *
  3265*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3266*                            VMOD=2.025                          *
  3267*                                                                *
  3268*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3269*                                                                *
  3270******************************************************************
  3271*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3272*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3273******************************************************************
  3274*                                                                *
  3275*                                                                *
  3276*   FILE TYPE = VSAM,KSDS                                        *
  3277*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3278*                                                                *
  3279*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3280*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3281*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3282*                                                 RKP=13,LEN=36  *
  3283*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3284*                                      AND CHG-SEQ.)             *
  3285*                                                RKP=49,LEN=11   *
  3286*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3287*                                      AND CHG-SEQ.)             *
  3288*                                                RKP=60,LEN=15   *
  3289*                                                                *
  3290*   LOG = NO                                                     *
  3291*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3292******************************************************************
  3293******************************************************************
  3294*                   C H A N G E   L O G
  3295*
  3296* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3297*-----------------------------------------------------------------
  3298*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3299* EFFECTIVE    NUMBER
  3300*-----------------------------------------------------------------
  3301* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3302* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3303* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3304* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3305* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3306* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3307* 032306                   PEMA  ADD BOW LOAN NUMBER
  3308* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3309* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3310* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3311* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3312* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3313* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3314* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3315* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3316* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3317* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  67
* EL630.cbl
  3318* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  3319* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  3320* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  3321******************************************************************
  3322
  3323 01  PENDING-BUSINESS.
  3324     12  PB-RECORD-ID                     PIC XX.
  3325         88  VALID-PB-ID                        VALUE 'PB'.
  3326
  3327     12  PB-CONTROL-PRIMARY.
  3328         16  PB-COMPANY-CD                PIC X.
  3329         16  PB-ENTRY-BATCH               PIC X(6).
  3330         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3331         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3332
  3333     12  PB-CONTROL-BY-ACCOUNT.
  3334         16  PB-COMPANY-CD-A1             PIC X.
  3335         16  PB-CARRIER                   PIC X.
  3336         16  PB-GROUPING.
  3337             20  PB-GROUPING-PREFIX       PIC XXX.
  3338             20  PB-GROUPING-PRIME        PIC XXX.
  3339         16  PB-STATE                     PIC XX.
  3340         16  PB-ACCOUNT.
  3341             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3342             20  PB-ACCOUNT-PRIME         PIC X(6).
  3343         16  PB-CERT-EFF-DT               PIC XX.
  3344         16  PB-CERT-NO.
  3345             20  PB-CERT-PRIME            PIC X(10).
  3346             20  PB-CERT-SFX              PIC X.
  3347         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3348
  3349         16  PB-RECORD-TYPE               PIC X.
  3350             88  PB-MAILING-DATA                VALUE '0'.
  3351             88  PB-ISSUE                       VALUE '1'.
  3352             88  PB-CANCELLATION                VALUE '2'.
  3353             88  PB-BATCH-TRAILER               VALUE '9'.
  3354
  3355     12  PB-CONTROL-BY-ORIG-BATCH.
  3356         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3357         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3358         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3359         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3360
  3361     12  PB-CONTROL-BY-CSR.
  3362         16  PB-CSR-COMPANY-CD            PIC X.
  3363         16  PB-CSR-ID                    PIC X(4).
  3364         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3365         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3366         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3367******************************************************************
  3368*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3369******************************************************************
  3370
  3371     12  PB-LAST-MAINT-DT                 PIC XX.
  3372     12  PB-LAST-MAINT-BY                 PIC X(4).
  3373     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3374
  3375     12  PB-RECORD-BODY                   PIC X(375).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  68
* EL630.cbl
  3376
  3377     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3378         16  PB-CERT-ORIGIN               PIC X.
  3379             88  CLASIC-CREATED-CERT         VALUE '1'.
  3380         16  PB-I-NAME.
  3381             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3382             20  PB-I-INSURED-FIRST-NAME.
  3383                 24  PB-I-INSURED-1ST-INIT PIC X.
  3384                 24  FILLER                PIC X(9).
  3385             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3386         16  PB-I-AGE                     PIC S99   COMP-3.
  3387         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3388         16  PB-I-BIRTHDAY                PIC XX.
  3389         16  PB-I-INSURED-SEX             PIC X.
  3390             88  PB-SEX-MALE     VALUE 'M'.
  3391             88  PB-SEX-FEMALE   VALUE 'F'.
  3392
  3393         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3394         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3395         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3396         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3397         16  PB-I-SKIP-CODE               PIC X.
  3398             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3399             88  PB-SKIP-JULY              VALUE '1'.
  3400             88  PB-SKIP-AUGUST            VALUE '2'.
  3401             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3402             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3403             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3404             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3405             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3406             88  PB-SKIP-JUNE              VALUE '8'.
  3407             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3408             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3409             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3410         16  PB-I-TERM-TYPE               PIC X.
  3411             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3412             88  PB-PAID-WEEKLY            VALUE 'W'.
  3413             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3414             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3415             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3416         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3417         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3418         16  PB-I-DATA-ENTRY-SW           PIC X.
  3419             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3420             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3421             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3422             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3423         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3424         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3425*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3426         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3427         16  PB-I-LETTER-REQD             PIC X.
  3428
  3429         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3430             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3431             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3432                                                   '90' THRU '99'.
  3433         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  69
* EL630.cbl
  3434                                          PIC XX.
  3435         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3436         16  PB-I-AMOUNT-FINANCED REDEFINES
  3437                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3438         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3439         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3440                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3441         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3442         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3443         16  PB-I-CLP-AMOUNT REDEFINES
  3444                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3445         16  PB-I-LF-CALC-FLAG            PIC X.
  3446             88 PB-COMP-LF-PREM               VALUE '?'.
  3447         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3448         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3449         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3450         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3451         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3452         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3453         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3454         16  PB-I-LF-ABBR                 PIC XXX.
  3455         16  PB-I-LF-INPUT-CD             PIC XX.
  3456
  3457         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3458             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3459             88  PB-INVALID-AH               VALUE '  ' '00'
  3460                                                   '90' THRU '99'.
  3461         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3462         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3463         16  PB-I-AH-CALC-FLAG            PIC X.
  3464             88 PB-COMP-AH-PREM                  VALUE '?'.
  3465         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3466         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3467         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  3468         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3469         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3470         16  PB-I-AH-ABBR                 PIC XXX.
  3471         16  PB-I-AH-INPUT-CD             PIC XXX.
  3472
  3473         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3474         16  PB-I-REIN-TABLE              PIC XXX.
  3475         16  PB-I-BUSINESS-TYPE           PIC 99.
  3476         16  PB-I-INDV-GRP-CD             PIC X.
  3477         16  PB-I-MORT-CODE.
  3478             20  PB-I-TABLE               PIC X.
  3479             20  PB-I-INTEREST            PIC XX.
  3480             20  PB-I-MORT-TYP            PIC X.
  3481         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3482         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3483         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3484         16  PB-I-INDV-GRP-OVRD           PIC X.
  3485         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3486         16  PB-I-SIG-SW                  PIC X.
  3487             88  PB-POLICY-SIGNED             VALUE 'Y'.
  3488         16  PB-I-RATE-CLASS              PIC XX.
  3489         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3490         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3491         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  70
* EL630.cbl
  3492         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3493         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3494         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3495         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3496         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3497         16  PB-I-OB-FLAG                 PIC X.
  3498             88  PB-I-OB                      VALUE 'B'.
  3499             88  PB-I-SUMMARY                 VALUE 'Z'.
  3500         16  PB-I-ENTRY-STATUS            PIC X.
  3501             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3502                                              'M' '5' '9' '2'.
  3503             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3504             88  PB-I-POLICY-PENDING          VALUE '2'.
  3505             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3506             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3507             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  3508             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3509             88  PB-I-REIN-ONLY               VALUE '9'.
  3510             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3511             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3512             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3513             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3514         16  PB-I-INT-CODE                PIC X.
  3515             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3516             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3517         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3518         16  PB-I-SOC-SEC-NO              PIC X(11).
  3519         16  PB-I-MEMBER-NO               PIC X(12).
  3520         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3521*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3522         16  PB-I-OLD-LOF                 PIC XXX.
  3523         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3524         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3525         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3526         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3527         16  PB-I-LIFE-INDICATOR          PIC X.
  3528             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3529         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3530         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3531                                          PIC S9(5)V99    COMP-3.
  3532         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3533             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3534             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3535         16  PB-I-1ST-PMT-DT              PIC XX.
  3536         16  PB-I-JOINT-INSURED.
  3537             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3538             20 PB-I-JOINT-FIRST-NAME.
  3539                24  PB-I-JOINT-FIRST-INIT PIC X.
  3540                24  FILLER                PIC X(9).
  3541             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3542*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3543         16  PB-I-BENEFICIARY-NAME.
  3544             20  PB-I-BANK-NUMBER         PIC X(10).
  3545             20  FILLER                   PIC X(15).
  3546         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  3547         16  PB-I-REFERENCE               PIC X(12).
  3548         16  FILLER REDEFINES PB-I-REFERENCE.
  3549             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  71
* EL630.cbl
  3550             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3551             20  PB-I-CLP-STATE           PIC XX.
  3552         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3553             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3554             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3555             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3556         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3557         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3558         16  PB-I-RESIDENT-STATE          PIC XX.
  3559         16  PB-I-RATE-CODE               PIC X(4).
  3560         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3561         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3562         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3563         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3564         16  PB-I-BANK-NOCHRGB            PIC 99.
  3565         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3566         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3567
  3568     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3569         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3570             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3571         16  PB-C-CANCEL-ORIGIN           PIC X.
  3572             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3573         16  PB-C-LF-CANCEL-DT            PIC XX.
  3574         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3575         16  PB-C-LF-CALC-REQ             PIC X.
  3576             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3577         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3578         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3579         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3580             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3581         16  PB-C-AH-CANCEL-DT            PIC XX.
  3582         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3583         16  PB-C-AH-CALC-REQ             PIC X.
  3584             88 PB-COMP-AH-CANCEL            VALUE '?'.
  3585         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  3586         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  3587         16  PB-C-LAST-NAME               PIC X(15).
  3588         16  PB-C-REFUND-SW               PIC X.
  3589             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  3590             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  3591         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  3592         16  PB-C-PAYEE-CODE              PIC X(6).
  3593         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  3594         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  3595         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  3596         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  3597         16  PB-C-REFERENCE               PIC X(12).
  3598         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3599         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3600         16  PB-C-POST-CARD-IND           PIC X.
  3601         16  PB-C-CANCEL-REASON           PIC X.
  3602         16  PB-C-REF-INTERFACE-SW        PIC X.
  3603         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  3604         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  3605         16  FILLER                       PIC X(01).
  3606*        16  FILLER                       PIC X(18).
  3607         16  PB-C-POLICY-FORM-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  72
* EL630.cbl
  3608*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  3609         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  3610         16  PB-CANCELED-CERT-DATA.
  3611             20  PB-CI-INSURED-NAME.
  3612                 24  PB-CI-LAST-NAME      PIC X(15).
  3613                 24  PB-CI-INITIALS       PIC XX.
  3614             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  3615             20  PB-CI-INSURED-SEX        PIC X.
  3616             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  3617             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  3618             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  3619             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  3620             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3621             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  3622             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  3623             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  3624             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  3625             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3626             20  PB-CI-RATE-CLASS         PIC XX.
  3627             20  PB-CI-RATE-DEV-LF        PIC XXX.
  3628             20  PB-CI-RATE-DEV-AH        PIC XXX.
  3629             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  3630             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  3631             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  3632             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  3633             20  PB-CI-LF-ABBR            PIC X(3).
  3634             20  PB-CI-AH-ABBR            PIC X(3).
  3635             20  PB-CI-OB-FLAG            PIC X.
  3636                 88  PB-CI-OB                VALUE 'B'.
  3637             20  PB-CI-LF-POLICY-STATUS   PIC X.
  3638                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  3639                                           'M' '4' '5' '9' '2'.
  3640                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  3641                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  3642                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  3643                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  3644                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  3645                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  3646                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3647                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  3648                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3649                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  3650                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  3651                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  3652                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  3653             20  PB-CI-AH-POLICY-STATUS   PIC X.
  3654                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  3655                                           'M' '4' '5' '9' '2'.
  3656                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  3657                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  3658                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  3659                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  3660                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  3661                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  3662                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3663                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  3664                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3665                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  73
* EL630.cbl
  3666                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  3667                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  3668                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  3669             20  PB-CI-PAY-FREQUENCY      PIC 99.
  3670             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  3671             20  PB-CI-SOC-SEC-NO         PIC X(11).
  3672             20  PB-CI-MEMBER-NO          PIC X(12).
  3673             20  PB-CI-INT-CODE           PIC X.
  3674                 88  PB-CI-ADD-ON                  VALUE 'A'.
  3675                 88  PB-CI-SIMPLE                  VALUE 'S'.
  3676             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  3677             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  3678             20  PB-CI-COMP-EXCP-SW       PIC X.
  3679                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  3680                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  3681             20  PB-CI-ENTRY-STATUS       PIC X.
  3682             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  3683             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  3684             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  3685             20  PB-CI-DEATH-DT           PIC XX.
  3686             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  3687             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  3688             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3689             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3690             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  3691             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  3692             20  PB-CI-ENTRY-DT              PIC XX.
  3693             20  PB-CI-ENTRY-BATCH           PIC X(6).
  3694             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  3695             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  3696             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  3697             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  3698             20  PB-CI-OLD-LOF               PIC XXX.
  3699*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  3700             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  3701             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  3702             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  3703             20  PB-CI-INDV-GRP-CD           PIC X.
  3704             20  PB-CI-BENEFICIARY-NAME.
  3705                 24  PB-CI-BANK-NUMBER       PIC X(10).
  3706                 24  FILLER                  PIC X(15).
  3707             20  PB-CI-NOTE-SW               PIC X.
  3708             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  3709             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  3710             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  3711             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  3712             20  PB-CI-LOAN-OFFICER          PIC X(5).
  3713             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  3714             20  PB-CI-FIRST-NAME            PIC X(10).
  3715             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  3716
  3717         16  FILLER                       PIC X(13).
  3718*032306  16  FILLER                       PIC X(27).
  3719*        16  FILLER                       PIC X(46).
  3720
  3721     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  3722         16  FILLER                       PIC X(10).
  3723         16  PB-M-INSURED-LAST-NAME       PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  74
* EL630.cbl
  3724         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  3725         16  PB-M-INSURED-MID-INIT        PIC X.
  3726         16  PB-M-INSURED-AGE             PIC 99.
  3727         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  3728         16  PB-M-INSURED-SEX             PIC X.
  3729         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  3730         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  3731         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  3732         16  PB-M-INSURED-CITY-STATE.
  3733             20  PB-M-INSURED-CITY        PIC X(28).
  3734             20  PB-M-INSURED-STATE       PIC XX.
  3735         16  PB-M-INSURED-ZIP-CODE.
  3736             20  PB-M-INSURED-ZIP-PRIME.
  3737                 24  PB-M-INSURED-ZIP-1   PIC X.
  3738                     88  PB-M-CANADIAN-POST-CODE
  3739                                             VALUE 'A' THRU 'Z'.
  3740                 24  FILLER               PIC X(4).
  3741             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  3742         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  3743                                        PB-M-INSURED-ZIP-CODE.
  3744             20  PM-M-INS-CAN-POST1       PIC XXX.
  3745             20  PM-M-INS-CAN-POST2       PIC XXX.
  3746             20  FILLER                   PIC XXX.
  3747         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  3748         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  3749         16  PB-M-CRED-BENE-NAME          PIC X(30).
  3750         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  3751         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  3752         16  PB-M-CRED-BENE-CITYST.
  3753             20  PB-M-CRED-BENE-CITY      PIC X(28).
  3754             20  PB-M-CRED-BENE-STATE     PIC XX.
  3755         16  FILLER                       PIC X(92).
  3756
  3757     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  3758         16  FILLER                       PIC X(10).
  3759         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3760         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3761         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3762         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3763         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3764         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3765         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3766         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3767         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3768         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3769         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3770         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3771         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  3772         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  3773         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  3774         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  3775         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  3776         16  PB-ACCOUNT-NAME              PIC X(30).
  3777         16  PB-PREM-REF-RPT-FLAG         PIC X.
  3778         16  PB-REFERENCE                 PIC X(12).
  3779         16  PB-B-RECEIVED-DT             PIC XX.
  3780         16  FILLER                       PIC X(234).
  3781
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  75
* EL630.cbl
  3782     12  PB-RECORD-STATUS.
  3783         16  PB-CREDIT-SELECT-DT          PIC XX.
  3784         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  3785         16  PB-BILLED-DT                 PIC XX.
  3786         16  PB-BILLING-STATUS            PIC X.
  3787             88  PB-ENTRY-REVERSED            VALUE 'R'.
  3788             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  3789             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  3790         16  PB-RECORD-BILL               PIC X.
  3791             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  3792             88  PB-RECORD-RETURNED           VALUE 'R'.
  3793             88  PB-RECORD-ENDORSED           VALUE 'E'.
  3794             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  3795             88  PB-OVERRIDE-AH               VALUE 'A'.
  3796             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  3797         16  PB-BATCH-ENTRY               PIC X.
  3798             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  3799             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  3800             88  PB-REISSUED-CERT             VALUE 'E'.
  3801             88  PB-CASH-CERT                 VALUE 'C'.
  3802             88  PB-MONTHLY-CERT              VALUE 'M'.
  3803             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  3804             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  3805             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  3806         16  PB-FORCE-CODE                PIC X.
  3807             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  3808             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  3809             88  PB-CANCEL-FORCE              VALUE '8'.
  3810             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  3811             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  3812             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  3813             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  3814             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  3815             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  3816             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  3817             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  3818         16  PB-FATAL-FLAG                PIC X.
  3819             88  PB-FATAL-ERRORS              VALUE 'X'.
  3820         16  PB-FORCE-ER-CD               PIC X.
  3821             88  PB-FORCE-ERRORS              VALUE 'F'.
  3822             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  3823         16  PB-WARN-ER-CD                PIC X.
  3824             88  PB-WARNING-ERRORS            VALUE 'W'.
  3825         16  FILLER                       PIC X.
  3826         16  PB-OUT-BAL-CD                PIC X.
  3827             88  PB-OUT-OF-BAL                VALUE 'O'.
  3828         16  PB-LIFE-OVERRIDE-L1          PIC X.
  3829         16  PB-AH-OVERRIDE-L1            PIC X.
  3830         16  PB-INPUT-DT                  PIC XX.
  3831         16  PB-INPUT-BY                  PIC X(4).
  3832         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  3833         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  3834         16  PB-TOLERANCE-REJECT-SW       PIC X.
  3835         16  PB-LF-EARNING-METHOD         PIC X.
  3836         16  PB-AH-EARNING-METHOD         PIC X.
  3837         16  PB-LF-TERM-CALC-METHOD       PIC X.
  3838         16  PB-AH-TERM-CALC-METHOD       PIC X.
  3839         16  PB-REIN-CD                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  76
* EL630.cbl
  3840         16  PB-LF-REFUND-TYPE            PIC X.
  3841         16  PB-AH-REFUND-TYPE            PIC X.
  3842         16  PB-ACCT-EFF-DT               PIC XX.
  3843         16  PB-ACCT-EXP-DT               PIC XX.
  3844         16  PB-COMPANY-ID                PIC X(3).
  3845         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3846         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3847         16  PB-SV-CARRIER                PIC X.
  3848         16  PB-SV-GROUPING               PIC X(6).
  3849         16  PB-SV-STATE                  PIC XX.
  3850         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  3851         16  PB-GA-BILLING-INFO.
  3852             20  PB-GA-BILL-DT OCCURS 5 TIMES
  3853                                          PIC XX.
  3854         16  PB-SV-REMIT-TO  REDEFINES
  3855             PB-GA-BILLING-INFO           PIC X(10).
  3856         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  3857         16  PB-I-LOAN-OFFICER            PIC X(5).
  3858         16  PB-I-VIN                     PIC X(17).
  3859
  3860         16  FILLER                       PIC X(04).
  3861         16  IMNET-BYPASS-SW              PIC X.
  3862
  3863******************************************************************
  3864*                COMMON EDIT ERRORS                              *
  3865******************************************************************
  3866
  3867     12  PB-COMMON-ERRORS.
  3868         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  3869                                           PIC S9(4)     COMP.
  3870
  3871******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  77
* EL630.cbl
  3873*    COPY ERCACCT.
  3874******************************************************************
  3875*                                                                *
  3876*                                                                *
  3877*                            ERCACCT                             *
  3878*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3879*                            VMOD=2.031                          *
  3880*                                                                *
  3881*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3882*                                                                *
  3883*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3884*   VSAM ACCOUNT MASTER FILES.                                   *
  3885*                                                                *
  3886*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3887*                                                                *
  3888*   FILE TYPE = VSAM,KSDS                                        *
  3889*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3890*                                                                *
  3891*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3892*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3893*                                                                *
  3894*   LOG = NO                                                     *
  3895*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3896*                                                                *
  3897*                                                                *
  3898******************************************************************
  3899*                   C H A N G E   L O G
  3900*
  3901* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3902*-----------------------------------------------------------------
  3903*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3904* EFFECTIVE    NUMBER
  3905*-----------------------------------------------------------------
  3906* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3907* 092705    2005050300006  PEMA  ADD SPP LEASES
  3908* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3909* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3910* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3911* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3912* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3913* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  3914******************************************************************
  3915
  3916 01  ACCOUNT-MASTER.
  3917     12  AM-RECORD-ID                      PIC XX.
  3918         88  VALID-AM-ID                      VALUE 'AM'.
  3919
  3920     12  AM-CONTROL-PRIMARY.
  3921         16  AM-COMPANY-CD                 PIC X.
  3922         16  AM-MSTR-CNTRL.
  3923             20  AM-CONTROL-A.
  3924                 24  AM-CARRIER            PIC X.
  3925                 24  AM-GROUPING.
  3926                     28 AM-GROUPING-PREFIX PIC XXX.
  3927                     28 AM-GROUPING-PRIME  PIC XXX.
  3928                 24  AM-STATE              PIC XX.
  3929                 24  AM-ACCOUNT.
  3930                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  78
* EL630.cbl
  3931                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3932             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3933                                           PIC X(19).
  3934             20  AM-CNTRL-B.
  3935                 24  AM-EXPIRATION-DT      PIC XX.
  3936                 24  FILLER                PIC X(4).
  3937             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3938                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3939
  3940     12  AM-CONTROL-BY-VAR-GRP.
  3941         16  AM-COMPANY-CD-A1              PIC X.
  3942         16  AM-VG-CARRIER                 PIC X.
  3943         16  AM-VG-GROUPING                PIC X(6).
  3944         16  AM-VG-STATE                   PIC XX.
  3945         16  AM-VG-ACCOUNT                 PIC X(10).
  3946         16  AM-VG-DATE.
  3947             20  AM-VG-EXPIRATION-DT       PIC XX.
  3948             20  FILLER                    PIC X(4).
  3949         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3950                                           PIC 9(11)      COMP-3.
  3951     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3952         16  FILLER                        PIC X(10).
  3953         16  AM-VG-KEY3.
  3954             20  AM-VG3-ACCOUNT            PIC X(10).
  3955             20  AM-VG3-EXP-DT             PIC XX.
  3956         16  FILLER                        PIC X(4).
  3957     12  AM-MAINT-INFORMATION.
  3958         16  AM-LAST-MAINT-DT              PIC XX.
  3959         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3960         16  AM-LAST-MAINT-USER            PIC X(4).
  3961         16  FILLER                        PIC XX.
  3962
  3963     12  AM-EFFECTIVE-DT                   PIC XX.
  3964     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3965
  3966     12  AM-PREV-DATES  COMP-3.
  3967         16  AM-PREV-EXP-DT                PIC 9(11).
  3968         16  AM-PREV-EFF-DT                PIC 9(11).
  3969
  3970     12  AM-REPORT-CODE-1                  PIC X(10).
  3971     12  AM-REPORT-CODE-2                  PIC X(10).
  3972
  3973     12  AM-CITY-CODE                      PIC X(4).
  3974     12  AM-COUNTY-PARISH                  PIC X(6).
  3975
  3976     12  AM-NAME                           PIC X(30).
  3977     12  AM-PERSON                         PIC X(30).
  3978     12  AM-ADDRS                          PIC X(30).
  3979     12  AM-CITY.
  3980         16  AM-ADDR-CITY                  PIC X(28).
  3981         16  AM-ADDR-STATE                 PIC XX.
  3982     12  AM-ZIP.
  3983         16  AM-ZIP-PRIME.
  3984             20  AM-ZIP-PRI-1ST            PIC X.
  3985                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3986             20  FILLER                    PIC X(4).
  3987         16  AM-ZIP-PLUS4                  PIC X(4).
  3988     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  79
* EL630.cbl
  3989         16  AM-CAN-POSTAL-1               PIC XXX.
  3990         16  AM-CAN-POSTAL-2               PIC XXX.
  3991         16  FILLER                        PIC XXX.
  3992     12  AM-TEL-NO.
  3993         16  AM-AREA-CODE                  PIC 999.
  3994         16  AM-TEL-PRE                    PIC 999.
  3995         16  AM-TEL-NBR                    PIC 9(4).
  3996     12  AM-TEL-LOC                        PIC X.
  3997         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3998         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3999
  4000     12  AM-COMM-STRUCTURE.
  4001         16  AM-DEFN-1.
  4002             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4003                 24  AM-AGT.
  4004                     28  AM-AGT-PREFIX     PIC X(4).
  4005                     28  AM-AGT-PRIME      PIC X(6).
  4006                 24  AM-COM-TYP            PIC X.
  4007                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4008                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4009                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4010                 24  AM-RECALC-LV-INDIC    PIC X.
  4011                 24  AM-RETRO-LV-INDIC     PIC X.
  4012                 24  AM-GL-CODES           PIC X.
  4013                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4014                 24  FILLER                PIC X(01).
  4015         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4016             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4017                 24  FILLER                PIC X(11).
  4018                 24  AM-L-COMA             PIC XXX.
  4019                 24  AM-J-COMA             PIC XXX.
  4020                 24  AM-A-COMA             PIC XXX.
  4021                 24  FILLER                PIC X(6).
  4022
  4023     12  AM-COMM-CHANGE-STATUS             PIC X.
  4024         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4025
  4026     12  AM-CSR-CODE                       PIC X(4).
  4027
  4028     12  AM-BILLING-STATUS                 PIC X.
  4029         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4030         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4031     12  AM-AUTO-REFUND-SW                 PIC X.
  4032         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4033         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4034     12  AM-GPCD                           PIC 99.
  4035     12  AM-IG                             PIC X.
  4036         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4037         88  AM-HAS-GROUP                     VALUE '2'.
  4038     12  AM-STATUS                         PIC X.
  4039         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4040         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4041         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4042         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4043         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4044         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4045         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  4046         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  80
* EL630.cbl
  4047         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  4048         88  AM-ACCOUNT-PENDING               VALUE '9'.
  4049     12  AM-REMIT-TO                       PIC 99.
  4050     12  AM-ID-NO                          PIC X(11).
  4051
  4052     12  AM-CAL-TABLE                      PIC XX.
  4053     12  AM-LF-DEVIATION                   PIC XXX.
  4054     12  AM-AH-DEVIATION                   PIC XXX.
  4055     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4056     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4057     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4058     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4059     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4060     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4061
  4062     12  AM-USER-FIELDS.
  4063         16  AM-FLD-1                      PIC XX.
  4064         16  AM-FLD-2                      PIC XX.
  4065         16  AM-FLD-3                      PIC XX.
  4066         16  AM-FLD-4                      PIC XX.
  4067         16  AM-FLD-5                      PIC XX.
  4068
  4069     12  AM-1ST-PROD-DATE.
  4070         16  AM-1ST-PROD-YR                PIC XX.
  4071         16  AM-1ST-PROD-MO                PIC XX.
  4072         16  AM-1ST-PROD-DA                PIC XX.
  4073     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4074     12  AM-CERTS-PURGED-DATE.
  4075         16  AM-PUR-YR                     PIC XX.
  4076         16  AM-PUR-MO                     PIC XX.
  4077         16  AM-PUR-DA                     PIC XX.
  4078     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4079     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4080     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4081     12  AM-INACTIVE-DATE.
  4082         16  AM-INA-MO                     PIC 99.
  4083         16  AM-INA-DA                     PIC 99.
  4084         16  AM-INA-YR                     PIC 99.
  4085     12  AM-AR-HI-CERT-DATE                PIC XX.
  4086
  4087     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4088     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4089
  4090     12  AM-OB-PAYMENT-MODE                PIC X.
  4091         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4092         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4093         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4094         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4095
  4096     12  AM-AH-ONLY-INDICATOR              PIC X.
  4097         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4098         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4099
  4100     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4101
  4102     12  AM-OVER-SHORT.
  4103         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4104         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  81
* EL630.cbl
  4105
  4106     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4107     12  AM-DCC-CLP-STATE                  PIC XX.
  4108
  4109     12  AM-RECALC-COMM                    PIC X.
  4110     12  AM-RECALC-REIN                    PIC X.
  4111
  4112     12  AM-REI-TABLE                      PIC XXX.
  4113     12  AM-REI-ET-LF                      PIC X.
  4114     12  AM-REI-ET-AH                      PIC X.
  4115     12  AM-REI-PE-LF                      PIC X.
  4116     12  AM-REI-PE-AH                      PIC X.
  4117     12  AM-REI-PRT-ST                     PIC X.
  4118     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4119     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4120     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4121     12  AM-REI-GROUP-A                    PIC X(6).
  4122     12  AM-REI-MORT                       PIC X(4).
  4123     12  AM-REI-PRT-OW                     PIC X.
  4124     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4125     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4126     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4127     12  AM-REI-GROUP-B                    PIC X(6).
  4128
  4129     12  AM-TRUST-TYPE                     PIC X(2).
  4130
  4131     12  AM-EMPLOYER-STMT-USED             PIC X.
  4132     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4133
  4134     12  AM-STD-AH-TYPE                    PIC XX.
  4135     12  AM-EARN-METHODS.
  4136         16  AM-EARN-METHOD-R              PIC X.
  4137             88 AM-REF-RL-R78                 VALUE 'R'.
  4138             88 AM-REF-RL-PR                  VALUE 'P'.
  4139             88 AM-REF-RL-MEAN                VALUE 'M'.
  4140             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4141         16  AM-EARN-METHOD-L              PIC X.
  4142             88 AM-REF-LL-R78                 VALUE 'R'.
  4143             88 AM-REF-LL-PR                  VALUE 'P'.
  4144             88 AM-REF-LL-MEAN                VALUE 'M'.
  4145             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4146         16  AM-EARN-METHOD-A              PIC X.
  4147             88 AM-REF-AH-R78                 VALUE 'R'.
  4148             88 AM-REF-AH-PR                  VALUE 'P'.
  4149             88 AM-REF-AH-MEAN                VALUE 'M'.
  4150             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4151             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4152             88 AM-REF-AH-NET                 VALUE 'N'.
  4153
  4154     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4155     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4156     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4157
  4158     12  AM-RET-Y-N                        PIC X.
  4159     12  AM-RET-P-E                        PIC X.
  4160     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4161     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4162     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  82
* EL630.cbl
  4163     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4164         16  AM-POOL-PRIME                 PIC XXX.
  4165         16  AM-POOL-SUB                   PIC XXX.
  4166     12  AM-RETRO-EARNINGS.
  4167         16  AM-RET-EARN-R                 PIC X.
  4168         16  AM-RET-EARN-L                 PIC X.
  4169         16  AM-RET-EARN-A                 PIC X.
  4170     12  AM-RET-ST-TAX-USE                 PIC X.
  4171         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4172         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4173     12  AM-RETRO-BEG-EARNINGS.
  4174         16  AM-RET-BEG-EARN-R             PIC X.
  4175         16  AM-RET-BEG-EARN-L             PIC X.
  4176         16  AM-RET-BEG-EARN-A             PIC X.
  4177     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4178     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4179
  4180     12  AM-USER-SELECT-OPTIONS.
  4181         16  AM-USER-SELECT-1              PIC X(10).
  4182         16  AM-USER-SELECT-2              PIC X(10).
  4183         16  AM-USER-SELECT-3              PIC X(10).
  4184         16  AM-USER-SELECT-4              PIC X(10).
  4185         16  AM-USER-SELECT-5              PIC X(10).
  4186
  4187     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4188
  4189     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4190
  4191     12  AM-RPT045A-SWITCH                 PIC X.
  4192         88  RPT045A-OFF                   VALUE 'N'.
  4193
  4194     12  AM-INSURANCE-LIMITS.
  4195         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4196         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4197
  4198     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4199         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4200
  4201     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4202         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4203         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4204
  4205     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4206
  4207     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4208     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4209     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4210     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4211     12  AM-DCC-UEF-STATE                  PIC XX.
  4212     12  FILLER                            PIC XXX.
  4213     12  AM-REPORT-CODE-3                  PIC X(10).
  4214*    12  FILLER                            PIC X(22).
  4215
  4216     12  AM-RESERVE-DATE.
  4217         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4218         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4219         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4220
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  83
* EL630.cbl
  4221     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4222     12  AM-NOTIFICATION-TYPES.
  4223         16  AM-NOTIF-OF-LETTERS           PIC X.
  4224         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4225         16  AM-NOTIF-OF-REPORTS           PIC X.
  4226         16  AM-NOTIF-OF-STATUS            PIC X.
  4227
  4228     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4229         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4230         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4231         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4232         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4233
  4234     12  AM-BENEFIT-CONTROLS.
  4235         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4236             20  AM-BENEFIT-CODE           PIC XX.
  4237             20  AM-BENEFIT-TYPE           PIC X.
  4238             20  AM-BENEFIT-REVISION       PIC XXX.
  4239             20  AM-BENEFIT-REM-TERM       PIC X.
  4240             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4241             20  FILLER                    PIC XX.
  4242         16  FILLER                        PIC X(80).
  4243
  4244     12  AM-TRANSFER-DATA.
  4245         16  AM-TRANSFERRED-FROM.
  4246             20  AM-TRNFROM-CARRIER        PIC X.
  4247             20  AM-TRNFROM-GROUPING.
  4248                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4249                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4250             20  AM-TRNFROM-STATE          PIC XX.
  4251             20  AM-TRNFROM-ACCOUNT.
  4252                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4253                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4254             20  AM-TRNFROM-DTE            PIC XX.
  4255         16  AM-TRANSFERRED-TO.
  4256             20  AM-TRNTO-CARRIER          PIC X.
  4257             20  AM-TRNTO-GROUPING.
  4258                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4259                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4260             20  AM-TRNTO-STATE            PIC XX.
  4261             20  AM-TRNTO-ACCOUNT.
  4262                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4263                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4264             20  AM-TRNTO-DTE              PIC XX.
  4265         16  FILLER                        PIC X(10).
  4266
  4267     12  AM-SAVED-REMIT-TO                 PIC 99.
  4268
  4269     12  AM-COMM-STRUCTURE-SAVED.
  4270         16  AM-DEFN-1-SAVED.
  4271             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4272                 24  AM-AGT-SV             PIC X(10).
  4273                 24  AM-COM-TYP-SV         PIC X.
  4274                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4275                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4276                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4277                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4278                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  84
* EL630.cbl
  4279                 24  AM-GL-CODES-SV        PIC X.
  4280                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4281                 24  FILLER                PIC X.
  4282         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4283             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4284                 24  FILLER                PIC X(11).
  4285                 24  AM-L-COMA-SV          PIC XXX.
  4286                 24  AM-J-COMA-SV          PIC XXX.
  4287                 24  AM-A-COMA-SV          PIC XXX.
  4288                 24  FILLER                PIC X(6).
  4289
  4290     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4291         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4292            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4293            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4294            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4295
  4296     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4297     12  FILLER                            PIC X(120).
  4298
  4299     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4300         16  AM-CONTROL-NAME               PIC X(30).
  4301         16  AM-EXECUTIVE-ONE.
  4302             20  AM-EXEC1-NAME             PIC X(15).
  4303             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4304                                                          COMP-3.
  4305             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4306                                                          COMP-3.
  4307         16  AM-EXECUTIVE-TWO.
  4308             20  AM-EXEC2-NAME             PIC X(15).
  4309             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4310                                                          COMP-3.
  4311             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4312                                                          COMP-3.
  4313
  4314     12  AM-RETRO-ADDITIONAL-DATA.
  4315         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4316         16  AM-RETRO-PREM-P-E             PIC X.
  4317         16  AM-RETRO-CLMS-P-I             PIC X.
  4318         16  AM-RETRO-RET-BRACKET-LF.
  4319             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4320                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4321                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4322             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4323                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4324                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4325             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4326                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4327                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4328         16  AM-RETRO-RET-BRACKET-AH.
  4329             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4330                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4331                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4332                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4333             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4334                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4335                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4336             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  85
* EL630.cbl
  4337                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4338                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4339
  4340     12  AM-COMMENTS.
  4341         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4342
  4343     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4344         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4345         16  AM-FLI-BILLING-CODE           PIC X.
  4346         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4347         16  AM-FLI-UNITED-IDENT           PIC X.
  4348         16  AM-FLI-INTEREST-LOST-DATA.
  4349             20  AM-FLI-BANK-NO            PIC X(5).
  4350             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4351             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4352             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4353         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4354             20  AM-FLI-AGT                PIC X(9).
  4355             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4356             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4357         16  FILLER                        PIC X(102).
  4358
  4359     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4360         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4361             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4362             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4363             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4364             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4365             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4366         16  FILLER                          PIC X(10).
  4367******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  86
* EL630.cbl
  4369*    COPY ELCCERT.
  4370******************************************************************
  4371*                                                                *
  4372*                            ELCCERT.                            *
  4373*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4374*                            VMOD=2.013                          *
  4375*                                                                *
  4376*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4377*                                                                *
  4378*   FILE TYPE = VSAM,KSDS                                        *
  4379*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4380*                                                                *
  4381*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4382*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4383*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4384*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4385*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4386*                                                                *
  4387*   LOG = YES                                                    *
  4388*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4389******************************************************************
  4390*                   C H A N G E   L O G
  4391*
  4392* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4393*-----------------------------------------------------------------
  4394*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4395* EFFECTIVE    NUMBER
  4396*-----------------------------------------------------------------
  4397* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4398* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4399* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4400* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4401* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4402* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4403* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4404* 032612  CR2011110200001  PEMA  AHL CHANGES
  4405* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4406* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4407* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4408******************************************************************
  4409
  4410 01  CERTIFICATE-MASTER.
  4411     12  CM-RECORD-ID                      PIC XX.
  4412         88  VALID-CM-ID                      VALUE 'CM'.
  4413
  4414     12  CM-CONTROL-PRIMARY.
  4415         16  CM-COMPANY-CD                 PIC X.
  4416         16  CM-CARRIER                    PIC X.
  4417         16  CM-GROUPING.
  4418             20  CM-GROUPING-PREFIX        PIC X(3).
  4419             20  CM-GROUPING-PRIME         PIC X(3).
  4420         16  CM-STATE                      PIC XX.
  4421         16  CM-ACCOUNT.
  4422             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4423             20  CM-ACCOUNT-PRIME          PIC X(6).
  4424         16  CM-CERT-EFF-DT                PIC XX.
  4425         16  CM-CERT-NO.
  4426             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  87
* EL630.cbl
  4427             20  CM-CERT-SFX               PIC X.
  4428
  4429     12  CM-CONTROL-BY-NAME.
  4430         16  CM-COMPANY-CD-A1              PIC X.
  4431         16  CM-INSURED-LAST-NAME          PIC X(15).
  4432         16  CM-INSURED-INITIALS.
  4433             20  CM-INSURED-INITIAL1       PIC X.
  4434             20  CM-INSURED-INITIAL2       PIC X.
  4435
  4436     12  CM-CONTROL-BY-SSN.
  4437         16  CM-COMPANY-CD-A2              PIC X.
  4438         16  CM-SOC-SEC-NO.
  4439             20  CM-SSN-STATE              PIC XX.
  4440             20  CM-SSN-ACCOUNT            PIC X(6).
  4441             20  CM-SSN-LN3.
  4442                 25  CM-INSURED-INITIALS-A2.
  4443                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4444                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4445                 25 CM-PART-LAST-NAME-A2         PIC X.
  4446
  4447     12  CM-CONTROL-BY-CERT-NO.
  4448         16  CM-COMPANY-CD-A4              PIC X.
  4449         16  CM-CERT-NO-A4                 PIC X(11).
  4450
  4451     12  CM-CONTROL-BY-MEMB.
  4452         16  CM-COMPANY-CD-A5              PIC X.
  4453         16  CM-MEMBER-NO.
  4454             20  CM-MEMB-STATE             PIC XX.
  4455             20  CM-MEMB-ACCOUNT           PIC X(6).
  4456             20  CM-MEMB-LN4.
  4457                 25  CM-INSURED-INITIALS-A5.
  4458                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4459                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4460                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4461
  4462     12  CM-INSURED-PROFILE-DATA.
  4463         16  CM-INSURED-FIRST-NAME.
  4464             20  CM-INSURED-1ST-INIT       PIC X.
  4465             20  FILLER                    PIC X(9).
  4466         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4467         16  CM-INSURED-SEX                PIC X.
  4468             88  CM-SEX-MALE                  VALUE 'M'.
  4469             88  CM-SEX-FEMAL                 VALUE 'F'.
  4470         16  CM-INSURED-JOINT-AGE          PIC 99.
  4471         16  CM-JOINT-INSURED-NAME.
  4472             20  CM-JT-LAST-NAME           PIC X(15).
  4473             20  CM-JT-FIRST-NAME.
  4474                 24  CM-JT-1ST-INIT        PIC X.
  4475                 24  FILLER                PIC X(9).
  4476             20  CM-JT-INITIAL             PIC X.
  4477
  4478     12  CM-LIFE-DATA.
  4479         16  CM-LF-BENEFIT-CD              PIC XX.
  4480         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4481         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4482         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4483         16  CM-LF-DEV-CODE                PIC XXX.
  4484         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  88
* EL630.cbl
  4485         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4486         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4487         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4488         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4489         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4490         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4491         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4492         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4493         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4494         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4495         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4496         16  cm-temp-epiq                  pic xx.
  4497             88  EPIQ-CLASS                  value 'EQ'.
  4498*        16  FILLER                        PIC XX.
  4499
  4500     12  CM-AH-DATA.
  4501         16  CM-AH-BENEFIT-CD              PIC XX.
  4502         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4503         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4504         16  CM-AH-DEV-CODE                PIC XXX.
  4505         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4506         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4507         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4508         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4509         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4510         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4511         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4512         16  CM-AH-PAID-THRU-DT            PIC XX.
  4513             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4514         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4515         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4516         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4517         16  FILLER                        PIC X.
  4518
  4519     12  CM-LOAN-INFORMATION.
  4520         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4521         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4522                                           PIC S9(5)V99  COMP-3.
  4523         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4524         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4525         16  CM-PAY-FREQUENCY              PIC S99.
  4526         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4527         16  CM-RATE-CLASS                 PIC XX.
  4528         16  CM-BENEFICIARY                PIC X(25).
  4529         16  CM-POLICY-FORM-NO             PIC X(12).
  4530         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4531         16  CM-LAST-ADD-ON-DT             PIC XX.
  4532         16  CM-DEDUCTIBLE-AMOUNTS.
  4533             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4534             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4535         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4536             20  CM-RESIDENT-STATE         PIC XX.
  4537             20  CM-RATE-CODE              PIC X(4).
  4538             20  FILLER                    PIC XX.
  4539         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4540             20  CM-LOAN-OFFICER           PIC X(5).
  4541             20  FILLER                    PIC XXX.
  4542         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  89
* EL630.cbl
  4543         16  CM-UNDERWRITING-CODE          PIC X.
  4544             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4545         16  CM-POST-CARD-IND              PIC X.
  4546         16  CM-REF-INTERFACE-SW           PIC X.
  4547         16  CM-PREMIUM-TYPE               PIC X.
  4548             88  CM-SING-PRM                  VALUE '1'.
  4549             88  CM-O-B-COVERAGE              VALUE '2'.
  4550             88  CM-OPEN-END                  VALUE '3'.
  4551         16  CM-IND-GRP-TYPE               PIC X.
  4552             88  CM-INDIVIDUAL                VALUE 'I'.
  4553             88  CM-GROUP                     VALUE 'G'.
  4554         16  CM-SKIP-CODE                  PIC X.
  4555             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4556             88  SKIP-JULY                    VALUE '1'.
  4557             88  SKIP-AUGUST                  VALUE '2'.
  4558             88  SKIP-SEPTEMBER               VALUE '3'.
  4559             88  SKIP-JULY-AUG                VALUE '4'.
  4560             88  SKIP-AUG-SEPT                VALUE '5'.
  4561             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4562             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4563             88  SKIP-JUNE                    VALUE '8'.
  4564             88  SKIP-JUNE-JULY               VALUE '9'.
  4565             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4566             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4567         16  CM-PAYMENT-MODE               PIC X.
  4568             88  PAY-MONTHLY                  VALUE SPACE.
  4569             88  PAY-WEEKLY                   VALUE '1'.
  4570             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4571             88  PAY-BI-WEEKLY                VALUE '3'.
  4572             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4573         16  CM-LOAN-NUMBER                PIC X(8).
  4574         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4575         16  CM-OLD-LOF                    PIC XXX.
  4576*        16  CM-LOAN-OFFICER               PIC XXX.
  4577         16  CM-REIN-TABLE                 PIC XXX.
  4578         16  CM-SPECIAL-REIN-CODE          PIC X.
  4579         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4580         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4581         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4582
  4583     12  CM-STATUS-DATA.
  4584         16  CM-ENTRY-STATUS               PIC X.
  4585         16  CM-ENTRY-DT                   PIC XX.
  4586
  4587         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4588         16  CM-LF-CANCEL-DT               PIC XX.
  4589         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4590
  4591         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4592         16  CM-LF-DEATH-DT                PIC XX.
  4593         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4594
  4595         16  CM-LF-CURRENT-STATUS          PIC X.
  4596             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4597                                                'M' '4' '5' '9'.
  4598             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4599             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4600             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  90
* EL630.cbl
  4601             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4602             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4603             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4604             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4605             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4606             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4607             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4608             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4609             88  CM-LF-DECLINED               VALUE 'D'.
  4610             88  CM-LF-VOIDED                 VALUE 'V'.
  4611
  4612         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4613         16  CM-AH-CANCEL-DT               PIC XX.
  4614         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4615
  4616         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4617         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4618         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4619
  4620         16  CM-AH-CURRENT-STATUS          PIC X.
  4621             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4622                                                'M' '4' '5' '9'.
  4623             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4624             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4625             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4626             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4627             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4628             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4629             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4630             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4631             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4632             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4633             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4634             88  CM-AH-DECLINED               VALUE 'D'.
  4635             88  CM-AH-VOIDED                 VALUE 'V'.
  4636
  4637         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4638             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4639             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4640             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4641         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4642
  4643         16  CM-ENTRY-BATCH                PIC X(6).
  4644         16  CM-LF-EXIT-BATCH              PIC X(6).
  4645         16  CM-AH-EXIT-BATCH              PIC X(6).
  4646         16  CM-LAST-MONTH-END             PIC XX.
  4647
  4648     12  CM-NOTE-SW                        PIC X.
  4649         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4650         88  CERT-NOTES-PRESENT               VALUE '1'.
  4651         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4652         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4653         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4654         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4655         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4656         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4657     12  CM-COMP-EXCP-SW                   PIC X.
  4658         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  91
* EL630.cbl
  4659         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4660     12  CM-INSURED-ADDRESS-SW             PIC X.
  4661         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4662         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4663
  4664*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4665     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4666     12  FILLER                            PIC X.
  4667
  4668*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4669     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4670     12  FILLER                            PIC X.
  4671*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4672     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4673
  4674     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4675         88  CERT-ADDED-BATCH                 VALUE ' '.
  4676         88  CERT-ADDED-ONLINE                VALUE '1'.
  4677         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4678         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4679         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4680     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4681         88  CERT-AS-LOADED                   VALUE ' '.
  4682         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4683         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4684         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4685         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4686         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4687         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4688         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4689
  4690     12  CM-ACCOUNT-COMM-PCTS.
  4691         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4692         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4693
  4694     12  CM-USER-FIELD                     PIC X.
  4695     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4696     12  CM-CLP-STATE                      PIC XX.
  4697     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4698     12  CM-USER-RESERVED                  PIC XXX.
  4699     12  FILLER REDEFINES CM-USER-RESERVED.
  4700         16  CM-AH-CLASS-CD                PIC XX.
  4701         16  F                             PIC X.
  4702******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  92
* EL630.cbl
  4704*    COPY ERCNOTE.
  4705******************************************************************
  4706*                                                                *
  4707*                                                                *
  4708*                            ERCNOTE                             *
  4709*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4710*                            VMOD=2.003                          *
  4711*                                                                *
  4712*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  4713*                                                                *
  4714*        FILE TYPE= VSAM,KSDS                                    *
  4715*        RECORD SIZE = 825    RECFORM = FIXED                    *
  4716*                                                                *
  4717*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  4718*                                                                *
  4719*        LOG = YES                                               *
  4720*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  4721*                                                                *
  4722******************************************************************
  4723*                   C H A N G E   L O G
  4724*
  4725* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4726*-----------------------------------------------------------------
  4727*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4728* EFFECTIVE    NUMBER
  4729*-----------------------------------------------------------------
  4730* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  4731*                                FILE WILL CONTAIN BILLING NOTES O
  4732* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  4733******************************************************************
  4734
  4735 01  CERTIFICATE-NOTE.
  4736     12  CN-RECORD-ID                PIC  XX.
  4737         88  VALID-CN-ID                  VALUE 'CN'.
  4738
  4739     12  CN-CONTROL-PRIMARY.
  4740         16  CN-COMPANY-CD           PIC X.
  4741         16  CN-CARRIER              PIC X.
  4742         16  CN-GROUPING.
  4743             20 CN-GROUPING-PREFIX   PIC XXX.
  4744             20 CN-GROUPING-PRIME    PIC XXX.
  4745         16  CN-STATE                PIC XX.
  4746         16  CN-ACCOUNT.
  4747             20 CN-ACCOUNT-PREFIX    PIC X(4).
  4748             20 CN-ACCOUNT-PRIME     PIC X(6).
  4749         16  CN-CERT-EFF-DT          PIC XX.
  4750         16  CN-CERT-NO.
  4751             20  CN-CERT-PRIME       PIC X(10).
  4752             20  CN-CERT-SFX         PIC X.
  4753         16  CN-RECORD-TYPE          PIC X.
  4754             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  4755             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  4756     12  CN-BILLING-START-LINE-NO    PIC 99.
  4757     12  CN-BILLING-END-LINE-NO      PIC 99.
  4758
  4759     12  CN-LINES.
  4760         16  CN-LINE OCCURS 10       PIC X(77).
  4761
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  93
* EL630.cbl
  4762     12  CN-LAST-MAINT-DT            PIC XX.
  4763     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  4764     12  CN-LAST-MAINT-USER          PIC X(4).
  4765     12  FILLER                      PIC X(5).
  4766******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  94
* EL630.cbl
  4768*    COPY ERCMAIL.
  4769******************************************************************
  4770*                                                                *
  4771*                                                                *
  4772*                            ERCMAIL                             *
  4773*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4774*                            VMOD=2.003                          *
  4775*                                                                *
  4776*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  4777*                                                                *
  4778*   FILE TYPE = VSAM,KSDS                                        *
  4779*   RECORD SIZE = 374   RECFORM = FIX                            *
  4780*                                                                *
  4781*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  4782*   ALTERNATE PATH    = NOT USED                                 *
  4783*                                                                *
  4784*   LOG = YES                                                    *
  4785*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4786******************************************************************
  4787*                   C H A N G E   L O G
  4788*
  4789* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4790*-----------------------------------------------------------------
  4791*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4792* EFFECTIVE    NUMBER
  4793*-----------------------------------------------------------------
  4794* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  4795* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4796* 111108                   PEMA  ADD CRED BENE ADDR2
  4797******************************************************************
  4798
  4799 01  MAILING-DATA.
  4800     12  MA-RECORD-ID                      PIC XX.
  4801         88  VALID-MA-ID                       VALUE 'MA'.
  4802
  4803     12  MA-CONTROL-PRIMARY.
  4804         16  MA-COMPANY-CD                 PIC X.
  4805         16  MA-CARRIER                    PIC X.
  4806         16  MA-GROUPING.
  4807             20  MA-GROUPING-PREFIX        PIC XXX.
  4808             20  MA-GROUPING-PRIME         PIC XXX.
  4809         16  MA-STATE                      PIC XX.
  4810         16  MA-ACCOUNT.
  4811             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4812             20  MA-ACCOUNT-PRIME          PIC X(6).
  4813         16  MA-CERT-EFF-DT                PIC XX.
  4814         16  MA-CERT-NO.
  4815             20  MA-CERT-PRIME             PIC X(10).
  4816             20  MA-CERT-SFX               PIC X.
  4817
  4818     12  FILLER                            PIC XX.
  4819
  4820     12  MA-ACCESS-CONTROL.
  4821         16  MA-SOURCE-SYSTEM              PIC XX.
  4822             88  MA-FROM-CREDIT                VALUE 'CR'.
  4823             88  MA-FROM-VSI                   VALUE 'VS'.
  4824             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4825             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  95
* EL630.cbl
  4826         16  MA-RECORD-ADD-DT              PIC XX.
  4827         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4828         16  MA-LAST-MAINT-DT              PIC XX.
  4829         16  MA-LAST-MAINT-BY              PIC XXXX.
  4830         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4831
  4832     12  MA-PROFILE-INFO.
  4833         16  MA-QUALIFY-CODE-1             PIC XX.
  4834         16  MA-QUALIFY-CODE-2             PIC XX.
  4835         16  MA-QUALIFY-CODE-3             PIC XX.
  4836         16  MA-QUALIFY-CODE-4             PIC XX.
  4837         16  MA-QUALIFY-CODE-5             PIC XX.
  4838
  4839         16  MA-INSURED-LAST-NAME          PIC X(15).
  4840         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4841         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4842         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4843         16  MA-INSURED-BIRTH-DT           PIC XX.
  4844         16  MA-INSURED-SEX                PIC X.
  4845             88  MA-SEX-MALE                   VALUE 'M'.
  4846             88  MA-SEX-FEMALE                 VALUE 'F'.
  4847         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4848
  4849         16  MA-ADDRESS-CORRECTED          PIC X.
  4850         16  MA-JOINT-BIRTH-DT             PIC XX.
  4851*        16  FILLER                        PIC X(12).
  4852
  4853         16  MA-ADDRESS-LINE-1             PIC X(30).
  4854         16  MA-ADDRESS-LINE-2             PIC X(30).
  4855         16  MA-CITY-STATE.
  4856             20  MA-CITY                   PIC X(28).
  4857             20  MA-ADDR-STATE             PIC XX.
  4858         16  MA-ZIP.
  4859             20  MA-ZIP-CODE.
  4860                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4861                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4862                 24  FILLER                PIC X(4).
  4863             20  MA-ZIP-PLUS4              PIC X(4).
  4864         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4865             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4866             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4867             20  FILLER                    PIC X(3).
  4868
  4869         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4870
  4871         16  FILLER                        PIC XXX.
  4872*        16  FILLER                        PIC X(10).
  4873
  4874     12  MA-CRED-BENE-INFO.
  4875         16  MA-CRED-BENE-NAME                 PIC X(25).
  4876         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4877         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4878         16  MA-CRED-BENE-CTYST.
  4879             20  MA-CRED-BENE-CITY             PIC X(28).
  4880             20  MA-CRED-BENE-STATE            PIC XX.
  4881         16  MA-CRED-BENE-ZIP.
  4882             20  MA-CB-ZIP-CODE.
  4883                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  96
* EL630.cbl
  4884                     88  MA-CB-CANADIAN-POST-CODE
  4885                                           VALUE 'A' THRU 'Z'.
  4886                 24  FILLER                    PIC X(4).
  4887             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4888         16  MA-CB-CANADIAN-POSTAL-CODE
  4889                            REDEFINES MA-CRED-BENE-ZIP.
  4890             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4891             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4892             20  FILLER                        PIC X(3).
  4893     12  MA-POST-CARD-MAIL-DATA.
  4894         16  MA-MAIL-DATA OCCURS 7.
  4895             20  MA-MAIL-TYPE              PIC X.
  4896                 88  MA-12MO-MAILING           VALUE '1'.
  4897                 88  MA-EXP-MAILING            VALUE '2'.
  4898             20  MA-MAIL-STATUS            PIC X.
  4899                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4900                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4901                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4902             20  MA-MAIL-DATE              PIC XX.
  4903     12  FILLER                            PIC XX.
  4904     12  FILLER                            PIC XX.
  4905*    12  FILLER                            PIC X(30).
  4906******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  97
* EL630.cbl
  4908*    COPY ERCPNDM.
  4909******************************************************************
  4910*                                                                *
  4911*                                                                *
  4912*                            ERCPNDM                             *
  4913*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4914*                            VMOD=2.003                          *
  4915*                                                                *
  4916*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  4917*                                                                *
  4918*   FILE TYPE = VSAM,KSDS                                        *
  4919*   RECORD SIZE = 374   RECFORM = FIX                            *
  4920*                                                                *
  4921*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  4922*   ALTERNATE PATH    = NOT USED                                 *
  4923*                                                                *
  4924*   LOG = YES                                                    *
  4925*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4926******************************************************************
  4927*                   C H A N G E   L O G
  4928*
  4929* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4930*-----------------------------------------------------------------
  4931*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4932* EFFECTIVE    NUMBER
  4933*-----------------------------------------------------------------
  4934* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  4935* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  4936* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4937* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  4938******************************************************************
  4939
  4940 01  PENDING-MAILING-DATA.
  4941     12  PM-RECORD-ID                      PIC XX.
  4942         88  VALID-MA-ID                       VALUE 'PM'.
  4943
  4944     12  PM-CONTROL-PRIMARY.
  4945         16  PM-COMPANY-CD                 PIC X.
  4946         16  PM-ENTRY-BATCH                PIC X(6).
  4947         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  4948         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  4949
  4950     12  FILLER                            PIC X(14).
  4951
  4952     12  PM-ACCESS-CONTROL.
  4953         16  PM-SOURCE-SYSTEM              PIC XX.
  4954             88  PM-FROM-CREDIT                VALUE 'CR'.
  4955             88  PM-FROM-VSI                   VALUE 'VS'.
  4956             88  PM-FROM-WARRANTY              VALUE 'WA'.
  4957             88  PM-FROM-OTHER                 VALUE 'OT'.
  4958         16  PM-RECORD-ADD-DT              PIC XX.
  4959         16  PM-RECORD-ADDED-BY            PIC XXXX.
  4960         16  PM-LAST-MAINT-DT              PIC XX.
  4961         16  PM-LAST-MAINT-BY              PIC XXXX.
  4962         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4963
  4964     12  PM-PROFILE-INFO.
  4965         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  98
* EL630.cbl
  4966         16  PM-QUALIFY-CODE-2             PIC XX.
  4967         16  PM-QUALIFY-CODE-3             PIC XX.
  4968         16  PM-QUALIFY-CODE-4             PIC XX.
  4969         16  PM-QUALIFY-CODE-5             PIC XX.
  4970
  4971         16  PM-INSURED-LAST-NAME          PIC X(15).
  4972         16  PM-INSURED-FIRST-NAME         PIC X(10).
  4973         16  PM-INSURED-MIDDLE-INIT        PIC X.
  4974         16  PM-INSURED-ISSUE-AGE          PIC 99.
  4975         16  PM-INSURED-BIRTH-DT           PIC XX.
  4976         16  PM-INSURED-SEX                PIC X.
  4977             88  PM-SEX-MALE                   VALUE 'M'.
  4978             88  PM-SEX-FEMALE                 VALUE 'F'.
  4979         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  4980
  4981         16  PM-ADDRESS-CORRECTED          PIC X.
  4982         16  PM-JOINT-BIRTH-DT             PIC XX.
  4983*        16  FILLER                        PIC X(12).
  4984
  4985         16  PM-ADDRESS-LINE-1             PIC X(30).
  4986         16  PM-ADDRESS-LINE-2             PIC X(30).
  4987         16  PM-CITY-STATE.
  4988             20  PM-CITY                   PIC X(28).
  4989             20  PM-STATE                  PIC XX.
  4990         16  PM-ZIP.
  4991             20  PM-ZIP-CODE.
  4992                 24  PM-ZIP-1              PIC X.
  4993                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4994                 24  FILLER                PIC X(4).
  4995             20  PM-ZIP-PLUS4              PIC X(4).
  4996         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  4997             20  PM-CAN-POST1              PIC XXX.
  4998             20  PM-CAN-POST2              PIC XXX.
  4999             20  FILLER                    PIC XXX.
  5000
  5001         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5002         16  pm-city-st-zip-verified       pic x.
  5003         16  FILLER                        PIC XX.
  5004
  5005     12  PM-CRED-BENE-INFO.
  5006         16  PM-CRED-BENE-NAME             PIC X(25).
  5007         16  PM-CRED-BENE-ADDR             PIC X(30).
  5008         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5009         16  PM-CRED-BENE-CTYST.
  5010             20  PM-CRED-BENE-CITY         PIC X(28).
  5011             20  PM-CRED-BENE-STATE        PIC XX.
  5012         16  PM-CRED-BENE-ZIP.
  5013             20  PM-CB-ZIP-CODE.
  5014                 24  PM-CB-ZIP-1           PIC X.
  5015                     88  PM-CB-CANADIAN-POST-CODE
  5016                                  VALUE 'A' THRU 'Z'.
  5017                 24  FILLER                PIC X(4).
  5018             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5019         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5020             20  PM-CB-CAN-POST1           PIC XXX.
  5021             20  PM-CB-CAN-POST2           PIC XXX.
  5022             20  FILLER                    PIC XXX.
  5023     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  99
* EL630.cbl
  5024         16  PM-MAIL-DATA OCCURS 7.
  5025             20  PM-MAIL-TYPE              PIC X.
  5026                 88  PM-12MO-MAILING           VALUE '1'.
  5027                 88  PM-EXP-MAILING            VALUE '2'.
  5028             20  PM-MAIL-STATUS            PIC X.
  5029                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5030                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5031                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5032             20  PM-MAIL-DATE              PIC XX.
  5033     12  FILLER                            PIC XX.
  5034     12  FILLER                            PIC X(12).
  5035*    12  FILLER                            PIC X(30).
  5036
  5037******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 100
* EL630.cbl
  5039*    COPY ERCCOMP.
  5040******************************************************************
  5041*                                                                *
  5042*                                                                *
  5043*                            ERCCOMP                             *
  5044*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5045*                            VMOD=2.019                          *
  5046*                                                                *
  5047*   ONLINE CREDIT SYSTEM                                         *
  5048*                                                                *
  5049*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  5050*                                                                *
  5051*   FILE TYPE = VSAM,KSDS                                        *
  5052*   RECORD SIZE = 700   RECFORM = FIXED                          *
  5053*                                                                *
  5054*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  5055*       ALTERNATE PATH = NONE                                    *
  5056*                                                                *
  5057*   LOG = NO                                                     *
  5058*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5059*                                                                *
  5060******************************************************************
  5061*                   C H A N G E   L O G
  5062*
  5063* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5064*-----------------------------------------------------------------
  5065*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5066* EFFECTIVE    NUMBER
  5067*-----------------------------------------------------------------
  5068* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5069* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5070* 092205    2005050300006  PEMA  ADD LEASE FEE
  5071* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5072* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5073* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5074* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5075* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5076* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  5077******************************************************************
  5078
  5079 01  COMPENSATION-MASTER.
  5080     12  CO-RECORD-ID                          PIC XX.
  5081         88  VALID-CO-ID                          VALUE 'CO'.
  5082
  5083     12  CO-CONTROL-PRIMARY.
  5084         16  CO-COMPANY-CD                     PIC X.
  5085         16  CO-CONTROL.
  5086             20  CO-CTL-1.
  5087                 24  CO-CARR-GROUP.
  5088                     28  CO-CARRIER            PIC X.
  5089                     28  CO-GROUPING.
  5090                         32  CO-GROUP-PREFIX   PIC XXX.
  5091                         32  CO-GROUP-PRIME    PIC XXX.
  5092                 24  CO-RESP-NO.
  5093                     28  CO-RESP-PREFIX        PIC X(4).
  5094                     28  CO-RESP-PRIME         PIC X(6).
  5095             20  CO-CTL-2.
  5096                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 101
* EL630.cbl
  5097                     28  CO-ACCT-PREFIX        PIC X(4).
  5098                     28  CO-ACCT-PRIME         PIC X(6).
  5099         16  CO-TYPE                           PIC X.
  5100             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5101             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5102             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5103
  5104     12  CO-MAINT-INFORMATION.
  5105         16  CO-LAST-MAINT-DT                  PIC XX.
  5106         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5107         16  CO-LAST-MAINT-USER                PIC X(4).
  5108     12  FILLER                                PIC XX.
  5109     12  CO-STMT-TYPE                          PIC XXX.
  5110     12  CO-COMP-TYPE                          PIC X.
  5111         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5112     12  CO-STMT-OWNER                         PIC X(4).
  5113     12  CO-BALANCE-CONTROL                    PIC X.
  5114         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5115         88  CO-NO-BALANCE                        VALUE 'N'.
  5116
  5117     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5118         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5119         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5120         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5121
  5122     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5123         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5124         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5125
  5126     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5127     12  CO-GA-DIRECT-DEP                      PIC X.
  5128     12  CO-FUTURE-SPACE                       PIC X.
  5129         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5130
  5131     12  CO-ACCT-NAME                          PIC X(30).
  5132     12  CO-MAIL-NAME                          PIC X(30).
  5133     12  CO-ADDR-1                             PIC X(30).
  5134     12  CO-ADDR-2                             PIC X(30).
  5135     12  CO-ADDR-3.
  5136         16  CO-ADDR-CITY                      PIC X(27).
  5137         16  CO-ADDR-STATE                     PIC XX.
  5138     12  CO-CSO-1099                           PIC X.
  5139     12  CO-ZIP.
  5140         16  CO-ZIP-PRIME.
  5141             20  CO-ZIP-PRI-1ST                PIC X.
  5142                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5143             20  FILLER                        PIC X(4).
  5144         16  CO-ZIP-PLUS4                      PIC X(4).
  5145     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5146         16  CO-CAN-POSTAL-1                   PIC XXX.
  5147         16  CO-CAN-POSTAL-2                   PIC XXX.
  5148         16  FILLER                            PIC XXX.
  5149     12  CO-SOC-SEC                            PIC X(13).
  5150     12  CO-TELEPHONE.
  5151         16  CO-AREA-CODE                      PIC XXX.
  5152         16  CO-PREFIX                         PIC XXX.
  5153         16  CO-PHONE                          PIC X(4).
  5154
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 102
* EL630.cbl
  5155     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  5156
  5157     12  CO-AR-BAL-LEVEL                       PIC X.
  5158         88  CO-AR-REF-LVL                        VALUE '1'.
  5159         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5160         88  CO-AR-BILL-LVL                       VALUE '2'.
  5161         88  CO-AR-AGT-LVL                        VALUE '3'.
  5162         88  CO-AR-FR-LVL                         VALUE '4'.
  5163
  5164     12  CO-AR-NORMAL-PRINT                    PIC X.
  5165         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5166         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5167
  5168     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5169
  5170     12  CO-AR-REPORTING                       PIC X.
  5171         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5172         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5173
  5174     12  CO-AR-PULL-CHECK                      PIC X.
  5175         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5176         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5177
  5178     12  CO-AR-BALANCE-PRINT                   PIC X.
  5179         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5180
  5181     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5182         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5183         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5184         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5185
  5186     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5187
  5188     12  CO-USER-CODE                          PIC X.
  5189     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5190
  5191******************************************************************
  5192*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5193*    THE LAST MONTH END RUN.
  5194******************************************************************
  5195
  5196     12  CO-LAST-ACTIVITY-DATE.
  5197         16  CO-ACT-YEAR                       PIC 99.
  5198         16  CO-ACT-MONTH                      PIC 99.
  5199         16  CO-ACT-DAY                        PIC 99.
  5200
  5201     12  CO-LAST-STMT-DT.
  5202         16  CO-LAST-STMT-YEAR                 PIC 99.
  5203         16  CO-LAST-STMT-MONTH                PIC 99.
  5204         16  CO-LAST-STMT-DAY                  PIC 99.
  5205
  5206     12  CO-MO-END-TOTALS.
  5207         16  CO-MONTHLY-TOTALS.
  5208             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5209             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5210             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5211             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5212             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 103
* EL630.cbl
  5213
  5214         16  CO-AGING-TOTALS.
  5215             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5216             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5217             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5218             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5219
  5220         16  CO-YTD-TOTALS.
  5221             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5222             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5223
  5224         16  CO-OVER-UNDER-TOTALS.
  5225             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5226             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5227
  5228     12  CO-MISCELLANEOUS-TOTALS.
  5229         16  CO-FICA-TOTALS.
  5230             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5231             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5232
  5233         16  CO-CLAIM-TOTALS.
  5234             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5235             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5236
  5237******************************************************************
  5238*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5239*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5240******************************************************************
  5241
  5242     12  CO-CURRENT-TOTALS.
  5243         16  CO-CURRENT-LAST-STMT-DT.
  5244             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5245             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5246             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5247
  5248         16  CO-CURRENT-MONTHLY-TOTALS.
  5249             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5250             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5251             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5252             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5253             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5254
  5255         16  CO-CURRENT-AGING-TOTALS.
  5256             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5257             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5258             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5259             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5260
  5261         16  CO-CURRENT-YTD-TOTALS.
  5262             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5263             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5264
  5265     12  CO-PAID-COMM-TOTALS.
  5266         16  CO-YTD-PAID-COMMS.
  5267             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5268             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5269
  5270     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 104
* EL630.cbl
  5271         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  5272         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5273
  5274     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5275         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5276         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5277         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5278         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5279         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5280         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5281         88  CO-FINAL-LETTER                  VALUE 'F'.
  5282         88  CO-RECONCILING                   VALUE 'R'.
  5283         88  CO-PHONE-CALL                    VALUE 'P'.
  5284         88  CO-LEGAL                         VALUE 'L'.
  5285         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5286         88  CO-WRITE-OFF                     VALUE 'W'.
  5287         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5288
  5289     12  CO-CSR-CODE                       PIC X(4).
  5290
  5291     12  CO-GA-STATUS-INFO.
  5292         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5293         16  CO-GA-TERMINATION-DT          PIC XX.
  5294         16  CO-GA-STATUS-CODE             PIC X.
  5295             88  CO-GA-ACTIVE                 VALUE 'A'.
  5296             88  CO-GA-INACTIVE               VALUE 'I'.
  5297             88  CO-GA-PENDING                VALUE 'P'.
  5298         16  CO-GA-COMMENTS.
  5299             20  CO-GA-COMMENT-1           PIC X(40).
  5300             20  CO-GA-COMMENT-2           PIC X(40).
  5301             20  CO-GA-COMMENT-3           PIC X(40).
  5302             20  CO-GA-COMMENT-4           PIC X(40).
  5303
  5304     12  CO-RPTCD2                         PIC X(10).
  5305     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  5306         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  5307         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  5308
  5309     12  CO-TYPE-AGENT                     PIC X(01).
  5310         88  CO-CORPORATION                   VALUE 'C'.
  5311         88  CO-PARTNERSHIP                   VALUE 'P'.
  5312         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5313         88  CO-TRUST                         VALUE 'T'.
  5314         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5315
  5316     12  CO-FAXNO.
  5317         16  CO-FAX-AREA-CODE                  PIC XXX.
  5318         16  CO-FAX-PREFIX                     PIC XXX.
  5319         16  CO-FAX-PHONE                      PIC X(4).
  5320
  5321     12  CO-BANK-INFORMATION.
  5322         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5323         16  CO-BANK-TRANSIT-NON REDEFINES
  5324             CO-BANK-TRANSIT-NO                PIC 9(8).
  5325
  5326         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5327     12  CO-MISC-DEDUCT-INFO REDEFINES
  5328                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 105
* EL630.cbl
  5329         16  CO-MD-GL-ACCT                     PIC X(10).
  5330         16  CO-MD-DIV                         PIC XX.
  5331         16  CO-MD-CENTER                      PIC X(4).
  5332         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  5333         16  CO-CREATE-AP-CHECK                PIC X.
  5334         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5335         16  FILLER                            PIC XXX.
  5336     12  CO-ACH-STATUS                         PIC X.
  5337         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5338         88  CO-ACH-PENDING                        VALUE 'P'.
  5339
  5340     12  CO-BILL-SW                            PIC X.
  5341     12  CO-CONTROL-NAME                       PIC X(30).
  5342     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5343     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5344     12  CO-CLP-STATE                          PIC XX.
  5345     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5346     12  CO-SPP-REFUND-EDIT                    PIC X.
  5347
  5348******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 106
* EL630.cbl
  5350*    COPY ERCRQST.
  5351******************************************************************
  5352*                                                                *
  5353*                                                                *
  5354*                            ERCRQST.                            *
  5355*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5356*                            VMOD=2.002                          *
  5357*                                                                *
  5358*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5359*                                                                *
  5360*   FILE TYPE = VSAM,KSDS                                        *
  5361*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5362*                                                                *
  5363*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5364*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5365*                                   ACCOUNT, REF, BATCH)         *
  5366*                                                RKP=9, LEN=38   *
  5367*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5368*                                   ACCOUNT, REF, BATCH)         *
  5369*                                                RKP=47, LEN=46  *
  5370*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5371*                                   BATCH)                       *
  5372*                                                RKP=93, LEN=24  *
  5373*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5374*                                   REF, BATCH)                  *
  5375*                                                RKP=117, LEN=35 *
  5376*   LOG = NO                                                     *
  5377*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5378******************************************************************
  5379
  5380 01  AR-REQUEST-RECORD.
  5381     12  RQ-RECORD-ID                     PIC XX.
  5382         88  VALID-RQ-ID                        VALUE 'RQ'.
  5383
  5384     12  RQ-CONTROL-PRIMARY.
  5385         16  RQ-COMPANY-CD                PIC X.
  5386         16  RQ-ENTRY-BATCH               PIC X(6).
  5387
  5388     12  RQ-CONTROL-BY-ACCT-REF.
  5389         16  RQ-COMPANY-CD-A1             PIC X.
  5390         16  RQ-CARRIER-A1                PIC X.
  5391         16  RQ-GROUPING-A1               PIC X(6).
  5392         16  RQ-STATE-A1                  PIC XX.
  5393         16  RQ-ACCOUNT-A1                PIC X(10).
  5394         16  RQ-REFERENCE-A1              PIC X(12).
  5395         16  RQ-BATCH-A1                  PIC X(6).
  5396
  5397     12  RQ-CONTROL-BY-FIN-RESP.
  5398         16  RQ-COMPANY-CD-A2             PIC X.
  5399         16  RQ-CARRIER-A2                PIC X.
  5400         16  RQ-GROUPING-A2               PIC X(6).
  5401         16  RQ-FIN-RESP-A2               PIC X(10).
  5402         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5403         16  RQ-REFERENCE-A2              PIC X(12).
  5404         16  RQ-BATCH-A2                  PIC X(6).
  5405
  5406     12  RQ-CONTROL-BY-ACCT-AGENT.
  5407         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 107
* EL630.cbl
  5408         16  RQ-CARRIER-A3                PIC X.
  5409         16  RQ-GROUPING-A3               PIC X(6).
  5410         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5411         16  RQ-BATCH-A3                  PIC X(6).
  5412
  5413     12  RQ-CONTROL-BY-SUMMARY.
  5414         16  RQ-COMPANY-CD-A4             PIC X.
  5415         16  RQ-SUMMARY-CODE              PIC X(6).
  5416         16  RQ-ACCOUNT-A4                PIC X(10).
  5417         16  RQ-REFERENCE-A4              PIC X(12).
  5418         16  RQ-BATCH-A4                  PIC X(6).
  5419
  5420     12  RQ-REQUEST-METHOD                PIC X.
  5421         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5422         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5423         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5424         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5425     12  FILLER                           PIC X.
  5426     12  RQ-STATUS                        PIC X.
  5427         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5428         88  RQ-RESUBMIT                      VALUE 'R'.
  5429     12  RQ-PROCESSOR-ID                  PIC X(4).
  5430     12  RQ-ENTRY-DT                      PIC XX.
  5431     12  RQ-MO-END-DT                     PIC XX.
  5432     12  RQ-REQUEST-DT                    PIC XX.
  5433     12  RQ-STMT-DT                       PIC XX.
  5434     12  RQ-REVERSAL-DT                   PIC XX.
  5435     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5436     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5437
  5438     12  FILLER                           PIC X(27).
  5439
  5440******************************************************************
  5441
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 108
* EL630.cbl
  5443*    COPY ERCCNOT.
  5444******************************************************************
  5445*                                                                *
  5446*                            ERCCNOT                             *
  5447*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5448*                            VMOD=2.003                          *
  5449*                                                                *
  5450*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5451*                                                                *
  5452*        FILE TYPE= VSAM,KSDS                                    *
  5453*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5454*                                                                *
  5455*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5456*                                                                *
  5457*        LOG = YES                                               *
  5458*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5459*                                                                *
  5460******************************************************************
  5461*                   C H A N G E   L O G
  5462*
  5463* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5464*-----------------------------------------------------------------
  5465*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5466* EFFECTIVE    NUMBER
  5467*-----------------------------------------------------------------
  5468* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5469******************************************************************
  5470
  5471 01  CERT-NOTE-FILE.
  5472     12  CZ-RECORD-ID                PIC  XX.
  5473         88  VALID-CZ-ID                  VALUE 'CZ'.
  5474
  5475     12  CZ-CONTROL-PRIMARY.
  5476         16  CZ-COMPANY-CD           PIC X.
  5477         16  CZ-CARRIER              PIC X.
  5478         16  CZ-GROUPING.
  5479             20 CZ-GROUPING-PREFIX   PIC XXX.
  5480             20 CZ-GROUPING-PRIME    PIC XXX.
  5481         16  CZ-STATE                PIC XX.
  5482         16  CZ-ACCOUNT.
  5483             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5484             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5485         16  CZ-CERT-EFF-DT          PIC XX.
  5486         16  CZ-CERT-NO.
  5487             20  CZ-CERT-PRIME       PIC X(10).
  5488             20  CZ-CERT-SFX         PIC X.
  5489         16  CZ-RECORD-TYPE          PIC X.
  5490             88  CERT-NOTE           VALUE '1'.
  5491             88  CLAIM-CERT-NOTE     VALUE '2'.
  5492         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5493
  5494     12  CZ-LAST-MAINT-DT            PIC XX.
  5495     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5496     12  CZ-LAST-MAINT-USER          PIC X(4).
  5497
  5498     12  CZ-NOTE-INFORMATION.
  5499         16  CZ-NOTE                 PIC X(63).
  5500         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 109
* EL630.cbl
  5501******************************************************************
  5502
  5503 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5504                          PENDING-BUSINESS ACCOUNT-MASTER
  5505                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  5506                          MAILING-DATA PENDING-MAILING-DATA
  5507                          COMPENSATION-MASTER AR-REQUEST-RECORD
  5508                          CERT-NOTE-FILE.
  5509 0000-DFHEXIT SECTION.
  5510     MOVE '9#                    $   ' TO DFHEIV0.
  5511     MOVE 'EL630' TO DFHEIV1.
  5512     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5513
  5514     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5515     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  5516     IF EIBCALEN = 0
  5517         GO TO 8800-UNAUTHORIZED-ACCESS.
  5518
  5519     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5520     MOVE '5'                    TO DC-OPTION-CODE.
  5521     PERFORM 9700-DATE-LINK.
  5522
  5523     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  5524     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT.
  5525     MOVE DC-GREG-DATE-1-YMD     TO WS-CURRENT-YMD.
  5526
  5527     MOVE PI-CALLING-PROGRAM TO PI-SAVE-CALLING-PGM.
  5528     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5529         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5530             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5531             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5532             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5533             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5534             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5535             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5536             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5537             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5538             MOVE SPACES               TO PI-PROGRAM-WORK-AREA
  5539                                          PI-MISC
  5540         ELSE
  5541             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5542             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5543             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5544             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5545             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5546             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5547             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5548             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5549
  5550     MOVE LOW-VALUES             TO EL630AI.
  5551
  5552     IF PI-SAVE-CALLING-PGM = XCTL-6302
  5553         GO TO 4000-SHOW-TOTALS.
  5554
  5555     IF PI-SAVE-CALLING-PGM = XCTL-6301 or 'VP6301'
  5556         MOVE 'N'                TO PI-EL630-FIRST-TIME-SW
  5557         IF (PI-CAN-CNT-REMITTED GREATER ZERO OR
  5558             PI-ISS-CNT-REMITTED GREATER ZERO)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 110
* EL630.cbl
  5559                 GO TO 4000-SHOW-TOTALS
  5560         ELSE
  5561         IF PI-ISS-CNT-ENTERED = ZEROS  AND
  5562            PI-CAN-CNT-ENTERED = ZEROS
  5563             MOVE 'Y'            TO PI-VERIFY-DELETE-SW
  5564             GO TO 3000-DELETE-ENTERED-BATCH
  5565         ELSE
  5566             GO TO 4000-SHOW-TOTALS.
  5567
  5568     IF EIBTRNID NOT = TRANS-ID
  5569         MOVE SPACE              TO PI-BROWSE-SW
  5570         MOVE ZEROS              TO PI-LAST-SEQ-NO-ADDED
  5571         MOVE SPACES             TO PI-CR-CONTROL-IN-PROGRESS
  5572         MOVE QUESTION-MARKS     TO BATCHI
  5573         MOVE AL-UANON           TO BATCHA
  5574         GO TO 8100-SEND-INITIAL-MAP.
  5575
  5576
  5577* EXEC CICS HANDLE CONDITION
  5578*        PGMIDERR  (9600-PGMID-ERROR)
  5579*        ERROR     (9990-ABEND)
  5580*    END-EXEC.
  5581*    MOVE '"$L.                  ! " #00005572' TO DFHEIV0
  5582     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5583     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5584     MOVE X'2220233030303035353732' TO DFHEIV0(25:11)
  5585     CALL 'kxdfhei1' USING DFHEIV0
  5586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5587
  5588
  5589     IF EIBAID = DFHCLEAR
  5590        MOVE SPACES              TO PI-ACCT-AGENT-PROCESSED-SW
  5591        GO TO 9400-CLEAR.
  5592
  5593     IF PI-PROCESSOR-ID = 'LGXX'
  5594         GO TO 0200-RECEIVE.
  5595
  5596
  5597* EXEC CICS READQ TS
  5598*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5599*        INTO   (SECURITY-CONTROL)
  5600*        LENGTH (SC-COMM-LENGTH)
  5601*        ITEM   (SC-ITEM)
  5602*    END-EXEC.
  5603*    MOVE '*$II   L              ''   #00005584' TO DFHEIV0
  5604     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5605     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5606     MOVE X'2020233030303035353834' TO DFHEIV0(25:11)
  5607     CALL 'kxdfhei1' USING DFHEIV0,
  5608           PI-SECURITY-TEMP-STORE-ID,
  5609           SECURITY-CONTROL,
  5610           SC-COMM-LENGTH,
  5611           SC-ITEM,
  5612           DFHEIV99,
  5613           DFHEIV99
  5614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5615
  5616
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 111
* EL630.cbl
  5617     MOVE SC-CREDIT-DISPLAY (11)  TO PI-DISPLAY-CAP.
  5618     MOVE SC-CREDIT-UPDATE  (11)  TO PI-MODIFY-CAP.
  5619
  5620     IF NOT DISPLAY-CAP
  5621         MOVE 'READ'          TO SM-READ
  5622         PERFORM 9995-SECURITY-VIOLATION
  5623                              THRU 9995-EXIT
  5624         MOVE ER-0070         TO  EMI-ERROR
  5625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5626         GO TO 8100-SEND-INITIAL-MAP.
  5627
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 112
* EL630.cbl
  5629 0200-RECEIVE.
  5630     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5631         MOVE ER-0008            TO EMI-ERROR
  5632         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5633         MOVE -1                 TO MAINTL
  5634         GO TO 8200-SEND-DATAONLY.
  5635
  5636
  5637* EXEC CICS RECEIVE
  5638*        MAP      (MAP-NAME)
  5639*        MAPSET   (MAPSET-NAME)
  5640*        INTO     (EL630AI)
  5641*    END-EXEC.
  5642     MOVE LENGTH OF
  5643      EL630AI
  5644       TO DFHEIV11
  5645*    MOVE '8"T I  L              ''   #00005610' TO DFHEIV0
  5646     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5647     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5648     MOVE X'2020233030303035363130' TO DFHEIV0(25:11)
  5649     CALL 'kxdfhei1' USING DFHEIV0,
  5650           MAP-NAME,
  5651           EL630AI,
  5652           DFHEIV11,
  5653           MAPSET-NAME,
  5654           DFHEIV99,
  5655           DFHEIV99
  5656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5657
  5658
  5659     IF PFENTERL = 0
  5660         GO TO 0300-CHECK-PFKEYS.
  5661
  5662     IF PFENTERI NUMERIC
  5663        IF PFENTERI GREATER 0 AND LESS 25
  5664           MOVE PF-VALUES (PFENTERI) TO EIBAID
  5665        ELSE
  5666           MOVE ER-0029            TO EMI-ERROR
  5667           GO TO 0320-INPUT-ERROR.
  5668
  5669 0300-CHECK-PFKEYS.
  5670     IF EIBAID = DFHENTER
  5671        IF PI-CLEAR-ERROR
  5672           MOVE -1                 TO PFENTERL
  5673           MOVE ER-2213            TO EMI-ERROR
  5674           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5675           GO TO 4000-SHOW-TOTALS.
  5676
  5677     IF EIBAID = DFHPF23
  5678         GO TO 8810-PF23.
  5679     IF EIBAID = DFHPF24
  5680         GO TO 9200-RETURN-MAIN-MENU.
  5681     IF EIBAID = DFHPF12
  5682         GO TO 9500-PF12.
  5683
  5684     IF EIBAID = DFHPF1
  5685        IF PI-DATA-UPDATED
  5686           MOVE 'Y'            TO WS-PF1-SW
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 113
* EL630.cbl
  5687           MOVE SPACE          TO PI-NB-MONTH-END-DT
  5688                                  PI-CLEAR-ERROR-SW
  5689           PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  5690           MOVE SPACES TO BATCH-TO-PROCESS
  5691           MOVE PI-COMPANY-ID  TO EDIT-COMPANY-ID
  5692           MOVE PI-COMPANY-CD  TO EDIT-COMPANY-CD
  5693           MOVE PI-SAV-ENTRY-BATCH TO EDIT-BATCH
  5694
  5695* EXEC CICS START
  5696*               TRANSID       (EDIT-TRANS)
  5697*               FROM          (BATCH-TO-PROCESS)
  5698*               LENGTH        (PASS-AREA-LEN)
  5699*          END-EXEC
  5700*    MOVE '0( LF                 1   #00005651' TO DFHEIV0
  5701     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  5702     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  5703     MOVE X'2020233030303035363531' TO DFHEIV0(25:11)
  5704     CALL 'kxdfhei1' USING DFHEIV0,
  5705           DFHEIV99,
  5706           EDIT-TRANS,
  5707           DFHEIV99,
  5708           BATCH-TO-PROCESS,
  5709           PASS-AREA-LEN,
  5710           DFHEIV99,
  5711           DFHEIV99,
  5712           DFHEIV99,
  5713           DFHEIV99,
  5714           DFHEIV99,
  5715           DFHEIV99,
  5716           DFHEIV99,
  5717           DFHEIV99,
  5718           DFHEIV99,
  5719           DFHEIV99,
  5720           DFHEIV99
  5721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5722           MOVE PI-SAV-REFERENCE TO PI-SAV-PYAJ-REFERENCE
  5723           MOVE SPACES         TO PI-UPDATE-SW
  5724                                  PI-KEYED-SWITCHES
  5725                                  PI-AGE-KEYED-SW
  5726                                  PI-BIRTHDT-KEYED-SW
  5727                                  PI-ACCT-AGENT-PROCESSED-SW
  5728                                  PI-SAV-REFERENCE
  5729           MOVE ZEROS          TO PI-ISS-CNT-ENTERED
  5730                                  PI-CAN-CNT-ENTERED
  5731           MOVE LOW-VALUES     TO EL630AO
  5732           MOVE SPACE          TO PI-BROWSE-SW
  5733           MOVE QUESTION-MARKS TO BATCHI
  5734           MOVE AL-UANON       TO BATCHA
  5735           MOVE -1             TO MAINTL
  5736           IF EMI-NO-ERRORS
  5737               MOVE ZEROS          TO EMI-ERROR
  5738               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5739               GO TO 8100-SEND-INITIAL-MAP
  5740           ELSE
  5741               GO TO 8100-SEND-INITIAL-MAP
  5742        ELSE
  5743           IF  MAINTI = 'N'
  5744               MOVE -1             TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 114
* EL630.cbl
  5745               MOVE ER-2211        TO EMI-ERROR
  5746               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5747               GO TO 8200-SEND-DATAONLY.
  5748
  5749     IF EIBAID = DFHPF1
  5750        MOVE SPACE          TO PI-NB-MONTH-END-DT
  5751                               PI-CLEAR-ERROR-SW
  5752        MOVE SPACES TO BATCH-TO-PROCESS
  5753        MOVE PI-COMPANY-ID  TO EDIT-COMPANY-ID
  5754        MOVE PI-COMPANY-CD  TO EDIT-COMPANY-CD
  5755        MOVE PI-SAV-ENTRY-BATCH TO EDIT-BATCH
  5756        IF EDIT-BATCH GREATER SPACES
  5757
  5758* EXEC CICS START
  5759*               TRANSID       (EDIT-TRANS)
  5760*               FROM          (BATCH-TO-PROCESS)
  5761*               LENGTH        (PASS-AREA-LEN)
  5762*            END-EXEC
  5763*    MOVE '0( LF                 1   #00005691' TO DFHEIV0
  5764     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  5765     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  5766     MOVE X'2020233030303035363931' TO DFHEIV0(25:11)
  5767     CALL 'kxdfhei1' USING DFHEIV0,
  5768           DFHEIV99,
  5769           EDIT-TRANS,
  5770           DFHEIV99,
  5771           BATCH-TO-PROCESS,
  5772           PASS-AREA-LEN,
  5773           DFHEIV99,
  5774           DFHEIV99,
  5775           DFHEIV99,
  5776           DFHEIV99,
  5777           DFHEIV99,
  5778           DFHEIV99,
  5779           DFHEIV99,
  5780           DFHEIV99,
  5781           DFHEIV99,
  5782           DFHEIV99,
  5783           DFHEIV99
  5784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5785             MOVE SPACES         TO PI-UPDATE-SW
  5786                                    PI-KEYED-SWITCHES
  5787                                    PI-AGE-KEYED-SW
  5788                                    PI-BIRTHDT-KEYED-SW
  5789                                    PI-ACCT-AGENT-PROCESSED-SW
  5790                                    PI-SAV-REFERENCE
  5791             MOVE ZEROS          TO PI-ISS-CNT-ENTERED
  5792                                    PI-CAN-CNT-ENTERED
  5793                                    EMI-ERROR
  5794             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5795             MOVE LOW-VALUES     TO EL630AO
  5796             MOVE SPACE          TO PI-BROWSE-SW
  5797             MOVE QUESTION-MARKS TO BATCHI
  5798             MOVE AL-UANON       TO BATCHA
  5799             MOVE -1             TO MAINTL
  5800             GO TO 8100-SEND-INITIAL-MAP
  5801        ELSE
  5802             MOVE -1             TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 115
* EL630.cbl
  5803             MOVE ER-2211        TO EMI-ERROR
  5804             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5805             GO TO 8200-SEND-DATAONLY.
  5806
  5807     IF EIBAID = DFHPF3
  5808         IF NOT PI-DATA-UPDATED
  5809             MOVE SPACE          TO PI-EL630-FIRST-TIME-SW
  5810             IF PI-AR-PROCESSING
  5811                MOVE XCTL-635       TO PGM-NAME
  5812                GO TO 9300-XCTL
  5813             ELSE
  5814                IF PI-COMPANY-ID = 'DMD'
  5815                   MOVE XCTL-633DMD TO PGM-NAME
  5816                   GO TO 9300-XCTL
  5817                ELSE
  5818                   MOVE XCTL-633    TO PGM-NAME
  5819                   GO TO 9300-XCTL
  5820         ELSE
  5821             MOVE -1             TO BATCHL
  5822             MOVE AL-UABON       TO BATCHA
  5823             MOVE ER-2213        TO EMI-ERROR
  5824             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5825             GO TO 8200-SEND-DATAONLY.
  5826
  5827     IF EIBAID = DFHPF4
  5828         IF NOT PI-EL630-FIRST-TIME
  5829             MOVE XCTL-6302      TO PGM-NAME
  5830             GO TO 9300-XCTL
  5831         ELSE
  5832             PERFORM 0400-PRIME-BATCH-TOTALS THRU 0490-EXIT
  5833             IF EMI-ERROR = ZEROS
  5834                 MOVE 'N'        TO PI-EL630-FIRST-TIME-SW
  5835                 MOVE XCTL-6302  TO PGM-NAME
  5836                 GO TO 9300-XCTL
  5837             ELSE
  5838                 GO TO 8200-SEND-DATAONLY.
  5839
  5840     IF EIBAID = DFHPF5
  5841             IF PI-EL630-FIRST-TIME
  5842                 MOVE -1         TO MAINTL
  5843                 GO TO 8200-SEND-DATAONLY
  5844             ELSE
  5845             IF PI-ISS-CNT-ENTERED = ZEROS  AND
  5846                PI-CAN-CNT-ENTERED = ZEROS
  5847                 MOVE LOW-VALUES TO     EL630AO
  5848                 MOVE QUESTION-MARKS TO BATCHI
  5849                 MOVE AL-UANON   TO     BATCHA
  5850                 MOVE -1         TO     MAINTL
  5851                 GO TO 8100-SEND-INITIAL-MAP
  5852             ELSE
  5853                 MOVE -1         TO BATCHL
  5854                 MOVE AL-UABON   TO BATCHA
  5855                 MOVE ER-2213    TO EMI-ERROR
  5856                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5857                 GO TO 4000-SHOW-TOTALS.
  5858
  5859     IF EIBAID = DFHPF2
  5860        MOVE  AL-UANON           TO  BATCHA
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 116
* EL630.cbl
  5861        MOVE  BATCHI             TO PI-SAV-ENTRY-BATCH
  5862        GO TO 3000-DELETE-ENTERED-BATCH.
  5863
  5864     IF  MAINTI = 'S'
  5865         MOVE  MAINTI            TO  PI-MAINT-FUNC
  5866         PERFORM 0400-PRIME-BATCH-TOTALS  THRU  0490-EXIT
  5867             IF EMI-ERROR = ZEROS
  5868                 MOVE 'N'        TO PI-EL630-FIRST-TIME-SW
  5869                 GO TO 4000-SHOW-TOTALS
  5870             ELSE
  5871                 GO TO 8200-SEND-DATAONLY.
  5872
  5873     IF EIBAID = DFHENTER
  5874         GO TO 0330-EDIT-DATA.
  5875
  5876 0320-INPUT-ERROR.
  5877     MOVE ER-0029                TO EMI-ERROR.
  5878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5879     MOVE AL-UNBON               TO PFENTERA.
  5880     IF PFENTERL = 0
  5881         MOVE -1                 TO MAINTL
  5882     ELSE
  5883         MOVE -1                 TO PFENTERL.
  5884
  5885     GO TO 8200-SEND-DATAONLY.
  5886
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 117
* EL630.cbl
  5888 0330-EDIT-DATA.
  5889     IF MODIFY-CAP
  5890         NEXT SENTENCE
  5891       ELSE
  5892         IF MAINTI NOT = 'S'
  5893           MOVE 'UPDATE'       TO SM-READ
  5894           PERFORM 9995-SECURITY-VIOLATION
  5895                              THRU 9995-EXIT
  5896           MOVE ER-0070        TO EMI-ERROR
  5897           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5898           GO TO 8100-SEND-INITIAL-MAP.
  5899
  5900     MOVE SPACE                  TO  PI-NB-MONTH-END-DT.
  5901
  5902     PERFORM 1250-READ-COMPANY-REC THRU 1250-EXIT.
  5903
  5904     IF MAINTI = 'N' OR 'C' OR 'B' OR 'K'
  5905         NEXT SENTENCE
  5906     ELSE
  5907         MOVE ER-0023            TO EMI-ERROR
  5908         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5909         MOVE -1                 TO MAINTL
  5910         MOVE AL-UABON           TO MAINTA
  5911         GO TO 8200-SEND-DATAONLY.
  5912
  5913     IF PI-CARRIER-SECURITY GREATER SPACES
  5914         IF CARRIERL GREATER ZEROS
  5915           IF PI-CARRIER-SECURITY = CARRIERI
  5916              MOVE AL-UANON       TO CARRIERA
  5917            ELSE
  5918              MOVE -1             TO CARRIERL
  5919              MOVE AL-UABON       TO CARRIERA
  5920              MOVE ER-2370       TO EMI-ERROR
  5921              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5922
  5923     IF PI-ACCOUNT-SECURITY GREATER SPACES
  5924         IF ACCOUNTL GREATER ZEROS
  5925             IF PI-ACCOUNT-SECURITY = ACCOUNTI
  5926                 MOVE AL-UANON   TO ACCOUNTA
  5927               ELSE
  5928                 MOVE -1         TO ACCOUNTL
  5929                 MOVE AL-UABON   TO ACCOUNTA
  5930                 MOVE ER-2371   TO EMI-ERROR
  5931                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5932
  5933     IF  NOT EMI-NO-ERRORS
  5934         GO TO 8200-SEND-DATAONLY.
  5935
  5936     MOVE MAINTI                 TO PI-MAINT-FUNC.
  5937     MOVE AL-UANON               TO MAINTA.
  5938
  5939     MOVE PI-COMPANY-CD          TO PI-SAV-COMP-CD.
  5940     MOVE ZEROS                  TO PI-SAV-BATCH-SEQ
  5941                                    PI-SAV-BATCH-CHG-SEQ.
  5942     MOVE SPACES                 TO PI-SAV-CERT-EFF-DT
  5943                                    PI-SAV-CERT-NO.
  5944
  5945     IF BATCHL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 118
* EL630.cbl
  5946         MOVE -1                 TO BATCHL
  5947         MOVE AL-UNBON           TO BATCHA
  5948         MOVE ER-2201            TO EMI-ERROR
  5949         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5950     ELSE
  5951         IF BATCHI = QUESTION-MARKS OR SPACES
  5952             IF MAINTI = 'N'
  5953                 PERFORM 1300-GET-BATCH-NO THRU 1300-EXIT
  5954             ELSE
  5955                 MOVE -1         TO BATCHL
  5956                 MOVE AL-UNBON   TO BATCHA
  5957                 MOVE ER-2201    TO EMI-ERROR
  5958                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5959         ELSE
  5960             MOVE SPACE TO WS-SWITCH
  5961             PERFORM 0335-FAT-FINGER-EDIT VARYING PIC6-SUB
  5962                 FROM +1 BY +1
  5963                 UNTIL PIC6-SUB > +6 OR QUESTION-MARK-FOUND.
  5964
  5965     IF QUESTION-MARK-FOUND
  5966         IF MAINTI = 'N'
  5967             PERFORM 1300-GET-BATCH-NO THRU 1300-EXIT
  5968         ELSE
  5969             MOVE -1         TO BATCHL
  5970             MOVE AL-UNBON   TO BATCHA
  5971             MOVE ER-2201    TO EMI-ERROR
  5972             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5973     ELSE
  5974         IF BATCHI = PI-SAV-ENTRY-BATCH
  5975             MOVE AL-UANON   TO BATCHA
  5976         ELSE
  5977             MOVE BATCHI TO PI-SAV-ENTRY-BATCH
  5978             IF MAINTI = 'C' OR 'B'
  5979                 MOVE AL-UANON TO BATCHA
  5980                 MOVE ZEROS      TO ELFISSL  ELFCANL
  5981                                    EAHISSL  EAHCANL
  5982                                    EISSCNTL ECANCNTL
  5983                                    PI-LF-ISS-REMITTED
  5984                                    PI-LF-CAN-REMITTED
  5985                                    PI-AH-ISS-REMITTED
  5986                                    PI-AH-CAN-REMITTED
  5987                                    PI-ISS-CNT-REMITTED
  5988                                    PI-CAN-CNT-REMITTED.
  5989
  5990     IF REFL GREATER ZEROS
  5991        MOVE REFI                TO PI-SAV-REFERENCE.
  5992
  5993     IF MAINTI = 'C' OR 'B'
  5994         GO TO 0340-CHECK-TOTALS.
  5995
  5996     IF CARRIERL GREATER ZEROS
  5997         MOVE AL-UANON           TO CARRIERA
  5998         PERFORM 1000-VERIFY-CARRIER-ID THRU 1000-EXIT
  5999     ELSE
  6000         IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  6001             MOVE -1             TO CARRIERL
  6002             MOVE AL-UABON       TO CARRIERA
  6003             MOVE ER-0194        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 119
* EL630.cbl
  6004             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6005
  6006     IF GROUPL GREATER ZEROS
  6007         MOVE AL-UANON           TO GROUPA
  6008     ELSE
  6009         IF CARR-GROUP-ST-ACCNT-CNTL
  6010             MOVE -1 TO          GROUPL
  6011             MOVE AL-UABON       TO GROUPA
  6012             MOVE ER-0195        TO EMI-ERROR
  6013             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6014
  6015     IF STATEL GREATER ZEROS
  6016         MOVE AL-UANON           TO STATEA
  6017         PERFORM 1100-VERIFY-STATE-ID THRU 1100-EXIT
  6018     ELSE
  6019         IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  6020             MOVE -1             TO STATEL
  6021             MOVE AL-UABON       TO STATEA
  6022             MOVE ER-0196        TO EMI-ERROR
  6023             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6024
  6025     IF ACCOUNTL GREATER ZEROS
  6026         MOVE AL-UANON           TO ACCOUNTA
  6027         PERFORM 1200-VERIFY-ACCOUNT THRU 1200-EXIT
  6028     ELSE
  6029         MOVE -1 TO ACCOUNTL
  6030         MOVE AL-UABON           TO ACCOUNTA
  6031         MOVE ER-0197            TO EMI-ERROR
  6032         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6033
  6034 0335-FAT-FINGER-EDIT.
  6035
  6036     IF BATCHI (PIC6-SUB:1) = QUESTION-MARK
  6037         SET QUESTION-MARK-FOUND TO TRUE
  6038     END-IF.
  6039
  6040 0340-CHECK-TOTALS.
  6041******************************************************************
  6042*        IF MAINTENANCE FUNCTION = 'K' (COPY BATCH)              *
  6043*           GO TO CHECK ERRORS.                                  *
  6044******************************************************************
  6045
  6046     IF  MAINTI = 'K'
  6047         GO TO 0340-ERROR-CHECK.
  6048
  6049*    ********************************************************
  6050*    *         THE FOLLOWING FIELDS ARE NOT REQUIRED        *
  6051*    *         IF ENTERED THE ONLY REQUIREMENT IS NUMERIC   *
  6052*    ********************************************************
  6053
  6054     IF ELFISSL GREATER ZEROS
  6055         MOVE AL-UNNON           TO ELFISSA
  6056
  6057* EXEC CICS BIF DEEDIT
  6058*            FIELD   (ELFISSI)
  6059*            LENGTH  (12)
  6060*        END-EXEC
  6061     MOVE 12
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 120
* EL630.cbl
  6062       TO DFHEIV11
  6063*    MOVE '@"L                   #   #00005967' TO DFHEIV0
  6064     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6065     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6066     MOVE X'2020233030303035393637' TO DFHEIV0(25:11)
  6067     CALL 'kxdfhei1' USING DFHEIV0,
  6068           ELFISSI,
  6069           DFHEIV11
  6070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6071         MOVE ELFISSI            TO PI-LF-ISS-REMITTED
  6072     ELSE
  6073         MOVE ZEROS              TO PI-LF-ISS-REMITTED.
  6074
  6075     IF ELFCANL GREATER ZEROS
  6076         MOVE AL-UNNON           TO ELFCANA
  6077
  6078* EXEC CICS BIF DEEDIT
  6079*            FIELD   (ELFCANI)
  6080*            LENGTH  (10)
  6081*        END-EXEC
  6082     MOVE 10
  6083       TO DFHEIV11
  6084*    MOVE '@"L                   #   #00005977' TO DFHEIV0
  6085     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6086     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6087     MOVE X'2020233030303035393737' TO DFHEIV0(25:11)
  6088     CALL 'kxdfhei1' USING DFHEIV0,
  6089           ELFCANI,
  6090           DFHEIV11
  6091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6092         MOVE ELFCANI            TO PI-LF-CAN-REMITTED
  6093     ELSE
  6094         MOVE ZEROS              TO PI-LF-CAN-REMITTED.
  6095
  6096     IF EAHISSL GREATER ZEROS
  6097         MOVE AL-UNNON           TO EAHISSA
  6098
  6099* EXEC CICS BIF DEEDIT
  6100*            FIELD   (EAHISSI)
  6101*            LENGTH  (12)
  6102*        END-EXEC
  6103     MOVE 12
  6104       TO DFHEIV11
  6105*    MOVE '@"L                   #   #00005987' TO DFHEIV0
  6106     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6107     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6108     MOVE X'2020233030303035393837' TO DFHEIV0(25:11)
  6109     CALL 'kxdfhei1' USING DFHEIV0,
  6110           EAHISSI,
  6111           DFHEIV11
  6112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6113         MOVE EAHISSI            TO PI-AH-ISS-REMITTED
  6114     ELSE
  6115         MOVE ZEROS              TO PI-AH-ISS-REMITTED.
  6116
  6117     IF EAHCANL GREATER ZEROS
  6118         MOVE AL-UNNON           TO EAHCANA
  6119
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 121
* EL630.cbl
  6120* EXEC CICS BIF DEEDIT
  6121*            FIELD   (EAHCANI)
  6122*            LENGTH  (10)
  6123*        END-EXEC
  6124     MOVE 10
  6125       TO DFHEIV11
  6126*    MOVE '@"L                   #   #00005997' TO DFHEIV0
  6127     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6128     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6129     MOVE X'2020233030303035393937' TO DFHEIV0(25:11)
  6130     CALL 'kxdfhei1' USING DFHEIV0,
  6131           EAHCANI,
  6132           DFHEIV11
  6133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6134         MOVE EAHCANI            TO PI-AH-CAN-REMITTED
  6135     ELSE
  6136         MOVE ZEROS              TO PI-AH-CAN-REMITTED.
  6137
  6138     IF EISSCNTL GREATER ZEROS
  6139         MOVE AL-UNNON           TO EISSCNTA
  6140
  6141* EXEC CICS BIF DEEDIT
  6142*            FIELD (EISSCNTI)
  6143*            LENGTH(6)
  6144*        END-EXEC
  6145     MOVE 6
  6146       TO DFHEIV11
  6147*    MOVE '@"L                   #   #00006007' TO DFHEIV0
  6148     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6149     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6150     MOVE X'2020233030303036303037' TO DFHEIV0(25:11)
  6151     CALL 'kxdfhei1' USING DFHEIV0,
  6152           EISSCNTI,
  6153           DFHEIV11
  6154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6155         MOVE EISSCNTI           TO PI-ISS-CNT-REMITTED
  6156     ELSE
  6157         MOVE ZEROS              TO PI-ISS-CNT-REMITTED.
  6158
  6159     IF ECANCNTL GREATER ZEROS
  6160         MOVE AL-UNNON           TO ECANCNTA
  6161
  6162* EXEC CICS BIF DEEDIT
  6163*            FIELD  (ECANCNTI)
  6164*            LENGTH (6)
  6165*        END-EXEC
  6166     MOVE 6
  6167       TO DFHEIV11
  6168*    MOVE '@"L                   #   #00006017' TO DFHEIV0
  6169     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6170     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6171     MOVE X'2020233030303036303137' TO DFHEIV0(25:11)
  6172     CALL 'kxdfhei1' USING DFHEIV0,
  6173           ECANCNTI,
  6174           DFHEIV11
  6175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6176         MOVE ECANCNTI           TO PI-CAN-CNT-REMITTED
  6177     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 122
* EL630.cbl
  6178         MOVE ZEROS              TO PI-CAN-CNT-REMITTED.
  6179
  6180     IF MNTHNDTL GREATER ZEROS
  6181        NEXT SENTENCE
  6182       ELSE
  6183        GO TO 0340-RECEIVED-DATE.
  6184
  6185     MOVE MNTHNDTI               TO WS-DT-DEEDIT-FIELD.
  6186     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  6187
  6188     MOVE WS-DEEDIT-FIELD-DATE-OUT
  6189                                 TO DC-GREG-DATE-1-MDY.
  6190     MOVE '4'          TO DC-OPTION-CODE.
  6191     PERFORM 9700-DATE-LINK.
  6192
  6193     IF DATE-CONVERSION-ERROR
  6194        GO TO 0340-MNTH-DAY-ERROR.
  6195
  6196     MOVE DC-GREG-DATE-1-EDIT    TO MNTHNDTO.
  6197     MOVE DC-BIN-DATE-1          TO PI-NB-MONTH-END-DT.
  6198     MOVE DC-GREG-DATE-1-MDY     TO DATE-TEST-AREA.
  6199
  6200     IF DATE-TEST-DD = DC-DAYS-IN-MONTH OR 01
  6201        CONTINUE
  6202     ELSE
  6203        GO TO 0340-MNTH-DAY-ERROR.
  6204
  6205 0340-RECEIVED-DATE.
  6206
  6207     IF RECEVDTL GREATER ZEROS
  6208        NEXT SENTENCE
  6209       ELSE
  6210        MOVE WS-CURRENT-DT       TO RECEVDTI.
  6211
  6212     MOVE RECEVDTI               TO WS-DT-DEEDIT-FIELD.
  6213     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  6214
  6215     MOVE WS-DEEDIT-FIELD-DATE-OUT
  6216                                 TO DC-GREG-DATE-1-MDY.
  6217     MOVE '4'          TO DC-OPTION-CODE.
  6218     PERFORM 9700-DATE-LINK.
  6219
  6220     IF DATE-CONVERSION-ERROR
  6221        GO TO 0340-RECEV-DAY-ERROR.
  6222
  6223     MOVE DC-GREG-DATE-1-EDIT    TO RECEVDTO.
  6224     MOVE DC-BIN-DATE-1          TO PI-RECEIVED-DT.
  6225
  6226     GO TO 0340-ERROR-CHECK.
  6227
  6228 0340-MNTH-DAY-ERROR.
  6229
  6230     MOVE -1       TO MNTHNDTL.
  6231     MOVE AL-UABON TO MNTHNDTA.
  6232     MOVE ER-0587  TO EMI-ERROR.
  6233     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6234     GO TO 0340-ERROR-CHECK.
  6235
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 123
* EL630.cbl
  6236 0340-RECEV-DAY-ERROR.
  6237
  6238     MOVE -1       TO RECEVDTL.
  6239     MOVE AL-UABON TO RECEVDTA.
  6240     MOVE ER-0905  TO EMI-ERROR.
  6241     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6242
  6243 0340-ERROR-CHECK.
  6244
  6245     IF NOT EMI-NO-ERRORS
  6246         GO TO 8200-SEND-DATAONLY.
  6247
  6248     IF PI-NB-MONTH-END-DT EQUAL LOW-VALUES OR SPACES
  6249        GO TO 0345-END-DATE-CHECK.
  6250
  6251     IF PI-NB-MONTH-END-DT LESS THAN PI-CR-MONTH-END-DT
  6252        MOVE PI-NB-MONTH-END-DT  TO DC-BIN-DATE-1
  6253        MOVE PI-CR-MONTH-END-DT  TO DC-BIN-DATE-2
  6254     ELSE
  6255     IF PI-CR-MONTH-END-DT LESS THAN PI-NB-MONTH-END-DT
  6256        MOVE PI-NB-MONTH-END-DT  TO DC-BIN-DATE-2
  6257        MOVE PI-CR-MONTH-END-DT  TO DC-BIN-DATE-1
  6258     ELSE
  6259        GO TO 0345-END-DATE-CHECK.
  6260
  6261     MOVE  '1'                   TO  DC-OPTION-CODE.
  6262     PERFORM  9700-DATE-LINK.
  6263
  6264     IF (DATE-CONVERSION-ERROR)
  6265                   OR
  6266        ((DC-ELAPSED-MONTHS GREATER THAN +1) AND
  6267         (PI-COMPANY-ID NOT EQUAL 'DMD'))
  6268        MOVE -1       TO MNTHNDTL
  6269        MOVE AL-UABON TO MNTHNDTA
  6270        MOVE ER-0587  TO EMI-ERROR
  6271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6272
  6273 0345-END-DATE-CHECK.
  6274
  6275     IF NOT EMI-NO-ERRORS
  6276         GO TO 8200-SEND-DATAONLY.
  6277
  6278     IF PI-DELETE-IS-OK
  6279         MOVE SPACE              TO PI-VERIFY-DELETE-SW.
  6280
  6281     IF MAINTI = 'N'
  6282       AND PI-DATA-UPDATED
  6283         MOVE 'C'                TO PI-MAINT-FUNC
  6284         GO TO 0360-XCTL-EL6301.
  6285
  6286
  6287* EXEC CICS HANDLE CONDITION
  6288*        NOTFND  (0350-NO-RECORDS)
  6289*        ENDFILE (0350-NO-RECORDS)
  6290*    END-EXEC.
  6291*    MOVE '"$I''                  ! # #00006131' TO DFHEIV0
  6292     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 124
* EL630.cbl
  6294     MOVE X'2320233030303036313331' TO DFHEIV0(25:11)
  6295     CALL 'kxdfhei1' USING DFHEIV0
  6296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6297
  6298
  6299
  6300* EXEC CICS READ
  6301*        SET     (ADDRESS OF PENDING-BUSINESS)
  6302*        DATASET (ERPNDB-FILE-ID)
  6303*        RIDFLD  (PI-SAV-ENDING-ERPNDB-KEY)
  6304*        GTEQ
  6305*    END-EXEC.
  6306*    MOVE '&"S        G          (   #00006136' TO DFHEIV0
  6307     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6308     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6309     MOVE X'2020233030303036313336' TO DFHEIV0(25:11)
  6310     CALL 'kxdfhei1' USING DFHEIV0,
  6311           ERPNDB-FILE-ID,
  6312           DFHEIV20,
  6313           DFHEIV99,
  6314           PI-SAV-ENDING-ERPNDB-KEY,
  6315           DFHEIV99,
  6316           DFHEIV99,
  6317           DFHEIV99
  6318     SET ADDRESS OF PENDING-BUSINESS TO
  6319         DFHEIV20
  6320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6321
  6322
  6323     IF PI-SAV-COMP-CD     = PB-COMPANY-CD  AND
  6324        PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  6325         IF MAINTI = 'N'
  6326             MOVE ER-2229        TO EMI-ERROR
  6327             MOVE -1             TO MAINTL
  6328             MOVE AL-UABON       TO MAINTA
  6329             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6330             GO TO 8200-SEND-DATAONLY
  6331         ELSE
  6332             NEXT SENTENCE
  6333     ELSE
  6334         GO TO 0350-NO-RECORDS.
  6335
  6336     IF PI-CARRIER-SECURITY GREATER SPACES
  6337        IF PB-CARRIER = PI-CARRIER-SECURITY
  6338           NEXT SENTENCE
  6339         ELSE
  6340           GO TO 0350-NO-RECORDS.
  6341
  6342     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6343        IF PB-ACCOUNT = PI-ACCOUNT-SECURITY
  6344           NEXT SENTENCE
  6345         ELSE
  6346           GO TO 0350-NO-RECORDS.
  6347
  6348     IF PB-BILLED-DT NOT = LOW-VALUES
  6349         MOVE ER-2402            TO EMI-ERROR
  6350         MOVE -1                 TO BATCHL
  6351         MOVE AL-UABON           TO BATCHA
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 125
* EL630.cbl
  6352         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6353         GO TO 8200-SEND-DATAONLY.
  6354
  6355******************************************************************
  6356*        IF MAINTENANCE FUNCTION = 'K'                           *
  6357*           REWRITE ENTIRE BATCH WITH NEW ACCOUNT INFORMATION.   *
  6358******************************************************************
  6359
  6360     IF  PI-SAV-COMP-CD = PB-COMPANY-CD
  6361         IF  PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  6362             IF  MAINTI = 'K'
  6363                 GO TO 6000-REWRITE-ENTIRE-BATCH.
  6364
  6365     IF PI-SAV-COMP-CD     = PB-COMPANY-CD   AND
  6366        PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH  AND
  6367        MAINTI NOT = 'N'
  6368         MOVE PB-CARRIER         TO PI-SAV-CARRIER
  6369                                    ACCT-CARRIER
  6370         MOVE PB-GROUPING        TO PI-SAV-GROUPING
  6371                                    ACCT-GROUPING
  6372         MOVE PB-STATE           TO PI-SAV-STATE
  6373                                    ACCT-STATE
  6374         MOVE PB-ACCOUNT         TO PI-SAV-ACCOUNT
  6375                                    ACCT-ACCOUNT
  6376         PERFORM 1200-READ-ACCOUNT THRU 1200-EXIT
  6377         PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  6378         MOVE 'EL630B'           TO PI-MAP-NAME.
  6379         GO TO 0360-XCTL-EL6301.
  6380
  6381 0350-NO-RECORDS.
  6382     IF MAINTI = 'N'
  6383         MOVE SPACE              TO PI-ISSUE-ADDED-SW
  6384         MOVE ZEROS              TO PI-LF-ISS-ENTERED
  6385                                    PI-LF-CAN-ENTERED
  6386                                    PI-AH-ISS-ENTERED
  6387                                    PI-AH-CAN-ENTERED
  6388                                    PI-ISS-CNT-ENTERED
  6389                                    PI-CAN-CNT-ENTERED
  6390         PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  6391         IF PI-LF-ISS-REMITTED  = ZEROS AND
  6392            PI-AH-ISS-REMITTED  = ZEROS AND
  6393            PI-LF-CAN-REMITTED  = ZEROS AND
  6394            PI-AH-CAN-REMITTED  = ZEROS AND
  6395            PI-ISS-CNT-REMITTED = ZEROS AND
  6396            PI-CAN-CNT-REMITTED = ZEROS
  6397             MOVE 'EL630B'     TO PI-MAP-NAME
  6398             GO TO 0360-XCTL-EL6301
  6399         ELSE
  6400             IF PI-LF-ISS-REMITTED  = ZEROS AND
  6401                PI-AH-ISS-REMITTED  = ZEROS AND
  6402                PI-ISS-CNT-REMITTED = ZEROS
  6403                 MOVE 'EL630C'     TO PI-MAP-NAME
  6404                 GO TO 0360-XCTL-EL6301
  6405             ELSE
  6406                 MOVE 'EL630B'     TO PI-MAP-NAME
  6407                 GO TO 0360-XCTL-EL6301
  6408     ELSE
  6409         MOVE ER-2212            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 126
* EL630.cbl
  6410         MOVE -1                 TO BATCHL
  6411         MOVE AL-UABON           TO BATCHA
  6412         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6413         GO TO 8200-SEND-DATAONLY.
  6414
  6415 0360-XCTL-EL6301.
  6416     IF PI-MAINT-FUNC = 'N'
  6417         MOVE SPACES             TO PI-KEYED-SWITCHES
  6418                                    PI-AGE-KEYED-SW
  6419                                    PI-BIRTHDT-KEYED-SW.
  6420
  6421     if pi-company-id = 'VPP'
  6422        move 'VP6301'            to pgm-name
  6423        move 'VP630B'            to PI-MAP-NAME
  6424     else
  6425        MOVE XCTL-6301           TO PGM-NAME
  6426     end-if
  6427
  6428     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 127
* EL630.cbl
  6430 0400-PRIME-BATCH-TOTALS.
  6431
  6432* EXEC CICS HANDLE CONDITION
  6433*        NOTFND (0480-NO-BATCH-TRAILER)
  6434*    END-EXEC.
  6435*    MOVE '"$I                   ! $ #00006251' TO DFHEIV0
  6436     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6437     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6438     MOVE X'2420233030303036323531' TO DFHEIV0(25:11)
  6439     CALL 'kxdfhei1' USING DFHEIV0
  6440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6441
  6442
  6443     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  6444     MOVE 9999                   TO PNDB-BATCH-SEQ.
  6445     MOVE BATCHI                 TO PNDB-ENTRY-BATCH.
  6446
  6447
  6448* EXEC CICS READ
  6449*        DATASET (ERPNDB-FILE-ID)
  6450*        SET     (ADDRESS OF PENDING-BUSINESS)
  6451*        RIDFLD  (ERPNDB-KEY)
  6452*    END-EXEC.
  6453*    MOVE '&"S        E          (   #00006259' TO DFHEIV0
  6454     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6456     MOVE X'2020233030303036323539' TO DFHEIV0(25:11)
  6457     CALL 'kxdfhei1' USING DFHEIV0,
  6458           ERPNDB-FILE-ID,
  6459           DFHEIV20,
  6460           DFHEIV99,
  6461           ERPNDB-KEY,
  6462           DFHEIV99,
  6463           DFHEIV99,
  6464           DFHEIV99
  6465     SET ADDRESS OF PENDING-BUSINESS TO
  6466         DFHEIV20
  6467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6468
  6469
  6470     IF PB-BILLED-DT NOT = LOW-VALUES
  6471         MOVE ER-2402            TO EMI-ERROR
  6472         MOVE -1                 TO BATCHL
  6473         MOVE AL-UABON           TO BATCHA
  6474         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6475         GO TO 0490-EXIT.
  6476
  6477     MOVE SPACES                   TO PI-ACCT-AGENT-PROCESSED-SW.
  6478     MOVE PI-COMPANY-CD            TO PI-SAV-COMP-CD.
  6479     MOVE PB-ENTRY-BATCH           TO PI-SAV-ENTRY-BATCH.
  6480
  6481     MOVE PB-REFERENCE             TO PI-SAV-REFERENCE.
  6482     MOVE PB-CSR-ID                TO PI-CSR-ID.
  6483
  6484     MOVE PB-CARRIER               TO PI-SAV-CARRIER.
  6485     MOVE PB-GROUPING              TO PI-SAV-GROUPING.
  6486     MOVE PB-STATE                 TO PI-SAV-STATE.
  6487     MOVE PB-ACCOUNT               TO PI-SAV-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 128
* EL630.cbl
  6488     MOVE PB-B-LF-ISS-PRM-REMITTED TO PI-LF-ISS-REMITTED.
  6489     MOVE PB-B-LF-ISS-PRM-ENTERED  TO PI-LF-ISS-ENTERED.
  6490     MOVE PB-B-AH-ISS-PRM-REMITTED TO PI-AH-ISS-REMITTED.
  6491     MOVE PB-B-AH-ISS-PRM-ENTERED  TO PI-AH-ISS-ENTERED.
  6492     MOVE PB-B-LF-CAN-PRM-REMITTED TO PI-LF-CAN-REMITTED.
  6493     MOVE PB-B-LF-CAN-PRM-ENTERED  TO PI-LF-CAN-ENTERED.
  6494     MOVE PB-B-AH-CAN-PRM-REMITTED TO PI-AH-CAN-REMITTED.
  6495     MOVE PB-B-AH-CAN-PRM-ENTERED  TO PI-AH-CAN-ENTERED.
  6496     MOVE PB-B-ISSUE-CNT-REMITTED  TO PI-ISS-CNT-REMITTED.
  6497     MOVE PB-B-ISSUE-CNT-ENTERED   TO PI-ISS-CNT-ENTERED.
  6498     MOVE PB-B-CANCEL-CNT-REMITTED TO PI-CAN-CNT-REMITTED.
  6499     MOVE PB-B-CANCEL-CNT-ENTERED  TO PI-CAN-CNT-ENTERED.
  6500
  6501******************************************************************
  6502*    IF THE MONTH-END-DATE IN THE TRAILER RECORD (BATCH HEADER)  *
  6503*       IS NOT EQUAL TO THE ACCOUNTS MONTH-END-DATE PRIME THE    *
  6504*       TRAILER'S MONTH-END-DATE.                                *
  6505******************************************************************
  6506
  6507     MOVE SPACE                    TO PI-NB-MONTH-END-DT.
  6508     IF  PB-CREDIT-SELECT-DT = PI-CR-MONTH-END-DT
  6509         NEXT SENTENCE
  6510       ELSE
  6511         MOVE PB-CREDIT-SELECT-DT  TO  PI-NB-MONTH-END-DT.
  6512
  6513     IF  PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
  6514         MOVE PB-INPUT-DT          TO PI-RECEIVED-DT
  6515     ELSE
  6516         MOVE PB-B-RECEIVED-DT     TO PI-RECEIVED-DT.
  6517
  6518     GO TO 0490-EXIT.
  6519
  6520 0480-NO-BATCH-TRAILER.
  6521     MOVE ER-2212                TO EMI-ERROR.
  6522     MOVE -1                     TO BATCHL.
  6523     MOVE AL-UABON               TO BATCHA.
  6524     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6525
  6526 0490-EXIT.
  6527     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 129
* EL630.cbl
  6529 1000-VERIFY-CARRIER-ID.
  6530     MOVE SPACES                 TO ELCNTL-KEY.
  6531     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6532     MOVE '6'                    TO CNTL-REC-TYPE.
  6533     MOVE CARRIERI               TO CNTL-CARRIER
  6534     MOVE +0                     TO CNTL-SEQ.
  6535
  6536
  6537* EXEC CICS HANDLE CONDITION
  6538*        NOTFND   (1000-NO-CARRIER)
  6539*    END-EXEC.
  6540*    MOVE '"$I                   ! % #00006331' TO DFHEIV0
  6541     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6543     MOVE X'2520233030303036333331' TO DFHEIV0(25:11)
  6544     CALL 'kxdfhei1' USING DFHEIV0
  6545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6546
  6547
  6548
  6549* EXEC CICS READ
  6550*        DATASET   (ELCNTL-FILE-ID)
  6551*        SET       (ADDRESS OF CONTROL-FILE)
  6552*        RIDFLD    (ELCNTL-KEY)
  6553*    END-EXEC.
  6554*    MOVE '&"S        E          (   #00006335' TO DFHEIV0
  6555     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6557     MOVE X'2020233030303036333335' TO DFHEIV0(25:11)
  6558     CALL 'kxdfhei1' USING DFHEIV0,
  6559           ELCNTL-FILE-ID,
  6560           DFHEIV20,
  6561           DFHEIV99,
  6562           ELCNTL-KEY,
  6563           DFHEIV99,
  6564           DFHEIV99,
  6565           DFHEIV99
  6566     SET ADDRESS OF CONTROL-FILE TO
  6567         DFHEIV20
  6568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6569
  6570
  6571     GO TO 1000-EXIT.
  6572
  6573 1000-NO-CARRIER.
  6574     MOVE ER-2208                TO EMI-ERROR
  6575     MOVE -1                     TO CARRIERL
  6576     MOVE AL-UABON               TO CARRIERA
  6577     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6578
  6579 1000-EXIT.
  6580     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 130
* EL630.cbl
  6582 1100-VERIFY-STATE-ID.
  6583     MOVE SPACES                 TO ELCNTL-KEY.
  6584     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6585     MOVE '3'                    TO CNTL-REC-TYPE.
  6586     MOVE STATEI                 TO CNTL-STATE.
  6587     MOVE +0                     TO CNTL-SEQ.
  6588
  6589
  6590* EXEC CICS HANDLE CONDITION
  6591*        NOTFND   (1100-NO-STATE)
  6592*    END-EXEC.
  6593*    MOVE '"$I                   ! & #00006359' TO DFHEIV0
  6594     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6595     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6596     MOVE X'2620233030303036333539' TO DFHEIV0(25:11)
  6597     CALL 'kxdfhei1' USING DFHEIV0
  6598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6599
  6600
  6601
  6602* EXEC CICS READ
  6603*        DATASET   (ELCNTL-FILE-ID)
  6604*        SET       (ADDRESS OF CONTROL-FILE)
  6605*        RIDFLD    (ELCNTL-KEY)
  6606*    END-EXEC.
  6607*    MOVE '&"S        E          (   #00006363' TO DFHEIV0
  6608     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6609     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6610     MOVE X'2020233030303036333633' TO DFHEIV0(25:11)
  6611     CALL 'kxdfhei1' USING DFHEIV0,
  6612           ELCNTL-FILE-ID,
  6613           DFHEIV20,
  6614           DFHEIV99,
  6615           ELCNTL-KEY,
  6616           DFHEIV99,
  6617           DFHEIV99,
  6618           DFHEIV99
  6619     SET ADDRESS OF CONTROL-FILE TO
  6620         DFHEIV20
  6621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6622
  6623
  6624     GO TO 1100-EXIT.
  6625
  6626 1100-NO-STATE.
  6627     MOVE ER-2209                TO EMI-ERROR.
  6628     MOVE -1                     TO STATEL.
  6629     MOVE AL-UABON               TO STATEA.
  6630     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6631     GO TO 8200-SEND-DATAONLY.
  6632
  6633 1100-EXIT.
  6634     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 131
* EL630.cbl
  6636
  6637 1200-VERIFY-ACCOUNT.
  6638     IF CARRIERL GREATER ZEROS
  6639         MOVE CARRIERI           TO ACCT-CARRIER
  6640     ELSE
  6641         MOVE SPACES             TO ACCT-CARRIER.
  6642
  6643     IF GROUPL GREATER ZEROS
  6644         MOVE GROUPI             TO ACCT-GROUPING
  6645     ELSE
  6646         MOVE SPACES             TO ACCT-GROUPING.
  6647
  6648     IF STATEL GREATER ZEROS
  6649         MOVE STATEI             TO ACCT-STATE
  6650     ELSE
  6651         MOVE SPACES             TO ACCT-STATE.
  6652
  6653     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  6654
  6655 1200-READ-ACCOUNT.
  6656     MOVE PI-COMPANY-CD          TO ACCT-CO.
  6657     MOVE LOW-VALUES             TO ACCT-EXP-DATE
  6658                                    PI-ACCT-LOW-EFF-DT
  6659                                    PI-ACCT-HIGH-EXP-DT.
  6660
  6661
  6662* EXEC CICS HANDLE CONDITION
  6663*        NOTFND   (1200-ACCOUNT-INVALID)
  6664*        ENDFILE  (1200-ACCOUNT-INVALID)
  6665*    END-EXEC.
  6666*    MOVE '"$I''                  ! '' #00006406' TO DFHEIV0
  6667     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6669     MOVE X'2720233030303036343036' TO DFHEIV0(25:11)
  6670     CALL 'kxdfhei1' USING DFHEIV0
  6671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6672
  6673
  6674
  6675* EXEC CICS STARTBR
  6676*        DATASET (ERACCT2-FILE-ID)
  6677*        RIDFLD  (ERACCT-KEY)
  6678*    END-EXEC.
  6679     MOVE 0
  6680       TO DFHEIV11
  6681*    MOVE '&,         G          &   #00006411' TO DFHEIV0
  6682     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6683     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6684     MOVE X'2020233030303036343131' TO DFHEIV0(25:11)
  6685     CALL 'kxdfhei1' USING DFHEIV0,
  6686           ERACCT2-FILE-ID,
  6687           ERACCT-KEY,
  6688           DFHEIV99,
  6689           DFHEIV11,
  6690           DFHEIV99
  6691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6692
  6693
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 132
* EL630.cbl
  6694     MOVE ERACCT-KEY             TO ERACCT-SAVE-KEY.
  6695
  6696 1200-READ-LOOP.
  6697
  6698* EXEC CICS READNEXT
  6699*        DATASET   (ERACCT2-FILE-ID)
  6700*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6701*        RIDFLD    (ERACCT-KEY)
  6702*    END-EXEC.
  6703     MOVE 0
  6704       TO DFHEIV11
  6705*    MOVE '&.S                   )   #00006419' TO DFHEIV0
  6706     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6707     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6708     MOVE X'2020233030303036343139' TO DFHEIV0(25:11)
  6709     CALL 'kxdfhei1' USING DFHEIV0,
  6710           ERACCT2-FILE-ID,
  6711           DFHEIV20,
  6712           DFHEIV99,
  6713           ERACCT-KEY,
  6714           DFHEIV99,
  6715           DFHEIV11,
  6716           DFHEIV99,
  6717           DFHEIV99
  6718     SET ADDRESS OF ACCOUNT-MASTER TO
  6719         DFHEIV20
  6720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6721
  6722
  6723     IF ERACCT-COMP-KEY NOT = ERACCT-SAVE-KEY
  6724         GO TO 1200-ACCOUNT-INVALID.
  6725
  6726     IF WS-ON1-SW1 IS EQUAL TO 'Y'
  6727         MOVE 'N'                TO WS-ON1-SW1
  6728         MOVE +0                 TO WS-SUB1
  6729         MOVE AM-CARRIER         TO PI-SAV-FC-CARRIER
  6730         MOVE AM-GROUPING        TO PI-SAV-FC-GROUPING
  6731         MOVE AM-STATE           TO PI-SAV-FC-STATE
  6732         MOVE AM-VG-CARRIER      TO PI-SAV-CARRIER
  6733         MOVE AM-VG-GROUPING     TO PI-SAV-GROUPING
  6734         MOVE AM-VG-STATE        TO PI-SAV-STATE
  6735         MOVE AM-VG-ACCOUNT      TO PI-SAV-ACCOUNT
  6736         MOVE AM-EFFECTIVE-DT    TO PI-ACCT-LOW-EFF-DT.
  6737
  6738     MOVE AM-EXPIRATION-DT       TO PI-ACCT-HIGH-EXP-DT.
  6739     MOVE AM-NAME                TO PI-AM-NAME.
  6740     IF AM-EDIT-LOAN-OFC = 'Y'
  6741        MOVE 'Y'                 TO PI-AM-EDIT-LOAN-OFC
  6742     ELSE
  6743        MOVE 'N'                 TO PI-AM-EDIT-LOAN-OFC
  6744     END-IF
  6745     IF AM-GPCD = 02 OR 03 OR 04 OR 05
  6746        MOVE AM-PERSON           TO PI-AM-ADDR1
  6747        MOVE AM-ADDRS            TO PI-AM-ADDR2
  6748*       MOVE AM-CITY             TO PI-AM-CITYST
  6749        MOVE AM-ADDR-CITY        TO PI-AM-CITY
  6750        MOVE AM-ADDR-STATE       TO PI-AM-STATE
  6751        MOVE AM-ZIP              TO PI-AM-ZIP
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 133
* EL630.cbl
  6752     ELSE
  6753        MOVE SPACES TO PI-AM-ADDR1 PI-AM-ADDR2
  6754                      PI-AM-CITYST PI-AM-ZIP
  6755     END-IF
  6756
  6757     MOVE AM-CARRIER             TO PI-COMP-CARRIER.
  6758     MOVE AM-GROUPING            TO PI-COMP-GROUPING.
  6759     MOVE AM-CSR-CODE            TO PI-CSR-ID.
  6760
  6761     IF PI-AR-PROCESSING
  6762        MOVE 'Y'                 TO WS-RECORD-FOUND-SW
  6763        PERFORM 1260-FIND-ACCT-AGENT THRU 1260-EXIT
  6764        IF RECORD-NOT-FOUND
  6765           GO TO 8200-SEND-DATAONLY.
  6766
  6767     GO TO 1200-READ-LOOP.
  6768
  6769 1200-ACCOUNT-INVALID.
  6770     IF PI-ACCT-LOW-EFF-DT NOT = LOW-VALUES
  6771        MOVE 'Y'                 TO PI-ACCT-AGENT-PROCESSED-SW
  6772        GO TO 1200-EXIT.
  6773
  6774     IF CARR-GROUP-ST-ACCNT-CNTL
  6775         MOVE -1                     TO CARRIERL
  6776         MOVE AL-UABON               TO CARRIERA
  6777                                        GROUPA
  6778                                        STATEA
  6779                                        ACCOUNTA
  6780     ELSE
  6781         IF ST-ACCNT-CNTL
  6782             MOVE -1                 TO STATEL
  6783             MOVE AL-UABON           TO STATEA
  6784                                        ACCOUNTA
  6785         ELSE
  6786             IF CARR-ST-ACCNT-CNTL
  6787                 MOVE -1             TO CARRIERL
  6788                 MOVE AL-UABON       TO CARRIERA
  6789                                        STATEA
  6790                                        ACCOUNTA
  6791             ELSE
  6792                 IF ACCNT-CNTL
  6793                     MOVE -1         TO ACCOUNTL
  6794                     MOVE AL-UABON   TO ACCOUNTA
  6795                 ELSE
  6796                     MOVE -1         TO CARRIERL
  6797                     MOVE AL-UABON   TO CARRIERA
  6798                                        ACCOUNTA.
  6799
  6800     MOVE ER-2210                TO EMI-ERROR.
  6801     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6802
  6803 1200-EXIT.
  6804     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 134
* EL630.cbl
  6806 1250-READ-COMPANY-REC.
  6807     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6808     MOVE '1'                    TO CNTL-REC-TYPE.
  6809     MOVE SPACES                 TO CNTL-ACCESS.
  6810     MOVE +0                     TO CNTL-SEQ.
  6811
  6812
  6813* EXEC CICS HANDLE CONDITION
  6814*        NOTFND   (1250-NO-COMPANY-REC)
  6815*    END-EXEC.
  6816*    MOVE '"$I                   ! ( #00006514' TO DFHEIV0
  6817     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6819     MOVE X'2820233030303036353134' TO DFHEIV0(25:11)
  6820     CALL 'kxdfhei1' USING DFHEIV0
  6821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6822
  6823
  6824
  6825* EXEC CICS READ
  6826*        DATASET   (ELCNTL-FILE-ID)
  6827*        SET       (ADDRESS OF CONTROL-FILE)
  6828*        RIDFLD    (ELCNTL-KEY)
  6829*    END-EXEC.
  6830*    MOVE '&"S        E          (   #00006518' TO DFHEIV0
  6831     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6832     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6833     MOVE X'2020233030303036353138' TO DFHEIV0(25:11)
  6834     CALL 'kxdfhei1' USING DFHEIV0,
  6835           ELCNTL-FILE-ID,
  6836           DFHEIV20,
  6837           DFHEIV99,
  6838           ELCNTL-KEY,
  6839           DFHEIV99,
  6840           DFHEIV99,
  6841           DFHEIV99
  6842     SET ADDRESS OF CONTROL-FILE TO
  6843         DFHEIV20
  6844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6845
  6846
  6847     MOVE CF-CREDIT-EDIT-CONTROLS TO PI-CREDIT-EDIT-CONTROLS.
  6848     GO TO 1250-EXIT.
  6849
  6850 1250-NO-COMPANY-REC.
  6851     MOVE ER-2248                TO EMI-ERROR.
  6852     MOVE -1                     TO BATCHL.
  6853     MOVE AL-UABON               TO CARRIERA
  6854     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6855     GO TO 8200-SEND-DATAONLY.
  6856
  6857 1250-EXIT.
  6858     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 135
* EL630.cbl
  6860
  6861 1260-FIND-ACCT-AGENT.
  6862
  6863******************************************************************
  6864*                                                                *
  6865*            F I N D   A C C O U N T   A G E N T                 *
  6866*                                                                *
  6867*    NOTE:  IT IS NECESSARY TO LOAD EVERY DATE RANGE FOR         *
  6868*           EACH ACCOUNT AGENT / FINANCIAL RESPONSIBILITY        *
  6869*           INTO THE PROGRAM INTERFACE AREA.  THE ACCOUNT        *
  6870*           DATE RANGES ARE CHECKED DURING DATA ENTRY IN         *
  6871*           EL6301.                                              *
  6872*                                                                *
  6873******************************************************************
  6874
  6875     IF PI-ACCT-AGENT-PROCESSED
  6876        GO TO 1260-EXIT.
  6877
  6878     IF WS-ON1-SW2 IS EQUAL TO 'Y'
  6879        MOVE 'N'                 TO WS-ON1-SW2
  6880     ELSE
  6881        MOVE +0                  TO WS-SUB2
  6882        GO TO 1260-CONT-FIND-ACCT-AGENT.
  6883
  6884     MOVE +0                     TO WS-SUB2.
  6885
  6886 1260-INITIALIZE-DATE-RANGES.
  6887     ADD +1                      TO WS-SUB2.
  6888
  6889     IF WS-SUB2 GREATER +32
  6890        GO TO 1260-INITIALIZE-FINISHED.
  6891
  6892     MOVE SPACES                 TO PI-ACCT-EFF-DT (WS-SUB2)
  6893                                    PI-ACCT-EXP-DT (WS-SUB2)
  6894                                    PI-REMIT-AGENT (WS-SUB2)
  6895                                    PI-ACCT-AGENT  (WS-SUB2).
  6896
  6897     GO TO 1260-INITIALIZE-DATE-RANGES.
  6898
  6899 1260-INITIALIZE-FINISHED.
  6900     MOVE SPACES                 TO PI-ACCOUNT-AGENT
  6901                                    PI-FIN-RESP.
  6902
  6903     MOVE 'N'                    TO PI-ACCT-AGENT-ERROR-SW
  6904                                    PI-FIN-RESP-ERROR-SW.
  6905
  6906     MOVE +0                     TO WS-SUB2.
  6907
  6908 1260-CONT-FIND-ACCT-AGENT.
  6909     ADD  +1                     TO WS-SUB2.
  6910
  6911     IF WS-SUB2 GREATER +10
  6912        MOVE  SPACES             TO PI-ACCT-AGENT (WS-SUB1)
  6913        GO TO 1260-EXIT.
  6914
  6915     IF AM-COM-TYP (WS-SUB2) = 'C' OR 'D' OR 'F'
  6916        NEXT SENTENCE
  6917     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 136
* EL630.cbl
  6918        GO TO 1260-CONT-FIND-ACCT-AGENT.
  6919
  6920     IF WS-SUB1 = +0
  6921        MOVE +1                   TO WS-SUB1
  6922                                     PI-SUB
  6923        MOVE AM-EFFECTIVE-DT      TO PI-ACCT-EFF-DT (WS-SUB1)
  6924        MOVE AM-EXPIRATION-DT     TO PI-ACCT-EXP-DT (WS-SUB1)
  6925        MOVE AM-AGT (WS-SUB2)     TO PI-ACCT-AGENT  (WS-SUB1)
  6926        MOVE AM-AGT (AM-REMIT-TO) TO PI-REMIT-AGENT (WS-SUB1)
  6927        GO TO 1260-EXIT.
  6928
  6929     IF AM-AGT (WS-SUB2)     = PI-ACCT-AGENT  (WS-SUB1) AND
  6930        AM-AGT (AM-REMIT-TO) = PI-REMIT-AGENT (WS-SUB1)
  6931          MOVE AM-EXPIRATION-DT  TO PI-ACCT-EXP-DT (WS-SUB1)
  6932        ELSE
  6933          ADD +1                      TO WS-SUB1
  6934          IF WS-SUB1 GREATER +32
  6935              MOVE  ER-2119             TO EMI-ERROR
  6936              MOVE -1                   TO MAINTL
  6937              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  6938              MOVE 'N'                  TO WS-RECORD-FOUND-SW
  6939              GO TO 1260-EXIT
  6940          ELSE
  6941           MOVE WS-SUB1              TO PI-SUB
  6942           MOVE AM-EFFECTIVE-DT      TO PI-ACCT-EFF-DT (WS-SUB1)
  6943           MOVE AM-EXPIRATION-DT     TO PI-ACCT-EXP-DT (WS-SUB1)
  6944           MOVE AM-AGT (WS-SUB2)     TO PI-ACCT-AGENT  (WS-SUB1)
  6945           MOVE AM-AGT (AM-REMIT-TO) TO PI-REMIT-AGENT (WS-SUB1).
  6946
  6947 1260-EXIT.
  6948      EXIT.
  6949
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 137
* EL630.cbl
  6951
  6952 1300-GET-BATCH-NO.
  6953
  6954* EXEC CICS HANDLE CONDITION
  6955*        NOTFND   (1300-NO-COMPANY-REC)
  6956*    END-EXEC.
  6957*    MOVE '"$I                   ! ) #00006630' TO DFHEIV0
  6958     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6959     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6960     MOVE X'2920233030303036363330' TO DFHEIV0(25:11)
  6961     CALL 'kxdfhei1' USING DFHEIV0
  6962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6963
  6964
  6965
  6966* EXEC CICS READ
  6967*        DATASET   (ELCNTL-FILE-ID)
  6968*        SET       (ADDRESS OF CONTROL-FILE)
  6969*        RIDFLD    (ELCNTL-KEY)
  6970*        UPDATE
  6971*    END-EXEC.
  6972*    MOVE '&"S        EU         (   #00006634' TO DFHEIV0
  6973     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6974     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6975     MOVE X'2020233030303036363334' TO DFHEIV0(25:11)
  6976     CALL 'kxdfhei1' USING DFHEIV0,
  6977           ELCNTL-FILE-ID,
  6978           DFHEIV20,
  6979           DFHEIV99,
  6980           ELCNTL-KEY,
  6981           DFHEIV99,
  6982           DFHEIV99,
  6983           DFHEIV99
  6984     SET ADDRESS OF CONTROL-FILE TO
  6985         DFHEIV20
  6986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6987
  6988
  6989 1300-ASSIGN-NUMBER-LOOP.
  6990     IF CF-LAST-BATCH-RESET
  6991         MOVE ZEROS              TO CF-LAST-BATCH-NO
  6992         ADD +1                  TO CF-LAST-BATCH-NO
  6993     ELSE
  6994         ADD +1                  TO CF-LAST-BATCH-NO.
  6995
  6996     MOVE CF-LAST-BATCH-NO       TO WS-BATCH-NO.
  6997     MOVE WS-BATCH-NO            TO PI-SAV-ENTRY-BATCH.
  6998
  6999 1300-REWRITE-COMPANY-REC.
  7000     MOVE WS-BATCH-NO            TO BATCHI.
  7001     MOVE AL-UANON               TO BATCHA.
  7002
  7003
  7004* EXEC CICS REWRITE
  7005*        DATASET (ELCNTL-FILE-ID)
  7006*        FROM    (CONTROL-FILE)
  7007*    END-EXEC.
  7008     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 138
* EL630.cbl
  7009      CONTROL-FILE
  7010       TO DFHEIV11
  7011*    MOVE '&& L                  %   #00006655' TO DFHEIV0
  7012     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7013     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7014     MOVE X'2020233030303036363535' TO DFHEIV0(25:11)
  7015     CALL 'kxdfhei1' USING DFHEIV0,
  7016           ELCNTL-FILE-ID,
  7017           CONTROL-FILE,
  7018           DFHEIV11,
  7019           DFHEIV99
  7020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7021
  7022
  7023
  7024* EXEC CICS SYNCPOINT
  7025*    END-EXEC.
  7026*    MOVE '6"                    !   #00006660' TO DFHEIV0
  7027     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7028     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7029     MOVE X'2020233030303036363630' TO DFHEIV0(25:11)
  7030     CALL 'kxdfhei1' USING DFHEIV0
  7031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7032
  7033
  7034 1300-CHECK-FOR-DUP-BATCH.
  7035
  7036* EXEC CICS HANDLE CONDITION
  7037*        NOTFND  (1300-EXIT)
  7038*    END-EXEC.
  7039*    MOVE '"$I                   ! * #00006664' TO DFHEIV0
  7040     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7042     MOVE X'2A20233030303036363634' TO DFHEIV0(25:11)
  7043     CALL 'kxdfhei1' USING DFHEIV0
  7044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7045
  7046
  7047
  7048* EXEC CICS READ
  7049*        SET     (ADDRESS OF PENDING-BUSINESS)
  7050*        DATASET (ERPNDB-FILE-ID)
  7051*        RIDFLD  (PI-SAV-ENDING-ERPNDB-KEY)
  7052*        GTEQ
  7053*    END-EXEC.
  7054*    MOVE '&"S        G          (   #00006668' TO DFHEIV0
  7055     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7056     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7057     MOVE X'2020233030303036363638' TO DFHEIV0(25:11)
  7058     CALL 'kxdfhei1' USING DFHEIV0,
  7059           ERPNDB-FILE-ID,
  7060           DFHEIV20,
  7061           DFHEIV99,
  7062           PI-SAV-ENDING-ERPNDB-KEY,
  7063           DFHEIV99,
  7064           DFHEIV99,
  7065           DFHEIV99
  7066     SET ADDRESS OF PENDING-BUSINESS TO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 139
* EL630.cbl
  7067         DFHEIV20
  7068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7069
  7070
  7071     IF PI-SAV-COMP-CD NOT = PB-COMPANY-CD
  7072         GO TO 1300-EXIT.
  7073
  7074     IF PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  7075         MOVE LOW-VALUES         TO EL630AO
  7076         MOVE QUESTION-MARKS     TO BATCHO
  7077         MOVE AL-UABON           TO BATCHA
  7078         MOVE -1                 TO BATCHL
  7079         MOVE ER-2229            TO EMI-ERROR
  7080         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7081         GO TO 8100-SEND-INITIAL-MAP.
  7082
  7083     GO TO 1300-EXIT.
  7084
  7085 1300-NO-COMPANY-REC.
  7086     MOVE ER-2248                TO EMI-ERROR.
  7087     MOVE -1                     TO BATCHL.
  7088     MOVE AL-UABON               TO CARRIERA
  7089     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7090     GO TO 8200-SEND-DATAONLY.
  7091
  7092 1300-EXIT.
  7093     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 140
* EL630.cbl
  7095
  7096 1400-VERIFY-COMP-MASTER.
  7097
  7098******************************************************************
  7099*
  7100*      V E R I F Y    C O M P E N S A T I O N    M A S T E R
  7101*
  7102*       READ COMPENSATION MASTER AND SAVE SUMMARY CODE FOR
  7103*       A.R. PROCESSING.
  7104*
  7105******************************************************************
  7106
  7107
  7108* EXEC CICS HANDLE CONDITION
  7109*        NOTFND   (1470-NO-COMP-MSTR)
  7110*    END-EXEC.
  7111*    MOVE '"$I                   ! + #00006711' TO DFHEIV0
  7112     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7114     MOVE X'2B20233030303036373131' TO DFHEIV0(25:11)
  7115     CALL 'kxdfhei1' USING DFHEIV0
  7116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7117
  7118
  7119     MOVE SPACE                  TO WS-COMP-MASTER-ERROR-SW.
  7120     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  7121
  7122     IF PI-ZERO-CARRIER OR
  7123        PI-ZERO-CAR-GROUP
  7124        MOVE ZEROS               TO ERCOMP-CARRIER
  7125     ELSE
  7126        MOVE PI-COMP-CARRIER     TO ERCOMP-CARRIER.
  7127
  7128     IF PI-ZERO-GROUPING OR
  7129        PI-ZERO-CAR-GROUP
  7130        MOVE ZEROS               TO ERCOMP-GROUPING
  7131     ELSE
  7132        MOVE PI-COMP-GROUPING    TO ERCOMP-GROUPING.
  7133
  7134     MOVE PI-FIN-RESP            TO ERCOMP-FIN-RESP.
  7135     MOVE PI-ACCOUNT-AGENT       TO ERCOMP-ACCT.
  7136     MOVE 'A'                    TO ERCOMP-RECORD-TYPE.
  7137
  7138
  7139* EXEC CICS READ
  7140*        DATASET   (ERCOMP-FILE-ID)
  7141*        SET       (ADDRESS OF COMPENSATION-MASTER)
  7142*        RIDFLD    (ERCOMP-KEY)
  7143*    END-EXEC.
  7144*    MOVE '&"S        E          (   #00006734' TO DFHEIV0
  7145     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7147     MOVE X'2020233030303036373334' TO DFHEIV0(25:11)
  7148     CALL 'kxdfhei1' USING DFHEIV0,
  7149           ERCOMP-FILE-ID,
  7150           DFHEIV20,
  7151           DFHEIV99,
  7152           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 141
* EL630.cbl
  7153           DFHEIV99,
  7154           DFHEIV99,
  7155           DFHEIV99
  7156     SET ADDRESS OF COMPENSATION-MASTER TO
  7157         DFHEIV20
  7158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7159
  7160
  7161     MOVE CO-AR-SUMMARY-CODE     TO PI-SUMMARY-CODE.
  7162
  7163     IF REFL GREATER ZEROS
  7164         GO TO 1490-EXIT.
  7165
  7166     IF PI-SAV-REFERENCE GREATER SPACES
  7167         GO TO 1490-EXIT.
  7168
  7169     IF CO-AR-NET-REPORT
  7170        MOVE 'Y'                 TO WS-UPDATE-REFERENCE-SW
  7171        MOVE WS-CURRENT-YMD      TO PI-SAV-REFERENCE
  7172     ELSE
  7173        MOVE SPACES              TO PI-SAV-REFERENCE.
  7174
  7175     GO TO 1490-EXIT.
  7176
  7177 1470-NO-COMP-MSTR.
  7178     MOVE ER-2800                TO EMI-ERROR.
  7179     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7180     MOVE 'Y'                    TO WS-COMP-MASTER-ERROR-SW.
  7181
  7182 1490-EXIT.
  7183     EXIT.
  7184
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 142
* EL630.cbl
  7186
  7187******************************************************************
  7188*                                                                *
  7189*           W R I T E   R E Q U E S T   R E C O R D              *
  7190*                                                                *
  7191******************************************************************
  7192
  7193 1900-WRITE-REQUEST-RECORD.
  7194
  7195* EXEC CICS GETMAIN
  7196*         SET       (ADDRESS OF AR-REQUEST-RECORD)
  7197*         LENGTH    (200)
  7198*         INITIMG   (GETMAIN-SPACE)
  7199*    END-EXEC.
  7200     MOVE 200
  7201       TO DFHEIV11
  7202*    MOVE ',"IL                  $   #00006773' TO DFHEIV0
  7203     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7204     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7205     MOVE X'2020233030303036373733' TO DFHEIV0(25:11)
  7206     CALL 'kxdfhei1' USING DFHEIV0,
  7207           DFHEIV20,
  7208           DFHEIV11,
  7209           GETMAIN-SPACE
  7210     SET ADDRESS OF AR-REQUEST-RECORD TO
  7211         DFHEIV20
  7212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7213
  7214
  7215     MOVE 'RQ'                   TO RQ-RECORD-ID.
  7216
  7217     MOVE PI-SAV-ENTRY-BATCH     TO RQ-ENTRY-BATCH
  7218                                    RQ-BATCH-A1
  7219                                    RQ-BATCH-A2
  7220                                    RQ-BATCH-A3
  7221                                    RQ-BATCH-A4.
  7222
  7223     MOVE PI-SAV-REFERENCE       TO RQ-REFERENCE-A1
  7224                                    RQ-REFERENCE-A2
  7225                                    RQ-REFERENCE-A4.
  7226
  7227     MOVE PI-COMPANY-CD          TO RQ-COMPANY-CD
  7228                                    RQ-COMPANY-CD-A1
  7229                                    RQ-COMPANY-CD-A2
  7230                                    RQ-COMPANY-CD-A3
  7231                                    RQ-COMPANY-CD-A4.
  7232
  7233     MOVE PI-SAV-FC-CARRIER      TO RQ-CARRIER-A1
  7234                                    RQ-CARRIER-A2
  7235                                    RQ-CARRIER-A3
  7236                                    PI-CR-CARRIER.
  7237
  7238     MOVE PI-SAV-FC-GROUPING     TO RQ-GROUPING-A1
  7239                                    RQ-GROUPING-A2
  7240                                    RQ-GROUPING-A3
  7241                                    PI-CR-GROUPING.
  7242
  7243     IF PI-ZERO-CARRIER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 143
* EL630.cbl
  7244        MOVE ZERO                TO RQ-CARRIER-A2
  7245                                    PI-CR-CARRIER.
  7246
  7247     IF PI-ZERO-GROUPING
  7248        MOVE ZEROS               TO RQ-GROUPING-A2
  7249                                    PI-CR-GROUPING.
  7250
  7251     IF PI-ZERO-CAR-GROUP
  7252        MOVE ZEROS               TO RQ-CARRIER-A2
  7253                                    RQ-GROUPING-A2
  7254                                    PI-CR-CARRIER
  7255                                    PI-CR-GROUPING.
  7256
  7257     MOVE PI-SAV-FC-STATE        TO RQ-STATE-A1
  7258                                    PI-CR-STATE.
  7259
  7260     MOVE PI-SAV-ACCOUNT         TO RQ-ACCOUNT-A1
  7261                                    RQ-ACCOUNT-A4
  7262                                    PI-CR-ACCOUNT.
  7263
  7264
  7265     MOVE PI-ACCOUNT-AGENT       TO RQ-ACCT-AGENT-A2
  7266                                    RQ-ACCT-AGENT-A3.
  7267
  7268     MOVE WS-CURRENT-BIN-DT      TO RQ-ENTRY-DT.
  7269
  7270     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7271         MOVE PI-NB-MONTH-END-DT TO RQ-MO-END-DT
  7272     ELSE
  7273         MOVE PI-CR-MONTH-END-DT TO RQ-MO-END-DT.
  7274
  7275     MOVE LOW-VALUES             TO RQ-REQUEST-DT
  7276                                    RQ-STMT-DT
  7277                                    RQ-REVERSAL-DT
  7278                                    RQ-CREDIT-SELECT-DT
  7279                                    RQ-CREDIT-ACCEPT-DT.
  7280
  7281     IF PI-FIN-RESP-ERROR
  7282        MOVE 'E'                 TO RQ-STATUS
  7283        MOVE 'UNKNOWN'           TO RQ-FIN-RESP-A2
  7284                                    PI-CR-FIN-RESP
  7285     ELSE
  7286        MOVE PI-FIN-RESP         TO RQ-FIN-RESP-A2
  7287                                    PI-CR-FIN-RESP.
  7288
  7289     IF PI-ACCT-AGENT-ERROR
  7290        MOVE 'E'                 TO RQ-STATUS
  7291        MOVE 'UNKNOWN'           TO RQ-ACCT-AGENT-A2
  7292                                    RQ-ACCT-AGENT-A3.
  7293
  7294     IF WS-COMP-MASTER-ERROR
  7295        MOVE 'E'                 TO RQ-STATUS
  7296        MOVE 'UNKNOWN'           TO PI-CR-FIN-RESP.
  7297
  7298     MOVE RQ-CONTROL-PRIMARY     TO ERRQST-KEY.
  7299     MOVE LOW-VALUES             TO RQ-STMT-DT
  7300                                    RQ-REQUEST-DT
  7301                                    RQ-REVERSAL-DT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 144
* EL630.cbl
  7302
  7303     MOVE CO-AR-SUMMARY-CODE     TO RQ-SUMMARY-CODE.
  7304
  7305     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7306         MOVE PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT
  7307     ELSE
  7308         MOVE PI-CR-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  7309
  7310
  7311* EXEC CICS HANDLE CONDITION
  7312*        DUPREC (1990-EXIT)
  7313*    END-EXEC.
  7314*    MOVE '"$%                   ! , #00006874' TO DFHEIV0
  7315     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7317     MOVE X'2C20233030303036383734' TO DFHEIV0(25:11)
  7318     CALL 'kxdfhei1' USING DFHEIV0
  7319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7320
  7321
  7322
  7323* EXEC CICS WRITE
  7324*         DATASET    (ERRQST-FILE-ID)
  7325*         FROM       (AR-REQUEST-RECORD)
  7326*         RIDFLD     (ERRQST-KEY)
  7327*    END-EXEC.
  7328     MOVE LENGTH OF
  7329      AR-REQUEST-RECORD
  7330       TO DFHEIV11
  7331*    MOVE '&$ L                  ''   #00006878' TO DFHEIV0
  7332     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7333     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7334     MOVE X'2020233030303036383738' TO DFHEIV0(25:11)
  7335     CALL 'kxdfhei1' USING DFHEIV0,
  7336           ERRQST-FILE-ID,
  7337           AR-REQUEST-RECORD,
  7338           DFHEIV11,
  7339           ERRQST-KEY,
  7340           DFHEIV99,
  7341           DFHEIV99
  7342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7343
  7344
  7345 1990-EXIT.
  7346     EXIT.
  7347
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 145
* EL630.cbl
  7349 2000-WRITE-BATCH-TOTAL-REC.
  7350
  7351     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  7352     MOVE PI-SAV-ENTRY-BATCH     TO PNDB-ENTRY-BATCH.
  7353     MOVE 9999                   TO PNDB-BATCH-SEQ.
  7354
  7355
  7356* EXEC CICS HANDLE CONDITION
  7357*        NOTFND (2100-ADD-BATCH-TOTAL-REC)
  7358*    END-EXEC.
  7359*    MOVE '"$I                   ! - #00006894' TO DFHEIV0
  7360     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7362     MOVE X'2D20233030303036383934' TO DFHEIV0(25:11)
  7363     CALL 'kxdfhei1' USING DFHEIV0
  7364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7365
  7366
  7367
  7368* EXEC CICS READ
  7369*        SET    (ADDRESS OF PENDING-BUSINESS)
  7370*        DATASET(ERPNDB-FILE-ID)
  7371*        RIDFLD (ERPNDB-KEY)
  7372*        UPDATE
  7373*    END-EXEC.
  7374*    MOVE '&"S        EU         (   #00006898' TO DFHEIV0
  7375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7376     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7377     MOVE X'2020233030303036383938' TO DFHEIV0(25:11)
  7378     CALL 'kxdfhei1' USING DFHEIV0,
  7379           ERPNDB-FILE-ID,
  7380           DFHEIV20,
  7381           DFHEIV99,
  7382           ERPNDB-KEY,
  7383           DFHEIV99,
  7384           DFHEIV99,
  7385           DFHEIV99
  7386     SET ADDRESS OF PENDING-BUSINESS TO
  7387         DFHEIV20
  7388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7389
  7390
  7391******************************************************************
  7392*    IF THE MONTH-END-DATE IN THE TRAILER RECORD (BATCH HEADER)  *
  7393*       IS NOT EQUAL TO THE ACCOUNTS MONTH-END-DATE AND THE      *
  7394*       OPERATOR HAS NOT ENTERED A NEW MONTH-END-DATE USE THE    *
  7395*       MONTH-END-DATE IN TRAILER RECORD FOR ALL DETAIL RECORDS. *
  7396******************************************************************
  7397
  7398     IF  PI-NB-MONTH-END-DT = SPACES
  7399         IF  PB-CREDIT-SELECT-DT = PI-CR-MONTH-END-DT
  7400             NEXT SENTENCE
  7401         ELSE
  7402             MOVE PB-CREDIT-SELECT-DT  TO  PI-NB-MONTH-END-DT.
  7403
  7404     IF PI-AR-PROCESSING
  7405        IF REFL = ZEROS
  7406           IF PB-REFERENCE GREATER SPACES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 146
* EL630.cbl
  7407              MOVE PB-REFERENCE  TO PI-SAV-REFERENCE
  7408           ELSE
  7409              NEXT SENTENCE
  7410        ELSE
  7411           IF PI-SAV-REFERENCE NOT = PB-REFERENCE
  7412              MOVE 'Y'              TO WS-UPDATE-REFERENCE-SW
  7413                                       WS-RECORD-FOUND-SW
  7414              PERFORM 7100-REWRITE-REQUEST-REC THRU 7190-EXIT
  7415              IF RECORD-NOT-FOUND
  7416                  GO TO 8200-SEND-DATAONLY
  7417              ELSE
  7418                  MOVE PI-SAV-REFERENCE TO PB-REFERENCE.
  7419
  7420     IF ELFISSL NOT = ZEROS
  7421         MOVE PI-LF-ISS-REMITTED  TO PB-B-LF-ISS-PRM-REMITTED.
  7422     IF EAHISSL NOT = ZEROS
  7423         MOVE PI-AH-ISS-REMITTED  TO PB-B-AH-ISS-PRM-REMITTED.
  7424     IF EISSCNTL NOT = ZEROS
  7425         MOVE PI-ISS-CNT-REMITTED TO PB-B-ISSUE-CNT-REMITTED.
  7426     IF ECANCNTL NOT = ZEROS
  7427         MOVE PI-CAN-CNT-REMITTED TO PB-B-CANCEL-CNT-REMITTED.
  7428     IF ELFCANL NOT = ZEROS
  7429         MOVE PI-LF-CAN-REMITTED  TO PB-B-LF-CAN-PRM-REMITTED.
  7430     IF EAHCANL NOT = ZEROS
  7431         MOVE PI-AH-CAN-REMITTED  TO PB-B-AH-CAN-PRM-REMITTED.
  7432
  7433     IF WS-PF1
  7434         MOVE PI-LF-ISS-ENTERED   TO PB-B-LF-ISS-PRM-ENTERED
  7435         MOVE PI-AH-ISS-ENTERED   TO PB-B-AH-ISS-PRM-ENTERED
  7436         MOVE PI-ISS-CNT-ENTERED  TO PB-B-ISSUE-CNT-ENTERED
  7437         MOVE PI-CAN-CNT-ENTERED  TO PB-B-CANCEL-CNT-ENTERED
  7438         MOVE PI-LF-CAN-ENTERED   TO PB-B-LF-CAN-PRM-ENTERED
  7439         MOVE PI-AH-CAN-ENTERED   TO PB-B-AH-CAN-PRM-ENTERED
  7440         MOVE PI-LAST-SEQ-NO-ADDED TO PB-B-HIGHEST-SEQ-NO.
  7441
  7442     MOVE PI-RECEIVED-DT         TO PB-B-RECEIVED-DT.
  7443
  7444     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  7445     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  7446     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
  7447
  7448     IF PI-AR-PROCESSING
  7449        IF PI-DATA-UPDATED
  7450           PERFORM 1400-VERIFY-COMP-MASTER   THRU 1490-EXIT
  7451           PERFORM 1900-WRITE-REQUEST-RECORD THRU 1990-EXIT
  7452           IF PI-MAINT-FUNC NOT = 'K'
  7453              MOVE PI-SAV-REFERENCE TO PB-REFERENCE.
  7454
  7455
  7456* EXEC CICS REWRITE
  7457*        DATASET(ERPNDB-FILE-ID)
  7458*        FROM   (PENDING-BUSINESS)
  7459*    END-EXEC.
  7460     MOVE LENGTH OF
  7461      PENDING-BUSINESS
  7462       TO DFHEIV11
  7463*    MOVE '&& L                  %   #00006969' TO DFHEIV0
  7464     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 147
* EL630.cbl
  7465     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7466     MOVE X'2020233030303036393639' TO DFHEIV0(25:11)
  7467     CALL 'kxdfhei1' USING DFHEIV0,
  7468           ERPNDB-FILE-ID,
  7469           PENDING-BUSINESS,
  7470           DFHEIV11,
  7471           DFHEIV99
  7472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7473
  7474
  7475     IF  PI-AR-PROCESSING
  7476         IF WS-UPDATE-REFERENCE
  7477            PERFORM 5000-UPDATE-ENTIRE-BATCH THRU 5900-EXIT
  7478            GO TO 2990-EXIT.
  7479
  7480     IF PI-NB-MONTH-END-DT = PB-CREDIT-SELECT-DT
  7481        GO TO 2990-EXIT.
  7482
  7483     IF PI-NB-MONTH-END-DT GREATER SPACES
  7484         PERFORM 5000-UPDATE-ENTIRE-BATCH THRU 5900-EXIT
  7485             IF PI-AR-PROCESSING
  7486                 MOVE 'Y'          TO WS-RECORD-FOUND-SW
  7487                 PERFORM 7200-REWRITE-REQUEST THRU 7299-EXIT
  7488                 IF RECORD-NOT-FOUND
  7489                     GO TO 8200-SEND-DATAONLY.
  7490
  7491     GO TO 2990-EXIT.
  7492
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 148
* EL630.cbl
  7494
  7495 2100-ADD-BATCH-TOTAL-REC.
  7496
  7497* EXEC CICS GETMAIN
  7498*        SET    (ADDRESS OF PENDING-BUSINESS)
  7499*        LENGTH (585)
  7500*        INITIMG(GETMAIN-SPACE)
  7501*    END-EXEC.
  7502     MOVE 585
  7503       TO DFHEIV11
  7504*    MOVE ',"IL                  $   #00006995' TO DFHEIV0
  7505     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7506     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7507     MOVE X'2020233030303036393935' TO DFHEIV0(25:11)
  7508     CALL 'kxdfhei1' USING DFHEIV0,
  7509           DFHEIV20,
  7510           DFHEIV11,
  7511           GETMAIN-SPACE
  7512     SET ADDRESS OF PENDING-BUSINESS TO
  7513         DFHEIV20
  7514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7515
  7516
  7517     MOVE 'PB'                   TO PB-RECORD-ID.
  7518     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD
  7519                                    PB-COMPANY-CD-A1.
  7520     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
  7521     MOVE PI-SAV-ENTRY-BATCH     TO PB-ENTRY-BATCH
  7522                                    PB-CERT-NO.
  7523     MOVE 9999                   TO PB-BATCH-SEQ-NO.
  7524     MOVE HIGH-VALUES            TO PB-CERT-EFF-DT.
  7525     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  7526                                    PB-ALT-CHG-SEQ-NO.
  7527
  7528     IF REFL GREATER THAN +0
  7529        MOVE REFI                TO PB-REFERENCE
  7530                                    PI-SAV-REFERENCE.
  7531
  7532     IF PI-LF-ISS-REMITTED     NOT NUMERIC
  7533        MOVE +0                  TO PI-LF-ISS-REMITTED.
  7534
  7535     IF PI-LF-ISS-ENTERED      NOT NUMERIC
  7536        MOVE +0                  TO PI-LF-ISS-ENTERED.
  7537
  7538     IF PI-AH-ISS-REMITTED     NOT NUMERIC
  7539        MOVE +0                  TO PI-AH-ISS-REMITTED.
  7540
  7541     IF PI-AH-ISS-ENTERED      NOT NUMERIC
  7542        MOVE +0                  TO PI-AH-ISS-ENTERED.
  7543
  7544     IF PI-ISS-CNT-REMITTED    NOT NUMERIC
  7545        MOVE +0                  TO PI-ISS-CNT-REMITTED.
  7546
  7547     IF PI-ISS-CNT-ENTERED     NOT NUMERIC
  7548        MOVE +0                  TO PI-ISS-CNT-ENTERED.
  7549
  7550     IF PI-CAN-CNT-REMITTED    NOT NUMERIC
  7551        MOVE +0                  TO PI-CAN-CNT-REMITTED.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 149
* EL630.cbl
  7552
  7553     IF PI-CAN-CNT-ENTERED     NOT NUMERIC
  7554        MOVE +0                  TO PI-CAN-CNT-ENTERED.
  7555
  7556     IF PI-LF-CAN-REMITTED     NOT NUMERIC
  7557        MOVE +0                  TO PI-LF-CAN-REMITTED.
  7558
  7559     IF PI-LF-CAN-ENTERED      NOT NUMERIC
  7560        MOVE +0                  TO PI-LF-CAN-ENTERED.
  7561
  7562     IF PI-LF-CAN-REMITTED     NOT NUMERIC
  7563        MOVE +0                  TO PI-LF-CAN-REMITTED.
  7564
  7565     IF PI-AH-CAN-REMITTED     NOT NUMERIC
  7566        MOVE +0                  TO PI-AH-CAN-REMITTED.
  7567
  7568     IF PI-AH-CAN-ENTERED      NOT NUMERIC
  7569        MOVE +0                  TO PI-AH-CAN-ENTERED.
  7570
  7571
  7572     MOVE PI-SAV-CARRIER         TO PB-CARRIER.
  7573     MOVE PI-SAV-GROUPING        TO PB-GROUPING.
  7574     MOVE PI-SAV-STATE           TO PB-STATE.
  7575     MOVE PI-SAV-ACCOUNT         TO PB-ACCOUNT.
  7576     MOVE '9'                    TO PB-RECORD-TYPE.
  7577     MOVE PI-LF-ISS-REMITTED     TO PB-B-LF-ISS-PRM-REMITTED.
  7578     MOVE PI-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED.
  7579     MOVE PI-AH-ISS-REMITTED     TO PB-B-AH-ISS-PRM-REMITTED.
  7580     MOVE PI-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED.
  7581     MOVE PI-ISS-CNT-REMITTED    TO PB-B-ISSUE-CNT-REMITTED.
  7582     MOVE PI-ISS-CNT-ENTERED     TO PB-B-ISSUE-CNT-ENTERED.
  7583     MOVE PI-CAN-CNT-REMITTED    TO PB-B-CANCEL-CNT-REMITTED.
  7584     MOVE PI-CAN-CNT-ENTERED     TO PB-B-CANCEL-CNT-ENTERED.
  7585     MOVE PI-LF-CAN-REMITTED     TO PB-B-LF-CAN-PRM-REMITTED.
  7586     MOVE PI-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED.
  7587     MOVE PI-AH-CAN-REMITTED     TO PB-B-AH-CAN-PRM-REMITTED.
  7588     MOVE PI-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED.
  7589     MOVE ZEROS                  TO PB-B-LF-ISS-PRM-COMPUTED
  7590                                    PB-B-LF-CAN-PRM-COMPUTED
  7591                                    PB-B-AH-ISS-PRM-COMPUTED
  7592                                    PB-B-AH-CAN-PRM-COMPUTED
  7593                                    PB-LF-BILLED-AMTS
  7594                                    PB-AH-BILLED-AMTS
  7595                                    PB-CHG-COUNT
  7596                                    PB-CALC-TOLERANCE.
  7597     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  7598                                    PB-BILLED-DT
  7599                                    PB-ACCT-EFF-DT
  7600                                    PB-ACCT-EXP-DT.
  7601
  7602     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7603         MOVE PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT
  7604        ELSE
  7605         MOVE PI-CR-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  7606
  7607     MOVE PI-LAST-SEQ-NO-ADDED   TO PB-B-HIGHEST-SEQ-NO.
  7608
  7609     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 150
* EL630.cbl
  7610                                    PB-INPUT-BY.
  7611     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  7612     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
  7613                                    PB-INPUT-DT.
  7614
  7615     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
  7616
  7617     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
  7618     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
  7619     MOVE PI-CSR-ID              TO PB-CSR-ID.
  7620     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
  7621     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
  7622
  7623     MOVE PI-RECEIVED-DT         TO PB-B-RECEIVED-DT.
  7624
  7625     MOVE PI-AM-NAME             TO  PB-ACCOUNT-NAME.
  7626     MOVE PI-SAV-FC-CARRIER      TO  PB-SV-CARRIER.
  7627     MOVE PI-SAV-FC-GROUPING     TO  PB-SV-GROUPING.
  7628     MOVE PI-SAV-FC-STATE        TO  PB-SV-STATE.
  7629
  7630     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-KEY.
  7631
  7632
  7633* EXEC CICS WRITE
  7634*        DATASET(ERPNDB-FILE-ID)
  7635*        FROM   (PENDING-BUSINESS)
  7636*        RIDFLD (PB-CONTROL-PRIMARY)
  7637*    END-EXEC.
  7638     MOVE LENGTH OF
  7639      PENDING-BUSINESS
  7640       TO DFHEIV11
  7641*    MOVE '&$ L                  ''   #00007116' TO DFHEIV0
  7642     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7643     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7644     MOVE X'2020233030303037313136' TO DFHEIV0(25:11)
  7645     CALL 'kxdfhei1' USING DFHEIV0,
  7646           ERPNDB-FILE-ID,
  7647           PENDING-BUSINESS,
  7648           DFHEIV11,
  7649           PB-CONTROL-PRIMARY,
  7650           DFHEIV99,
  7651           DFHEIV99
  7652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7653
  7654
  7655 2990-EXIT.
  7656     EXIT.
  7657
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 151
* EL630.cbl
  7659 3000-DELETE-ENTERED-BATCH.
  7660     MOVE SPACE          TO PI-NB-MONTH-END-DT
  7661                            PI-SAV-REFERENCE.
  7662
  7663     IF NOT PI-DELETE-IS-OK
  7664         MOVE 'Y'                TO PI-VERIFY-DELETE-SW
  7665         GO TO 3300-FIRST-PF2.
  7666
  7667     MOVE SPACE                  TO PI-ACCT-AGENT-PROCESSED-SW
  7668                                    PI-VERIFY-DELETE-SW.
  7669     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  7670     MOVE PI-SAV-ENTRY-BATCH     TO PNDB-ENTRY-BATCH.
  7671     MOVE 1                      TO PNDB-BATCH-SEQ.
  7672
  7673
  7674* EXEC CICS SYNCPOINT
  7675*    END-EXEC.
  7676*    MOVE '6"                    !   #00007140' TO DFHEIV0
  7677     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7679     MOVE X'2020233030303037313430' TO DFHEIV0(25:11)
  7680     CALL 'kxdfhei1' USING DFHEIV0
  7681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7682
  7683
  7684
  7685* EXEC CICS HANDLE CONDITION
  7686*        NOTFND(3200-NO-RECORDS)
  7687*    END-EXEC.
  7688*    MOVE '"$I                   ! . #00007143' TO DFHEIV0
  7689     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7691     MOVE X'2E20233030303037313433' TO DFHEIV0(25:11)
  7692     CALL 'kxdfhei1' USING DFHEIV0
  7693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7694
  7695
  7696
  7697* EXEC CICS STARTBR
  7698*        DATASET(ERPNDB-FILE-ID)
  7699*        RIDFLD(ERPNDB-KEY)
  7700*    END-EXEC.
  7701     MOVE 0
  7702       TO DFHEIV11
  7703*    MOVE '&,         G          &   #00007147' TO DFHEIV0
  7704     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7705     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7706     MOVE X'2020233030303037313437' TO DFHEIV0(25:11)
  7707     CALL 'kxdfhei1' USING DFHEIV0,
  7708           ERPNDB-FILE-ID,
  7709           ERPNDB-KEY,
  7710           DFHEIV99,
  7711           DFHEIV11,
  7712           DFHEIV99
  7713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7714
  7715
  7716 3000-GET-NEXT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 152
* EL630.cbl
  7717
  7718* EXEC CICS HANDLE CONDITION
  7719*        NOTFND(3120-END-ROUTINE)
  7720*    END-EXEC.
  7721*    MOVE '"$I                   ! / #00007153' TO DFHEIV0
  7722     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7723     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7724     MOVE X'2F20233030303037313533' TO DFHEIV0(25:11)
  7725     CALL 'kxdfhei1' USING DFHEIV0
  7726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7727
  7728
  7729     ADD +1                      TO  WS-SYNC-CNTR.
  7730
  7731     IF WS-SYNC-CNTR GREATER +100
  7732         MOVE +0                 TO  WS-SYNC-CNTR
  7733
  7734* EXEC  CICS SYNCPOINT
  7735*        END-EXEC.
  7736*    MOVE '6"                    !   #00007161' TO DFHEIV0
  7737     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7738     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7739     MOVE X'2020233030303037313631' TO DFHEIV0(25:11)
  7740     CALL 'kxdfhei1' USING DFHEIV0
  7741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7742
  7743
  7744     IF WS-ON1-SW3 IS EQUAL TO 'Y'
  7745         MOVE 'N'                TO  WS-ON1-SW3
  7746         GO TO 3005-READ-NEXT-RECORD.
  7747
  7748
  7749* EXEC CICS STARTBR
  7750*        DATASET(ERPNDB-FILE-ID)
  7751*        RIDFLD (ERPNDB-KEY)
  7752*    END-EXEC.
  7753     MOVE 0
  7754       TO DFHEIV11
  7755*    MOVE '&,         G          &   #00007168' TO DFHEIV0
  7756     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7757     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7758     MOVE X'2020233030303037313638' TO DFHEIV0(25:11)
  7759     CALL 'kxdfhei1' USING DFHEIV0,
  7760           ERPNDB-FILE-ID,
  7761           ERPNDB-KEY,
  7762           DFHEIV99,
  7763           DFHEIV11,
  7764           DFHEIV99
  7765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7766
  7767
  7768
  7769* EXEC CICS HANDLE CONDITION
  7770*        NOTFND (3100-STOP-BROWSE)
  7771*        ENDFILE(3100-STOP-BROWSE)
  7772*    END-EXEC.
  7773*    MOVE '"$I''                  ! 0 #00007173' TO DFHEIV0
  7774     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 153
* EL630.cbl
  7775     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7776     MOVE X'3020233030303037313733' TO DFHEIV0(25:11)
  7777     CALL 'kxdfhei1' USING DFHEIV0
  7778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7779
  7780
  7781 3005-READ-NEXT-RECORD.
  7782
  7783* EXEC CICS READNEXT
  7784*        SET    (ADDRESS OF PENDING-BUSINESS)
  7785*        DATASET(ERPNDB-FILE-ID)
  7786*        RIDFLD (ERPNDB-KEY)
  7787*    END-EXEC.
  7788     MOVE 0
  7789       TO DFHEIV11
  7790*    MOVE '&.S                   )   #00007179' TO DFHEIV0
  7791     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7792     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7793     MOVE X'2020233030303037313739' TO DFHEIV0(25:11)
  7794     CALL 'kxdfhei1' USING DFHEIV0,
  7795           ERPNDB-FILE-ID,
  7796           DFHEIV20,
  7797           DFHEIV99,
  7798           ERPNDB-KEY,
  7799           DFHEIV99,
  7800           DFHEIV11,
  7801           DFHEIV99,
  7802           DFHEIV99
  7803     SET ADDRESS OF PENDING-BUSINESS TO
  7804         DFHEIV20
  7805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7806
  7807
  7808     IF PB-COMPANY-CD  = PI-SAV-COMP-CD AND
  7809        PB-ENTRY-BATCH = PI-SAV-ENTRY-BATCH
  7810         NEXT SENTENCE
  7811     ELSE
  7812         GO TO 3100-STOP-BROWSE.
  7813
  7814     IF PB-BILLED-DT NOT = LOW-VALUES
  7815
  7816* EXEC CICS SYNCPOINT ROLLBACK
  7817*        END-EXEC
  7818*    MOVE '6"R                   !   #00007192' TO DFHEIV0
  7819     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  7820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7821     MOVE X'2020233030303037313932' TO DFHEIV0(25:11)
  7822     CALL 'kxdfhei1' USING DFHEIV0
  7823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7824         MOVE ER-2402            TO EMI-ERROR
  7825         MOVE -1                 TO BATCHL
  7826         MOVE AL-UABON           TO BATCHA
  7827         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7828         GO TO 8200-SEND-DATAONLY.
  7829
  7830******************************************************************
  7831*                DELETE PENDING ADDRESS RECORD                   *
  7832******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 154
* EL630.cbl
  7833
  7834     IF PB-I-MAIL-ADDRS-PRESENT
  7835        NEXT SENTENCE
  7836       ELSE
  7837        GO TO 3006-DELETE-CERTIFICATE.
  7838
  7839
  7840* EXEC CICS HANDLE CONDITION
  7841*         NOTOPEN  (3006-DELETE-CERTIFICATE)
  7842*         NOTFND   (3006-DELETE-CERTIFICATE)
  7843*    END-EXEC.
  7844*    MOVE '"$JI                  ! 1 #00007209' TO DFHEIV0
  7845     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7847     MOVE X'3120233030303037323039' TO DFHEIV0(25:11)
  7848     CALL 'kxdfhei1' USING DFHEIV0
  7849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7850
  7851
  7852
  7853* EXEC CICS READ
  7854*        EQUAL
  7855*        DATASET   (ERPNDM-FILE-ID)
  7856*        SET       (ADDRESS OF PENDING-MAILING-DATA)
  7857*        RIDFLD    (ERPNDB-KEY)
  7858*        UPDATE
  7859*    END-EXEC.
  7860*    MOVE '&"S        EU         (   #00007214' TO DFHEIV0
  7861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7862     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7863     MOVE X'2020233030303037323134' TO DFHEIV0(25:11)
  7864     CALL 'kxdfhei1' USING DFHEIV0,
  7865           ERPNDM-FILE-ID,
  7866           DFHEIV20,
  7867           DFHEIV99,
  7868           ERPNDB-KEY,
  7869           DFHEIV99,
  7870           DFHEIV99,
  7871           DFHEIV99
  7872     SET ADDRESS OF PENDING-MAILING-DATA TO
  7873         DFHEIV20
  7874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7875
  7876
  7877
  7878* EXEC CICS DELETE
  7879*        DATASET   (ERPNDM-FILE-ID)
  7880*    END-EXEC.
  7881*    MOVE '&(                    &   #00007222' TO DFHEIV0
  7882     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7883     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7884     MOVE X'2020233030303037323232' TO DFHEIV0(25:11)
  7885     CALL 'kxdfhei1' USING DFHEIV0,
  7886           ERPNDM-FILE-ID,
  7887           DFHEIV99,
  7888           DFHEIV99,
  7889           DFHEIV99,
  7890           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 155
* EL630.cbl
  7891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7892
  7893
  7894 3006-DELETE-CERTIFICATE.
  7895     IF PB-BATCH-TRAILER
  7896        GO TO 3020-CONTINUE-DELETE.
  7897
  7898
  7899* EXEC CICS HANDLE CONDITION
  7900*         NOTFND  (3020-CONTINUE-DELETE)
  7901*    END-EXEC.
  7902*    MOVE '"$I                   ! 2 #00007230' TO DFHEIV0
  7903     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7904     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7905     MOVE X'3220233030303037323330' TO DFHEIV0(25:11)
  7906     CALL 'kxdfhei1' USING DFHEIV0
  7907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7908
  7909
  7910     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
  7911     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7912     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7913     MOVE PB-SV-STATE            TO CERT-STATE.
  7914
  7915* EXEC CICS READ
  7916*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  7917*        DATASET (ELCERT-FILE-ID)
  7918*        RIDFLD  (ELCERT-KEY)
  7919*        UPDATE
  7920*    END-EXEC.
  7921*    MOVE '&"S        EU         (   #00007238' TO DFHEIV0
  7922     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7923     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7924     MOVE X'2020233030303037323338' TO DFHEIV0(25:11)
  7925     CALL 'kxdfhei1' USING DFHEIV0,
  7926           ELCERT-FILE-ID,
  7927           DFHEIV20,
  7928           DFHEIV99,
  7929           ELCERT-KEY,
  7930           DFHEIV99,
  7931           DFHEIV99,
  7932           DFHEIV99
  7933     SET ADDRESS OF CERTIFICATE-MASTER TO
  7934         DFHEIV20
  7935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7936
  7937
  7938     IF INSURED-ADDR-PRESENT
  7939        MOVE 'Y'                  TO WS-CERT-ADDRESS-SW
  7940     ELSE
  7941        MOVE ' '                  TO WS-CERT-ADDRESS-SW.
  7942
  7943     IF  CERT-NOTES-ARE-NOT-PRESENT
  7944         MOVE ' '                TO WS-CERT-NOTE-SW
  7945     ELSE
  7946         MOVE 'Y'                TO WS-CERT-NOTE-SW.
  7947
  7948     IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 156
* EL630.cbl
  7949        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  7950           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7951           MOVE ZERO                  TO CM-LF-ITD-CANCEL-AMT
  7952           MOVE LOW-VALUES            TO CM-LF-CANCEL-EXIT-DT
  7953                                         CM-LF-CANCEL-DT
  7954           MOVE SPACE                 TO CM-LF-EXIT-BATCH
  7955        ELSE
  7956           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7957           MOVE PB-CI-LF-CANCEL-AMT   TO CM-LF-ITD-CANCEL-AMT
  7958           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
  7959           MOVE PB-CI-LIVES              TO CM-LIVES.
  7960
  7961     IF PB-CANCELLATION
  7962        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  7963           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL SPACE
  7964               MOVE CM-LF-STATUS-AT-CANCEL
  7965                                        TO CM-LF-CURRENT-STATUS
  7966               MOVE SPACE
  7967                                        TO CM-LF-STATUS-AT-CANCEL
  7968            ELSE
  7969               MOVE PB-CI-LF-POLICY-STATUS
  7970                                        TO CM-LF-CURRENT-STATUS
  7971        ELSE
  7972            MOVE PB-CI-LF-POLICY-STATUS TO CM-LF-CURRENT-STATUS.
  7973
  7974     IF PB-CANCELLATION
  7975        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  7976           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7977           MOVE ZERO                  TO CM-AH-ITD-CANCEL-AMT
  7978           MOVE LOW-VALUES            TO CM-AH-CANCEL-EXIT-DT
  7979                                         CM-AH-CANCEL-DT
  7980           MOVE SPACE                 TO CM-AH-EXIT-BATCH
  7981        ELSE
  7982           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7983           MOVE PB-CI-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT
  7984           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
  7985           MOVE PB-CI-LIVES           TO CM-LIVES.
  7986
  7987     IF PB-CANCELLATION
  7988        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  7989           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL SPACE
  7990               MOVE CM-AH-STATUS-AT-CANCEL
  7991                                        TO CM-AH-CURRENT-STATUS
  7992               MOVE SPACE
  7993                                        TO CM-AH-STATUS-AT-CANCEL
  7994               GO TO 3010-REWRITE-CERT
  7995            ELSE
  7996               MOVE PB-CI-AH-POLICY-STATUS
  7997                                        TO CM-AH-CURRENT-STATUS
  7998               GO TO 3010-REWRITE-CERT
  7999        ELSE
  8000            MOVE PB-CI-AH-POLICY-STATUS TO CM-AH-CURRENT-STATUS
  8001            GO TO 3010-REWRITE-CERT.
  8002
  8003******************************************************************
  8004******************************************************************
  8005******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
  8006******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 157
* EL630.cbl
  8007******************************************************************
  8008******************************************************************
  8009
  8010     IF CERT-ADDED-BATCH AND
  8011        (NOT NO-CLAIM-ATTACHED
  8012         OR
  8013         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
  8014        GO TO 3010-REWRITE-CERT.
  8015
  8016******************************************************************
  8017******************************************************************
  8018
  8019     IF CERT-ADDED-BATCH  AND
  8020        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
  8021        GO TO 3010-REWRITE-CERT.
  8022
  8023     IF NO-CLAIM-ATTACHED
  8024         NEXT SENTENCE
  8025       ELSE
  8026         MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
  8027         MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
  8028         GO TO 3010-REWRITE-CERT.
  8029
  8030
  8031* EXEC CICS DELETE
  8032*            DATASET    (ELCERT-FILE-ID)
  8033*       END-EXEC.
  8034*    MOVE '&(                    &   #00007337' TO DFHEIV0
  8035     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8036     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8037     MOVE X'2020233030303037333337' TO DFHEIV0(25:11)
  8038     CALL 'kxdfhei1' USING DFHEIV0,
  8039           ELCERT-FILE-ID,
  8040           DFHEIV99,
  8041           DFHEIV99,
  8042           DFHEIV99,
  8043           DFHEIV99
  8044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8045
  8046
  8047******************************************************************
  8048*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
  8049******************************************************************
  8050
  8051     IF CERT-NOTES-ARE-PRESENT
  8052        NEXT SENTENCE
  8053     ELSE
  8054        GO TO 3007-DELETE-MAILING-DATA.
  8055
  8056
  8057* EXEC CICS HANDLE CONDITION
  8058*         NOTFND  (3006-DELETE-ERNOTE)
  8059*    END-EXEC.
  8060*    MOVE '"$I                   ! 3 #00007350' TO DFHEIV0
  8061     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8063     MOVE X'3320233030303037333530' TO DFHEIV0(25:11)
  8064     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 158
* EL630.cbl
  8065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8066
  8067
  8068     MOVE ELCERT-KEY            TO ERCNOT-KEY.
  8069     MOVE '0'                   TO ERCNOT-REC-TYPE.
  8070     MOVE 0                     TO ERCNOT-SEQUENCE.
  8071
  8072 3006-DELETE-ERCNOT-LOOP.
  8073
  8074
  8075* EXEC CICS READ
  8076*        GTEQ
  8077*        DATASET   (ERCNOT-FILE-ID)
  8078*        SET       (ADDRESS OF CERT-NOTE-FILE)
  8079*        RIDFLD    (ERCNOT-KEY)
  8080*    END-EXEC.
  8081*    MOVE '&"S        G          (   #00007360' TO DFHEIV0
  8082     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8083     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8084     MOVE X'2020233030303037333630' TO DFHEIV0(25:11)
  8085     CALL 'kxdfhei1' USING DFHEIV0,
  8086           ERCNOT-FILE-ID,
  8087           DFHEIV20,
  8088           DFHEIV99,
  8089           ERCNOT-KEY,
  8090           DFHEIV99,
  8091           DFHEIV99,
  8092           DFHEIV99
  8093     SET ADDRESS OF CERT-NOTE-FILE TO
  8094         DFHEIV20
  8095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8096
  8097
  8098     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
  8099     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
  8100         GO TO 3006-DELETE-ERNOTE
  8101     END-IF.
  8102
  8103
  8104* EXEC CICS DELETE
  8105*        DATASET   (ERCNOT-FILE-ID)
  8106*        RIDFLD    (ERCNOT-KEY)
  8107*        END-EXEC.
  8108*    MOVE '&(  R                 &   #00007372' TO DFHEIV0
  8109     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8110     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8111     MOVE X'2020233030303037333732' TO DFHEIV0(25:11)
  8112     CALL 'kxdfhei1' USING DFHEIV0,
  8113           ERCNOT-FILE-ID,
  8114           ERCNOT-KEY,
  8115           DFHEIV99,
  8116           DFHEIV99,
  8117           DFHEIV99
  8118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8119
  8120
  8121     GO TO 3006-DELETE-ERCNOT-LOOP.
  8122
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 159
* EL630.cbl
  8123 3006-DELETE-ERNOTE.
  8124
  8125     move elcert-key             to ernote-key
  8126     move '1'                    to ernote-rec-type
  8127
  8128
  8129* exec cics delete
  8130*       dataset    (ernote-file-id)
  8131*       keylength  (ernote-generic-key-len)
  8132*       ridfld     (ernote-key(1:33))
  8133*       generic
  8134*       resp       (w-response)
  8135*    end-exec
  8136*    MOVE '&(  RKG               &  N#00007384' TO DFHEIV0
  8137     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  8138     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8139     MOVE X'204E233030303037333834' TO DFHEIV0(25:11)
  8140     CALL 'kxdfhei1' USING DFHEIV0,
  8141           ernote-file-id,
  8142           ernote-key(1 : 33),
  8143           ernote-generic-key-len,
  8144           DFHEIV99,
  8145           DFHEIV99
  8146     MOVE EIBRESP  TO w-response
  8147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8148     .
  8149******************************************************************
  8150*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
  8151******************************************************************
  8152
  8153 3007-DELETE-MAILING-DATA.
  8154     IF CERT-ADDRESS-PRESENT
  8155        NEXT SENTENCE
  8156     ELSE
  8157        GO TO 3020-CONTINUE-DELETE.
  8158
  8159
  8160* EXEC CICS HANDLE CONDITION
  8161*         NOTOPEN  (3020-CONTINUE-DELETE)
  8162*         NOTFND   (3020-CONTINUE-DELETE)
  8163*    END-EXEC.
  8164*    MOVE '"$JI                  ! 4 #00007402' TO DFHEIV0
  8165     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8167     MOVE X'3420233030303037343032' TO DFHEIV0(25:11)
  8168     CALL 'kxdfhei1' USING DFHEIV0
  8169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8170
  8171
  8172
  8173* EXEC CICS READ
  8174*        EQUAL
  8175*        DATASET   (ERMAIL-FILE-ID)
  8176*        SET       (ADDRESS OF MAILING-DATA)
  8177*        RIDFLD    (ELCERT-KEY)
  8178*        UPDATE
  8179*    END-EXEC.
  8180*    MOVE '&"S        EU         (   #00007407' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 160
* EL630.cbl
  8181     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8182     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8183     MOVE X'2020233030303037343037' TO DFHEIV0(25:11)
  8184     CALL 'kxdfhei1' USING DFHEIV0,
  8185           ERMAIL-FILE-ID,
  8186           DFHEIV20,
  8187           DFHEIV99,
  8188           ELCERT-KEY,
  8189           DFHEIV99,
  8190           DFHEIV99,
  8191           DFHEIV99
  8192     SET ADDRESS OF MAILING-DATA TO
  8193         DFHEIV20
  8194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8195
  8196
  8197
  8198* EXEC CICS DELETE
  8199*        DATASET   (ERMAIL-FILE-ID)
  8200*    END-EXEC.
  8201*    MOVE '&(                    &   #00007415' TO DFHEIV0
  8202     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8203     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8204     MOVE X'2020233030303037343135' TO DFHEIV0(25:11)
  8205     CALL 'kxdfhei1' USING DFHEIV0,
  8206           ERMAIL-FILE-ID,
  8207           DFHEIV99,
  8208           DFHEIV99,
  8209           DFHEIV99,
  8210           DFHEIV99
  8211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8212
  8213
  8214     GO TO 3020-CONTINUE-DELETE.
  8215
  8216 3010-REWRITE-CERT.
  8217
  8218
  8219* EXEC CICS REWRITE
  8220*        DATASET    (ELCERT-FILE-ID)
  8221*        FROM       (CERTIFICATE-MASTER)
  8222*    END-EXEC.
  8223     MOVE LENGTH OF
  8224      CERTIFICATE-MASTER
  8225       TO DFHEIV11
  8226*    MOVE '&& L                  %   #00007423' TO DFHEIV0
  8227     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8228     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8229     MOVE X'2020233030303037343233' TO DFHEIV0(25:11)
  8230     CALL 'kxdfhei1' USING DFHEIV0,
  8231           ELCERT-FILE-ID,
  8232           CERTIFICATE-MASTER,
  8233           DFHEIV11,
  8234           DFHEIV99
  8235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8236
  8237
  8238 3020-CONTINUE-DELETE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 161
* EL630.cbl
  8239
  8240
  8241* EXEC CICS ENDBR
  8242*        DATASET(ERPNDB-FILE-ID)
  8243*    END-EXEC.
  8244     MOVE 0
  8245       TO DFHEIV11
  8246*    MOVE '&2                    $   #00007430' TO DFHEIV0
  8247     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8248     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8249     MOVE X'2020233030303037343330' TO DFHEIV0(25:11)
  8250     CALL 'kxdfhei1' USING DFHEIV0,
  8251           ERPNDB-FILE-ID,
  8252           DFHEIV11,
  8253           DFHEIV99
  8254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8255
  8256
  8257
  8258* EXEC CICS DELETE
  8259*        DATASET(ERPNDB-FILE-ID)
  8260*        RIDFLD (ERPNDB-KEY)
  8261*    END-EXEC.
  8262*    MOVE '&(  R                 &   #00007434' TO DFHEIV0
  8263     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8264     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8265     MOVE X'2020233030303037343334' TO DFHEIV0(25:11)
  8266     CALL 'kxdfhei1' USING DFHEIV0,
  8267           ERPNDB-FILE-ID,
  8268           ERPNDB-KEY,
  8269           DFHEIV99,
  8270           DFHEIV99,
  8271           DFHEIV99
  8272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8273
  8274
  8275     ADD 1   TO WS-DELETE-CNT.
  8276     GO TO 3000-GET-NEXT-RECORD.
  8277
  8278 3100-STOP-BROWSE.
  8279
  8280* EXEC CICS ENDBR
  8281*        DATASET(ERPNDB-FILE-ID)
  8282*    END-EXEC.
  8283     MOVE 0
  8284       TO DFHEIV11
  8285*    MOVE '&2                    $   #00007443' TO DFHEIV0
  8286     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8287     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8288     MOVE X'2020233030303037343433' TO DFHEIV0(25:11)
  8289     CALL 'kxdfhei1' USING DFHEIV0,
  8290           ERPNDB-FILE-ID,
  8291           DFHEIV11,
  8292           DFHEIV99
  8293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8294
  8295
  8296 3120-END-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 162
* EL630.cbl
  8297     MOVE SPACE                  TO PI-UPDATE-SW.
  8298
  8299     IF WS-DELETE-CNT NOT GREATER ZERO
  8300         GO TO 3200-NO-RECORDS.
  8301
  8302     IF PI-AR-PROCESSING
  8303        MOVE 'Y'                 TO WS-RECORD-FOUND-SW
  8304        PERFORM 7000-VERIFY-REQUEST-REC THRU 7090-EXIT
  8305        IF RECORD-NOT-FOUND
  8306           GO TO 8200-SEND-DATAONLY.
  8307
  8308     IF PI-SAVE-CALLING-PGM NOT = XCTL-6301 and 'VP6301'
  8309         MOVE ZEROS              TO EMI-ERROR
  8310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8311
  8312     MOVE SPACE                  TO PI-BROWSE-SW.
  8313     MOVE LOW-VALUES             TO EL630AO.
  8314     MOVE QUESTION-MARKS         TO BATCHI.
  8315     MOVE AL-UANON               TO BATCHA.
  8316     MOVE -1                     TO MAINTL.
  8317     GO TO 8100-SEND-INITIAL-MAP.
  8318
  8319 3200-NO-RECORDS.
  8320     MOVE ER-2242                TO EMI-ERROR.
  8321     MOVE -1 TO BATCHL
  8322     MOVE AL-UABON               TO BATCHA.
  8323     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8324     GO TO 8200-SEND-DATAONLY.
  8325
  8326 3300-FIRST-PF2.
  8327     MOVE SPACE                  TO PI-CLEAR-ERROR-SW.
  8328     MOVE ER-2422                TO EMI-ERROR.
  8329     MOVE -1                     TO PFENTERL.
  8330     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8331     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 163
* EL630.cbl
  8333
  8334 4000-SHOW-TOTALS.
  8335
  8336     MOVE LOW-VALUES             TO EL630AI.
  8337     MOVE PI-SAV-ENTRY-BATCH     TO BATCHO.
  8338     MOVE PI-SAV-REFERENCE       TO REFO.
  8339
  8340     IF PI-DATA-UPDATED
  8341        MOVE 'C'                TO PI-MAINT-FUNC.
  8342
  8343     MOVE PI-MAINT-FUNC          TO MAINTO.
  8344
  8345     IF PI-SAV-CARRIER NOT = SPACES
  8346         MOVE PI-SAV-CARRIER     TO CARRIERO.
  8347
  8348     IF PI-SAV-GROUPING NOT = SPACES
  8349         MOVE PI-SAV-GROUPING    TO GROUPO.
  8350
  8351     IF PI-SAV-STATE NOT = SPACES
  8352         MOVE PI-SAV-STATE       TO STATEO.
  8353
  8354     MOVE PI-SAV-ACCOUNT         TO ACCOUNTO.
  8355
  8356     IF PI-DATA-UPDATED
  8357         MOVE AL-SANON           TO BATCHA
  8358                                    MAINTA
  8359                                    CARRIERA
  8360                                    GROUPA
  8361                                    STATEA
  8362                                    ACCOUNTA
  8363     ELSE
  8364         MOVE AL-UANON           TO BATCHA
  8365                                    MAINTA
  8366                                    CARRIERA
  8367                                    GROUPA
  8368                                    STATEA
  8369                                    ACCOUNTA.
  8370
  8371     MOVE PI-LF-ISS-ENTERED      TO ALFISSO.
  8372     IF PI-LF-ISS-REMITTED NOT = ZEROS
  8373         MOVE PI-LF-ISS-REMITTED TO ELFISSO
  8374         MOVE AL-UNNON           TO ELFISSA
  8375         COMPUTE WS-OBAL = PI-LF-ISS-REMITTED - PI-LF-ISS-ENTERED
  8376         IF WS-OBAL NOT = ZEROS
  8377             MOVE WS-OBAL        TO OLFISSO.
  8378
  8379     MOVE PI-LF-CAN-ENTERED      TO ALFCANO.
  8380     IF PI-LF-CAN-REMITTED NOT = ZEROS
  8381         MOVE PI-LF-CAN-REMITTED TO ELFCANO
  8382         MOVE AL-UNNON           TO ELFCANA
  8383         COMPUTE WS-OBAL = PI-LF-CAN-REMITTED - PI-LF-CAN-ENTERED
  8384         IF WS-OBAL NOT = ZEROS
  8385             MOVE WS-OBAL        TO OLFCANO.
  8386
  8387     MOVE PI-AH-ISS-ENTERED      TO AAHISSO.
  8388     IF PI-AH-ISS-REMITTED NOT = ZEROS
  8389         MOVE PI-AH-ISS-REMITTED TO EAHISSO
  8390         MOVE AL-UNNON           TO EAHISSA
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 164
* EL630.cbl
  8391         COMPUTE WS-OBAL = PI-AH-ISS-REMITTED - PI-AH-ISS-ENTERED
  8392         IF WS-OBAL NOT = ZEROS
  8393             MOVE WS-OBAL        TO OAHISSO.
  8394
  8395     MOVE PI-AH-CAN-ENTERED      TO AAHCANO.
  8396     IF PI-AH-CAN-REMITTED NOT = ZEROS
  8397         MOVE PI-AH-CAN-REMITTED TO EAHCANO
  8398         MOVE AL-UNNON           TO EAHCANA
  8399         COMPUTE WS-OBAL = PI-AH-CAN-REMITTED - PI-AH-CAN-ENTERED
  8400         IF WS-OBAL NOT = ZEROS
  8401             MOVE WS-OBAL        TO OAHCANO.
  8402
  8403     MOVE PI-ISS-CNT-ENTERED     TO AISSCNTO.
  8404     IF PI-ISS-CNT-REMITTED NOT = ZEROS
  8405         MOVE PI-ISS-CNT-REMITTED TO EISSCNTO
  8406         MOVE AL-UNNON            TO EISSCNTA
  8407         COMPUTE WS-OCNT = PI-ISS-CNT-REMITTED -
  8408                                PI-ISS-CNT-ENTERED
  8409         IF WS-OCNT NOT = ZEROS
  8410             MOVE WS-OCNT        TO OISSCNTO.
  8411
  8412     MOVE PI-CAN-CNT-ENTERED     TO ACANCNTO.
  8413     IF PI-CAN-CNT-REMITTED NOT = ZEROS
  8414         MOVE PI-CAN-CNT-REMITTED TO ECANCNTO
  8415         MOVE AL-UNNON            TO ECANCNTA
  8416         COMPUTE WS-OCNT = PI-CAN-CNT-REMITTED -
  8417                                PI-CAN-CNT-ENTERED
  8418         IF WS-OCNT NOT = ZEROS
  8419             MOVE WS-OCNT        TO OCANCNTO.
  8420
  8421     IF  PI-NB-MONTH-END-DT GREATER SPACES
  8422         MOVE PI-NB-MONTH-END-DT TO DC-BIN-DATE-1
  8423       ELSE
  8424         MOVE PI-CR-MONTH-END-DT TO DC-BIN-DATE-1.
  8425
  8426     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8427     PERFORM  9700-DATE-LINK.
  8428
  8429     IF  DATE-CONVERSION-ERROR
  8430         MOVE LOW-VALUES TO MNTHNDTO
  8431         GO TO 0490-EXIT.
  8432
  8433     MOVE DC-GREG-DATE-1-EDIT    TO  MNTHNDTO.
  8434     MOVE AL-UANON               TO  MNTHNDTA.
  8435
  8436     IF  PI-NB-MONTH-END-DT GREATER SPACES
  8437         MOVE PI-NB-MONTH-END-DT TO DC-BIN-DATE-1
  8438       ELSE
  8439         MOVE PI-CR-MONTH-END-DT TO DC-BIN-DATE-1.
  8440
  8441     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8442     PERFORM  9700-DATE-LINK.
  8443
  8444     IF  DATE-CONVERSION-ERROR
  8445         MOVE LOW-VALUES TO MNTHNDTO
  8446     ELSE
  8447         MOVE DC-GREG-DATE-1-EDIT    TO  MNTHNDTO
  8448         MOVE AL-UANON               TO  MNTHNDTA.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 165
* EL630.cbl
  8449
  8450     MOVE PI-RECEIVED-DT         TO DC-BIN-DATE-1.
  8451
  8452     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8453     PERFORM  9700-DATE-LINK.
  8454
  8455     IF  DATE-CONVERSION-ERROR
  8456         MOVE LOW-VALUES TO RECEVDTO
  8457     ELSE
  8458         MOVE DC-GREG-DATE-1-EDIT    TO  RECEVDTO
  8459         MOVE AL-UANON               TO  RECEVDTA.
  8460
  8461     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 166
* EL630.cbl
  8463
  8464*****************************************************************
  8465*            U P D A T E   E N T I R E   B A T C H              *
  8466*  THIS SECTION UPDATES AN ENTIRE BATCH WITH A NEW MONTH END    *
  8467*  DATE.                                                        *
  8468*****************************************************************
  8469
  8470 5000-UPDATE-ENTIRE-BATCH.
  8471
  8472     MOVE ZEROS                  TO  PNDB-BATCH-SEQ
  8473                                     PNDB-BATCH-CHG-SEQ.
  8474
  8475
  8476* EXEC CICS HANDLE CONDITION
  8477*        NOTFND(5900-EXIT)
  8478*    END-EXEC.
  8479*    MOVE '"$I                   ! 5 #00007626' TO DFHEIV0
  8480     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8482     MOVE X'3520233030303037363236' TO DFHEIV0(25:11)
  8483     CALL 'kxdfhei1' USING DFHEIV0
  8484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8485
  8486
  8487
  8488* EXEC CICS STARTBR
  8489*        DATASET(ERPNDB-FILE-ID)
  8490*        RIDFLD (ERPNDB-KEY)
  8491*    END-EXEC.
  8492     MOVE 0
  8493       TO DFHEIV11
  8494*    MOVE '&,         G          &   #00007630' TO DFHEIV0
  8495     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8496     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8497     MOVE X'2020233030303037363330' TO DFHEIV0(25:11)
  8498     CALL 'kxdfhei1' USING DFHEIV0,
  8499           ERPNDB-FILE-ID,
  8500           ERPNDB-KEY,
  8501           DFHEIV99,
  8502           DFHEIV11,
  8503           DFHEIV99
  8504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8505
  8506
  8507 5010-GET-NEXT-RECORD.
  8508
  8509* EXEC CICS HANDLE CONDITION
  8510*        NOTFND (5100-STOP-BROWSE)
  8511*        ENDFILE(5100-STOP-BROWSE)
  8512*    END-EXEC.
  8513*    MOVE '"$I''                  ! 6 #00007636' TO DFHEIV0
  8514     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8515     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8516     MOVE X'3620233030303037363336' TO DFHEIV0(25:11)
  8517     CALL 'kxdfhei1' USING DFHEIV0
  8518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8519
  8520
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 167
* EL630.cbl
  8521 5020-READ-NEXT-RECORD.
  8522
  8523* EXEC CICS READNEXT
  8524*        SET    (ADDRESS OF PENDING-BUSINESS)
  8525*        DATASET(ERPNDB-FILE-ID)
  8526*        RIDFLD (ERPNDB-KEY)
  8527*    END-EXEC.
  8528     MOVE 0
  8529       TO DFHEIV11
  8530*    MOVE '&.S                   )   #00007642' TO DFHEIV0
  8531     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8532     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8533     MOVE X'2020233030303037363432' TO DFHEIV0(25:11)
  8534     CALL 'kxdfhei1' USING DFHEIV0,
  8535           ERPNDB-FILE-ID,
  8536           DFHEIV20,
  8537           DFHEIV99,
  8538           ERPNDB-KEY,
  8539           DFHEIV99,
  8540           DFHEIV11,
  8541           DFHEIV99,
  8542           DFHEIV99
  8543     SET ADDRESS OF PENDING-BUSINESS TO
  8544         DFHEIV20
  8545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8546
  8547
  8548     IF WS-ON1-SW4 IS EQUAL TO 'Y'
  8549         MOVE 'N'                    TO  WS-ON1-SW4
  8550         MOVE PB-CONTROL-PRIMARY     TO  WS-SAV-PNDB-KEY
  8551         GO TO 5030-READ-FOR-UPDATE.
  8552
  8553     IF ERPNDB-KEY = WS-SAV-PNDB-KEY
  8554        GO TO 5020-READ-NEXT-RECORD.
  8555
  8556     IF PB-COMPANY-CD  = WS-SAV-COMP-CD  AND
  8557        PB-ENTRY-BATCH = WS-SAV-ENTRY-BATCH
  8558         NEXT SENTENCE
  8559     ELSE
  8560         GO TO 5100-STOP-BROWSE.
  8561
  8562     IF PB-ISSUE
  8563        IF PB-I-REFERENCE NOT = PI-SAV-REFERENCE
  8564           GO TO 5030-READ-FOR-UPDATE.
  8565
  8566     IF PB-CANCELLATION
  8567        IF PB-C-REFERENCE NOT = PI-SAV-REFERENCE
  8568           GO TO 5030-READ-FOR-UPDATE.
  8569
  8570     IF PB-CREDIT-SELECT-DT = PI-NB-MONTH-END-DT
  8571         GO TO 5010-GET-NEXT-RECORD.
  8572
  8573 5030-READ-FOR-UPDATE.
  8574
  8575* EXEC CICS ENDBR
  8576*        DATASET(ERPNDB-FILE-ID)
  8577*    END-EXEC.
  8578     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 168
* EL630.cbl
  8579       TO DFHEIV11
  8580*    MOVE '&2                    $   #00007674' TO DFHEIV0
  8581     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8582     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8583     MOVE X'2020233030303037363734' TO DFHEIV0(25:11)
  8584     CALL 'kxdfhei1' USING DFHEIV0,
  8585           ERPNDB-FILE-ID,
  8586           DFHEIV11,
  8587           DFHEIV99
  8588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8589
  8590
  8591
  8592* EXEC CICS READ
  8593*        SET     (ADDRESS OF PENDING-BUSINESS)
  8594*        DATASET (ERPNDB-FILE-ID)
  8595*        RIDFLD  (ERPNDB-KEY)
  8596*        UPDATE
  8597*    END-EXEC.
  8598*    MOVE '&"S        EU         (   #00007678' TO DFHEIV0
  8599     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8600     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8601     MOVE X'2020233030303037363738' TO DFHEIV0(25:11)
  8602     CALL 'kxdfhei1' USING DFHEIV0,
  8603           ERPNDB-FILE-ID,
  8604           DFHEIV20,
  8605           DFHEIV99,
  8606           ERPNDB-KEY,
  8607           DFHEIV99,
  8608           DFHEIV99,
  8609           DFHEIV99
  8610     SET ADDRESS OF PENDING-BUSINESS TO
  8611         DFHEIV20
  8612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8613
  8614
  8615     MOVE ERPNDB-KEY                  TO WS-SAV-PNDB-KEY.
  8616
  8617     IF PI-NB-MONTH-END-DT GREATER THAN SPACES
  8618        MOVE  PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  8619
  8620     IF PB-ISSUE
  8621        IF PB-I-REFERENCE NOT = PI-SAV-REFERENCE
  8622           MOVE PI-SAV-REFERENCE TO PB-I-REFERENCE.
  8623
  8624     IF PB-CANCELLATION
  8625        IF PB-C-REFERENCE NOT = PI-SAV-REFERENCE
  8626           MOVE PI-SAV-REFERENCE TO PB-C-REFERENCE.
  8627
  8628 5050-REWRITE-PENDING-BUS.
  8629
  8630* EXEC CICS REWRITE
  8631*         DATASET    (ERPNDB-FILE-ID)
  8632*         FROM       (PENDING-BUSINESS)
  8633*     END-EXEC.
  8634     MOVE LENGTH OF
  8635      PENDING-BUSINESS
  8636       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 169
* EL630.cbl
  8637*    MOVE '&& L                  %   #00007699' TO DFHEIV0
  8638     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8639     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8640     MOVE X'2020233030303037363939' TO DFHEIV0(25:11)
  8641     CALL 'kxdfhei1' USING DFHEIV0,
  8642           ERPNDB-FILE-ID,
  8643           PENDING-BUSINESS,
  8644           DFHEIV11,
  8645           DFHEIV99
  8646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8647
  8648
  8649
  8650* EXEC CICS STARTBR
  8651*        DATASET(ERPNDB-FILE-ID)
  8652*        RIDFLD (ERPNDB-KEY)
  8653*    END-EXEC.
  8654     MOVE 0
  8655       TO DFHEIV11
  8656*    MOVE '&,         G          &   #00007704' TO DFHEIV0
  8657     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8658     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8659     MOVE X'2020233030303037373034' TO DFHEIV0(25:11)
  8660     CALL 'kxdfhei1' USING DFHEIV0,
  8661           ERPNDB-FILE-ID,
  8662           ERPNDB-KEY,
  8663           DFHEIV99,
  8664           DFHEIV11,
  8665           DFHEIV99
  8666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8667
  8668
  8669     GO TO 5010-GET-NEXT-RECORD.
  8670
  8671 5100-STOP-BROWSE.
  8672
  8673* EXEC CICS ENDBR
  8674*        DATASET(ERPNDB-FILE-ID)
  8675*    END-EXEC.
  8676     MOVE 0
  8677       TO DFHEIV11
  8678*    MOVE '&2                    $   #00007712' TO DFHEIV0
  8679     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8680     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8681     MOVE X'2020233030303037373132' TO DFHEIV0(25:11)
  8682     CALL 'kxdfhei1' USING DFHEIV0,
  8683           ERPNDB-FILE-ID,
  8684           DFHEIV11,
  8685           DFHEIV99
  8686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8687
  8688
  8689 5900-EXIT.
  8690      EXIT.
  8691
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 170
* EL630.cbl
  8693
  8694******************************************************************
  8695*          R E W R I T E   E N T I R E   B A T C H              *
  8696*  THIS SECTION REWRITES AN ENTIRE BATCH WITH NEW ACCOUNT INFO. *
  8697*  1.  DELETE THE PENDING BUSINESS RECORD                       *
  8698*  2.  IF THE PENDING RECORD IS AN ISSUE, AND THE CERTIFICATE   *
  8699*      HAS NOT BEEN ADDED TO BATCH OR A CLAIM IS NOT ATTACHED,  *
  8700*      DELETE THE CERTIFICATE,CERTIFICATE NOTES, AND MAILING    *
  8701*      RECORDS                                                  *
  8702*  3.  IF THE PENDING RECORD HAS BEEN ADDED TO BATCH OR A CLAIM *
  8703*      IS ATTACHED MOVE SPACE TO CM-CREDIT-INTERFACE-SW-1 AND   *
  8704*      REWRITE THE CERTIFICATE.                                 *
  8705*  4.  IF THE PENDING RECORD IS CANCELLATION, BACKOUT THE       *
  8706*      CANCELLATION INFORMATION IN THE CERTIFICATE RECORD       *
  8707*      AND REWRITE THE CERTIFICATE.                             *
  8708*  5.  WRITE A NEW PENDING BUSINESS RECORD WITH THE NEW ACCOUNT *
  8709*      INFORMATION.                                             *
  8710*  6.  AFTER EACH DETAIL RECORD IS PROCESSED REWRITE THE BATCH  *
  8711*      RECORD WITH THE NEW ACCOUNT INFORMATION.                 *
  8712*  7.  ONCE THE BATCH IS REWRITTEN FORCE THE OPERATOR TO        *
  8713*      RE-EDITED THE BATCH.                                     *
  8714*  NOTE:  THE PENDING BUSINESS RECORDS ARE DELETED AND ADDED    *
  8715*         TO RESET THE ALTERNATE INDEX.                         *
  8716******************************************************************
  8717 6000-REWRITE-ENTIRE-BATCH.
  8718     IF  NOT EMI-NO-ERRORS
  8719         GO TO 8200-SEND-DATAONLY.
  8720
  8721     PERFORM 0400-PRIME-BATCH-TOTALS  THRU  0490-EXIT.
  8722
  8723     IF  EMI-ERROR = ZEROS
  8724         MOVE 'N'                TO  PI-EL630-FIRST-TIME-SW
  8725       ELSE
  8726         GO TO 8200-SEND-DATAONLY.
  8727
  8728     MOVE PI-SAV-COMP-CD         TO  PNDB-COMP-CD.
  8729     MOVE PI-SAV-ENTRY-BATCH     TO  PNDB-ENTRY-BATCH.
  8730
  8731     MOVE ZEROS                  TO  PNDB-BATCH-SEQ
  8732                                     PNDB-BATCH-CHG-SEQ.
  8733
  8734
  8735* EXEC CICS GETMAIN
  8736*        SET    (ADDRESS OF PENDING-BUSINESS)
  8737*        LENGTH (585)
  8738*        INITIMG(GETMAIN-SPACE)
  8739*    END-EXEC.
  8740     MOVE 585
  8741       TO DFHEIV11
  8742*    MOVE ',"IL                  $   #00007761' TO DFHEIV0
  8743     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8744     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8745     MOVE X'2020233030303037373631' TO DFHEIV0(25:11)
  8746     CALL 'kxdfhei1' USING DFHEIV0,
  8747           DFHEIV20,
  8748           DFHEIV11,
  8749           GETMAIN-SPACE
  8750     SET ADDRESS OF PENDING-BUSINESS TO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 171
* EL630.cbl
  8751         DFHEIV20
  8752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8753
  8754
  8755
  8756* EXEC CICS HANDLE CONDITION
  8757*        NOTFND(6500-NO-RECORDS)
  8758*    END-EXEC.
  8759*    MOVE '"$I                   ! 7 #00007767' TO DFHEIV0
  8760     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8761     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8762     MOVE X'3720233030303037373637' TO DFHEIV0(25:11)
  8763     CALL 'kxdfhei1' USING DFHEIV0
  8764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8765
  8766
  8767 6010-GET-NEXT-RECORD.
  8768     IF WS-ON1-SW5 IS EQUAL TO 'Y'
  8769         MOVE 'N'                TO  WS-ON1-SW5
  8770         GO TO 6015-START-BROWSE.
  8771
  8772
  8773* EXEC CICS HANDLE CONDITION
  8774*        NOTFND (6400-STOP-BROWSE)
  8775*        ENDFILE(6400-STOP-BROWSE)
  8776*    END-EXEC.
  8777*    MOVE '"$I''                  ! 8 #00007776' TO DFHEIV0
  8778     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8780     MOVE X'3820233030303037373736' TO DFHEIV0(25:11)
  8781     CALL 'kxdfhei1' USING DFHEIV0
  8782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8783
  8784
  8785 6015-START-BROWSE.
  8786
  8787* EXEC CICS STARTBR
  8788*        DATASET(ERPNDB-FILE-ID)
  8789*        RIDFLD (ERPNDB-KEY)
  8790*    END-EXEC.
  8791     MOVE 0
  8792       TO DFHEIV11
  8793*    MOVE '&,         G          &   #00007782' TO DFHEIV0
  8794     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8795     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8796     MOVE X'2020233030303037373832' TO DFHEIV0(25:11)
  8797     CALL 'kxdfhei1' USING DFHEIV0,
  8798           ERPNDB-FILE-ID,
  8799           ERPNDB-KEY,
  8800           DFHEIV99,
  8801           DFHEIV11,
  8802           DFHEIV99
  8803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8804
  8805
  8806 6020-READ-NEXT-RECORD.
  8807
  8808* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 172
* EL630.cbl
  8809*        INTO   (PENDING-BUSINESS)
  8810*        DATASET(ERPNDB-FILE-ID)
  8811*        RIDFLD (ERPNDB-KEY)
  8812*    END-EXEC.
  8813     MOVE LENGTH OF
  8814      PENDING-BUSINESS
  8815       TO DFHEIV12
  8816     MOVE 0
  8817       TO DFHEIV11
  8818*    MOVE '&.IL                  )   #00007788' TO DFHEIV0
  8819     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8820     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8821     MOVE X'2020233030303037373838' TO DFHEIV0(25:11)
  8822     CALL 'kxdfhei1' USING DFHEIV0,
  8823           ERPNDB-FILE-ID,
  8824           PENDING-BUSINESS,
  8825           DFHEIV12,
  8826           ERPNDB-KEY,
  8827           DFHEIV99,
  8828           DFHEIV11,
  8829           DFHEIV99,
  8830           DFHEIV99
  8831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8832
  8833
  8834     IF WS-ON1-SW6 IS EQUAL TO 'Y'
  8835         MOVE 'N'                    TO WS-ON1-SW6
  8836         MOVE PB-CONTROL-PRIMARY     TO WS-SAV-PNDB-KEY
  8837         GO TO 6030-READ-FOR-UPDATE.
  8838
  8839     IF ERPNDB-KEY = WS-SAV-PNDB-KEY
  8840         GO TO 6020-READ-NEXT-RECORD.
  8841
  8842     IF PB-COMPANY-CD  = WS-SAV-COMP-CD  AND
  8843        PB-ENTRY-BATCH = WS-SAV-ENTRY-BATCH
  8844         NEXT SENTENCE
  8845     ELSE
  8846         GO TO 6400-STOP-BROWSE.
  8847
  8848 6030-READ-FOR-UPDATE.
  8849
  8850* EXEC CICS ENDBR
  8851*        DATASET(ERPNDB-FILE-ID)
  8852*    END-EXEC.
  8853     MOVE 0
  8854       TO DFHEIV11
  8855*    MOVE '&2                    $   #00007809' TO DFHEIV0
  8856     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8857     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8858     MOVE X'2020233030303037383039' TO DFHEIV0(25:11)
  8859     CALL 'kxdfhei1' USING DFHEIV0,
  8860           ERPNDB-FILE-ID,
  8861           DFHEIV11,
  8862           DFHEIV99
  8863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8864
  8865
  8866
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 173
* EL630.cbl
  8867* EXEC CICS READ
  8868*        INTO (PENDING-BUSINESS)
  8869*        DATASET (ERPNDB-FILE-ID)
  8870*        RIDFLD  (ERPNDB-KEY)
  8871*        UPDATE
  8872*    END-EXEC.
  8873     MOVE LENGTH OF
  8874      PENDING-BUSINESS
  8875       TO DFHEIV11
  8876*    MOVE '&"IL       EU         (   #00007813' TO DFHEIV0
  8877     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8878     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8879     MOVE X'2020233030303037383133' TO DFHEIV0(25:11)
  8880     CALL 'kxdfhei1' USING DFHEIV0,
  8881           ERPNDB-FILE-ID,
  8882           PENDING-BUSINESS,
  8883           DFHEIV11,
  8884           ERPNDB-KEY,
  8885           DFHEIV99,
  8886           DFHEIV99,
  8887           DFHEIV99
  8888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8889
  8890
  8891     MOVE ERPNDB-KEY                  TO WS-SAV-PNDB-KEY.
  8892
  8893     MOVE PENDING-BUSINESS       TO WS-ERPNDB-RECORD.
  8894
  8895 6050-DELETE-PENDING-BUS.
  8896
  8897* EXEC CICS DELETE
  8898*        DATASET    (ERPNDB-FILE-ID)
  8899*    END-EXEC.
  8900*    MOVE '&(                    &   #00007825' TO DFHEIV0
  8901     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8902     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8903     MOVE X'2020233030303037383235' TO DFHEIV0(25:11)
  8904     CALL 'kxdfhei1' USING DFHEIV0,
  8905           ERPNDB-FILE-ID,
  8906           DFHEIV99,
  8907           DFHEIV99,
  8908           DFHEIV99,
  8909           DFHEIV99
  8910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8911
  8912
  8913     MOVE WS-ERPNDB-RECORD       TO PENDING-BUSINESS.
  8914
  8915     IF  PB-BATCH-TRAILER
  8916         GO TO 6300-WRITE-PNDB-RECORD.
  8917
  8918     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
  8919     IF  PB-SV-CARRIER GREATER SPACES
  8920         MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8921     IF  PB-SV-GROUPING GREATER SPACES
  8922         MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8923     IF  PB-SV-STATE GREATER SPACES
  8924         MOVE PB-SV-STATE            TO CERT-STATE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 174
* EL630.cbl
  8925
  8926     IF PB-ISSUE
  8927         NEXT SENTENCE
  8928       ELSE
  8929         GO TO 6200-PROCESS-CANCELS.
  8930
  8931
  8932* EXEC CICS HANDLE CONDITION
  8933*         NOTFND  (6300-WRITE-PNDB-RECORD)
  8934*    END-EXEC.
  8935*    MOVE '"$I                   ! 9 #00007847' TO DFHEIV0
  8936     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8938     MOVE X'3920233030303037383437' TO DFHEIV0(25:11)
  8939     CALL 'kxdfhei1' USING DFHEIV0
  8940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8941
  8942
  8943
  8944* EXEC CICS READ
  8945*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  8946*        DATASET (ELCERT-FILE-ID)
  8947*        RIDFLD  (ELCERT-KEY)
  8948*        UPDATE
  8949*    END-EXEC.
  8950*    MOVE '&"S        EU         (   #00007851' TO DFHEIV0
  8951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8952     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8953     MOVE X'2020233030303037383531' TO DFHEIV0(25:11)
  8954     CALL 'kxdfhei1' USING DFHEIV0,
  8955           ELCERT-FILE-ID,
  8956           DFHEIV20,
  8957           DFHEIV99,
  8958           ELCERT-KEY,
  8959           DFHEIV99,
  8960           DFHEIV99,
  8961           DFHEIV99
  8962     SET ADDRESS OF CERTIFICATE-MASTER TO
  8963         DFHEIV20
  8964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8965
  8966
  8967     IF INSURED-ADDR-PRESENT
  8968        MOVE 'Y'                  TO WS-CERT-ADDRESS-SW
  8969     ELSE
  8970        MOVE ' '                  TO WS-CERT-ADDRESS-SW.
  8971
  8972     IF  CERT-NOTES-ARE-NOT-PRESENT
  8973         MOVE ' '                TO WS-CERT-NOTE-SW
  8974     ELSE
  8975         MOVE 'Y'                TO WS-CERT-NOTE-SW.
  8976
  8977     IF  CERT-ADDED-BATCH
  8978
  8979* EXEC CICS UNLOCK
  8980*             DATASET (ELCERT-FILE-ID)
  8981*        END-EXEC
  8982*    MOVE '&*                    #   #00007869' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 175
* EL630.cbl
  8983     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8984     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8985     MOVE X'2020233030303037383639' TO DFHEIV0(25:11)
  8986     CALL 'kxdfhei1' USING DFHEIV0,
  8987           ELCERT-FILE-ID,
  8988           DFHEIV99
  8989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8990         GO TO 6300-WRITE-PNDB-RECORD.
  8991
  8992     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
  8993         NEXT SENTENCE
  8994        ELSE
  8995         GO TO 6060-DELETE-CERTIFICATE.
  8996
  8997     MOVE SPACE                 TO  CM-CREDIT-INTERFACE-SW-1.
  8998     MOVE '2'                   TO  CM-CLAIM-INTERFACE-SW.
  8999
  9000
  9001* EXEC CICS REWRITE
  9002*         DATASET    (ELCERT-FILE-ID)
  9003*         FROM       (CERTIFICATE-MASTER)
  9004*    END-EXEC.
  9005     MOVE LENGTH OF
  9006      CERTIFICATE-MASTER
  9007       TO DFHEIV11
  9008*    MOVE '&& L                  %   #00007882' TO DFHEIV0
  9009     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9010     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9011     MOVE X'2020233030303037383832' TO DFHEIV0(25:11)
  9012     CALL 'kxdfhei1' USING DFHEIV0,
  9013           ELCERT-FILE-ID,
  9014           CERTIFICATE-MASTER,
  9015           DFHEIV11,
  9016           DFHEIV99
  9017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9018
  9019
  9020     GO TO 6300-WRITE-PNDB-RECORD.
  9021
  9022 6060-DELETE-CERTIFICATE.
  9023
  9024
  9025* EXEC CICS DELETE
  9026*         DATASET    (ELCERT-FILE-ID)
  9027*    END-EXEC.
  9028*    MOVE '&(                    &   #00007891' TO DFHEIV0
  9029     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9030     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9031     MOVE X'2020233030303037383931' TO DFHEIV0(25:11)
  9032     CALL 'kxdfhei1' USING DFHEIV0,
  9033           ELCERT-FILE-ID,
  9034           DFHEIV99,
  9035           DFHEIV99,
  9036           DFHEIV99,
  9037           DFHEIV99
  9038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9039
  9040
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 176
* EL630.cbl
  9041******************************************************************
  9042*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
  9043******************************************************************
  9044
  9045     IF CERT-NOTES-ARE-PRESENT
  9046        NEXT SENTENCE
  9047     ELSE
  9048        GO TO 6070-DELETE-MAILING.
  9049
  9050
  9051* EXEC CICS HANDLE CONDITION
  9052*         NOTFND  (6070-DELETE-MAILING)
  9053*    END-EXEC.
  9054*    MOVE '"$I                   ! : #00007904' TO DFHEIV0
  9055     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9057     MOVE X'3A20233030303037393034' TO DFHEIV0(25:11)
  9058     CALL 'kxdfhei1' USING DFHEIV0
  9059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9060
  9061
  9062
  9063* EXEC CICS READ
  9064*        EQUAL
  9065*        DATASET   (ERNOTE-FILE-ID)
  9066*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  9067*        RIDFLD    (ELCERT-KEY)
  9068*        UPDATE
  9069*    END-EXEC.
  9070*    MOVE '&"S        EU         (   #00007908' TO DFHEIV0
  9071     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9072     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9073     MOVE X'2020233030303037393038' TO DFHEIV0(25:11)
  9074     CALL 'kxdfhei1' USING DFHEIV0,
  9075           ERNOTE-FILE-ID,
  9076           DFHEIV20,
  9077           DFHEIV99,
  9078           ELCERT-KEY,
  9079           DFHEIV99,
  9080           DFHEIV99,
  9081           DFHEIV99
  9082     SET ADDRESS OF CERTIFICATE-NOTE TO
  9083         DFHEIV20
  9084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9085
  9086
  9087
  9088* EXEC CICS DELETE
  9089*        DATASET   (ERNOTE-FILE-ID)
  9090*    END-EXEC.
  9091*    MOVE '&(                    &   #00007916' TO DFHEIV0
  9092     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9093     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9094     MOVE X'2020233030303037393136' TO DFHEIV0(25:11)
  9095     CALL 'kxdfhei1' USING DFHEIV0,
  9096           ERNOTE-FILE-ID,
  9097           DFHEIV99,
  9098           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 177
* EL630.cbl
  9099           DFHEIV99,
  9100           DFHEIV99
  9101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9102
  9103
  9104******************************************************************
  9105*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
  9106******************************************************************
  9107
  9108 6070-DELETE-MAILING.
  9109     IF CERT-ADDRESS-PRESENT
  9110        NEXT SENTENCE
  9111     ELSE
  9112        GO TO 6300-WRITE-PNDB-RECORD.
  9113
  9114
  9115* EXEC CICS HANDLE CONDITION
  9116*         NOTOPEN (6300-WRITE-PNDB-RECORD)
  9117*         NOTFND  (6300-WRITE-PNDB-RECORD)
  9118*    END-EXEC.
  9119*    MOVE '"$JI                  ! ; #00007930' TO DFHEIV0
  9120     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9121     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9122     MOVE X'3B20233030303037393330' TO DFHEIV0(25:11)
  9123     CALL 'kxdfhei1' USING DFHEIV0
  9124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9125
  9126
  9127
  9128* EXEC CICS READ
  9129*        EQUAL
  9130*        DATASET   (ERMAIL-FILE-ID)
  9131*        SET       (ADDRESS OF MAILING-DATA)
  9132*        RIDFLD    (ELCERT-KEY)
  9133*        UPDATE
  9134*    END-EXEC.
  9135*    MOVE '&"S        EU         (   #00007935' TO DFHEIV0
  9136     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9137     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9138     MOVE X'2020233030303037393335' TO DFHEIV0(25:11)
  9139     CALL 'kxdfhei1' USING DFHEIV0,
  9140           ERMAIL-FILE-ID,
  9141           DFHEIV20,
  9142           DFHEIV99,
  9143           ELCERT-KEY,
  9144           DFHEIV99,
  9145           DFHEIV99,
  9146           DFHEIV99
  9147     SET ADDRESS OF MAILING-DATA TO
  9148         DFHEIV20
  9149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9150
  9151
  9152
  9153* EXEC CICS DELETE
  9154*        DATASET   (ERMAIL-FILE-ID)
  9155*    END-EXEC.
  9156*    MOVE '&(                    &   #00007943' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 178
* EL630.cbl
  9157     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9158     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9159     MOVE X'2020233030303037393433' TO DFHEIV0(25:11)
  9160     CALL 'kxdfhei1' USING DFHEIV0,
  9161           ERMAIL-FILE-ID,
  9162           DFHEIV99,
  9163           DFHEIV99,
  9164           DFHEIV99,
  9165           DFHEIV99
  9166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9167
  9168
  9169     GO TO 6300-WRITE-PNDB-RECORD.
  9170
  9171 6200-PROCESS-CANCELS.
  9172
  9173* EXEC CICS HANDLE CONDITION
  9174*         NOTFND  (6300-WRITE-PNDB-RECORD)
  9175*    END-EXEC.
  9176*    MOVE '"$I                   ! < #00007950' TO DFHEIV0
  9177     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9178     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9179     MOVE X'3C20233030303037393530' TO DFHEIV0(25:11)
  9180     CALL 'kxdfhei1' USING DFHEIV0
  9181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9182
  9183
  9184
  9185* EXEC CICS READ
  9186*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  9187*        DATASET (ELCERT-FILE-ID)
  9188*        RIDFLD  (ELCERT-KEY)
  9189*        UPDATE
  9190*    END-EXEC.
  9191*    MOVE '&"S        EU         (   #00007954' TO DFHEIV0
  9192     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9193     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9194     MOVE X'2020233030303037393534' TO DFHEIV0(25:11)
  9195     CALL 'kxdfhei1' USING DFHEIV0,
  9196           ELCERT-FILE-ID,
  9197           DFHEIV20,
  9198           DFHEIV99,
  9199           ELCERT-KEY,
  9200           DFHEIV99,
  9201           DFHEIV99,
  9202           DFHEIV99
  9203     SET ADDRESS OF CERTIFICATE-MASTER TO
  9204         DFHEIV20
  9205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9206
  9207
  9208     IF PB-CANCELLATION
  9209        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  9210           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9211           MOVE ZERO                   TO CM-LF-ITD-CANCEL-AMT
  9212           MOVE LOW-VALUES             TO CM-LF-CANCEL-EXIT-DT
  9213                                          CM-LF-CANCEL-DT
  9214        ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 179
* EL630.cbl
  9215           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9216           MOVE PB-CI-LF-CANCEL-AMT    TO CM-LF-ITD-CANCEL-AMT
  9217           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
  9218           MOVE PB-CI-LIVES            TO CM-LIVES.
  9219
  9220     IF PB-CANCELLATION
  9221        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  9222           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL SPACE
  9223               MOVE CM-LF-STATUS-AT-CANCEL
  9224                                        TO CM-LF-CURRENT-STATUS
  9225               MOVE SPACE
  9226                                        TO CM-LF-STATUS-AT-CANCEL
  9227            ELSE
  9228               MOVE PB-CI-LF-POLICY-STATUS
  9229                                        TO CM-LF-CURRENT-STATUS
  9230        ELSE
  9231            MOVE PB-CI-LF-POLICY-STATUS TO CM-LF-CURRENT-STATUS.
  9232
  9233     IF PB-CANCELLATION
  9234        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  9235           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9236           MOVE ZERO                   TO CM-AH-ITD-CANCEL-AMT
  9237           MOVE LOW-VALUES             TO CM-AH-CANCEL-EXIT-DT
  9238                                          CM-AH-CANCEL-DT
  9239        ELSE
  9240           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9241           MOVE PB-CI-AH-CANCEL-AMT    TO CM-AH-ITD-CANCEL-AMT
  9242           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
  9243           MOVE PB-CI-LIVES            TO CM-LIVES.
  9244
  9245     IF PB-CANCELLATION
  9246        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  9247           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL SPACE
  9248               MOVE CM-AH-STATUS-AT-CANCEL
  9249                                        TO CM-AH-CURRENT-STATUS
  9250               MOVE SPACE
  9251                                        TO CM-AH-STATUS-AT-CANCEL
  9252            ELSE
  9253               MOVE PB-CI-AH-POLICY-STATUS
  9254                                        TO CM-AH-CURRENT-STATUS
  9255        ELSE
  9256            MOVE PB-CI-AH-POLICY-STATUS TO CM-AH-CURRENT-STATUS.
  9257
  9258 6255-REWRITE-CERT.
  9259
  9260
  9261* EXEC CICS REWRITE
  9262*        DATASET    (ELCERT-FILE-ID)
  9263*        FROM       (CERTIFICATE-MASTER)
  9264*    END-EXEC.
  9265     MOVE LENGTH OF
  9266      CERTIFICATE-MASTER
  9267       TO DFHEIV11
  9268*    MOVE '&& L                  %   #00008013' TO DFHEIV0
  9269     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9270     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9271     MOVE X'2020233030303038303133' TO DFHEIV0(25:11)
  9272     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 180
* EL630.cbl
  9273           ELCERT-FILE-ID,
  9274           CERTIFICATE-MASTER,
  9275           DFHEIV11,
  9276           DFHEIV99
  9277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9278
  9279
  9280 6300-WRITE-PNDB-RECORD.
  9281
  9282     MOVE 'X'                    TO  PB-FATAL-FLAG.
  9283
  9284     MOVE SPACES                 TO  PB-I-RATE-DEVIATION-LF
  9285                                     PB-I-RATE-DEVIATION-AH
  9286                                     PB-REIN-CD
  9287                                     PB-SV-CARRIER
  9288                                     PB-SV-GROUPING
  9289                                     PB-SV-STATE.
  9290
  9291     IF PB-BATCH-TRAILER
  9292         MOVE PI-AM-NAME         TO  PB-ACCOUNT-NAME
  9293         MOVE PI-SAV-FC-CARRIER  TO  PB-SV-CARRIER
  9294         MOVE PI-SAV-FC-GROUPING TO  PB-SV-GROUPING
  9295         MOVE PI-SAV-FC-STATE    TO  PB-SV-STATE.
  9296
  9297     MOVE LOW-VALUES             TO  PB-ACCT-EFF-DT
  9298                                     PB-ACCT-EXP-DT.
  9299
  9300     MOVE ZEROS                  TO  PB-CALC-TOLERANCE.
  9301
  9302     IF  CARRIERL GREATER ZEROS
  9303         MOVE CARRIERI           TO PB-CARRIER
  9304        ELSE
  9305         MOVE SPACES             TO PB-CARRIER.
  9306
  9307     IF  GROUPL   GREATER ZEROS
  9308         MOVE GROUPI             TO PB-GROUPING
  9309        ELSE
  9310         MOVE SPACES             TO PB-GROUPING.
  9311
  9312     IF  STATEL   GREATER ZEROS
  9313         MOVE STATEI             TO PB-STATE
  9314        ELSE
  9315         MOVE SPACES             TO PB-STATE.
  9316
  9317     IF  ACCOUNTL GREATER ZEROS
  9318         MOVE ACCOUNTI           TO PB-ACCOUNT
  9319        ELSE
  9320         MOVE SPACES             TO PB-ACCOUNT.
  9321
  9322     IF WS-ON1-SW7 IS EQUAL TO 'Y'
  9323         MOVE 'N'                TO WS-ON1-SW7
  9324         MOVE PB-GROUPING        TO PI-SAV-GROUPING
  9325         MOVE PB-STATE           TO PI-SAV-STATE
  9326         MOVE PB-ACCOUNT         TO PI-SAV-ACCOUNT.
  9327
  9328
  9329* EXEC CICS WRITE
  9330*        DATASET(ERPNDB-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 181
* EL630.cbl
  9331*        FROM   (PENDING-BUSINESS)
  9332*        RIDFLD (PB-CONTROL-PRIMARY)
  9333*    END-EXEC.
  9334     MOVE LENGTH OF
  9335      PENDING-BUSINESS
  9336       TO DFHEIV11
  9337*    MOVE '&$ L                  ''   #00008066' TO DFHEIV0
  9338     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9339     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9340     MOVE X'2020233030303038303636' TO DFHEIV0(25:11)
  9341     CALL 'kxdfhei1' USING DFHEIV0,
  9342           ERPNDB-FILE-ID,
  9343           PENDING-BUSINESS,
  9344           DFHEIV11,
  9345           PB-CONTROL-PRIMARY,
  9346           DFHEIV99,
  9347           DFHEIV99
  9348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9349
  9350
  9351     GO TO 6010-GET-NEXT-RECORD.
  9352
  9353 6400-STOP-BROWSE.
  9354
  9355* EXEC CICS ENDBR
  9356*        DATASET(ERPNDB-FILE-ID)
  9357*    END-EXEC.
  9358     MOVE 0
  9359       TO DFHEIV11
  9360*    MOVE '&2                    $   #00008075' TO DFHEIV0
  9361     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9362     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9363     MOVE X'2020233030303038303735' TO DFHEIV0(25:11)
  9364     CALL 'kxdfhei1' USING DFHEIV0,
  9365           ERPNDB-FILE-ID,
  9366           DFHEIV11,
  9367           DFHEIV99
  9368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9369
  9370
  9371     MOVE 'Y'                    TO  PI-UPDATE-SW.
  9372
  9373     IF PI-AR-PROCESSING
  9374        PERFORM 6600-REWRITE-REQUEST THRU 6690-EXIT.
  9375
  9376     MOVE ER-2990                TO EMI-ERROR.
  9377     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9378     MOVE -1                     TO MAINTL.
  9379     MOVE AL-SANON               TO MAINTA.
  9380     MOVE PI-SAV-REFERENCE       TO REFO.
  9381     GO TO 8200-SEND-DATAONLY.
  9382
  9383 6500-NO-RECORDS.
  9384     MOVE ER-2242                TO EMI-ERROR.
  9385     MOVE -1                     TO BATCHL.
  9386     MOVE AL-UABON               TO BATCHA.
  9387     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9388     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 182
* EL630.cbl
  9389
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 183
* EL630.cbl
  9391
  9392******************************************************************
  9393*                                                                *
  9394*          R E W R I T E   R E Q U E S T   R E C O R D           *
  9395*                                                                *
  9396******************************************************************
  9397
  9398 6600-REWRITE-REQUEST.
  9399
  9400
  9401* EXEC CICS HANDLE CONDITION
  9402*        NOTFND (6690-EXIT)
  9403*    END-EXEC.
  9404*    MOVE '"$I                   ! = #00008108' TO DFHEIV0
  9405     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9407     MOVE X'3D20233030303038313038' TO DFHEIV0(25:11)
  9408     CALL 'kxdfhei1' USING DFHEIV0
  9409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9410
  9411
  9412     MOVE PI-COMPANY-CD          TO  ERRQST-COMP-CD.
  9413     MOVE PI-SAV-ENTRY-BATCH     TO  ERRQST-ENTRY-BATCH.
  9414
  9415
  9416* EXEC CICS READ
  9417*         DATASET    (ERRQST-FILE-ID)
  9418*         SET        (ADDRESS OF AR-REQUEST-RECORD)
  9419*         RIDFLD     (ERRQST-KEY)
  9420*         UPDATE
  9421*    END-EXEC.
  9422*    MOVE '&"S        EU         (   #00008115' TO DFHEIV0
  9423     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9424     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9425     MOVE X'2020233030303038313135' TO DFHEIV0(25:11)
  9426     CALL 'kxdfhei1' USING DFHEIV0,
  9427           ERRQST-FILE-ID,
  9428           DFHEIV20,
  9429           DFHEIV99,
  9430           ERRQST-KEY,
  9431           DFHEIV99,
  9432           DFHEIV99,
  9433           DFHEIV99
  9434     SET ADDRESS OF AR-REQUEST-RECORD TO
  9435         DFHEIV20
  9436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9437
  9438
  9439     IF  CARRIERL GREATER ZEROS
  9440         MOVE CARRIERI           TO RQ-CARRIER-A1
  9441                                    RQ-CARRIER-A2
  9442                                    RQ-CARRIER-A2.
  9443
  9444     IF  GROUPL   GREATER ZEROS
  9445         MOVE GROUPI             TO RQ-GROUPING-A1
  9446                                    RQ-GROUPING-A2
  9447                                    RQ-GROUPING-A3.
  9448
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 184
* EL630.cbl
  9449     IF  STATEL   GREATER ZEROS
  9450         MOVE STATEI             TO RQ-STATE-A1.
  9451
  9452     IF  ACCOUNTL GREATER ZEROS
  9453         MOVE ACCOUNTI           TO RQ-ACCOUNT-A1
  9454                                    RQ-ACCOUNT-A4.
  9455
  9456     IF PI-ZERO-CARRIER
  9457        MOVE ZERO                TO RQ-CARRIER-A2.
  9458
  9459     IF PI-ZERO-GROUPING
  9460        MOVE ZEROS               TO RQ-GROUPING-A2.
  9461
  9462     IF PI-ZERO-CAR-GROUP
  9463        MOVE ZEROS               TO RQ-CARRIER-A2
  9464                                    RQ-GROUPING-A2.
  9465
  9466     MOVE PI-REMIT-AGENT (PI-SUB) TO RQ-FIN-RESP-A2
  9467                                     PI-FIN-RESP.
  9468
  9469     MOVE PI-ACCT-AGENT  (PI-SUB) TO RQ-ACCT-AGENT-A2
  9470                                     PI-ACCOUNT-AGENT.
  9471
  9472
  9473* EXEC CICS REWRITE
  9474*         DATASET    (ERRQST-FILE-ID)
  9475*         FROM       (AR-REQUEST-RECORD)
  9476*    END-EXEC.
  9477     MOVE LENGTH OF
  9478      AR-REQUEST-RECORD
  9479       TO DFHEIV11
  9480*    MOVE '&& L                  %   #00008155' TO DFHEIV0
  9481     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9482     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9483     MOVE X'2020233030303038313535' TO DFHEIV0(25:11)
  9484     CALL 'kxdfhei1' USING DFHEIV0,
  9485           ERRQST-FILE-ID,
  9486           AR-REQUEST-RECORD,
  9487           DFHEIV11,
  9488           DFHEIV99
  9489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9490
  9491
  9492 6690-EXIT.
  9493     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 185
* EL630.cbl
  9495
  9496******************************************************************
  9497*                                                                *
  9498*           V E R I F Y   R E Q U E S T   R E C O R D            *
  9499*                                                                *
  9500******************************************************************
  9501
  9502 7000-VERIFY-REQUEST-REC.
  9503
  9504* EXEC CICS HANDLE CONDITION
  9505*        NOTFND(7090-EXIT)
  9506*    END-EXEC.
  9507*    MOVE '"$I                   ! > #00008171' TO DFHEIV0
  9508     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9510     MOVE X'3E20233030303038313731' TO DFHEIV0(25:11)
  9511     CALL 'kxdfhei1' USING DFHEIV0
  9512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9513
  9514
  9515     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9516     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9517
  9518
  9519* EXEC CICS READ
  9520*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9521*        DATASET(ERRQST-FILE-ID)
  9522*        RIDFLD (ERRQST-KEY)
  9523*    END-EXEC.
  9524*    MOVE '&"S        E          (   #00008178' TO DFHEIV0
  9525     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9526     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9527     MOVE X'2020233030303038313738' TO DFHEIV0(25:11)
  9528     CALL 'kxdfhei1' USING DFHEIV0,
  9529           ERRQST-FILE-ID,
  9530           DFHEIV20,
  9531           DFHEIV99,
  9532           ERRQST-KEY,
  9533           DFHEIV99,
  9534           DFHEIV99,
  9535           DFHEIV99
  9536     SET ADDRESS OF AR-REQUEST-RECORD TO
  9537         DFHEIV20
  9538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9539
  9540
  9541     IF RQ-STMT-DT NOT = LOW-VALUES
  9542        MOVE ER-2126        TO EMI-ERROR
  9543        MOVE -1             TO BATCHL
  9544        MOVE AL-UABON       TO BATCHA
  9545        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  9546        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9547        GO TO 7090-EXIT.
  9548
  9549******************************************************************
  9550*                                                                *
  9551*   IF THE BATCH IS BEING DELETED (PF2), DELETE REQUEST RECORD.  *
  9552*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 186
* EL630.cbl
  9553******************************************************************
  9554
  9555     IF EIBAID = DFHPF2
  9556        NEXT SENTENCE
  9557     ELSE
  9558        GO TO 7090-EXIT.
  9559
  9560
  9561* EXEC CICS READ
  9562*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9563*        DATASET(ERRQST-FILE-ID)
  9564*        RIDFLD (ERRQST-KEY)
  9565*        UPDATE
  9566*    END-EXEC.
  9567*    MOVE '&"S        EU         (   #00008203' TO DFHEIV0
  9568     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9569     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9570     MOVE X'2020233030303038323033' TO DFHEIV0(25:11)
  9571     CALL 'kxdfhei1' USING DFHEIV0,
  9572           ERRQST-FILE-ID,
  9573           DFHEIV20,
  9574           DFHEIV99,
  9575           ERRQST-KEY,
  9576           DFHEIV99,
  9577           DFHEIV99,
  9578           DFHEIV99
  9579     SET ADDRESS OF AR-REQUEST-RECORD TO
  9580         DFHEIV20
  9581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9582
  9583
  9584
  9585* EXEC CICS DELETE
  9586*        DATASET(ERRQST-FILE-ID)
  9587*    END-EXEC.
  9588*    MOVE '&(                    &   #00008210' TO DFHEIV0
  9589     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9590     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9591     MOVE X'2020233030303038323130' TO DFHEIV0(25:11)
  9592     CALL 'kxdfhei1' USING DFHEIV0,
  9593           ERRQST-FILE-ID,
  9594           DFHEIV99,
  9595           DFHEIV99,
  9596           DFHEIV99,
  9597           DFHEIV99
  9598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9599
  9600
  9601 7090-EXIT.
  9602      EXIT.
  9603
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 187
* EL630.cbl
  9605
  9606 7100-REWRITE-REQUEST-REC.
  9607
  9608
  9609* EXEC CICS HANDLE CONDITION
  9610*        NOTFND(7180-NO-REQUEST-REC)
  9611*    END-EXEC.
  9612*    MOVE '"$I                   ! ? #00008221' TO DFHEIV0
  9613     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9615     MOVE X'3F20233030303038323231' TO DFHEIV0(25:11)
  9616     CALL 'kxdfhei1' USING DFHEIV0
  9617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9618
  9619
  9620
  9621     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9622     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9623
  9624
  9625* EXEC CICS READ
  9626*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9627*        DATASET(ERRQST-FILE-ID)
  9628*        RIDFLD (ERRQST-KEY)
  9629*        UPDATE
  9630*    END-EXEC.
  9631*    MOVE '&"S        EU         (   #00008229' TO DFHEIV0
  9632     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9633     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9634     MOVE X'2020233030303038323239' TO DFHEIV0(25:11)
  9635     CALL 'kxdfhei1' USING DFHEIV0,
  9636           ERRQST-FILE-ID,
  9637           DFHEIV20,
  9638           DFHEIV99,
  9639           ERRQST-KEY,
  9640           DFHEIV99,
  9641           DFHEIV99,
  9642           DFHEIV99
  9643     SET ADDRESS OF AR-REQUEST-RECORD TO
  9644         DFHEIV20
  9645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9646
  9647
  9648     IF RQ-STMT-DT NOT = LOW-VALUES
  9649        MOVE ER-2126        TO EMI-ERROR
  9650        MOVE -1             TO BATCHL
  9651        MOVE AL-UABON       TO BATCHA
  9652        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  9653        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9654        GO TO 7190-EXIT.
  9655
  9656     MOVE PI-SAV-REFERENCE  TO RQ-REFERENCE-A1
  9657                               RQ-REFERENCE-A2
  9658                               RQ-REFERENCE-A4.
  9659
  9660
  9661* EXEC CICS REWRITE
  9662*        DATASET(ERRQST-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 188
* EL630.cbl
  9663*        FROM   (AR-REQUEST-RECORD)
  9664*    END-EXEC.
  9665     MOVE LENGTH OF
  9666      AR-REQUEST-RECORD
  9667       TO DFHEIV11
  9668*    MOVE '&& L                  %   #00008248' TO DFHEIV0
  9669     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9670     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9671     MOVE X'2020233030303038323438' TO DFHEIV0(25:11)
  9672     CALL 'kxdfhei1' USING DFHEIV0,
  9673           ERRQST-FILE-ID,
  9674           AR-REQUEST-RECORD,
  9675           DFHEIV11,
  9676           DFHEIV99
  9677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9678
  9679
  9680     GO TO 7190-EXIT.
  9681
  9682 7180-NO-REQUEST-REC.
  9683     MOVE ER-2132        TO EMI-ERROR.
  9684     MOVE -1             TO BATCHL.
  9685     MOVE AL-UABON       TO BATCHA.
  9686     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9687     MOVE 'N'            TO WS-RECORD-FOUND-SW.
  9688     GO TO 7190-EXIT.
  9689
  9690 7190-EXIT.
  9691     EXIT.
  9692
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 189
* EL630.cbl
  9694
  9695******************************************************************
  9696*
  9697*     7200-REWRITE IS USED TO REWRITE THE REQUEST FILE WHEN
  9698*     THE EOM DATE IS CHANGED.
  9699*
  9700******************************************************************
  9701
  9702 7200-REWRITE-REQUEST.
  9703
  9704* EXEC CICS HANDLE CONDITION
  9705*        NOTFND(7280-NO-REQUEST-REC)
  9706*    END-EXEC.
  9707*    MOVE '"$I                   ! @ #00008276' TO DFHEIV0
  9708     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9709     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9710     MOVE X'4020233030303038323736' TO DFHEIV0(25:11)
  9711     CALL 'kxdfhei1' USING DFHEIV0
  9712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9713
  9714
  9715     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9716     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9717
  9718
  9719* EXEC CICS READ
  9720*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9721*        DATASET(ERRQST-FILE-ID)
  9722*        RIDFLD (ERRQST-KEY)
  9723*        UPDATE
  9724*    END-EXEC.
  9725*    MOVE '&"S        EU         (   #00008283' TO DFHEIV0
  9726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9727     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9728     MOVE X'2020233030303038323833' TO DFHEIV0(25:11)
  9729     CALL 'kxdfhei1' USING DFHEIV0,
  9730           ERRQST-FILE-ID,
  9731           DFHEIV20,
  9732           DFHEIV99,
  9733           ERRQST-KEY,
  9734           DFHEIV99,
  9735           DFHEIV99,
  9736           DFHEIV99
  9737     SET ADDRESS OF AR-REQUEST-RECORD TO
  9738         DFHEIV20
  9739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9740
  9741
  9742     IF RQ-STMT-DT NOT = LOW-VALUES
  9743        MOVE ER-2126        TO EMI-ERROR
  9744        MOVE -1             TO BATCHL
  9745        MOVE AL-UABON       TO BATCHA
  9746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9747        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9748        GO TO 7299-EXIT.
  9749
  9750
  9751     IF PI-NB-MONTH-END-DT NOT = RQ-MO-END-DT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 190
* EL630.cbl
  9752        MOVE PI-NB-MONTH-END-DT  TO  RQ-MO-END-DT.
  9753
  9754     IF PI-SAV-REFERENCE NOT = RQ-REFERENCE-A1
  9755        MOVE PI-SAV-REFERENCE    TO RQ-REFERENCE-A1
  9756                                    RQ-REFERENCE-A2
  9757                                    RQ-REFERENCE-A4.
  9758
  9759
  9760* EXEC CICS REWRITE
  9761*        DATASET(ERRQST-FILE-ID)
  9762*        FROM   (AR-REQUEST-RECORD)
  9763*    END-EXEC.
  9764     MOVE LENGTH OF
  9765      AR-REQUEST-RECORD
  9766       TO DFHEIV11
  9767*    MOVE '&& L                  %   #00008307' TO DFHEIV0
  9768     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9769     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9770     MOVE X'2020233030303038333037' TO DFHEIV0(25:11)
  9771     CALL 'kxdfhei1' USING DFHEIV0,
  9772           ERRQST-FILE-ID,
  9773           AR-REQUEST-RECORD,
  9774           DFHEIV11,
  9775           DFHEIV99
  9776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9777
  9778
  9779     GO TO 7299-EXIT.
  9780
  9781 7280-NO-REQUEST-REC.
  9782     MOVE ER-2132        TO EMI-ERROR.
  9783     MOVE -1             TO BATCHL.
  9784     MOVE AL-UABON       TO BATCHA.
  9785     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9786     MOVE 'N'            TO WS-RECORD-FOUND-SW.
  9787
  9788 7299-EXIT.
  9789     EXIT.
  9790
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 191
* EL630.cbl
  9792
  9793 8100-SEND-INITIAL-MAP.
  9794     MOVE WS-CURRENT-DT          TO DATEO.
  9795     MOVE EIBTIME                TO TIME-IN.
  9796     MOVE TIME-OUT               TO TIMEO.
  9797     MOVE -1                     TO MAINTL.
  9798     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  9799     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  9800
  9801     MOVE PI-LIFE-OVERRIDE-L2    TO WS-PRM-OVERRIDE
  9802                                    WS-REFUND-OVERRIDE.
  9803     MOVE WS-PRM-HEADER          TO LFPHDGO.
  9804     MOVE WS-REFUND-HEADER       TO LFRHDGO.
  9805
  9806     MOVE PI-AH-OVERRIDE-L2      TO WS-PRM-OVERRIDE
  9807                                    WS-REFUND-OVERRIDE.
  9808     MOVE WS-PRM-HEADER          TO AHPHDGO.
  9809     MOVE WS-REFUND-HEADER       TO AHRHDGO.
  9810
  9811     IF NOT PI-AR-PROCESSING
  9812        MOVE AL-SADOF            TO REFHDGA
  9813                                    REFA.
  9814
  9815     MOVE AL-SANOF               TO PF5A.
  9816
  9817     IF CARR-GROUP-ST-ACCNT-CNTL
  9818         NEXT SENTENCE
  9819     ELSE
  9820         IF ST-ACCNT-CNTL
  9821             MOVE AL-SADOF       TO CARRHDGA
  9822                                    GRPHDGA
  9823             MOVE AL-SANOF       TO CARRIERA
  9824                                    GROUPA
  9825         ELSE
  9826             IF CARR-ST-ACCNT-CNTL
  9827                 MOVE AL-SADOF   TO GRPHDGA
  9828                 MOVE AL-SANOF   TO GROUPA
  9829             ELSE
  9830                 IF ACCNT-CNTL
  9831                     MOVE AL-SADOF TO CARRHDGA
  9832                                      GRPHDGA
  9833                                      STHDGA
  9834                     MOVE AL-SANOF TO CARRIERA
  9835                                      GROUPA
  9836                                      STATEA
  9837                 ELSE
  9838                     IF CARR-ACCNT-CNTL
  9839                         MOVE AL-SADOF TO GRPHDGA
  9840                                          STHDGA
  9841                         MOVE AL-SANOF TO GROUPA
  9842                                          STATEA.
  9843
  9844* EXEC CICS SEND
  9845*        MAP      (MAP-NAME)
  9846*        MAPSET   (MAPSET-NAME)
  9847*        FROM     (EL630AO)
  9848*        ERASE
  9849*        CURSOR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 192
* EL630.cbl
  9850*    END-EXEC.
  9851     MOVE LENGTH OF
  9852      EL630AO
  9853       TO DFHEIV12
  9854     MOVE -1
  9855       TO DFHEIV11
  9856*    MOVE '8$     CT  E    H L F ,   #00008376' TO DFHEIV0
  9857     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9858     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9859     MOVE X'2020233030303038333736' TO DFHEIV0(25:11)
  9860     CALL 'kxdfhei1' USING DFHEIV0,
  9861           MAP-NAME,
  9862           EL630AO,
  9863           DFHEIV12,
  9864           MAPSET-NAME,
  9865           DFHEIV99,
  9866           DFHEIV99,
  9867           DFHEIV99,
  9868           DFHEIV11,
  9869           DFHEIV99,
  9870           DFHEIV99,
  9871           DFHEIV99
  9872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9873
  9874
  9875     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 193
* EL630.cbl
  9877
  9878 8200-SEND-DATAONLY.
  9879     MOVE WS-CURRENT-DT          TO DATEO.
  9880     MOVE EIBTIME                TO TIME-IN.
  9881     MOVE TIME-OUT               TO TIMEO.
  9882     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  9883     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  9884
  9885* EXEC CICS SEND
  9886*        MAP      (MAP-NAME)
  9887*        MAPSET   (MAPSET-NAME)
  9888*        FROM     (EL630AO)
  9889*        DATAONLY
  9890*        ERASEAUP
  9891*        CURSOR
  9892*    END-EXEC.
  9893     MOVE LENGTH OF
  9894      EL630AO
  9895       TO DFHEIV12
  9896     MOVE -1
  9897       TO DFHEIV11
  9898*    MOVE '8$D    CT  A    H L F ,   #00008393' TO DFHEIV0
  9899     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9900     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9901     MOVE X'2020233030303038333933' TO DFHEIV0(25:11)
  9902     CALL 'kxdfhei1' USING DFHEIV0,
  9903           MAP-NAME,
  9904           EL630AO,
  9905           DFHEIV12,
  9906           MAPSET-NAME,
  9907           DFHEIV99,
  9908           DFHEIV99,
  9909           DFHEIV99,
  9910           DFHEIV11,
  9911           DFHEIV99,
  9912           DFHEIV99,
  9913           DFHEIV99
  9914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9915
  9916
  9917     GO TO 9100-RETURN-TRAN.
  9918
  9919 8300-SEND-TEXT.
  9920
  9921* EXEC CICS SEND TEXT
  9922*        FROM     (LOGOFF-TEXT)
  9923*        LENGTH   (LOGOFF-LENGTH)
  9924*        ERASE
  9925*        FREEKB
  9926*    END-EXEC.
  9927*    MOVE '8&      T  E F  H   F -   #00008405' TO DFHEIV0
  9928     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9929     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9930     MOVE X'2020233030303038343035' TO DFHEIV0(25:11)
  9931     CALL 'kxdfhei1' USING DFHEIV0,
  9932           LOGOFF-TEXT,
  9933           LOGOFF-LENGTH,
  9934           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 194
* EL630.cbl
  9935           DFHEIV99,
  9936           DFHEIV99,
  9937           DFHEIV99,
  9938           DFHEIV99,
  9939           DFHEIV99,
  9940           DFHEIV99,
  9941           DFHEIV99,
  9942           DFHEIV99,
  9943           DFHEIV99
  9944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9945
  9946
  9947
  9948* EXEC CICS RETURN
  9949*    END-EXEC.
  9950*    MOVE '.(                    ''   #00008412' TO DFHEIV0
  9951     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9952     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9953     MOVE X'2020233030303038343132' TO DFHEIV0(25:11)
  9954     CALL 'kxdfhei1' USING DFHEIV0,
  9955           DFHEIV99,
  9956           DFHEIV99,
  9957           DFHEIV99,
  9958           DFHEIV99,
  9959           DFHEIV99,
  9960           DFHEIV99
  9961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9962
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 195
* EL630.cbl
  9964 8600-DEEDIT.
  9965
  9966* EXEC CICS BIF DEEDIT
  9967*        FIELD (WS-DEEDIT-FIELD)
  9968*        LENGTH(10)
  9969*     END-EXEC.
  9970     MOVE 10
  9971       TO DFHEIV11
  9972*    MOVE '@"L                   #   #00008416' TO DFHEIV0
  9973     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9974     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9975     MOVE X'2020233030303038343136' TO DFHEIV0(25:11)
  9976     CALL 'kxdfhei1' USING DFHEIV0,
  9977           WS-DEEDIT-FIELD,
  9978           DFHEIV11
  9979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9980
  9981
  9982 8600-EXIT.
  9983     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 196
* EL630.cbl
  9985 8800-UNAUTHORIZED-ACCESS.
  9986     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  9987     GO TO 8300-SEND-TEXT.
  9988
  9989 8810-PF23.
  9990     IF NOT PI-DATA-UPDATED
  9991         NEXT SENTENCE
  9992     ELSE
  9993         MOVE -1                 TO PFENTERL
  9994         MOVE ER-2213            TO EMI-ERROR
  9995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9996         GO TO 4000-SHOW-TOTALS.
  9997
  9998     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  9999     MOVE XCTL-005               TO PGM-NAME.
 10000     GO TO 9300-XCTL.
 10001
 10002 9100-RETURN-TRAN.
 10003     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10004     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10005
 10006* EXEC CICS RETURN
 10007*        TRANSID    (TRANS-ID)
 10008*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10009*        LENGTH     (WS-COMM-LENGTH)
 10010*    END-EXEC.
 10011*    MOVE '.(CT                  ''   #00008444' TO DFHEIV0
 10012     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10013     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10014     MOVE X'2020233030303038343434' TO DFHEIV0(25:11)
 10015     CALL 'kxdfhei1' USING DFHEIV0,
 10016           TRANS-ID,
 10017           PROGRAM-INTERFACE-BLOCK,
 10018           WS-COMM-LENGTH,
 10019           DFHEIV99,
 10020           DFHEIV99,
 10021           DFHEIV99
 10022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10023
 10024
 10025     MOVE ZEROS  TO RETURN-CODE.
 10026
 10027* GOBACK.
 10028     MOVE '9%                    "   ' TO DFHEIV0
 10029     MOVE 'EL630' TO DFHEIV1
 10030     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10031     GOBACK.
 10032
 10033 9200-RETURN-MAIN-MENU.
 10034     IF NOT PI-DATA-UPDATED
 10035         NEXT SENTENCE
 10036     ELSE
 10037         MOVE -1                 TO PFENTERL
 10038         MOVE ER-2213            TO EMI-ERROR
 10039         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10040         GO TO 4000-SHOW-TOTALS.
 10041
 10042     MOVE XCTL-626               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 197
* EL630.cbl
 10043     GO TO 9300-XCTL.
 10044
 10045 9300-XCTL.
 10046
 10047* EXEC CICS XCTL
 10048*        PROGRAM    (PGM-NAME)
 10049*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10050*        LENGTH     (WS-COMM-LENGTH)
 10051*    END-EXEC.
 10052*    MOVE '.$C                   %   #00008466' TO DFHEIV0
 10053     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10054     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10055     MOVE X'2020233030303038343636' TO DFHEIV0(25:11)
 10056     CALL 'kxdfhei1' USING DFHEIV0,
 10057           PGM-NAME,
 10058           PROGRAM-INTERFACE-BLOCK,
 10059           WS-COMM-LENGTH,
 10060           DFHEIV99
 10061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10062
 10063     MOVE ZEROS  TO RETURN-CODE.
 10064
 10065* GOBACK.
 10066     MOVE '9%                    "   ' TO DFHEIV0
 10067     MOVE 'EL630' TO DFHEIV1
 10068     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10069     GOBACK.
 10070
 10071 9400-CLEAR.
 10072     IF NOT PI-DATA-UPDATED
 10073         NEXT SENTENCE
 10074     ELSE
 10075         MOVE 'Y'                TO PI-CLEAR-ERROR-SW
 10076         MOVE -1                 TO PFENTERL
 10077         MOVE ER-2213            TO EMI-ERROR
 10078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10079         GO TO 4000-SHOW-TOTALS.
 10080
 10081     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 10082     GO TO 9300-XCTL.
 10083
 10084 9500-PF12.
 10085     MOVE XCTL-010               TO PGM-NAME.
 10086     GO TO 9300-XCTL.
 10087
 10088 9600-PGMID-ERROR.
 10089
 10090* EXEC CICS HANDLE CONDITION
 10091*        PGMIDERR    (8300-SEND-TEXT)
 10092*    END-EXEC.
 10093*    MOVE '"$L                   ! A #00008492' TO DFHEIV0
 10094     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10096     MOVE X'4120233030303038343932' TO DFHEIV0(25:11)
 10097     CALL 'kxdfhei1' USING DFHEIV0
 10098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10099
 10100
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 198
* EL630.cbl
 10101     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10102     MOVE ' '                    TO PI-ENTRY-CD-1.
 10103     MOVE XCTL-005               TO PGM-NAME.
 10104     MOVE PGM-NAME               TO LOGOFF-PGM.
 10105     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10106     GO TO 9300-XCTL.
 10107
 10108 9700-DATE-LINK.
 10109     MOVE LINK-ELDATCV           TO PGM-NAME.
 10110
 10111* EXEC CICS LINK
 10112*        PROGRAM    (PGM-NAME)
 10113*        COMMAREA   (DATE-CONVERSION-DATA)
 10114*        LENGTH     (DC-COMM-LENGTH)
 10115*    END-EXEC.
 10116*    MOVE '."C                   (   #00008505' TO DFHEIV0
 10117     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10118     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10119     MOVE X'2020233030303038353035' TO DFHEIV0(25:11)
 10120     CALL 'kxdfhei1' USING DFHEIV0,
 10121           PGM-NAME,
 10122           DATE-CONVERSION-DATA,
 10123           DC-COMM-LENGTH,
 10124           DFHEIV99,
 10125           DFHEIV99,
 10126           DFHEIV99,
 10127           DFHEIV99
 10128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10129
 10130
 10131 9900-ERROR-FORMAT.
 10132     IF NOT EMI-ERRORS-COMPLETE
 10133         MOVE LINK-001           TO PGM-NAME
 10134
 10135* EXEC CICS LINK
 10136*            PROGRAM    (PGM-NAME)
 10137*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10138*            LENGTH     (EMI-COMM-LENGTH)
 10139*        END-EXEC.
 10140*    MOVE '."C                   (   #00008514' TO DFHEIV0
 10141     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10142     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10143     MOVE X'2020233030303038353134' TO DFHEIV0(25:11)
 10144     CALL 'kxdfhei1' USING DFHEIV0,
 10145           PGM-NAME,
 10146           ERROR-MESSAGE-INTERFACE-BLOCK,
 10147           EMI-COMM-LENGTH,
 10148           DFHEIV99,
 10149           DFHEIV99,
 10150           DFHEIV99,
 10151           DFHEIV99
 10152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10153
 10154
 10155 9900-EXIT.
 10156     EXIT.
 10157
 10158 9990-ABEND.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 199
* EL630.cbl
 10159     MOVE LINK-004               TO PGM-NAME.
 10160     MOVE DFHEIBLK               TO EMI-LINE1.
 10161
 10162* EXEC CICS LINK
 10163*        PROGRAM   (PGM-NAME)
 10164*        COMMAREA  (EMI-LINE1)
 10165*        LENGTH    (72)
 10166*    END-EXEC.
 10167     MOVE 72
 10168       TO DFHEIV11
 10169*    MOVE '."C                   (   #00008526' TO DFHEIV0
 10170     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10172     MOVE X'2020233030303038353236' TO DFHEIV0(25:11)
 10173     CALL 'kxdfhei1' USING DFHEIV0,
 10174           PGM-NAME,
 10175           EMI-LINE1,
 10176           DFHEIV11,
 10177           DFHEIV99,
 10178           DFHEIV99,
 10179           DFHEIV99,
 10180           DFHEIV99
 10181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10182
 10183
 10184     MOVE -1                     TO PFENTERL.
 10185     GO TO 8200-SEND-DATAONLY.
 10186
 10187 9995-SECURITY-VIOLATION.
 10188*                            COPY ELCSCTP.
 10189******************************************************************
 10190*                                                                *
 10191*                            ELCSCTP                             *
 10192*                            VMOD=2.001                          *
 10193*                                                                *
 10194*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10195******************************************************************
 10196
 10197
 10198     MOVE EIBDATE          TO SM-JUL-DATE.
 10199     MOVE EIBTRMID         TO SM-TERMID.
 10200     MOVE THIS-PGM         TO SM-PGM.
 10201     MOVE EIBTIME          TO TIME-IN.
 10202     MOVE TIME-OUT         TO SM-TIME.
 10203     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10204
 10205
 10206* EXEC CICS LINK
 10207*         PROGRAM  ('EL003')
 10208*         COMMAREA (SECURITY-MESSAGE)
 10209*         LENGTH   (80)
 10210*    END-EXEC.
 10211     MOVE 'EL003' TO DFHEIV1
 10212     MOVE 80
 10213       TO DFHEIV11
 10214*    MOVE '."C                   (   #00008553' TO DFHEIV0
 10215     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10216     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 200
* EL630.cbl
 10217     MOVE X'2020233030303038353533' TO DFHEIV0(25:11)
 10218     CALL 'kxdfhei1' USING DFHEIV0,
 10219           DFHEIV1,
 10220           SECURITY-MESSAGE,
 10221           DFHEIV11,
 10222           DFHEIV99,
 10223           DFHEIV99,
 10224           DFHEIV99,
 10225           DFHEIV99
 10226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10227
 10228
 10229******************************************************************
 10230
 10231
 10232 9995-EXIT.
 10233     EXIT.
 10234
 10235
 10236 9999-DFHBACK SECTION.
 10237     MOVE '9%                    "   ' TO DFHEIV0
 10238     MOVE 'EL630' TO DFHEIV1
 10239     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10240     GOBACK.
 10241 9999-DFHEXIT.
 10242     IF DFHEIGDJ EQUAL 0001
 10243         NEXT SENTENCE
 10244     ELSE IF DFHEIGDJ EQUAL 2
 10245         GO TO 9600-PGMID-ERROR,
 10246               9990-ABEND
 10247         DEPENDING ON DFHEIGDI
 10248     ELSE IF DFHEIGDJ EQUAL 3
 10249         GO TO 0350-NO-RECORDS,
 10250               0350-NO-RECORDS
 10251         DEPENDING ON DFHEIGDI
 10252     ELSE IF DFHEIGDJ EQUAL 4
 10253         GO TO 0480-NO-BATCH-TRAILER
 10254         DEPENDING ON DFHEIGDI
 10255     ELSE IF DFHEIGDJ EQUAL 5
 10256         GO TO 1000-NO-CARRIER
 10257         DEPENDING ON DFHEIGDI
 10258     ELSE IF DFHEIGDJ EQUAL 6
 10259         GO TO 1100-NO-STATE
 10260         DEPENDING ON DFHEIGDI
 10261     ELSE IF DFHEIGDJ EQUAL 7
 10262         GO TO 1200-ACCOUNT-INVALID,
 10263               1200-ACCOUNT-INVALID
 10264         DEPENDING ON DFHEIGDI
 10265     ELSE IF DFHEIGDJ EQUAL 8
 10266         GO TO 1250-NO-COMPANY-REC
 10267         DEPENDING ON DFHEIGDI
 10268     ELSE IF DFHEIGDJ EQUAL 9
 10269         GO TO 1300-NO-COMPANY-REC
 10270         DEPENDING ON DFHEIGDI
 10271     ELSE IF DFHEIGDJ EQUAL 10
 10272         GO TO 1300-EXIT
 10273         DEPENDING ON DFHEIGDI
 10274     ELSE IF DFHEIGDJ EQUAL 11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 201
* EL630.cbl
 10275         GO TO 1470-NO-COMP-MSTR
 10276         DEPENDING ON DFHEIGDI
 10277     ELSE IF DFHEIGDJ EQUAL 12
 10278         GO TO 1990-EXIT
 10279         DEPENDING ON DFHEIGDI
 10280     ELSE IF DFHEIGDJ EQUAL 13
 10281         GO TO 2100-ADD-BATCH-TOTAL-REC
 10282         DEPENDING ON DFHEIGDI
 10283     ELSE IF DFHEIGDJ EQUAL 14
 10284         GO TO 3200-NO-RECORDS
 10285         DEPENDING ON DFHEIGDI
 10286     ELSE IF DFHEIGDJ EQUAL 15
 10287         GO TO 3120-END-ROUTINE
 10288         DEPENDING ON DFHEIGDI
 10289     ELSE IF DFHEIGDJ EQUAL 16
 10290         GO TO 3100-STOP-BROWSE,
 10291               3100-STOP-BROWSE
 10292         DEPENDING ON DFHEIGDI
 10293     ELSE IF DFHEIGDJ EQUAL 17
 10294         GO TO 3006-DELETE-CERTIFICATE,
 10295               3006-DELETE-CERTIFICATE
 10296         DEPENDING ON DFHEIGDI
 10297     ELSE IF DFHEIGDJ EQUAL 18
 10298         GO TO 3020-CONTINUE-DELETE
 10299         DEPENDING ON DFHEIGDI
 10300     ELSE IF DFHEIGDJ EQUAL 19
 10301         GO TO 3006-DELETE-ERNOTE
 10302         DEPENDING ON DFHEIGDI
 10303     ELSE IF DFHEIGDJ EQUAL 20
 10304         GO TO 3020-CONTINUE-DELETE,
 10305               3020-CONTINUE-DELETE
 10306         DEPENDING ON DFHEIGDI
 10307     ELSE IF DFHEIGDJ EQUAL 21
 10308         GO TO 5900-EXIT
 10309         DEPENDING ON DFHEIGDI
 10310     ELSE IF DFHEIGDJ EQUAL 22
 10311         GO TO 5100-STOP-BROWSE,
 10312               5100-STOP-BROWSE
 10313         DEPENDING ON DFHEIGDI
 10314     ELSE IF DFHEIGDJ EQUAL 23
 10315         GO TO 6500-NO-RECORDS
 10316         DEPENDING ON DFHEIGDI
 10317     ELSE IF DFHEIGDJ EQUAL 24
 10318         GO TO 6400-STOP-BROWSE,
 10319               6400-STOP-BROWSE
 10320         DEPENDING ON DFHEIGDI
 10321     ELSE IF DFHEIGDJ EQUAL 25
 10322         GO TO 6300-WRITE-PNDB-RECORD
 10323         DEPENDING ON DFHEIGDI
 10324     ELSE IF DFHEIGDJ EQUAL 26
 10325         GO TO 6070-DELETE-MAILING
 10326         DEPENDING ON DFHEIGDI
 10327     ELSE IF DFHEIGDJ EQUAL 27
 10328         GO TO 6300-WRITE-PNDB-RECORD,
 10329               6300-WRITE-PNDB-RECORD
 10330         DEPENDING ON DFHEIGDI
 10331     ELSE IF DFHEIGDJ EQUAL 28
 10332         GO TO 6300-WRITE-PNDB-RECORD
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 202
* EL630.cbl
 10333         DEPENDING ON DFHEIGDI
 10334     ELSE IF DFHEIGDJ EQUAL 29
 10335         GO TO 6690-EXIT
 10336         DEPENDING ON DFHEIGDI
 10337     ELSE IF DFHEIGDJ EQUAL 30
 10338         GO TO 7090-EXIT
 10339         DEPENDING ON DFHEIGDI
 10340     ELSE IF DFHEIGDJ EQUAL 31
 10341         GO TO 7180-NO-REQUEST-REC
 10342         DEPENDING ON DFHEIGDI
 10343     ELSE IF DFHEIGDJ EQUAL 32
 10344         GO TO 7280-NO-REQUEST-REC
 10345         DEPENDING ON DFHEIGDI
 10346     ELSE IF DFHEIGDJ EQUAL 33
 10347         GO TO 8300-SEND-TEXT
 10348         DEPENDING ON DFHEIGDI.
 10349     MOVE '9%                    "   ' TO DFHEIV0
 10350     MOVE 'EL630' TO DFHEIV1
 10351     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10352     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6948     Code:       27554
