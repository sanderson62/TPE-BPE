* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page   1
* ELRFND.cbl
* Options: int("ELRFND.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRFND.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRFND.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRFND.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFND.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:23:50.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page   2
* ELRFND.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  LOAN TERM        - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    42*  STATE CODE       - CP-STATE                                   *
    43*  STATE CODE       - CP-STATE-STD-ABBV                          *
    44*  CLASS CODE       - CP-CLASS-CODE                              *
    45*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    46*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    47*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    48*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    49*  A.P.R.           - CP-LOAN-APR                                *
    50*  METHOD           - CP-EARNING-METHOD                          *
    51*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  COMPANY I.D.     - CP-COMPANY-ID                              *
    54*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    55*  INSURED AGE      - CP-ISSUE-AGE                               *
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page   3
* ELRFND.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  ELRFND  WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '********VMOD=2.011 *************'.
    66 77  WS-UE-CLP                   PIC S9(5)V99 COMP-3 VALUE +0.
    67 77  WS-GFR3                     PIC S9(5)V99 COMP-3 VALUE +0.
    68 77  WS-MONTH                    PIC S999     COMP-3 VALUE +0.
    69
    70 01  WS-WORK-MISC.
    71     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    72     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    73     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    74     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    75     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    76     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    77     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    78     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    79     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    80     12  WS-SAVE-EARN-METHOD PIC X.
    81     12  ws-save-ext-days    pic s9(5)        comp-3.
    82     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    83     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    84     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    85     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    86     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    87     12  FACTOR-5            PIC S9(7)        COMP-3.
    88     12  FACTOR-6            PIC S9(7)        COMP-3.
    89     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    90     12  RATE-FACTOR-2       PIC S999         COMP-3.
    91     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    92     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    93     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    94     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    95
    96 01  TEXAS-REG-WORK-AREAS.
    97     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    98     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    99     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   100     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   101     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   102     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   103     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   104     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   105     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   106
   107 01  NET-PAY-INTERFACE.
   108     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   109     12  N-P-ORIG            PIC S9(3)       COMP-3.
   110     12  N-P-REM             PIC S9(3)       COMP-3.
   111     12  N-P-OPT             PIC X.
   112     12  N-P-LOAN            PIC S9(3)       COMP-3.
   113     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   114
   115*                        COPY ERCNETWS.
   116*****************************************************************
   117*                                                               *
   118*                                                               *
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page   4
* ELRFND.cbl
   119*                            ERCNETWS                           *
   120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   121*                            VMOD=2.014                         *
   122*                                                               *
   123*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   124*                                                               *
   125*****************************************************************.
   126*                   C H A N G E   L O G
   127*
   128* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   129*-----------------------------------------------------------------
   130*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   131* EFFECTIVE    NUMBER
   132*-----------------------------------------------------------------
   133* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   134* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   135* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   136* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   137* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   138******************************************************************
   139
   140 01  NET-PAY-WORK-AREA.
   141     12  OPTION-SW               PIC X   VALUE 'X'.
   142        88  NPO-STD         VALUE SPACE.
   143        88  NPO-ALT         VALUE 'A'.
   144        88  NPO-SIMPLE      VALUE 'S'.
   145        88  NPO-2MO         VALUE 'I'.
   146        88  NPO-3MO         VALUE 'J'.
   147        88  NPO-4MO         VALUE 'K'.
   148        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   149        88  NPO-TRUNC-0     VALUE 'T'.
   150        88  NPO-TRUNC-1     VALUE 'U'.
   151        88  NPO-TRUNC-2     VALUE 'V'.
   152        88  NPO-TRUNC-3     VALUE 'W'.
   153        88  NPO-TRUNC-4     VALUE 'X'.
   154        88  NPO-REFUND      VALUE 'R'.
   155        88  NPO-PRUDENTIAL  VALUE 'P'.
   156
   157     12  TYPE-SW             PIC X   VALUE 'N'.
   158        88  NET-STD             VALUE 'N'.
   159        88  NET-SMP             VALUE 'S'.
   160
   161     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   162        88  NP-RATING           VALUE '1'.
   163        88  NP-REFUND           VALUE '2'.
   164        88  NP-REMAIN-AMT       VALUE '3'.
   165
   166     12  COMP-3-WORK-AREA         COMP-3.
   167         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   168         16  V               PIC SV9(13)       VALUE +.0.
   169         16  J               PIC SV9(9)        VALUE +0.
   170         16  K               PIC SV9(9)        VALUE +0.
   171         16  I               PIC SV9(10)       VALUE +.0.
   172         16  D               PIC S9(5)         VALUE +.0.
   173         16  APR100          PIC SV9(9)        VALUE +.0.
   174         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   175         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   176         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page   5
* ELRFND.cbl
   177         16  pema            pic s9(2)v9(15)   value +0.
   178         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   179         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   180         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   181         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   182         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   183         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   184         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   185         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   186         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   187         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   188         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   189         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   190         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   191         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   192         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   193         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   194         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.
   195         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   196         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   197         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.
   198         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   199         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.
   200         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.
   201         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   202         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   203         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.
   204         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   205         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.
   206         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   207         16  K1              PIC S999          VALUE +1.
   208         16  K12             PIC S999          VALUE +12.
   209         16  K100            PIC S999          VALUE +100.
   210         16  K1000           PIC S9(7)         VALUE +1000.
   211         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   212         16  Y REDEFINES NC-LR
   213                             PIC S99V9(5).
   214         16  TI              PIC S999V9(5)     VALUE +0.
   215         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   216         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   217         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   218         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   219         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   220         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   221         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   222         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   223
   224         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   225         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   226         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   227         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   228         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   229         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   230         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   231         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   232         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   233         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   234         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page   6
* ELRFND.cbl
   235         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   236         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   237
   238         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   239
   240         16  ORIGINAL-TERM   PIC S999.
   241         16  M              REDEFINES ORIGINAL-TERM
   242                             PIC S999.
   243
   244         16  REMAINING-TERM  PIC S999.
   245         16  R              REDEFINES REMAINING-TERM
   246                             PIC S999.
   247
   248         16  LOAN-TERM       PIC S999.
   249         16  N              REDEFINES LOAN-TERM
   250                             PIC S999.
   251
   252         16  EXPIRED-TERM    PIC S999.
   253         16  E              REDEFINES EXPIRED-TERM
   254                             PIC S999.
   255
   256         16  PRUDENTIAL-WORK-AMT
   257                             PIC S9(7)V9(8).
   258         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   259                             PIC S9(7)V9(8).
   260
   261         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   262         16  VX              PIC S9V9(13)      VALUE +0.0.
   263         16  SV              PIC S9V9(13)      VALUE +0.0.
   264         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   265         16  SX              PIC S9V9(13)      VALUE +0.0.
   266         16  SE              PIC S9V9(10)      VALUE +0.0.
   267         16  N2              PIC S9(7)         VALUE +0.
   268         16  N3              PIC S9(7)         VALUE +0.
   269         16  K-I             PIC S9V9(8)       VALUE +0.0.
   270
   271     12  BINARY-WORK-AREA        COMP.
   272         16  X1              PIC S999        VALUE +0.
   273         16  X2              PIC S999        VALUE +0.
   274         16  MAX-X           PIC S9(5)       VALUE +0.
   275         16  B1              PIC S9(5)       VALUE +1.
   276         16  LINDX           PIC S999        VALUE ZEROS.
   277         16  AHNDX           PIC S999        VALUE ZEROS.
   278
   279     12  CSO-RATE-WORK-AREAS.
   280         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   281         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   282         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   283     12  WS-WORK-MISC.
   284         16  ws-extra-pmts       pic s999         comp-3.
   285         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   286         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   287*        16  WS-AGE              PIC 99           VALUE ZEROS.
   288         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   289         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   290         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   291         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   292         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page   7
* ELRFND.cbl
   293         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   294         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   295         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   296         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   297         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   298         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   299         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   300******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page   8
* ELRFND.cbl
   302*                        COPY ELCDATE.
   303******************************************************************
   304*                                                                *
   305*                                                                *
   306*                            ELCDATE.                            *
   307*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   308*                            VMOD=2.003
   309*                                                                *
   310*                                                                *
   311*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   312*                 LENGTH = 200                                   *
   313******************************************************************
   314
   315 01  DATE-CONVERSION-DATA.
   316     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   317     12  DC-OPTION-CODE                PIC X.
   318         88  BIN-TO-GREG                VALUE ' '.
   319         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   320         88  EDIT-GREG-TO-BIN           VALUE '2'.
   321         88  YMD-GREG-TO-BIN            VALUE '3'.
   322         88  MDY-GREG-TO-BIN            VALUE '4'.
   323         88  JULIAN-TO-BIN              VALUE '5'.
   324         88  BIN-PLUS-ELAPSED           VALUE '6'.
   325         88  FIND-CENTURY               VALUE '7'.
   326         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   327         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   328         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   329         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   330         88  JULIAN-TO-BIN-3            VALUE 'C'.
   331         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   332         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   333         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   334         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   335         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   336         88  CHECK-LEAP-YEAR            VALUE 'H'.
   337         88  BIN-3-TO-GREG              VALUE 'I'.
   338         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   339         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   340         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   341         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   342         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   343         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   344         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   345         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   346         88  THREE-CHARACTER-BIN
   347                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   348         88  GREGORIAN-TO-BIN
   349                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   350         88  BIN-TO-GREGORIAN
   351                  VALUES ' ' '1' 'I' '8' 'G'.
   352         88  JULIAN-TO-BINARY
   353                  VALUES '5' 'C' 'E' 'F'.
   354     12  DC-ERROR-CODE                 PIC X.
   355         88  NO-CONVERSION-ERROR        VALUE ' '.
   356         88  DATE-CONVERSION-ERROR
   357                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   358         88  DATE-IS-ZERO               VALUE '1'.
   359         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page   9
* ELRFND.cbl
   360         88  DATE-IS-INVALID            VALUE '3'.
   361         88  DATE1-GREATER-DATE2        VALUE '4'.
   362         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   363         88  DATE-INVALID-OPTION        VALUE '9'.
   364         88  INVALID-CENTURY            VALUE 'A'.
   365         88  ONLY-CENTURY               VALUE 'B'.
   366         88  ONLY-LEAP-YEAR             VALUE 'C'.
   367         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   368     12  DC-END-OF-MONTH               PIC X.
   369         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   370     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   371         88  USE-NORMAL-PROCESS         VALUE ' '.
   372         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   373         88  ADJUST-UP-100-YRS          VALUE '2'.
   374     12  FILLER                        PIC X.
   375     12  DC-CONVERSION-DATES.
   376         16  DC-BIN-DATE-1             PIC XX.
   377         16  DC-BIN-DATE-2             PIC XX.
   378         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   379         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   380                       DC-GREG-DATE-1-EDIT.
   381             20  DC-EDIT1-MONTH        PIC 99.
   382             20  SLASH1-1              PIC X.
   383             20  DC-EDIT1-DAY          PIC 99.
   384             20  SLASH1-2              PIC X.
   385             20  DC-EDIT1-YEAR         PIC 99.
   386         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   387         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   388                     DC-GREG-DATE-2-EDIT.
   389             20  DC-EDIT2-MONTH        PIC 99.
   390             20  SLASH2-1              PIC X.
   391             20  DC-EDIT2-DAY          PIC 99.
   392             20  SLASH2-2              PIC X.
   393             20  DC-EDIT2-YEAR         PIC 99.
   394         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   395         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   396                     DC-GREG-DATE-1-YMD.
   397             20  DC-YMD-YEAR           PIC 99.
   398             20  DC-YMD-MONTH          PIC 99.
   399             20  DC-YMD-DAY            PIC 99.
   400         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   401         16  DC-GREG-DATE-1-MDY-R REDEFINES
   402                      DC-GREG-DATE-1-MDY.
   403             20  DC-MDY-MONTH          PIC 99.
   404             20  DC-MDY-DAY            PIC 99.
   405             20  DC-MDY-YEAR           PIC 99.
   406         16  DC-GREG-DATE-1-ALPHA.
   407             20  DC-ALPHA-MONTH        PIC X(10).
   408             20  DC-ALPHA-DAY          PIC 99.
   409             20  FILLER                PIC XX.
   410             20  DC-ALPHA-CENTURY.
   411                 24 DC-ALPHA-CEN-N     PIC 99.
   412             20  DC-ALPHA-YEAR         PIC 99.
   413         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   414         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   415         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   416         16  DC-JULIAN-DATE            PIC 9(05).
   417         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  10
* ELRFND.cbl
   418                                       PIC 9(05).
   419         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   420             20  DC-JULIAN-YEAR        PIC 99.
   421             20  DC-JULIAN-DAYS        PIC 999.
   422         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   423         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   424         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   425     12  DATE-CONVERSION-VARIBLES.
   426         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   427         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   428             20  FILLER                PIC 9(3).
   429             20  HOLD-CEN-1-CCYY.
   430                 24  HOLD-CEN-1-CC     PIC 99.
   431                 24  HOLD-CEN-1-YY     PIC 99.
   432             20  HOLD-CEN-1-MO         PIC 99.
   433             20  HOLD-CEN-1-DA         PIC 99.
   434         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   435             20  HOLD-CEN-1-R-MO       PIC 99.
   436             20  HOLD-CEN-1-R-DA       PIC 99.
   437             20  HOLD-CEN-1-R-CCYY.
   438                 24  HOLD-CEN-1-R-CC   PIC 99.
   439                 24  HOLD-CEN-1-R-YY   PIC 99.
   440             20  FILLER                PIC 9(3).
   441         16  HOLD-CENTURY-1-X.
   442             20  FILLER                PIC X(3)  VALUE SPACES.
   443             20  HOLD-CEN-1-X-CCYY.
   444                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   445                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   446             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   447             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   448         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   449             20  HOLD-CEN-1-R-X-MO     PIC XX.
   450             20  HOLD-CEN-1-R-X-DA     PIC XX.
   451             20  HOLD-CEN-1-R-X-CCYY.
   452                 24  HOLD-CEN-1-R-X-CC PIC XX.
   453                 24  HOLD-CEN-1-R-X-YY PIC XX.
   454             20  FILLER                PIC XXX.
   455         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   456         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   457         16  DC-JULIAN-DATE-1          PIC 9(07).
   458         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   459             20  DC-JULIAN-1-CCYY.
   460                 24  DC-JULIAN-1-CC    PIC 99.
   461                 24  DC-JULIAN-1-YR    PIC 99.
   462             20  DC-JULIAN-DA-1        PIC 999.
   463         16  DC-JULIAN-DATE-2          PIC 9(07).
   464         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   465             20  DC-JULIAN-2-CCYY.
   466                 24  DC-JULIAN-2-CC    PIC 99.
   467                 24  DC-JULIAN-2-YR    PIC 99.
   468             20  DC-JULIAN-DA-2        PIC 999.
   469         16  DC-GREG-DATE-A-EDIT.
   470             20  DC-EDITA-MONTH        PIC 99.
   471             20  SLASHA-1              PIC X VALUE '/'.
   472             20  DC-EDITA-DAY          PIC 99.
   473             20  SLASHA-2              PIC X VALUE '/'.
   474             20  DC-EDITA-CCYY.
   475                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  11
* ELRFND.cbl
   476                 24  DC-EDITA-YEAR     PIC 99.
   477         16  DC-GREG-DATE-B-EDIT.
   478             20  DC-EDITB-MONTH        PIC 99.
   479             20  SLASHB-1              PIC X VALUE '/'.
   480             20  DC-EDITB-DAY          PIC 99.
   481             20  SLASHB-2              PIC X VALUE '/'.
   482             20  DC-EDITB-CCYY.
   483                 24  DC-EDITB-CENT     PIC 99.
   484                 24  DC-EDITB-YEAR     PIC 99.
   485         16  DC-GREG-DATE-CYMD         PIC 9(08).
   486         16  DC-GREG-DATE-CYMD-R REDEFINES
   487                              DC-GREG-DATE-CYMD.
   488             20  DC-CYMD-CEN           PIC 99.
   489             20  DC-CYMD-YEAR          PIC 99.
   490             20  DC-CYMD-MONTH         PIC 99.
   491             20  DC-CYMD-DAY           PIC 99.
   492         16  DC-GREG-DATE-MDCY         PIC 9(08).
   493         16  DC-GREG-DATE-MDCY-R REDEFINES
   494                              DC-GREG-DATE-MDCY.
   495             20  DC-MDCY-MONTH         PIC 99.
   496             20  DC-MDCY-DAY           PIC 99.
   497             20  DC-MDCY-CEN           PIC 99.
   498             20  DC-MDCY-YEAR          PIC 99.
   499    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   500        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   501    12  DC-EL310-DATE                  PIC X(21).
   502    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  12
* ELRFND.cbl
   504*                        COPY ELCCALC.
   505******************************************************************
   506*                                                                *
   507*                           ELCCALC.                            *
   508*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   509*                            VMOD=2.025                          *
   510*                                                                *
   511*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   512*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   513*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   514*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   515*                                                                *
   516*  PASSED TO ELRTRM                                              *
   517*  -----------------                                             *
   518*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   519*  ORIGINAL TERM                                                 *
   520*  BEGINNING DATE                                                *
   521*  ENDING DATE                                                   *
   522*  COMPANY I.D.                                                  *
   523*  ACCOUNT MASTER USER FIELD                                     *
   524*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   525*  FREE LOOK DAYS                                                *
   526*                                                                *
   527*  RETURNED FROM ELRTRM                                          *
   528*  ---------------------                                         *
   529*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   530*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   531*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   532*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   533*----------------------------------------------------------------*
   534*  PASSED TO ELRAMT                                              *
   535*  ----------------                                              *
   536*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   537*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   538*  ORIGINAL AMOUNT                                               *
   539*  ALTERNATE BENEFIT (BALLON)                                    *
   540*  A.P.R. - NET PAY ONLY                                         *
   541*  METHOD
   542*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   543*  COMPANY I.D.                                                  *
   544*  BENEFIT TYPE                                                  *
   545*                                                                *
   546*  RETURNED FROM ELRAMT                                          *
   547*  --------------------                                          *
   548*  REMAINING AMOUNT 1 - CURRENT                                  *
   549*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   550*  REMAINING AMOUNT FACTOR
   551*----------------------------------------------------------------*
   552*  PASSED TO ELRESV                                              *
   553*  -----------------                                             *
   554*  CERTIFICATE EFFECTIVE DATE                                    *
   555*  VALUATION DATE                                                *
   556*  PAID THRU DATE                                                *
   557*  BENEFIT                                                       *
   558*  INCURRED DATE                                                 *
   559*  REPORTED DATE                                                 *
   560*  ISSUE AGE                                                     *
   561*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  13
* ELRFND.cbl
   562*  CDT PERCENT                                                   *
   563*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   564* *CLAIM TYPE (LIFE, A/H)                                        *
   565* *REMAINING BENEFIT (FROM ELRAMT)                               *
   566* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   567*                                                                *
   568*  RETURNED FROM ELRESV                                          *
   569*  --------------------                                          *
   570*  CDT TABLE USED                                                *
   571*  CDT FACTOR USED                                               *
   572*  PAY TO CURRENT RESERVE                                        *
   573*  I.B.N.R. - A/H ONLY                                           *
   574*  FUTURE (ACCRUED) AH ONLY                                      *
   575*----------------------------------------------------------------*
   576*  PASSED TO ELRATE                                              *
   577*  ----------------                                              *
   578*  CERT ISSUE DATE                                               *
   579*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   580*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   581*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   582*  STATE CODE (CLIENT DEFINED)                                   *
   583*  STATE CODE (STANDARD P.O. ABBRV)                              *
   584*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   585*  DEVIATION CODE                                                *
   586*  ISSUE AGE                                                     *
   587*  ORIGINAL BENEFIT AMOUNT                                       *
   588*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   589*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   590*  BENEFIT KIND (LIFE OR A/H)                                    *
   591*  A.P.R.                                                        *
   592*  METHOD
   593*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   594*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   595*  COMPANY I.D. (3 CHARACTER)                                    *
   596*  BENEFIT CODE                                                  *
   597*  BENEFIT OVERRIDE CODE                                         *
   598*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   599*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   600*  JOINT INDICATOR (CSL ONLY)                                    *
   601*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   602*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   603*                                                                *
   604*  RETURNED FROM ELRATE                                          *
   605*  --------------------                                          *
   606*  CALCULATED PREMIUM                                            *
   607*  PREMIUM RATE                                                  *
   608*  MORTALITY CODE                                                *
   609*  MAX ATTAINED AGE                                              *
   610*  MAX AGE                                                       *
   611*  MAX TERM                                                      *
   612*  MAX MONTHLY BENEFIT                                           *
   613*  MAX TOTAL BENIFIT                                             *
   614*  COMPOSITE RATE (OPEN-END ONLY)                                *
   615*----------------------------------------------------------------*
   616*  PASSED TO ELRFND                                              *
   617*  ----------------                                              *
   618*  CERT ISSUE DATE                                               *
   619*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  14
* ELRFND.cbl
   620*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   621*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   622*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   623*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   624*  STATE CODE (CLIENT DEFINED)                                   *
   625*  STATE CODE (STANDARD P.O. ABBRV)                              *
   626*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   627*  DEVIATION CODE                                                *
   628*  ISSUE AGE                                                     *
   629*  ORIGINAL BENEFIT AMOUNT                                       *
   630*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   631*  PROCESS TYPE (CANCEL)                                         *
   632*  BENEFIT KIND (LIFE OR A/H)                                    *
   633*  A.P.R.                                                        *
   634*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   635*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   636*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   637*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   638*  COMPANY I.D. (3 CHARACTER)                                    *
   639*  BENEFIT CODE                                                  *
   640*  BENEFIT OVERRIDE CODE                                         *
   641*                                                                *
   642*  RETURNED FROM ELRFND                                          *
   643*  --------------------                                          *
   644*  CALCULATED REFUND                                             *
   645*----------------------------------------------------------------*
   646*  PASSED TO ELEARN                                              *
   647*  ----------------                                              *
   648*  CERT ISSUE DATE                                               *
   649*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   650*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   651*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   652*  STATE CODE (CLIENT DEFINED)                                   *
   653*  STATE CODE (STANDARD P.O. ABBRV)                              *
   654*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   655*  DEVIATION CODE                                                *
   656*  ISSUE AGE                                                     *
   657*  ORIGINAL BENEFIT AMOUNT                                       *
   658*  BENEFIT KIND (LIFE OR A/H)                                    *
   659*  A.P.R.                                                        *
   660*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   661*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   662*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   663*  COMPANY I.D. (3 CHARACTER)                                    *
   664*  BENEFIT CODE                                                  *
   665*  BENEFIT OVERRIDE CODE                                         *
   666*                                                                *
   667*  RETURNED FROM ELEARN                                          *
   668*  --------------------                                          *
   669*  INDICATED  EARNINGS                                           *
   670*----------------------------------------------------------------*
   671*                 LENGTH = 450                                   *
   672*                                                                *
   673******************************************************************
   674******************************************************************
   675*                   C H A N G E   L O G
   676*
   677* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  15
* ELRFND.cbl
   678*-----------------------------------------------------------------
   679*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   680* EFFECTIVE    NUMBER
   681*-----------------------------------------------------------------
   682* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   683* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   684* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   685* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   686* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   687* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   688* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   689* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   690* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   691* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   692* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   693* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
   694******************************************************************
   695
   696 01  CALCULATION-PASS-AREA.
   697     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   698                                     COMP.
   699
   700     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   701       88  NO-CP-ERROR                             VALUE ZERO.
   702       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   703                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
   704       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   705       88  CP-ERROR-IN-DATES                       VALUE '2'.
   706       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   707       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   708       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   709       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   710       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   711       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   712       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   713       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   714       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   715       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   716       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   717       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   718       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   719       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   720       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   721       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
   722
   723     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   724       88  NO-CP-ERROR-2                           VALUE ZERO.
   725***********************  INPUT AREAS ****************************
   726
   727     12  CP-CALCULATION-AREA.
   728         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   729         16  CP-CERT-EFF-DT        PIC XX.
   730         16  CP-VALUATION-DT       PIC XX.
   731         16  CP-PAID-THRU-DT       PIC XX.
   732         16  CP-BENEFIT-TYPE       PIC X.
   733           88  CP-AH                               VALUE 'A' 'D'
   734                                                   'I' 'U'.
   735           88  CP-REDUCING-LIFE                    VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  16
* ELRFND.cbl
   736           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   737         16  CP-INCURRED-DT        PIC XX.
   738         16  CP-REPORTED-DT        PIC XX.
   739         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   740         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   741         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   742                                     COMP-3.
   743         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   744                                     COMP-3.
   745         16  CP-CDT-METHOD         PIC X.
   746           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   747           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   748           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   749         16  CP-CLAIM-TYPE         PIC X.
   750           88  CP-AH-CLAIM                         VALUE 'A'.
   751           88  CP-LIFE-CLAIM                       VALUE 'L'.
   752         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   753                                     COMP-3.
   754         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   755                                     COMP-3.
   756         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   757                                     COMP-3.
   758         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   759                                     COMP-3.
   760         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   761                                     COMP-3.
   762         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   763                                     COMP-3.
   764         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   765                                     COMP-3.
   766         16  CP-REM-TERM-METHOD    PIC X.
   767           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   768           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   769           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   770           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   771           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   772           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   773           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   774         16  CP-EARNING-METHOD     PIC X.
   775           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   776           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   777           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   778           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   779           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   780           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   781           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   782           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   783           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   784           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   785           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   786           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   787           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   788           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   789         16  CP-PROCESS-TYPE       PIC X.
   790           88  CP-CLAIM                            VALUE '1'.
   791           88  CP-CANCEL                           VALUE '2'.
   792           88  CP-ISSUE                            VALUE '3'.
   793         16  CP-SPECIAL-CALC-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  17
* ELRFND.cbl
   794           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   795           88  CP-1-MTH-INTEREST               VALUE ' '.
   796           88  CP-0-MTH-INTEREST               VALUE 'A'.
   797           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   798           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   799           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   800           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   801           88  CP-FARM-PLAN                    VALUE 'F'.
   802           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   803           88  CP-2-MTH-INTEREST               VALUE 'I'.
   804           88  CP-3-MTH-INTEREST               VALUE 'J'.
   805           88  CP-4-MTH-INTEREST               VALUE 'K'.
   806           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   807           88  CP-MORTGAGE-REC                 VALUE 'M'.
   808           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   809           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   810           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   811           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   812                                                     'W' 'X'.
   813           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   814           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   815           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   816           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   817           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   818           88  CP-SUMMARY-REC                  VALUE 'Z'.
   819           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   820           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   821           88  CP-AD-D-BENEFIT                 VALUE '4'.
   822           88  CP-CSL-METH-1                   VALUE '5'.
   823           88  CP-CSL-METH-2                   VALUE '6'.
   824           88  CP-CSL-METH-3                   VALUE '7'.
   825           88  CP-CSL-METH-4                   VALUE '8'.
   826
   827         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   828                                     COMP-3.
   829         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   830         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   831         16  CP-STATE              PIC XX          VALUE SPACE.
   832         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   833         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   834           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   835               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   836         16  CP-R78-OPTION         PIC X.
   837           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   838           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   839
   840         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   841         16  CP-IBNR-RESERVE-SW    PIC X.
   842         16  CP-CLAIM-STATUS       PIC X.
   843         16  CP-RATE-FILE          PIC X.
   844         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   845                                     COMP-3.
   846
   847         16  CP-LIFE-OVERRIDE-CODE PIC X.
   848         16  CP-AH-OVERRIDE-CODE   PIC X.
   849
   850         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   851                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  18
* ELRFND.cbl
   852         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   853                                   PIC S9(5)V99 COMP-3.
   854         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   855                                     COMP-3.
   856         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   857                                     COMP-3.
   858         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   859                                     COMP-3.
   860         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   861                                  PIC S9(7)V99 COMP-3.
   862
   863         16  CP-PAID-FROM-DATE     PIC X(02).
   864         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   865         16  CP-EXT-DAYS-CALC      PIC X.
   866           88  CP-EXT-NO-CHG                   VALUE ' '.
   867           88  CP-EXT-CHG-LF                   VALUE '1'.
   868           88  CP-EXT-CHG-AH                   VALUE '2'.
   869           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   870         16  CP-DOMICILE-STATE     PIC XX.
   871         16  CP-CARRIER            PIC X.
   872         16  CP-REIN-FLAG          PIC X.
   873         16  CP-REM-TRM-CALC-OPTION PIC X.
   874           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   875                      '2' '3' '4' '5'.
   876           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   877           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   878           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   879           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   880           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   881           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   882           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   883           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   884         16  CP-SIG-SWITCH         PIC X.
   885         16  CP-RATING-METHOD      PIC X.
   886           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   887           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   888           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   889           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   890           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   891           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   892           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   893           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   894           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   895         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   896                                     COMP-3.
   897         16  CP-BEN-CATEGORY       PIC X.
   898         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   899         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   900                                   PIC S99V9(5) COMP-3.
   901         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   902         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   903                                   PIC S99V9(5) COMP-3.
   904         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   905         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   906         16  CP-EXPIRE-DT          PIC XX.
   907         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   908         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   909         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  19
* ELRFND.cbl
   910         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   911         16  CP-DDF-SPEC-CALC      PIC X.
   912             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   913             88  CP-CALC-CLP              VALUE 'C'.
   914         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   915         16  CP-CANCEL-REASON      PIC X.
   916         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   917         16  CP-PMT-MODE           PIC X.
   918         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   919         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   920         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   921         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   922         16  FILLER                PIC X.
   923
   924***************    OUTPUT FROM ELRESV   ************************
   925
   926         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   927
   928         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   929                                     COMP-3.
   930         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   931                                     COMP-3.
   932         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   933                                     COMP-3.
   934         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   935                                     COMP-3.
   936         16  FILLER                PIC X(09).
   937***************    OUTPUT FROM ELRTRM   *************************
   938
   939         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   940                                     COMP-3.
   941         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   942                                     COMP-3.
   943         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   944                                     COMP-3.
   945         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   946                                     COMP-3.
   947         16  FILLER                PIC X(12).
   948
   949***************    OUTPUT FROM ELRAMT   *************************
   950
   951         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   952                                     COMP-3.
   953         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   954                                     COMP-3.
   955         16  FILLER                PIC X(12).
   956
   957***************    OUTPUT FROM ELRATE   *************************
   958
   959         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   960                                     COMP-3.
   961         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   962                                     COMP-3.
   963         16  CP-MORTALITY-CODE     PIC X(4).
   964         16  CP-RATE-EDIT-FLAG     PIC X.
   965             88  CP-RATES-NEED-APR                  VALUE '1'.
   966         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   967                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  20
* ELRFND.cbl
   968         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   969         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   970         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   971                                   PIC S9(7)V99 COMP-3.
   972         16  FILLER                PIC X(07).
   973
   974***************    OUTPUT FROM ELRFND   *************************
   975
   976         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   977                                     COMP-3.
   978         16  CP-REFUND-TYPE-USED   PIC X.
   979           88  CP-R-AS-R78                         VALUE '1'.
   980           88  CP-R-AS-PRORATA                     VALUE '2'.
   981           88  CP-R-AS-CALIF                       VALUE '3'.
   982           88  CP-R-AS-TEXAS                       VALUE '4'.
   983           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   984           88  CP-R-AS-NET-PAY                     VALUE '5'.
   985           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   986           88  CP-R-AS-MEAN                        VALUE '8'.
   987           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   988           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   989           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   990           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   991           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   992           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   993         16  FILLER                PIC X(12).
   994
   995***************    OUTPUT FROM ELEARN   *************************
   996
   997         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   998                                     COMP-3.
   999         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1000                                     COMP-3.
  1001         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1002                                     COMP-3.
  1003         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1004                                     COMP-3.
  1005         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1006                                     COMP-3.
  1007         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1008                                     COMP-3.
  1009         16  CP-EARNING-TYPE-USED  PIC X.
  1010           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1011           88  CP-E-AS-R78                         VALUE '1'.
  1012           88  CP-E-AS-PRORATA                     VALUE '2'.
  1013           88  CP-E-AS-TEXAS                       VALUE '4'.
  1014           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1015           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1016           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1017           88  CP-E-AS-MEAN                        VALUE '8'.
  1018           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1019         16  FILLER                PIC X(12).
  1020
  1021***************    OUTPUT FROM ELPMNT   *************************
  1022
  1023         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1024                                     COMP-3.
  1025         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  21
* ELRFND.cbl
  1026                                     COMP-3.
  1027         16  FILLER                PIC X(12).
  1028
  1029***************   MISC WORK AREAS    *****************************
  1030         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1031                                     COMP-3.
  1032         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1033                                     COMP-3.
  1034         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1035                                     COMP-3.
  1036         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1037                                     COMP-3.
  1038         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1039                                     COMP-3.
  1040         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1041                                     COMP-3.
  1042         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1043             88  OPEN-RATE-FILE                   VALUE 'O'.
  1044             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1045             88  IO-ERROR                         VALUE 'E'.
  1046
  1047         16  CP-FIRST-PAY-DATE     PIC XX.
  1048
  1049         16  CP-JOINT-INDICATOR    PIC X.
  1050
  1051         16  CP-RESERVE-REMAINING-TERM
  1052                                   PIC S9(4)V9    VALUE ZERO
  1053                                     COMP-3.
  1054
  1055         16  CP-INSURED-BIRTH-DT   PIC XX.
  1056
  1057         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1058                                     COMP-3.
  1059
  1060         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1061                                     COMP-3.
  1062
  1063         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1064                                     COMP-3.
  1065
  1066         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1067                                     COMP-3.
  1068
  1069         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1070                                     COMP-3.
  1071
  1072         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1073                                     COMP-3.
  1074
  1075         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1076                                     COMP-3.
  1077
  1078         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1079             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1080
  1081         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1082                                     COMP-3.
  1083         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  22
* ELRFND.cbl
  1084                                     COMP-3.
  1085         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1086         16  cp-extra-periods      pic 9 value zeros.
  1087         16  cp-net-only-state     pic x value spaces.
  1088         16  FILLER                PIC X(13).
  1089******************************************************************
  1090
  1091
  1092****************************************************************
  1093*
  1094* Copyright (c) 2007-2013 Dell Inc.
  1095* All rights reserved.
  1096*
  1097****************************************************************
  1098 01  DFHEIV.
  1099   02  DFHEIV0               PIC X(35).
  1100   02  DFHEIV1               PIC X(08).
  1101   02  DFHEIV2               PIC X(08).
  1102   02  DFHEIV3               PIC X(08).
  1103   02  DFHEIV4               PIC X(06).
  1104   02  DFHEIV5               PIC X(04).
  1105   02  DFHEIV6               PIC X(04).
  1106   02  DFHEIV7               PIC X(02).
  1107   02  DFHEIV8               PIC X(02).
  1108   02  DFHEIV9               PIC X(01).
  1109   02  DFHEIV10              PIC S9(7) COMP-3.
  1110   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1111   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1112   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1113   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1114   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1115   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1116   02  DFHEIV17              PIC X(04).
  1117   02  DFHEIV18              PIC X(04).
  1118   02  DFHEIV19              PIC X(04).
  1119   02  DFHEIV20              USAGE IS POINTER.
  1120   02  DFHEIV21              USAGE IS POINTER.
  1121   02  DFHEIV22              USAGE IS POINTER.
  1122   02  DFHEIV23              USAGE IS POINTER.
  1123   02  DFHEIV24              USAGE IS POINTER.
  1124   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1125   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1126   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1127   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1128   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1129   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1130   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1131   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1132   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1133   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1134   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1135   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1136   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1137   02  FILLER                PIC X(02).
  1138   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1139   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1140   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1141   02  DFHEIVL2              PIC X(48) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  23
* ELRFND.cbl
  1142   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1143   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1144   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1145 LINKAGE  SECTION.
  1146*****************************************************************
  1147*                                                               *
  1148* Copyright (c) 2007-2013 Dell Inc.                             *
  1149* All rights reserved.                                          *
  1150*                                                               *
  1151*****************************************************************
  1152 01  dfheiblk.
  1153     02  eibtime          pic s9(7) comp-3.
  1154     02  eibdate          pic s9(7) comp-3.
  1155     02  eibtrnid         pic x(4).
  1156     02  eibtaskn         pic s9(7) comp-3.
  1157     02  eibtrmid         pic x(4).
  1158     02  dfheigdi         pic s9(4) comp.
  1159     02  eibcposn         pic s9(4) comp.
  1160     02  eibcalen         pic s9(4) comp.
  1161     02  eibaid           pic x(1).
  1162     02  eibfiller1       pic x(1).
  1163     02  eibfn            pic x(2).
  1164     02  eibfiller2       pic x(2).
  1165     02  eibrcode         pic x(6).
  1166     02  eibfiller3       pic x(2).
  1167     02  eibds            pic x(8).
  1168     02  eibreqid         pic x(8).
  1169     02  eibrsrce         pic x(8).
  1170     02  eibsync          pic x(1).
  1171     02  eibfree          pic x(1).
  1172     02  eibrecv          pic x(1).
  1173     02  eibsend          pic x(1).
  1174     02  eibatt           pic x(1).
  1175     02  eibeoc           pic x(1).
  1176     02  eibfmh           pic x(1).
  1177     02  eibcompl         pic x(1).
  1178     02  eibsig           pic x(1).
  1179     02  eibconf          pic x(1).
  1180     02  eiberr           pic x(1).
  1181     02  eibrldbk         pic x(1).
  1182     02  eiberrcd         pic x(4).
  1183     02  eibsynrb         pic x(1).
  1184     02  eibnodat         pic x(1).
  1185     02  eibfiller5       pic x(2).
  1186     02  eibresp          pic s9(8) comp.
  1187     02  eibresp2         pic s9(8) comp.
  1188     02  dfheigdj         pic s9(4) comp.
  1189     02  dfheigdk         pic s9(4) comp.
  1190 01  DFHCOMMAREA                PIC X(450).
  1191
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  24
* ELRFND.cbl
  1193 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1194 0000-DFHEXIT SECTION.
  1195     MOVE '9#                    $   ' TO DFHEIV0.
  1196     MOVE 'ELRFND' TO DFHEIV1.
  1197     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1198     MOVE DFHCOMMAREA    TO  CALCULATION-PASS-AREA.
  1199
  1200 000-START-REFUND-CALC.
  1201*                      COPY ELCRFNDP.
  1202****************************************************************
  1203*                                                              *
  1204*                            ELCRFNDP.                         *
  1205*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1206*                            VMOD=2.028                        *
  1207*                                                              *
  1208****************************************************************.
  1209*                   C H A N G E   L O G
  1210*
  1211* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1212*-----------------------------------------------------------------
  1213*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1214* EFFECTIVE    NUMBER
  1215*-----------------------------------------------------------------
  1216* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1217* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1218* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1219* 110609  CR2009092300002  PEMA CHANGE MN REFUNDS
  1220* 000000  CR2008042200001  PEMA ADD 0 APR PROCESSING
  1221* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  1222* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1223* 032612  CR2011110200001  PEMA AHL CHANGES
  1224* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  1225* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1226* 011317  IR2017011000002  PEMA  REMOVE 'CT' HARDCODING
  1227* 071222  IR2022071200001  PEMA  Ref Rea of "R" s/b DCC only
  1228******************************************************************
  1229
  1230     MOVE ZERO                   TO  CP-RETURN-CODE
  1231                                     CP-CALC-REFUND.
  1232     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1233
  1234 0001-GET-CANCEL-TYPE.
  1235     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1236        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1237        GO TO 1999-CALC-REF-AMT-X.
  1238
  1239     IF (CP-CANCEL-REASON = 'R')
  1240        and (cp-company-id = 'DCC')
  1241        IF CP-CALC-CLP
  1242           MOVE CP-ORIGINAL-PREMIUM
  1243                                 TO CP-CALC-REFUND
  1244        ELSE
  1245           COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM -
  1246              CP-DDF-ADMIN-FEES
  1247        END-IF
  1248        MOVE 'R'                 TO CP-REFUND-TYPE-USED
  1249        GO TO 1999-CALC-REF-AMT-X
  1250     END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  25
* ELRFND.cbl
  1251     IF CP-REMAINING-TERM = ZERO   OR
  1252        CP-REMAINING-TERM NEGATIVE
  1253          MOVE ZERO TO CP-CALC-REFUND
  1254          GO TO 1999-CALC-REF-AMT-X.
  1255
  1256     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1257     MOVE SPACE              TO DC-OPTION-CODE.
  1258     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1259
  1260     IF DATE-CONVERSION-ERROR
  1261         MOVE '2' TO CP-RETURN-CODE
  1262         GO TO 1999-CALC-REF-AMT-X.
  1263
  1264     IF CP-AH
  1265        GO TO 1030-GET-AH-REFUND.
  1266
  1267********************    LIFE REFUNDS    **************************
  1268
  1269     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1270         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1271
  1272     IF CP-LOAN-TERM NOT NUMERIC
  1273         MOVE +0                TO CP-LOAN-TERM.
  1274
  1275     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1276
  1277     COMPUTE R78-FACTOR =
  1278            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1279              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1280************************************************************
  1281***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1282***---------------------------------------------------------
  1283     IF CP-TRUNCATED-LIFE
  1284        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1285     ELSE
  1286        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1287***
  1288************************************************************
  1289**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1290**** FOLLOWING.
  1291****       FOR NC. LIFE..
  1292****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1293****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1294****                             TERM <= 60 USE SUM OF DIGITS.
  1295****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1296****                             TERM > 60 USE RULE OF ANTIC
  1297****                             OTHERWISE USE RULE OF 78.
  1298****
  1299****
  1300
  1301     IF (CP-COMPANY-ID = 'NCL') AND
  1302        (CP-STATE-STD-ABBRV = 'NC')
  1303        IF CP-LEVEL-LIFE
  1304           GO TO 1023-REF-PR
  1305        ELSE
  1306        IF CP-EARN-AS-NET-PAY AND
  1307           CP-TRUNCATED-LIFE
  1308           IF CP-ORIGINAL-TERM GREATER THAN 60
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  26
* ELRFND.cbl
  1309              GO TO 1021-ANTICIPATION-REF
  1310           ELSE
  1311              GO TO 1026-REF-R78
  1312        ELSE
  1313        IF CP-REDUCING-LIFE
  1314           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
  1315              CP-ORIGINAL-TERM GREATER THAN 60)
  1316              GO TO 1021-ANTICIPATION-REF
  1317           ELSE
  1318              GO TO 1075-SUM-OF-DIGITS.
  1319
  1320****
  1321**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1322**** FOLLOWING.
  1323****       FOR OH. LIFE..
  1324****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1325****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1326****  GROSS DECREASING       --- RULE OF 78
  1327****
  1328****
  1329
  1330     IF (CP-COMPANY-ID = 'CID') AND
  1331        (CP-STATE-STD-ABBRV = 'OH') AND
  1332        (CP-CLASS-CODE NOT = 'L ')
  1333        IF CP-LEVEL-LIFE
  1334           GO TO 1023-REF-PR
  1335        ELSE
  1336           IF (CP-ORIGINAL-TERM > 60) OR
  1337              (CP-EARN-AS-NET-PAY)
  1338              GO TO 1028-NET-PAY-REFUND
  1339           ELSE
  1340              GO TO 1026-REF-R78
  1341           END-IF
  1342        END-IF
  1343     END-IF
  1344
  1345**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1346**** FOLLOWING.
  1347****       FOR VA. LIFE..
  1348****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1349****           NET COVERAGES --- USE RULE OF ANTIC.
  1350****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1351****                         --- EFF DATE > 123194 USE ANTIC.
  1352****                         --- EFF DATE BETWEEN 010193 AND 12319
  1353****                             WITH TERM > 61 USE RULE OF ANTIC
  1354****                             OTHERWISE USE RULE OF 78.
  1355****
  1356****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1357****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1358****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1359****            WILL FOLLOW.
  1360****
  1361****
  1362****
  1363
  1364     IF (CP-COMPANY-ID = 'NCL') AND
  1365        (CP-STATE-STD-ABBRV = 'VA')
  1366        IF CP-LEVEL-LIFE
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  27
* ELRFND.cbl
  1367           GO TO 1023-REF-PR
  1368        ELSE
  1369        IF CP-EARN-AS-NET-PAY
  1370           GO TO 1021-ANTICIPATION-REF
  1371        ELSE
  1372        IF CP-REDUCING-LIFE
  1373           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1374              GO TO 1026-REF-R78
  1375           ELSE
  1376           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1377              GO TO 1021-ANTICIPATION-REF
  1378           ELSE
  1379           IF CP-ORIGINAL-TERM GREATER THAN 61
  1380              GO TO 1021-ANTICIPATION-REF
  1381           ELSE
  1382              GO TO 1026-REF-R78.
  1383
  1384     IF (CP-COMPANY-ID = 'CID')
  1385        AND (CP-STATE-STD-ABBRV = 'IN')
  1386        AND (DC-GREG-DATE-CYMD < 20030401)
  1387        IF CP-REDUCING-LIFE
  1388           GO TO 1026-REF-R78
  1389        ELSE
  1390           IF CP-LEVEL-LIFE
  1391              GO TO 1023-REF-PR
  1392           END-IF
  1393        END-IF
  1394     END-IF
  1395
  1396     IF (CP-COMPANY-ID = 'CID')
  1397        AND (CP-STATE-STD-ABBRV = 'FL')
  1398        AND (DC-GREG-DATE-CYMD > 20030630)
  1399        IF CP-RATE-AS-NET-PAY
  1400           GO TO 1028-NET-PAY-REFUND
  1401        END-IF
  1402     END-IF
  1403
  1404     IF (CP-COMPANY-ID = 'CID')
  1405        AND (CP-STATE-STD-ABBRV = 'MN')
  1406        AND (CP-EARN-AS-NET-PAY)
  1407        AND (CP-RATE-AS-REG-BALLOON)
  1408        AND (DC-GREG-DATE-CYMD > 20091231)
  1409        GO TO 1028-NET-PAY-REFUND
  1410     END-IF
  1411     IF (CP-COMPANY-ID = 'CID')
  1412        AND (CP-STATE-STD-ABBRV = 'MN')
  1413        AND (DC-GREG-DATE-CYMD > 20091231)
  1414        AND (CP-RATE-AS-NET-PAY)
  1415        GO TO 1021-ANTICIPATION-REF
  1416     END-IF
  1417     IF (CP-COMPANY-ID = 'CID')
  1418        AND (CP-STATE-STD-ABBRV = 'MO')
  1419        AND (DC-GREG-DATE-CYMD > 20030630)
  1420        AND (CP-LOAN-TERM < +121)
  1421        IF CP-RATE-AS-NET-PAY
  1422           GO TO 1028-NET-PAY-REFUND
  1423        END-IF
  1424     END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  28
* ELRFND.cbl
  1425
  1426     IF (CP-COMPANY-ID = 'CID')
  1427        AND (CP-STATE-STD-ABBRV = 'ND')
  1428        AND (DC-GREG-DATE-CYMD > 20011231)
  1429        AND (CP-REDUCING-LIFE)
  1430        GO TO 1021-ANTICIPATION-REF
  1431     END-IF
  1432
  1433     IF CP-CRITICAL-PERIOD
  1434        IF CP-COMPANY-ID = 'NCL'
  1435           NEXT SENTENCE
  1436        ELSE
  1437           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1438
  1439     IF CP-TERM-IS-DAYS  AND
  1440        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1441         GO TO 1024-REF-PR-DAYS.
  1442
  1443     IF CP-STATE-STD-ABBRV = 'NM'
  1444       IF CP-REDUCING-LIFE
  1445*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1446         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1447             GO TO 1026-REF-R78.
  1448
  1449     IF CP-EARN-ANTICIPATION
  1450         GO TO 1021-ANTICIPATION-REF.
  1451
  1452     IF CP-STATE-STD-ABBRV = 'ME'
  1453         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1454            NEXT SENTENCE
  1455         ELSE
  1456            IF CP-REDUCING-LIFE
  1457               GO TO 1021-ANTICIPATION-REF.
  1458
  1459     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1460        IF CP-STATE-STD-ABBRV = 'TX'
  1461            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1462        END-IF
  1463     END-IF.
  1464
  1465     IF CP-STATE-STD-ABBRV = 'TX'
  1466       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1467          NEXT SENTENCE
  1468       END-IF
  1469        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1470           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1471           GO TO 1021-ANTICIPATION-REF.
  1472
  1473 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1474
  1475     IF CP-EARN-BY-PRORATA
  1476         GO TO 1023-REF-PR.
  1477
  1478     IF CP-EARN-AS-MEAN
  1479         GO TO 1025-REF-MEAN.
  1480
  1481     IF CP-EARN-AS-TEXAS
  1482         GO TO 1027-TEXAS-REFUND.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  29
* ELRFND.cbl
  1483
  1484     IF CP-EARN-AS-NET-PAY
  1485         GO TO 1028-NET-PAY-REFUND.
  1486
  1487     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1488         GO TO 1000-NO-NET-PAY.
  1489
  1490     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1491       IF CP-STATE-STD-ABBRV = 'NC'
  1492         IF CP-REDUCING-LIFE
  1493           IF CP-ORIGINAL-TERM GREATER 60  AND
  1494              DC-GREG-DATE-CYMD GREATER 19810930
  1495                GO TO 1028-NET-PAY-REFUND
  1496           ELSE
  1497              GO TO 1026-REF-R78.
  1498
  1499
  1500     IF CP-STATE-STD-ABBRV = 'NC'
  1501       IF CP-COMPANY-ID EQUAL 'NCL'
  1502          NEXT SENTENCE
  1503       END-IF
  1504       IF CP-REDUCING-LIFE
  1505         IF CP-ORIGINAL-TERM GREATER 60  AND
  1506            DC-GREG-DATE-CYMD GREATER 19810930
  1507             GO TO 1021-ANTICIPATION-REF
  1508         ELSE
  1509             GO TO 1026-REF-R78.
  1510
  1511     IF CP-STATE-STD-ABBRV = 'UT'
  1512       IF CP-COMPANY-ID EQUAL 'NCL'
  1513          NEXT SENTENCE
  1514       END-IF
  1515         IF CP-ORIGINAL-TERM GREATER 62         AND
  1516            CP-LOAN-APR GREATER ZERO            AND
  1517            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1518            DC-GREG-DATE-CYMD LESS    19830901
  1519             GO TO 1028-NET-PAY-REFUND
  1520         ELSE
  1521             GO TO 1026-REF-R78.
  1522
  1523     IF CP-STATE-STD-ABBRV = 'OH'
  1524       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1525          NEXT SENTENCE
  1526       END-IF
  1527           IF CP-ORIGINAL-TERM GREATER 60         AND
  1528              CP-CLASS-CODE NOT = 'L '            AND
  1529              CP-LOAN-APR GREATER ZERO            AND
  1530              DC-GREG-DATE-CYMD GREATER 19831031
  1531              GO TO 1028-NET-PAY-REFUND
  1532           ELSE
  1533              GO TO 1026-REF-R78.
  1534
  1535     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1536       IF CP-STATE-STD-ABBRV = 'MT'
  1537         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1538
  1539
  1540     IF CP-STATE-STD-ABBRV = 'MT'
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  30
* ELRFND.cbl
  1541       IF CP-COMPANY-ID EQUAL 'NCL'
  1542          NEXT SENTENCE
  1543       END-IF
  1544         IF CP-ORIGINAL-TERM GREATER 61         AND
  1545            CP-LOAN-APR GREATER ZERO            AND
  1546            DC-GREG-DATE-CYMD GREATER 19830318
  1547             GO TO 1028-NET-PAY-REFUND
  1548         ELSE
  1549             GO TO 1026-REF-R78.
  1550
  1551 SKIP-CSO-MT-LF-PROCESSING.
  1552
  1553     IF CP-STATE-STD-ABBRV = 'RI'
  1554       IF CP-COMPANY-ID EQUAL 'NCL'
  1555          NEXT SENTENCE
  1556       END-IF
  1557         IF CP-ORIGINAL-TERM GREATER 60         AND
  1558            CP-LOAN-APR GREATER ZERO            AND
  1559            DC-GREG-DATE-CYMD GREATER 19831231
  1560             GO TO 1028-NET-PAY-REFUND
  1561         ELSE
  1562             GO TO 1026-REF-R78.
  1563
  1564
  1565 1000-NO-NET-PAY.
  1566
  1567     IF CP-STATE-STD-ABBRV = 'WY'
  1568       IF CP-COMPANY-ID EQUAL 'NCL'
  1569          NEXT SENTENCE
  1570       END-IF
  1571        IF CP-COMPANY-ID = 'TMS'
  1572           GO TO 1026-REF-R78
  1573        ELSE
  1574           GO TO 1023-REF-PR.
  1575
  1576     IF CP-EARN-BY-R78
  1577         GO TO 1026-REF-R78.
  1578
  1579     IF CP-EARN-AS-SUM-OF-DIGITS
  1580         GO TO 1075-SUM-OF-DIGITS.
  1581
  1582     IF CP-LEVEL-LIFE
  1583         GO TO 1023-REF-PR
  1584     ELSE
  1585         GO TO 1026-REF-R78.
  1586
  1587*-----------------------------------------------------------------
  1588 1021-ANTICIPATION-REF.
  1589     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1590
  1591     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1592     IF CP-LOAN-TERM = ZEROS
  1593        MOVE CP-ORIGINAL-TERM TO CP-LOAN-TERM
  1594     END-IF
  1595     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1596                            CP-REMAINING-TERM.
  1597
  1598     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  31
* ELRFND.cbl
  1599     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
  1600     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
  1601     move cp-term-or-ext-days  to ws-save-ext-days
  1602
  1603     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
  1604     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
  1605     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
  1606
  1607     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1608         MOVE 'N'              TO CP-ROA-REFUND
  1609     ELSE
  1610         MOVE 'Y'              TO CP-ROA-REFUND.
  1611
  1612******    TO COMPUTE PREMIUM AT REFUND DATE
  1613     PERFORM 2500-GET-RATE.
  1614
  1615     MOVE 'N'                  TO CP-ROA-REFUND.
  1616     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1617     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1618     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
  1619     move ws-save-ext-days     to cp-term-or-ext-days
  1620
  1621     IF CP-PREMIUM-RATE = ZEROS
  1622        MOVE '7'                 TO CP-RETURN-CODE
  1623        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1624        GO TO 1999-CALC-REF-AMT-X.
  1625
  1626     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1627
  1628******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1629     PERFORM 2500-GET-RATE.
  1630
  1631     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1632
  1633     IF CP-PREMIUM-RATE = ZEROS
  1634        MOVE '7'            TO CP-RETURN-CODE
  1635        GO TO 1999-CALC-REF-AMT-X.
  1636
  1637     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1638
  1639     IF  WS-ORIG-PREM = ZEROS
  1640         MOVE ZEROS TO WS-NP-REF-FACTOR
  1641        ELSE
  1642         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1643                                            WS-ORIG-PREM.
  1644
  1645     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1646                                        CP-ORIGINAL-PREMIUM.
  1647
  1648     GO TO 1999-CALC-REF-AMT-X.
  1649
  1650*---------------------------------------------------------------
  1651 1022-REF-CRITICAL-PERIOD-LF.
  1652     GO TO 1023-REF-PR.
  1653
  1654*---------------------------------------------------------------
  1655 1023-REF-PR.
  1656     MOVE '2'               TO CP-REFUND-TYPE-USED.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  32
* ELRFND.cbl
  1657     COMPUTE CP-CALC-REFUND ROUNDED =
  1658            CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1659
  1660     GO TO 1999-CALC-REF-AMT-X.
  1661
  1662*---------------------------------------------------------------
  1663 1024-REF-PR-DAYS.
  1664     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1665     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1666     MOVE '1'                TO DC-OPTION-CODE.
  1667     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1668
  1669     IF DATE-CONVERSION-ERROR
  1670         MOVE '2' TO CP-RETURN-CODE
  1671         GO TO 1999-CALC-REF-AMT-X.
  1672
  1673     COMPUTE CP-CALC-REFUND ROUNDED =
  1674         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1675                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1676
  1677     GO TO 1999-CALC-REF-AMT-X.
  1678
  1679*---------------------------------------------------------------
  1680 1025-REF-MEAN.
  1681     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1682     COMPUTE CP-CALC-REFUND ROUNDED =
  1683          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1684           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1685
  1686     GO TO 1999-CALC-REF-AMT-X.
  1687
  1688*---------------------------------------------------------------
  1689 1026-REF-R78.
  1690     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1691*    IF CP-TERM-TIMES-TERM
  1692*        COMPUTE R78-FACTOR =
  1693*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1694*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1695*
  1696     COMPUTE CP-CALC-REFUND ROUNDED =
  1697        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1698
  1699     GO TO 1999-CALC-REF-AMT-X.
  1700
  1701*---------------------------------------------------------------
  1702 1027-TEXAS-REFUND.
  1703     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1704     IF CP-PAY-FREQUENCY = ZERO
  1705        MOVE ZERO TO CP-CALC-REFUND
  1706        MOVE '5'  TO CP-RETURN-CODE
  1707        GO TO 1999-CALC-REF-AMT-X.
  1708
  1709     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1710         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1711
  1712     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1713         GIVING TEX-FACT-5
  1714             REMAINDER TEX-FACT-6.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  33
* ELRFND.cbl
  1715
  1716     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1717
  1718     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1719         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1720         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1721
  1722     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1723
  1724     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1725                                        * TEX-FACT-8.
  1726
  1727     GO TO 1999-CALC-REF-AMT-X.
  1728
  1729*---------------------------------------------------------------
  1730 1028-NET-PAY-REFUND.
  1731     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1732     IF CP-LOAN-APR = ZERO
  1733        move '1'                 to cp-refund-type-used
  1734        compute cp-calc-refund rounded =
  1735           cp-original-premium * r78-factor
  1736        go to 1999-calc-ref-amt-x
  1737     end-if
  1738*       MOVE ZERO TO CP-CALC-REFUND
  1739*       MOVE '1'  TO CP-RETURN-CODE
  1740*       GO TO 1999-CALC-REF-AMT-X.
  1741
  1742     MOVE CP-LOAN-APR           TO N-P-APR.
  1743     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1744     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1745
  1746     IF CP-TRUNCATED-LIFE
  1747        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1748
  1749     MOVE 'R'                   TO N-P-OPT.
  1750
  1751     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1752
  1753     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1754                                        CP-ORIGINAL-PREMIUM.
  1755
  1756 1029-UTAH-REFUND.
  1757*
  1758*---------------------------------------------------------------
  1759* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1760*---------------------------------------------------------------
  1761*
  1762     GO TO 1999-CALC-REF-AMT-X.
  1763*
  1764*---------------------------------------------------------------
  1765     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1766                      OR
  1767        (CP-COMPANY-ID EQUAL 'NCL')
  1768         GO TO 1999-CALC-REF-AMT-X.
  1769     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1770
  1771     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1772        GREATER ZERO AND LESS 13
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  34
* ELRFND.cbl
  1773         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1774                 (CP-CALC-REFUND * .05).
  1775
  1776     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1777        GREATER 12 AND LESS 25
  1778         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1779                 (CP-CALC-REFUND * .025).
  1780
  1781     GO TO 1999-CALC-REF-AMT-X.
  1782*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  35
* ELRFND.cbl
  1784*---------------------------------------------------------------
  1785 1030-GET-AH-REFUND.
  1786     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1787
  1788     COMPUTE R78-FACTOR =
  1789            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1790                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1791
  1792*    IF CP-TERM-TIMES-TERM
  1793*        COMPUTE R78-FACTOR =
  1794*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1795*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1796*
  1797
  1798**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1799**** FOLLOWING.
  1800****       FOR VA. DISABILITY
  1801****                         --- EFF DATE > 123192 AND
  1802****                             TERM > 61 USE RULE OF ANTIC
  1803****                             OTHERWISE USE RULE OF 78.
  1804****
  1805****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1806****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1807****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1808****            WILL FOLLOW.
  1809****
  1810****
  1811****
  1812     IF CP-COMPANY-ID = 'NCL' or 'AHL'
  1813        IF CP-STATE-STD-ABBRV = 'VA'
  1814           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1815              (CP-ORIGINAL-TERM GREATER THAN 61)
  1816               MOVE '6'        TO CP-EARNING-METHOD
  1817               GO TO 1060-ANTICIPATION-REF
  1818            ELSE
  1819               MOVE '1'        TO CP-EARNING-METHOD
  1820               GO TO 1050-R78-REF.
  1821
  1822     IF CP-STATE-STD-ABBRV = 'WY'
  1823        IF CP-COMPANY-ID = 'TMS'
  1824           GO TO 1050-R78-REF.
  1825
  1826     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC'
  1827                     OR 'AHL' OR 'VPP'
  1828         NEXT SENTENCE
  1829     ELSE
  1830         IF CP-CRITICAL-PERIOD
  1831             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1832
  1833*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1834*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1835*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1836*    DAY FREE LOOK PERIOD. ALSO, 55 AND 56 ARE THE BIU CODES
  1837     IF (CP-GAP-NON-REFUNDABLE)
  1838        IF (CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM)
  1839           OR (CP-BENEFIT-CD = '55' OR '56')
  1840           MOVE ZEROS            TO CP-CALC-REFUND
  1841           MOVE 'G'              TO CP-REFUND-TYPE-USED
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  36
* ELRFND.cbl
  1842           GO TO 1999-CALC-REF-AMT-X
  1843        END-IF
  1844     END-IF
  1845     IF CP-GAP-ACTUARIAL
  1846         GO TO 1070-NET-PAY-REFUND
  1847     END-IF
  1848     IF (CP-COMPANY-ID = 'CID')
  1849        AND (CP-STATE-STD-ABBRV = 'MN')
  1850        AND (DC-GREG-DATE-CYMD > 20091231)
  1851        IF (CP-CRITICAL-PERIOD)
  1852           GO TO 1040-PR-REF
  1853        ELSE
  1854           GO TO 1055-MEAN-REF
  1855     END-IF
  1856     IF CP-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'VPP'
  1857        IF CP-STATE-STD-ABBRV = 'NC'
  1858           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1859
  1860     IF (CP-COMPANY-ID = 'CID')
  1861        AND (CP-STATE-STD-ABBRV = 'IN')
  1862        AND (DC-GREG-DATE-CYMD < 20030401)
  1863        GO TO 1026-REF-R78
  1864     END-IF
  1865
  1866     IF (CP-COMPANY-ID = 'CID')
  1867        AND (CP-STATE-STD-ABBRV = 'FL')
  1868        AND (DC-GREG-DATE-CYMD > 20030630)
  1869        AND (CP-CRITICAL-PERIOD)
  1870        GO TO 1040-PR-REF
  1871     END-IF
  1872
  1873     IF (CP-COMPANY-ID = 'CID')
  1874        AND (CP-STATE-STD-ABBRV = 'MO')
  1875        AND (DC-GREG-DATE-CYMD > 20030630)
  1876        AND (CP-CRITICAL-PERIOD)
  1877        GO TO 1040-PR-REF
  1878     END-IF
  1879
  1880     IF (CP-COMPANY-ID = 'CID')
  1881        AND (CP-STATE-STD-ABBRV = 'ND')
  1882        AND (CP-CRITICAL-PERIOD)
  1883        AND (DC-GREG-DATE-CYMD > 20011231)
  1884        GO TO 1040-PR-REF
  1885     END-IF
  1886
  1887     IF (CP-COMPANY-ID = 'CID')
  1888        AND (CP-STATE-STD-ABBRV = 'ND')
  1889        AND (DC-GREG-DATE-CYMD > 20011231)
  1890        GO TO 1060-ANTICIPATION-REF
  1891     END-IF
  1892
  1893     IF CP-STATE-STD-ABBRV = 'NC'
  1894       IF CP-COMPANY-ID = 'NCL' OR 'NCB'
  1895          NEXT SENTENCE
  1896       END-IF
  1897         IF DC-GREG-DATE-CYMD GREATER 19810930
  1898            IF CP-EARN-ANTICIPATION
  1899                GO TO 1060-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  37
* ELRFND.cbl
  1900            ELSE
  1901                GO TO 1055-MEAN-REF.
  1902
  1903 SKIP-CSO-NC-AH-PROCESSING.
  1904
  1905     IF CP-STATE-STD-ABBRV = 'NM'
  1906       IF CP-COMPANY-ID = 'NCL' OR 'DCC' OR 'AHL' OR 'VPP'
  1907          NEXT SENTENCE
  1908       END-IF
  1909         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1910            IF CP-COMPANY-ID = 'MON'
  1911              MOVE '6'             TO CP-EARNING-METHOD
  1912              GO TO 1060-ANTICIPATION-REF
  1913             ELSE
  1914              GO TO 1055-MEAN-REF.
  1915
  1916*    IF CP-STATE-STD-ABBRV = 'CT'
  1917*      IF CP-COMPANY-ID EQUAL 'NCL' OR 'DCC' OR 'VPP'
  1918*         NEXT SENTENCE
  1919*      END-IF
  1920*         MOVE '6'              TO CP-EARNING-METHOD
  1921*         GO TO 1060-ANTICIPATION-REF.
  1922
  1923     IF CP-STATE-STD-ABBRV = 'ME'
  1924       IF CP-COMPANY-ID = 'NCL' OR 'CVL' OR 'DCC' OR 'VPP'
  1925          NEXT SENTENCE
  1926       END-IF
  1927           IF CP-EARN-BY-PRORATA
  1928              GO TO 1040-PR-REF
  1929           ELSE
  1930              MOVE '6'           TO CP-EARNING-METHOD
  1931              GO TO 1060-ANTICIPATION-REF.
  1932
  1933
  1934     IF CP-COMPANY-ID = 'CID' OR 'DCC' OR 'VPP'
  1935        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1936            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1937
  1938     IF CP-STATE-STD-ABBRV = 'TX'
  1939       IF CP-COMPANY-ID = 'NCL' OR 'HER'
  1940          NEXT SENTENCE
  1941       END-IF
  1942        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1943           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1944           MOVE '6'              TO CP-EARNING-METHOD
  1945           GO TO 1060-ANTICIPATION-REF.
  1946
  1947     IF CP-STATE-STD-ABBRV = 'VA'
  1948       IF CP-COMPANY-ID EQUAL 'NCL'
  1949          NEXT SENTENCE
  1950       END-IF
  1951       IF CP-COMPANY-ID = 'NCB'
  1952           MOVE '6'                TO CP-EARNING-METHOD
  1953           GO TO 1060-ANTICIPATION-REF
  1954       ELSE
  1955           IF DC-GREG-DATE-CYMD GREATER 19921231
  1956               IF CP-ORIGINAL-TERM GREATER THAN 61
  1957                   MOVE '6'        TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  38
* ELRFND.cbl
  1958                   GO TO 1060-ANTICIPATION-REF
  1959               ELSE
  1960                   MOVE '1'        TO CP-EARNING-METHOD
  1961                   GO TO 1050-R78-REF.
  1962
  1963 SKIP-CSO-TX-VA-AH-PROCESSING.
  1964
  1965     IF CP-EARN-BY-PRORATA
  1966         GO TO 1040-PR-REF.
  1967
  1968     IF CP-EARN-BY-R78
  1969         GO TO 1050-R78-REF.
  1970
  1971     IF CP-EARN-AS-MEAN
  1972        GO TO 1055-MEAN-REF.
  1973
  1974     IF CP-EARN-AS-SUM-OF-DIGITS
  1975         GO TO 1075-SUM-OF-DIGITS.
  1976     IF CP-DCC-SPP-DDF
  1977        GO TO 1080-DCC-DDF-SPECIAL
  1978     END-IF
  1979     IF CP-EARN-AS-CALIF
  1980         GO TO 1060-ANTICIPATION-REF.
  1981
  1982     IF CP-EARN-ANTICIPATION
  1983         GO TO 1060-ANTICIPATION-REF.
  1984
  1985     IF CP-EARN-AS-NET-PAY
  1986         GO TO 1070-NET-PAY-REFUND.
  1987
  1988     GO TO 1050-R78-REF.
  1989
  1990*---------------------------------------------------------------
  1991 1035-REF-AH-CRITICAL-PERIOD.
  1992     IF CP-REMAINING-TERM GREATER +6
  1993        COMPUTE CP-CALC-REFUND ROUNDED =
  1994          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1995                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1996      ELSE
  1997        COMPUTE CP-CALC-REFUND ROUNDED =
  1998          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1999                                           CP-REMAINING-TERM + 1)
  2000                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  2001
  2002     IF CP-CALC-REFUND LESS ZERO
  2003         MOVE ZERO TO CP-CALC-REFUND.
  2004
  2005     GO TO 1999-CALC-REF-AMT-X.
  2006
  2007*---------------------------------------------------------------
  2008 1040-PR-REF.
  2009     MOVE '2'               TO CP-REFUND-TYPE-USED.
  2010     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  2011
  2012     GO TO 1999-CALC-REF-AMT-X.
  2013
  2014*---------------------------------------------------------------
  2015 1050-R78-REF.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  39
* ELRFND.cbl
  2016     MOVE '1'               TO CP-REFUND-TYPE-USED.
  2017     COMPUTE CP-CALC-REFUND ROUNDED =
  2018           CP-ORIGINAL-PREMIUM * R78-FACTOR.
  2019
  2020     GO TO 1999-CALC-REF-AMT-X.
  2021
  2022*---------------------------------------------------------------
  2023 1055-MEAN-REF.
  2024     MOVE '8'               TO CP-REFUND-TYPE-USED.
  2025     COMPUTE CP-CALC-REFUND ROUNDED =
  2026         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  2027          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  2028
  2029     GO TO 1999-CALC-REF-AMT-X.
  2030
  2031*---------------------------------------------------------------
  2032 1060-ANTICIPATION-REF.
  2033     MOVE '6'               TO CP-REFUND-TYPE-USED.
  2034
  2035     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  2036     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  2037     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  2038
  2039     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  2040                               CP-LOAN-TERM.
  2041     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  2042
  2043     PERFORM 2500-GET-RATE.
  2044
  2045     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  2046     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  2047
  2048     IF CP-PREMIUM-RATE = ZEROS
  2049        MOVE '7'                 TO CP-RETURN-CODE
  2050        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  2051        GO TO 1999-CALC-REF-AMT-X.
  2052
  2053     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  2054
  2055     PERFORM 2500-GET-RATE.
  2056
  2057     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  2058
  2059     IF CP-PREMIUM-RATE = ZEROS
  2060        MOVE '7'            TO CP-RETURN-CODE
  2061        GO TO 1999-CALC-REF-AMT-X.
  2062
  2063     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  2064
  2065     IF  WS-ORIG-PREM = ZERO
  2066         MOVE ZERO                TO WS-NP-REF-FACTOR
  2067        ELSE
  2068         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  2069                                            WS-ORIG-PREM.
  2070
  2071     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  2072                                        CP-ORIGINAL-PREMIUM.
  2073
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  40
* ELRFND.cbl
  2074     IF NOT CP-EARN-AS-CALIF
  2075         GO TO 1999-CALC-REF-AMT-X.
  2076
  2077*---------------------------------------------------------------
  2078 1065-CALIF-REGS.
  2079     MOVE '3'               TO CP-REFUND-TYPE-USED.
  2080     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2081         GIVING FACTOR-5.
  2082
  2083     IF FACTOR-5 NOT GREATER +6  AND
  2084        CP-CLASS-CODE = 'A '
  2085         GO TO 1050-R78-REF.
  2086
  2087     IF FACTOR-5 = ZERO
  2088         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  2089         GO TO 1999-CALC-REF-AMT-X.
  2090
  2091     IF CP-ORIGINAL-TERM LESS +014
  2092         GO TO 1999-CALC-REF-AMT-X.
  2093
  2094     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  2095                                   GIVING FACTOR-5 ROUNDED.
  2096
  2097     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  2098
  2099     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  2100                                   GIVING FACTOR-2 ROUNDED.
  2101
  2102     SUBTRACT FACTOR-2 FROM FACTOR-1.
  2103     ADD +0.099375 TO FACTOR-1.
  2104
  2105     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2106                                   GIVING FACTOR-5 ROUNDED.
  2107
  2108     SUBTRACT +1.00 FROM FACTOR-5.
  2109
  2110     IF CP-ORIGINAL-TERM LESS +049
  2111         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  2112                                   GIVING FACTOR-6 ROUNDED
  2113     ELSE
  2114         MOVE +035 TO FACTOR-6.
  2115
  2116     MOVE +001 TO FACTOR-2.
  2117
  2118     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  2119     SUBTRACT FACTOR-4 FROM FACTOR-2.
  2120     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  2121     MOVE +001 TO FACTOR-2.
  2122     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  2123
  2124     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
  2125         GIVING CAL-RFND ROUNDED.
  2126
  2127     IF CAL-RFND LESS +0.01
  2128         MOVE ZEROS TO CAL-RFND.
  2129
  2130     IF CAL-RFND LESS CP-CALC-REFUND
  2131         MOVE CAL-RFND TO CP-CALC-REFUND.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  41
* ELRFND.cbl
  2132
  2133     GO TO 1999-CALC-REF-AMT-X.
  2134
  2135*-----------------------------------------------------------------
  2136 1070-NET-PAY-REFUND.
  2137     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  2138     IF CP-LOAN-APR = ZERO
  2139         MOVE ZEROS              TO  CP-CALC-REFUND
  2140         MOVE '1'                TO  CP-RETURN-CODE
  2141         GO TO 1999-CALC-REF-AMT-X.
  2142
  2143     MOVE CP-LOAN-APR            TO  N-P-APR.
  2144     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  2145     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  2146
  2147     MOVE 'R'                    TO  N-P-OPT.
  2148
  2149     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2150
  2151     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  2152                                        CP-ORIGINAL-PREMIUM.
  2153
  2154     GO TO 1999-CALC-REF-AMT-X.
  2155*---------------------------------------------------------------
  2156
  2157 1075-SUM-OF-DIGITS.
  2158
  2159     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2160
  2161     COMPUTE RSUM-REMAINING-TERM =
  2162             CP-LOAN-TERM -
  2163                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2164
  2165     COMPUTE RSUM-FACTOR =
  2166        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2167               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2168                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2169            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2170               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2171                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2172
  2173     COMPUTE CP-CALC-REFUND ROUNDED =
  2174           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2175
  2176     GO TO 1999-CALC-REF-AMT-X
  2177     .
  2178 1080-DCC-DDF-SPECIAL.
  2179     COMPUTE CP-MONTH =
  2180        FUNCTION REM(CP-ORIGINAL-TERM - CP-REMAINING-TERM, 12)
  2181*    DISPLAY ' SPEC       ' CP-DDF-SPEC-CALC
  2182*    DISPLAY ' MONTH      ' CP-MONTH
  2183*    DISPLAY ' ORIG TERM  ' CP-ORIGINAL-TERM
  2184*    DISPLAY ' REM TERM   ' CP-REMAINING-TERM
  2185*    DISPLAY ' ORIG PREM  ' CP-ORIGINAL-PREMIUM
  2186*    DISPLAY ' 1YR EXP AL ' CP-1ST-YR-ALLOW
  2187*    DISPLAY ' HI FACT    ' CP-DDF-HI-FACT
  2188*    DISPLAY ' LO FACT    ' CP-DDF-LO-FACT
  2189*    DISPLAY ' RATE UP    ' CP-IU-RATE-UP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  42
* ELRFND.cbl
  2190*    DISPLAY ' CLP RAT UP ' CP-CLP-RATE-UP
  2191*    DISPLAY ' EARM METH  ' CP-EARNING-METHOD
  2192     IF CP-MONTH = 0
  2193        MOVE 12                  TO CP-MONTH
  2194     END-IF
  2195     MOVE CP-MONTH               TO WS-MONTH
  2196     MOVE 'D'                    TO CP-REFUND-TYPE-USED
  2197     IF CP-DCC-SPP-DDF-IU
  2198        GO TO 1090-DCC-DDF-IU
  2199     END-IF
  2200     IF CP-CALC-CLP
  2201        GO TO 1085-DCC-DDF-SPECIAL-CLP
  2202     END-IF
  2203     EVALUATE TRUE
  2204        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2205           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2206           MOVE CP-ORIGINAL-PREMIUM
  2207                                 TO CP-CALC-REFUND
  2208        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2209           MOVE CP-MONTH         TO WS-MONTH
  2210           PERFORM 1150-UE-GROSS-LT-4
  2211           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2212        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2213           MOVE CP-MONTH         TO WS-MONTH
  2214           PERFORM 1160-UE-GROSS-LT-13
  2215           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2216        WHEN OTHER
  2217           MOVE CP-MONTH         TO WS-MONTH
  2218           PERFORM 1170-UE-GROSS-GT-12
  2219           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2220     END-EVALUATE
  2221     GO TO 1999-CALC-REF-AMT-X
  2222     .
  2223 1085-DCC-DDF-SPECIAL-CLP.
  2224     EVALUATE TRUE
  2225        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2226           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2227           MOVE CP-ORIGINAL-PREMIUM
  2228                                 TO CP-CALC-REFUND
  2229        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2230           MOVE CP-MONTH         TO WS-MONTH
  2231           PERFORM 1100-UE-CLP-LT-4
  2232           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2233        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2234           MOVE CP-MONTH         TO WS-MONTH
  2235           PERFORM 1110-UE-CLP-LT-13
  2236           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2237        WHEN OTHER
  2238           MOVE CP-MONTH         TO WS-MONTH
  2239           PERFORM 1120-UE-CLP-GT-12
  2240           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2241     END-EVALUATE
  2242     GO TO 1999-CALC-REF-AMT-X
  2243     .
  2244 1090-DCC-DDF-IU.
  2245     MOVE 'I'                    TO CP-REFUND-TYPE-USED
  2246     IF CP-CALC-CLP
  2247        GO TO 1095-DCC-DDF-IU-SPECIAL-CLP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  43
* ELRFND.cbl
  2248     END-IF
  2249     EVALUATE TRUE
  2250        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2251           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2252           MOVE CP-ORIGINAL-PREMIUM
  2253                                 TO CP-CALC-REFUND
  2254        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2255           MOVE CP-MONTH         TO WS-MONTH
  2256           PERFORM 1250-IU-UE-GROSS-LT-4
  2257           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2258        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2259           MOVE CP-MONTH         TO WS-MONTH
  2260           PERFORM 1260-IU-UE-GROSS-LT-13
  2261           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2262        WHEN OTHER
  2263           MOVE CP-MONTH         TO WS-MONTH
  2264           PERFORM 1270-IU-UE-GROSS-GT-12
  2265           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2266     END-EVALUATE
  2267     GO TO 1999-CALC-REF-AMT-X
  2268     .
  2269 1095-DCC-DDF-IU-SPECIAL-CLP.
  2270     EVALUATE TRUE
  2271        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2272           OR (CP-DDF-CLP = ZEROS)
  2273           MOVE CP-DDF-CLP       TO CP-CALC-REFUND
  2274        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2275           MOVE CP-MONTH         TO WS-MONTH
  2276           PERFORM 1200-IU-UE-CLP-LT-4
  2277           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2278        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2279           MOVE CP-MONTH         TO WS-MONTH
  2280           PERFORM 1210-IU-UE-CLP-LT-13
  2281           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2282        WHEN OTHER
  2283           MOVE CP-MONTH         TO WS-MONTH
  2284           PERFORM 1220-IU-UE-CLP-GT-12
  2285           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2286     END-EVALUATE
  2287     GO TO 1999-CALC-REF-AMT-X
  2288     .
  2289 1100-UE-CLP-LT-4.
  2290*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*mo/12}
  2291     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2292        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2293        / CP-DDF-CLP - CP-DDF-HI-FACT)
  2294        * WS-MONTH / 12)
  2295     .
  2296 1110-UE-CLP-LT-13.
  2297*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12}
  2298*****  -[(CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12
  2299*****  -CLP*UEF1}*(mo-3)/9]
  2300     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2301        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2302        / CP-DDF-CLP - CP-DDF-HI-FACT) * 3 / 12)
  2303        -  ((CP-DDF-CLP - 0) - CP-DDF-CLP
  2304        * (((CP-DDF-CLP - 0) / CP-DDF-CLP
  2305        - CP-DDF-HI-FACT) * 3 / 12) - CP-DDF-CLP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  44
* ELRFND.cbl
  2306        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2307     .
  2308 1120-UE-CLP-GT-12.
  2309*****  CLP * {UEF1 - (UEF1 -UEF2)*mo/12}
  2310     COMPUTE WS-TEMP-RESULT ROUNDED = CP-DDF-CLP *
  2311        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2312        * WS-MONTH / 12)
  2313     .
  2314 1150-UE-GROSS-LT-4.
  2315     COMPUTE CP-1ST-YR-ALLOW = CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2316     COMPUTE WS-TEMP-RESULT ROUNDED =
  2317        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2318        * WS-MONTH / 3) - (CP-ORIGINAL-PREMIUM -
  2319        CP-1ST-YR-ALLOW - CP-DDF-YR1AF) * (1 - CP-DDF-HI-FACT)
  2320        * WS-MONTH / 12
  2321     .
  2322 1160-UE-GROSS-LT-13.
  2323     MOVE 3                      TO WS-MONTH
  2324     PERFORM 1150-UE-GROSS-LT-4
  2325     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2326     MOVE CP-MONTH               TO WS-MONTH
  2327     COMPUTE WS-TEMP-RESULT ROUNDED = WS-GFR3 - (WS-GFR3
  2328        - (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF)
  2329        * (CP-DDF-HI-FACT)) * ((WS-MONTH - 3) / 9)
  2330     .
  2331 1170-UE-GROSS-GT-12.
  2332*****  (GF-Yr1 Texp) * {UEF1 - (UEF1 -UEF2)*mo/12}
  2333     COMPUTE WS-TEMP-RESULT ROUNDED =
  2334        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW)
  2335        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2336        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2337     .
  2338 1200-IU-UE-CLP-LT-4.
  2339*****  no changes with < 4  pema 08/03/11
  2340*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*mo/12)
  2341     COMPUTE WS-TEMP-RESULT ROUNDED =
  2342        (CP-DDF-CLP - 0)
  2343        - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2344        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2345        * WS-MONTH / 12
  2346     .
  2347 1210-IU-UE-CLP-LT-13.
  2348*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2349*****  -[(CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2350*****  - CLP*UEF1]*(mo-3)/9
  2351     MOVE 3                      TO WS-MONTH
  2352     PERFORM 1200-IU-UE-CLP-LT-4
  2353     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2354     MOVE CP-MONTH               TO WS-MONTH
  2355     COMPUTE WS-TEMP-RESULT ROUNDED =
  2356        WS-UE-CLP - (WS-UE-CLP - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2357          * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2358     .
  2359 1220-IU-UE-CLP-GT-12.
  2360*****  CLP*{UEF1 - (UEF1 -UEF2)*mo/12}
  2361     COMPUTE WS-TEMP-RESULT ROUNDED =
  2362        (CP-DDF-CLP - CP-CLP-RATE-UP)
  2363        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  45
* ELRFND.cbl
  2364        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2365     .
  2366 1250-IU-UE-GROSS-LT-4.
  2367*****  (Comm+MngtFee)*UECLPmo/CLPCounty+CLPCounty+AdminFee-
  2368*****  Yr1 AF*(mo/3)-[CLP*(UEF1-UEF2)+(AdminFee-Yr1AF)*
  2369*****  (1-UEF1)]*mo/12
  2370     PERFORM 1200-IU-UE-CLP-LT-4
  2371     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2372     COMPUTE WS-TEMP-RESULT = CP-DDF-COMM-AND-MFEE *
  2373        WS-UE-CLP / CP-DDF-CLP + CP-DDF-CLP +
  2374        CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF *
  2375        WS-MONTH / 3 - ((CP-DDF-CLP - CP-CLP-RATE-UP)
  2376        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2377        + (CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF)
  2378        * (1 - CP-DDF-HI-FACT)) * WS-MONTH / 12
  2379     .
  2380 1260-IU-UE-GROSS-LT-13.
  2381***** uegf3-(uegf3-(gf - 1st yr - clprateu)*hi))*(mo-3)/9
  2382     MOVE 3                      TO WS-MONTH
  2383     PERFORM 1250-IU-UE-GROSS-LT-4
  2384     move cp-month               to ws-month
  2385     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2386     COMPUTE WS-TEMP-RESULT ROUNDED =
  2387        WS-GFR3 - (WS-GFR3 - ((CP-ORIGINAL-PREMIUM
  2388        - CP-1ST-YR-ALLOW - cp-clp-rate-up))
  2389        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2390     .
  2391 1270-IU-UE-GROSS-GT-12.
  2392***** (gf - 1st yr - clprateu)*(hi-(hi-lo)*mo/12)
  2393     COMPUTE WS-TEMP-RESULT ROUNDED =
  2394        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW
  2395        - CP-CLP-RATE-UP) *
  2396        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2397        * WS-MONTH / 12)
  2398     .
  2399 1299-END-DDF-CALCS.
  2400     .
  2401 1999-CALC-REF-AMT-X.
  2402
  2403     MOVE CALCULATION-PASS-AREA TO DFHCOMMAREA.
  2404
  2405
  2406* EXEC CICS RETURN
  2407*    END-EXEC.
  2408*    MOVE '.(                    ''   #00002403' TO DFHEIV0
  2409     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2410     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2411     MOVE X'2020233030303032343033' TO DFHEIV0(25:11)
  2412     CALL 'kxdfhei1' USING DFHEIV0,
  2413           DFHEIV99,
  2414           DFHEIV99,
  2415           DFHEIV99,
  2416           DFHEIV99,
  2417           DFHEIV99,
  2418           DFHEIV99
  2419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2420
  2421
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  46
* ELRFND.cbl
  2422* GOBACK.
  2423     MOVE '9%                    "   ' TO DFHEIV0
  2424     MOVE 'ELRFND' TO DFHEIV1
  2425     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2426     GOBACK.
  2427
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  47
* ELRFND.cbl
  2429  2500-GET-RATE.
  2430
  2431* EXEC CICS LINK
  2432*        PROGRAM    ('ELRATE')
  2433*        COMMAREA   (CALCULATION-PASS-AREA)
  2434*        LENGTH     (CP-COMM-LENGTH)
  2435*        END-EXEC.
  2436     MOVE 'ELRATE' TO DFHEIV1
  2437*    MOVE '."C                   (   #00002409' TO DFHEIV0
  2438     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2439     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2440     MOVE X'2020233030303032343039' TO DFHEIV0(25:11)
  2441     CALL 'kxdfhei1' USING DFHEIV0,
  2442           DFHEIV1,
  2443           CALCULATION-PASS-AREA,
  2444           CP-COMM-LENGTH,
  2445           DFHEIV99,
  2446           DFHEIV99,
  2447           DFHEIV99,
  2448           DFHEIV99
  2449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2450
  2451
  2452  2500-EXIT.
  2453       EXIT.
  2454
  2455  9100-CONVERT-DATE.
  2456
  2457* EXEC CICS LINK
  2458*         PROGRAM   ('ELDATCV')
  2459*         COMMAREA  (DATE-CONVERSION-DATA)
  2460*         LENGTH    (DC-COMM-LENGTH)
  2461*    END-EXEC.
  2462     MOVE 'ELDATCV' TO DFHEIV1
  2463*    MOVE '."C                   (   #00002419' TO DFHEIV0
  2464     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2465     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2466     MOVE X'2020233030303032343139' TO DFHEIV0(25:11)
  2467     CALL 'kxdfhei1' USING DFHEIV0,
  2468           DFHEIV1,
  2469           DATE-CONVERSION-DATA,
  2470           DC-COMM-LENGTH,
  2471           DFHEIV99,
  2472           DFHEIV99,
  2473           DFHEIV99,
  2474           DFHEIV99
  2475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2476
  2477
  2478  9100-EXIT.
  2479       EXIT.
  2480
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  48
* ELRFND.cbl
  2482  10000-NET-TERM  SECTION.
  2483*                      COPY ERCNETP.
  2484*****************************************************************
  2485*                                                               *
  2486*                            ERCNETP                            *
  2487*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2488*                            VMOD=2.029                         *
  2489*                                                               *
  2490*****************************************************************.
  2491*
  2492*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  2493*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  2494*                                   ORIGINAL TERM (S999)
  2495*                                   REMAINING TERM (S999)
  2496*                                   NET PAY OPTION (X)
  2497*                                   LOAN TERM (S999)
  2498*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  2499*
  2500*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  2501*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  2502*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  2503*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  2504*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  2505*    CHARGED.
  2506*
  2507*    OPTIONS - S = NET SIMPLE
  2508*          SPACE = NET PAY  (1 MO. INTEREST)
  2509*              A = NET PAY  (0 MO. INTEREST)
  2510*              I = NET PAY  (2 MO. INTEREST)
  2511*              J = NET PAY  (3 MO. INTEREST)
  2512*              K = NET PAY  (4 MO. INTEREST)
  2513*              T = TRUNCATED  (0 MO. INTEREST)
  2514*              U = TRUNCATED  (1 MO. INTEREST)
  2515*              V = TRUNCATED  (2 MO. INTEREST)
  2516*              W = TRUNCATED  (3 MO. INTEREST)
  2517*              X = TRUNCATED  (4 MO. INTEREST)
  2518*              R = REFUNDS (REGULAR OR TRUNCATED)
  2519******************************************************************
  2520*                   C H A N G E   L O G
  2521*
  2522* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2523*-----------------------------------------------------------------
  2524*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2525* EFFECTIVE    NUMBER
  2526*-----------------------------------------------------------------
  2527* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2528* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2529* 120403                   PEMA  ADD SPECIAL TX CALC
  2530* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2531* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2532* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2533* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2534* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2535* 021207                   PEMA  ADD PA NP
  2536* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2537* 032807                   PEMA  ADD VT NP PLUS 2
  2538* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2539* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  49
* ELRFND.cbl
  2540* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2541* 110207      TO 'AL' NET PAY CALC
  2542* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2543* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2544* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2545* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2546* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2547* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2548* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2549* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2550* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2551* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2552* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  2553* 032612  CR2011110200001  PEMA  AHL CHANGES
  2554* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  2555* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  2556* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  2557* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  2558* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOON
  2559* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2560* 021519  CR2019021100001  PEMA  non-monthly AL calcs
  2561* 012820  CR2020010600001  PEMA  MOD TX NP FORMULA TO HANDLE TRUNC
  2562* 012820    CONTINUED   AND TO ADJ AF FOR EXTRA DAYS.
  2563******************************************************************
  2564
  2565     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  2566     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  2567     MOVE N-P-LOAN    TO LOAN-TERM.
  2568     MOVE N-P-REM     TO REMAINING-TERM.
  2569     MOVE N-P-OPT     TO OPTION-SW.
  2570
  2571     MOVE +0 TO FACTOR.
  2572     if cp-company-id = 'CID'
  2573        if annual-int-rate = +99.9999
  2574           go to 99000-error
  2575        end-if
  2576     else
  2577        if annual-int-rate = zero
  2578           go to 99000-error
  2579        end-if
  2580     end-if
  2581     IF ORIGINAL-TERM = ZERO
  2582         GO TO 99999-RETURN.
  2583     IF REMAINING-TERM = ZERO
  2584         GO TO 99999-RETURN.
  2585     IF REMAINING-TERM GREATER ORIGINAL-TERM
  2586         GO TO 99000-ERROR.
  2587     IF LOAN-TERM = ZERO
  2588         GO TO 99999-RETURN.
  2589     IF LOAN-TERM LESS ORIGINAL-TERM
  2590         GO TO 99000-ERROR.
  2591
  2592*    IF ANNUAL-INT-RATE LESS +2
  2593*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2594*    IF ANNUAL-INT-RATE LESS +2
  2595*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2596*    IF ANNUAL-INT-RATE LESS +2
  2597*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  50
* ELRFND.cbl
  2598
  2599     IF NPO-REFUND
  2600         MOVE '2' TO NP-PROCESS-SW
  2601       ELSE
  2602         IF ORIGINAL-TERM = REMAINING-TERM
  2603            MOVE '1'   TO NP-PROCESS-SW
  2604           ELSE
  2605            MOVE '3'   TO NP-PROCESS-SW.
  2606
  2607     IF NPO-SIMPLE
  2608         MOVE 'S' TO TYPE-SW
  2609     ELSE
  2610         MOVE 'N' TO TYPE-SW.
  2611
  2612     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  2613     if i = zeros
  2614        move .0000000001         to i
  2615     end-if
  2616
  2617     COMPUTE V ROUNDED = K1 / (K1 + I).
  2618
  2619     MOVE V     TO VX
  2620                   SV.
  2621
  2622     MOVE +1    TO X1
  2623                   SX.
  2624
  2625     MOVE LOAN-TERM TO MAX-X.
  2626
  2627     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  2628
  2629     IF MAX-X = +1
  2630        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  2631
  2632     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  2633
  2634     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  2635         OR 'DCC' or 'VPP' OR 'NCL') AND
  2636        (NOT NP-REFUND)
  2637        NEXT SENTENCE
  2638     ELSE
  2639     IF LOAN-TERM NOT = ORIGINAL-TERM
  2640        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  2641
  2642     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  2643
  2644 10500-VX-LOOP.
  2645
  2646***  VX = AMORT. LOAN TERM.
  2647***  SV = AMORT. INSURANCE TERM.
  2648***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  2649***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  2650***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  2651
  2652     IF X2 = 1
  2653        MOVE V         TO SX
  2654     END-IF
  2655     COMPUTE VX ROUNDED = VX * V.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  51
* ELRFND.cbl
  2656
  2657     ADD B1 TO X1.
  2658
  2659     IF X1 = REMAINING-TERM
  2660          MOVE VX    TO SV.
  2661
  2662     IF X1 EQUAL SV-MINUS-ONE
  2663        MOVE VX      TO SV-MINUS-ONE.
  2664
  2665     IF X1 = X2
  2666          MOVE VX    TO SX.
  2667
  2668     IF X1 NOT = MAX-X
  2669          GO TO 10500-VX-LOOP.
  2670
  2671 10700-COMPUTE-REMAINING-FACTOR.
  2672*****  WK1 = LOAN TERM AMORT
  2673     COMPUTE WK1 = K1 - VX.
  2674*****  WK2 = INS TERM AMORT
  2675     COMPUTE WK2 = K1 - SV.
  2676*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  2677     COMPUTE WK5 = K1 - SX.
  2678*****  WK6 = INS TERM - 1
  2679     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  2680
  2681     IF NP-RATING
  2682         GO TO 12000-PREMIUM-RATE.
  2683
  2684     IF NP-REFUND
  2685         GO TO 11000-REFUND-CALC.
  2686
  2687     IF NET-STD
  2688         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  2689
  2690     IF NET-SMP
  2691         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  2692         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  2693         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  2694         COMPUTE WK3 ROUNDED = WK3 * 1000.
  2695
  2696     IF REMAINING-TERM LESS THAN X2
  2697         MOVE +0 TO WK3.
  2698
  2699     MOVE WK3 TO FACTOR.
  2700
  2701     GO TO 99999-RETURN.
  2702
  2703 11000-REFUND-CALC.
  2704     IF REMAINING-TERM NOT LESS MAX-X
  2705        MOVE +1 TO FACTOR
  2706        GO TO 99999-RETURN.
  2707
  2708     IF REMAINING-TERM LESS +1
  2709        MOVE 0 TO FACTOR
  2710        GO TO 99999-RETURN.
  2711
  2712     COMPUTE WK2 ROUNDED = WK2 / I.
  2713     COMPUTE WK5 ROUNDED = WK5 / I.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  52
* ELRFND.cbl
  2714     COMPUTE WK1 ROUNDED = WK1 / I.
  2715
  2716     IF (CP-COMPANY-ID EQUAL 'CID')
  2717        AND (CP-STATE-STD-ABBRV = 'MN')
  2718        AND (CP-CERT-EFF-DT > X'A4FF')
  2719        AND (CP-RATE-AS-REG-BALLOON)
  2720        AND (CP-EARN-AS-NET-PAY)
  2721        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2722        CONTINUE
  2723     ELSE
  2724        GO TO 11000-CHECK-MN-LEV-BALLOON
  2725     END-IF
  2726
  2727     COMPUTE R = M - E
  2728     COMPUTE FACTOR = (R - WK2 + WK5) /
  2729        (M - WK1 + WK5)
  2730
  2731     GO TO 99999-RETURN
  2732
  2733      .
  2734 11000-CHECK-MN-LEV-BALLOON.
  2735
  2736     IF (CP-COMPANY-ID EQUAL 'CID')
  2737        AND (CP-STATE-STD-ABBRV = 'MN')
  2738        AND (CP-CERT-EFF-DT > X'A4FF')
  2739        AND (CP-RATE-AS-REG-BALLOON)
  2740        AND (CP-EARN-AS-NET-PAY)
  2741        AND (CP-DEVIATION-CODE = 'LEV')
  2742        CONTINUE
  2743     ELSE
  2744        GO TO 11000-CONTINUE-REFUND
  2745     END-IF
  2746
  2747     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2748     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2749        ** (M - E)) / I
  2750
  2751     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2752
  2753     GO TO 99999-RETURN
  2754
  2755     .
  2756 11000-CONTINUE-REFUND.
  2757*    IF CP-GAP-ACTUARIAL
  2758*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2759*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2760*       COMPUTE WK3 = WK2 / ANGLEN
  2761*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2762     IF CP-GAP-ACTUARIAL
  2763        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2764           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2765        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2766     ELSE
  2767        COMPUTE WK3 ROUNDED =
  2768          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2769     END-IF
  2770
  2771     MOVE WK3  TO FACTOR.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  53
* ELRFND.cbl
  2772
  2773     GO TO 99999-RETURN.
  2774
  2775 12000-PREMIUM-RATE.
  2776*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  2777*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  2778*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  2779*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  2780*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  2781*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  2782
  2783     COMPUTE K-I = K1 + I.
  2784     MOVE K-I TO ONE-PLUS-I.
  2785
  2786     IF NPO-ALT OR NPO-TRUNC-0
  2787         MOVE K1 TO K-I.
  2788
  2789     IF NPO-2MO OR NPO-TRUNC-2
  2790         COMPUTE K-I = K1 + (2 * I).
  2791
  2792     IF NPO-3MO OR NPO-TRUNC-3
  2793         COMPUTE K-I = K1 + (3 * I).
  2794
  2795     IF NPO-4MO OR NPO-TRUNC-4
  2796         COMPUTE K-I = K1 + (4 * I).
  2797
  2798     COMPUTE RA ROUNDED = 1 -
  2799             ((X2 * (X2 + 1)) /
  2800              (N *  (N  + 1))).
  2801
  2802     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2803        (CP-CSL-VALID-NP-BENEFIT-CD)
  2804        NEXT SENTENCE
  2805     ELSE
  2806        GO TO XXXX-CHECK-DISCOUNT-5.
  2807
  2808     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2809     MOVE ' ' TO DC-OPTION-CODE.
  2810     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2811
  2812     IF DATE-CONVERSION-ERROR
  2813        MOVE '2'                 TO CP-RETURN-CODE
  2814        MOVE ZEROS               TO FACTOR
  2815                                    CP-CALC-PREMIUM
  2816         GO TO 99999-RETURN.
  2817
  2818     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  2819     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  2820     MOVE ' ' TO DC-OPTION-CODE
  2821     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2822
  2823     IF DATE-CONVERSION-ERROR
  2824        MOVE '2'                 TO CP-RETURN-CODE
  2825        MOVE ZEROS               TO FACTOR
  2826                                    CP-CALC-PREMIUM
  2827         GO TO 99999-RETURN.
  2828
  2829     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  54
* ELRFND.cbl
  2830
  2831     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  2832
  2833     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  2834        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  2835        CP-PAY-FREQUENCY / 365) * I
  2836     ELSE
  2837        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  2838        CP-PAY-FREQUENCY / 365) * I.
  2839
  2840     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  2841     13).
  2842
  2843     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  2844     (N - ( ANGLEN-1 / WK3)).
  2845
  2846     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  2847
  2848     COMPUTE WS-CALC-FREQ-RATE EQUAL
  2849       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  2850
  2851     COMPUTE WS-Y-X-FACTOR EQUAL
  2852       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  2853       WS-CALC-FREQ-RATE).
  2854
  2855     COMPUTE WS-ODD-DAY-UNITS EQUAL
  2856       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  2857
  2858     COMPUTE WS-X-Y-FACTOR EQUAL
  2859       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  2860
  2861     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  2862       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  2863       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  2864
  2865     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  2866
  2867     GO TO 99999-RETURN.
  2868
  2869 XXXX-CHECK-DISCOUNT-5.
  2870
  2871     IF WS-DISCOUNT-OPTION EQUAL '5'
  2872        NEXT SENTENCE
  2873     ELSE
  2874        GO TO 12000-CHECK-CLIENT.
  2875
  2876      COMPUTE ANGLEN EQUAL WK1 / I.
  2877
  2878      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2879
  2880      COMPUTE WK3 EQUAL
  2881        (12 *
  2882        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  2883        CP-ORIGINAL-BENEFIT)) /
  2884        APR100.
  2885
  2886     COMPUTE WK3 EQUAL
  2887        (WK3 * CP-PREMIUM-RATE) / +1000.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  55
* ELRFND.cbl
  2888
  2889     COMPUTE WK3 EQUAL
  2890        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  2891
  2892      MOVE WK3 TO CP-CALC-PREMIUM.
  2893
  2894     GO TO 99999-RETURN.
  2895
  2896 12000-CHECK-CLIENT.
  2897
  2898     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2899        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2900        (CP-TRUNCATED-LIFE)
  2901        NEXT SENTENCE
  2902     ELSE
  2903        GO TO 12000-CHECK-NEXT.
  2904
  2905     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2906
  2907     COMPUTE ANGLEN EQUAL WK1 / I.
  2908     COMPUTE ANGLEM EQUAL WK2 / I.
  2909
  2910     COMPUTE FM EQUAL
  2911                    (((ONE-PLUS-I ** M) * I * M) /
  2912                    ((ONE-PLUS-I ** M) - 1))
  2913                    - 1.
  2914
  2915     COMPUTE FN EQUAL
  2916                    (((ONE-PLUS-I ** N) * I * N) /
  2917                    ((ONE-PLUS-I ** N) - 1))
  2918                    - 1.
  2919
  2920     COMPUTE FNM EQUAL
  2921                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  2922                    ((ONE-PLUS-I ** (N - M)) - 1))
  2923                    - 1.
  2924
  2925     COMPUTE GR EQUAL
  2926                    (WS-WORK-RATE * ANGLEM * I) /
  2927                    (M - ANGLEM).
  2928
  2929     COMPUTE ODF EQUAL
  2930                     (1 +
  2931                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  2932                     360)) /
  2933                     ONE-PLUS-I.
  2934
  2935     COMPUTE OD EQUAL
  2936                    (1 + (ODF * (FN / I - 1))) +
  2937                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  2938
  2939     COMPUTE WK3 EQUAL
  2940*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  2941                    ((1 + FN) * ODF *
  2942                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  2943                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  2944                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  2945
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  56
* ELRFND.cbl
  2946     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  2947     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  2948
  2949     COMPUTE WK3 EQUAL
  2950                    (WK3 / (ODF * (1 + FN))) -
  2951*                   CP-ORIGINAL-BENEFIT.
  2952                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  2953
  2954      MOVE WK3 TO CP-CALC-PREMIUM.
  2955
  2956     GO TO 99999-RETURN.
  2957
  2958 12000-CHECK-NEXT.
  2959
  2960     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  2961        NEXT SENTENCE
  2962     ELSE
  2963        GO TO 12000-CHECK-PA-TRUNC.
  2964
  2965      IF WS-WORK-DIS-RATE EQUAL +0
  2966         MOVE '7'                TO CP-RETURN-CODE
  2967         MOVE ZEROS              TO FACTOR
  2968                                    CP-CALC-PREMIUM
  2969         GO TO 99999-RETURN.
  2970
  2971      COMPUTE ANGLEN EQUAL WK1 / I.
  2972
  2973      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2974
  2975      IF WS-WORK-DIS-RATE EQUAL APR100
  2976         ADD .00001 TO APR100.
  2977
  2978      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  2979      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  2980
  2981     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2982        / (1 + I)
  2983     COMPUTE ANGLEN-1 = ANGLEN / Y
  2984      IF CP-COMPANY-ID EQUAL 'CDL'
  2985         COMPUTE WK3 EQUAL
  2986
  2987          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  2988          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  2989
  2990          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2991
  2992          ((WK8 ** N) /
  2993          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2994
  2995          ((WK9 ** N) /
  2996          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  2997
  2998      ELSE
  2999         COMPUTE WK3 EQUAL
  3000
  3001          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3002          (12 + WS-WORK-DIS-RATE) * 12) *
  3003
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  57
* ELRFND.cbl
  3004          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3005
  3006          ((WK8 ** N) /
  3007          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3008
  3009          ((WK9 ** N) /
  3010          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  3011
  3012      COMPUTE WK3 EQUAL
  3013          (WK3 * CP-PREMIUM-RATE) / +1000.
  3014
  3015      MOVE WK3 TO CP-CALC-PREMIUM.
  3016
  3017     GO TO 99999-RETURN.
  3018
  3019 12000-CHECK-PA-TRUNC.
  3020
  3021     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3022        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  3023        (CP-EARN-AS-NET-PAY) AND
  3024        (CP-TRUNCATED-LIFE)
  3025        NEXT SENTENCE
  3026     ELSE
  3027        GO TO 12000-CHECK-MD-TRUNC.
  3028
  3029     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3030
  3031     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3032     COMPUTE ANGLEN EQUAL WK1 / I.
  3033
  3034     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3035
  3036     COMPUTE WK3 EQUAL
  3037        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  3038        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  3039
  3040     MOVE WK3 TO CP-CALC-PREMIUM.
  3041
  3042     GO TO 99999-RETURN.
  3043
  3044 12000-CHECK-MD-TRUNC.
  3045
  3046     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3047        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3048        (CP-EARN-AS-NET-PAY) AND
  3049        (CP-TRUNCATED-LIFE)
  3050        NEXT SENTENCE
  3051     ELSE
  3052        GO TO 12000-CHECK-MD.
  3053
  3054     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3055
  3056     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3057     COMPUTE ANGLEM EQUAL WK2 / I.
  3058     COMPUTE ANGLEN EQUAL WK1 / I.
  3059
  3060     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3061
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  58
* ELRFND.cbl
  3062     COMPUTE WK3 EQUAL
  3063        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3064        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3065        (ANGLEN-1 * (M - ANGLEM))).
  3066
  3067     MOVE WK3 TO CP-CALC-PREMIUM.
  3068
  3069     GO TO 99999-RETURN.
  3070
  3071 12000-CHECK-MD.
  3072
  3073     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3074        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3075        (CP-EARN-AS-NET-PAY)
  3076        NEXT SENTENCE
  3077     ELSE
  3078        GO TO 12000-CHECK-ME-TRUNC.
  3079
  3080     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3081
  3082     COMPUTE WK3 EQUAL
  3083        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3084
  3085     MOVE WK3 TO CP-CALC-PREMIUM.
  3086
  3087     GO TO 99999-RETURN.
  3088
  3089 12000-CHECK-ME-TRUNC.
  3090
  3091     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3092        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3093        AND (CP-EARN-AS-NET-PAY)
  3094        AND (CP-TRUNCATED-LIFE)
  3095        CONTINUE
  3096     ELSE
  3097        GO TO 12000-CHECK-CID-WA-FARMPLAN
  3098     END-IF
  3099
  3100     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3101     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3102     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3103     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3104     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3105     COMPUTE ANGLEN-1 = ANGLEN / Y
  3106     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3107     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3108     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3109     COMPUTE WK3
  3110        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3111        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3112            * (1 / (1.0635 ** (M / 12))))
  3113*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3114*    COMPUTE WK9 EQUAL
  3115*       1 / (1 + (.045 * (N - M) / 24))
  3116*    COMPUTE WK7 EQUAL
  3117*       WS-WORK-RATE * 20 / (M + 1).
  3118*    COMPUTE WK3 EQUAL
  3119*       ((( N - ANGLEN) * WK7 * WK8) /
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  59
* ELRFND.cbl
  3120*       (10 * ANGLEN-1 * I)) -
  3121*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3122*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3123*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3124*
  3125     MOVE WK3 TO CP-CALC-PREMIUM.
  3126
  3127     GO TO 99999-RETURN
  3128      .
  3129 12000-CHECK-CID-WA-FARMPLAN.
  3130
  3131     IF (CP-COMPANY-ID EQUAL 'CID')
  3132        AND (CP-STATE-STD-ABBRV = 'WA')
  3133        AND (CP-FARM-PLAN)
  3134        CONTINUE
  3135     ELSE
  3136        GO TO 12000-CHECK-CID-FARMPLAN
  3137     END-IF
  3138**  This was removed due to IR 2015022300001
  3139    GO TO 12000-CHECK-CID-FARMPLAN
  3140
  3141     move cp-original-term       to n
  3142     move cp-no-of-pmts          TO C-TOT-PMTS
  3143     compute c-pmts-per-year = 12 / cp-pay-frequency
  3144     move cp-pay-frequency       to m
  3145     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  3146     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3147     if i = zeros
  3148        move .0000000001         to i
  3149     end-if
  3150     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3151
  3152     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3153        (m * 30))) / (1 + I)
  3154     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3155        ** CP-PAY-FREQUENCY) - 1
  3156     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  3157     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3158        ** TI) / WS-WORK-DIS-RATE
  3159     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  3160     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  3161     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3162        ** m) / WS-WORK-DIS-RATE
  3163     COMPUTE WK2 = WK2 * (1 + J)
  3164     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3165     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3166     COMPUTE WK3 = WK3 * (1 + J)
  3167     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  3168        ** (c-tot-pmts - 1))) / J
  3169     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3170        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  3171        (CP-PREMIUM-RATE / 1000)
  3172     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  3173     COMPUTE WK6 = (WK7 * GR)
  3174
  3175     MOVE WK6 TO CP-CALC-PREMIUM
  3176
  3177     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  60
* ELRFND.cbl
  3178
  3179     .
  3180 12000-CHECK-CID-FARMPLAN.
  3181     IF (CP-COMPANY-ID EQUAL 'CID')
  3182        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3183           OR 'IN' OR 'AZ')
  3184        AND (CP-FARM-PLAN)
  3185        CONTINUE
  3186     ELSE
  3187        GO TO 12000-CHECK-CID-AL-FARMPLAN
  3188     END-IF
  3189     COMPUTE N = M / CP-PAY-FREQUENCY
  3190     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3191     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3192        ** CP-PAY-FREQUENCY) - 1
  3193     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3194     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3195        ** TI) / WS-WORK-DIS-RATE
  3196     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3197     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3198     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3199        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3200     COMPUTE WK2 = WK2 * (1 + J)
  3201     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3202     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3203     COMPUTE WK3 = WK3 * (1 + J)
  3204     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3205        ** (N - 1))) / J
  3206     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3207        ((N * WK2) - WK5)) + (N * WK1)) *
  3208        (CP-PREMIUM-RATE / 1000)
  3209     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3210     COMPUTE WK6 = (WK7 * GR)
  3211     MOVE WK6 TO CP-CALC-PREMIUM
  3212     GO TO 99999-RETURN
  3213     .
  3214 12000-CHECK-CID-AL-FARMPLAN.
  3215
  3216     IF (CP-COMPANY-ID EQUAL 'CID')
  3217        AND (CP-STATE-STD-ABBRV = 'AL')
  3218        AND (CP-FARM-PLAN)
  3219        CONTINUE
  3220     ELSE
  3221        GO TO 12000-CHECK-SC-CID
  3222     END-IF
  3223
  3224     display ' made AL Farm Plan calc '
  3225
  3226     evaluate true
  3227        when cp-pmt-mode = 'B'
  3228           move 26               to c-pmts-per-year
  3229           move 14               to c-days-in-pmt-per
  3230        when cp-pmt-mode = 'W'
  3231           move 52               to c-pmts-per-year
  3232           move 07               to c-days-in-pmt-per
  3233        when cp-pmt-mode = 'S'
  3234           move 24               to c-pmts-per-year
  3235           move 15               to c-days-in-pmt-per
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  61
* ELRFND.cbl
  3236        when cp-pmt-mode = 'A'
  3237           move 1                to c-pmts-per-year
  3238           move 360              to c-days-in-pmt-per
  3239        when cp-pmt-mode = 'T'
  3240           move 2                to c-pmts-per-year
  3241           move 180              to c-days-in-pmt-per
  3242        when cp-pmt-mode = 'Q'
  3243           move 4                to c-pmts-per-year
  3244           move 90               to c-days-in-pmt-per
  3245        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  3246           move 6                to c-pmts-per-year
  3247           move 60               to c-days-in-pmt-per
  3248        when other
  3249           move 12               to c-pmts-per-year
  3250           move 30               to c-days-in-pmt-per
  3251     end-evaluate
  3252
  3253     compute c-tot-pmts = n / 12 * c-pmts-per-year
  3254     compute i = cp-loan-apr / c-pmts-per-year / 100
  3255     if i = zeros
  3256        move .0000000001         to i
  3257     end-if
  3258     compute anglen  =
  3259        (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3260
  3261     compute y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3262        c-days-in-pmt-per)) / (1 + I)
  3263
  3264     compute angleny = anglen / y
  3265
  3266     compute wk3 rounded =   *> tv1
  3267        ((c-tot-pmts - anglen + (i * c-tot-pmts))) / i
  3268
  3269     compute wk6 =           *> tv2
  3270        cp-premium-rate / 10 * 12 / c-pmts-per-year / 100
  3271
  3272     compute wk7 =    *> tv3
  3273        (cp-original-benefit / anglen)
  3274
  3275     compute wk5 rounded = wk7 *wk3 * wk6
  3276
  3277     move wk5                    to cp-calc-premium
  3278     GO TO 99999-RETURN
  3279     .
  3280 12000-CHECK-SC-CID.
  3281     IF (CP-COMPANY-ID = 'CID')
  3282        AND (CP-STATE-STD-ABBRV = 'SC')
  3283        AND (CP-EARN-AS-NET-PAY)
  3284        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3285        move 6                   to ws-extra-pmts
  3286     ELSE
  3287        GO TO 12000-CHECK-AL-CID
  3288     END-IF
  3289     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3290     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3291     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3292        / 12)) / ((M + 1) / 2)
  3293
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  62
* ELRFND.cbl
  3294     if i = .0000000001
  3295        compute wk4 = cp-original-benefit / n
  3296        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  3297            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  3298        display ' hit sc wo apr - wk2 ' wk2
  3299     else
  3300        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  3301        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3302        COMPUTE ANGLEN-1 = ANGLEN / Y
  3303        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3304        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3305           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3306     end-if
  3307*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3308*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3309*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3310*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3311*    COMPUTE ANGLEN-1 = ANGLEN / Y
  3312*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3313*       / 12)) / ((M + 1) / 2)
  3314*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3315*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3316*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3317     MOVE WK3 TO CP-CALC-PREMIUM
  3318     GO TO 99999-RETURN
  3319     .
  3320 12000-CHECK-AL-CID.
  3321     IF (CP-COMPANY-ID EQUAL 'CID')
  3322        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3323        AND (CP-EARN-AS-NET-PAY)
  3324        CONTINUE
  3325     ELSE
  3326        GO TO 12000-CHECK-NH-CID
  3327     END-IF
  3328     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3329     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3330     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3331     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3332                   / (1 + I)
  3333     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3334     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3335     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3336        (CP-PREMIUM-RATE / 1000)
  3337     MOVE WK3 TO CP-CALC-PREMIUM
  3338     GO TO 99999-RETURN
  3339     .
  3340 12000-CHECK-NH-CID.
  3341     IF (CP-COMPANY-ID EQUAL 'CID')
  3342        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3343        AND (CP-EARN-AS-NET-PAY)
  3344        CONTINUE
  3345     ELSE
  3346        GO TO 12000-CHECK-PA-CID
  3347     END-IF
  3348     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3349     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3350     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3351                   / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  63
* ELRFND.cbl
  3352     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3353     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3354     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3355        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  3356     MOVE WK3 TO CP-CALC-PREMIUM
  3357     GO TO 99999-RETURN
  3358     .
  3359 12000-CHECK-PA-CID.
  3360     IF (CP-COMPANY-ID EQUAL 'CID')
  3361        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  3362        AND (CP-EARN-AS-NET-PAY)
  3363        CONTINUE
  3364     ELSE
  3365        GO TO 12000-CHECK-ME-CID
  3366     END-IF
  3367
  3368     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3369     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3370     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3371     COMPUTE ANGLEN-1 = ANGLEN / Y
  3372     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  3373     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3374     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  3375     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3376        * WK5
  3377     MOVE WK3 TO CP-CALC-PREMIUM
  3378     GO TO 99999-RETURN
  3379     .
  3380 12000-CHECK-ME-CID.
  3381     IF (CP-COMPANY-ID EQUAL 'CID')
  3382        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3383        AND (CP-EARN-AS-NET-PAY)
  3384        CONTINUE
  3385     ELSE
  3386        GO TO 12000-CHECK-VT-TRUNC
  3387     END-IF
  3388     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3389     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3390     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3391     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3392     COMPUTE ANGLEN-1 = ANGLEN / Y
  3393     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3394     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3395     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3396        * WK5
  3397     MOVE WK3 TO CP-CALC-PREMIUM
  3398     GO TO 99999-RETURN
  3399     .
  3400 12000-CHECK-VT-TRUNC.
  3401
  3402     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3403        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3404        (CP-EARN-AS-NET-PAY) AND
  3405        (CP-TRUNCATED-LIFE)
  3406        NEXT SENTENCE
  3407     ELSE
  3408        GO TO 12000-CHECK-VT.
  3409
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  64
* ELRFND.cbl
  3410      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3411
  3412      COMPUTE ANGLEN EQUAL WK1 / I.
  3413
  3414      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3415
  3416      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  3417      COMPUTE WK9 EQUAL
  3418        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  3419        ((.0054 - I) / (1 + I)).
  3420      COMPUTE WK7 EQUAL
  3421        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  3422      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3423        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  3424
  3425      MOVE WK3 TO CP-CALC-PREMIUM.
  3426
  3427     GO TO 99999-RETURN.
  3428
  3429 12000-CHECK-VT.
  3430
  3431     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3432        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3433        (CP-EARN-AS-NET-PAY)
  3434        NEXT SENTENCE
  3435     ELSE
  3436        GO TO 12000-CHECK-MINN-WDS.
  3437
  3438      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3439
  3440      COMPUTE ANGLEN EQUAL WK1 / I.
  3441
  3442      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3443
  3444      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  3445                        (ANGLEN-1 * I)) *
  3446
  3447                        (((1.0054 ** N - 1) /
  3448                        (1.0054 ** (N - 1) * .0054)) -
  3449
  3450                        ((V * (1 - 1.0054 ** N * VX)) /
  3451                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  3452
  3453      MOVE WK3 TO CP-CALC-PREMIUM.
  3454
  3455     GO TO 99999-RETURN.
  3456
  3457 12000-CHECK-MINN-WDS.
  3458
  3459     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3460        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3461        (CP-EARN-AS-NET-PAY)
  3462        NEXT SENTENCE
  3463     ELSE
  3464        GO TO 12000-CHECK-MINN-BALL-LEV.
  3465
  3466     COMPUTE ANGLEN EQUAL WK1 / I.
  3467     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  65
* ELRFND.cbl
  3468              (N / +12) * (2 / (N + 1)).
  3469     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  3470         WK3 * ((N - ANGLEN) / I).
  3471
  3472      MOVE WK3 TO CP-CALC-PREMIUM.
  3473
  3474     GO TO 99999-RETURN.
  3475
  3476 12000-CHECK-MINN-BALL-LEV.
  3477
  3478     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3479        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3480        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3481        (CP-EARN-AS-REG-BALLOON)
  3482        NEXT SENTENCE
  3483     ELSE
  3484        GO TO 12000-CHECK-MINN-BALL.
  3485
  3486     COMPUTE ANGLEN EQUAL WK1 / I.
  3487
  3488     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  3489
  3490     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3491        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  3492
  3493     MOVE WK3 TO CP-CALC-PREMIUM.
  3494
  3495     GO TO 99999-RETURN.
  3496
  3497 12000-CHECK-MINN-BALL.
  3498
  3499     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3500        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3501        (CP-EARN-AS-REG-BALLOON)
  3502        NEXT SENTENCE
  3503     ELSE
  3504        GO TO 12000-CHECK-CID-MN-BALL.
  3505
  3506     COMPUTE ANGLEN EQUAL WK1 / I.
  3507     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3508
  3509     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3510     / +100 * (N - 1) / 12 * 2 / N *
  3511     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  3512
  3513      MOVE WK3 TO CP-CALC-PREMIUM.
  3514
  3515     GO TO 99999-RETURN.
  3516
  3517 12000-CHECK-CID-MN-BALL.
  3518     IF (CP-COMPANY-ID EQUAL 'CID')
  3519        AND (CP-STATE-STD-ABBRV = 'MN')
  3520        AND (CP-CERT-EFF-DT > X'A4FF')
  3521        AND (CP-EARN-AS-REG-BALLOON)
  3522        CONTINUE
  3523     ELSE
  3524        GO TO 12000-CHECK-CID-MN-FARM
  3525     END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  66
* ELRFND.cbl
  3526     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3527     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3528     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3529     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3530     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3531     COMPUTE V = 1 / (1 + I)
  3532     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3533     COMPUTE Y = (1 + (D * I) / +30)
  3534        / (1 + I)
  3535     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3536        * CP-PREMIUM-RATE / 1000
  3537*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3538*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3539*    ELSE
  3540*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3541*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  3542*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3543*       DISPLAY ' BALLOON TOP ' WK6
  3544*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3545*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3546*          / 100
  3547*       DISPLAY ' BALLOON BOTTOM ' WK7
  3548*       COMPUTE GR = WK6 / WK7
  3549*       DISPLAY ' BALLOON PAYMENT ' GR
  3550*    END-IF
  3551     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3552     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3553        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3554     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  3555     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3556        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3557           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3558           * CP-PREMIUM-RATE / 1000
  3559     MOVE WK3                    TO CP-CALC-PREMIUM
  3560     GO TO 99999-RETURN.
  3561     .
  3562 12000-CHECK-CID-MN-FARM.
  3563
  3564     IF (CP-COMPANY-ID EQUAL 'CID')
  3565        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  3566        AND (CP-CERT-EFF-DT > X'A4FF')
  3567        AND (CP-EARN-AS-FARM-PLAN)
  3568        CONTINUE
  3569     ELSE
  3570        GO TO 12000-CHECK-CID-NET-BALLoons
  3571     END-IF
  3572
  3573     EVALUATE CP-PMT-MODE
  3574        WHEN 'B'
  3575           MOVE +14              TO C-DAYS-IN-PMT-PER
  3576           MOVE +26              TO C-PMTS-PER-YEAR
  3577           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3578        WHEN 'S'
  3579           MOVE +15              TO C-DAYS-IN-PMT-PER
  3580           MOVE +24              TO C-PMTS-PER-YEAR
  3581           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3582        WHEN 'T'
  3583           MOVE +360             TO C-DAYS-IN-PMT-PER
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  67
* ELRFND.cbl
  3584           MOVE +1               TO C-PMTS-PER-YEAR
  3585           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3586        WHEN 'W'
  3587           MOVE +7               TO C-DAYS-IN-PMT-PER
  3588           MOVE +52              TO C-PMTS-PER-YEAR
  3589           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3590        WHEN OTHER
  3591           move cp-no-of-pmts    to c-tot-pmts
  3592           if cp-pay-frequency > zeros
  3593              compute c-pmts-per-year =
  3594                 12 / cp-pay-frequency
  3595              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  3596           else
  3597              MOVE +30           TO C-DAYS-IN-PMT-PER
  3598              MOVE +12           TO C-PMTS-PER-YEAR
  3599              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  3600           end-if
  3601     END-EVALUATE
  3602
  3603     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3604     if i = zeros
  3605        move .0000000001         to i
  3606     end-if
  3607
  3608     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3609        C-DAYS-IN-PMT-PER)) / (1 + I)
  3610
  3611     compute cp-premium-rate =
  3612        cp-premium-rate * 12 / c-pmts-per-year / 10
  3613     move c-tot-pmts to n m
  3614     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3615     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3616     COMPUTE ANGLEN-1 = ANGLEN / Y
  3617     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3618
  3619     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  3620        (cp-premium-rate / 100)
  3621
  3622
  3623     MOVE WK3                    TO CP-CALC-PREMIUM
  3624
  3625     GO TO 99999-RETURN.
  3626
  3627     .
  3628 12000-check-cid-net-balloons.
  3629     IF (CP-COMPANY-ID EQUAL 'CID')
  3630        AND (CP-EARN-AS-REG-BALLOON)
  3631        and (CP-NET-ONLY-STATE not = 'Y')
  3632        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  3633        CONTINUE
  3634     ELSE
  3635        GO TO 12000-check-cid-net-only-balls
  3636     END-IF
  3637     display ' *** NOT NET ONLY STATE BALLOONS *** '
  3638     COMPUTE Y =
  3639        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  3640     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3641     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  68
* ELRFND.cbl
  3642     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3643     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3644     COMPUTE ANGLEMY = ANGLEM / Y
  3645     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  3646     COMPUTE ANGLENY = ANGLEN / Y
  3647     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  3648     compute cp-original-benefit =
  3649        cp-original-benefit + cp-alternate-benefit
  3650     COMPUTE PVBALLOON rounded =
  3651        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  3652     compute wk4 rounded =
  3653        cp-original-benefit - pvballoon
  3654     compute wk6 rounded =
  3655        (cp-original-benefit - cp-alternate-benefit)
  3656***  compute ra = wk4 / anglem-1y
  3657     compute ra = wk4 / anglemy
  3658     compute wk6 rounded = wk6 / anglemy
  3659     display ' rate before ' cp-premium-rate
  3660     compute cp-premium-rate =
  3661        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  3662            / 30) / 12))     /
  3663           ((m + 1) / 2)
  3664     display '************************************'
  3665     display ' orign ben    ' cp-original-benefit
  3666     display ' balloon      ' cp-alternate-benefit
  3667     display ' ra           ' ra
  3668     display ' wk6          ' wk6
  3669     display ' m            ' m
  3670     display ' anglemy      ' anglemy
  3671     display ' anglem-1     ' anglem-1y
  3672     display ' i            ' i
  3673     display ' extra per    ' cp-extra-periods
  3674     display ' prem rate    ' cp-premium-rate
  3675***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  3676***     (cp-extra-periods * i)) * cp-premium-rate / 100
  3677     compute wk3 = wk6 * (m - anglem) / i * (1 +
  3678        (cp-extra-periods * i)) * cp-premium-rate / 100
  3679     move wk3                    to cp-calc-premium
  3680     display ' wk3          ' wk3
  3681     display '************************************'
  3682*    compute wk3 rounded =
  3683*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  3684*    move wk3                    to cp-lf-balloon-prem
  3685     GO TO 99999-RETURN.
  3686     .
  3687 12000-check-cid-net-only-balls.
  3688     IF (CP-COMPANY-ID EQUAL 'CID')
  3689        AND (CP-EARN-AS-REG-BALLOON)
  3690        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  3691        CONTINUE
  3692     ELSE
  3693        GO TO 12000-CHECK-NC-WDS
  3694     END-IF
  3695     display ' *** NET ONLY STATE BALLOONS *** '
  3696     COMPUTE Y =
  3697        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  3698     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3699     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  69
* ELRFND.cbl
  3700     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3701     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3702     COMPUTE ANGLEMY = ANGLEM / Y
  3703     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  3704     COMPUTE ANGLENY = ANGLEN / Y
  3705     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  3706     COMPUTE PVBALLOON rounded =
  3707        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  3708     compute wk4 rounded =
  3709        cp-original-benefit - pvballoon
  3710*    compute cp-premium-rate =
  3711*       (cp-premium-rate * (m + 1) / 12)  /
  3712*          ((m + 2) / 2)
  3713***  compute ra = wk4 / anglem-1y
  3714     compute ra = (cp-original-benefit + cp-alternate-benefit -
  3715        pvballoon) / anglemy
  3716     display '************************************'
  3717     display ' ra           ' ra
  3718     display ' m            ' m
  3719     display ' anglemy      ' anglemy
  3720     display ' anglem-1     ' anglem-1y
  3721     display ' i            ' i
  3722     display ' extra per    ' cp-extra-periods
  3723     display ' prem rate    ' cp-premium-rate
  3724     display '************************************'
  3725***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  3726***     (cp-extra-periods * i)) * cp-premium-rate / 100
  3727     compute wk3 = ra * (m - anglemy) / i * (1 +
  3728        (cp-extra-periods * i)) * cp-premium-rate / 100
  3729     move wk3                    to cp-calc-premium
  3730     compute wk3 rounded =
  3731        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  3732     move wk3                    to cp-lf-balloon-prem
  3733     GO TO 99999-RETURN.
  3734     .
  3735 12000-CHECK-NC-WDS.
  3736
  3737     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3738        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3739        (CP-EARN-AS-NET-PAY)
  3740        NEXT SENTENCE
  3741     ELSE
  3742        GO TO 12000-CHECK-NC-BALL-LEV.
  3743
  3744     COMPUTE WK4 EQUAL N * (1 + I * 2).
  3745     COMPUTE ANGLEN EQUAL WK1 / I.
  3746     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3747              CP-PREMIUM-RATE / +100 *
  3748              N / +12 * 2 / (N + 1) *
  3749              (WK4 - ANGLEN) / (I * ANGLEN).
  3750
  3751      MOVE WK3 TO CP-CALC-PREMIUM.
  3752
  3753     GO TO 99999-RETURN.
  3754
  3755 12000-CHECK-NC-BALL-LEV.
  3756
  3757     IF (CP-COMPANY-ID EQUAL 'WDS') AND
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  70
* ELRFND.cbl
  3758        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3759        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3760        (CP-EARN-AS-REG-BALLOON)
  3761        NEXT SENTENCE
  3762     ELSE
  3763        GO TO 12000-CHECK-NC-BALL.
  3764
  3765     COMPUTE ANGLEN EQUAL WK1 / I.
  3766
  3767**** VX = 1 / (1 + I)**N.
  3768
  3769     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3770        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  3771
  3772     MOVE WK3 TO CP-CALC-PREMIUM.
  3773
  3774     GO TO 99999-RETURN.
  3775
  3776 12000-CHECK-NC-BALL.
  3777
  3778     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3779        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3780        (CP-EARN-AS-REG-BALLOON)
  3781        NEXT SENTENCE
  3782     ELSE
  3783        GO TO 12000-CHECK-MINN-TRUNC.
  3784
  3785     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  3786     COMPUTE ANGLEN EQUAL WK1 / I.
  3787     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3788**** VX = 1 / (1 + I)**N.
  3789
  3790     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3791     / +100 * (N - 1) / 12 * 2 / N *
  3792     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  3793
  3794      MOVE WK3 TO CP-CALC-PREMIUM.
  3795
  3796     GO TO 99999-RETURN.
  3797
  3798 12000-CHECK-MINN-TRUNC.
  3799
  3800     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3801        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3802        (M GREATER THAN +63) AND
  3803        (CP-EARN-AS-NET-PAY) AND
  3804        (CP-TRUNCATED-LIFE)
  3805        NEXT SENTENCE
  3806     ELSE
  3807        GO TO 12000-CHECK-MINN.
  3808
  3809      COMPUTE ANGLEN EQUAL WK1 / I.
  3810      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3811
  3812      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3813
  3814      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3815       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  71
* ELRFND.cbl
  3816       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  3817
  3818      MOVE WK3 TO CP-CALC-PREMIUM.
  3819
  3820     GO TO 99999-RETURN.
  3821
  3822 12000-CHECK-MINN.
  3823
  3824     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3825        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3826        (M GREATER THAN +63) AND
  3827        (CP-EARN-AS-NET-PAY)
  3828        NEXT SENTENCE
  3829     ELSE
  3830        GO TO 12000-CHECK-MONTANA-TRUNC.
  3831
  3832      COMPUTE ANGLEN EQUAL WK1 / I.
  3833
  3834      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3835
  3836      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3837       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3838       (((N - ANGLEN) / I) + (2 * N)).
  3839
  3840      MOVE WK3 TO CP-CALC-PREMIUM.
  3841
  3842     GO TO 99999-RETURN.
  3843
  3844 12000-CHECK-MONTANA-TRUNC.
  3845
  3846     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3847        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3848        (M GREATER THAN +63) AND
  3849        (CP-EARN-AS-NET-PAY) AND
  3850        (CP-TRUNCATED-LIFE)
  3851        NEXT SENTENCE
  3852     ELSE
  3853        GO TO 12000-CHECK-MONTANA.
  3854
  3855      COMPUTE ANGLEN EQUAL WK1 / I.
  3856      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3857
  3858      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3859
  3860      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3861      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3862       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  3863
  3864      MOVE WK3 TO CP-CALC-PREMIUM.
  3865
  3866     GO TO 99999-RETURN.
  3867
  3868 12000-CHECK-MONTANA.
  3869
  3870     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3871        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3872        (M GREATER THAN +63) AND
  3873        (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  72
* ELRFND.cbl
  3874        NEXT SENTENCE
  3875     ELSE
  3876        GO TO 12001-CONTINUE-NCL-TRUNC.
  3877
  3878      COMPUTE ANGLEN EQUAL WK1 / I.
  3879
  3880      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3881
  3882      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3883       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3884       (((N - ANGLEN) / I) + (4 * N)).
  3885
  3886      MOVE WK3 TO CP-CALC-PREMIUM.
  3887
  3888     GO TO 99999-RETURN.
  3889
  3890 12001-CONTINUE-NCL-TRUNC.
  3891
  3892     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3893        (CP-EARN-AS-NET-PAY) AND
  3894        (CP-TRUNCATED-LIFE)
  3895        NEXT SENTENCE
  3896     ELSE
  3897        GO TO 12001-CONTINUE-NCL.
  3898
  3899      COMPUTE ANGLEN EQUAL WK1 / I.
  3900      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3901
  3902      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3903
  3904      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  3905      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  3906      (ANGLEN-1 * (N + 1) * I).
  3907
  3908      MOVE WK3 TO CP-CALC-PREMIUM.
  3909
  3910     GO TO 99999-RETURN.
  3911
  3912 12001-CONTINUE-NCL.
  3913
  3914     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3915        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3916        (CP-EARN-AS-NET-PAY)
  3917        GO TO 12001-CHECK-NC-NET-PLUS3.
  3918
  3919     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3920        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3921        (CP-EARN-AS-NET-PAY)
  3922        GO TO 12001-CHECK-CA.
  3923
  3924     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3925        (CP-EARN-AS-NET-PAY)
  3926        NEXT SENTENCE
  3927     ELSE
  3928        GO TO 12000-CONTINUE-NET.
  3929
  3930      COMPUTE ANGLEN EQUAL WK1 / I.
  3931      MOVE ANGLEN                TO ANGLEN-1.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  73
* ELRFND.cbl
  3932
  3933      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3934
  3935      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3936       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3937       ((N - ANGLEN) / I).
  3938
  3939      MOVE WK3 TO CP-CALC-PREMIUM.
  3940
  3941     GO TO 99999-RETURN.
  3942
  3943 12000-CONTINUE-NET.
  3944
  3945     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  3946        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  3947        (CP-EARN-AS-NET-PAY)
  3948        NEXT SENTENCE
  3949     ELSE
  3950        GO TO 12001-CONTINUE-MINN.
  3951
  3952      COMPUTE ANGLEN EQUAL WK6 / I.
  3953      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  3954
  3955      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  3956      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  3957      COMPUTE WK3 EQUAL (WK3 / I) *
  3958       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  3959
  3960      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  3961         MOVE +0 TO CP-R-MAX-TOT-BEN.
  3962
  3963      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  3964
  3965      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  3966         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  3967         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  3968
  3969      MOVE WK3 TO CP-CALC-PREMIUM.
  3970
  3971     GO TO 99999-RETURN.
  3972
  3973 12001-CONTINUE-MINN.
  3974
  3975     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3976        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  3977        (CP-TRUNCATED-LIFE)
  3978        NEXT SENTENCE
  3979     ELSE
  3980        GO TO 12001-CHECK-RI-GTL.
  3981
  3982      COMPUTE ANGLEN EQUAL WK1 / I.
  3983      COMPUTE ANGLEM EQUAL WK2 / I.
  3984
  3985      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  3986       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  3987       * M / 2400) * 1000 + .5) / 1000000.
  3988
  3989      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  74
* ELRFND.cbl
  3990       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  3991
  3992     GO TO 99999-RETURN.
  3993
  3994 12001-CHECK-RI-GTL.
  3995
  3996     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3997        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3998        (CP-EARN-AS-NET-PAY)
  3999        NEXT SENTENCE
  4000     ELSE
  4001        GO TO 12001-CHECK-RI-LEASE-GTL.
  4002
  4003      COMPUTE ANGLEN EQUAL WK1 / I.
  4004*     COMPUTE ANGLEM EQUAL WK2 / I.
  4005
  4006      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  4007               (1 + WS-WORK-DIS-RATE * N).
  4008      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  4009         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  4010
  4011
  4012     GO TO 99999-RETURN.
  4013
  4014 12001-CHECK-RI-LEASE-GTL.
  4015
  4016     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4017        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4018        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4019        NEXT SENTENCE
  4020     ELSE
  4021        GO TO 12001-CHECK-OR-GTL.
  4022
  4023     COMPUTE ANGLEN EQUAL WK1 / I.
  4024
  4025     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  4026        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  4027                        /
  4028        (1000 * I * (1 + .0021 * N)).
  4029     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  4030       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  4031                            /
  4032       (1000 * (1 + .0027 * (N + 1))).
  4033
  4034     GO TO 99999-RETURN.
  4035
  4036 12001-CHECK-OR-GTL.
  4037
  4038     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4039        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  4040        (CP-EARN-AS-NET-PAY)
  4041        NEXT SENTENCE
  4042     ELSE
  4043        GO TO 12001-CHECK-GA-GTL.
  4044
  4045     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4046     COMPUTE ANGLEN EQUAL WK1 / I.
  4047
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  75
* ELRFND.cbl
  4048     IF M LESS THAN +64
  4049        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4050         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  4051                   /
  4052         (I * ANGLEN * (N - (N - M) + 1) * 600)
  4053        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  4054     ELSE
  4055        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4056        CP-PREMIUM-RATE * (1 + I))
  4057                  /
  4058        (+1000 * I * ANGLEN)
  4059        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4060*    MOVE WK3 TO CP-CALC-PREMIUM.
  4061     GO TO 99999-RETURN.
  4062
  4063 12001-CHECK-GA-GTL.
  4064
  4065     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4066        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  4067        (CP-EARN-AS-NET-PAY)
  4068*       (CP-TRUNCATED-LIFE)
  4069        NEXT SENTENCE
  4070     ELSE
  4071        GO TO 12001-CHECK-MA-GTL.
  4072
  4073     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4074     COMPUTE ANGLEN EQUAL WK1 / I.
  4075
  4076     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  4077     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  4078      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  4079     MOVE WK3 TO CP-CALC-PREMIUM.
  4080
  4081     GO TO 99999-RETURN.
  4082
  4083 12001-CHECK-MA-GTL.
  4084
  4085     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4086        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  4087        (CP-EARN-AS-NET-PAY) AND
  4088        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4089        NEXT SENTENCE
  4090     ELSE
  4091        GO TO 12001-CHECK-NV-NET.
  4092
  4093     COMPUTE ANGLEN EQUAL WK1 / I.
  4094
  4095     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  4096      CP-ALTERNATE-BENEFIT * N.
  4097
  4098     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  4099     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  4100
  4101     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  4102     WK7 * (N - ANGLEN) / I.
  4103     MOVE WK3 TO CP-CALC-PREMIUM.
  4104
  4105     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  76
* ELRFND.cbl
  4106
  4107 12001-CHECK-NV-NET.
  4108     IF (CP-COMPANY-ID EQUAL 'CID')
  4109        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4110        AND (CP-EARN-AS-NET-PAY)
  4111        CONTINUE
  4112     ELSE
  4113        GO TO 12001-CHECK-MN-NET
  4114     END-IF
  4115     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4116     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4117     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4118                   / (1 + I)
  4119     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4120     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4121     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4122        (CP-PREMIUM-RATE * K-I / 1000)
  4123     MOVE WK3                    TO CP-CALC-PREMIUM
  4124     GO TO 99999-RETURN
  4125      .
  4126 12001-CHECK-MN-NET.
  4127     IF (CP-COMPANY-ID EQUAL 'CID')
  4128        AND (CP-STATE-STD-ABBRV = 'MN')
  4129        AND (CP-EARN-AS-NET-PAY)
  4130        AND (NOT CP-LEVEL-LIFE)
  4131        AND (WS-DISCOUNT-OPTION = '1')
  4132        CONTINUE
  4133     ELSE
  4134        GO TO 12001-CHECK-NC-NET
  4135     END-IF
  4136     if i = .0000000001
  4137        compute wk4 = cp-original-benefit / n
  4138        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  4139           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  4140        move wk3 to cp-calc-premium
  4141        go to 99999-return
  4142     end-if
  4143     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4144     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4145     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4146                   / (1 + I)
  4147     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4148     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4149     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4150        (CP-PREMIUM-RATE / 1000) * (1 + I)
  4151     MOVE WK3                    TO CP-CALC-PREMIUM
  4152     GO TO 99999-RETURN
  4153      .
  4154 12001-CHECK-NC-NET.
  4155
  4156     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  4157        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4158        (CP-EARN-AS-NET-PAY)
  4159        NEXT SENTENCE
  4160     ELSE
  4161        GO TO 12001-CHECK-NC-NET-PLUS3.
  4162
  4163      COMPUTE ANGLEN EQUAL WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  77
* ELRFND.cbl
  4164      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4165
  4166      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  4167          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  4168          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  4169          N * (CP-PREMIUM-RATE / 1000)).
  4170
  4171      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  4172          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  4173
  4174      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  4175          ((N - ANGLEN) / I + 3) / ANGLEN) /
  4176          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  4177          (ANGLEN * 2))
  4178
  4179      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  4180
  4181      IF ANGLEN IS NOT LESS THAN WK7
  4182          COMPUTE CP-PREMIUM-RATE ROUNDED =
  4183              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  4184          COMPUTE WK3 ROUNDED =
  4185              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  4186
  4187     MOVE WK3 TO CP-CALC-PREMIUM.
  4188
  4189     GO TO 99999-RETURN.
  4190
  4191 12001-CHECK-NC-NET-PLUS3.
  4192
  4193     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4194        (CP-EARN-AS-NET-PAY) AND
  4195        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL' AND 'VPP')
  4196        NEXT SENTENCE
  4197     ELSE
  4198        GO TO 12001-CHECK-CA.
  4199
  4200     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  4201     MOVE ' ' TO DC-OPTION-CODE.
  4202     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  4203
  4204     IF DATE-CONVERSION-ERROR
  4205        MOVE '2'                 TO CP-RETURN-CODE
  4206        MOVE ZEROS               TO FACTOR
  4207                                    CP-CALC-PREMIUM
  4208         GO TO 99999-RETURN.
  4209
  4210     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  4211        NEXT SENTENCE
  4212     ELSE
  4213        GO TO 12001-CONTINUE-NET.
  4214
  4215     COMPUTE ANGLEN EQUAL WK1 / I.
  4216     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4217
  4218     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  4219
  4220     COMPUTE NC-R = 20 *
  4221                    ((NC-LR * ORIGINAL-TERM) / 12)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  78
* ELRFND.cbl
  4222                          / (ORIGINAL-TERM + 1).
  4223
  4224     COMPUTE NC-OB = NC-R / 1000.
  4225
  4226     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  4227                    (NC-OB * ORIGINAL-TERM * 3).
  4228
  4229     IF CP-EXT-CHG-LF
  4230         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  4231     ELSE
  4232         MOVE 30                 TO  NC-BIG-D.
  4233
  4234     COMPUTE NC-LITTLE-D = (1 + I) /
  4235             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  4236
  4237     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  4238             (ANGLEN * NC-LITTLE-D ).
  4239
  4240     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  4241
  4242     GO TO 99999-RETURN.
  4243
  4244 12001-CHECK-CA.
  4245
  4246     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4247        (WS-DISCOUNT-OPTION = '6')
  4248        NEXT SENTENCE
  4249     ELSE
  4250        GO TO 12001-CHECK-GTL-IA.
  4251
  4252     COMPUTE CA-J = CA-DISCOUNT / 12.
  4253     COMPUTE ANGLEN EQUAL WK1 / I.
  4254     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  4255     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  4256     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  4257     COMPUTE CA-VI = (1 + I)** -1.
  4258     COMPUTE CP-CALC-PREMIUM =
  4259         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  4260         ((1 + CA-J) / I) *
  4261         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  4262         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  4263         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  4264
  4265     GO TO 99999-RETURN.
  4266
  4267 12001-CHECK-GTL-IA.
  4268
  4269     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  4270        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  4271        (CP-EARN-AS-NET-PAY)
  4272        NEXT SENTENCE
  4273     ELSE
  4274        GO TO 12001-CHECK-CID-TRN-VA.
  4275
  4276***************************************************************
  4277
  4278     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  4279
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  79
* ELRFND.cbl
  4280     IF GTL-IA-ODD-DAYS = ZEROS
  4281         MOVE ZERO               TO  GTL-IA-SGN
  4282     ELSE
  4283         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  4284             MOVE +1             TO  GTL-IA-SGN
  4285         ELSE
  4286             MOVE -1             TO  GTL-IA-SGN.
  4287
  4288     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  4289     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  4290
  4291     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  4292                          GTL-IA-SGN.
  4293
  4294     COMPUTE ANGLEN EQUAL WK1 / I.
  4295     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4296
  4297     IF GTL-IA-ODF NOT = ZERO
  4298         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  4299         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  4300
  4301     COMPUTE GTL-IA-DIVIDEND =
  4302           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  4303                             (ANGLEN - ANGLEN-M))) *
  4304           ((K1 + I) * CP-PREMIUM-RATE *
  4305                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  4306
  4307     COMPUTE GTL-IA-DIVISOR =
  4308      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  4309
  4310     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  4311
  4312     COMPUTE CP-CALC-PREMIUM =
  4313                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  4314     GO TO 99999-RETURN.
  4315
  4316
  4317 12001-CHECK-CID-TRN-VA.
  4318
  4319     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4320        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  4321        (CP-EARN-AS-NET-PAY) AND
  4322        (CP-TRUNCATED-LIFE) AND
  4323        (CP-STATE-STD-ABBRV = CP-STATE)
  4324        CONTINUE
  4325     ELSE
  4326        GO TO 12001-CHECK-CID-TX
  4327     END-IF
  4328
  4329     COMPUTE ANGLEN EQUAL WK1 / I
  4330     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4331     IF WS-WORK-DIS-RATE = ZEROS
  4332        CONTINUE
  4333     ELSE
  4334        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4335        COMPUTE WK7 = (1 / I) *
  4336              (((WK4 ** M - 1) / (WK4 - 1)) -
  4337              ((WK4 ** M * SX - VX) /
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  80
* ELRFND.cbl
  4338              (WK4 * (1 + I) - 1))) *
  4339              (CP-PREMIUM-RATE / 1000)
  4340        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4341        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4342        COMPUTE CP-CALC-PREMIUM =
  4343           WK8 *  ((WK4 * ANGLEN) / 100)
  4344     END-IF
  4345
  4346     GO TO 99999-RETURN
  4347
  4348     .
  4349
  4350 12001-CHECK-CID-TX.
  4351     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4352        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4353        (CP-EARN-AS-NET-PAY) AND
  4354        (WS-WORK-DIS-RATE > ZEROS) AND
  4355        (CP-STATE-STD-ABBRV = CP-STATE)
  4356        CONTINUE
  4357     ELSE
  4358        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4359     END-IF
  4360* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4361     COMPUTE K-I = 1 + (1 * I)
  4362     COMPUTE ANGLEm EQUAL WK1 / I   *>   Loan term
  4363     COMPUTE ANGLEn EQUAL WK2 / I   *>   Ins  term
  4364     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4365
  4366     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4367     COMPUTE ANGLEmy = ANGLEm / Y
  4368     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4369     IF WS-WORK-DIS-RATE = ZEROS
  4370        CONTINUE
  4371     ELSE
  4372        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4373        COMPUTE WK7 = (K-I / I) *
  4374              (((WK4 ** M - 1) / (WK4 - 1)) -
  4375*             ((WK4 ** M * SX - VX) /
  4376              ((WK4 ** M * SX) - VX) /
  4377*             (WK4 * (1 + I) - 1))) *
  4378              (WK4 * (1 + I) - 1)) *
  4379              (CP-PREMIUM-RATE / 1000)
  4380        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEmy
  4381        COMPUTE WK8 = (WK7 * 100) / (ANGLEmy * K-I)
  4382        COMPUTE CP-CALC-PREMIUM =
  4383           WK8 *  ((WK4 * ANGLEmy * K-I) / 100)
  4384     END-IF
  4385
  4386     GO TO 99999-RETURN
  4387     .
  4388 12001-CHECK-CID-LEV-MN-NEW.
  4389*    IF (CP-COMPANY-ID EQUAL 'CID')
  4390*       AND (CP-STATE-STD-ABBRV = 'MN')
  4391*       AND (CP-EARN-AS-NET-PAY)
  4392*       AND (CP-LEVEL-LIFE)
  4393*       AND (CP-CERT-EFF-DT > X'A4FF')
  4394*       CONTINUE
  4395*    ELSE
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  81
* ELRFND.cbl
  4396*       GO TO 12001-CHECK-CID-LEV-MN
  4397*    END-IF
  4398*
  4399*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4400*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4401*    MOVE '1'                    TO DC-OPTION-CODE
  4402*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4403*
  4404*    IF DATE-CONVERSION-ERROR
  4405*       MOVE '2'                 TO CP-RETURN-CODE
  4406*       MOVE ZEROS               TO FACTOR
  4407*                                   CP-CALC-PREMIUM
  4408*       GO TO 99999-RETURN
  4409*    END-IF
  4410*
  4411*    COMPUTE I = CP-LOAN-APR / 100
  4412*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4413*
  4414*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4415*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4416*      * 12 / 360 * D)
  4417*
  4418*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4419*       * 12 / 360 * D
  4420*
  4421*    GO TO 99999-RETURN
  4422      .
  4423 12001-CHECK-CID-LEV-MN.
  4424
  4425     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4426        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4427        (CP-EARN-AS-NET-PAY) AND
  4428        (CP-LEVEL-LIFE) AND
  4429        (CP-STATE-STD-ABBRV = CP-STATE)
  4430        CONTINUE
  4431     ELSE
  4432        GO TO 12001-CHECK-CID-LEV-CA
  4433     END-IF
  4434
  4435     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4436         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4437         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4438
  4439     GO TO 99999-RETURN
  4440
  4441      .
  4442 12001-CHECK-CID-LEV-CA.
  4443
  4444     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4445        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4446        (CP-EARN-AS-NET-PAY) AND
  4447        (CP-LEVEL-LIFE) AND
  4448        (CP-STATE-STD-ABBRV = CP-STATE)
  4449        CONTINUE
  4450     ELSE
  4451        GO TO 12001-CHECK-CID-TRN-CA
  4452     END-IF
  4453
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  82
* ELRFND.cbl
  4454     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4455     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4456     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4457     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4458     COMPUTE CP-CALC-PREMIUM =
  4459          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4460          (CP-PREMIUM-RATE / 1000)) /
  4461          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4462
  4463     GO TO 99999-RETURN
  4464
  4465      .
  4466 12001-CHECK-CID-TRN-CA.
  4467
  4468     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4469        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4470        (CP-EARN-AS-NET-PAY) AND
  4471        (CP-TRUNCATED-LIFE) AND
  4472        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4473        (WS-DISCOUNT-OPTION NOT = ' ')
  4474        CONTINUE
  4475     ELSE
  4476        GO TO 12001-CHECK-CID-TRN-MT
  4477     END-IF
  4478
  4479     COMPUTE ANGLEN EQUAL WK1 / I
  4480     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4481     IF WS-WORK-DIS-RATE = ZEROS
  4482        CONTINUE
  4483     ELSE
  4484        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4485        COMPUTE WK7 = (1 / I) *
  4486              (((WK4 ** M - 1) / (WK4 - 1)) -
  4487              ((WK4 ** M * SX - VX) /
  4488              (WK4 * (1 + I) - 1))) *
  4489              (CP-PREMIUM-RATE / 1000)
  4490        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4491        COMPUTE CP-CALC-PREMIUM =
  4492           WK4 *  WK7
  4493     END-IF
  4494
  4495     GO TO 99999-RETURN
  4496
  4497      .
  4498 12001-CHECK-CID-TRN-MT.
  4499
  4500     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4501        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4502                   OR
  4503        ((CP-STATE-STD-ABBRV = 'IN') AND
  4504        (CP-CERT-EFF-DT > X'9A7F'))
  4505                   OR
  4506        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4507        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4508        (CP-EARN-AS-NET-PAY) AND
  4509        (CP-TRUNCATED-LIFE) AND
  4510        (CP-STATE-STD-ABBRV = CP-STATE)
  4511        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  83
* ELRFND.cbl
  4512     ELSE
  4513        GO TO 12001-CHECK-CID-MT
  4514     END-IF
  4515
  4516* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4517     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4518        MOVE 0                   TO K-I
  4519     ELSE
  4520        MOVE 2                   TO K-I
  4521     END-IF
  4522     COMPUTE CP-TERM-OR-EXT-DAYS =
  4523           CP-TERM-OR-EXT-DAYS + 30
  4524
  4525     COMPUTE ANGLEN EQUAL WK1 / I
  4526     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4527     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4528                   / (1 + I)
  4529     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4530     IF WS-WORK-DIS-RATE = ZEROS
  4531        CONTINUE
  4532     ELSE
  4533        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4534*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4535        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4536              (((WK4 ** M - 1) / (WK4 - 1)) -
  4537              ((WK4 ** M * SX - VX) /
  4538              (WK4 * (1 + I) - 1))) *
  4539              (CP-PREMIUM-RATE / 1000)
  4540        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4541*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4542        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4543        COMPUTE CP-CALC-PREMIUM =
  4544           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4545*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4546     END-IF
  4547
  4548     GO TO 99999-RETURN
  4549
  4550     .
  4551 12001-CHECK-CID-MT.
  4552
  4553     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4554        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4555                                OR 'VT')
  4556                   OR
  4557        ((CP-STATE-STD-ABBRV = 'IN') AND
  4558        (CP-CERT-EFF-DT > X'9A7F'))
  4559                   OR
  4560        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4561        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4562        (CP-EARN-AS-NET-PAY) AND
  4563        (CP-STATE-STD-ABBRV = CP-STATE)
  4564        CONTINUE
  4565     ELSE
  4566        GO TO 12001-CHECK-DCC-DD
  4567     END-IF
  4568
  4569     COMPUTE CP-TERM-OR-EXT-DAYS =
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  84
* ELRFND.cbl
  4570           CP-TERM-OR-EXT-DAYS + 30
  4571
  4572* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4573     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4574        MOVE 0                   TO K-I
  4575     ELSE
  4576        IF CP-STATE-STD-ABBRV = 'NJ'
  4577           MOVE 1                TO K-I
  4578        ELSE
  4579           MOVE 2                TO K-I
  4580        END-IF
  4581     END-IF
  4582     COMPUTE ANGLEN EQUAL WK1 / I
  4583     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4584     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4585                   / (1 + I)
  4586     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4587     IF WS-WORK-DIS-RATE = ZEROS
  4588        CONTINUE
  4589     ELSE
  4590        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4591*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4592        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4593              (((WK4 ** N - 1) / (WK4 - 1)) -
  4594              ((WK4 ** N - SV) /
  4595              (WK4 * (1 + I) - 1))) *
  4596              (CP-PREMIUM-RATE / 1000)
  4597        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4598*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4599        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4600        COMPUTE CP-CALC-PREMIUM =
  4601           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4602*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4603     END-IF
  4604
  4605     GO TO 99999-RETURN
  4606
  4607     .
  4608 12001-CHECK-DCC-DD.
  4609     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4610        AND (CP-EARN-AS-NET-PAY)
  4611        AND (CP-BEN-CATEGORY = 'D')
  4612        CONTINUE
  4613     ELSE
  4614        GO TO 12001-CHECK-DCC-NET
  4615     END-IF
  4616
  4617     COMPUTE CP-TERM-OR-EXT-DAYS =
  4618           CP-TERM-OR-EXT-DAYS + 30
  4619
  4620     COMPUTE ANGLEN EQUAL WK1 / I.
  4621     COMPUTE ANGLEM EQUAL WK2 / I.
  4622     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4623
  4624     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4625           / (1 + I)
  4626     COMPUTE GR     = ANGLEN / ODF
  4627*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  85
* ELRFND.cbl
  4628*      CP-RATE-DEV-PCT
  4629     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4630     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4631       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  4632     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4633     MOVE WK3                    TO CP-CALC-PREMIUM
  4634
  4635     GO TO 99999-RETURN
  4636
  4637     .
  4638 12001-CHECK-DCC-NET.
  4639
  4640     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4641        AND (CP-EARN-AS-NET-PAY)
  4642        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  4643             AND 'H' AND 'S' AND 'P')
  4644        CONTINUE
  4645     ELSE
  4646        GO TO 12001-CHECK-DCC-PNET
  4647     END-IF
  4648
  4649     COMPUTE CP-TERM-OR-EXT-DAYS =
  4650           CP-TERM-OR-EXT-DAYS + 30
  4651
  4652     COMPUTE ANGLEN EQUAL WK1 / I.
  4653     COMPUTE ANGLEM EQUAL WK2 / I.
  4654     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4655
  4656     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4657           / (1 + I)
  4658     COMPUTE GR     = ANGLEN / ODF
  4659     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4660     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4661       CP-RATE-DEV-PCT
  4662     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4663*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4664
  4665     COMPUTE WK8 = CP-PREMIUM-RATE *
  4666        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  4667     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4668     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4669     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4670       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4671     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4672     MOVE WK3                    TO CP-CALC-PREMIUM
  4673
  4674     GO TO 99999-RETURN
  4675
  4676     .
  4677 12001-CHECK-DCC-PNET.
  4678     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4679        AND (CP-EARN-AS-NET-PAY)
  4680        AND (CP-BENEFIT-CD (1:1) = 'P')
  4681        CONTINUE
  4682     ELSE
  4683        GO TO 12001-CHECK-DCC-MNET
  4684     END-IF
  4685     IF CP-NO-OF-PMTS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  86
* ELRFND.cbl
  4686        MOVE +0                  TO CP-NO-OF-PMTS
  4687     END-IF
  4688     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  4689        AND ' ' AND 'M'
  4690        MOVE ' '                 TO CP-PMT-MODE
  4691     END-IF
  4692******************************************************************
  4693***   Default is monthly, use loan term for rate and amort     ***
  4694******************************************************************
  4695     move cp-loan-term         to c-tot-pmts
  4696     MOVE +30                  TO C-DAYS-IN-PMT-PER
  4697     MOVE +12                  TO C-PMTS-PER-YEAR
  4698******************************************************************
  4699
  4700     evaluate true
  4701        when cp-pmt-mode = 'W'
  4702           MOVE +52              TO C-PMTS-PER-YEAR
  4703           compute c-tot-pmts = cp-loan-term /
  4704              12 * c-pmts-per-year
  4705           MOVE +7               TO C-DAYS-IN-PMT-PER
  4706        when cp-pmt-mode = 'B'
  4707           MOVE +26              TO C-PMTS-PER-YEAR
  4708           compute c-tot-pmts = cp-loan-term /
  4709              12 * c-pmts-per-year
  4710           MOVE +14              TO C-DAYS-IN-PMT-PER
  4711     end-evaluate
  4712     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4713     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4714        C-DAYS-IN-PMT-PER)) / (1 + I)
  4715     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  4716*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  4717     COMPUTE ANGLEN-1 = ANGLEN / Y
  4718     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4719     IF CP-RATE-DEV-PCT NOT = ZEROS
  4720        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4721           CP-PREMIUM-RATE
  4722     END-IF
  4723     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  4724     GO TO 99999-RETURN
  4725     .
  4726 12001-CHECK-DCC-MNET.
  4727
  4728     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4729        AND (CP-EARN-AS-NET-PAY)
  4730        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4731        CONTINUE
  4732     ELSE
  4733        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  4734     END-IF
  4735
  4736*    COMPUTE ANGLEN EQUAL WK1 / I.
  4737*    COMPUTE ANGLEM EQUAL WK2 / I.
  4738*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  4739
  4740     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  4741     MOVE WK3                    TO CP-CALC-PREMIUM
  4742
  4743     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  87
* ELRFND.cbl
  4744
  4745     .
  4746 12001-CHECK-DCC-MNET-LF-BAL.
  4747
  4748     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4749        AND (CP-EARN-AS-NET-PAY)
  4750        AND (CP-BENEFIT-CD (1:1) = 'N')
  4751        AND (CP-BEN-CATEGORY NOT = 'N')
  4752        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4753        CONTINUE
  4754     ELSE
  4755        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4756     END-IF
  4757
  4758     IF CP-RATE-DEV-PCT NOT = ZEROS
  4759        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4760           CP-PREMIUM-RATE
  4761     END-IF
  4762*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4763     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4764        / (1 + I)
  4765     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4766     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4767     COMPUTE WK2 = (1 + J) ** (M * -1)
  4768     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4769     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4770          ** ((M - 1) * -1))) / J)
  4771     COMPUTE ANGLEM = ((1 - ((1 + J)
  4772          ** (M * -1))) / J) / OD
  4773     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4774        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4775        / ANGLEM-1
  4776     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4777          ** ((N - M) * -1))) / I)
  4778     MOVE +0                     TO WK3
  4779     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4780        (WS-COUNTER > M)
  4781        COMPUTE ANGLEM = (1 - ((1 + J)
  4782          ** ((M - WS-COUNTER) * -1))) / J
  4783        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4784        COMPUTE WK5-CSL = (RA * ANGLEM)
  4785        + (CP-ALTERNATE-BENEFIT * WK2)
  4786        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4787     END-PERFORM
  4788     MOVE WK3                    TO CP-CALC-PREMIUM
  4789
  4790     GO TO 99999-RETURN
  4791
  4792     .
  4793 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4794
  4795     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4796        AND (CP-EARN-AS-NET-PAY)
  4797        AND (CP-BENEFIT-CD (1:1) = 'S')
  4798        AND (CP-BEN-CATEGORY NOT = 'N')
  4799        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4800        CONTINUE
  4801     ELSE
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  88
* ELRFND.cbl
  4802        GO TO 12001-CHECK-DCC-MNET-LF
  4803     END-IF
  4804
  4805     IF CP-RATE-DEV-PCT NOT = ZEROS
  4806        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4807           CP-PREMIUM-RATE
  4808     END-IF
  4809     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4810     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4811          ** ((M - 1) * -1))) / K)
  4812     COMPUTE ANGLEM = ((1 - ((1 + K)
  4813          ** (M * -1))) / K)
  4814     MOVE CP-MONTHLY-PAYMENT     TO RA
  4815     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4816        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4817        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4818        CP-PREMIUM-RATE / 1000
  4819     MOVE WK3                    TO CP-CALC-PREMIUM
  4820
  4821     GO TO 99999-RETURN
  4822
  4823     .
  4824 12001-CHECK-DCC-MNET-LF.
  4825
  4826     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4827        AND (CP-EARN-AS-NET-PAY)
  4828        AND (CP-BENEFIT-CD (1:1) = 'N')
  4829        AND (CP-BEN-CATEGORY NOT = 'N')
  4830        CONTINUE
  4831     ELSE
  4832        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4833     END-IF
  4834
  4835     IF CP-RATE-DEV-PCT NOT = ZEROS
  4836        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4837           CP-PREMIUM-RATE
  4838     END-IF
  4839*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4840     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4841        / (1 + I)
  4842     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4843     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4844     COMPUTE WK2 = (1 + J) ** (M * -1)
  4845     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4846     COMPUTE ANGLEM = ((1 - ((1 + J)
  4847          ** (M * -1))) / J) / OD
  4848     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4849     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4850          ** ((N - M) * -1))) / I)
  4851     MOVE +0                     TO WK3
  4852     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4853        (WS-COUNTER > M)
  4854        COMPUTE ANGLEM = (1 - ((1 + J)
  4855          ** ((M - WS-COUNTER + 1) * -1))) / J
  4856        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4857        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4858        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4859     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  89
* ELRFND.cbl
  4860     MOVE WK3                    TO CP-CALC-PREMIUM
  4861
  4862     GO TO 99999-RETURN
  4863
  4864     .
  4865 12001-CHECK-DCC-MNET-SUMLF.
  4866
  4867     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4868        AND (CP-EARN-AS-NET-PAY)
  4869        AND (CP-BENEFIT-CD (1:1) = 'S')
  4870        AND (CP-BEN-CATEGORY NOT = 'N')
  4871        CONTINUE
  4872     ELSE
  4873        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4874     END-IF
  4875
  4876     IF CP-RATE-DEV-PCT NOT = ZEROS
  4877        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4878           CP-PREMIUM-RATE
  4879     END-IF
  4880     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4881     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4882        / (1 + K)
  4883     COMPUTE ANGLEN-M = (WK5 / I)
  4884     COMPUTE WK2 = (1 + K) ** (M * -1)
  4885     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4886     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4887     COMPUTE ANGLEM = ((1 - ((1 + K)
  4888          ** (M * -1))) / K) / Y
  4889     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4890     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4891        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4892        - 1)) / K) * RA
  4893     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4894        + (CP-DAYS-TO-1ST-PMT - +30)
  4895        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4896        +0 / 1000 * 12 / 12)
  4897     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4898        * (12 / 12)
  4899     MOVE WK3                    TO CP-CALC-PREMIUM
  4900
  4901     GO TO 99999-RETURN
  4902
  4903     .
  4904 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4905
  4906     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4907        AND (CP-EARN-AS-NET-PAY)
  4908        AND (CP-BENEFIT-CD (1:1) = 'N')
  4909        AND (CP-BEN-CATEGORY = 'N')
  4910        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4911        CONTINUE
  4912     ELSE
  4913        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  4914     END-IF
  4915
  4916*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4917     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  90
* ELRFND.cbl
  4918        / (1 + I)
  4919     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4920     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  4921     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4922     COMPUTE WK2 = (1 + J) ** (M * -1)
  4923     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4924     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4925          ** ((M - 1) * -1))) / J)
  4926     COMPUTE ANGLEM = ((1 - ((1 + J)
  4927          ** (M * -1))) / J) / OD
  4928     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4929        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  4930        / ANGLEM-1
  4931     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4932          ** ((N - M) * -1))) / I)
  4933     MOVE +0                     TO WK3
  4934     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4935        (WS-COUNTER > M)
  4936        COMPUTE ANGLEM = (1 - ((1 + J)
  4937          ** ((M - WS-COUNTER) * -1))) / J
  4938        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  4939        COMPUTE WK5-CSL = (RA * ANGLEM)
  4940        + (CP-ALTERNATE-BENEFIT * WK2)
  4941        COMPUTE WK3 = WK3 +
  4942         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  4943        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  4944          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  4945          (CP-DCC-AH-RATE / 1000)
  4946     END-PERFORM
  4947     MOVE WK3                    TO CP-CALC-PREMIUM
  4948
  4949     GO TO 99999-RETURN
  4950
  4951     .
  4952 12001-CHECK-DCC-MNET-TOT-BAL-S.
  4953
  4954     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4955        AND (CP-EARN-AS-NET-PAY)
  4956        AND (CP-BENEFIT-CD (1:1) = 'S')
  4957        AND (CP-BEN-CATEGORY = 'N')
  4958        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4959        CONTINUE
  4960     ELSE
  4961        GO TO 12001-CHECK-DCC-MNET-TOT-N
  4962     END-IF
  4963
  4964     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4965     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4966          ** ((M - 1) * -1))) / K)
  4967     COMPUTE ANGLEM = ((1 - ((1 + K)
  4968          ** (M * -1))) / K)
  4969     MOVE CP-MONTHLY-PAYMENT     TO RA
  4970     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4971        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  4972        * CP-DCC-AH-RATE / 1000))
  4973        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4974        CP-DCC-LF-RATE / 1000
  4975     MOVE WK3                    TO CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  91
* ELRFND.cbl
  4976     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  4977        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  4978        * CP-DCC-AH-RATE / 1000
  4979     COMPUTE WK3 = WK3 + WK5-CSL
  4980     MOVE WK3                    TO CP-CALC-PREMIUM
  4981
  4982     GO TO 99999-RETURN
  4983      .
  4984 12001-CHECK-DCC-MNET-TOT-N.
  4985
  4986     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4987        AND (CP-EARN-AS-NET-PAY)
  4988        AND (CP-BENEFIT-CD (1:1) = 'N')
  4989        AND (CP-BEN-CATEGORY = 'N')
  4990        CONTINUE
  4991     ELSE
  4992        GO TO 12001-CHECK-DCC-MNET-TOT-S
  4993     END-IF
  4994
  4995*    I = APR/1200
  4996*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4997*    RA = PAYMENT AMOUNT
  4998*    WK5-CSL = THE BALANCE (PAY OFF )
  4999*    WK3 = THE ACCUMULATED PREMIUM
  5000*    WK2 = (1 + I) ^ (m * -1)
  5001*    OD  = GAMMA
  5002*
  5003*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5004     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5005        / (1 + I)
  5006     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5007     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5008        (CP-DCC-AH-RATE / +1000)
  5009     COMPUTE WK2 = (1 + J) ** (M * -1)
  5010     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5011     COMPUTE ANGLEM = ((1 - ((1 + J)
  5012          ** (M * -1))) / J) / OD
  5013     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5014     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5015          ** ((N - M) * -1))) / I)
  5016     MOVE +0                     TO WK3
  5017     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5018        (WS-COUNTER > M)
  5019        COMPUTE ANGLEM = (1 - ((1 + J)
  5020          ** ((M - WS-COUNTER + 1) * -1))) / J
  5021        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5022        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5023        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5024           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5025     END-PERFORM
  5026     MOVE WK3                    TO CP-CALC-PREMIUM
  5027
  5028     GO TO 99999-RETURN
  5029
  5030     .
  5031 12001-CHECK-DCC-MNET-TOT-S.
  5032
  5033     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  92
* ELRFND.cbl
  5034        AND (CP-EARN-AS-NET-PAY)
  5035        AND (CP-BENEFIT-CD (1:1) = 'S')
  5036        AND (CP-BEN-CATEGORY = 'N')
  5037        CONTINUE
  5038     ELSE
  5039        GO TO 12001-CONTINUE-NET
  5040     END-IF
  5041
  5042*    I = APR/1200
  5043*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5044*    RA = PAYMENT AMOUNT
  5045*    WK5-CSL = THE BALANCE (PAY OFF )
  5046*    WK3 = THE ACCUMULATED PREMIUM
  5047*    WK2 = (1 + I) ^ (m * -1)
  5048*    OD  = GAMMA
  5049*
  5050     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5051     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5052        / (1 + J)
  5053     COMPUTE ANGLEM = ((1 - ((1 + J)
  5054          ** (M * -1))) / J) / OD
  5055     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5056          ** ((N - M) * -1))) / I)
  5057          * (1 + J) ** (-1 * M)
  5058     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5059     MOVE CP-MONTHLY-PAYMENT     TO RA
  5060     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5061        / +30)
  5062     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5063        ** (WK1) - 1)) / J) * RA
  5064     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5065        + (CP-DAYS-TO-1ST-PMT - +30)
  5066        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5067        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5068     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5069        (12 / 12)
  5070     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5071        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5072        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5073     COMPUTE WK3 = WK3 + WK5-CSL
  5074     MOVE WK3                    TO CP-CALC-PREMIUM
  5075     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5076     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5077        / (1 + K)
  5078     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5079          ** ((N - M) * -1))) / I)
  5080     COMPUTE WK2 = (1 + K) ** (M * -1)
  5081     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5082     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5083     COMPUTE ANGLEM = ((1 - ((1 + K)
  5084          ** (M * -1))) / K) / Y
  5085*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5086     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5087        ((1 + K) ** (M + 1 / Y
  5088        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5089        - 1)) / K) * RA
  5090     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5091        + (CP-DAYS-TO-1ST-PMT - +30)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  93
* ELRFND.cbl
  5092        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5093        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5094     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5095        * (12 / 12)
  5096     MOVE WK3                    TO CP-LF-PREM
  5097
  5098     GO TO 99999-RETURN
  5099
  5100     .
  5101 12001-CONTINUE-NET.
  5102
  5103     IF NET-STD
  5104        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  5105*          OR 'DCC'
  5106         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5107         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5108         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5109         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5110                               * ((1 + N) / (1 + M))
  5111         if (i = .0000000001)
  5112            and (wk3 = zeros)
  5113            move 1               to wk3
  5114         end-if
  5115        ELSE
  5116         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5117         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5118         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5119         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  5120
  5121     IF NET-SMP
  5122         COMPUTE N2 = N * N
  5123         COMPUTE N3 = N2 * N
  5124         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  5125         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  5126         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  5127         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  5128         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  5129
  5130     IF NPO-PRUDENTIAL
  5131       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  5132           VARYING WS-COUNTER FROM 1 BY 1
  5133               UNTIL WS-COUNTER = N
  5134       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  5135       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  5136
  5137     MOVE WK3 TO FACTOR.
  5138
  5139     GO TO 99999-RETURN.
  5140
  5141 12100-PRU-CALC.
  5142     IF WS-COUNTER = 1
  5143         COMPUTE PWK = (I + 1)
  5144     ELSE
  5145         COMPUTE PWK = PWK * (I + 1).
  5146
  5147 12199-EXIT.
  5148      EXIT.
  5149
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  94
* ELRFND.cbl
  5150 99000-ERROR.
  5151     MOVE +9999.999999999 TO N-P-FACTOR.
  5152     MOVE '4'             TO CP-RETURN-CODE.
  5153
  5154     GO TO 99999-EXIT.
  5155
  5156 99999-RETURN.
  5157     MOVE FACTOR          TO N-P-FACTOR.
  5158
  5159 99999-EXIT.
  5160      EXIT.
  5161
  5162 9999-DFHBACK SECTION.
  5163     MOVE '9%                    "   ' TO DFHEIV0
  5164     MOVE 'ELRFND' TO DFHEIV1
  5165     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5166     GOBACK.
  5167 9999-DFHEXIT.
  5168     IF DFHEIGDJ EQUAL 0001
  5169         NEXT SENTENCE.
  5170     MOVE '9%                    "   ' TO DFHEIV0
  5171     MOVE 'ELRFND' TO DFHEIV1
  5172     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5173     GOBACK.
*
* Program-Id : ELRFND
* Line   Data Name                       Address    Size      Attributes
* 000062 DFH-START . . . . . . . . . . . 0000000352 00000004  WS E    AlphNum
* 000063 Filler. . . . . . . . . . . . . 0000000360 00000032  WS E    AlphNum
* 000064 Filler. . . . . . . . . . . . . 0000000392 00000032  WS E    AlphNum
* 000065 Filler. . . . . . . . . . . . . 0000000424 00000032  WS E    AlphNum
* 000066 WS-UE-CLP . . . . . . . . . . . 0000000456 00000004  WS E    Comp-3
* 000067 WS-GFR3 . . . . . . . . . . . . 0000000464 00000004  WS E    Comp-3
* 000068 WS-MONTH. . . . . . . . . . . . 0000000472 00000002  WS E    Comp-3
* 000070 WS-WORK-MISC. . . . . . . . . . 0000000480 00000128  WS G    AlphNum
* 000071 WS-REMAINING-TERM . . . . . . . 0000000480 00000003  WS E    Comp-3
* 000072 WS-TEMP-RESULT. . . . . . . . . 0000000483 00000007  WS E    Comp-3
* 000073 WS-REMAINING-AMT. . . . . . . . 0000000490 00000007  WS E    Comp-3
* 000074 WS-ORIG-PREM. . . . . . . . . . 0000000497 00000007  WS E    Comp-3
* 000075 WS-REMAIN-PREM. . . . . . . . . 0000000504 00000007  WS E    Comp-3
* 000076 WS-NP-REF-FACTOR. . . . . . . . 0000000511 00000008  WS E    Comp-3
* 000077 WS-SAVE-TERM. . . . . . . . . . 0000000519 00000002  WS E    Comp-3
* 000078 WS-SAVE-LOAN-TERM . . . . . . . 0000000521 00000002  WS E    Comp-3
* 000079 WS-SAVE-BENEFIT . . . . . . . . 0000000523 00000006  WS E    Comp-3
* 000080 WS-SAVE-EARN-METHOD . . . . . . 0000000529 00000001  WS E    AlphNum
* 000081 WS-SAVE-EXT-DAYS. . . . . . . . 0000000530 00000003  WS E    Comp-3
* 000082 CAL-RFND. . . . . . . . . . . . 0000000533 00000004  WS E    Comp-3
* 000083 FACTOR-1. . . . . . . . . . . . 0000000537 00000008  WS E    Comp-3
* 000084 FACTOR-2. . . . . . . . . . . . 0000000545 00000008  WS E    Comp-3
* 000085 FACTOR-3. . . . . . . . . . . . 0000000553 00000008  WS E    Comp-3
* 000086 FACTOR-4. . . . . . . . . . . . 0000000561 00000008  WS E    Comp-3
* 000087 FACTOR-5. . . . . . . . . . . . 0000000569 00000004  WS E    Comp-3
* 000088 FACTOR-6. . . . . . . . . . . . 0000000573 00000004  WS E    Comp-3
* 000089 RATE-FACTOR-1 . . . . . . . . . 0000000577 00000002  WS E    Comp-3
* 000090 RATE-FACTOR-2 . . . . . . . . . 0000000579 00000002  WS E    Comp-3
* 000091 R78-FACTOR. . . . . . . . . . . 0000000581 00000008  WS E    Comp-3
* 000092 PR-FACTOR . . . . . . . . . . . 0000000589 00000008  WS E    Comp-3
* 000093 RSUM-FACTOR . . . . . . . . . . 0000000597 00000008  WS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  95
* ELRFND.cbl
* 000094 RSUM-REMAINING-TERM . . . . . . 0000000605 00000003  WS E    Comp-3
* 000096 TEXAS-REG-WORK-AREAS. . . . . . 0000000608 00000033  WS G    AlphNum
* 000097 TEX-FACT-1. . . . . . . . . . . 0000000608 00000005  WS E    Comp-3
* 000098 TEX-FACT-2. . . . . . . . . . . 0000000613 00000002  WS E    Comp-3
* 000099 TEX-FACT-3. . . . . . . . . . . 0000000615 00000002  WS E    Comp-3
* 000100 TEX-FACT-4. . . . . . . . . . . 0000000617 00000004  WS E    Comp-3
* 000101 TEX-FACT-5. . . . . . . . . . . 0000000621 00000002  WS E    Comp-3
* 000102 TEX-FACT-6. . . . . . . . . . . 0000000623 00000002  WS E    Comp-3
* 000103 TEX-FACT-7. . . . . . . . . . . 0000000625 00000004  WS E    Comp-3
* 000104 TEX-FACT-8. . . . . . . . . . . 0000000629 00000004  WS E    Comp-3
* 000105 TEX-FACT-9. . . . . . . . . . . 0000000633 00000008  WS E    Comp-3
* 000107 NET-PAY-INTERFACE . . . . . . . 0000000648 00000018  WS G    AlphNum
* 000108 N-P-APR . . . . . . . . . . . . 0000000648 00000004  WS E    Comp-3
* 000109 N-P-ORIG. . . . . . . . . . . . 0000000652 00000002  WS E    Comp-3
* 000110 N-P-REM . . . . . . . . . . . . 0000000654 00000002  WS E    Comp-3
* 000111 N-P-OPT . . . . . . . . . . . . 0000000656 00000001  WS E    AlphNum
* 000112 N-P-LOAN. . . . . . . . . . . . 0000000657 00000002  WS E    Comp-3
* 000113 N-P-FACTOR. . . . . . . . . . . 0000000659 00000007  WS E    Comp-3
* 000140 NET-PAY-WORK-AREA . . . . . . . 0000000672 00000638  WS G    AlphNum
* 000141 OPTION-SW . . . . . . . . . . . 0000000672 00000001  WS E    AlphNum
* 000157 TYPE-SW . . . . . . . . . . . . 0000000673 00000001  WS E    AlphNum
* 000161 NP-PROCESS-SW . . . . . . . . . 0000000674 00000001  WS E    AlphNum
* 000166 COMP-3-WORK-AREA. . . . . . . . 0000000675 00000530  WS G    AlphNum
* 000167 WS-WORK-DIS-RATE. . . . . . . . 0000000675 00000005  WS E    Comp-3
* 000168 V . . . . . . . . . . . . . . . 0000000680 00000007  WS E    Comp-3
* 000169 J . . . . . . . . . . . . . . . 0000000687 00000005  WS E    Comp-3
* 000170 K . . . . . . . . . . . . . . . 0000000692 00000005  WS E    Comp-3
* 000171 I . . . . . . . . . . . . . . . 0000000697 00000006  WS E    Comp-3
* 000172 D . . . . . . . . . . . . . . . 0000000703 00000003  WS E    Comp-3
* 000173 APR100. . . . . . . . . . . . . 0000000706 00000005  WS E    Comp-3
* 000174 RA. . . . . . . . . . . . . . . 0000000711 00000008  WS E    Comp-3
* 000175 WK1 . . . . . . . . . . . . . . 0000000719 00000009  WS E    Comp-3
* 000176 WK2 . . . . . . . . . . . . . . 0000000728 00000009  WS E    Comp-3
* 000177 PEMA. . . . . . . . . . . . . . 0000000737 00000009  WS E    Comp-3
* 000178 WK3 . . . . . . . . . . . . . . 0000000746 00000009  WS E    Comp-3
* 000179 WK4 . . . . . . . . . . . . . . 0000000755 00000008  WS E    Comp-3
* 000180 WK5 . . . . . . . . . . . . . . 0000000763 00000010  WS E    Comp-3
* 000181 WK5-CSL . . . . . . . . . . . . 0000000773 00000008  WS E    Comp-3
* 000182 WK6 . . . . . . . . . . . . . . 0000000781 00000009  WS E    Comp-3
* 000183 WK7 . . . . . . . . . . . . . . 0000000790 00000009  WS E    Comp-3
* 000184 WK8 . . . . . . . . . . . . . . 0000000799 00000007  WS E    Comp-3
* 000185 WK9 . . . . . . . . . . . . . . 0000000806 00000007  WS E    Comp-3
* 000186 GR. . . . . . . . . . . . . . . 0000000813 00000009  WS E    Comp-3
* 000187 ONE-PLUS-I. . . . . . . . . . . 0000000822 00000007  WS E    Comp-3
* 000188 ODF . . . . . . . . . . . . . . 0000000829 00000007  WS E    Comp-3
* 000189 OD. . . . . . . . . . . . . . . 0000000836 00000007  WS E    Comp-3
* 000190 FM. . . . . . . . . . . . . . . 0000000843 00000007  WS E    Comp-3
* 000191 FN. . . . . . . . . . . . . . . 0000000850 00000007  WS E    Comp-3
* 000192 FNM . . . . . . . . . . . . . . 0000000857 00000007  WS E    Comp-3
* 000193 ANGLEM. . . . . . . . . . . . . 0000000864 00000010  WS E    Comp-3
* 000194 ANGLEMY . . . . . . . . . . . . 0000000874 00000010  WS E    Comp-3
* 000195 ANGLEMP1. . . . . . . . . . . . 0000000884 00000010  WS E    Comp-3
* 000196 ANGLEN. . . . . . . . . . . . . 0000000894 00000010  WS E    Comp-3
* 000197 ANGLENY . . . . . . . . . . . . 0000000904 00000010  WS E    Comp-3
* 000198 ANGLEN-M. . . . . . . . . . . . 0000000914 00000010  WS E    Comp-3
* 000199 ANGLEN-MP1. . . . . . . . . . . 0000000924 00000010  WS E    Comp-3
* 000200 ANGLEN-MP1Y . . . . . . . . . . 0000000934 00000010  WS E    Comp-3
* 000201 ANGLEN-1. . . . . . . . . . . . 0000000944 00000009  WS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  96
* ELRFND.cbl
* 000202 ANGLEM-1. . . . . . . . . . . . 0000000953 00000009  WS E    Comp-3
* 000203 ANGLEM-1Y . . . . . . . . . . . 0000000962 00000009  WS E    Comp-3
* 000204 ANGLEM-T. . . . . . . . . . . . 0000000971 00000010  WS E    Comp-3
* 000205 PVBALLOON . . . . . . . . . . . 0000000981 00000005  WS E    Comp-3
* 000206 TRUNC-PMT . . . . . . . . . . . 0000000986 00000005  WS E    Comp-3
* 000207 K1. . . . . . . . . . . . . . . 0000000991 00000002  WS E    Comp-3
* 000208 K12 . . . . . . . . . . . . . . 0000000993 00000002  WS E    Comp-3
* 000209 K100. . . . . . . . . . . . . . 0000000995 00000002  WS E    Comp-3
* 000210 K1000 . . . . . . . . . . . . . 0000000997 00000004  WS E    Comp-3
* 000211 NC-LR . . . . . . . . . . . . . 0000001001 00000004  WS E    Comp-3
* 000212 Y . . . . . . . . . . . . . . . 0000001001 00000004  WS E    Comp-3     R
* 000214 TI. . . . . . . . . . . . . . . 0000001005 00000005  WS E    Comp-3
* 000215 NC-R. . . . . . . . . . . . . . 0000001010 00000009  WS E    Comp-3
* 000216 NC-OB . . . . . . . . . . . . . 0000001019 00000009  WS E    Comp-3
* 000217 NC-P. . . . . . . . . . . . . . 0000001028 00000009  WS E    Comp-3
* 000218 NC-D. . . . . . . . . . . . . . 0000001037 00000009  WS E    Comp-3
* 000219 NC-BIG-D. . . . . . . . . . . . 0000001046 00000002  WS E    Comp-3
* 000220 NC-LITTLE-D . . . . . . . . . . 0000001048 00000005  WS E    Comp-3
* 000221 NC-MP . . . . . . . . . . . . . 0000001053 00000004  WS E    Comp-3
* 000222 NC-LP . . . . . . . . . . . . . 0000001057 00000004  WS E    Comp-3
* 000224 CA-MP . . . . . . . . . . . . . 0000001061 00000004  WS E    Comp-3
* 000225 CA-API. . . . . . . . . . . . . 0000001065 00000006  WS E    Comp-3
* 000226 CA-APJ. . . . . . . . . . . . . 0000001071 00000006  WS E    Comp-3
* 000227 CA-VI . . . . . . . . . . . . . 0000001077 00000006  WS E    Comp-3
* 000228 CA-J. . . . . . . . . . . . . . 0000001083 00000006  WS E    Comp-3
* 000229 CA-DISCOUNT . . . . . . . . . . 0000001089 00000006  WS E    Comp-3
* 000230 GTL-IA-DIVIDEND . . . . . . . . 0000001095 00000007  WS E    Comp-3
* 000231 GTL-IA-DIVISOR. . . . . . . . . 0000001102 00000007  WS E    Comp-3
* 000232 GTL-IA-FACTOR . . . . . . . . . 0000001109 00000007  WS E    Comp-3
* 000233 GTL-IA-ODF. . . . . . . . . . . 0000001116 00000007  WS E    Comp-3
* 000234 GTL-IA-ODD-DAYS . . . . . . . . 0000001123 00000002  WS E    Comp-3
* 000235 GTL-IA-SGN. . . . . . . . . . . 0000001125 00000001  WS E    Comp-3
* 000236 GTL-IA-ABS. . . . . . . . . . . 0000001126 00000002  WS E    Comp-3
* 000238 ANNUAL-INT-RATE . . . . . . . . 0000001128 00000004  WS E    Comp-3
* 000240 ORIGINAL-TERM . . . . . . . . . 0000001132 00000002  WS E    Comp-3
* 000241 M . . . . . . . . . . . . . . . 0000001132 00000002  WS E    Comp-3     R
* 000244 REMAINING-TERM. . . . . . . . . 0000001134 00000002  WS E    Comp-3
* 000245 R . . . . . . . . . . . . . . . 0000001134 00000002  WS E    Comp-3     R
* 000248 LOAN-TERM . . . . . . . . . . . 0000001136 00000002  WS E    Comp-3
* 000249 N . . . . . . . . . . . . . . . 0000001136 00000002  WS E    Comp-3     R
* 000252 EXPIRED-TERM. . . . . . . . . . 0000001138 00000002  WS E    Comp-3
* 000253 E . . . . . . . . . . . . . . . 0000001138 00000002  WS E    Comp-3     R
* 000256 PRUDENTIAL-WORK-AMT . . . . . . 0000001140 00000008  WS E    Comp-3
* 000258 PWK . . . . . . . . . . . . . . 0000001140 00000008  WS E    Comp-3     R
* 000261 FACTOR. . . . . . . . . . . . . 0000001148 00000007  WS E    Comp-3
* 000262 VX. . . . . . . . . . . . . . . 0000001155 00000008  WS E    Comp-3
* 000263 SV. . . . . . . . . . . . . . . 0000001163 00000008  WS E    Comp-3
* 000264 SV-MINUS-ONE. . . . . . . . . . 0000001171 00000007  WS E    Comp-3
* 000265 SX. . . . . . . . . . . . . . . 0000001178 00000008  WS E    Comp-3
* 000266 SE. . . . . . . . . . . . . . . 0000001186 00000006  WS E    Comp-3
* 000267 N2. . . . . . . . . . . . . . . 0000001192 00000004  WS E    Comp-3
* 000268 N3. . . . . . . . . . . . . . . 0000001196 00000004  WS E    Comp-3
* 000269 K-I . . . . . . . . . . . . . . 0000001200 00000005  WS E    Comp-3
* 000271 BINARY-WORK-AREA. . . . . . . . 0000001205 00000016  WS G    AlphNum
* 000272 X1. . . . . . . . . . . . . . . 0000001205 00000002  WS E    Comp
* 000273 X2. . . . . . . . . . . . . . . 0000001207 00000002  WS E    Comp
* 000274 MAX-X . . . . . . . . . . . . . 0000001209 00000004  WS E    Comp
* 000275 B1. . . . . . . . . . . . . . . 0000001213 00000004  WS E    Comp
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  97
* ELRFND.cbl
* 000276 LINDX . . . . . . . . . . . . . 0000001217 00000002  WS E    Comp
* 000277 AHNDX . . . . . . . . . . . . . 0000001219 00000002  WS E    Comp
* 000279 CSO-RATE-WORK-AREAS . . . . . . 0000001221 00000007  WS G    AlphNum
* 000280 C-PMTS-PER-YEAR . . . . . . . . 0000001221 00000003  WS E    Comp-3
* 000281 C-DAYS-IN-PMT-PER . . . . . . . 0000001224 00000002  WS E    Comp-3
* 000282 C-TOT-PMTS. . . . . . . . . . . 0000001226 00000002  WS E    Comp-3
* 000283 WS-WORK-MISC. . . . . . . . . . 0000001228 00000082  WS G    AlphNum
* 000284 WS-EXTRA-PMTS . . . . . . . . . 0000001228 00000002  WS E    Comp-3
* 000285 NET-BEN . . . . . . . . . . . . 0000001230 00000007  WS E    Comp-3
* 000286 WS-RATE-TERM. . . . . . . . . . 0000001237 00000002  WS E    Comp-3
* 000288 WS-AGE. . . . . . . . . . . . . 0000001239 00000003  WS E    Comp-3
* 000289 WS-AH-FACE-BENEFIT. . . . . . . 0000001242 00000004  WS E    Comp-3
* 000290 WS-COUNTER. . . . . . . . . . . 0000001246 00000002  WS E    Comp-3
* 000291 WS-WORK-RATE. . . . . . . . . . 0000001248 00000006  WS E    Comp-3
* 000292 WS-DISCOUNT-OPTION. . . . . . . 0000001254 00000001  WS E    AlphNum
* 000293 WS-DUE-DATE . . . . . . . . . . 0000001255 00000004  WS E    Comp-3
* 000294 WS-INT-BEGIN-DATE . . . . . . . 0000001259 00000004  WS E    Comp-3
* 000295 WS-X-Y-FACTOR . . . . . . . . . 0000001263 00000010  WS E    Comp-3
* 000296 WS-Y-X-FACTOR . . . . . . . . . 0000001273 00000010  WS E    Comp-3
* 000297 WS-ODD-DAY-UNITS. . . . . . . . 0000001283 00000010  WS E    Comp-3
* 000298 WS-CALC-FREQ-RATE . . . . . . . 0000001293 00000009  WS E    Comp-3
* 000299 WS-NP-FACTOR. . . . . . . . . . 0000001302 00000008  WS E    Comp-3
* 000315 DATE-CONVERSION-DATA. . . . . . 0000001312 00000200  WS G    AlphNum
* 000316 DC-COMM-LENGTH. . . . . . . . . 0000001312 00000002  WS E    Comp
* 000317 DC-OPTION-CODE. . . . . . . . . 0000001314 00000001  WS E    AlphNum
* 000354 DC-ERROR-CODE . . . . . . . . . 0000001315 00000001  WS E    AlphNum
* 000368 DC-END-OF-MONTH . . . . . . . . 0000001316 00000001  WS E    AlphNum
* 000370 DC-CENTURY-ADJUSTMENT . . . . . 0000001317 00000001  WS E    AlphNum
* 000374 Filler. . . . . . . . . . . . . 0000001318 00000001  WS E    AlphNum
* 000375 DC-CONVERSION-DATES . . . . . . 0000001319 00000065  WS G    AlphNum
* 000376 DC-BIN-DATE-1 . . . . . . . . . 0000001319 00000002  WS E    AlphNum
* 000377 DC-BIN-DATE-2 . . . . . . . . . 0000001321 00000002  WS E    AlphNum
* 000378 DC-GREG-DATE-1-EDIT . . . . . . 0000001323 00000008  WS E    AlphNum
* 000379 DC-GREG-DATE-1-EDIT-R . . . . . 0000001323 00000008  WS G    AlphNum    R
* 000381 DC-EDIT1-MONTH. . . . . . . . . 0000001323 00000002  WS E    Display
* 000382 SLASH1-1. . . . . . . . . . . . 0000001325 00000001  WS E    AlphNum
* 000383 DC-EDIT1-DAY. . . . . . . . . . 0000001326 00000002  WS E    Display
* 000384 SLASH1-2. . . . . . . . . . . . 0000001328 00000001  WS E    AlphNum
* 000385 DC-EDIT1-YEAR . . . . . . . . . 0000001329 00000002  WS E    Display
* 000386 DC-GREG-DATE-2-EDIT . . . . . . 0000001331 00000008  WS E    AlphNum
* 000387 DC-GREG-DATE-2-EDIT-R . . . . . 0000001331 00000008  WS G    AlphNum    R
* 000389 DC-EDIT2-MONTH. . . . . . . . . 0000001331 00000002  WS E    Display
* 000390 SLASH2-1. . . . . . . . . . . . 0000001333 00000001  WS E    AlphNum
* 000391 DC-EDIT2-DAY. . . . . . . . . . 0000001334 00000002  WS E    Display
* 000392 SLASH2-2. . . . . . . . . . . . 0000001336 00000001  WS E    AlphNum
* 000393 DC-EDIT2-YEAR . . . . . . . . . 0000001337 00000002  WS E    Display
* 000394 DC-GREG-DATE-1-YMD. . . . . . . 0000001339 00000006  WS E    Display
* 000395 DC-GREG-DATE-1-YMD-R. . . . . . 0000001339 00000006  WS G    AlphNum    R
* 000397 DC-YMD-YEAR . . . . . . . . . . 0000001339 00000002  WS E    Display
* 000398 DC-YMD-MONTH. . . . . . . . . . 0000001341 00000002  WS E    Display
* 000399 DC-YMD-DAY. . . . . . . . . . . 0000001343 00000002  WS E    Display
* 000400 DC-GREG-DATE-1-MDY. . . . . . . 0000001345 00000006  WS E    Display
* 000401 DC-GREG-DATE-1-MDY-R. . . . . . 0000001345 00000006  WS G    AlphNum    R
* 000403 DC-MDY-MONTH. . . . . . . . . . 0000001345 00000002  WS E    Display
* 000404 DC-MDY-DAY. . . . . . . . . . . 0000001347 00000002  WS E    Display
* 000405 DC-MDY-YEAR . . . . . . . . . . 0000001349 00000002  WS E    Display
* 000406 DC-GREG-DATE-1-ALPHA. . . . . . 0000001351 00000018  WS G    AlphNum
* 000407 DC-ALPHA-MONTH. . . . . . . . . 0000001351 00000010  WS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  98
* ELRFND.cbl
* 000408 DC-ALPHA-DAY. . . . . . . . . . 0000001361 00000002  WS E    Display
* 000409 Filler. . . . . . . . . . . . . 0000001363 00000002  WS E    AlphNum
* 000410 DC-ALPHA-CENTURY. . . . . . . . 0000001365 00000002  WS G    AlphNum
* 000411 DC-ALPHA-CEN-N. . . . . . . . . 0000001365 00000002  WS E    Display
* 000412 DC-ALPHA-YEAR . . . . . . . . . 0000001367 00000002  WS E    Display
* 000413 DC-ELAPSED-MONTHS . . . . . . . 0000001369 00000002  WS E    Comp
* 000414 DC-ODD-DAYS-OVER. . . . . . . . 0000001371 00000002  WS E    Comp
* 000415 DC-ELAPSED-DAYS . . . . . . . . 0000001373 00000002  WS E    Comp
* 000416 DC-JULIAN-DATE. . . . . . . . . 0000001375 00000005  WS E    Display
* 000417 DC-JULIAN-YYDDD . . . . . . . . 0000001375 00000005  WS E    Display    R
* 000419 DC-JULIAN-DT. . . . . . . . . . 0000001375 00000005  WS G    AlphNum    R
* 000420 DC-JULIAN-YEAR. . . . . . . . . 0000001375 00000002  WS E    Display
* 000421 DC-JULIAN-DAYS. . . . . . . . . 0000001377 00000003  WS E    Display
* 000422 DC-DAYS-IN-MONTH. . . . . . . . 0000001380 00000002  WS E    Comp-3
* 000423 DC-DAY-OF-WEEK. . . . . . . . . 0000001382 00000001  WS E    Comp-3
* 000424 DC-DAY-OF-WEEK2 . . . . . . . . 0000001383 00000001  WS E    Comp-3
* 000425 DATE-CONVERSION-VARIBLES. . . . 0000001384 00000078  WS G    AlphNum
* 000426 HOLD-CENTURY-1. . . . . . . . . 0000001384 00000011  WS E    Display
* 000427 HOLD-CENTURY-1-SPLIT. . . . . . 0000001384 00000011  WS G    AlphNum    R
* 000428 Filler. . . . . . . . . . . . . 0000001384 00000003  WS E    Display
* 000429 HOLD-CEN-1-CCYY . . . . . . . . 0000001387 00000004  WS G    AlphNum
* 000430 HOLD-CEN-1-CC . . . . . . . . . 0000001387 00000002  WS E    Display
* 000431 HOLD-CEN-1-YY . . . . . . . . . 0000001389 00000002  WS E    Display
* 000432 HOLD-CEN-1-MO . . . . . . . . . 0000001391 00000002  WS E    Display
* 000433 HOLD-CEN-1-DA . . . . . . . . . 0000001393 00000002  WS E    Display
* 000434 HOLD-CENTURY-1-R. . . . . . . . 0000001384 00000011  WS G    AlphNum    R
* 000435 HOLD-CEN-1-R-MO . . . . . . . . 0000001384 00000002  WS E    Display
* 000436 HOLD-CEN-1-R-DA . . . . . . . . 0000001386 00000002  WS E    Display
* 000437 HOLD-CEN-1-R-CCYY . . . . . . . 0000001388 00000004  WS G    AlphNum
* 000438 HOLD-CEN-1-R-CC . . . . . . . . 0000001388 00000002  WS E    Display
* 000439 HOLD-CEN-1-R-YY . . . . . . . . 0000001390 00000002  WS E    Display
* 000440 Filler. . . . . . . . . . . . . 0000001392 00000003  WS E    Display
* 000441 HOLD-CENTURY-1-X. . . . . . . . 0000001395 00000011  WS G    AlphNum
* 000442 Filler. . . . . . . . . . . . . 0000001395 00000003  WS E    AlphNum
* 000443 HOLD-CEN-1-X-CCYY . . . . . . . 0000001398 00000004  WS G    AlphNum
* 000444 HOLD-CEN-1-X-CC . . . . . . . . 0000001398 00000002  WS E    AlphNum
* 000445 HOLD-CEN-1-X-YY . . . . . . . . 0000001400 00000002  WS E    AlphNum
* 000446 HOLD-CEN-1-X-MO . . . . . . . . 0000001402 00000002  WS E    AlphNum
* 000447 HOLD-CEN-1-X-DA . . . . . . . . 0000001404 00000002  WS E    AlphNum
* 000448 HOLD-CENTURY-1-R-X. . . . . . . 0000001395 00000011  WS G    AlphNum    R
* 000449 HOLD-CEN-1-R-X-MO . . . . . . . 0000001395 00000002  WS E    AlphNum
* 000450 HOLD-CEN-1-R-X-DA . . . . . . . 0000001397 00000002  WS E    AlphNum
* 000451 HOLD-CEN-1-R-X-CCYY . . . . . . 0000001399 00000004  WS G    AlphNum
* 000452 HOLD-CEN-1-R-X-CC . . . . . . . 0000001399 00000002  WS E    AlphNum
* 000453 HOLD-CEN-1-R-X-YY . . . . . . . 0000001401 00000002  WS E    AlphNum
* 000454 Filler. . . . . . . . . . . . . 0000001403 00000003  WS E    AlphNum
* 000455 DC-BIN-DATE-EXPAND-1. . . . . . 0000001406 00000003  WS E    AlphNum
* 000456 DC-BIN-DATE-EXPAND-2. . . . . . 0000001409 00000003  WS E    AlphNum
* 000457 DC-JULIAN-DATE-1. . . . . . . . 0000001412 00000007  WS E    Display
* 000458 DC-JULIAN-DATE-1-R. . . . . . . 0000001412 00000007  WS G    AlphNum    R
* 000459 DC-JULIAN-1-CCYY. . . . . . . . 0000001412 00000004  WS G    AlphNum
* 000460 DC-JULIAN-1-CC. . . . . . . . . 0000001412 00000002  WS E    Display
* 000461 DC-JULIAN-1-YR. . . . . . . . . 0000001414 00000002  WS E    Display
* 000462 DC-JULIAN-DA-1. . . . . . . . . 0000001416 00000003  WS E    Display
* 000463 DC-JULIAN-DATE-2. . . . . . . . 0000001419 00000007  WS E    Display
* 000464 DC-JULIAN-DATE-2-R. . . . . . . 0000001419 00000007  WS G    AlphNum    R
* 000465 DC-JULIAN-2-CCYY. . . . . . . . 0000001419 00000004  WS G    AlphNum
* 000466 DC-JULIAN-2-CC. . . . . . . . . 0000001419 00000002  WS E    Display
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page  99
* ELRFND.cbl
* 000467 DC-JULIAN-2-YR. . . . . . . . . 0000001421 00000002  WS E    Display
* 000468 DC-JULIAN-DA-2. . . . . . . . . 0000001423 00000003  WS E    Display
* 000469 DC-GREG-DATE-A-EDIT . . . . . . 0000001426 00000010  WS G    AlphNum
* 000470 DC-EDITA-MONTH. . . . . . . . . 0000001426 00000002  WS E    Display
* 000471 SLASHA-1. . . . . . . . . . . . 0000001428 00000001  WS E    AlphNum
* 000472 DC-EDITA-DAY. . . . . . . . . . 0000001429 00000002  WS E    Display
* 000473 SLASHA-2. . . . . . . . . . . . 0000001431 00000001  WS E    AlphNum
* 000474 DC-EDITA-CCYY . . . . . . . . . 0000001432 00000004  WS G    AlphNum
* 000475 DC-EDITA-CENT . . . . . . . . . 0000001432 00000002  WS E    Display
* 000476 DC-EDITA-YEAR . . . . . . . . . 0000001434 00000002  WS E    Display
* 000477 DC-GREG-DATE-B-EDIT . . . . . . 0000001436 00000010  WS G    AlphNum
* 000478 DC-EDITB-MONTH. . . . . . . . . 0000001436 00000002  WS E    Display
* 000479 SLASHB-1. . . . . . . . . . . . 0000001438 00000001  WS E    AlphNum
* 000480 DC-EDITB-DAY. . . . . . . . . . 0000001439 00000002  WS E    Display
* 000481 SLASHB-2. . . . . . . . . . . . 0000001441 00000001  WS E    AlphNum
* 000482 DC-EDITB-CCYY . . . . . . . . . 0000001442 00000004  WS G    AlphNum
* 000483 DC-EDITB-CENT . . . . . . . . . 0000001442 00000002  WS E    Display
* 000484 DC-EDITB-YEAR . . . . . . . . . 0000001444 00000002  WS E    Display
* 000485 DC-GREG-DATE-CYMD . . . . . . . 0000001446 00000008  WS E    Display
* 000486 DC-GREG-DATE-CYMD-R . . . . . . 0000001446 00000008  WS G    AlphNum    R
* 000488 DC-CYMD-CEN . . . . . . . . . . 0000001446 00000002  WS E    Display
* 000489 DC-CYMD-YEAR. . . . . . . . . . 0000001448 00000002  WS E    Display
* 000490 DC-CYMD-MONTH . . . . . . . . . 0000001450 00000002  WS E    Display
* 000491 DC-CYMD-DAY . . . . . . . . . . 0000001452 00000002  WS E    Display
* 000492 DC-GREG-DATE-MDCY . . . . . . . 0000001454 00000008  WS E    Display
* 000493 DC-GREG-DATE-MDCY-R . . . . . . 0000001454 00000008  WS G    AlphNum    R
* 000495 DC-MDCY-MONTH . . . . . . . . . 0000001454 00000002  WS E    Display
* 000496 DC-MDCY-DAY . . . . . . . . . . 0000001456 00000002  WS E    Display
* 000497 DC-MDCY-CEN . . . . . . . . . . 0000001458 00000002  WS E    Display
* 000498 DC-MDCY-YEAR. . . . . . . . . . 0000001460 00000002  WS E    Display
* 000499 DC-FORCE-EL310-DATE-SW. . . . . 0000001462 00000001  WS E    AlphNum
* 000501 DC-EL310-DATE . . . . . . . . . 0000001463 00000021  WS E    AlphNum
* 000502 Filler. . . . . . . . . . . . . 0000001484 00000028  WS E    AlphNum
* 000696 CALCULATION-PASS-AREA . . . . . 0000001512 00000450  WS G    AlphNum
* 000697 CP-COMM-LENGTH. . . . . . . . . 0000001512 00000002  WS E    Comp
* 000700 CP-RETURN-CODE. . . . . . . . . 0000001514 00000001  WS E    AlphNum
* 000723 CP-RETURN-CODE-2. . . . . . . . 0000001515 00000001  WS E    AlphNum
* 000727 CP-CALCULATION-AREA . . . . . . 0000001516 00000446  WS G    AlphNum
* 000728 CP-ACCOUNT-NUMBER . . . . . . . 0000001516 00000010  WS E    AlphNum
* 000729 CP-CERT-EFF-DT. . . . . . . . . 0000001526 00000002  WS E    AlphNum
* 000730 CP-VALUATION-DT . . . . . . . . 0000001528 00000002  WS E    AlphNum
* 000731 CP-PAID-THRU-DT . . . . . . . . 0000001530 00000002  WS E    AlphNum
* 000732 CP-BENEFIT-TYPE . . . . . . . . 0000001532 00000001  WS E    AlphNum
* 000737 CP-INCURRED-DT. . . . . . . . . 0000001533 00000002  WS E    AlphNum
* 000738 CP-REPORTED-DT. . . . . . . . . 0000001535 00000002  WS E    AlphNum
* 000739 CP-ACCT-FLD-5 . . . . . . . . . 0000001537 00000002  WS E    AlphNum
* 000740 CP-COMPANY-ID . . . . . . . . . 0000001539 00000003  WS E    AlphNum
* 000741 CP-ISSUE-AGE. . . . . . . . . . 0000001542 00000002  WS E    Comp-3
* 000743 CP-CDT-PERCENT. . . . . . . . . 0000001544 00000003  WS E    Comp-3
* 000745 CP-CDT-METHOD . . . . . . . . . 0000001547 00000001  WS E    AlphNum
* 000749 CP-CLAIM-TYPE . . . . . . . . . 0000001548 00000001  WS E    AlphNum
* 000752 CP-ORIGINAL-TERM. . . . . . . . 0000001549 00000002  WS E    Comp-3
* 000754 CP-ORIGINAL-BENEFIT . . . . . . 0000001551 00000006  WS E    Comp-3
* 000756 CP-ORIGINAL-PREMIUM . . . . . . 0000001557 00000005  WS E    Comp-3
* 000758 CP-REMAINING-TERM . . . . . . . 0000001562 00000003  WS E    Comp-3
* 000760 CP-REMAINING-BENEFIT. . . . . . 0000001565 00000006  WS E    Comp-3
* 000762 CP-LOAN-APR . . . . . . . . . . 0000001571 00000004  WS E    Comp-3
* 000764 CP-PAY-FREQUENCY. . . . . . . . 0000001575 00000002  WS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page 100
* ELRFND.cbl
* 000766 CP-REM-TERM-METHOD. . . . . . . 0000001577 00000001  WS E    AlphNum
* 000774 CP-EARNING-METHOD . . . . . . . 0000001578 00000001  WS E    AlphNum
* 000789 CP-PROCESS-TYPE . . . . . . . . 0000001579 00000001  WS E    AlphNum
* 000793 CP-SPECIAL-CALC-CD. . . . . . . 0000001580 00000001  WS E    AlphNum
* 000827 CP-LOAN-TERM. . . . . . . . . . 0000001581 00000002  WS E    Comp-3
* 000829 CP-CLASS-CODE . . . . . . . . . 0000001583 00000002  WS E    AlphNum
* 000830 CP-DEVIATION-CODE . . . . . . . 0000001585 00000003  WS E    AlphNum
* 000831 CP-STATE. . . . . . . . . . . . 0000001588 00000002  WS E    AlphNum
* 000832 CP-STATE-STD-ABBRV. . . . . . . 0000001590 00000002  WS E    AlphNum
* 000833 CP-BENEFIT-CD . . . . . . . . . 0000001592 00000002  WS E    AlphNum
* 000836 CP-R78-OPTION . . . . . . . . . 0000001594 00000001  WS E    AlphNum
* 000840 CP-COMPANY-CD . . . . . . . . . 0000001595 00000001  WS E    AlphNum
* 000841 CP-IBNR-RESERVE-SW. . . . . . . 0000001596 00000001  WS E    AlphNum
* 000842 CP-CLAIM-STATUS . . . . . . . . 0000001597 00000001  WS E    AlphNum
* 000843 CP-RATE-FILE. . . . . . . . . . 0000001598 00000001  WS E    AlphNum
* 000844 CP-TERM-OR-EXT-DAYS . . . . . . 0000001599 00000003  WS E    Comp-3
* 000847 CP-LIFE-OVERRIDE-CODE . . . . . 0000001602 00000001  WS E    AlphNum
* 000848 CP-AH-OVERRIDE-CODE . . . . . . 0000001603 00000001  WS E    AlphNum
* 000850 CP-RATE-DEV-PCT . . . . . . . . 0000001604 00000004  WS E    Comp-3
* 000852 CP-CLP-RATE-UP. . . . . . . . . 0000001604 00000004  WS E    Comp-3     R
* 000854 CP-CRITICAL-MONTHS. . . . . . . 0000001608 00000002  WS E    Comp-3
* 000856 CP-ALTERNATE-BENEFIT. . . . . . 0000001610 00000006  WS E    Comp-3
* 000858 CP-ALTERNATE-PREMIUM. . . . . . 0000001616 00000005  WS E    Comp-3
* 000860 CP-DDF-CSO-ADMIN-FEE. . . . . . 0000001616 00000005  WS E    Comp-3     R
* 000863 CP-PAID-FROM-DATE . . . . . . . 0000001621 00000002  WS E    AlphNum
* 000864 CP-CLAIM-CALC-METHOD. . . . . . 0000001623 00000001  WS E    AlphNum
* 000865 CP-EXT-DAYS-CALC. . . . . . . . 0000001624 00000001  WS E    AlphNum
* 000870 CP-DOMICILE-STATE . . . . . . . 0000001625 00000002  WS E    AlphNum
* 000871 CP-CARRIER. . . . . . . . . . . 0000001627 00000001  WS E    AlphNum
* 000872 CP-REIN-FLAG. . . . . . . . . . 0000001628 00000001  WS E    AlphNum
* 000873 CP-REM-TRM-CALC-OPTION. . . . . 0000001629 00000001  WS E    AlphNum
* 000884 CP-SIG-SWITCH . . . . . . . . . 0000001630 00000001  WS E    AlphNum
* 000885 CP-RATING-METHOD. . . . . . . . 0000001631 00000001  WS E    AlphNum
* 000895 CP-SALES-TAX. . . . . . . . . . 0000001632 00000003  WS E    Comp-3
* 000897 CP-BEN-CATEGORY . . . . . . . . 0000001635 00000001  WS E    AlphNum
* 000898 CP-DCC-LF-RATE. . . . . . . . . 0000001636 00000004  WS E    Comp-3
* 000899 CP-DCC-ACT-COMM . . . . . . . . 0000001636 00000004  WS E    Comp-3     R
* 000901 CP-DCC-AH-RATE. . . . . . . . . 0000001640 00000004  WS E    Comp-3
* 000902 CP-DCC-PMF-COMM . . . . . . . . 0000001640 00000004  WS E    Comp-3     R
* 000904 CP-DAYS-TO-1ST-PMT. . . . . . . 0000001644 00000002  WS E    Comp-3
* 000905 CP-AH-BALLOON-SW. . . . . . . . 0000001646 00000001  WS E    AlphNum
* 000906 CP-EXPIRE-DT. . . . . . . . . . 0000001647 00000002  WS E    AlphNum
* 000907 CP-LF-CLAIM-CALC-SW . . . . . . 0000001649 00000001  WS E    AlphNum
* 000908 CP-DDF-HI-FACT. . . . . . . . . 0000001650 00000003  WS E    Comp-3
* 000909 CP-DDF-LO-FACT. . . . . . . . . 0000001653 00000003  WS E    Comp-3
* 000910 CP-DDF-CLP. . . . . . . . . . . 0000001656 00000004  WS E    Comp-3
* 000911 CP-DDF-SPEC-CALC. . . . . . . . 0000001660 00000001  WS E    AlphNum
* 000914 CP-IU-RATE-UP . . . . . . . . . 0000001661 00000004  WS E    Comp-3
* 000915 CP-CANCEL-REASON. . . . . . . . 0000001665 00000001  WS E    AlphNum
* 000916 CP-DDF-ADMIN-FEES . . . . . . . 0000001666 00000004  WS E    Comp-3
* 000917 CP-PMT-MODE . . . . . . . . . . 0000001670 00000001  WS E    AlphNum
* 000918 CP-NO-OF-PMTS . . . . . . . . . 0000001671 00000002  WS E    Comp-3
* 000919 CP-1ST-YR-ALLOW . . . . . . . . 0000001673 00000003  WS E    Comp-3
* 000920 CP-DDF-COMM-AND-MFEE. . . . . . 0000001676 00000004  WS E    Comp-3
* 000921 CP-DDF-YR1AF. . . . . . . . . . 0000001680 00000004  WS E    Comp-3
* 000922 Filler. . . . . . . . . . . . . 0000001684 00000001  WS E    AlphNum
* 000926 CP-CDT-TABLE. . . . . . . . . . 0000001685 00000001  WS E    Display
* 000928 CP-CDT-FACTOR . . . . . . . . . 0000001686 00000006  WS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page 101
* ELRFND.cbl
* 000930 CP-PTC-RESERVE. . . . . . . . . 0000001692 00000005  WS E    Comp-3
* 000932 CP-IBNR-RESERVE . . . . . . . . 0000001697 00000005  WS E    Comp-3
* 000934 CP-FUTURE-RESERVE . . . . . . . 0000001702 00000005  WS E    Comp-3
* 000936 Filler. . . . . . . . . . . . . 0000001707 00000009  WS E    AlphNum
* 000939 CP-REMAINING-TERM-1 . . . . . . 0000001716 00000003  WS E    Comp-3
* 000941 CP-REMAINING-TERM-2 . . . . . . 0000001719 00000003  WS E    Comp-3
* 000943 CP-REMAINING-TERM-3 . . . . . . 0000001722 00000003  WS E    Comp-3
* 000945 CP-ODD-DAYS . . . . . . . . . . 0000001725 00000002  WS E    Comp-3
* 000947 Filler. . . . . . . . . . . . . 0000001727 00000012  WS E    AlphNum
* 000951 CP-REMAINING-AMT. . . . . . . . 0000001739 00000006  WS E    Comp-3
* 000953 CP-REMAINING-AMT-PRV. . . . . . 0000001745 00000006  WS E    Comp-3
* 000955 Filler. . . . . . . . . . . . . 0000001751 00000012  WS E    AlphNum
* 000959 CP-CALC-PREMIUM . . . . . . . . 0000001763 00000005  WS E    Comp-3
* 000961 CP-PREMIUM-RATE . . . . . . . . 0000001768 00000004  WS E    Comp-3
* 000963 CP-MORTALITY-CODE . . . . . . . 0000001772 00000004  WS E    AlphNum
* 000964 CP-RATE-EDIT-FLAG . . . . . . . 0000001776 00000001  WS E    AlphNum
* 000966 CP-COMPOSITE-RATE . . . . . . . 0000001777 00000003  WS E    Comp-3
* 000968 CP-CANCEL-FEE . . . . . . . . . 0000001780 00000003  WS E    Comp-3
* 000969 CP-LF-PREM. . . . . . . . . . . 0000001783 00000005  WS E    Comp-3
* 000970 CP-LF-BALLOON-PREM. . . . . . . 0000001783 00000005  WS E    Comp-3     R
* 000972 Filler. . . . . . . . . . . . . 0000001788 00000007  WS E    AlphNum
* 000976 CP-CALC-REFUND. . . . . . . . . 0000001795 00000005  WS E    Comp-3
* 000978 CP-REFUND-TYPE-USED . . . . . . 0000001800 00000001  WS E    AlphNum
* 000993 Filler. . . . . . . . . . . . . 0000001801 00000012  WS E    AlphNum
* 000997 CP-R78-U-PRM. . . . . . . . . . 0000001813 00000005  WS E    Comp-3
* 000999 CP-R78-U-PRM-ALT. . . . . . . . 0000001818 00000005  WS E    Comp-3
* 001001 CP-PRORATA-U-PRM. . . . . . . . 0000001823 00000005  WS E    Comp-3
* 001003 CP-PRORATA-U-PRM-ALT. . . . . . 0000001828 00000005  WS E    Comp-3
* 001005 CP-STATE-U-PRM. . . . . . . . . 0000001833 00000005  WS E    Comp-3
* 001007 CP-DOMICILE-U-PRM . . . . . . . 0000001838 00000005  WS E    Comp-3
* 001009 CP-EARNING-TYPE-USED. . . . . . 0000001843 00000001  WS E    AlphNum
* 001019 Filler. . . . . . . . . . . . . 0000001844 00000012  WS E    AlphNum
* 001023 CP-ACTUAL-DAYS. . . . . . . . . 0000001856 00000003  WS E    Comp-3
* 001025 CP-CLAIM-PAYMENT. . . . . . . . 0000001859 00000005  WS E    Comp-3
* 001027 Filler. . . . . . . . . . . . . 0000001864 00000012  WS E    AlphNum
* 001030 CP-TOTAL-PAID . . . . . . . . . 0000001876 00000005  WS E    Comp-3
* 001032 CP-R-MAX-ATT-AGE. . . . . . . . 0000001881 00000002  WS E    Comp-3
* 001034 CP-R-MAX-AGE. . . . . . . . . . 0000001883 00000002  WS E    Comp-3
* 001036 CP-R-MAX-TERM . . . . . . . . . 0000001885 00000003  WS E    Comp-3
* 001038 CP-R-MAX-TOT-BEN. . . . . . . . 0000001888 00000005  WS E    Comp-3
* 001040 CP-R-MAX-MON-BEN. . . . . . . . 0000001893 00000005  WS E    Comp-3
* 001042 CP-IO-FUNCTION. . . . . . . . . 0000001898 00000001  WS E    AlphNum
* 001047 CP-FIRST-PAY-DATE . . . . . . . 0000001899 00000002  WS E    AlphNum
* 001049 CP-JOINT-INDICATOR. . . . . . . 0000001901 00000001  WS E    AlphNum
* 001051 CP-RESERVE-REMAINING-TERM . . . 0000001902 00000003  WS E    Comp-3
* 001055 CP-INSURED-BIRTH-DT . . . . . . 0000001905 00000002  WS E    AlphNum
* 001057 CP-INCURRED-AGE . . . . . . . . 0000001907 00000002  WS E    Comp-3
* 001060 CP-MONTHLY-PAYMENT. . . . . . . 0000001909 00000004  WS E    Comp-3
* 001063 CP-RATING-BENEFIT-AMT . . . . . 0000001913 00000006  WS E    Comp-3
* 001066 CP-ODD-DAYS-TO-PMT. . . . . . . 0000001919 00000002  WS E    Comp-3
* 001069 CP-MNTHS-TO-FIRST-PMT . . . . . 0000001921 00000002  WS E    Comp-3
* 001072 CP-REMAMT-FACTOR. . . . . . . . 0000001923 00000007  WS E    Comp-3
* 001075 CP-FREE-LOOK. . . . . . . . . . 0000001930 00000002  WS E    Comp-3
* 001078 CP-ROA-REFUND . . . . . . . . . 0000001932 00000001  WS E    AlphNum
* 001081 CP-NET-BENEFIT-AMT. . . . . . . 0000001933 00000006  WS E    Comp-3
* 001083 CP-SCNP-6MO-AMT . . . . . . . . 0000001939 00000006  WS E    Comp-3
* 001085 CP-MONTH. . . . . . . . . . . . 0000001945 00000002  WS E    Comp-3
* 001086 CP-EXTRA-PERIODS. . . . . . . . 0000001947 00000001  WS E    Display
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page 102
* ELRFND.cbl
* 001087 CP-NET-ONLY-STATE . . . . . . . 0000001948 00000001  WS E    AlphNum
* 001088 Filler. . . . . . . . . . . . . 0000001949 00000013  WS E    AlphNum
* 001098 DFHEIV. . . . . . . . . . . . . 0000001968 00000882  WS G    AlphNum
* 001099 DFHEIV0 . . . . . . . . . . . . 0000001968 00000035  WS E    AlphNum
* 001100 DFHEIV1 . . . . . . . . . . . . 0000002003 00000008  WS E    AlphNum
* 001101 DFHEIV2 . . . . . . . . . . . . 0000002011 00000008  WS E    AlphNum
* 001102 DFHEIV3 . . . . . . . . . . . . 0000002019 00000008  WS E    AlphNum
* 001103 DFHEIV4 . . . . . . . . . . . . 0000002027 00000006  WS E    AlphNum
* 001104 DFHEIV5 . . . . . . . . . . . . 0000002033 00000004  WS E    AlphNum
* 001105 DFHEIV6 . . . . . . . . . . . . 0000002037 00000004  WS E    AlphNum
* 001106 DFHEIV7 . . . . . . . . . . . . 0000002041 00000002  WS E    AlphNum
* 001107 DFHEIV8 . . . . . . . . . . . . 0000002043 00000002  WS E    AlphNum
* 001108 DFHEIV9 . . . . . . . . . . . . 0000002045 00000001  WS E    AlphNum
* 001109 DFHEIV10. . . . . . . . . . . . 0000002046 00000004  WS E    Comp-3
* 001110 DFHEIV11. . . . . . . . . . . . 0000002050 00000002  WS E    Comp
* 001111 DFHEIV12. . . . . . . . . . . . 0000002052 00000002  WS E    Comp
* 001112 DFHEIV13. . . . . . . . . . . . 0000002054 00000002  WS E    Comp
* 001113 DFHEIV14. . . . . . . . . . . . 0000002056 00000002  WS E    Comp
* 001114 DFHEIV15. . . . . . . . . . . . 0000002058 00000002  WS E    Comp
* 001115 DFHEIV16. . . . . . . . . . . . 0000002060 00000004  WS E    Comp
* 001116 DFHEIV17. . . . . . . . . . . . 0000002064 00000004  WS E    AlphNum
* 001117 DFHEIV18. . . . . . . . . . . . 0000002068 00000004  WS E    AlphNum
* 001118 DFHEIV19. . . . . . . . . . . . 0000002072 00000004  WS E    AlphNum
* 001119 DFHEIV20. . . . . . . . . . . . 0000002076 00000004  WS E    Pointer
* 001120 DFHEIV21. . . . . . . . . . . . 0000002080 00000004  WS E    Pointer
* 001121 DFHEIV22. . . . . . . . . . . . 0000002084 00000004  WS E    Pointer
* 001122 DFHEIV23. . . . . . . . . . . . 0000002088 00000004  WS E    Pointer
* 001123 DFHEIV24. . . . . . . . . . . . 0000002092 00000004  WS E    Pointer
* 001124 DFHEIV25. . . . . . . . . . . . 0000002096 00000004  WS E    Comp
* 001125 DFHEIV26. . . . . . . . . . . . 0000002100 00000004  WS E    Comp
* 001126 DFHEIV27. . . . . . . . . . . . 0000002104 00000004  WS E    Comp
* 001127 DFHEIV28. . . . . . . . . . . . 0000002108 00000004  WS E    Comp
* 001128 DFHEIV29. . . . . . . . . . . . 0000002112 00000004  WS E    Comp
* 001129 DFHEIV30. . . . . . . . . . . . 0000002116 00000004  WS E    Comp
* 001130 DFHEIV31. . . . . . . . . . . . 0000002120 00000004  WS E    Comp
* 001131 DFHEIV32. . . . . . . . . . . . 0000002124 00000002  WS E    Comp
* 001132 DFHEIV33. . . . . . . . . . . . 0000002126 00000002  WS E    Comp
* 001133 DFHEIV34. . . . . . . . . . . . 0000002128 00000002  WS E    Comp
* 001134 DFHEIV35. . . . . . . . . . . . 0000002130 00000002  WS E    Comp
* 001135 DFHEIV97. . . . . . . . . . . . 0000002132 00000004  WS E    Comp-3
* 001136 DFHEIV98. . . . . . . . . . . . 0000002136 00000002  WS E    Comp
* 001137 Filler. . . . . . . . . . . . . 0000002138 00000002  WS E    AlphNum
* 001138 DFHEIV99. . . . . . . . . . . . 0000002140 00000008  WS E    AlphNum
* 001139 DFHEIVL0. . . . . . . . . . . . 0000002148 00000048  WS E    AlphNum
* 001140 DFHEIVL1. . . . . . . . . . . . 0000002196 00000048  WS E    AlphNum
* 001141 DFHEIVL2. . . . . . . . . . . . 0000002244 00000048  WS E    AlphNum
* 001142 DFHEIVL3. . . . . . . . . . . . 0000002292 00000048  WS E    AlphNum
* 001143 DFHEIVL4. . . . . . . . . . . . 0000002340 00000255  WS E    AlphNum
* 001144 DFHEIVL5. . . . . . . . . . . . 0000002595 00000255  WS E    AlphNum
* 001152 DFHEIBLK. . . . . . . . . . . . 0000000000 00000096  LS G    AlphNum
* 001153 EIBTIME . . . . . . . . . . . . 0000000000 00000004  LS E    Comp-3
* 001154 EIBDATE . . . . . . . . . . . . 0000000004 00000004  LS E    Comp-3
* 001155 EIBTRNID. . . . . . . . . . . . 0000000008 00000004  LS E    AlphNum
* 001156 EIBTASKN. . . . . . . . . . . . 0000000012 00000004  LS E    Comp-3
* 001157 EIBTRMID. . . . . . . . . . . . 0000000016 00000004  LS E    AlphNum
* 001158 DFHEIGDI. . . . . . . . . . . . 0000000020 00000002  LS E    Comp
* 001159 EIBCPOSN. . . . . . . . . . . . 0000000022 00000002  LS E    Comp
* 001160 EIBCALEN. . . . . . . . . . . . 0000000024 00000002  LS E    Comp
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:36 Page 103
* ELRFND.cbl
* 001161 EIBAID. . . . . . . . . . . . . 0000000026 00000001  LS E    AlphNum
* 001162 EIBFILLER1. . . . . . . . . . . 0000000027 00000001  LS E    AlphNum
* 001163 EIBFN . . . . . . . . . . . . . 0000000028 00000002  LS E    AlphNum
* 001164 EIBFILLER2. . . . . . . . . . . 0000000030 00000002  LS E    AlphNum
* 001165 EIBRCODE. . . . . . . . . . . . 0000000032 00000006  LS E    AlphNum
* 001166 EIBFILLER3. . . . . . . . . . . 0000000038 00000002  LS E    AlphNum
* 001167 EIBDS . . . . . . . . . . . . . 0000000040 00000008  LS E    AlphNum
* 001168 EIBREQID. . . . . . . . . . . . 0000000048 00000008  LS E    AlphNum
* 001169 EIBRSRCE. . . . . . . . . . . . 0000000056 00000008  LS E    AlphNum
* 001170 EIBSYNC . . . . . . . . . . . . 0000000064 00000001  LS E    AlphNum
* 001171 EIBFREE . . . . . . . . . . . . 0000000065 00000001  LS E    AlphNum
* 001172 EIBRECV . . . . . . . . . . . . 0000000066 00000001  LS E    AlphNum
* 001173 EIBSEND . . . . . . . . . . . . 0000000067 00000001  LS E    AlphNum
* 001174 EIBATT. . . . . . . . . . . . . 0000000068 00000001  LS E    AlphNum
* 001175 EIBEOC. . . . . . . . . . . . . 0000000069 00000001  LS E    AlphNum
* 001176 EIBFMH. . . . . . . . . . . . . 0000000070 00000001  LS E    AlphNum
* 001177 EIBCOMPL. . . . . . . . . . . . 0000000071 00000001  LS E    AlphNum
* 001178 EIBSIG. . . . . . . . . . . . . 0000000072 00000001  LS E    AlphNum
* 001179 EIBCONF . . . . . . . . . . . . 0000000073 00000001  LS E    AlphNum
* 001180 EIBERR. . . . . . . . . . . . . 0000000074 00000001  LS E    AlphNum
* 001181 EIBRLDBK. . . . . . . . . . . . 0000000075 00000001  LS E    AlphNum
* 001182 EIBERRCD. . . . . . . . . . . . 0000000076 00000004  LS E    AlphNum
* 001183 EIBSYNRB. . . . . . . . . . . . 0000000080 00000001  LS E    AlphNum
* 001184 EIBNODAT. . . . . . . . . . . . 0000000081 00000001  LS E    AlphNum
* 001185 EIBFILLER5. . . . . . . . . . . 0000000082 00000002  LS E    AlphNum
* 001186 EIBRESP . . . . . . . . . . . . 0000000084 00000004  LS E    Comp
* 001187 EIBRESP2. . . . . . . . . . . . 0000000088 00000004  LS E    Comp
* 001188 DFHEIGDJ. . . . . . . . . . . . 0000000092 00000002  LS E    Comp
* 001189 DFHEIGDK. . . . . . . . . . . . 0000000094 00000002  LS E    Comp
* 001190 DFHCOMMAREA . . . . . . . . . . 0000000000 00000450  LS E    AlphNum
* 000000 XML-TEXT. . . . . . . . . . . . 0000000000 00000001  LS E    AlphNum      G
* 000000 XML-NTEXT . . . . . . . . . . . 0000000000 00000002  LS E    AlphNum      G
* 000000 XML-CODE. . . . . . . . . . . . 0000002860 00000004  PG E    Comp         G
* 000000 XML-EVENT . . . . . . . . . . . 0000002864 00000030  PG E    AlphNum      G
* 000000 RETURN-CODE . . . . . . . . . . 0000002896 00000004  PG E    Comp         G
* 000000 SORT-RETURN . . . . . . . . . . 0000002900 00000002  PG E    Comp         G
* 000000 TALLY . . . . . . . . . . . . . 0000002904 00000004  PG E    Comp         G
* 000000 SORT-MESSAGE. . . . . . . . . . 0000002908 00000008  PG E    AlphNum      G
* 000000 SORT-FILE-SIZE. . . . . . . . . 0000002916 00000004  PG E    Comp         G
* 000000 SORT-MODE-SIZE. . . . . . . . . 0000002920 00000004  PG E    Comp         G
* 000000 SORT-CORE-SIZE. . . . . . . . . 0000002924 00000004  PG E    Comp         G
* 000000 SORT-CONTROL. . . . . . . . . . 0000002928 00000008  PG E    AlphNum      G
* 000000 SHIFT-OUT . . . . . . . . . . . 0000002936 00000001  PG E    AlphNum      G
* 000000 SHIFT-IN. . . . . . . . . . . . 0000002940 00000001  PG E    AlphNum      G
*
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3084     Code:       45093
