* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6321.cbl
* Options: int("EL6321.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6321.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6321.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6321.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6321.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 10:33:35.
     7*                            VMOD=2.002
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6321.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*                                                                *
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    23*            *                                                   *
    24*            *****************************************************
    25
    26*REMARKS.
    27*        TRANSACTION - EXB5 - PENDING CLAIMS (COMPANY TOTALS).
    28
    29 ENVIRONMENT DIVISION.
    30 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6321.cbl
    32 WORKING-STORAGE SECTION.
    33 01  DFH-START PIC X(04).
    34 77  FILLER  PIC X(32)  VALUE '********************************'.
    35 77  FILLER  PIC X(32)  VALUE '*    EL6321 WORKING STORAGE    *'.
    36 77  FILLER  PIC X(32)  VALUE '************ V/M 2.002 *********'.
    37
    38*                            COPY ELCSCTM.
    39******************************************************************
    40*                                                                *
    41*                                                                *
    42*                            ELCSCTM                             *
    43*                            VMOD=2.001                          *
    44*                                                                *
    45*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    46*                                                                *
    47******************************************************************
    48 01  SECURITY-MESSAGE.
    49     12  FILLER                          PIC X(30)
    50            VALUE '** LOGIC SECURITY VIOLATION -'.
    51     12  SM-READ                         PIC X(6).
    52     12  FILLER                          PIC X(5)
    53            VALUE ' PGM='.
    54     12  SM-PGM                          PIC X(6).
    55     12  FILLER                          PIC X(5)
    56            VALUE ' OPR='.
    57     12  SM-PROCESSOR-ID                 PIC X(4).
    58     12  FILLER                          PIC X(6)
    59            VALUE ' TERM='.
    60     12  SM-TERMID                       PIC X(4).
    61     12  FILLER                          PIC XX   VALUE SPACE.
    62     12  SM-JUL-DATE                     PIC 9(5).
    63     12  FILLER                          PIC X    VALUE SPACE.
    64     12  SM-TIME                         PIC 99.99.
    65
    66*                            COPY ELCSCRTY.
    67******************************************************************
    68*                                                                *
    69*                                                                *
    70*                            ELCSCRTY                            *
    71*                            VMOD=2.001                          *
    72*                                                                *
    73*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    74*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    75*        SAVED IN PI-SECURITY-ADDRESS.                           *
    76*                                                                *
    77******************************************************************
    78 01  SECURITY-CONTROL.
    79     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    80     12  FILLER                       PIC XX    VALUE 'SC'.
    81     12  SC-CREDIT-CODES.
    82         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    83             20  SC-CREDIT-DISPLAY    PIC X.
    84             20  SC-CREDIT-UPDATE     PIC X.
    85     12  SC-CLAIMS-CODES.
    86         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    87             20  SC-CLAIMS-DISPLAY    PIC X.
    88             20  SC-CLAIMS-UPDATE     PIC X.
    89
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6321.cbl
    91
    92 01  STANDARD-AREAS.
    93     12  MAP-NAME            PIC  X(8)      VALUE 'EL6321A'.
    94     12  MAPSET-NAME         PIC  X(8)      VALUE 'EL6321S'.
    95     12  SCREEN-NUMBER       PIC  X(4)      VALUE '632C'.
    96     12  TRANS-ID            PIC  X(4)      VALUE 'EXB5'.
    97     12  THIS-PGM            PIC  X(8)      VALUE 'EL6321'.
    98     12  PGM-NAME            PIC  X(8).
    99     12  TIME-IN             PIC S9(7).
   100     12  TIME-OUT-R  REDEFINES TIME-IN.
   101         16  FILLER          PIC  X.
   102         16  TIME-OUT        PIC  99V99.
   103         16  FILLER          PIC  XX.
   104     12  XCTL-005            PIC  X(8)      VALUE 'EL005'.
   105     12  XCTL-010            PIC  X(8)      VALUE 'EL010'.
   106     12  XCTL-626            PIC  X(8)      VALUE 'EL626'.
   107     12  XCTL-630            PIC  X(8)      VALUE 'EL630'.
   108     12  XCTL-6301           PIC  X(8)      VALUE 'EL6301'.
   109     12  LINK-001            PIC  X(8)      VALUE 'EL001'.
   110     12  LINK-004            PIC  X(8)      VALUE 'EL004'.
   111     12  LINK-CLDATCV        PIC  X(8)      VALUE 'ELDATCV'.
   112     12  ERPNDC-FILE-ID      PIC  X(8)      VALUE 'ERPNDC'.
   113     12  WS-CURRENT-DT       PIC  X(8)      VALUE SPACES.
   114     12  ER-0029             PIC  X(4)      VALUE '0029'.
   115
   116 01  ACCESS-KEYS.
   117     12  ERPNDC-KEY.
   118         16  PNDC-COMPANY-CD     PIC  X      VALUE SPACE.
   119         16  PNDC-CARRIER        PIC  X      VALUE SPACE.
   120         16  PNDC-GROUPING       PIC  X(6)   VALUE SPACES.
   121         16  PNDC-STATE          PIC  XX     VALUE SPACES.
   122         16  PNDC-ACCOUNT        PIC  X(10)  VALUE SPACES.
   123         16  PNDC-CERT-EFF-DT    PIC  X(2)   VALUE SPACES.
   124         16  PNDC-CERT-NO.
   125             20  PNDC-CERT-PRIME PIC  X(10)  VALUE SPACES.
   126             20  PNDC-CERT-SFX   PIC  X      VALUE SPACE.
   127         16  PNDC-CLAIM-NO       PIC  X(7)   VALUE SPACES.
   128         16  PNDC-CHECK-NO       PIC  X(7)   VALUE SPACES.
   129         16  PNDC-RECORD-TYPE    PIC  X      VALUE '1'.
   130         16  PNDC-RECORD-SEQ     PIC S9(4)   VALUE +0   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6321.cbl
   132 01  COMPANY-TOTALS      COMP-3.
   133     12  LF-PYMNT-GOOD       PIC S9(5)         VALUE ZEROS.
   134     12  LF-PYMNT-BAD        PIC S9(5)         VALUE ZEROS.
   135     12  LF-PYMNT-AMT        PIC S9(7)V99      VALUE ZEROS.
   136     12  AH-PYMNT-GOOD       PIC S9(5)         VALUE ZEROS.
   137     12  AH-PYMNT-BAD        PIC S9(5)         VALUE ZEROS.
   138     12  AH-PYMNT-AMT        PIC S9(7)V99      VALUE ZEROS.
   139     12  RSV-GOOD            PIC S9(5)         VALUE ZEROS.
   140     12  RSV-BAD             PIC S9(5)         VALUE ZEROS.
   141     12  RSV-FUTURE          PIC S9(6)V99      VALUE ZEROS.
   142     12  RSV-PTC             PIC S9(6)V99      VALUE ZEROS.
   143     12  RSV-IBNR            PIC S9(6)V99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6321.cbl
   145*                                    COPY ELCDATE.
   146******************************************************************
   147*                                                                *
   148*                                                                *
   149*                            ELCDATE.                            *
   150*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   151*                            VMOD=2.003
   152*                                                                *
   153*                                                                *
   154*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   155*                 LENGTH = 200                                   *
   156******************************************************************
   157
   158 01  DATE-CONVERSION-DATA.
   159     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   160     12  DC-OPTION-CODE                PIC X.
   161         88  BIN-TO-GREG                VALUE ' '.
   162         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   163         88  EDIT-GREG-TO-BIN           VALUE '2'.
   164         88  YMD-GREG-TO-BIN            VALUE '3'.
   165         88  MDY-GREG-TO-BIN            VALUE '4'.
   166         88  JULIAN-TO-BIN              VALUE '5'.
   167         88  BIN-PLUS-ELAPSED           VALUE '6'.
   168         88  FIND-CENTURY               VALUE '7'.
   169         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   170         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   171         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   172         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   173         88  JULIAN-TO-BIN-3            VALUE 'C'.
   174         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   175         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   176         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   177         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   178         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   179         88  CHECK-LEAP-YEAR            VALUE 'H'.
   180         88  BIN-3-TO-GREG              VALUE 'I'.
   181         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   182         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   183         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   184         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   185         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   186         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   187         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   188         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   189         88  THREE-CHARACTER-BIN
   190                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   191         88  GREGORIAN-TO-BIN
   192                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   193         88  BIN-TO-GREGORIAN
   194                  VALUES ' ' '1' 'I' '8' 'G'.
   195         88  JULIAN-TO-BINARY
   196                  VALUES '5' 'C' 'E' 'F'.
   197     12  DC-ERROR-CODE                 PIC X.
   198         88  NO-CONVERSION-ERROR        VALUE ' '.
   199         88  DATE-CONVERSION-ERROR
   200                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   201         88  DATE-IS-ZERO               VALUE '1'.
   202         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6321.cbl
   203         88  DATE-IS-INVALID            VALUE '3'.
   204         88  DATE1-GREATER-DATE2        VALUE '4'.
   205         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   206         88  DATE-INVALID-OPTION        VALUE '9'.
   207         88  INVALID-CENTURY            VALUE 'A'.
   208         88  ONLY-CENTURY               VALUE 'B'.
   209         88  ONLY-LEAP-YEAR             VALUE 'C'.
   210         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   211     12  DC-END-OF-MONTH               PIC X.
   212         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   213     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   214         88  USE-NORMAL-PROCESS         VALUE ' '.
   215         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   216         88  ADJUST-UP-100-YRS          VALUE '2'.
   217     12  FILLER                        PIC X.
   218     12  DC-CONVERSION-DATES.
   219         16  DC-BIN-DATE-1             PIC XX.
   220         16  DC-BIN-DATE-2             PIC XX.
   221         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   222         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   223                       DC-GREG-DATE-1-EDIT.
   224             20  DC-EDIT1-MONTH        PIC 99.
   225             20  SLASH1-1              PIC X.
   226             20  DC-EDIT1-DAY          PIC 99.
   227             20  SLASH1-2              PIC X.
   228             20  DC-EDIT1-YEAR         PIC 99.
   229         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   230         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   231                     DC-GREG-DATE-2-EDIT.
   232             20  DC-EDIT2-MONTH        PIC 99.
   233             20  SLASH2-1              PIC X.
   234             20  DC-EDIT2-DAY          PIC 99.
   235             20  SLASH2-2              PIC X.
   236             20  DC-EDIT2-YEAR         PIC 99.
   237         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   238         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   239                     DC-GREG-DATE-1-YMD.
   240             20  DC-YMD-YEAR           PIC 99.
   241             20  DC-YMD-MONTH          PIC 99.
   242             20  DC-YMD-DAY            PIC 99.
   243         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   244         16  DC-GREG-DATE-1-MDY-R REDEFINES
   245                      DC-GREG-DATE-1-MDY.
   246             20  DC-MDY-MONTH          PIC 99.
   247             20  DC-MDY-DAY            PIC 99.
   248             20  DC-MDY-YEAR           PIC 99.
   249         16  DC-GREG-DATE-1-ALPHA.
   250             20  DC-ALPHA-MONTH        PIC X(10).
   251             20  DC-ALPHA-DAY          PIC 99.
   252             20  FILLER                PIC XX.
   253             20  DC-ALPHA-CENTURY.
   254                 24 DC-ALPHA-CEN-N     PIC 99.
   255             20  DC-ALPHA-YEAR         PIC 99.
   256         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   257         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   258         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   259         16  DC-JULIAN-DATE            PIC 9(05).
   260         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6321.cbl
   261                                       PIC 9(05).
   262         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   263             20  DC-JULIAN-YEAR        PIC 99.
   264             20  DC-JULIAN-DAYS        PIC 999.
   265         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   266         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   267         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   268     12  DATE-CONVERSION-VARIBLES.
   269         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   270         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   271             20  FILLER                PIC 9(3).
   272             20  HOLD-CEN-1-CCYY.
   273                 24  HOLD-CEN-1-CC     PIC 99.
   274                 24  HOLD-CEN-1-YY     PIC 99.
   275             20  HOLD-CEN-1-MO         PIC 99.
   276             20  HOLD-CEN-1-DA         PIC 99.
   277         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   278             20  HOLD-CEN-1-R-MO       PIC 99.
   279             20  HOLD-CEN-1-R-DA       PIC 99.
   280             20  HOLD-CEN-1-R-CCYY.
   281                 24  HOLD-CEN-1-R-CC   PIC 99.
   282                 24  HOLD-CEN-1-R-YY   PIC 99.
   283             20  FILLER                PIC 9(3).
   284         16  HOLD-CENTURY-1-X.
   285             20  FILLER                PIC X(3)  VALUE SPACES.
   286             20  HOLD-CEN-1-X-CCYY.
   287                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   288                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   289             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   290             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   291         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   292             20  HOLD-CEN-1-R-X-MO     PIC XX.
   293             20  HOLD-CEN-1-R-X-DA     PIC XX.
   294             20  HOLD-CEN-1-R-X-CCYY.
   295                 24  HOLD-CEN-1-R-X-CC PIC XX.
   296                 24  HOLD-CEN-1-R-X-YY PIC XX.
   297             20  FILLER                PIC XXX.
   298         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   299         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   300         16  DC-JULIAN-DATE-1          PIC 9(07).
   301         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   302             20  DC-JULIAN-1-CCYY.
   303                 24  DC-JULIAN-1-CC    PIC 99.
   304                 24  DC-JULIAN-1-YR    PIC 99.
   305             20  DC-JULIAN-DA-1        PIC 999.
   306         16  DC-JULIAN-DATE-2          PIC 9(07).
   307         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   308             20  DC-JULIAN-2-CCYY.
   309                 24  DC-JULIAN-2-CC    PIC 99.
   310                 24  DC-JULIAN-2-YR    PIC 99.
   311             20  DC-JULIAN-DA-2        PIC 999.
   312         16  DC-GREG-DATE-A-EDIT.
   313             20  DC-EDITA-MONTH        PIC 99.
   314             20  SLASHA-1              PIC X VALUE '/'.
   315             20  DC-EDITA-DAY          PIC 99.
   316             20  SLASHA-2              PIC X VALUE '/'.
   317             20  DC-EDITA-CCYY.
   318                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6321.cbl
   319                 24  DC-EDITA-YEAR     PIC 99.
   320         16  DC-GREG-DATE-B-EDIT.
   321             20  DC-EDITB-MONTH        PIC 99.
   322             20  SLASHB-1              PIC X VALUE '/'.
   323             20  DC-EDITB-DAY          PIC 99.
   324             20  SLASHB-2              PIC X VALUE '/'.
   325             20  DC-EDITB-CCYY.
   326                 24  DC-EDITB-CENT     PIC 99.
   327                 24  DC-EDITB-YEAR     PIC 99.
   328         16  DC-GREG-DATE-CYMD         PIC 9(08).
   329         16  DC-GREG-DATE-CYMD-R REDEFINES
   330                              DC-GREG-DATE-CYMD.
   331             20  DC-CYMD-CEN           PIC 99.
   332             20  DC-CYMD-YEAR          PIC 99.
   333             20  DC-CYMD-MONTH         PIC 99.
   334             20  DC-CYMD-DAY           PIC 99.
   335         16  DC-GREG-DATE-MDCY         PIC 9(08).
   336         16  DC-GREG-DATE-MDCY-R REDEFINES
   337                              DC-GREG-DATE-MDCY.
   338             20  DC-MDCY-MONTH         PIC 99.
   339             20  DC-MDCY-DAY           PIC 99.
   340             20  DC-MDCY-CEN           PIC 99.
   341             20  DC-MDCY-YEAR          PIC 99.
   342    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   343        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   344    12  DC-EL310-DATE                  PIC X(21).
   345    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6321.cbl
   347*                                    COPY ELCLOGOF.
   348******************************************************************
   349*                                                                *
   350*                                                                *
   351*                            ELCLOGOF.                           *
   352*                            VMOD=2.001                          *
   353*                                                                *
   354*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   355*                                                                *
   356******************************************************************
   357 01  CLASIC-LOGOFF.
   358     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   359     12  LOGOFF-TEXT.
   360         16  FILLER          PIC X(5)    VALUE SPACES.
   361         16  LOGOFF-MSG.
   362             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   363             20  FILLER      PIC X       VALUE SPACES.
   364             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   365         16  FILLER          PIC X(80)
   366           VALUE '* YOU ARE NOW LOGGED OFF'.
   367         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   368         16  FILLER          PIC X       VALUE QUOTE.
   369         16  LOGOFF-SYS-MSG  PIC X(17)
   370           VALUE 'S CLAS-IC SYSTEM '.
   371     12  TEXT-MESSAGES.
   372         16  UNACCESS-MSG    PIC X(29)
   373             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   374         16  PGMIDERR-MSG    PIC X(17)
   375             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6321.cbl
   377*                                    COPY ELCATTR.
   378******************************************************************
   379*                                                                *
   380*                            ELCATTR.                            *
   381*                            VMOD=2.001                          *
   382*                                                                *
   383*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   384*                                                                *
   385*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   386*                                                                *
   387*                   POS 1   P=PROTECTED                          *
   388*                           U=UNPROTECTED                        *
   389*                           S=ASKIP                              *
   390*                   POS 2   A=ALPHA/NUMERIC                      *
   391*                           N=NUMERIC                            *
   392*                   POS 3   N=NORMAL                             *
   393*                           B=BRIGHT                             *
   394*                           D=DARK                               *
   395*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   396*                           OF=MODIFIED DATA TAG OFF             *
   397*                                                                *
   398*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   399******************************************************************
   400 01  ATTRIBUTE-LIST.
   401     12  AL-PABOF            PIC X       VALUE 'Y'.
   402     12  AL-PABON            PIC X       VALUE 'Z'.
   403     12  AL-PADOF            PIC X       VALUE '%'.
   404     12  AL-PADON            PIC X       VALUE '_'.
   405     12  AL-PANOF            PIC X       VALUE '-'.
   406     12  AL-PANON            PIC X       VALUE '/'.
   407     12  AL-SABOF            PIC X       VALUE '8'.
   408     12  AL-SABON            PIC X       VALUE '9'.
   409     12  AL-SADOF            PIC X       VALUE '@'.
   410     12  AL-SADON            PIC X       VALUE QUOTE.
   411     12  AL-SANOF            PIC X       VALUE '0'.
   412     12  AL-SANON            PIC X       VALUE '1'.
   413     12  AL-UABOF            PIC X       VALUE 'H'.
   414     12  AL-UABON            PIC X       VALUE 'I'.
   415     12  AL-UADOF            PIC X       VALUE '<'.
   416     12  AL-UADON            PIC X       VALUE '('.
   417     12  AL-UANOF            PIC X       VALUE ' '.
   418     12  AL-UANON            PIC X       VALUE 'A'.
   419     12  AL-UNBOF            PIC X       VALUE 'Q'.
   420     12  AL-UNBON            PIC X       VALUE 'R'.
   421     12  AL-UNDOF            PIC X       VALUE '*'.
   422     12  AL-UNDON            PIC X       VALUE ')'.
   423     12  AL-UNNOF            PIC X       VALUE '&'.
   424     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6321.cbl
   426*                                    COPY ELCEMIB.
   427******************************************************************
   428*                                                                *
   429*                                                                *
   430*                            ELCEMIB.                            *
   431*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   432*                            VMOD=2.005                          *
   433*                                                                *
   434*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   435*                                                                *
   436******************************************************************
   437 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   438     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   439     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   440     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   441     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   442     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   443     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   444     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   445     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   446     12  EMI-SWITCH1             PIC X        VALUE '1'.
   447         88  EMI-NO-ERRORS                    VALUE '1'.
   448         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   449         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   450     12  EMI-SWITCH2             PIC X        VALUE '1'.
   451         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   452     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   453         88  EMI-AREA1-EMPTY                  VALUE '1'.
   454         88  EMI-AREA1-FULL                   VALUE '2'.
   455     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   456         88  EMI-AREA2-EMPTY                  VALUE '1'.
   457         88  EMI-AREA2-FULL                   VALUE '2'.
   458     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   459         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   460         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   461         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   462         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   463         88  EMI-BYPASS-FATALS                VALUE 'X'.
   464     12  EMI-ERROR-LINES.
   465         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   466         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   467         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   468         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   469             20  EMI-ERR-CODES OCCURS 10 TIMES.
   470                 24  EMI-ERR-NUM         PIC X(4).
   471                 24  EMI-FILLER          PIC X.
   472                 24  EMI-SEV             PIC X.
   473                 24  FILLER              PIC X.
   474             20  FILLER                  PIC X(02).
   475     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   476         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   477             20  EMI-ERROR-NUMBER    PIC X(4).
   478             20  EMI-FILL            PIC X.
   479             20  EMI-SEVERITY        PIC X.
   480             20  FILLER              PIC X.
   481             20  EMI-ERROR-TEXT.
   482                 24  EMI-TEXT-VARIABLE   PIC X(10).
   483                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6321.cbl
   484     12  EMI-SEVERITY-SAVE           PIC X.
   485         88  EMI-NOTE                    VALUE 'N'.
   486         88  EMI-WARNING                 VALUE 'W'.
   487         88  EMI-FORCABLE                VALUE 'F'.
   488         88  EMI-FATAL                   VALUE 'X'.
   489     12  EMI-MESSAGE-FLAG            PIC X.
   490         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   491         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   492     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   493     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   494         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   495         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   496         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   497     12  FILLER                      PIC X(137)  VALUE SPACES.
   498     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   499     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   500     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   501     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6321.cbl
   503*                                    COPY ELCINTF.
   504******************************************************************
   505*                                                                *
   506*                                                                *
   507*                            ELCINTF.                            *
   508*                            VMOD=2.017                          *
   509*                                                                *
   510*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   511*                                                                *
   512*       LENGTH = 1024                                            *
   513*                                                                *
   514******************************************************************
   515 01  PROGRAM-INTERFACE-BLOCK.
   516     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   517     12  PI-CALLING-PROGRAM              PIC X(8).
   518     12  PI-SAVED-PROGRAM-1              PIC X(8).
   519     12  PI-SAVED-PROGRAM-2              PIC X(8).
   520     12  PI-SAVED-PROGRAM-3              PIC X(8).
   521     12  PI-SAVED-PROGRAM-4              PIC X(8).
   522     12  PI-SAVED-PROGRAM-5              PIC X(8).
   523     12  PI-SAVED-PROGRAM-6              PIC X(8).
   524     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   525     12  PI-COMPANY-ID                   PIC XXX.
   526     12  PI-COMPANY-CD                   PIC X.
   527
   528     12  PI-COMPANY-PASSWORD             PIC X(8).
   529
   530     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   531
   532     12  PI-CONTROL-IN-PROGRESS.
   533         16  PI-CARRIER                  PIC X.
   534         16  PI-GROUPING                 PIC X(6).
   535         16  PI-STATE                    PIC XX.
   536         16  PI-ACCOUNT                  PIC X(10).
   537         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   538                                         PIC X(10).
   539         16  PI-CLAIM-CERT-GRP.
   540             20  PI-CLAIM-NO             PIC X(7).
   541             20  PI-CERT-NO.
   542                 25  PI-CERT-PRIME       PIC X(10).
   543                 25  PI-CERT-SFX         PIC X.
   544             20  PI-CERT-EFF-DT          PIC XX.
   545         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   546             20  PI-PLAN-CODE            PIC X(2).
   547             20  PI-REVISION-NUMBER      PIC X(3).
   548             20  PI-PLAN-EFF-DT          PIC X(2).
   549             20  PI-PLAN-EXP-DT          PIC X(2).
   550             20  FILLER                  PIC X(11).
   551         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   552             20  PI-OE-REFERENCE-1.
   553                 25  PI-OE-REF-1-PRIME   PIC X(18).
   554                 25  PI-OE-REF-1-SUFF    PIC XX.
   555
   556     12  PI-SESSION-IN-PROGRESS          PIC X.
   557         88  CLAIM-SESSION                   VALUE '1'.
   558         88  CREDIT-SESSION                  VALUE '2'.
   559         88  WARRANTY-SESSION                VALUE '3'.
   560         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6321.cbl
   561         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   562
   563
   564*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   565
   566     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   567     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   568
   569     12  PI-CREDIT-USER                  PIC X.
   570         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   571         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   572
   573     12  PI-CLAIM-USER                   PIC X.
   574         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   575         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   576
   577     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   578         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   579         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   580         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   581         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   582         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   583
   584     12  PI-PROCESSOR-ID                 PIC X(4).
   585
   586     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   587
   588     12  PI-MEMBER-CAPTION               PIC X(10).
   589
   590     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   591         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   592
   593     12  PI-LIFE-OVERRIDE-L1             PIC X.
   594     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   595     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   596     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   597
   598     12  PI-AH-OVERRIDE-L1               PIC X.
   599     12  PI-AH-OVERRIDE-L2               PIC XX.
   600     12  PI-AH-OVERRIDE-L6               PIC X(6).
   601     12  PI-AH-OVERRIDE-L12              PIC X(12).
   602
   603     12  PI-NEW-SYSTEM                   PIC X(2).
   604
   605     12  PI-PRIMARY-CERT-NO              PIC X(11).
   606     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   607         88  PI-USES-PAID-TO                 VALUE '1'.
   608     12  PI-CRDTCRD-SYSTEM.
   609         16  PI-CRDTCRD-USER             PIC X.
   610             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   611             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   612         16  PI-CC-MONTH-END-DT          PIC XX.
   613     12  PI-PROCESSOR-PRINTER            PIC X(4).
   614
   615     12  PI-OE-REFERENCE-2.
   616         16  PI-OE-REF-2-PRIME           PIC X(10).
   617         16  PI-OE-REF-2-SUFF            PIC X.
   618
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6321.cbl
   619     12  PI-REM-TRM-CALC-OPTION          PIC X.
   620
   621     12  PI-LANGUAGE-TYPE                PIC X.
   622             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   623             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   624             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   625
   626     12  PI-POLICY-LINKAGE-IND           PIC X.
   627         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   628         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   629                                                   LOW-VALUES.
   630
   631     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   632     12  PI-CLAIM-PW-SESSION             PIC X(1).
   633         88  PI-CLAIM-CREDIT                 VALUE '1'.
   634         88  PI-CLAIM-CONVEN                 VALUE '2'.
   635     12  FILLER                          PIC X(4).
   636
   637     12  PI-SYSTEM-LEVEL                 PIC X(145).
   638
   639     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   640         PI-SYSTEM-LEVEL.
   641
   642         16  PI-ENTRY-CODES.
   643             20  PI-ENTRY-CD-1           PIC X.
   644             20  PI-ENTRY-CD-2           PIC X.
   645
   646         16  PI-RETURN-CODES.
   647             20  PI-RETURN-CD-1          PIC X.
   648             20  PI-RETURN-CD-2          PIC X.
   649
   650         16  PI-UPDATE-STATUS-SAVE.
   651             20  PI-UPDATE-BY            PIC X(4).
   652             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   653
   654         16  PI-LOWER-CASE-LETTERS       PIC X.
   655             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   656
   657*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   658*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   659*            88  CARRIER-CLM-CNTL            VALUE '2'.
   660
   661         16  PI-CERT-ACCESS-CONTROL      PIC X.
   662             88  ST-ACCNT-CNTL               VALUE ' '.
   663             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   664             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   665             88  ACCNT-CNTL                  VALUE '3'.
   666             88  CARR-ACCNT-CNTL             VALUE '4'.
   667
   668         16  PI-PROCESSOR-CAP-LIST.
   669             20  PI-SYSTEM-CONTROLS.
   670                24 PI-SYSTEM-DISPLAY     PIC X.
   671                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   672                24 PI-SYSTEM-MODIFY      PIC X.
   673                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   674             20  FILLER                  PIC XX.
   675             20  PI-DISPLAY-CAP          PIC X.
   676                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6321.cbl
   677             20  PI-MODIFY-CAP           PIC X.
   678                 88  MODIFY-CAP              VALUE 'Y'.
   679             20  PI-MSG-AT-LOGON-CAP     PIC X.
   680                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   681             20  PI-FORCE-CAP            PIC X.
   682                 88  FORCE-CAP               VALUE 'Y'.
   683
   684         16  PI-PROGRAM-CONTROLS.
   685             20  PI-PGM-PRINT-OPT        PIC X.
   686             20  PI-PGM-FORMAT-OPT       PIC X.
   687             20  PI-PGM-PROCESS-OPT      PIC X.
   688             20  PI-PGM-TOTALS-OPT       PIC X.
   689
   690         16  PI-HELP-INTERFACE.
   691             20  PI-LAST-ERROR-NO        PIC X(4).
   692             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   693
   694         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   695             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   696
   697         16  PI-CR-CONTROL-IN-PROGRESS.
   698             20  PI-CR-CARRIER           PIC X.
   699             20  PI-CR-GROUPING          PIC X(6).
   700             20  PI-CR-STATE             PIC XX.
   701             20  PI-CR-ACCOUNT           PIC X(10).
   702             20  PI-CR-FIN-RESP          PIC X(10).
   703             20  PI-CR-TYPE              PIC X.
   704
   705         16  PI-CR-BATCH-NUMBER          PIC X(6).
   706
   707         16  PI-CR-MONTH-END-DT          PIC XX.
   708
   709         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   710             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   711             88  PI-ZERO-CARRIER             VALUE '1'.
   712             88  PI-ZERO-GROUPING            VALUE '2'.
   713             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   714
   715         16  PI-CARRIER-SECURITY         PIC X.
   716             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   717
   718         16  PI-ACCOUNT-SECURITY         PIC X(10).
   719             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   720             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   721
   722         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   723             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   724                                         INDEXED BY PI-ACCESS-NDX
   725                                         PIC X.
   726
   727         16  PI-GA-BILLING-CONTROL       PIC X.
   728             88  PI-GA-BILLING               VALUE '1'.
   729
   730         16  PI-MAIL-PROCESSING          PIC X.
   731             88  PI-MAIL-YES                 VALUE 'Y'.
   732
   733         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   734
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6321.cbl
   735         16  PI-AR-SYSTEM.
   736             20  PI-AR-PROCESSING-CNTL   PIC X.
   737                 88  PI-AR-PROCESSING        VALUE 'Y'.
   738             20  PI-AR-SUMMARY-CODE      PIC X(6).
   739             20  PI-AR-MONTH-END-DT      PIC XX.
   740
   741         16  PI-MP-SYSTEM.
   742             20  PI-MORTGAGE-USER            PIC X.
   743                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   744                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   745             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   746                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   747                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   748                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   749                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   750                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   751             20  PI-MP-MONTH-END-DT          PIC XX.
   752             20  PI-MP-REFERENCE-NO.
   753                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   754                 24  PI-MP-REFERENCE-SFX     PIC XX.
   755
   756         16  PI-LABEL-CONTROL            PIC X(01).
   757             88  PI-CREATE-LABELS                    VALUE 'Y'.
   758             88  PI-BYPASS-LABELS                    VALUE 'N'.
   759
   760         16  PI-BILL-GROUPING-CODE       PIC X(01).
   761             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   762
   763         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   764             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   765             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   766
   767         16  FILLER                      PIC X(14).
   768
   769     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   770******************************************************************
   771     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
   772         16  PI-ACC-NAME                 PIC  X(30).
   773         16  PI-MAP-NAME                 PIC  X(8).
   774         16  PI-BATCH-AMOUNTS    COMP-3.
   775             20  PI-LF-ISS-REMITTED      PIC S9(8)V99.
   776             20  PI-LF-ISS-ENTERED       PIC S9(8)V99.
   777             20  PI-LF-CAN-REMITTED      PIC S9(8)V99.
   778             20  PI-LF-CAN-ENTERED       PIC S9(8)V99.
   779             20  PI-AH-ISS-REMITTED      PIC S9(8)V99.
   780             20  PI-AH-ISS-ENTERED       PIC S9(8)V99.
   781             20  PI-AH-CAN-REMITTED      PIC S9(8)V99.
   782             20  PI-AH-CAN-ENTERED       PIC S9(8)V99.
   783             20  PI-ISS-CNT-REMITTED     PIC S9(5).
   784             20  PI-ISS-CNT-ENTERED      PIC S9(5).
   785             20  PI-CAN-CNT-REMITTED     PIC S9(5).
   786             20  PI-CAN-CNT-ENTERED      PIC S9(5).
   787         16  PI-MAINT-FUNC               PIC  X.
   788         16  PI-ERROR-SW                 PIC  X.
   789             88  PI-DATA-ERRORS              VALUE 'Y'.
   790         16  PI-UPDATE-SW                PIC  X.
   791             88  PI-DATA-UPDATED             VALUE 'Y'.
   792         16  PI-DISPLAY-SW               PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6321.cbl
   793             88  PI-LAST-FUNC-DISPLAY        VALUE 'Y'.
   794         16  PI-TABS-RESET-SW            PIC  X.
   795             88  PI-TABS-RESET               VALUE 'Y'.
   796         16  PI-SAVE-CALLING-PGM         PIC  X(8).
   797         16  PI-LAST-SEQ-NO-ADDED        PIC S9(4)      COMP.
   798         16  PI-NEXT-DISPLAY-SEQ-NO      PIC S9(4)      COMP.
   799         16  PI-SAV-CARRIER              PIC  X.
   800         16  PI-SAV-GROUPING             PIC  X(6).
   801         16  PI-SAV-STATE                PIC  XX.
   802         16  PI-SAV-ACCOUNT              PIC  X(10).
   803         16  PI-SAV-CERT-EFF-DT          PIC  XX.
   804         16  PI-SAV-CERT-NO.
   805             20  PI-SAV-CERT-PRIME       PIC  X(10).
   806             20  PI-SAV-CERT-SFX         PIC  X.
   807         16  PI-SAV-ENDING-PNDB-KEY.
   808             20  PI-SAV-COMP-CD          PIC  X.
   809             20  PI-SAV-ENTRY-BATCH      PIC  X(6).
   810             20  PI-SAV-BATCH-SEQ        PIC S9(4)     COMP.
   811             20  PI-SAV-BATCH-CHG-SEQ    PIC S9(4)     COMP.
   812         16  PI-VERIFY-DELETE-SW         PIC  X.
   813             88  PI-DELETE-IS-OK             VALUE 'Y'.
   814         16  PI-BATCH-EOF-SW             PIC  X.
   815             88  PI-BATCH-EOF                VALUE 'Y'.
   816         16  FILLER                      PIC  X(480).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6321.cbl
   818*                            COPY ELCJPFX.
   819******************************************************************
   820*                                                                *
   821*                                                                *
   822*                            ELCJPFX.                            *
   823*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   824*                            VMOD=2.002                          *
   825*                                                                *
   826*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   827*                                                                *
   828*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   829*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   830*        ELCNTL - CONTROL FILE                                   *
   831*        ELMSTR - CLAIM MASTERS                                  *
   832*        ELTRLR - ACTIVITY TRAILERS                              *
   833*        ELCHKQ - CHECK QUE                                      *
   834******************************************************************
   835 01  JOURNAL-RECORD.
   836     12  JP-USER-ID                  PIC X(4).
   837     12  JP-FILE-ID                  PIC X(8).
   838     12  JP-PROGRAM-ID               PIC X(8).
   839     12  JP-RECORD-TYPE              PIC X.
   840         88 JP-ADD              VALUE 'A'.
   841         88 JP-BEFORE-CHANGE    VALUE 'B'.
   842         88 JP-AFTER-CHANGE     VALUE 'C'.
   843         88 JP-DELETE           VALUE 'D'.
   844         88 JP-GENERIC-DELETE   VALUE 'G'.
   845         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   846         88 JP-KEY-CHG-ADD      VALUE 'N'.
   847     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   848     12  JP-RECORD-AREA
   849
   850
   851                             PIC  X(503).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6321.cbl
   853*                            COPY ELCAID.
   854******************************************************************
   855*                                                                *
   856*                            ELCAID.                             *
   857*                            VMOD=2.001                          *
   858*                                                                *
   859*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   860*                                                                *
   861*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   862*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   863******************************************************************
   864
   865 01  DFHAID.
   866   02  DFHNULL   PIC  X  VALUE  ' '.
   867   02  DFHENTER  PIC  X  VALUE  QUOTE.
   868   02  DFHCLEAR  PIC  X  VALUE  '_'.
   869   02  DFHPEN    PIC  X  VALUE  '='.
   870   02  DFHOPID   PIC  X  VALUE  'W'.
   871   02  DFHPA1    PIC  X  VALUE  '%'.
   872   02  DFHPA2    PIC  X  VALUE  '>'.
   873   02  DFHPA3    PIC  X  VALUE  ','.
   874   02  DFHPF1    PIC  X  VALUE  '1'.
   875   02  DFHPF2    PIC  X  VALUE  '2'.
   876   02  DFHPF3    PIC  X  VALUE  '3'.
   877   02  DFHPF4    PIC  X  VALUE  '4'.
   878   02  DFHPF5    PIC  X  VALUE  '5'.
   879   02  DFHPF6    PIC  X  VALUE  '6'.
   880   02  DFHPF7    PIC  X  VALUE  '7'.
   881   02  DFHPF8    PIC  X  VALUE  '8'.
   882   02  DFHPF9    PIC  X  VALUE  '9'.
   883   02  DFHPF10   PIC  X  VALUE  ':'.
   884   02  DFHPF11   PIC  X  VALUE  '#'.
   885   02  DFHPF12   PIC  X  VALUE  '@'.
   886   02  DFHPF13   PIC  X  VALUE  'A'.
   887   02  DFHPF14   PIC  X  VALUE  'B'.
   888   02  DFHPF15   PIC  X  VALUE  'C'.
   889   02  DFHPF16   PIC  X  VALUE  'D'.
   890   02  DFHPF17   PIC  X  VALUE  'E'.
   891   02  DFHPF18   PIC  X  VALUE  'F'.
   892   02  DFHPF19   PIC  X  VALUE  'G'.
   893   02  DFHPF20   PIC  X  VALUE  'H'.
   894   02  DFHPF21   PIC  X  VALUE  'I'.
   895*00039    02  DFHPF22   PIC  X  VALUE  ''.
   896   02  DFHPF22   PIC  X  VALUE  '['.
   897   02  DFHPF23   PIC  X  VALUE  '.'.
   898   02  DFHPF24   PIC  X  VALUE  '<'.
   899   02  DFHMSRE   PIC  X  VALUE  'X'.
   900   02  DFHSTRF   PIC  X  VALUE  'h'.
   901   02  DFHTRIG   PIC  X  VALUE  '"'.
   902 01  FILLER  REDEFINES  DFHAID.
   903     12  FILLER              PIC  X(8).
   904     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6321.cbl
   906*                            COPY EL6321S.
   907 01  EL6321AI.
   908     05  FILLER            PIC  X(0012).
   909*    -------------------------------
   910     05  DATEL PIC S9(0004) COMP.
   911     05  DATEF PIC  X(0001).
   912     05  FILLER REDEFINES DATEF.
   913         10  DATEA PIC  X(0001).
   914     05  DATEI PIC  X(0008).
   915*    -------------------------------
   916     05  TIMEL PIC S9(0004) COMP.
   917     05  TIMEF PIC  X(0001).
   918     05  FILLER REDEFINES TIMEF.
   919         10  TIMEA PIC  X(0001).
   920     05  TIMEI PIC  X(0005).
   921*    -------------------------------
   922     05  CTYPE1L PIC S9(0004) COMP.
   923     05  CTYPE1F PIC  X(0001).
   924     05  FILLER REDEFINES CTYPE1F.
   925         10  CTYPE1A PIC  X(0001).
   926     05  CTYPE1I PIC  X(0006).
   927*    -------------------------------
   928     05  LFTOTL PIC S9(0004) COMP.
   929     05  LFTOTF PIC  X(0001).
   930     05  FILLER REDEFINES LFTOTF.
   931         10  LFTOTA PIC  X(0001).
   932     05  LFTOTI PIC  X(0004).
   933*    -------------------------------
   934     05  LFBADL PIC S9(0004) COMP.
   935     05  LFBADF PIC  X(0001).
   936     05  FILLER REDEFINES LFBADF.
   937         10  LFBADA PIC  X(0001).
   938     05  LFBADI PIC  X(0004).
   939*    -------------------------------
   940     05  LFGOODL PIC S9(0004) COMP.
   941     05  LFGOODF PIC  X(0001).
   942     05  FILLER REDEFINES LFGOODF.
   943         10  LFGOODA PIC  X(0001).
   944     05  LFGOODI PIC  X(0004).
   945*    -------------------------------
   946     05  LFPMTSL PIC S9(0004) COMP.
   947     05  LFPMTSF PIC  X(0001).
   948     05  FILLER REDEFINES LFPMTSF.
   949         10  LFPMTSA PIC  X(0001).
   950     05  LFPMTSI PIC  X(0010).
   951*    -------------------------------
   952     05  CTYPE2L PIC S9(0004) COMP.
   953     05  CTYPE2F PIC  X(0001).
   954     05  FILLER REDEFINES CTYPE2F.
   955         10  CTYPE2A PIC  X(0001).
   956     05  CTYPE2I PIC  X(0006).
   957*    -------------------------------
   958     05  AHTOTL PIC S9(0004) COMP.
   959     05  AHTOTF PIC  X(0001).
   960     05  FILLER REDEFINES AHTOTF.
   961         10  AHTOTA PIC  X(0001).
   962     05  AHTOTI PIC  X(0004).
   963*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6321.cbl
   964     05  AHBADL PIC S9(0004) COMP.
   965     05  AHBADF PIC  X(0001).
   966     05  FILLER REDEFINES AHBADF.
   967         10  AHBADA PIC  X(0001).
   968     05  AHBADI PIC  X(0004).
   969*    -------------------------------
   970     05  AHGOODL PIC S9(0004) COMP.
   971     05  AHGOODF PIC  X(0001).
   972     05  FILLER REDEFINES AHGOODF.
   973         10  AHGOODA PIC  X(0001).
   974     05  AHGOODI PIC  X(0004).
   975*    -------------------------------
   976     05  AHPMTSL PIC S9(0004) COMP.
   977     05  AHPMTSF PIC  X(0001).
   978     05  FILLER REDEFINES AHPMTSF.
   979         10  AHPMTSA PIC  X(0001).
   980     05  AHPMTSI PIC  X(0010).
   981*    -------------------------------
   982     05  RETOTL PIC S9(0004) COMP.
   983     05  RETOTF PIC  X(0001).
   984     05  FILLER REDEFINES RETOTF.
   985         10  RETOTA PIC  X(0001).
   986     05  RETOTI PIC  X(0005).
   987*    -------------------------------
   988     05  REBADL PIC S9(0004) COMP.
   989     05  REBADF PIC  X(0001).
   990     05  FILLER REDEFINES REBADF.
   991         10  REBADA PIC  X(0001).
   992     05  REBADI PIC  X(0005).
   993*    -------------------------------
   994     05  REGOODL PIC S9(0004) COMP.
   995     05  REGOODF PIC  X(0001).
   996     05  FILLER REDEFINES REGOODF.
   997         10  REGOODA PIC  X(0001).
   998     05  REGOODI PIC  X(0005).
   999*    -------------------------------
  1000     05  FUTUREL PIC S9(0004) COMP.
  1001     05  FUTUREF PIC  X(0001).
  1002     05  FILLER REDEFINES FUTUREF.
  1003         10  FUTUREA PIC  X(0001).
  1004     05  FUTUREI PIC  X(0009).
  1005*    -------------------------------
  1006     05  PTCL PIC S9(0004) COMP.
  1007     05  PTCF PIC  X(0001).
  1008     05  FILLER REDEFINES PTCF.
  1009         10  PTCA PIC  X(0001).
  1010     05  PTCI PIC  X(0009).
  1011*    -------------------------------
  1012     05  IBNRL PIC S9(0004) COMP.
  1013     05  IBNRF PIC  X(0001).
  1014     05  FILLER REDEFINES IBNRF.
  1015         10  IBNRA PIC  X(0001).
  1016     05  IBNRI PIC  X(0009).
  1017*    -------------------------------
  1018     05  ERRMSGL PIC S9(0004) COMP.
  1019     05  ERRMSGF PIC  X(0001).
  1020     05  FILLER REDEFINES ERRMSGF.
  1021         10  ERRMSGA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6321.cbl
  1022     05  ERRMSGI PIC  X(0076).
  1023*    -------------------------------
  1024     05  PFENTERL PIC S9(0004) COMP.
  1025     05  PFENTERF PIC  X(0001).
  1026     05  FILLER REDEFINES PFENTERF.
  1027         10  PFENTERA PIC  X(0001).
  1028     05  PFENTERI PIC  9(2).
  1029 01  EL6321AO REDEFINES EL6321AI.
  1030     05  FILLER            PIC  X(0012).
  1031*    -------------------------------
  1032     05  FILLER            PIC  X(0003).
  1033     05  DATEO PIC  X(0008).
  1034*    -------------------------------
  1035     05  FILLER            PIC  X(0003).
  1036     05  TIMEO PIC  99.99.
  1037*    -------------------------------
  1038     05  FILLER            PIC  X(0003).
  1039     05  CTYPE1O PIC  X(0006).
  1040*    -------------------------------
  1041     05  FILLER            PIC  X(0003).
  1042     05  LFTOTO PIC  ZZ99.
  1043*    -------------------------------
  1044     05  FILLER            PIC  X(0003).
  1045     05  LFBADO PIC  ZZ99.
  1046*    -------------------------------
  1047     05  FILLER            PIC  X(0003).
  1048     05  LFGOODO PIC  ZZ99.
  1049*    -------------------------------
  1050     05  FILLER            PIC  X(0003).
  1051     05  LFPMTSO PIC  ZZZZZZ9.99.
  1052*    -------------------------------
  1053     05  FILLER            PIC  X(0003).
  1054     05  CTYPE2O PIC  X(0006).
  1055*    -------------------------------
  1056     05  FILLER            PIC  X(0003).
  1057     05  AHTOTO PIC  ZZ99.
  1058*    -------------------------------
  1059     05  FILLER            PIC  X(0003).
  1060     05  AHBADO PIC  ZZ99.
  1061*    -------------------------------
  1062     05  FILLER            PIC  X(0003).
  1063     05  AHGOODO PIC  ZZ99.
  1064*    -------------------------------
  1065     05  FILLER            PIC  X(0003).
  1066     05  AHPMTSO PIC  ZZZZZZ9.99.
  1067*    -------------------------------
  1068     05  FILLER            PIC  X(0003).
  1069     05  RETOTO PIC  ZZZ99.
  1070*    -------------------------------
  1071     05  FILLER            PIC  X(0003).
  1072     05  REBADO PIC  ZZZ99.
  1073*    -------------------------------
  1074     05  FILLER            PIC  X(0003).
  1075     05  REGOODO PIC  ZZZ99.
  1076*    -------------------------------
  1077     05  FILLER            PIC  X(0003).
  1078     05  FUTUREO PIC  ZZZZZ9.99.
  1079*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6321.cbl
  1080     05  FILLER            PIC  X(0003).
  1081     05  PTCO PIC  ZZZZZ9.99.
  1082*    -------------------------------
  1083     05  FILLER            PIC  X(0003).
  1084     05  IBNRO PIC  ZZZZZ9.99.
  1085*    -------------------------------
  1086     05  FILLER            PIC  X(0003).
  1087     05  ERRMSGO PIC  X(0076).
  1088*    -------------------------------
  1089     05  FILLER            PIC  X(0003).
  1090     05  PFENTERO PIC  99.
  1091*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6321.cbl
  1093****************************************************************
  1094*
  1095* Copyright (c) 2007 by Clerity Solutions, Inc.
  1096* All rights reserved.
  1097*
  1098****************************************************************
  1099 01  DFHEIV.
  1100   02  DFHEIV0               PIC X(35).
  1101   02  DFHEIV1               PIC X(08).
  1102   02  DFHEIV2               PIC X(08).
  1103   02  DFHEIV3               PIC X(08).
  1104   02  DFHEIV4               PIC X(06).
  1105   02  DFHEIV5               PIC X(04).
  1106   02  DFHEIV6               PIC X(04).
  1107   02  DFHEIV7               PIC X(02).
  1108   02  DFHEIV8               PIC X(02).
  1109   02  DFHEIV9               PIC X(01).
  1110   02  DFHEIV10              PIC S9(7) COMP-3.
  1111   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1112   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1113   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1114   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1115   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1116   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1117   02  DFHEIV17              PIC X(04).
  1118   02  DFHEIV18              PIC X(04).
  1119   02  DFHEIV19              PIC X(04).
  1120   02  DFHEIV20              USAGE IS POINTER.
  1121   02  DFHEIV21              USAGE IS POINTER.
  1122   02  DFHEIV22              USAGE IS POINTER.
  1123   02  DFHEIV23              USAGE IS POINTER.
  1124   02  DFHEIV24              USAGE IS POINTER.
  1125   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1126   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1127   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1128   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1129   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1130   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1131   02  FILLER                PIC X(02).
  1132   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1133   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1134   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1135   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1136   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1137 LINKAGE  SECTION.
  1138*****************************************************************
  1139*                                                               *
  1140* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1141* All rights reserved.                                          *
  1142*                                                               *
  1143*****************************************************************
  1144 01  dfheiblk.
  1145     02  eibtime          pic s9(7) comp-3.
  1146     02  eibdate          pic s9(7) comp-3.
  1147     02  eibtrnid         pic x(4).
  1148     02  eibtaskn         pic s9(7) comp-3.
  1149     02  eibtrmid         pic x(4).
  1150     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6321.cbl
  1151     02  eibcposn         pic s9(4) comp.
  1152     02  eibcalen         pic s9(4) comp.
  1153     02  eibaid           pic x(1).
  1154     02  eibfiller1       pic x(1).
  1155     02  eibfn            pic x(2).
  1156     02  eibfiller2       pic x(2).
  1157     02  eibrcode         pic x(6).
  1158     02  eibfiller3       pic x(2).
  1159     02  eibds            pic x(8).
  1160     02  eibreqid         pic x(8).
  1161     02  eibrsrce         pic x(8).
  1162     02  eibsync          pic x(1).
  1163     02  eibfree          pic x(1).
  1164     02  eibrecv          pic x(1).
  1165     02  eibsend          pic x(1).
  1166     02  eibatt           pic x(1).
  1167     02  eibeoc           pic x(1).
  1168     02  eibfmh           pic x(1).
  1169     02  eibcompl         pic x(1).
  1170     02  eibsig           pic x(1).
  1171     02  eibconf          pic x(1).
  1172     02  eiberr           pic x(1).
  1173     02  eibrldbk         pic x(1).
  1174     02  eiberrcd         pic x(4).
  1175     02  eibsynrb         pic x(1).
  1176     02  eibnodat         pic x(1).
  1177     02  eibfiller5       pic x(2).
  1178     02  eibresp          pic 9(09) comp.
  1179     02  eibresp2         pic 9(09) comp.
  1180     02  dfheigdj         pic s9(4) comp.
  1181     02  dfheigdk         pic s9(4) comp.
  1182 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6321.cbl
  1184
  1185*                    COPY ERCPNDC.
  1186******************************************************************
  1187*                                                                *
  1188*                                                                *
  1189*                            ERCPNDC                             *
  1190*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1191*                            VMOD=2.004                          *
  1192*                                                                *
  1193*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *
  1194*                      PAYMENTS, RESERVES, EXPENSES              *
  1195*                                                                *
  1196*   FILE TYPE = VSAM,KSDS                                        *
  1197*   RECORD SIZE = 500  RECFORM = FIXED                           *
  1198*                                                                *
  1199*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *
  1200*       ALTERNATE PATHS = NONE                                   *
  1201*                                                                *
  1202*   LOG = YES                                                    *
  1203*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1204******************************************************************
  1205
  1206 01  PENDING-CLAIMS.
  1207     12  PC-RECORD-ID                     PIC XX.
  1208         88  VALID-PC-ID                      VALUE 'PC'.
  1209
  1210     12  PC-CONTROL-PRIMARY.
  1211         16  PC-COMPANY-CD                PIC X.
  1212         16  PC-CARRIER                   PIC X.
  1213         16  PC-GROUPING.
  1214             20  PC-GROUPING-PREFIX       PIC XXX.
  1215             20  PC-GROUPING-PRIME        PIC XXX.
  1216         16  PC-STATE                     PIC XX.
  1217         16  PC-ACCOUNT.
  1218             20  PC-ACCOUNT-PREFIX        PIC X(4).
  1219             20  PC-ACCOUNT-PRIME         PIC X(6).
  1220         16  PC-CERT-EFF-DT               PIC XX.
  1221         16  PC-CERT-NO.
  1222             20  PC-CERT-PRIME            PIC X(10).
  1223             20  PC-CERT-SFX              PIC X.
  1224         16  PC-CLAIM-NO                  PIC X(7).
  1225         16  PC-CHECK-NO                  PIC X(7).
  1226
  1227         16  PC-RECORD-TYPE               PIC X.
  1228             88  PC-CLAIMS                    VALUE '1'.
  1229             88  PC-RESERVES                  VALUE '2'.
  1230         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.
  1231
  1232     12  PC-LAST-MAINT-DT                 PIC XX.
  1233     12  PC-LAST-MAINT-BY                 PIC X(4).
  1234     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1235
  1236     12  PC-CLAIM-RECORD.
  1237         16  PC-CLAIM-TYPE                PIC X.
  1238             88  PC-LF-CLAIM                  VALUE '1'.
  1239             88  PC-AH-CLAIM                  VALUE '2'.
  1240             88  PC-OB-LF-CLAIM               VALUE '3'.
  1241             88  PC-OB-AH-CLAIM               VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6321.cbl
  1242         16  PC-PAYMENT-DT                PIC XX.
  1243         16  PC-PAID-THRU-DT              PIC XX.
  1244         16  PC-REPORTED-DT               PIC XX.
  1245         16  PC-INCURRED-DT               PIC XX.
  1246         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.
  1247         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.
  1248         16  PC-AGE-AT-CLAIM              PIC 99.
  1249         16  FILLER                       PIC XX.
  1250         16  PC-PAYMENT-TYPE              PIC X.
  1251             88  PC-PARTIAL-PAYMENT           VALUE '1'.
  1252             88  PC-FINAL-PAYMENT             VALUE '2'.
  1253             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.
  1254             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.
  1255             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.
  1256             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.
  1257             88  PC-VOIDED-PAYMENT            VALUE '9'.
  1258
  1259         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.
  1260         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.
  1261         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.
  1262         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.
  1263
  1264         16  PC-SV-CARRIER                PIC X.
  1265         16  PC-SV-GROUPING               PIC X(6).
  1266         16  PC-SV-STATE                  PIC XX.
  1267
  1268         16  PC-VOID-SW                   PIC X.
  1269             88  PC-PUT-CERT-INFORCE          VALUE '1'.
  1270
  1271         16  PC-CAUSE-CODE                PIC X(6).
  1272         16  FILLER                       PIC X(48).
  1273
  1274         16  PC-CLAIMED-CERT-DATA.
  1275             20  PC-CC-INSURED-NAME.
  1276                 24  PC-CC-LAST-NAME      PIC X(15).
  1277                 24  PC-CC-INITIALS       PIC XX.
  1278             20  PC-CC-INSURED-AGE        PIC S99.
  1279             20  PC-CC-INSURED-SEX        PIC X.
  1280             20  PC-CC-ORIG-TERM          PIC S999        COMP-3.
  1281             20  PC-CC-LF-BENEFIT-CD      PIC XX.
  1282             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3.
  1283             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1284             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3.
  1285             20  PC-CC-AH-BENEFIT-CD      PIC XX.
  1286             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1287             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1288             20  PC-CC-RATE-CLASS         PIC XX.
  1289             20  PC-CC-RATE-DEV           PIC XXX.
  1290             20  PC-CC-OB-FLAG            PIC X.
  1291                 88  PC-CC-OB                VALUE 'B'.
  1292             20  PC-CC-AH-POLICY-STATUS   PIC X.
  1293                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3'
  1294                                               '4' '5' '9' '2'.
  1295                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.
  1296                 88  PC-CCA-POLICY-PENDING          VALUE '2'.
  1297                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.
  1298                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.
  1299                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6321.cbl
  1300                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.
  1301                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.
  1302                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.
  1303                 88  PC-CCA-REIN-ONLY               VALUE '9'.
  1304             20  PC-CC-LF-POLICY-STATUS   PIC X.
  1305                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3'
  1306                                               '4' '5' '9' '2'.
  1307                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.
  1308                 88  PC-CCL-POLICY-PENDING          VALUE '2'.
  1309                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.
  1310                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.
  1311                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.
  1312                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.
  1313                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.
  1314                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.
  1315                 88  PC-CCL-REIN-ONLY               VALUE '9'.
  1316             20  PC-CC-PAY-FREQUENCY      PIC 99.
  1317             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1318             20  PC-CC-SOC-SEC-NO         PIC X(11).
  1319             20  PC-CC-MEMBER-NO          PIC X(12).
  1320             20  PC-CC-INT-CODE           PIC X.
  1321                 88  PC-CC-ADD-ON                  VALUE 'A'.
  1322                 88  PC-CC-SIMPLE                  VALUE 'S'.
  1323             20  PC-CC-CAPPED-TERM        PIC 999.
  1324             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.
  1325             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.
  1326             20  PC-CC-CANCEL-DT          PIC XX.
  1327             20  PC-CC-DEATH-DT           PIC XX.
  1328             20  PC-CC-SETTLEMENT-DT      PIC XX.
  1329             20  PC-CC-PRIOR-STATUS       PIC X.
  1330             20  PC-CC-CERT-ENTRY-STATUS  PIC X.
  1331         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.
  1332         16  PC-CC-CLP-STATE              PIC XX.
  1333         16  FILLER                       PIC X(14).
  1334         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.
  1335         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.
  1336         16  FILLER                       PIC X(34).
  1337
  1338     12  PC-RECORD-STATUS.
  1339         16  PC-CREDIT-SELECT-DT          PIC XX.
  1340         16  PC-CREDIT-ACCEPT-DT          PIC XX.
  1341         16  FILLER                       PIC XX.
  1342         16  PC-FATAL-FLAG                PIC X.
  1343             88  PC-FATAL-ERRORS             VALUE 'X'.
  1344         16  PC-FORCE-CODE                PIC X.
  1345             88  PC-FORCE-OFF                VALUE ' ' '0'.
  1346             88  PC-CLAIM-FORCE              VALUE '6' '7'
  1347                                                     '8'.
  1348         16  PC-FORCE-ER-CD               PIC X.
  1349             88  PC-FORCE-ERRORS             VALUE 'F'.
  1350             88  PC-UNFORCED-ERRORS          VALUE 'X'.
  1351         16  PC-WARN-ER-CD                PIC X.
  1352             88  PC-WARNING-ERRORS           VALUE 'W'.
  1353         16  PC-LF-OVERRIDE-L1            PIC X.
  1354         16  PC-AH-OVERRIDE-L1            PIC X.
  1355         16  FILLER                       PIC X(17).
  1356         16  PC-CERT-UPDATE-SW            PIC X.
  1357             88  PC-CERT-DATA-CAPTURED       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6321.cbl
  1358         16  PC-COMPANY-ID                PIC XXX.
  1359         16  PC-INPUT-DT                  PIC XX.
  1360
  1361     12  PC-ERROR-FLAGS.
  1362         16  PC-STANDARD-ERRORS.
  1363             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.
  1364         16  PC-TRANSACTION-ERRORS.
  1365             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.
  1366
  1367     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.
  1368         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.
  1369
  1370     12  FILLER                           PIC X(25).
  1371
  1372******************************************************************
  1373
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6321.cbl
  1375 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-CLAIMS.
  1376 0000-DFHEXIT SECTION.
  1377     MOVE '9#                    $   ' TO DFHEIV0.
  1378     MOVE 'EL6321' TO DFHEIV1.
  1379     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1380
  1381     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  1382
  1383     IF EIBCALEN = ZERO
  1384         GO TO 8800-UNAUTHORIZED-ACCESS.
  1385
  1386     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  1387     MOVE '5'                    TO  DC-OPTION-CODE.
  1388
  1389     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  1390
  1391     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  1392
  1393     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1394         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1395             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  1396             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  1397             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  1398             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  1399             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  1400             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  1401             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  1402             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  1403         ELSE
  1404             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  1405             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  1406             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  1407             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  1408             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  1409             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  1410             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  1411             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  1412
  1413     MOVE LOW-VALUES             TO  EL6321AI.
  1414     MOVE PI-COMPANY-CD          TO  PNDC-COMPANY-CD.
  1415
  1416
  1417* EXEC CICS HANDLE CONDITION
  1418*        PGMIDERR  (9600-PGMID-ERROR)
  1419*        ERROR     (9990-ABEND)
  1420*        END-EXEC.
  1421*    MOVE '"$L.                  ! " #00001412' TO DFHEIV0
  1422     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1424     MOVE X'2220233030303031343132' TO DFHEIV0(25:11)
  1425     CALL 'kxdfhei1' USING DFHEIV0
  1426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1427
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6321.cbl
  1429     IF EIBTRNID NOT = TRANS-ID
  1430         GO TO 0200-PROCESS.
  1431
  1432     IF EIBAID = DFHCLEAR              OR  DFHENTER
  1433         GO TO 9400-CLEAR.
  1434
  1435     IF EIBAID = DFHPF23
  1436         GO TO 8810-PF23.
  1437
  1438     IF EIBAID = DFHPF24
  1439         GO TO 9200-RETURN-MAIN-MENU.
  1440
  1441     IF EIBAID = DFHPF12
  1442         GO TO 9500-PF12.
  1443
  1444     MOVE ER-0029                TO  EMI-ERROR.
  1445
  1446     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  1447
  1448     MOVE AL-UNBON               TO  PFENTERA.
  1449     MOVE -1                     TO  PFENTERL.
  1450
  1451     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6321.cbl
  1453 0200-PROCESS.
  1454
  1455* EXEC CICS HANDLE CONDITION
  1456*        NOTFND   (0400-END-OF-COMPANY)
  1457*        ENDFILE  (0400-END-OF-COMPANY)
  1458*    END-EXEC.
  1459*    MOVE '"$I''                  ! # #00001442' TO DFHEIV0
  1460     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  1461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1462     MOVE X'2320233030303031343432' TO DFHEIV0(25:11)
  1463     CALL 'kxdfhei1' USING DFHEIV0
  1464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1465
  1466
  1467
  1468* EXEC CICS STARTBR
  1469*        DATASET  (ERPNDC-FILE-ID)
  1470*        RIDFLD   (ERPNDC-KEY)
  1471*    END-EXEC.
  1472     MOVE 0
  1473       TO DFHEIV11
  1474*    MOVE '&,         G          &   #00001447' TO DFHEIV0
  1475     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1476     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1477     MOVE X'2020233030303031343437' TO DFHEIV0(25:11)
  1478     CALL 'kxdfhei1' USING DFHEIV0,
  1479           ERPNDC-FILE-ID,
  1480           ERPNDC-KEY,
  1481           DFHEIV99,
  1482           DFHEIV11,
  1483           DFHEIV99
  1484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1485
  1486
  1487 0300-PROCESS-LOOP.
  1488
  1489* EXEC CICS READNEXT
  1490*        DATASET  (ERPNDC-FILE-ID)
  1491*        SET      (ADDRESS OF PENDING-CLAIMS)
  1492*        RIDFLD   (ERPNDC-KEY)
  1493*    END-EXEC.
  1494     MOVE 0
  1495       TO DFHEIV11
  1496*    MOVE '&.S                   )   #00001453' TO DFHEIV0
  1497     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1498     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1499     MOVE X'2020233030303031343533' TO DFHEIV0(25:11)
  1500     CALL 'kxdfhei1' USING DFHEIV0,
  1501           ERPNDC-FILE-ID,
  1502           DFHEIV20,
  1503           DFHEIV99,
  1504           ERPNDC-KEY,
  1505           DFHEIV99,
  1506           DFHEIV11,
  1507           DFHEIV99,
  1508           DFHEIV99
  1509     SET ADDRESS OF PENDING-CLAIMS TO
  1510         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6321.cbl
  1511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1512
  1513
  1514     IF PC-COMPANY-CD NOT = PI-COMPANY-CD
  1515         GO TO 0400-END-OF-COMPANY.
  1516
  1517     IF PC-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  1518         GO TO 0300-PROCESS-LOOP.
  1519
  1520     IF PC-FATAL-ERRORS
  1521       OR PC-UNFORCED-ERRORS
  1522         IF PC-CLAIMS
  1523             IF PC-LF-CLAIM
  1524               OR PC-OB-LF-CLAIM
  1525                 ADD +1                 TO  LF-PYMNT-BAD
  1526             ELSE
  1527                 ADD +1                 TO  AH-PYMNT-BAD
  1528         ELSE
  1529             ADD +1                     TO  RSV-BAD
  1530     ELSE
  1531         IF PC-CLAIMS
  1532             IF PC-LF-CLAIM
  1533               OR PC-OB-LF-CLAIM
  1534                 ADD +1                 TO  LF-PYMNT-GOOD
  1535                 ADD PC-CLAIM-PAYMENT   TO  LF-PYMNT-AMT
  1536             ELSE
  1537                 ADD +1                 TO  AH-PYMNT-GOOD
  1538                 ADD PC-CLAIM-PAYMENT   TO  AH-PYMNT-AMT
  1539         ELSE
  1540             ADD +1                     TO  RSV-GOOD
  1541             ADD PC-FUTURE-RESERVE-AMT  TO  RSV-FUTURE
  1542             ADD PC-PTC-RESERVE-AMT     TO  RSV-PTC
  1543             ADD PC-IBNR-RESERVE-AMT    TO  RSV-IBNR.
  1544
  1545     GO TO 0300-PROCESS-LOOP.
  1546
  1547 0400-END-OF-COMPANY.
  1548     ADD LF-PYMNT-GOOD  LF-PYMNT-BAD  GIVING  LFTOTO.
  1549     ADD AH-PYMNT-GOOD  AH-PYMNT-BAD  GIVING  AHTOTO.
  1550
  1551     MOVE LF-PYMNT-GOOD          TO  LFGOODO.
  1552     MOVE LF-PYMNT-BAD           TO  LFBADO.
  1553     MOVE LF-PYMNT-AMT           TO  LFPMTSO.
  1554     MOVE AH-PYMNT-GOOD          TO  AHGOODO.
  1555     MOVE AH-PYMNT-BAD           TO  AHBADO.
  1556     MOVE AH-PYMNT-AMT           TO  AHPMTSO.
  1557
  1558     ADD RSV-GOOD  RSV-BAD  GIVING  RETOTO.
  1559
  1560     MOVE RSV-GOOD               TO  REGOODO.
  1561     MOVE RSV-BAD                TO  REBADO.
  1562     MOVE RSV-FUTURE             TO  FUTUREO.
  1563     MOVE RSV-PTC                TO  PTCO.
  1564     MOVE RSV-IBNR               TO  IBNRO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6321.cbl
  1566 8100-SEND-INITIAL-MAP.
  1567     MOVE WS-CURRENT-DT          TO  DATEO.
  1568     MOVE EIBTIME                TO  TIME-IN.
  1569     MOVE TIME-OUT               TO  TIMEO.
  1570     MOVE PI-LIFE-OVERRIDE-L6    TO  CTYPE1O.
  1571     MOVE PI-AH-OVERRIDE-L6      TO  CTYPE2O.
  1572     MOVE -1                     TO  PFENTERL.
  1573     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSGO.
  1574
  1575
  1576* EXEC CICS SEND
  1577*        MAP     (MAP-NAME)
  1578*        MAPSET  (MAPSET-NAME)
  1579*        FROM    (EL6321AO)
  1580*        ERASE
  1581*        CURSOR
  1582*    END-EXEC.
  1583     MOVE LENGTH OF
  1584      EL6321AO
  1585       TO DFHEIV12
  1586     MOVE -1
  1587       TO DFHEIV11
  1588*    MOVE '8$     CT  E    H L F ,   #00001520' TO DFHEIV0
  1589     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1590     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1591     MOVE X'2020233030303031353230' TO DFHEIV0(25:11)
  1592     CALL 'kxdfhei1' USING DFHEIV0,
  1593           MAP-NAME,
  1594           EL6321AO,
  1595           DFHEIV12,
  1596           MAPSET-NAME,
  1597           DFHEIV99,
  1598           DFHEIV99,
  1599           DFHEIV99,
  1600           DFHEIV11,
  1601           DFHEIV99,
  1602           DFHEIV99,
  1603           DFHEIV99
  1604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1605
  1606
  1607     GO TO 9100-RETURN-TRAN.
  1608
  1609 8200-SEND-DATAONLY.
  1610     MOVE WS-CURRENT-DT          TO  DATEO.
  1611     MOVE EIBTIME                TO  TIME-IN.
  1612     MOVE TIME-OUT               TO  TIMEO.
  1613     MOVE PI-LIFE-OVERRIDE-L6    TO  CTYPE1O.
  1614     MOVE PI-AH-OVERRIDE-L6      TO  CTYPE2O.
  1615     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSGO.
  1616
  1617
  1618* EXEC CICS SEND
  1619*        MAP     (MAP-NAME)
  1620*        MAPSET  (MAPSET-NAME)
  1621*        FROM    (EL6321AO)
  1622*        DATAONLY
  1623*        ERASEAUP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6321.cbl
  1624*        CURSOR
  1625*    END-EXEC.
  1626     MOVE LENGTH OF
  1627      EL6321AO
  1628       TO DFHEIV12
  1629     MOVE -1
  1630       TO DFHEIV11
  1631*    MOVE '8$D    CT  A    H L F ,   #00001538' TO DFHEIV0
  1632     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  1633     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1634     MOVE X'2020233030303031353338' TO DFHEIV0(25:11)
  1635     CALL 'kxdfhei1' USING DFHEIV0,
  1636           MAP-NAME,
  1637           EL6321AO,
  1638           DFHEIV12,
  1639           MAPSET-NAME,
  1640           DFHEIV99,
  1641           DFHEIV99,
  1642           DFHEIV99,
  1643           DFHEIV11,
  1644           DFHEIV99,
  1645           DFHEIV99,
  1646           DFHEIV99
  1647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1648
  1649
  1650     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6321.cbl
  1652 8300-SEND-TEXT.
  1653
  1654* EXEC CICS SEND TEXT
  1655*        FROM    (LOGOFF-TEXT)
  1656*        LENGTH  (LOGOFF-LENGTH)
  1657*        ERASE
  1658*        FREEKB
  1659*    END-EXEC.
  1660*    MOVE '8&      T  E F  H   F -   #00001550' TO DFHEIV0
  1661     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  1662     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  1663     MOVE X'2020233030303031353530' TO DFHEIV0(25:11)
  1664     CALL 'kxdfhei1' USING DFHEIV0,
  1665           LOGOFF-TEXT,
  1666           LOGOFF-LENGTH,
  1667           DFHEIV99,
  1668           DFHEIV99,
  1669           DFHEIV99,
  1670           DFHEIV99,
  1671           DFHEIV99,
  1672           DFHEIV99,
  1673           DFHEIV99,
  1674           DFHEIV99,
  1675           DFHEIV99,
  1676           DFHEIV99
  1677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1678
  1679
  1680
  1681* EXEC CICS RETURN
  1682*    END-EXEC.
  1683*    MOVE '.(                    &   #00001557' TO DFHEIV0
  1684     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1685     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1686     MOVE X'2020233030303031353537' TO DFHEIV0(25:11)
  1687     CALL 'kxdfhei1' USING DFHEIV0,
  1688           DFHEIV99,
  1689           DFHEIV99,
  1690           DFHEIV99,
  1691           DFHEIV99,
  1692           DFHEIV99
  1693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1694
  1695
  1696 8500-DATE-CONVERT.
  1697     MOVE LINK-CLDATCV           TO  PGM-NAME.
  1698
  1699
  1700* EXEC CICS LINK
  1701*        PROGRAM   (PGM-NAME)
  1702*        COMMAREA  (DATE-CONVERSION-DATA)
  1703*        LENGTH    (DC-COMM-LENGTH)
  1704*    END-EXEC.
  1705*    MOVE '."C                   ''   #00001563' TO DFHEIV0
  1706     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1707     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1708     MOVE X'2020233030303031353633' TO DFHEIV0(25:11)
  1709     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6321.cbl
  1710           PGM-NAME,
  1711           DATE-CONVERSION-DATA,
  1712           DC-COMM-LENGTH,
  1713           DFHEIV99,
  1714           DFHEIV99,
  1715           DFHEIV99
  1716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1717
  1718
  1719 8500-EXIT.
  1720     EXIT.
  1721
  1722 8800-UNAUTHORIZED-ACCESS.
  1723     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  1724
  1725     GO TO 8300-SEND-TEXT.
  1726
  1727 8810-PF23.
  1728     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  1729     MOVE XCTL-005               TO  PGM-NAME.
  1730
  1731     GO TO 9300-XCTL.
  1732
  1733 9100-RETURN-TRAN.
  1734     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  1735     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  1736
  1737
  1738* EXEC CICS RETURN
  1739*        TRANSID   (TRANS-ID)
  1740*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1741*        LENGTH    (PI-COMM-LENGTH)
  1742*    END-EXEC.
  1743*    MOVE '.(CT                  &   #00001587' TO DFHEIV0
  1744     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1745     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1746     MOVE X'2020233030303031353837' TO DFHEIV0(25:11)
  1747     CALL 'kxdfhei1' USING DFHEIV0,
  1748           TRANS-ID,
  1749           PROGRAM-INTERFACE-BLOCK,
  1750           PI-COMM-LENGTH,
  1751           DFHEIV99,
  1752           DFHEIV99
  1753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1754
  1755
  1756 9200-RETURN-MAIN-MENU.
  1757     MOVE XCTL-626               TO  PGM-NAME.
  1758
  1759     GO TO 9300-XCTL.
  1760
  1761 9300-XCTL.
  1762
  1763* EXEC CICS XCTL
  1764*        PROGRAM   (PGM-NAME)
  1765*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1766*        LENGTH    (PI-COMM-LENGTH)
  1767*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6321.cbl
  1768*    MOVE '.$C                   $   #00001599' TO DFHEIV0
  1769     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  1770     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1771     MOVE X'2020233030303031353939' TO DFHEIV0(25:11)
  1772     CALL 'kxdfhei1' USING DFHEIV0,
  1773           PGM-NAME,
  1774           PROGRAM-INTERFACE-BLOCK,
  1775           PI-COMM-LENGTH
  1776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1777
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6321.cbl
  1779 9400-CLEAR.
  1780     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  1781
  1782     GO TO 9300-XCTL.
  1783
  1784 9500-PF12.
  1785     MOVE XCTL-010               TO  PGM-NAME.
  1786
  1787     GO TO 9300-XCTL.
  1788
  1789 9600-PGMID-ERROR.
  1790
  1791* EXEC CICS HANDLE CONDITION
  1792*        PGMIDERR  (8300-SEND-TEXT)
  1793*    END-EXEC.
  1794*    MOVE '"$L                   ! $ #00001616' TO DFHEIV0
  1795     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  1796     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1797     MOVE X'2420233030303031363136' TO DFHEIV0(25:11)
  1798     CALL 'kxdfhei1' USING DFHEIV0
  1799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1800
  1801
  1802     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  1803     MOVE ' '                    TO  PI-ENTRY-CD-1.
  1804     MOVE XCTL-005               TO  PGM-NAME.
  1805     MOVE PGM-NAME               TO  LOGOFF-PGM.
  1806     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  1807
  1808     GO TO 9300-XCTL.
  1809
  1810 9900-ERROR-FORMAT.
  1811     IF NOT EMI-ERRORS-COMPLETE
  1812         MOVE LINK-001           TO  PGM-NAME
  1813
  1814* EXEC CICS LINK
  1815*            PROGRAM   (PGM-NAME)
  1816*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  1817*            LENGTH    (EMI-COMM-LENGTH)
  1818*        END-EXEC.
  1819*    MOVE '."C                   ''   #00001631' TO DFHEIV0
  1820     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1821     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1822     MOVE X'2020233030303031363331' TO DFHEIV0(25:11)
  1823     CALL 'kxdfhei1' USING DFHEIV0,
  1824           PGM-NAME,
  1825           ERROR-MESSAGE-INTERFACE-BLOCK,
  1826           EMI-COMM-LENGTH,
  1827           DFHEIV99,
  1828           DFHEIV99,
  1829           DFHEIV99
  1830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1831
  1832
  1833 9900-EXIT.
  1834     EXIT.
  1835
  1836 9990-ABEND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6321.cbl
  1837     MOVE LINK-004               TO  PGM-NAME.
  1838     MOVE DFHEIBLK               TO  EMI-LINE1
  1839
  1840
  1841* EXEC CICS LINK
  1842*        PROGRAM   (PGM-NAME)
  1843*        COMMAREA  (EMI-LINE1)
  1844*        LENGTH    (72)
  1845*    END-EXEC.
  1846     MOVE 72
  1847       TO DFHEIV11
  1848*    MOVE '."C                   ''   #00001644' TO DFHEIV0
  1849     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1850     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1851     MOVE X'2020233030303031363434' TO DFHEIV0(25:11)
  1852     CALL 'kxdfhei1' USING DFHEIV0,
  1853           PGM-NAME,
  1854           EMI-LINE1,
  1855           DFHEIV11,
  1856           DFHEIV99,
  1857           DFHEIV99,
  1858           DFHEIV99
  1859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1860
  1861
  1862     GO TO 8200-SEND-DATAONLY.
  1863
  1864
  1865* GOBACK.
  1866     MOVE '9%                    "   ' TO DFHEIV0
  1867     MOVE 'EL6321' TO DFHEIV1
  1868     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1869     GOBACK.
  1870
  1871 9995-SECURITY-VIOLATION.
  1872*                            COPY ELCSCTP.
  1873******************************************************************
  1874*                                                                *
  1875*                            ELCSCTP                             *
  1876*                            VMOD=2.001                          *
  1877*                                                                *
  1878*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  1879******************************************************************
  1880
  1881
  1882     MOVE EIBDATE          TO SM-JUL-DATE.
  1883     MOVE EIBTRMID         TO SM-TERMID.
  1884     MOVE THIS-PGM         TO SM-PGM.
  1885     MOVE EIBTIME          TO TIME-IN.
  1886     MOVE TIME-OUT         TO SM-TIME.
  1887     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  1888
  1889
  1890* EXEC CICS LINK
  1891*         PROGRAM  ('EL003')
  1892*         COMMAREA (SECURITY-MESSAGE)
  1893*         LENGTH   (80)
  1894*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6321.cbl
  1895     MOVE 'EL003' TO DFHEIV1
  1896     MOVE 80
  1897       TO DFHEIV11
  1898*    MOVE '."C                   ''   #00001672' TO DFHEIV0
  1899     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1900     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1901     MOVE X'2020233030303031363732' TO DFHEIV0(25:11)
  1902     CALL 'kxdfhei1' USING DFHEIV0,
  1903           DFHEIV1,
  1904           SECURITY-MESSAGE,
  1905           DFHEIV11,
  1906           DFHEIV99,
  1907           DFHEIV99,
  1908           DFHEIV99
  1909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1910
  1911
  1912******************************************************************
  1913
  1914
  1915 9995-EXIT.
  1916     EXIT.
  1917
  1918
  1919 9999-DFHBACK SECTION.
  1920     MOVE '9%                    "   ' TO DFHEIV0
  1921     MOVE 'EL6321' TO DFHEIV1
  1922     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1923     GOBACK.
  1924 9999-DFHEXIT.
  1925     IF DFHEIGDJ EQUAL 0001
  1926         NEXT SENTENCE
  1927     ELSE IF DFHEIGDJ EQUAL 2
  1928         GO TO 9600-PGMID-ERROR,
  1929               9990-ABEND
  1930         DEPENDING ON DFHEIGDI
  1931     ELSE IF DFHEIGDJ EQUAL 3
  1932         GO TO 0400-END-OF-COMPANY,
  1933               0400-END-OF-COMPANY
  1934         DEPENDING ON DFHEIGDI
  1935     ELSE IF DFHEIGDJ EQUAL 4
  1936         GO TO 8300-SEND-TEXT
  1937         DEPENDING ON DFHEIGDI.
  1938     MOVE '9%                    "   ' TO DFHEIV0
  1939     MOVE 'EL6321' TO DFHEIV1
  1940     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1941     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4240     Code:        3272
