* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL856.cbl
* Options: int("EL856.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL856.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL856.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL856.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL856 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/14/96 08:09:25.
     7*                            VMOD=2.003
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL856.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS. TRANSACTION - EXJ8 - ACCOUNTS RECEIVABLE
    26*                              SUMMARY CROSS REFERENCE.
    27
    28 ENVIRONMENT DIVISION.
    29
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL856.cbl
    31 DATA DIVISION.
    32 WORKING-STORAGE SECTION.
    33 01  DFH-START PIC X(04).
    34
    35 77  FILLER  PIC X(32)  VALUE '********************************'.
    36 77  FILLER  PIC X(32)  VALUE '*    EL856 WORKING STORAGE     *'.
    37 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.003 *********'.
    38
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL856.cbl
    40
    41*                            COPY ELCSCTM.
    42******************************************************************
    43*                                                                *
    44*                                                                *
    45*                            ELCSCTM                             *
    46*                            VMOD=2.001                          *
    47*                                                                *
    48*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    49*                                                                *
    50******************************************************************
    51 01  SECURITY-MESSAGE.
    52     12  FILLER                          PIC X(30)
    53            VALUE '** LOGIC SECURITY VIOLATION -'.
    54     12  SM-READ                         PIC X(6).
    55     12  FILLER                          PIC X(5)
    56            VALUE ' PGM='.
    57     12  SM-PGM                          PIC X(6).
    58     12  FILLER                          PIC X(5)
    59            VALUE ' OPR='.
    60     12  SM-PROCESSOR-ID                 PIC X(4).
    61     12  FILLER                          PIC X(6)
    62            VALUE ' TERM='.
    63     12  SM-TERMID                       PIC X(4).
    64     12  FILLER                          PIC XX   VALUE SPACE.
    65     12  SM-JUL-DATE                     PIC 9(5).
    66     12  FILLER                          PIC X    VALUE SPACE.
    67     12  SM-TIME                         PIC 99.99.
    68
    69*                            COPY ELCSCRTY.
    70******************************************************************
    71*                                                                *
    72*                                                                *
    73*                            ELCSCRTY                            *
    74*                            VMOD=2.001                          *
    75*                                                                *
    76*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    77*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    78*        SAVED IN PI-SECURITY-ADDRESS.                           *
    79*                                                                *
    80******************************************************************
    81 01  SECURITY-CONTROL.
    82     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    83     12  FILLER                       PIC XX    VALUE 'SC'.
    84     12  SC-CREDIT-CODES.
    85         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    86             20  SC-CREDIT-DISPLAY    PIC X.
    87             20  SC-CREDIT-UPDATE     PIC X.
    88     12  SC-CLAIMS-CODES.
    89         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    90             20  SC-CLAIMS-DISPLAY    PIC X.
    91             20  SC-CLAIMS-UPDATE     PIC X.
    92
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL856.cbl
    94
    95******************************************************************
    96*                                                                *
    97*              S T A N D A R D   A R E A S                       *
    98*                                                                *
    99******************************************************************
   100
   101 01  STANDARD-AREAS.
   102     12  SC-ITEM                 PIC S9(4)   VALUE +1 COMP.
   103     12  QID.
   104         16  QID-TERM            PIC X(4)      VALUE SPACES.
   105         16  FILLER              PIC X(4)      VALUE '125D'.
   106
   107     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   108     12  EL856A                  PIC X(8)    VALUE 'EL856A'.
   109     12  MAPSET-EL856S           PIC X(8)    VALUE 'EL856S '.
   110     12  TRANS-EXJ8              PIC X(4)    VALUE 'EXJ8'.
   111     12  TRANS-EXD4              PIC X(4)    VALUE 'EXD4'.
   112     12  THIS-PGM                PIC X(8)    VALUE 'EL856'.
   113     12  PGM-NAME                PIC X(8).
   114     12  TIME-IN                 PIC S9(7).
   115     12  TIME-OUT-R  REDEFINES TIME-IN.
   116         16  FILLER              PIC X.
   117         16  TIME-OUT            PIC 99V99.
   118         16  FILLER              PIC X(2).
   119     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   120     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   121     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   122     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   123     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   124     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   125     12  FILE-ID-ERSUMM          PIC X(8)    VALUE 'ERSUMM'.
   126     12  WS-CURRENT-DT           PIC X(8)    VALUE SPACES.
   127     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   128     12  WS-BROWSE-STARTED-SW    PIC X       VALUE SPACE.
   129         88 WS-BROWSE-STARTED                VALUE 'Y'.
   130     12  WS-SUB1                 PIC S9(4)   VALUE ZEROS COMP.
   131     12  WS-ACCESS-KEY           PIC X(34)   VALUE SPACES.
   132
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL856.cbl
   134
   135******************************************************************
   136*                                                                *
   137*                E R R O R   M E S S A G E S                     *
   138*                                                                *
   139******************************************************************
   140
   141 01  ERROR-MESSAGES.
   142     12  ER-0000                 PIC X(4)  VALUE '0000'.
   143     12  ER-0004                 PIC X(4)  VALUE '0004'.
   144     12  ER-0008                 PIC X(4)  VALUE '0008'.
   145     12  ER-0023                 PIC X(4)  VALUE '0023'.
   146     12  ER-0029                 PIC X(4)  VALUE '0029'.
   147     12  ER-0070                 PIC X(4)  VALUE '0070'.
   148     12  ER-2132                 PIC X(4)  VALUE '2132'.
   149     12  ER-2237                 PIC X(4)  VALUE '2237'.
   150     12  ER-2238                 PIC X(4)  VALUE '2238'.
   151     12  ER-3133                 PIC X(4)  VALUE '3133'.
   152     12  ER-3135                 PIC X(4)  VALUE '3135'.
   153
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL856.cbl
   155
   156******************************************************************
   157*                                                                *
   158*              A C C E S S   K E Y S                             *
   159*                                                                *
   160******************************************************************
   161
   162 01  ACCESS-KEYS.
   163
   164     12  ERSUMM-KEY.
   165         16  ERSUMM-COMPANY-CD      PIC X     VALUE SPACE.
   166         16  ERSUMM-SUMMARY         PIC X(6)  VALUE SPACE.
   167         16  ERSUMM-CARRIER         PIC X     VALUE SPACE.
   168         16  ERSUMM-GROUP           PIC X(6)  VALUE SPACE.
   169         16  ERSUMM-FIN-RESP        PIC X(10) VALUE SPACE.
   170         16  ERSUMM-ACCT-AGENT      PIC X(10) VALUE SPACE.
   171
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL856.cbl
   173
   174*                            COPY ELCDATE.
   175******************************************************************
   176*                                                                *
   177*                                                                *
   178*                            ELCDATE.                            *
   179*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   180*                            VMOD=2.003
   181*                                                                *
   182*                                                                *
   183*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   184*                 LENGTH = 200                                   *
   185******************************************************************
   186
   187 01  DATE-CONVERSION-DATA.
   188     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   189     12  DC-OPTION-CODE                PIC X.
   190         88  BIN-TO-GREG                VALUE ' '.
   191         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   192         88  EDIT-GREG-TO-BIN           VALUE '2'.
   193         88  YMD-GREG-TO-BIN            VALUE '3'.
   194         88  MDY-GREG-TO-BIN            VALUE '4'.
   195         88  JULIAN-TO-BIN              VALUE '5'.
   196         88  BIN-PLUS-ELAPSED           VALUE '6'.
   197         88  FIND-CENTURY               VALUE '7'.
   198         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   199         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   200         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   201         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   202         88  JULIAN-TO-BIN-3            VALUE 'C'.
   203         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   204         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   205         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   206         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   207         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   208         88  CHECK-LEAP-YEAR            VALUE 'H'.
   209         88  BIN-3-TO-GREG              VALUE 'I'.
   210         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   211         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   212         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   213         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   214         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   215         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   216         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   217         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   218         88  THREE-CHARACTER-BIN
   219                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   220         88  GREGORIAN-TO-BIN
   221                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   222         88  BIN-TO-GREGORIAN
   223                  VALUES ' ' '1' 'I' '8' 'G'.
   224         88  JULIAN-TO-BINARY
   225                  VALUES '5' 'C' 'E' 'F'.
   226     12  DC-ERROR-CODE                 PIC X.
   227         88  NO-CONVERSION-ERROR        VALUE ' '.
   228         88  DATE-CONVERSION-ERROR
   229                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   230         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL856.cbl
   231         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   232         88  DATE-IS-INVALID            VALUE '3'.
   233         88  DATE1-GREATER-DATE2        VALUE '4'.
   234         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   235         88  DATE-INVALID-OPTION        VALUE '9'.
   236         88  INVALID-CENTURY            VALUE 'A'.
   237         88  ONLY-CENTURY               VALUE 'B'.
   238         88  ONLY-LEAP-YEAR             VALUE 'C'.
   239         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   240     12  DC-END-OF-MONTH               PIC X.
   241         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   242     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   243         88  USE-NORMAL-PROCESS         VALUE ' '.
   244         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   245         88  ADJUST-UP-100-YRS          VALUE '2'.
   246     12  FILLER                        PIC X.
   247     12  DC-CONVERSION-DATES.
   248         16  DC-BIN-DATE-1             PIC XX.
   249         16  DC-BIN-DATE-2             PIC XX.
   250         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   251         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   252                       DC-GREG-DATE-1-EDIT.
   253             20  DC-EDIT1-MONTH        PIC 99.
   254             20  SLASH1-1              PIC X.
   255             20  DC-EDIT1-DAY          PIC 99.
   256             20  SLASH1-2              PIC X.
   257             20  DC-EDIT1-YEAR         PIC 99.
   258         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   259         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   260                     DC-GREG-DATE-2-EDIT.
   261             20  DC-EDIT2-MONTH        PIC 99.
   262             20  SLASH2-1              PIC X.
   263             20  DC-EDIT2-DAY          PIC 99.
   264             20  SLASH2-2              PIC X.
   265             20  DC-EDIT2-YEAR         PIC 99.
   266         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   267         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   268                     DC-GREG-DATE-1-YMD.
   269             20  DC-YMD-YEAR           PIC 99.
   270             20  DC-YMD-MONTH          PIC 99.
   271             20  DC-YMD-DAY            PIC 99.
   272         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   273         16  DC-GREG-DATE-1-MDY-R REDEFINES
   274                      DC-GREG-DATE-1-MDY.
   275             20  DC-MDY-MONTH          PIC 99.
   276             20  DC-MDY-DAY            PIC 99.
   277             20  DC-MDY-YEAR           PIC 99.
   278         16  DC-GREG-DATE-1-ALPHA.
   279             20  DC-ALPHA-MONTH        PIC X(10).
   280             20  DC-ALPHA-DAY          PIC 99.
   281             20  FILLER                PIC XX.
   282             20  DC-ALPHA-CENTURY.
   283                 24 DC-ALPHA-CEN-N     PIC 99.
   284             20  DC-ALPHA-YEAR         PIC 99.
   285         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   286         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   287         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   288         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL856.cbl
   289         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   290                                       PIC 9(05).
   291         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   292             20  DC-JULIAN-YEAR        PIC 99.
   293             20  DC-JULIAN-DAYS        PIC 999.
   294         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   295         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   296         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   297     12  DATE-CONVERSION-VARIBLES.
   298         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   299         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   300             20  FILLER                PIC 9(3).
   301             20  HOLD-CEN-1-CCYY.
   302                 24  HOLD-CEN-1-CC     PIC 99.
   303                 24  HOLD-CEN-1-YY     PIC 99.
   304             20  HOLD-CEN-1-MO         PIC 99.
   305             20  HOLD-CEN-1-DA         PIC 99.
   306         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   307             20  HOLD-CEN-1-R-MO       PIC 99.
   308             20  HOLD-CEN-1-R-DA       PIC 99.
   309             20  HOLD-CEN-1-R-CCYY.
   310                 24  HOLD-CEN-1-R-CC   PIC 99.
   311                 24  HOLD-CEN-1-R-YY   PIC 99.
   312             20  FILLER                PIC 9(3).
   313         16  HOLD-CENTURY-1-X.
   314             20  FILLER                PIC X(3)  VALUE SPACES.
   315             20  HOLD-CEN-1-X-CCYY.
   316                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   317                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   318             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   319             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   320         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   321             20  HOLD-CEN-1-R-X-MO     PIC XX.
   322             20  HOLD-CEN-1-R-X-DA     PIC XX.
   323             20  HOLD-CEN-1-R-X-CCYY.
   324                 24  HOLD-CEN-1-R-X-CC PIC XX.
   325                 24  HOLD-CEN-1-R-X-YY PIC XX.
   326             20  FILLER                PIC XXX.
   327         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   328         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   329         16  DC-JULIAN-DATE-1          PIC 9(07).
   330         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   331             20  DC-JULIAN-1-CCYY.
   332                 24  DC-JULIAN-1-CC    PIC 99.
   333                 24  DC-JULIAN-1-YR    PIC 99.
   334             20  DC-JULIAN-DA-1        PIC 999.
   335         16  DC-JULIAN-DATE-2          PIC 9(07).
   336         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   337             20  DC-JULIAN-2-CCYY.
   338                 24  DC-JULIAN-2-CC    PIC 99.
   339                 24  DC-JULIAN-2-YR    PIC 99.
   340             20  DC-JULIAN-DA-2        PIC 999.
   341         16  DC-GREG-DATE-A-EDIT.
   342             20  DC-EDITA-MONTH        PIC 99.
   343             20  SLASHA-1              PIC X VALUE '/'.
   344             20  DC-EDITA-DAY          PIC 99.
   345             20  SLASHA-2              PIC X VALUE '/'.
   346             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL856.cbl
   347                 24  DC-EDITA-CENT     PIC 99.
   348                 24  DC-EDITA-YEAR     PIC 99.
   349         16  DC-GREG-DATE-B-EDIT.
   350             20  DC-EDITB-MONTH        PIC 99.
   351             20  SLASHB-1              PIC X VALUE '/'.
   352             20  DC-EDITB-DAY          PIC 99.
   353             20  SLASHB-2              PIC X VALUE '/'.
   354             20  DC-EDITB-CCYY.
   355                 24  DC-EDITB-CENT     PIC 99.
   356                 24  DC-EDITB-YEAR     PIC 99.
   357         16  DC-GREG-DATE-CYMD         PIC 9(08).
   358         16  DC-GREG-DATE-CYMD-R REDEFINES
   359                              DC-GREG-DATE-CYMD.
   360             20  DC-CYMD-CEN           PIC 99.
   361             20  DC-CYMD-YEAR          PIC 99.
   362             20  DC-CYMD-MONTH         PIC 99.
   363             20  DC-CYMD-DAY           PIC 99.
   364         16  DC-GREG-DATE-MDCY         PIC 9(08).
   365         16  DC-GREG-DATE-MDCY-R REDEFINES
   366                              DC-GREG-DATE-MDCY.
   367             20  DC-MDCY-MONTH         PIC 99.
   368             20  DC-MDCY-DAY           PIC 99.
   369             20  DC-MDCY-CEN           PIC 99.
   370             20  DC-MDCY-YEAR          PIC 99.
   371    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   372        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   373    12  DC-EL310-DATE                  PIC X(21).
   374    12  FILLER                         PIC X(28).
   375
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL856.cbl
   377*                            COPY ELCLOGOF.
   378******************************************************************
   379*                                                                *
   380*                                                                *
   381*                            ELCLOGOF.                           *
   382*                            VMOD=2.001                          *
   383*                                                                *
   384*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   385*                                                                *
   386******************************************************************
   387 01  CLASIC-LOGOFF.
   388     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   389     12  LOGOFF-TEXT.
   390         16  FILLER          PIC X(5)    VALUE SPACES.
   391         16  LOGOFF-MSG.
   392             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   393             20  FILLER      PIC X       VALUE SPACES.
   394             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   395         16  FILLER          PIC X(80)
   396           VALUE '* YOU ARE NOW LOGGED OFF'.
   397         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   398         16  FILLER          PIC X       VALUE QUOTE.
   399         16  LOGOFF-SYS-MSG  PIC X(17)
   400           VALUE 'S CLAS-IC SYSTEM '.
   401     12  TEXT-MESSAGES.
   402         16  UNACCESS-MSG    PIC X(29)
   403             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   404         16  PGMIDERR-MSG    PIC X(17)
   405             VALUE 'PROGRAM NOT FOUND'.
   406
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL856.cbl
   408*                            COPY ELCATTR.
   409******************************************************************
   410*                                                                *
   411*                            ELCATTR.                            *
   412*                            VMOD=2.001                          *
   413*                                                                *
   414*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   415*                                                                *
   416*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   417*                                                                *
   418*                   POS 1   P=PROTECTED                          *
   419*                           U=UNPROTECTED                        *
   420*                           S=ASKIP                              *
   421*                   POS 2   A=ALPHA/NUMERIC                      *
   422*                           N=NUMERIC                            *
   423*                   POS 3   N=NORMAL                             *
   424*                           B=BRIGHT                             *
   425*                           D=DARK                               *
   426*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   427*                           OF=MODIFIED DATA TAG OFF             *
   428*                                                                *
   429*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   430******************************************************************
   431 01  ATTRIBUTE-LIST.
   432     12  AL-PABOF            PIC X       VALUE 'Y'.
   433     12  AL-PABON            PIC X       VALUE 'Z'.
   434     12  AL-PADOF            PIC X       VALUE '%'.
   435     12  AL-PADON            PIC X       VALUE '_'.
   436     12  AL-PANOF            PIC X       VALUE '-'.
   437     12  AL-PANON            PIC X       VALUE '/'.
   438     12  AL-SABOF            PIC X       VALUE '8'.
   439     12  AL-SABON            PIC X       VALUE '9'.
   440     12  AL-SADOF            PIC X       VALUE '@'.
   441     12  AL-SADON            PIC X       VALUE QUOTE.
   442     12  AL-SANOF            PIC X       VALUE '0'.
   443     12  AL-SANON            PIC X       VALUE '1'.
   444     12  AL-UABOF            PIC X       VALUE 'H'.
   445     12  AL-UABON            PIC X       VALUE 'I'.
   446     12  AL-UADOF            PIC X       VALUE '<'.
   447     12  AL-UADON            PIC X       VALUE '('.
   448     12  AL-UANOF            PIC X       VALUE ' '.
   449     12  AL-UANON            PIC X       VALUE 'A'.
   450     12  AL-UNBOF            PIC X       VALUE 'Q'.
   451     12  AL-UNBON            PIC X       VALUE 'R'.
   452     12  AL-UNDOF            PIC X       VALUE '*'.
   453     12  AL-UNDON            PIC X       VALUE ')'.
   454     12  AL-UNNOF            PIC X       VALUE '&'.
   455     12  AL-UNNON            PIC X       VALUE 'J'.
   456
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL856.cbl
   458*                            COPY ELCEMIB.
   459******************************************************************
   460*                                                                *
   461*                                                                *
   462*                            ELCEMIB.                            *
   463*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   464*                            VMOD=2.005                          *
   465*                                                                *
   466*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   467*                                                                *
   468******************************************************************
   469 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   470     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   471     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   472     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   473     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   474     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   475     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   476     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   477     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   478     12  EMI-SWITCH1             PIC X        VALUE '1'.
   479         88  EMI-NO-ERRORS                    VALUE '1'.
   480         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   481         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   482     12  EMI-SWITCH2             PIC X        VALUE '1'.
   483         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   484     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   485         88  EMI-AREA1-EMPTY                  VALUE '1'.
   486         88  EMI-AREA1-FULL                   VALUE '2'.
   487     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   488         88  EMI-AREA2-EMPTY                  VALUE '1'.
   489         88  EMI-AREA2-FULL                   VALUE '2'.
   490     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   491         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   492         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   493         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   494         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   495         88  EMI-BYPASS-FATALS                VALUE 'X'.
   496     12  EMI-ERROR-LINES.
   497         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   498         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   499         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   500         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   501             20  EMI-ERR-CODES OCCURS 10 TIMES.
   502                 24  EMI-ERR-NUM         PIC X(4).
   503                 24  EMI-FILLER          PIC X.
   504                 24  EMI-SEV             PIC X.
   505                 24  FILLER              PIC X.
   506             20  FILLER                  PIC X(02).
   507     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   508         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   509             20  EMI-ERROR-NUMBER    PIC X(4).
   510             20  EMI-FILL            PIC X.
   511             20  EMI-SEVERITY        PIC X.
   512             20  FILLER              PIC X.
   513             20  EMI-ERROR-TEXT.
   514                 24  EMI-TEXT-VARIABLE   PIC X(10).
   515                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL856.cbl
   516     12  EMI-SEVERITY-SAVE           PIC X.
   517         88  EMI-NOTE                    VALUE 'N'.
   518         88  EMI-WARNING                 VALUE 'W'.
   519         88  EMI-FORCABLE                VALUE 'F'.
   520         88  EMI-FATAL                   VALUE 'X'.
   521     12  EMI-MESSAGE-FLAG            PIC X.
   522         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   523         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   524     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   525     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   526         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   527         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   528         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   529     12  FILLER                      PIC X(137)  VALUE SPACES.
   530     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   531     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   532     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   533     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   534
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL856.cbl
   536*                            COPY ELCINTF.
   537******************************************************************
   538*                                                                *
   539*                                                                *
   540*                            ELCINTF.                            *
   541*                            VMOD=2.017                          *
   542*                                                                *
   543*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   544*                                                                *
   545*       LENGTH = 1024                                            *
   546*                                                                *
   547******************************************************************
   548 01  PROGRAM-INTERFACE-BLOCK.
   549     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   550     12  PI-CALLING-PROGRAM              PIC X(8).
   551     12  PI-SAVED-PROGRAM-1              PIC X(8).
   552     12  PI-SAVED-PROGRAM-2              PIC X(8).
   553     12  PI-SAVED-PROGRAM-3              PIC X(8).
   554     12  PI-SAVED-PROGRAM-4              PIC X(8).
   555     12  PI-SAVED-PROGRAM-5              PIC X(8).
   556     12  PI-SAVED-PROGRAM-6              PIC X(8).
   557     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   558     12  PI-COMPANY-ID                   PIC XXX.
   559     12  PI-COMPANY-CD                   PIC X.
   560
   561     12  PI-COMPANY-PASSWORD             PIC X(8).
   562
   563     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   564
   565     12  PI-CONTROL-IN-PROGRESS.
   566         16  PI-CARRIER                  PIC X.
   567         16  PI-GROUPING                 PIC X(6).
   568         16  PI-STATE                    PIC XX.
   569         16  PI-ACCOUNT                  PIC X(10).
   570         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   571                                         PIC X(10).
   572         16  PI-CLAIM-CERT-GRP.
   573             20  PI-CLAIM-NO             PIC X(7).
   574             20  PI-CERT-NO.
   575                 25  PI-CERT-PRIME       PIC X(10).
   576                 25  PI-CERT-SFX         PIC X.
   577             20  PI-CERT-EFF-DT          PIC XX.
   578         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   579             20  PI-PLAN-CODE            PIC X(2).
   580             20  PI-REVISION-NUMBER      PIC X(3).
   581             20  PI-PLAN-EFF-DT          PIC X(2).
   582             20  PI-PLAN-EXP-DT          PIC X(2).
   583             20  FILLER                  PIC X(11).
   584         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   585             20  PI-OE-REFERENCE-1.
   586                 25  PI-OE-REF-1-PRIME   PIC X(18).
   587                 25  PI-OE-REF-1-SUFF    PIC XX.
   588
   589     12  PI-SESSION-IN-PROGRESS          PIC X.
   590         88  CLAIM-SESSION                   VALUE '1'.
   591         88  CREDIT-SESSION                  VALUE '2'.
   592         88  WARRANTY-SESSION                VALUE '3'.
   593         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL856.cbl
   594         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   595
   596
   597*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   598
   599     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   600     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   601
   602     12  PI-CREDIT-USER                  PIC X.
   603         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   604         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   605
   606     12  PI-CLAIM-USER                   PIC X.
   607         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   608         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   609
   610     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   611         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   612         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   613         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   614         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   615         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   616
   617     12  PI-PROCESSOR-ID                 PIC X(4).
   618
   619     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   620
   621     12  PI-MEMBER-CAPTION               PIC X(10).
   622
   623     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   624         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   625
   626     12  PI-LIFE-OVERRIDE-L1             PIC X.
   627     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   628     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   629     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   630
   631     12  PI-AH-OVERRIDE-L1               PIC X.
   632     12  PI-AH-OVERRIDE-L2               PIC XX.
   633     12  PI-AH-OVERRIDE-L6               PIC X(6).
   634     12  PI-AH-OVERRIDE-L12              PIC X(12).
   635
   636     12  PI-NEW-SYSTEM                   PIC X(2).
   637
   638     12  PI-PRIMARY-CERT-NO              PIC X(11).
   639     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   640         88  PI-USES-PAID-TO                 VALUE '1'.
   641     12  PI-CRDTCRD-SYSTEM.
   642         16  PI-CRDTCRD-USER             PIC X.
   643             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   644             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   645         16  PI-CC-MONTH-END-DT          PIC XX.
   646     12  PI-PROCESSOR-PRINTER            PIC X(4).
   647
   648     12  PI-OE-REFERENCE-2.
   649         16  PI-OE-REF-2-PRIME           PIC X(10).
   650         16  PI-OE-REF-2-SUFF            PIC X.
   651
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL856.cbl
   652     12  PI-REM-TRM-CALC-OPTION          PIC X.
   653
   654     12  PI-LANGUAGE-TYPE                PIC X.
   655             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   656             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   657             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   658
   659     12  PI-POLICY-LINKAGE-IND           PIC X.
   660         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   661         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   662                                                   LOW-VALUES.
   663
   664     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   665     12  PI-CLAIM-PW-SESSION             PIC X(1).
   666         88  PI-CLAIM-CREDIT                 VALUE '1'.
   667         88  PI-CLAIM-CONVEN                 VALUE '2'.
   668     12  FILLER                          PIC X(4).
   669
   670     12  PI-SYSTEM-LEVEL                 PIC X(145).
   671
   672     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   673         PI-SYSTEM-LEVEL.
   674
   675         16  PI-ENTRY-CODES.
   676             20  PI-ENTRY-CD-1           PIC X.
   677             20  PI-ENTRY-CD-2           PIC X.
   678
   679         16  PI-RETURN-CODES.
   680             20  PI-RETURN-CD-1          PIC X.
   681             20  PI-RETURN-CD-2          PIC X.
   682
   683         16  PI-UPDATE-STATUS-SAVE.
   684             20  PI-UPDATE-BY            PIC X(4).
   685             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   686
   687         16  PI-LOWER-CASE-LETTERS       PIC X.
   688             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   689
   690*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   691*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   692*            88  CARRIER-CLM-CNTL            VALUE '2'.
   693
   694         16  PI-CERT-ACCESS-CONTROL      PIC X.
   695             88  ST-ACCNT-CNTL               VALUE ' '.
   696             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   697             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   698             88  ACCNT-CNTL                  VALUE '3'.
   699             88  CARR-ACCNT-CNTL             VALUE '4'.
   700
   701         16  PI-PROCESSOR-CAP-LIST.
   702             20  PI-SYSTEM-CONTROLS.
   703                24 PI-SYSTEM-DISPLAY     PIC X.
   704                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   705                24 PI-SYSTEM-MODIFY      PIC X.
   706                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   707             20  FILLER                  PIC XX.
   708             20  PI-DISPLAY-CAP          PIC X.
   709                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL856.cbl
   710             20  PI-MODIFY-CAP           PIC X.
   711                 88  MODIFY-CAP              VALUE 'Y'.
   712             20  PI-MSG-AT-LOGON-CAP     PIC X.
   713                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   714             20  PI-FORCE-CAP            PIC X.
   715                 88  FORCE-CAP               VALUE 'Y'.
   716
   717         16  PI-PROGRAM-CONTROLS.
   718             20  PI-PGM-PRINT-OPT        PIC X.
   719             20  PI-PGM-FORMAT-OPT       PIC X.
   720             20  PI-PGM-PROCESS-OPT      PIC X.
   721             20  PI-PGM-TOTALS-OPT       PIC X.
   722
   723         16  PI-HELP-INTERFACE.
   724             20  PI-LAST-ERROR-NO        PIC X(4).
   725             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   726
   727         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   728             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   729
   730         16  PI-CR-CONTROL-IN-PROGRESS.
   731             20  PI-CR-CARRIER           PIC X.
   732             20  PI-CR-GROUPING          PIC X(6).
   733             20  PI-CR-STATE             PIC XX.
   734             20  PI-CR-ACCOUNT           PIC X(10).
   735             20  PI-CR-FIN-RESP          PIC X(10).
   736             20  PI-CR-TYPE              PIC X.
   737
   738         16  PI-CR-BATCH-NUMBER          PIC X(6).
   739
   740         16  PI-CR-MONTH-END-DT          PIC XX.
   741
   742         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   743             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   744             88  PI-ZERO-CARRIER             VALUE '1'.
   745             88  PI-ZERO-GROUPING            VALUE '2'.
   746             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   747
   748         16  PI-CARRIER-SECURITY         PIC X.
   749             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   750
   751         16  PI-ACCOUNT-SECURITY         PIC X(10).
   752             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   753             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   754
   755         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   756             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   757                                         INDEXED BY PI-ACCESS-NDX
   758                                         PIC X.
   759
   760         16  PI-GA-BILLING-CONTROL       PIC X.
   761             88  PI-GA-BILLING               VALUE '1'.
   762
   763         16  PI-MAIL-PROCESSING          PIC X.
   764             88  PI-MAIL-YES                 VALUE 'Y'.
   765
   766         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   767
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL856.cbl
   768         16  PI-AR-SYSTEM.
   769             20  PI-AR-PROCESSING-CNTL   PIC X.
   770                 88  PI-AR-PROCESSING        VALUE 'Y'.
   771             20  PI-AR-SUMMARY-CODE      PIC X(6).
   772             20  PI-AR-MONTH-END-DT      PIC XX.
   773
   774         16  PI-MP-SYSTEM.
   775             20  PI-MORTGAGE-USER            PIC X.
   776                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   777                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   778             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   779                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   780                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   781                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   782                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   783                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   784             20  PI-MP-MONTH-END-DT          PIC XX.
   785             20  PI-MP-REFERENCE-NO.
   786                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   787                 24  PI-MP-REFERENCE-SFX     PIC XX.
   788
   789         16  PI-LABEL-CONTROL            PIC X(01).
   790             88  PI-CREATE-LABELS                    VALUE 'Y'.
   791             88  PI-BYPASS-LABELS                    VALUE 'N'.
   792
   793         16  PI-BILL-GROUPING-CODE       PIC X(01).
   794             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   795
   796         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   797             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   798             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   799
   800         16  FILLER                      PIC X(14).
   801
   802     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   803******************************************************************
   804     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   805
   806         16  PI-SUMMARY-CODE         PIC X(6).
   807         16  PI-1ST-SUM-KEY          PIC X(34).
   808         16  PI-LST-SUM-KEY          PIC X(34).
   809
   810         16  PI-TOP-OF-FILE-SW       PIC X.
   811             88  PI-TOP-OF-FILE            VALUE 'Y'.
   812
   813         16  PI-END-OF-FILE-SW       PIC X.
   814             88  PI-END-OF-FILE            VALUE 'Y'.
   815         16  FILLER                  PIC X(564).
   816
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL856.cbl
   818*                            COPY ELCJPFX.
   819******************************************************************
   820*                                                                *
   821*                                                                *
   822*                            ELCJPFX.                            *
   823*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   824*                            VMOD=2.002                          *
   825*                                                                *
   826*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   827*                                                                *
   828*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   829*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   830*        ELCNTL - CONTROL FILE                                   *
   831*        ELMSTR - CLAIM MASTERS                                  *
   832*        ELTRLR - ACTIVITY TRAILERS                              *
   833*        ELCHKQ - CHECK QUE                                      *
   834******************************************************************
   835 01  JOURNAL-RECORD.
   836     12  JP-USER-ID                  PIC X(4).
   837     12  JP-FILE-ID                  PIC X(8).
   838     12  JP-PROGRAM-ID               PIC X(8).
   839     12  JP-RECORD-TYPE              PIC X.
   840         88 JP-ADD              VALUE 'A'.
   841         88 JP-BEFORE-CHANGE    VALUE 'B'.
   842         88 JP-AFTER-CHANGE     VALUE 'C'.
   843         88 JP-DELETE           VALUE 'D'.
   844         88 JP-GENERIC-DELETE   VALUE 'G'.
   845         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   846         88 JP-KEY-CHG-ADD      VALUE 'N'.
   847     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   848     12  JP-RECORD-AREA
   849
   850
   851                             PIC X(223).
   852
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL856.cbl
   854*                            COPY ELCAID.
   855******************************************************************
   856*                                                                *
   857*                            ELCAID.                             *
   858*                            VMOD=2.001                          *
   859*                                                                *
   860*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   861*                                                                *
   862*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   863*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   864******************************************************************
   865
   866 01  DFHAID.
   867   02  DFHNULL   PIC  X  VALUE  ' '.
   868   02  DFHENTER  PIC  X  VALUE  QUOTE.
   869   02  DFHCLEAR  PIC  X  VALUE  '_'.
   870   02  DFHPEN    PIC  X  VALUE  '='.
   871   02  DFHOPID   PIC  X  VALUE  'W'.
   872   02  DFHPA1    PIC  X  VALUE  '%'.
   873   02  DFHPA2    PIC  X  VALUE  '>'.
   874   02  DFHPA3    PIC  X  VALUE  ','.
   875   02  DFHPF1    PIC  X  VALUE  '1'.
   876   02  DFHPF2    PIC  X  VALUE  '2'.
   877   02  DFHPF3    PIC  X  VALUE  '3'.
   878   02  DFHPF4    PIC  X  VALUE  '4'.
   879   02  DFHPF5    PIC  X  VALUE  '5'.
   880   02  DFHPF6    PIC  X  VALUE  '6'.
   881   02  DFHPF7    PIC  X  VALUE  '7'.
   882   02  DFHPF8    PIC  X  VALUE  '8'.
   883   02  DFHPF9    PIC  X  VALUE  '9'.
   884   02  DFHPF10   PIC  X  VALUE  ':'.
   885   02  DFHPF11   PIC  X  VALUE  '#'.
   886   02  DFHPF12   PIC  X  VALUE  '@'.
   887   02  DFHPF13   PIC  X  VALUE  'A'.
   888   02  DFHPF14   PIC  X  VALUE  'B'.
   889   02  DFHPF15   PIC  X  VALUE  'C'.
   890   02  DFHPF16   PIC  X  VALUE  'D'.
   891   02  DFHPF17   PIC  X  VALUE  'E'.
   892   02  DFHPF18   PIC  X  VALUE  'F'.
   893   02  DFHPF19   PIC  X  VALUE  'G'.
   894   02  DFHPF20   PIC  X  VALUE  'H'.
   895   02  DFHPF21   PIC  X  VALUE  'I'.
   896*00039    02  DFHPF22   PIC  X  VALUE  ''.
   897   02  DFHPF22   PIC  X  VALUE  '['.
   898   02  DFHPF23   PIC  X  VALUE  '.'.
   899   02  DFHPF24   PIC  X  VALUE  '<'.
   900   02  DFHMSRE   PIC  X  VALUE  'X'.
   901   02  DFHSTRF   PIC  X  VALUE  'h'.
   902   02  DFHTRIG   PIC  X  VALUE  '"'.
   903 01  FILLER    REDEFINES DFHAID.
   904     12  FILLER              PIC X(8).
   905     12  PF-VALUES           PIC X       OCCURS 2.
   906
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL856.cbl
   908*                            COPY EL856S.
   909 01  EL856AI.
   910     05  FILLER            PIC  X(0012).
   911*    -------------------------------
   912     05  DATEL PIC S9(0004) COMP.
   913     05  DATEF PIC  X(0001).
   914     05  FILLER REDEFINES DATEF.
   915         10  DATEA PIC  X(0001).
   916     05  DATEI PIC  X(0008).
   917*    -------------------------------
   918     05  TIMEL PIC S9(0004) COMP.
   919     05  TIMEF PIC  X(0001).
   920     05  FILLER REDEFINES TIMEF.
   921         10  TIMEA PIC  X(0001).
   922     05  TIMEI PIC  X(0005).
   923*    -------------------------------
   924     05  SUMCODEL PIC S9(0004) COMP.
   925     05  SUMCODEF PIC  X(0001).
   926     05  FILLER REDEFINES SUMCODEF.
   927         10  SUMCODEA PIC  X(0001).
   928     05  SUMCODEI PIC  X(0006).
   929*    -------------------------------
   930     05  SUMNAMEL PIC S9(0004) COMP.
   931     05  SUMNAMEF PIC  X(0001).
   932     05  FILLER REDEFINES SUMNAMEF.
   933         10  SUMNAMEA PIC  X(0001).
   934     05  SUMNAMEI PIC  X(0030).
   935*    -------------------------------
   936     05  CAR1L PIC S9(0004) COMP.
   937     05  CAR1F PIC  X(0001).
   938     05  FILLER REDEFINES CAR1F.
   939         10  CAR1A PIC  X(0001).
   940     05  CAR1I PIC  X(0001).
   941*    -------------------------------
   942     05  GRP1L PIC S9(0004) COMP.
   943     05  GRP1F PIC  X(0001).
   944     05  FILLER REDEFINES GRP1F.
   945         10  GRP1A PIC  X(0001).
   946     05  GRP1I PIC  X(0006).
   947*    -------------------------------
   948     05  FINRSP1L PIC S9(0004) COMP.
   949     05  FINRSP1F PIC  X(0001).
   950     05  FILLER REDEFINES FINRSP1F.
   951         10  FINRSP1A PIC  X(0001).
   952     05  FINRSP1I PIC  X(0010).
   953*    -------------------------------
   954     05  AGENT1L PIC S9(0004) COMP.
   955     05  AGENT1F PIC  X(0001).
   956     05  FILLER REDEFINES AGENT1F.
   957         10  AGENT1A PIC  X(0001).
   958     05  AGENT1I PIC  X(0010).
   959*    -------------------------------
   960     05  AGTNAM1L PIC S9(0004) COMP.
   961     05  AGTNAM1F PIC  X(0001).
   962     05  FILLER REDEFINES AGTNAM1F.
   963         10  AGTNAM1A PIC  X(0001).
   964     05  AGTNAM1I PIC  X(0030).
   965*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL856.cbl
   966     05  CAR2L PIC S9(0004) COMP.
   967     05  CAR2F PIC  X(0001).
   968     05  FILLER REDEFINES CAR2F.
   969         10  CAR2A PIC  X(0001).
   970     05  CAR2I PIC  X(0001).
   971*    -------------------------------
   972     05  GRP2L PIC S9(0004) COMP.
   973     05  GRP2F PIC  X(0001).
   974     05  FILLER REDEFINES GRP2F.
   975         10  GRP2A PIC  X(0001).
   976     05  GRP2I PIC  X(0006).
   977*    -------------------------------
   978     05  FINRSP2L PIC S9(0004) COMP.
   979     05  FINRSP2F PIC  X(0001).
   980     05  FILLER REDEFINES FINRSP2F.
   981         10  FINRSP2A PIC  X(0001).
   982     05  FINRSP2I PIC  X(0010).
   983*    -------------------------------
   984     05  AGENT2L PIC S9(0004) COMP.
   985     05  AGENT2F PIC  X(0001).
   986     05  FILLER REDEFINES AGENT2F.
   987         10  AGENT2A PIC  X(0001).
   988     05  AGENT2I PIC  X(0010).
   989*    -------------------------------
   990     05  AGTNAM2L PIC S9(0004) COMP.
   991     05  AGTNAM2F PIC  X(0001).
   992     05  FILLER REDEFINES AGTNAM2F.
   993         10  AGTNAM2A PIC  X(0001).
   994     05  AGTNAM2I PIC  X(0030).
   995*    -------------------------------
   996     05  CAR3L PIC S9(0004) COMP.
   997     05  CAR3F PIC  X(0001).
   998     05  FILLER REDEFINES CAR3F.
   999         10  CAR3A PIC  X(0001).
  1000     05  CAR3I PIC  X(0001).
  1001*    -------------------------------
  1002     05  GRP3L PIC S9(0004) COMP.
  1003     05  GRP3F PIC  X(0001).
  1004     05  FILLER REDEFINES GRP3F.
  1005         10  GRP3A PIC  X(0001).
  1006     05  GRP3I PIC  X(0006).
  1007*    -------------------------------
  1008     05  FINRSP3L PIC S9(0004) COMP.
  1009     05  FINRSP3F PIC  X(0001).
  1010     05  FILLER REDEFINES FINRSP3F.
  1011         10  FINRSP3A PIC  X(0001).
  1012     05  FINRSP3I PIC  X(0010).
  1013*    -------------------------------
  1014     05  AGENT3L PIC S9(0004) COMP.
  1015     05  AGENT3F PIC  X(0001).
  1016     05  FILLER REDEFINES AGENT3F.
  1017         10  AGENT3A PIC  X(0001).
  1018     05  AGENT3I PIC  X(0010).
  1019*    -------------------------------
  1020     05  AGTNAM3L PIC S9(0004) COMP.
  1021     05  AGTNAM3F PIC  X(0001).
  1022     05  FILLER REDEFINES AGTNAM3F.
  1023         10  AGTNAM3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL856.cbl
  1024     05  AGTNAM3I PIC  X(0030).
  1025*    -------------------------------
  1026     05  CAR4L PIC S9(0004) COMP.
  1027     05  CAR4F PIC  X(0001).
  1028     05  FILLER REDEFINES CAR4F.
  1029         10  CAR4A PIC  X(0001).
  1030     05  CAR4I PIC  X(0001).
  1031*    -------------------------------
  1032     05  GRP4L PIC S9(0004) COMP.
  1033     05  GRP4F PIC  X(0001).
  1034     05  FILLER REDEFINES GRP4F.
  1035         10  GRP4A PIC  X(0001).
  1036     05  GRP4I PIC  X(0006).
  1037*    -------------------------------
  1038     05  FINRSP4L PIC S9(0004) COMP.
  1039     05  FINRSP4F PIC  X(0001).
  1040     05  FILLER REDEFINES FINRSP4F.
  1041         10  FINRSP4A PIC  X(0001).
  1042     05  FINRSP4I PIC  X(0010).
  1043*    -------------------------------
  1044     05  AGENT4L PIC S9(0004) COMP.
  1045     05  AGENT4F PIC  X(0001).
  1046     05  FILLER REDEFINES AGENT4F.
  1047         10  AGENT4A PIC  X(0001).
  1048     05  AGENT4I PIC  X(0010).
  1049*    -------------------------------
  1050     05  AGTNAM4L PIC S9(0004) COMP.
  1051     05  AGTNAM4F PIC  X(0001).
  1052     05  FILLER REDEFINES AGTNAM4F.
  1053         10  AGTNAM4A PIC  X(0001).
  1054     05  AGTNAM4I PIC  X(0030).
  1055*    -------------------------------
  1056     05  CAR5L PIC S9(0004) COMP.
  1057     05  CAR5F PIC  X(0001).
  1058     05  FILLER REDEFINES CAR5F.
  1059         10  CAR5A PIC  X(0001).
  1060     05  CAR5I PIC  X(0001).
  1061*    -------------------------------
  1062     05  GRP5L PIC S9(0004) COMP.
  1063     05  GRP5F PIC  X(0001).
  1064     05  FILLER REDEFINES GRP5F.
  1065         10  GRP5A PIC  X(0001).
  1066     05  GRP5I PIC  X(0006).
  1067*    -------------------------------
  1068     05  FINRSP5L PIC S9(0004) COMP.
  1069     05  FINRSP5F PIC  X(0001).
  1070     05  FILLER REDEFINES FINRSP5F.
  1071         10  FINRSP5A PIC  X(0001).
  1072     05  FINRSP5I PIC  X(0010).
  1073*    -------------------------------
  1074     05  AGENT5L PIC S9(0004) COMP.
  1075     05  AGENT5F PIC  X(0001).
  1076     05  FILLER REDEFINES AGENT5F.
  1077         10  AGENT5A PIC  X(0001).
  1078     05  AGENT5I PIC  X(0010).
  1079*    -------------------------------
  1080     05  AGTNAM5L PIC S9(0004) COMP.
  1081     05  AGTNAM5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL856.cbl
  1082     05  FILLER REDEFINES AGTNAM5F.
  1083         10  AGTNAM5A PIC  X(0001).
  1084     05  AGTNAM5I PIC  X(0030).
  1085*    -------------------------------
  1086     05  CAR6L PIC S9(0004) COMP.
  1087     05  CAR6F PIC  X(0001).
  1088     05  FILLER REDEFINES CAR6F.
  1089         10  CAR6A PIC  X(0001).
  1090     05  CAR6I PIC  X(0001).
  1091*    -------------------------------
  1092     05  GRP6L PIC S9(0004) COMP.
  1093     05  GRP6F PIC  X(0001).
  1094     05  FILLER REDEFINES GRP6F.
  1095         10  GRP6A PIC  X(0001).
  1096     05  GRP6I PIC  X(0006).
  1097*    -------------------------------
  1098     05  FINRSP6L PIC S9(0004) COMP.
  1099     05  FINRSP6F PIC  X(0001).
  1100     05  FILLER REDEFINES FINRSP6F.
  1101         10  FINRSP6A PIC  X(0001).
  1102     05  FINRSP6I PIC  X(0010).
  1103*    -------------------------------
  1104     05  AGENT6L PIC S9(0004) COMP.
  1105     05  AGENT6F PIC  X(0001).
  1106     05  FILLER REDEFINES AGENT6F.
  1107         10  AGENT6A PIC  X(0001).
  1108     05  AGENT6I PIC  X(0010).
  1109*    -------------------------------
  1110     05  AGTNAM6L PIC S9(0004) COMP.
  1111     05  AGTNAM6F PIC  X(0001).
  1112     05  FILLER REDEFINES AGTNAM6F.
  1113         10  AGTNAM6A PIC  X(0001).
  1114     05  AGTNAM6I PIC  X(0030).
  1115*    -------------------------------
  1116     05  CAR7L PIC S9(0004) COMP.
  1117     05  CAR7F PIC  X(0001).
  1118     05  FILLER REDEFINES CAR7F.
  1119         10  CAR7A PIC  X(0001).
  1120     05  CAR7I PIC  X(0001).
  1121*    -------------------------------
  1122     05  GRP7L PIC S9(0004) COMP.
  1123     05  GRP7F PIC  X(0001).
  1124     05  FILLER REDEFINES GRP7F.
  1125         10  GRP7A PIC  X(0001).
  1126     05  GRP7I PIC  X(0006).
  1127*    -------------------------------
  1128     05  FINRSP7L PIC S9(0004) COMP.
  1129     05  FINRSP7F PIC  X(0001).
  1130     05  FILLER REDEFINES FINRSP7F.
  1131         10  FINRSP7A PIC  X(0001).
  1132     05  FINRSP7I PIC  X(0010).
  1133*    -------------------------------
  1134     05  AGENT7L PIC S9(0004) COMP.
  1135     05  AGENT7F PIC  X(0001).
  1136     05  FILLER REDEFINES AGENT7F.
  1137         10  AGENT7A PIC  X(0001).
  1138     05  AGENT7I PIC  X(0010).
  1139*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL856.cbl
  1140     05  AGTNAM7L PIC S9(0004) COMP.
  1141     05  AGTNAM7F PIC  X(0001).
  1142     05  FILLER REDEFINES AGTNAM7F.
  1143         10  AGTNAM7A PIC  X(0001).
  1144     05  AGTNAM7I PIC  X(0030).
  1145*    -------------------------------
  1146     05  CAR8L PIC S9(0004) COMP.
  1147     05  CAR8F PIC  X(0001).
  1148     05  FILLER REDEFINES CAR8F.
  1149         10  CAR8A PIC  X(0001).
  1150     05  CAR8I PIC  X(0001).
  1151*    -------------------------------
  1152     05  GRP8L PIC S9(0004) COMP.
  1153     05  GRP8F PIC  X(0001).
  1154     05  FILLER REDEFINES GRP8F.
  1155         10  GRP8A PIC  X(0001).
  1156     05  GRP8I PIC  X(0006).
  1157*    -------------------------------
  1158     05  FINRSP8L PIC S9(0004) COMP.
  1159     05  FINRSP8F PIC  X(0001).
  1160     05  FILLER REDEFINES FINRSP8F.
  1161         10  FINRSP8A PIC  X(0001).
  1162     05  FINRSP8I PIC  X(0010).
  1163*    -------------------------------
  1164     05  AGENT8L PIC S9(0004) COMP.
  1165     05  AGENT8F PIC  X(0001).
  1166     05  FILLER REDEFINES AGENT8F.
  1167         10  AGENT8A PIC  X(0001).
  1168     05  AGENT8I PIC  X(0010).
  1169*    -------------------------------
  1170     05  AGTNAM8L PIC S9(0004) COMP.
  1171     05  AGTNAM8F PIC  X(0001).
  1172     05  FILLER REDEFINES AGTNAM8F.
  1173         10  AGTNAM8A PIC  X(0001).
  1174     05  AGTNAM8I PIC  X(0030).
  1175*    -------------------------------
  1176     05  CAR9L PIC S9(0004) COMP.
  1177     05  CAR9F PIC  X(0001).
  1178     05  FILLER REDEFINES CAR9F.
  1179         10  CAR9A PIC  X(0001).
  1180     05  CAR9I PIC  X(0001).
  1181*    -------------------------------
  1182     05  GRP9L PIC S9(0004) COMP.
  1183     05  GRP9F PIC  X(0001).
  1184     05  FILLER REDEFINES GRP9F.
  1185         10  GRP9A PIC  X(0001).
  1186     05  GRP9I PIC  X(0006).
  1187*    -------------------------------
  1188     05  FINRSP9L PIC S9(0004) COMP.
  1189     05  FINRSP9F PIC  X(0001).
  1190     05  FILLER REDEFINES FINRSP9F.
  1191         10  FINRSP9A PIC  X(0001).
  1192     05  FINRSP9I PIC  X(0010).
  1193*    -------------------------------
  1194     05  AGENT9L PIC S9(0004) COMP.
  1195     05  AGENT9F PIC  X(0001).
  1196     05  FILLER REDEFINES AGENT9F.
  1197         10  AGENT9A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL856.cbl
  1198     05  AGENT9I PIC  X(0010).
  1199*    -------------------------------
  1200     05  AGTNAM9L PIC S9(0004) COMP.
  1201     05  AGTNAM9F PIC  X(0001).
  1202     05  FILLER REDEFINES AGTNAM9F.
  1203         10  AGTNAM9A PIC  X(0001).
  1204     05  AGTNAM9I PIC  X(0030).
  1205*    -------------------------------
  1206     05  CARAL PIC S9(0004) COMP.
  1207     05  CARAF PIC  X(0001).
  1208     05  FILLER REDEFINES CARAF.
  1209         10  CARAA PIC  X(0001).
  1210     05  CARAI PIC  X(0001).
  1211*    -------------------------------
  1212     05  GRPAL PIC S9(0004) COMP.
  1213     05  GRPAF PIC  X(0001).
  1214     05  FILLER REDEFINES GRPAF.
  1215         10  GRPAA PIC  X(0001).
  1216     05  GRPAI PIC  X(0006).
  1217*    -------------------------------
  1218     05  FINRSPAL PIC S9(0004) COMP.
  1219     05  FINRSPAF PIC  X(0001).
  1220     05  FILLER REDEFINES FINRSPAF.
  1221         10  FINRSPAA PIC  X(0001).
  1222     05  FINRSPAI PIC  X(0010).
  1223*    -------------------------------
  1224     05  AGENTAL PIC S9(0004) COMP.
  1225     05  AGENTAF PIC  X(0001).
  1226     05  FILLER REDEFINES AGENTAF.
  1227         10  AGENTAA PIC  X(0001).
  1228     05  AGENTAI PIC  X(0010).
  1229*    -------------------------------
  1230     05  AGTNAMAL PIC S9(0004) COMP.
  1231     05  AGTNAMAF PIC  X(0001).
  1232     05  FILLER REDEFINES AGTNAMAF.
  1233         10  AGTNAMAA PIC  X(0001).
  1234     05  AGTNAMAI PIC  X(0030).
  1235*    -------------------------------
  1236     05  CARBL PIC S9(0004) COMP.
  1237     05  CARBF PIC  X(0001).
  1238     05  FILLER REDEFINES CARBF.
  1239         10  CARBA PIC  X(0001).
  1240     05  CARBI PIC  X(0001).
  1241*    -------------------------------
  1242     05  GRPBL PIC S9(0004) COMP.
  1243     05  GRPBF PIC  X(0001).
  1244     05  FILLER REDEFINES GRPBF.
  1245         10  GRPBA PIC  X(0001).
  1246     05  GRPBI PIC  X(0006).
  1247*    -------------------------------
  1248     05  FINRSPBL PIC S9(0004) COMP.
  1249     05  FINRSPBF PIC  X(0001).
  1250     05  FILLER REDEFINES FINRSPBF.
  1251         10  FINRSPBA PIC  X(0001).
  1252     05  FINRSPBI PIC  X(0010).
  1253*    -------------------------------
  1254     05  AGENTBL PIC S9(0004) COMP.
  1255     05  AGENTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL856.cbl
  1256     05  FILLER REDEFINES AGENTBF.
  1257         10  AGENTBA PIC  X(0001).
  1258     05  AGENTBI PIC  X(0010).
  1259*    -------------------------------
  1260     05  AGTNAMBL PIC S9(0004) COMP.
  1261     05  AGTNAMBF PIC  X(0001).
  1262     05  FILLER REDEFINES AGTNAMBF.
  1263         10  AGTNAMBA PIC  X(0001).
  1264     05  AGTNAMBI PIC  X(0030).
  1265*    -------------------------------
  1266     05  CARCL PIC S9(0004) COMP.
  1267     05  CARCF PIC  X(0001).
  1268     05  FILLER REDEFINES CARCF.
  1269         10  CARCA PIC  X(0001).
  1270     05  CARCI PIC  X(0001).
  1271*    -------------------------------
  1272     05  GRPCL PIC S9(0004) COMP.
  1273     05  GRPCF PIC  X(0001).
  1274     05  FILLER REDEFINES GRPCF.
  1275         10  GRPCA PIC  X(0001).
  1276     05  GRPCI PIC  X(0006).
  1277*    -------------------------------
  1278     05  FINRSPCL PIC S9(0004) COMP.
  1279     05  FINRSPCF PIC  X(0001).
  1280     05  FILLER REDEFINES FINRSPCF.
  1281         10  FINRSPCA PIC  X(0001).
  1282     05  FINRSPCI PIC  X(0010).
  1283*    -------------------------------
  1284     05  AGENTCL PIC S9(0004) COMP.
  1285     05  AGENTCF PIC  X(0001).
  1286     05  FILLER REDEFINES AGENTCF.
  1287         10  AGENTCA PIC  X(0001).
  1288     05  AGENTCI PIC  X(0010).
  1289*    -------------------------------
  1290     05  AGTNAMCL PIC S9(0004) COMP.
  1291     05  AGTNAMCF PIC  X(0001).
  1292     05  FILLER REDEFINES AGTNAMCF.
  1293         10  AGTNAMCA PIC  X(0001).
  1294     05  AGTNAMCI PIC  X(0030).
  1295*    -------------------------------
  1296     05  CARDL PIC S9(0004) COMP.
  1297     05  CARDF PIC  X(0001).
  1298     05  FILLER REDEFINES CARDF.
  1299         10  CARDA PIC  X(0001).
  1300     05  CARDI PIC  X(0001).
  1301*    -------------------------------
  1302     05  GRPDL PIC S9(0004) COMP.
  1303     05  GRPDF PIC  X(0001).
  1304     05  FILLER REDEFINES GRPDF.
  1305         10  GRPDA PIC  X(0001).
  1306     05  GRPDI PIC  X(0006).
  1307*    -------------------------------
  1308     05  FINRSPDL PIC S9(0004) COMP.
  1309     05  FINRSPDF PIC  X(0001).
  1310     05  FILLER REDEFINES FINRSPDF.
  1311         10  FINRSPDA PIC  X(0001).
  1312     05  FINRSPDI PIC  X(0010).
  1313*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL856.cbl
  1314     05  AGENTDL PIC S9(0004) COMP.
  1315     05  AGENTDF PIC  X(0001).
  1316     05  FILLER REDEFINES AGENTDF.
  1317         10  AGENTDA PIC  X(0001).
  1318     05  AGENTDI PIC  X(0010).
  1319*    -------------------------------
  1320     05  AGTNAMDL PIC S9(0004) COMP.
  1321     05  AGTNAMDF PIC  X(0001).
  1322     05  FILLER REDEFINES AGTNAMDF.
  1323         10  AGTNAMDA PIC  X(0001).
  1324     05  AGTNAMDI PIC  X(0030).
  1325*    -------------------------------
  1326     05  CAREL PIC S9(0004) COMP.
  1327     05  CAREF PIC  X(0001).
  1328     05  FILLER REDEFINES CAREF.
  1329         10  CAREA PIC  X(0001).
  1330     05  CAREI PIC  X(0001).
  1331*    -------------------------------
  1332     05  GRPEL PIC S9(0004) COMP.
  1333     05  GRPEF PIC  X(0001).
  1334     05  FILLER REDEFINES GRPEF.
  1335         10  GRPEA PIC  X(0001).
  1336     05  GRPEI PIC  X(0006).
  1337*    -------------------------------
  1338     05  FINRSPEL PIC S9(0004) COMP.
  1339     05  FINRSPEF PIC  X(0001).
  1340     05  FILLER REDEFINES FINRSPEF.
  1341         10  FINRSPEA PIC  X(0001).
  1342     05  FINRSPEI PIC  X(0010).
  1343*    -------------------------------
  1344     05  AGENTEL PIC S9(0004) COMP.
  1345     05  AGENTEF PIC  X(0001).
  1346     05  FILLER REDEFINES AGENTEF.
  1347         10  AGENTEA PIC  X(0001).
  1348     05  AGENTEI PIC  X(0010).
  1349*    -------------------------------
  1350     05  AGTNAMEL PIC S9(0004) COMP.
  1351     05  AGTNAMEF PIC  X(0001).
  1352     05  FILLER REDEFINES AGTNAMEF.
  1353         10  AGTNAMEA PIC  X(0001).
  1354     05  AGTNAMEI PIC  X(0030).
  1355*    -------------------------------
  1356     05  CARFL PIC S9(0004) COMP.
  1357     05  CARFF PIC  X(0001).
  1358     05  FILLER REDEFINES CARFF.
  1359         10  CARFA PIC  X(0001).
  1360     05  CARFI PIC  X(0001).
  1361*    -------------------------------
  1362     05  GRPFL PIC S9(0004) COMP.
  1363     05  GRPFF PIC  X(0001).
  1364     05  FILLER REDEFINES GRPFF.
  1365         10  GRPFA PIC  X(0001).
  1366     05  GRPFI PIC  X(0006).
  1367*    -------------------------------
  1368     05  FINRSPFL PIC S9(0004) COMP.
  1369     05  FINRSPFF PIC  X(0001).
  1370     05  FILLER REDEFINES FINRSPFF.
  1371         10  FINRSPFA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL856.cbl
  1372     05  FINRSPFI PIC  X(0010).
  1373*    -------------------------------
  1374     05  AGENTFL PIC S9(0004) COMP.
  1375     05  AGENTFF PIC  X(0001).
  1376     05  FILLER REDEFINES AGENTFF.
  1377         10  AGENTFA PIC  X(0001).
  1378     05  AGENTFI PIC  X(0010).
  1379*    -------------------------------
  1380     05  AGTNAMFL PIC S9(0004) COMP.
  1381     05  AGTNAMFF PIC  X(0001).
  1382     05  FILLER REDEFINES AGTNAMFF.
  1383         10  AGTNAMFA PIC  X(0001).
  1384     05  AGTNAMFI PIC  X(0030).
  1385*    -------------------------------
  1386     05  ERMESGL PIC S9(0004) COMP.
  1387     05  ERMESGF PIC  X(0001).
  1388     05  FILLER REDEFINES ERMESGF.
  1389         10  ERMESGA PIC  X(0001).
  1390     05  ERMESGI PIC  X(0079).
  1391*    -------------------------------
  1392     05  PFENTERL PIC S9(0004) COMP.
  1393     05  PFENTERF PIC  X(0001).
  1394     05  FILLER REDEFINES PFENTERF.
  1395         10  PFENTERA PIC  X(0001).
  1396     05  PFENTERI PIC  9(2).
  1397 01  EL856AO REDEFINES EL856AI.
  1398     05  FILLER            PIC  X(0012).
  1399*    -------------------------------
  1400     05  FILLER            PIC  X(0003).
  1401     05  DATEO PIC  X(0008).
  1402*    -------------------------------
  1403     05  FILLER            PIC  X(0003).
  1404     05  TIMEO PIC  99.99.
  1405*    -------------------------------
  1406     05  FILLER            PIC  X(0003).
  1407     05  SUMCODEO PIC  X(0006).
  1408*    -------------------------------
  1409     05  FILLER            PIC  X(0003).
  1410     05  SUMNAMEO PIC  X(0030).
  1411*    -------------------------------
  1412     05  FILLER            PIC  X(0003).
  1413     05  CAR1O PIC  X(0001).
  1414*    -------------------------------
  1415     05  FILLER            PIC  X(0003).
  1416     05  GRP1O PIC  X(0006).
  1417*    -------------------------------
  1418     05  FILLER            PIC  X(0003).
  1419     05  FINRSP1O PIC  X(0010).
  1420*    -------------------------------
  1421     05  FILLER            PIC  X(0003).
  1422     05  AGENT1O PIC  X(0010).
  1423*    -------------------------------
  1424     05  FILLER            PIC  X(0003).
  1425     05  AGTNAM1O PIC  X(0030).
  1426*    -------------------------------
  1427     05  FILLER            PIC  X(0003).
  1428     05  CAR2O PIC  X(0001).
  1429*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL856.cbl
  1430     05  FILLER            PIC  X(0003).
  1431     05  GRP2O PIC  X(0006).
  1432*    -------------------------------
  1433     05  FILLER            PIC  X(0003).
  1434     05  FINRSP2O PIC  X(0010).
  1435*    -------------------------------
  1436     05  FILLER            PIC  X(0003).
  1437     05  AGENT2O PIC  X(0010).
  1438*    -------------------------------
  1439     05  FILLER            PIC  X(0003).
  1440     05  AGTNAM2O PIC  X(0030).
  1441*    -------------------------------
  1442     05  FILLER            PIC  X(0003).
  1443     05  CAR3O PIC  X(0001).
  1444*    -------------------------------
  1445     05  FILLER            PIC  X(0003).
  1446     05  GRP3O PIC  X(0006).
  1447*    -------------------------------
  1448     05  FILLER            PIC  X(0003).
  1449     05  FINRSP3O PIC  X(0010).
  1450*    -------------------------------
  1451     05  FILLER            PIC  X(0003).
  1452     05  AGENT3O PIC  X(0010).
  1453*    -------------------------------
  1454     05  FILLER            PIC  X(0003).
  1455     05  AGTNAM3O PIC  X(0030).
  1456*    -------------------------------
  1457     05  FILLER            PIC  X(0003).
  1458     05  CAR4O PIC  X(0001).
  1459*    -------------------------------
  1460     05  FILLER            PIC  X(0003).
  1461     05  GRP4O PIC  X(0006).
  1462*    -------------------------------
  1463     05  FILLER            PIC  X(0003).
  1464     05  FINRSP4O PIC  X(0010).
  1465*    -------------------------------
  1466     05  FILLER            PIC  X(0003).
  1467     05  AGENT4O PIC  X(0010).
  1468*    -------------------------------
  1469     05  FILLER            PIC  X(0003).
  1470     05  AGTNAM4O PIC  X(0030).
  1471*    -------------------------------
  1472     05  FILLER            PIC  X(0003).
  1473     05  CAR5O PIC  X(0001).
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(0003).
  1476     05  GRP5O PIC  X(0006).
  1477*    -------------------------------
  1478     05  FILLER            PIC  X(0003).
  1479     05  FINRSP5O PIC  X(0010).
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(0003).
  1482     05  AGENT5O PIC  X(0010).
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
  1485     05  AGTNAM5O PIC  X(0030).
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL856.cbl
  1488     05  CAR6O PIC  X(0001).
  1489*    -------------------------------
  1490     05  FILLER            PIC  X(0003).
  1491     05  GRP6O PIC  X(0006).
  1492*    -------------------------------
  1493     05  FILLER            PIC  X(0003).
  1494     05  FINRSP6O PIC  X(0010).
  1495*    -------------------------------
  1496     05  FILLER            PIC  X(0003).
  1497     05  AGENT6O PIC  X(0010).
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  AGTNAM6O PIC  X(0030).
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  CAR7O PIC  X(0001).
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  GRP7O PIC  X(0006).
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
  1509     05  FINRSP7O PIC  X(0010).
  1510*    -------------------------------
  1511     05  FILLER            PIC  X(0003).
  1512     05  AGENT7O PIC  X(0010).
  1513*    -------------------------------
  1514     05  FILLER            PIC  X(0003).
  1515     05  AGTNAM7O PIC  X(0030).
  1516*    -------------------------------
  1517     05  FILLER            PIC  X(0003).
  1518     05  CAR8O PIC  X(0001).
  1519*    -------------------------------
  1520     05  FILLER            PIC  X(0003).
  1521     05  GRP8O PIC  X(0006).
  1522*    -------------------------------
  1523     05  FILLER            PIC  X(0003).
  1524     05  FINRSP8O PIC  X(0010).
  1525*    -------------------------------
  1526     05  FILLER            PIC  X(0003).
  1527     05  AGENT8O PIC  X(0010).
  1528*    -------------------------------
  1529     05  FILLER            PIC  X(0003).
  1530     05  AGTNAM8O PIC  X(0030).
  1531*    -------------------------------
  1532     05  FILLER            PIC  X(0003).
  1533     05  CAR9O PIC  X(0001).
  1534*    -------------------------------
  1535     05  FILLER            PIC  X(0003).
  1536     05  GRP9O PIC  X(0006).
  1537*    -------------------------------
  1538     05  FILLER            PIC  X(0003).
  1539     05  FINRSP9O PIC  X(0010).
  1540*    -------------------------------
  1541     05  FILLER            PIC  X(0003).
  1542     05  AGENT9O PIC  X(0010).
  1543*    -------------------------------
  1544     05  FILLER            PIC  X(0003).
  1545     05  AGTNAM9O PIC  X(0030).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL856.cbl
  1546*    -------------------------------
  1547     05  FILLER            PIC  X(0003).
  1548     05  CARAO PIC  X(0001).
  1549*    -------------------------------
  1550     05  FILLER            PIC  X(0003).
  1551     05  GRPAO PIC  X(0006).
  1552*    -------------------------------
  1553     05  FILLER            PIC  X(0003).
  1554     05  FINRSPAO PIC  X(0010).
  1555*    -------------------------------
  1556     05  FILLER            PIC  X(0003).
  1557     05  AGENTAO PIC  X(0010).
  1558*    -------------------------------
  1559     05  FILLER            PIC  X(0003).
  1560     05  AGTNAMAO PIC  X(0030).
  1561*    -------------------------------
  1562     05  FILLER            PIC  X(0003).
  1563     05  CARBO PIC  X(0001).
  1564*    -------------------------------
  1565     05  FILLER            PIC  X(0003).
  1566     05  GRPBO PIC  X(0006).
  1567*    -------------------------------
  1568     05  FILLER            PIC  X(0003).
  1569     05  FINRSPBO PIC  X(0010).
  1570*    -------------------------------
  1571     05  FILLER            PIC  X(0003).
  1572     05  AGENTBO PIC  X(0010).
  1573*    -------------------------------
  1574     05  FILLER            PIC  X(0003).
  1575     05  AGTNAMBO PIC  X(0030).
  1576*    -------------------------------
  1577     05  FILLER            PIC  X(0003).
  1578     05  CARCO PIC  X(0001).
  1579*    -------------------------------
  1580     05  FILLER            PIC  X(0003).
  1581     05  GRPCO PIC  X(0006).
  1582*    -------------------------------
  1583     05  FILLER            PIC  X(0003).
  1584     05  FINRSPCO PIC  X(0010).
  1585*    -------------------------------
  1586     05  FILLER            PIC  X(0003).
  1587     05  AGENTCO PIC  X(0010).
  1588*    -------------------------------
  1589     05  FILLER            PIC  X(0003).
  1590     05  AGTNAMCO PIC  X(0030).
  1591*    -------------------------------
  1592     05  FILLER            PIC  X(0003).
  1593     05  CARDO PIC  X(0001).
  1594*    -------------------------------
  1595     05  FILLER            PIC  X(0003).
  1596     05  GRPDO PIC  X(0006).
  1597*    -------------------------------
  1598     05  FILLER            PIC  X(0003).
  1599     05  FINRSPDO PIC  X(0010).
  1600*    -------------------------------
  1601     05  FILLER            PIC  X(0003).
  1602     05  AGENTDO PIC  X(0010).
  1603*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL856.cbl
  1604     05  FILLER            PIC  X(0003).
  1605     05  AGTNAMDO PIC  X(0030).
  1606*    -------------------------------
  1607     05  FILLER            PIC  X(0003).
  1608     05  CAREO PIC  X(0001).
  1609*    -------------------------------
  1610     05  FILLER            PIC  X(0003).
  1611     05  GRPEO PIC  X(0006).
  1612*    -------------------------------
  1613     05  FILLER            PIC  X(0003).
  1614     05  FINRSPEO PIC  X(0010).
  1615*    -------------------------------
  1616     05  FILLER            PIC  X(0003).
  1617     05  AGENTEO PIC  X(0010).
  1618*    -------------------------------
  1619     05  FILLER            PIC  X(0003).
  1620     05  AGTNAMEO PIC  X(0030).
  1621*    -------------------------------
  1622     05  FILLER            PIC  X(0003).
  1623     05  CARFO PIC  X(0001).
  1624*    -------------------------------
  1625     05  FILLER            PIC  X(0003).
  1626     05  GRPFO PIC  X(0006).
  1627*    -------------------------------
  1628     05  FILLER            PIC  X(0003).
  1629     05  FINRSPFO PIC  X(0010).
  1630*    -------------------------------
  1631     05  FILLER            PIC  X(0003).
  1632     05  AGENTFO PIC  X(0010).
  1633*    -------------------------------
  1634     05  FILLER            PIC  X(0003).
  1635     05  AGTNAMFO PIC  X(0030).
  1636*    -------------------------------
  1637     05  FILLER            PIC  X(0003).
  1638     05  ERMESGO PIC  X(0079).
  1639*    -------------------------------
  1640     05  FILLER            PIC  X(0003).
  1641     05  PFENTERO PIC  X(0002).
  1642*    -------------------------------
  1643 01  DISPLAY-MAP REDEFINES EL856AI.
  1644     12  FILLER                  PIC X(73).
  1645     12  SM-CROSS-REFERENCE OCCURS 15 TIMES.
  1646         16  SM-CAR-LEN          PIC S9(4)   COMP.
  1647         16  SM-CAR-ATTRB        PIC X.
  1648         16  SM-CAR              PIC X.
  1649         16  SM-GRP-LEN          PIC S9(4)   COMP.
  1650         16  SM-GRP-ATTRB        PIC X.
  1651         16  SM-GRP              PIC X(6).
  1652         16  SM-FIN-RESP-LEN     PIC S9(4)   COMP.
  1653         16  SM-FIN-RESP-ATTRB   PIC X.
  1654         16  SM-FIN-RESP         PIC X(10).
  1655         16  SM-AGENT-LEN        PIC S9(4)   COMP.
  1656         16  SM-AGENT-ATTRB      PIC X.
  1657         16  SM-AGENT            PIC X(10).
  1658         16  SM-AGENT-NAME-LEN   PIC S9(4)   COMP.
  1659         16  SM-AGENT-NAME-ATTRB PIC X.
  1660         16  SM-AGENT-NAME       PIC X(30).
  1661
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL856.cbl
  1663
  1664****************************************************************
  1665*
  1666* Copyright (c) 2007 by Clerity Solutions, Inc.
  1667* All rights reserved.
  1668*
  1669****************************************************************
  1670 01  DFHEIV.
  1671   02  DFHEIV0               PIC X(35).
  1672   02  DFHEIV1               PIC X(08).
  1673   02  DFHEIV2               PIC X(08).
  1674   02  DFHEIV3               PIC X(08).
  1675   02  DFHEIV4               PIC X(06).
  1676   02  DFHEIV5               PIC X(04).
  1677   02  DFHEIV6               PIC X(04).
  1678   02  DFHEIV7               PIC X(02).
  1679   02  DFHEIV8               PIC X(02).
  1680   02  DFHEIV9               PIC X(01).
  1681   02  DFHEIV10              PIC S9(7) COMP-3.
  1682   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1683   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1684   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1685   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1686   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1687   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1688   02  DFHEIV17              PIC X(04).
  1689   02  DFHEIV18              PIC X(04).
  1690   02  DFHEIV19              PIC X(04).
  1691   02  DFHEIV20              USAGE IS POINTER.
  1692   02  DFHEIV21              USAGE IS POINTER.
  1693   02  DFHEIV22              USAGE IS POINTER.
  1694   02  DFHEIV23              USAGE IS POINTER.
  1695   02  DFHEIV24              USAGE IS POINTER.
  1696   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1697   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1698   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1699   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1700   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1701   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1702   02  FILLER                PIC X(02).
  1703   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1704   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1705   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1706   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1707   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1708 LINKAGE  SECTION.
  1709*****************************************************************
  1710*                                                               *
  1711* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1712* All rights reserved.                                          *
  1713*                                                               *
  1714*****************************************************************
  1715 01  dfheiblk.
  1716     02  eibtime          pic s9(7) comp-3.
  1717     02  eibdate          pic s9(7) comp-3.
  1718     02  eibtrnid         pic x(4).
  1719     02  eibtaskn         pic s9(7) comp-3.
  1720     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL856.cbl
  1721     02  dfheigdi         pic s9(4) comp.
  1722     02  eibcposn         pic s9(4) comp.
  1723     02  eibcalen         pic s9(4) comp.
  1724     02  eibaid           pic x(1).
  1725     02  eibfiller1       pic x(1).
  1726     02  eibfn            pic x(2).
  1727     02  eibfiller2       pic x(2).
  1728     02  eibrcode         pic x(6).
  1729     02  eibfiller3       pic x(2).
  1730     02  eibds            pic x(8).
  1731     02  eibreqid         pic x(8).
  1732     02  eibrsrce         pic x(8).
  1733     02  eibsync          pic x(1).
  1734     02  eibfree          pic x(1).
  1735     02  eibrecv          pic x(1).
  1736     02  eibsend          pic x(1).
  1737     02  eibatt           pic x(1).
  1738     02  eibeoc           pic x(1).
  1739     02  eibfmh           pic x(1).
  1740     02  eibcompl         pic x(1).
  1741     02  eibsig           pic x(1).
  1742     02  eibconf          pic x(1).
  1743     02  eiberr           pic x(1).
  1744     02  eibrldbk         pic x(1).
  1745     02  eiberrcd         pic x(4).
  1746     02  eibsynrb         pic x(1).
  1747     02  eibnodat         pic x(1).
  1748     02  eibfiller5       pic x(2).
  1749     02  eibresp          pic 9(09) comp.
  1750     02  eibresp2         pic 9(09) comp.
  1751     02  dfheigdj         pic s9(4) comp.
  1752     02  dfheigdk         pic s9(4) comp.
  1753 01  DFHCOMMAREA             PIC X(1024).
  1754
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL856.cbl
  1756
  1757*                            COPY ERCSUMM.
  1758******************************************************************
  1759*                                                                *
  1760*                                                                *
  1761*                            ERCSUMM                             *
  1762*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1763*                            VMOD=2.002                          *
  1764*                                                                *
  1765*   ONLINE CREDIT SYSTEM                                         *
  1766*                                                                *
  1767*   FILE DESCRIPTION = AR SUMMARY CROSS REFERENCE                *
  1768*                                                                *
  1769*   FILE TYPE = VSAM,KSDS                                        *
  1770*   RECORD SIZE = 150           RECFORM = FIXED                  *
  1771*                                                                *
  1772*   BASE CLUSTER NAME = ERSUMM                   RKP=2,LEN=34    *
  1773*                                                                *
  1774*       ALTERNATE PATH1 = ERSUMM2  (BY CO SUMMARY CARR           *
  1775*                                      GROUP F.R. AGENT)         *
  1776*                                                 RKP=36 ,LEN=34 *
  1777*                                                                *
  1778*   LOG = NO                                                     *
  1779*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1780*                                                                *
  1781******************************************************************
  1782
  1783 01  SUMM-CROSS-REFERENCE.
  1784     12  SX-RECORD-ID                PIC XX.
  1785         88  VALID-SX-ID             VALUE 'SX'.
  1786
  1787     12  SX-CONTROL-PRIMARY.
  1788         16  SX-COMPANY-CD           PIC X.
  1789         16  SX-SUMMARY              PIC X(6).
  1790         16  SX-CARRIER              PIC X.
  1791         16  SX-GROUP                PIC X(6).
  1792         16  SX-FIN-RESP             PIC X(10).
  1793         16  SX-ACCT-AGENT           PIC X(10).
  1794
  1795     12  SX-CONTROL-A1.
  1796         16  SX-COMPANY-A1           PIC X.
  1797         16  SX-ACCT-AGENT-A1        PIC X(10).
  1798         16  SX-SUMMARY-A1           PIC X(6).
  1799         16  SX-CARR-A1              PIC X.
  1800         16  SX-GROUP-A1             PIC X(6).
  1801         16  SX-FIN-RESP-A1          PIC X(10).
  1802
  1803     12  SX-MAINT-INFORMATION.
  1804         16  SX-LAST-MAINT-DT        PIC XX.
  1805         16  SX-LAST-MAINT-BY        PIC X(4).
  1806         16  SX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1807
  1808     12  SX-SUMM-OR-AGT-NAME         PIC X(30).
  1809
  1810     12  FILLER                      PIC X(40).
  1811
  1812******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL856.cbl
  1814
  1815 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1816                          SUMM-CROSS-REFERENCE.
  1817 0000-DFHEXIT SECTION.
  1818     MOVE '9#                    $   ' TO DFHEIV0.
  1819     MOVE 'EL856' TO DFHEIV1.
  1820     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1821
  1822     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1823     MOVE 1                      TO EMI-NUMBER-OF-LINES.
  1824
  1825     IF EIBCALEN = 0
  1826         GO TO 8800-UNAUTHORIZED-ACCESS.
  1827
  1828     MOVE EIBTRMID               TO QID-TERM.
  1829     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1830     MOVE '5'                    TO DC-OPTION-CODE.
  1831     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  1832     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  1833     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT.
  1834
  1835     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1836         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1837             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1838             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1839             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1840             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1841             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1842             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1843             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1844             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1845         ELSE
  1846             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1847             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1848             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1849             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1850             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1851             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1852             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1853             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  1854
  1855     MOVE LOW-VALUES             TO EL856AI.
  1856
  1857
  1858* EXEC CICS HANDLE CONDITION
  1859*        PGMIDERR  (9600-PGMID-ERROR)
  1860*        ERROR     (9990-ABEND)
  1861*    END-EXEC.
  1862*    MOVE '"$L.                  ! " #00001853' TO DFHEIV0
  1863     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1864     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1865     MOVE X'2220233030303031383533' TO DFHEIV0(25:11)
  1866     CALL 'kxdfhei1' USING DFHEIV0
  1867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1868
  1869
  1870     IF EIBTRNID = TRANS-EXD4
  1871        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL856.cbl
  1872        MOVE PI-AR-SUMMARY-CODE  TO PI-SUMMARY-CODE
  1873        MOVE -1                      TO SUMNAMEL
  1874        GO TO 3000-DISPLAY-SM-CROSS-REF.
  1875
  1876     IF EIBTRNID NOT = TRANS-EXJ8
  1877        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  1878        MOVE -1                      TO SUMCODEL
  1879        GO TO 8100-SEND-INITIAL-MAP.
  1880
  1881     IF EIBAID = DFHCLEAR
  1882         GO TO 9400-CLEAR.
  1883
  1884
  1885     IF PI-PROCESSOR-ID = 'LGXX'
  1886         GO TO 0200-RECEIVE.
  1887
  1888
  1889* EXEC CICS READQ TS
  1890*        QUEUE  (QID)
  1891*        INTO   (SECURITY-CONTROL)
  1892*        LENGTH (SC-COMM-LENGTH)
  1893*        ITEM   (SC-ITEM)
  1894*    END-EXEC.
  1895*    MOVE '*$II   L              ''   #00001876' TO DFHEIV0
  1896     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1897     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1898     MOVE X'2020233030303031383736' TO DFHEIV0(25:11)
  1899     CALL 'kxdfhei1' USING DFHEIV0,
  1900           QID,
  1901           SECURITY-CONTROL,
  1902           SC-COMM-LENGTH,
  1903           SC-ITEM,
  1904           DFHEIV99,
  1905           DFHEIV99
  1906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1907
  1908
  1909     MOVE SC-CREDIT-DISPLAY (4)   TO PI-DISPLAY-CAP.
  1910     MOVE SC-CREDIT-UPDATE  (4)   TO PI-MODIFY-CAP.
  1911
  1912     IF NOT DISPLAY-CAP
  1913         MOVE 'READ'          TO SM-READ
  1914         PERFORM 9995-SECURITY-VIOLATION
  1915         MOVE ER-0070         TO  EMI-ERROR
  1916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1917         GO TO 8100-SEND-INITIAL-MAP.
  1918
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL856.cbl
  1920
  1921******************************************************************
  1922*                                                                *
  1923*              R E C E I V E   M A P S                           *
  1924*                                                                *
  1925******************************************************************
  1926
  1927 0200-RECEIVE.
  1928
  1929     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1930         MOVE ER-0008            TO EMI-ERROR
  1931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1932         MOVE -1                 TO PFENTERL
  1933         GO TO 8200-SEND-DATAONLY.
  1934
  1935
  1936* EXEC CICS RECEIVE
  1937*        MAP      (EL856A)
  1938*        MAPSET   (MAPSET-EL856S)
  1939*        INTO     (EL856AI)
  1940*    END-EXEC.
  1941     MOVE LENGTH OF
  1942      EL856AI
  1943       TO DFHEIV11
  1944*    MOVE '8"T I  L              ''   #00001909' TO DFHEIV0
  1945     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1946     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1947     MOVE X'2020233030303031393039' TO DFHEIV0(25:11)
  1948     CALL 'kxdfhei1' USING DFHEIV0,
  1949           EL856A,
  1950           EL856AI,
  1951           DFHEIV11,
  1952           MAPSET-EL856S,
  1953           DFHEIV99,
  1954           DFHEIV99
  1955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1956
  1957
  1958     IF PFENTERL = ZERO
  1959         GO TO 0300-CHECK-PFKEYS.
  1960
  1961     IF EIBAID NOT = DFHENTER
  1962         MOVE ER-0004          TO EMI-ERROR
  1963         MOVE AL-UNBOF         TO PFENTERA
  1964         MOVE -1               TO PFENTERL
  1965         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1966         GO TO 8200-SEND-DATAONLY.
  1967
  1968     IF (PFENTERI NUMERIC)
  1969         AND  (PFENTERI GREATER ZERO AND LESS THAN 25)
  1970         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  1971     ELSE
  1972         MOVE ER-0029          TO EMI-ERROR
  1973         MOVE AL-UNBOF         TO PFENTERA
  1974         MOVE -1               TO PFENTERL
  1975         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1976         GO TO 8200-SEND-DATAONLY.
  1977
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL856.cbl
  1979
  1980******************************************************************
  1981*                                                                *
  1982*              C H E C K   P F K E Y S                           *
  1983*                                                                *
  1984******************************************************************
  1985
  1986 0300-CHECK-PFKEYS.
  1987
  1988     IF EIBAID = DFHPF23
  1989         GO TO 8810-PF23.
  1990
  1991     IF EIBAID = DFHPF24
  1992         GO TO 9200-RETURN-MAIN-MENU.
  1993
  1994     IF EIBAID = DFHPF12
  1995         GO TO 9500-PF12.
  1996
  1997     IF EIBAID = DFHENTER
  1998         GO TO 1000-EDIT-MAP.
  1999
  2000     IF EIBAID = DFHPF1
  2001        IF PI-END-OF-FILE
  2002           MOVE ER-2237 TO EMI-ERROR
  2003           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2004           GO TO 8200-SEND-DATAONLY
  2005        ELSE
  2006           GO TO 3000-DISPLAY-SM-CROSS-REF.
  2007
  2008     IF EIBAID = DFHPF2
  2009        IF PI-TOP-OF-FILE
  2010           MOVE ER-2238 TO EMI-ERROR
  2011           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2012           GO TO 8200-SEND-DATAONLY
  2013        ELSE
  2014           PERFORM 4100-READ-PREV-SUMMARY-CODE THRU 4190-EXIT
  2015           GO TO 3000-DISPLAY-SM-CROSS-REF.
  2016
  2017     IF EIBAID = DFHPF3
  2018        IF PI-END-OF-FILE
  2019           MOVE ER-2237 TO EMI-ERROR
  2020           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2021           GO TO 8200-SEND-DATAONLY
  2022        ELSE
  2023           GO TO 3000-DISPLAY-SM-CROSS-REF.
  2024
  2025     IF EIBAID = DFHPF4
  2026        IF PI-TOP-OF-FILE
  2027           MOVE ER-2238 TO EMI-ERROR
  2028           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2029           GO TO 8200-SEND-DATAONLY
  2030        ELSE
  2031           GO TO 3100-DISPLAY-PREV-SM-CROSS-REF.
  2032
  2033     MOVE ER-0008 TO EMI-ERROR.
  2034     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2035     MOVE -1                     TO PFENTERL.
  2036     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL856.cbl
  2037
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL856.cbl
  2039
  2040******************************************************************
  2041*                                                                *
  2042*                  E D I T    M A P                              *
  2043*                                                                *
  2044******************************************************************
  2045
  2046 1000-EDIT-MAP.
  2047
  2048
  2049     IF SUMCODEL GREATER THAN ZEROS
  2050        MOVE SUMCODEI            TO PI-SUMMARY-CODE
  2051        PERFORM 4200-READ-SUM-FILE THRU 4290-EXIT
  2052        MOVE AL-UANON            TO SUMCODEA
  2053     ELSE
  2054        MOVE ER-3135             TO EMI-ERROR
  2055        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2056        MOVE -1                  TO SUMNAMEL
  2057        GO TO 8200-SEND-DATAONLY.
  2058
  2059     IF SUMNAMEL GREATER THAN ZEROS
  2060        PERFORM 2000-UPDATE-SUMMARY-NAME THRU 2090-EXIT.
  2061
  2062     GO TO 3000-DISPLAY-SM-CROSS-REF.
  2063
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL856.cbl
  2065
  2066******************************************************************
  2067*                                                                *
  2068*        U P D A T E   S U M M A R Y   N A M E                   *
  2069*                                                                *
  2070******************************************************************
  2071
  2072 2000-UPDATE-SUMMARY-NAME.
  2073
  2074     MOVE LOW-VALUES             TO ERSUMM-KEY.
  2075     MOVE PI-COMPANY-CD          TO ERSUMM-COMPANY-CD.
  2076     MOVE PI-SUMMARY-CODE        TO ERSUMM-SUMMARY.
  2077
  2078
  2079* EXEC CICS HANDLE CONDITION
  2080*        NOTFND   (2080-SUMMARY-NOTFND)
  2081*    END-EXEC.
  2082*    MOVE '"$I                   ! # #00002035' TO DFHEIV0
  2083     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2084     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2085     MOVE X'2320233030303032303335' TO DFHEIV0(25:11)
  2086     CALL 'kxdfhei1' USING DFHEIV0
  2087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2088
  2089
  2090
  2091* EXEC CICS READ
  2092*        DATASET   (FILE-ID-ERSUMM)
  2093*        SET       (ADDRESS OF SUMM-CROSS-REFERENCE)
  2094*        RIDFLD    (ERSUMM-KEY)
  2095*        UPDATE
  2096*    END-EXEC.
  2097*    MOVE '&"S        EU         (   #00002039' TO DFHEIV0
  2098     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2099     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2100     MOVE X'2020233030303032303339' TO DFHEIV0(25:11)
  2101     CALL 'kxdfhei1' USING DFHEIV0,
  2102           FILE-ID-ERSUMM,
  2103           DFHEIV20,
  2104           DFHEIV99,
  2105           ERSUMM-KEY,
  2106           DFHEIV99,
  2107           DFHEIV99,
  2108           DFHEIV99
  2109     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  2110         DFHEIV20
  2111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2112
  2113
  2114     MOVE 'B'                    TO JP-RECORD-TYPE.
  2115     MOVE SUMM-CROSS-REFERENCE   TO JP-RECORD-AREA.
  2116
  2117     PERFORM 8400-LOG-JOURNAL-RECORD.
  2118
  2119     MOVE SUMNAMEI               TO SX-SUMM-OR-AGT-NAME.
  2120
  2121     MOVE 'C'                    TO JP-RECORD-TYPE.
  2122     MOVE SUMM-CROSS-REFERENCE   TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL856.cbl
  2123
  2124
  2125* EXEC CICS REWRITE
  2126*        DATASET (FILE-ID-ERSUMM)
  2127*        FROM    (SUMM-CROSS-REFERENCE)
  2128*    END-EXEC.
  2129     MOVE LENGTH OF
  2130      SUMM-CROSS-REFERENCE
  2131       TO DFHEIV11
  2132*    MOVE '&& L                  %   #00002056' TO DFHEIV0
  2133     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2134     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2135     MOVE X'2020233030303032303536' TO DFHEIV0(25:11)
  2136     CALL 'kxdfhei1' USING DFHEIV0,
  2137           FILE-ID-ERSUMM,
  2138           SUMM-CROSS-REFERENCE,
  2139           DFHEIV11,
  2140           DFHEIV99
  2141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2142
  2143
  2144     PERFORM 8400-LOG-JOURNAL-RECORD.
  2145
  2146     GO TO 2090-EXIT.
  2147
  2148 2080-SUMMARY-NOTFND.
  2149
  2150     MOVE ER-3133                TO EMI-ERROR.
  2151     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2152     MOVE -1                     TO SUMNAMEL.
  2153     GO TO 8200-SEND-DATAONLY.
  2154
  2155 2090-EXIT.
  2156     EXIT.
  2157
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL856.cbl
  2159
  2160******************************************************************
  2161*                                                                *
  2162*  D I S P L A Y   S U M M A R Y   C R O S S   R E F E R E N C E *
  2163*                                                                *
  2164******************************************************************
  2165
  2166 3000-DISPLAY-SM-CROSS-REF.
  2167
  2168
  2169* EXEC CICS HANDLE CONDITION
  2170*        NOTFND  (3080-REQUEST-NOTFND)
  2171*    END-EXEC.
  2172*    MOVE '"$I                   ! $ #00002085' TO DFHEIV0
  2173     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2175     MOVE X'2420233030303032303835' TO DFHEIV0(25:11)
  2176     CALL 'kxdfhei1' USING DFHEIV0
  2177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2178
  2179
  2180     IF EIBAID = DFHPF3
  2181        IF PI-LST-SUM-KEY GREATER THAN SPACES
  2182           MOVE PI-LST-SUM-KEY   TO ERSUMM-KEY
  2183           GO TO 3010-PROCESS-SM-CROSS-REF
  2184        ELSE
  2185           MOVE PI-1ST-SUM-KEY   TO ERSUMM-KEY.
  2186
  2187     IF EIBAID = DFHENTER
  2188        MOVE LOW-VALUES       TO ERSUMM-KEY
  2189        MOVE PI-COMPANY-CD    TO ERSUMM-COMPANY-CD
  2190        MOVE PI-SUMMARY-CODE  TO ERSUMM-SUMMARY.
  2191
  2192     IF EIBAID = DFHPF1
  2193        MOVE HIGH-VALUES      TO ERSUMM-KEY
  2194        MOVE PI-COMPANY-CD    TO ERSUMM-COMPANY-CD
  2195        MOVE PI-SUMMARY-CODE  TO ERSUMM-SUMMARY.
  2196
  2197 3010-PROCESS-SM-CROSS-REF.
  2198
  2199
  2200* EXEC CICS STARTBR
  2201*        DATASET (FILE-ID-ERSUMM)
  2202*        RIDFLD  (ERSUMM-KEY)
  2203*    END-EXEC.
  2204     MOVE 0
  2205       TO DFHEIV11
  2206*    MOVE '&,         G          &   #00002108' TO DFHEIV0
  2207     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2208     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2209     MOVE X'2020233030303032313038' TO DFHEIV0(25:11)
  2210     CALL 'kxdfhei1' USING DFHEIV0,
  2211           FILE-ID-ERSUMM,
  2212           ERSUMM-KEY,
  2213           DFHEIV99,
  2214           DFHEIV11,
  2215           DFHEIV99
  2216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL856.cbl
  2217
  2218
  2219     MOVE SPACE                  TO PI-END-OF-FILE-SW
  2220                                    PI-TOP-OF-FILE-SW.
  2221
  2222     MOVE +0                     TO WS-SUB1.
  2223
  2224 3020-READ-SUMMARY-FILE.
  2225
  2226
  2227* EXEC CICS HANDLE CONDITION
  2228*        ENDFILE (3060-END-OF-FILE)
  2229*    END-EXEC.
  2230*    MOVE '"$''                   ! % #00002120' TO DFHEIV0
  2231     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  2232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2233     MOVE X'2520233030303032313230' TO DFHEIV0(25:11)
  2234     CALL 'kxdfhei1' USING DFHEIV0
  2235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2236
  2237
  2238
  2239* EXEC CICS READNEXT
  2240*        SET     (ADDRESS OF SUMM-CROSS-REFERENCE)
  2241*        DATASET (FILE-ID-ERSUMM)
  2242*        RIDFLD  (ERSUMM-KEY)
  2243*    END-EXEC.
  2244     MOVE 0
  2245       TO DFHEIV11
  2246*    MOVE '&.S                   )   #00002124' TO DFHEIV0
  2247     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2248     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2249     MOVE X'2020233030303032313234' TO DFHEIV0(25:11)
  2250     CALL 'kxdfhei1' USING DFHEIV0,
  2251           FILE-ID-ERSUMM,
  2252           DFHEIV20,
  2253           DFHEIV99,
  2254           ERSUMM-KEY,
  2255           DFHEIV99,
  2256           DFHEIV11,
  2257           DFHEIV99,
  2258           DFHEIV99
  2259     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  2260         DFHEIV20
  2261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2262
  2263
  2264     IF SX-COMPANY-CD NOT = PI-COMPANY-CD
  2265        GO TO 3060-END-OF-FILE.
  2266
  2267     IF PI-LST-SUM-KEY = ERSUMM-KEY
  2268        GO TO 3020-READ-SUMMARY-FILE.
  2269
  2270     IF WS-BROWSE-STARTED
  2271        IF SX-SUMMARY NOT = PI-SUMMARY-CODE
  2272           GO TO 3070-DISPLAY-PROCESSED.
  2273
  2274     IF SX-CARRIER = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL856.cbl
  2275        MOVE SX-SUMMARY          TO PI-SUMMARY-CODE
  2276        MOVE 'Y'                 TO WS-BROWSE-STARTED-SW
  2277        GO TO 3020-READ-SUMMARY-FILE.
  2278
  2279     IF WS-BROWSE-STARTED
  2280        NEXT SENTENCE
  2281     ELSE
  2282        MOVE 'Y'                 TO WS-BROWSE-STARTED-SW
  2283        MOVE SX-SUMMARY          TO PI-SUMMARY-CODE.
  2284
  2285     ADD +1                      TO WS-SUB1.
  2286
  2287     IF WS-SUB1 GREATER THAN +15
  2288        GO TO 3070-DISPLAY-PROCESSED.
  2289
  2290     IF WS-SUB1 = +1
  2291        MOVE PI-SUMMARY-CODE     TO SUMCODEO
  2292        MOVE AL-UANON            TO SUMCODEA
  2293        MOVE ERSUMM-KEY          TO PI-1ST-SUM-KEY.
  2294
  2295     IF WS-SUB1 = +15
  2296        MOVE ERSUMM-KEY          TO PI-LST-SUM-KEY.
  2297
  2298     MOVE PI-SUMMARY-CODE        TO SUMCODEO.
  2299     MOVE SX-CARRIER             TO SM-CAR        (WS-SUB1).
  2300     MOVE SX-GROUP               TO SM-GRP        (WS-SUB1).
  2301     MOVE SX-FIN-RESP            TO SM-FIN-RESP   (WS-SUB1).
  2302     MOVE SX-ACCT-AGENT          TO SM-AGENT      (WS-SUB1).
  2303     MOVE SX-SUMM-OR-AGT-NAME    TO SM-AGENT-NAME (WS-SUB1).
  2304
  2305     GO TO 3020-READ-SUMMARY-FILE.
  2306
  2307 3060-END-OF-FILE.
  2308
  2309     MOVE 'Y'                    TO PI-END-OF-FILE-SW.
  2310     MOVE ER-2237                TO EMI-ERROR.
  2311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2312
  2313 3070-DISPLAY-PROCESSED.
  2314
  2315
  2316* EXEC CICS ENDBR
  2317*        DATASET (FILE-ID-ERSUMM)
  2318*    END-EXEC.
  2319     MOVE 0
  2320       TO DFHEIV11
  2321*    MOVE '&2                    $   #00002181' TO DFHEIV0
  2322     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2323     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2324     MOVE X'2020233030303032313831' TO DFHEIV0(25:11)
  2325     CALL 'kxdfhei1' USING DFHEIV0,
  2326           FILE-ID-ERSUMM,
  2327           DFHEIV11,
  2328           DFHEIV99
  2329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2330
  2331
  2332     MOVE PI-SUMMARY-CODE        TO SUMCODEO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL856.cbl
  2333     PERFORM 4200-READ-SUM-FILE THRU 4290-EXIT.
  2334     MOVE SX-SUMM-OR-AGT-NAME    TO SUMNAMEO.
  2335
  2336     IF EIBTRNID = TRANS-EXD4
  2337        MOVE -1                  TO SUMNAMEL
  2338     ELSE
  2339        MOVE -1                  TO SUMCODEL.
  2340
  2341     GO TO 8100-SEND-INITIAL-MAP.
  2342
  2343 3080-REQUEST-NOTFND.
  2344
  2345     MOVE ER-3133                TO EMI-ERROR.
  2346     MOVE -1                     TO SUMCODEL.
  2347     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2348     GO TO 8200-SEND-DATAONLY.
  2349
  2350 3090-EXIT.
  2351      EXIT.
  2352
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL856.cbl
  2354
  2355******************************************************************
  2356*                                                                *
  2357*     D I S P L A Y   P R E V.   C R O S S   R E F E R E N C E   *
  2358*                                                                *
  2359******************************************************************
  2360
  2361 3100-DISPLAY-PREV-SM-CROSS-REF.
  2362
  2363
  2364* EXEC CICS HANDLE CONDITION
  2365*        NOTFND  (3180-REQUEST-NOTFND)
  2366*    END-EXEC.
  2367*    MOVE '"$I                   ! & #00002216' TO DFHEIV0
  2368     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2370     MOVE X'2620233030303032323136' TO DFHEIV0(25:11)
  2371     CALL 'kxdfhei1' USING DFHEIV0
  2372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2373
  2374
  2375     MOVE PI-1ST-SUM-KEY        TO ERSUMM-KEY.
  2376
  2377
  2378* EXEC CICS STARTBR
  2379*        DATASET (FILE-ID-ERSUMM)
  2380*        RIDFLD  (ERSUMM-KEY)
  2381*    END-EXEC.
  2382     MOVE 0
  2383       TO DFHEIV11
  2384*    MOVE '&,         G          &   #00002222' TO DFHEIV0
  2385     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2386     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2387     MOVE X'2020233030303032323232' TO DFHEIV0(25:11)
  2388     CALL 'kxdfhei1' USING DFHEIV0,
  2389           FILE-ID-ERSUMM,
  2390           ERSUMM-KEY,
  2391           DFHEIV99,
  2392           DFHEIV11,
  2393           DFHEIV99
  2394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2395
  2396
  2397     MOVE SPACE                  TO PI-END-OF-FILE-SW
  2398                                    PI-TOP-OF-FILE-SW.
  2399
  2400     MOVE +16                    TO WS-SUB1.
  2401
  2402 3110-READ-SUMMARY-FILE.
  2403
  2404
  2405* EXEC CICS HANDLE CONDITION
  2406*        ENDFILE (3160-END-OF-FILE)
  2407*    END-EXEC.
  2408*    MOVE '"$''                   ! '' #00002234' TO DFHEIV0
  2409     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  2410     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2411     MOVE X'2720233030303032323334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL856.cbl
  2412     CALL 'kxdfhei1' USING DFHEIV0
  2413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2414
  2415
  2416
  2417* EXEC CICS READPREV
  2418*        SET     (ADDRESS OF SUMM-CROSS-REFERENCE)
  2419*        DATASET (FILE-ID-ERSUMM)
  2420*        RIDFLD  (ERSUMM-KEY)
  2421*    END-EXEC.
  2422     MOVE 0
  2423       TO DFHEIV11
  2424*    MOVE '&0S                   )   #00002238' TO DFHEIV0
  2425     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  2426     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2427     MOVE X'2020233030303032323338' TO DFHEIV0(25:11)
  2428     CALL 'kxdfhei1' USING DFHEIV0,
  2429           FILE-ID-ERSUMM,
  2430           DFHEIV20,
  2431           DFHEIV99,
  2432           ERSUMM-KEY,
  2433           DFHEIV99,
  2434           DFHEIV11,
  2435           DFHEIV99,
  2436           DFHEIV99
  2437     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  2438         DFHEIV20
  2439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2440
  2441
  2442     IF SX-COMPANY-CD NOT = PI-COMPANY-CD
  2443        GO TO 3160-END-OF-FILE.
  2444
  2445     IF SX-SUMMARY LESS THAN PI-SUMMARY-CODE
  2446        GO TO 3170-DISPLAY-PROCESSED.
  2447
  2448     IF SX-CARRIER = LOW-VALUES
  2449        GO TO 3170-DISPLAY-PROCESSED.
  2450
  2451     IF WS-BROWSE-STARTED
  2452        NEXT SENTENCE
  2453     ELSE
  2454        MOVE 'Y'                 TO WS-BROWSE-STARTED-SW
  2455        MOVE ERSUMM-SUMMARY      TO PI-SUMMARY-CODE.
  2456
  2457     IF PI-1ST-SUM-KEY = ERSUMM-KEY
  2458        GO TO 3110-READ-SUMMARY-FILE.
  2459
  2460     IF WS-SUB1 = +1
  2461        MOVE ERSUMM-KEY          TO PI-1ST-SUM-KEY.
  2462
  2463     IF WS-SUB1 = +15
  2464        MOVE ERSUMM-KEY          TO PI-LST-SUM-KEY.
  2465
  2466     SUBTRACT +1                 FROM WS-SUB1.
  2467
  2468     IF WS-SUB1 LESS THAN +1
  2469        GO TO 3170-DISPLAY-PROCESSED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL856.cbl
  2470
  2471     MOVE PI-SUMMARY-CODE        TO SUMCODEO.
  2472     MOVE SX-CARRIER             TO SM-CAR        (WS-SUB1).
  2473     MOVE SX-GROUP               TO SM-GRP        (WS-SUB1).
  2474     MOVE SX-FIN-RESP            TO SM-FIN-RESP   (WS-SUB1).
  2475     MOVE SX-ACCT-AGENT          TO SM-AGENT      (WS-SUB1).
  2476     MOVE SX-SUMM-OR-AGT-NAME    TO SM-AGENT-NAME (WS-SUB1).
  2477
  2478     GO TO 3110-READ-SUMMARY-FILE.
  2479
  2480 3160-END-OF-FILE.
  2481
  2482     MOVE 'Y'                    TO PI-TOP-OF-FILE-SW.
  2483     MOVE ER-2238                TO EMI-ERROR.
  2484     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2485
  2486 3170-DISPLAY-PROCESSED.
  2487
  2488
  2489* EXEC CICS ENDBR
  2490*        DATASET (FILE-ID-ERSUMM)
  2491*    END-EXEC.
  2492     MOVE 0
  2493       TO DFHEIV11
  2494*    MOVE '&2                    $   #00002290' TO DFHEIV0
  2495     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2496     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2497     MOVE X'2020233030303032323930' TO DFHEIV0(25:11)
  2498     CALL 'kxdfhei1' USING DFHEIV0,
  2499           FILE-ID-ERSUMM,
  2500           DFHEIV11,
  2501           DFHEIV99
  2502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2503
  2504
  2505     PERFORM 4200-READ-SUM-FILE THRU 4290-EXIT.
  2506     MOVE SX-SUMM-OR-AGT-NAME TO SUMNAMEO.
  2507
  2508     MOVE -1                     TO SUMCODEL.
  2509
  2510     GO TO 8100-SEND-INITIAL-MAP.
  2511
  2512 3180-REQUEST-NOTFND.
  2513
  2514     MOVE ERSUMM-SUMMARY         TO SUMCODEO.
  2515     MOVE AL-UANON               TO SUMCODEA.
  2516     MOVE ER-2132                TO EMI-ERROR.
  2517     MOVE -1                     TO SUMCODEL.
  2518     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2519     GO TO 8200-SEND-DATAONLY.
  2520
  2521 3190-EXIT.
  2522      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL856.cbl
  2524
  2525******************************************************************
  2526*                                                                *
  2527*         R E A D   P R E V   S U M M A R Y   C O D E            *
  2528*                                                                *
  2529******************************************************************
  2530
  2531 4100-READ-PREV-SUMMARY-CODE.
  2532
  2533     MOVE LOW-VALUES             TO ERSUMM-KEY.
  2534     MOVE PI-COMPANY-CD          TO ERSUMM-COMPANY-CD.
  2535     MOVE PI-SUMMARY-CODE        TO ERSUMM-SUMMARY.
  2536
  2537
  2538* EXEC CICS HANDLE CONDITION
  2539*        NOTFND  (4180-SUMMARY-NOTFND)
  2540*    END-EXEC.
  2541*    MOVE '"$I                   ! ( #00002326' TO DFHEIV0
  2542     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2544     MOVE X'2820233030303032333236' TO DFHEIV0(25:11)
  2545     CALL 'kxdfhei1' USING DFHEIV0
  2546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2547
  2548
  2549     MOVE SPACE                  TO PI-END-OF-FILE-SW
  2550                                    PI-TOP-OF-FILE-SW.
  2551
  2552     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
  2553
  2554
  2555* EXEC CICS STARTBR
  2556*        DATASET (FILE-ID-ERSUMM)
  2557*        RIDFLD  (ERSUMM-KEY)
  2558*    END-EXEC.
  2559     MOVE 0
  2560       TO DFHEIV11
  2561*    MOVE '&,         G          &   #00002335' TO DFHEIV0
  2562     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2563     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2564     MOVE X'2020233030303032333335' TO DFHEIV0(25:11)
  2565     CALL 'kxdfhei1' USING DFHEIV0,
  2566           FILE-ID-ERSUMM,
  2567           ERSUMM-KEY,
  2568           DFHEIV99,
  2569           DFHEIV11,
  2570           DFHEIV99
  2571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2572
  2573
  2574
  2575* EXEC CICS HANDLE CONDITION
  2576*        ENDFILE (4160-END-OF-FILE)
  2577*    END-EXEC.
  2578*    MOVE '"$''                   ! ) #00002340' TO DFHEIV0
  2579     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  2580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2581     MOVE X'2920233030303032333430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL856.cbl
  2582     CALL 'kxdfhei1' USING DFHEIV0
  2583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2584
  2585
  2586 4110-READ-SUMMARY-FILE.
  2587
  2588
  2589* EXEC CICS READPREV
  2590*        SET     (ADDRESS OF SUMM-CROSS-REFERENCE)
  2591*        DATASET (FILE-ID-ERSUMM)
  2592*        RIDFLD  (ERSUMM-KEY)
  2593*    END-EXEC.
  2594     MOVE 0
  2595       TO DFHEIV11
  2596*    MOVE '&0S                   )   #00002346' TO DFHEIV0
  2597     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  2598     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2599     MOVE X'2020233030303032333436' TO DFHEIV0(25:11)
  2600     CALL 'kxdfhei1' USING DFHEIV0,
  2601           FILE-ID-ERSUMM,
  2602           DFHEIV20,
  2603           DFHEIV99,
  2604           ERSUMM-KEY,
  2605           DFHEIV99,
  2606           DFHEIV11,
  2607           DFHEIV99,
  2608           DFHEIV99
  2609     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  2610         DFHEIV20
  2611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2612
  2613
  2614     IF SX-COMPANY-CD NOT = PI-COMPANY-CD
  2615        GO TO 4160-END-OF-FILE.
  2616
  2617     IF WS-BROWSE-STARTED
  2618        NEXT SENTENCE
  2619     ELSE
  2620        MOVE 'Y'                 TO WS-BROWSE-STARTED-SW
  2621        GO TO 4110-READ-SUMMARY-FILE.
  2622
  2623
  2624* EXEC CICS ENDBR
  2625*        DATASET (FILE-ID-ERSUMM)
  2626*    END-EXEC.
  2627     MOVE 0
  2628       TO DFHEIV11
  2629*    MOVE '&2                    $   #00002361' TO DFHEIV0
  2630     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2631     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2632     MOVE X'2020233030303032333631' TO DFHEIV0(25:11)
  2633     CALL 'kxdfhei1' USING DFHEIV0,
  2634           FILE-ID-ERSUMM,
  2635           DFHEIV11,
  2636           DFHEIV99
  2637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2638
  2639
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL856.cbl
  2640     MOVE ERSUMM-SUMMARY         TO PI-SUMMARY-CODE.
  2641
  2642     MOVE LOW-VALUES             TO ERSUMM-KEY.
  2643     MOVE PI-COMPANY-CD          TO ERSUMM-COMPANY-CD.
  2644     MOVE PI-SUMMARY-CODE        TO ERSUMM-SUMMARY.
  2645
  2646
  2647* EXEC CICS READ
  2648*        SET     (ADDRESS OF SUMM-CROSS-REFERENCE)
  2649*        DATASET (FILE-ID-ERSUMM)
  2650*        RIDFLD  (ERSUMM-KEY)
  2651*    END-EXEC.
  2652*    MOVE '&"S        E          (   #00002371' TO DFHEIV0
  2653     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2654     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2655     MOVE X'2020233030303032333731' TO DFHEIV0(25:11)
  2656     CALL 'kxdfhei1' USING DFHEIV0,
  2657           FILE-ID-ERSUMM,
  2658           DFHEIV20,
  2659           DFHEIV99,
  2660           ERSUMM-KEY,
  2661           DFHEIV99,
  2662           DFHEIV99,
  2663           DFHEIV99
  2664     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  2665         DFHEIV20
  2666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2667
  2668
  2669     GO TO 4190-EXIT.
  2670
  2671 4160-END-OF-FILE.
  2672
  2673
  2674* EXEC CICS ENDBR
  2675*        DATASET (FILE-ID-ERSUMM)
  2676*    END-EXEC.
  2677     MOVE 0
  2678       TO DFHEIV11
  2679*    MOVE '&2                    $   #00002381' TO DFHEIV0
  2680     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2681     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2682     MOVE X'2020233030303032333831' TO DFHEIV0(25:11)
  2683     CALL 'kxdfhei1' USING DFHEIV0,
  2684           FILE-ID-ERSUMM,
  2685           DFHEIV11,
  2686           DFHEIV99
  2687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2688
  2689
  2690     MOVE 'Y'                    TO PI-TOP-OF-FILE-SW.
  2691     MOVE ER-2238                TO EMI-ERROR.
  2692     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2693     MOVE -1                    TO PFENTERL.
  2694     GO TO 8200-SEND-DATAONLY.
  2695
  2696 4180-SUMMARY-NOTFND.
  2697
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL856.cbl
  2698     MOVE ERSUMM-SUMMARY        TO SUMCODEO.
  2699     MOVE AL-UANON              TO SUMCODEA.
  2700     MOVE ER-3133               TO EMI-ERROR.
  2701     MOVE -1                    TO PFENTERL.
  2702     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2703     GO TO 8200-SEND-DATAONLY.
  2704
  2705 4190-EXIT.
  2706     EXIT.
  2707
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL856.cbl
  2709
  2710******************************************************************
  2711*                                                                *
  2712*             R E A D   S U M M A R Y   H E A D E R              *
  2713*                                                                *
  2714******************************************************************
  2715
  2716
  2717 4200-READ-SUM-FILE.
  2718
  2719     MOVE LOW-VALUES             TO ERSUMM-KEY.
  2720     MOVE PI-COMPANY-CD          TO ERSUMM-COMPANY-CD.
  2721     MOVE PI-SUMMARY-CODE        TO ERSUMM-SUMMARY.
  2722
  2723
  2724* EXEC CICS HANDLE CONDITION
  2725*        NOTFND   (4280-SUMMARY-NOTFND)
  2726*    END-EXEC.
  2727*    MOVE '"$I                   ! * #00002418' TO DFHEIV0
  2728     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2730     MOVE X'2A20233030303032343138' TO DFHEIV0(25:11)
  2731     CALL 'kxdfhei1' USING DFHEIV0
  2732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2733
  2734
  2735
  2736* EXEC CICS READ
  2737*        DATASET   (FILE-ID-ERSUMM)
  2738*        SET       (ADDRESS OF SUMM-CROSS-REFERENCE)
  2739*        RIDFLD    (ERSUMM-KEY)
  2740*    END-EXEC.
  2741*    MOVE '&"S        E          (   #00002422' TO DFHEIV0
  2742     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2744     MOVE X'2020233030303032343232' TO DFHEIV0(25:11)
  2745     CALL 'kxdfhei1' USING DFHEIV0,
  2746           FILE-ID-ERSUMM,
  2747           DFHEIV20,
  2748           DFHEIV99,
  2749           ERSUMM-KEY,
  2750           DFHEIV99,
  2751           DFHEIV99,
  2752           DFHEIV99
  2753     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  2754         DFHEIV20
  2755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2756
  2757
  2758     GO TO 4290-EXIT.
  2759
  2760 4280-SUMMARY-NOTFND.
  2761
  2762     MOVE -1                     TO SUMCODEL.
  2763     MOVE ER-3133                TO EMI-ERROR.
  2764     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2765     GO TO 8200-SEND-DATAONLY.
  2766
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL856.cbl
  2767 4290-EXIT.
  2768     EXIT.
  2769
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL856.cbl
  2771
  2772******************************************************************
  2773*                                                                *
  2774*            S  E N D    I N I T I A L   M A P                   *
  2775*                                                                *
  2776******************************************************************
  2777
  2778 8100-SEND-INITIAL-MAP.
  2779
  2780     MOVE EIBTIME                    TO TIME-IN.
  2781
  2782     MOVE EMI-MESSAGE-AREA (1)       TO ERMESGO.
  2783     MOVE WS-CURRENT-DT              TO DATEO.
  2784     MOVE TIME-OUT                   TO TIMEO.
  2785
  2786
  2787
  2788* EXEC CICS SEND
  2789*        MAP      (EL856A)
  2790*        MAPSET   (MAPSET-EL856S)
  2791*        FROM     (EL856AI)
  2792*        ERASE
  2793*        CURSOR
  2794*    END-EXEC.
  2795     MOVE LENGTH OF
  2796      EL856AI
  2797       TO DFHEIV12
  2798     MOVE -1
  2799       TO DFHEIV11
  2800*    MOVE '8$     CT  E    H L F ,   #00002457' TO DFHEIV0
  2801     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2802     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2803     MOVE X'2020233030303032343537' TO DFHEIV0(25:11)
  2804     CALL 'kxdfhei1' USING DFHEIV0,
  2805           EL856A,
  2806           EL856AI,
  2807           DFHEIV12,
  2808           MAPSET-EL856S,
  2809           DFHEIV99,
  2810           DFHEIV99,
  2811           DFHEIV99,
  2812           DFHEIV11,
  2813           DFHEIV99,
  2814           DFHEIV99,
  2815           DFHEIV99
  2816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2817
  2818
  2819     GO TO 9100-RETURN-TRAN.
  2820
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL856.cbl
  2822
  2823******************************************************************
  2824*                                                                *
  2825*              S E N D    D A T A O N L Y                        *
  2826*                                                                *
  2827******************************************************************
  2828
  2829 8200-SEND-DATAONLY.
  2830
  2831     MOVE EIBTIME                TO TIME-IN.
  2832
  2833     MOVE EMI-MESSAGE-AREA (1)       TO ERMESGO.
  2834     MOVE WS-CURRENT-DT              TO DATEO.
  2835     MOVE TIME-OUT                   TO TIMEO.
  2836     MOVE -1                         TO SUMCODEL.
  2837
  2838
  2839* EXEC CICS SEND
  2840*         MAP      (EL856A)
  2841*         MAPSET   (MAPSET-EL856S)
  2842*         FROM     (EL856AI)
  2843*         DATAONLY
  2844*         CURSOR
  2845*    END-EXEC.
  2846     MOVE LENGTH OF
  2847      EL856AI
  2848       TO DFHEIV12
  2849     MOVE -1
  2850       TO DFHEIV11
  2851*    MOVE '8$D    CT       H L F ,   #00002484' TO DFHEIV0
  2852     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2853     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2854     MOVE X'2020233030303032343834' TO DFHEIV0(25:11)
  2855     CALL 'kxdfhei1' USING DFHEIV0,
  2856           EL856A,
  2857           EL856AI,
  2858           DFHEIV12,
  2859           MAPSET-EL856S,
  2860           DFHEIV99,
  2861           DFHEIV99,
  2862           DFHEIV99,
  2863           DFHEIV11,
  2864           DFHEIV99,
  2865           DFHEIV99,
  2866           DFHEIV99
  2867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2868
  2869
  2870     GO TO 9100-RETURN-TRAN.
  2871
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL856.cbl
  2873
  2874 8300-SEND-TEXT.
  2875
  2876* EXEC CICS SEND TEXT
  2877*        FROM     (LOGOFF-TEXT)
  2878*        LENGTH   (LOGOFF-LENGTH)
  2879*        ERASE
  2880*        FREEKB
  2881*    END-EXEC.
  2882*    MOVE '8&      T  E F  H   F -   #00002497' TO DFHEIV0
  2883     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2884     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2885     MOVE X'2020233030303032343937' TO DFHEIV0(25:11)
  2886     CALL 'kxdfhei1' USING DFHEIV0,
  2887           LOGOFF-TEXT,
  2888           LOGOFF-LENGTH,
  2889           DFHEIV99,
  2890           DFHEIV99,
  2891           DFHEIV99,
  2892           DFHEIV99,
  2893           DFHEIV99,
  2894           DFHEIV99,
  2895           DFHEIV99,
  2896           DFHEIV99,
  2897           DFHEIV99,
  2898           DFHEIV99
  2899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2900
  2901
  2902
  2903* EXEC CICS RETURN
  2904*    END-EXEC.
  2905*    MOVE '.(                    &   #00002504' TO DFHEIV0
  2906     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2907     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2908     MOVE X'2020233030303032353034' TO DFHEIV0(25:11)
  2909     CALL 'kxdfhei1' USING DFHEIV0,
  2910           DFHEIV99,
  2911           DFHEIV99,
  2912           DFHEIV99,
  2913           DFHEIV99,
  2914           DFHEIV99
  2915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2916
  2917
  2918
  2919 8400-LOG-JOURNAL-RECORD.
  2920     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  2921     MOVE THIS-PGM                TO JP-PROGRAM-ID.
  2922
  2923*    EXEC CICS JOURNAL
  2924*        JFILEID     (PI-JOURNAL-FILE-ID)
  2925*        JTYPEID     ('EL')
  2926*        FROM        (JOURNAL-RECORD)
  2927*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
  2928*        END-EXEC.
  2929
  2930 8500-DATE-CONVERT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL856.cbl
  2931
  2932* EXEC CICS LINK
  2933*        PROGRAM  (LINK-ELDATCV)
  2934*        COMMAREA (DATE-CONVERSION-DATA)
  2935*        LENGTH   (DC-COMM-LENGTH)
  2936*    END-EXEC.
  2937*    MOVE '."C                   ''   #00002520' TO DFHEIV0
  2938     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2940     MOVE X'2020233030303032353230' TO DFHEIV0(25:11)
  2941     CALL 'kxdfhei1' USING DFHEIV0,
  2942           LINK-ELDATCV,
  2943           DATE-CONVERSION-DATA,
  2944           DC-COMM-LENGTH,
  2945           DFHEIV99,
  2946           DFHEIV99,
  2947           DFHEIV99
  2948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2949
  2950
  2951 8500-EXIT.
  2952     EXIT.
  2953
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL856.cbl
  2955
  2956 8800-UNAUTHORIZED-ACCESS.
  2957     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  2958     GO TO 8300-SEND-TEXT.
  2959
  2960 8810-PF23.
  2961     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  2962     MOVE XCTL-EL005             TO PGM-NAME.
  2963     GO TO 9300-XCTL.
  2964
  2965 9200-RETURN-MAIN-MENU.
  2966     MOVE XCTL-EL626             TO PGM-NAME.
  2967     GO TO 9300-XCTL.
  2968
  2969 9000-RETURN-CICS.
  2970
  2971* EXEC CICS RETURN
  2972*    END-EXEC.
  2973*    MOVE '.(                    &   #00002545' TO DFHEIV0
  2974     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2975     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2976     MOVE X'2020233030303032353435' TO DFHEIV0(25:11)
  2977     CALL 'kxdfhei1' USING DFHEIV0,
  2978           DFHEIV99,
  2979           DFHEIV99,
  2980           DFHEIV99,
  2981           DFHEIV99,
  2982           DFHEIV99
  2983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2984
  2985
  2986 9100-RETURN-TRAN.
  2987
  2988     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  2989     MOVE '852A'                 TO PI-CURRENT-SCREEN-NO.
  2990
  2991
  2992* EXEC CICS RETURN
  2993*        TRANSID    (TRANS-EXJ8)
  2994*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2995*        LENGTH     (PI-COMM-LENGTH)
  2996*    END-EXEC.
  2997*    MOVE '.(CT                  &   #00002553' TO DFHEIV0
  2998     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2999     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3000     MOVE X'2020233030303032353533' TO DFHEIV0(25:11)
  3001     CALL 'kxdfhei1' USING DFHEIV0,
  3002           TRANS-EXJ8,
  3003           PROGRAM-INTERFACE-BLOCK,
  3004           PI-COMM-LENGTH,
  3005           DFHEIV99,
  3006           DFHEIV99
  3007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3008
  3009
  3010 9300-XCTL.
  3011
  3012* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL856.cbl
  3013*        PROGRAM    (PGM-NAME)
  3014*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3015*        LENGTH     (PI-COMM-LENGTH)
  3016*    END-EXEC.
  3017*    MOVE '.$C                   $   #00002560' TO DFHEIV0
  3018     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3019     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3020     MOVE X'2020233030303032353630' TO DFHEIV0(25:11)
  3021     CALL 'kxdfhei1' USING DFHEIV0,
  3022           PGM-NAME,
  3023           PROGRAM-INTERFACE-BLOCK,
  3024           PI-COMM-LENGTH
  3025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3026
  3027
  3028 9400-CLEAR.
  3029     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
  3030     GO TO 9300-XCTL.
  3031
  3032 9500-PF12.
  3033     MOVE XCTL-EL010             TO PGM-NAME.
  3034     GO TO 9300-XCTL.
  3035
  3036 9600-PGMID-ERROR.
  3037
  3038
  3039* EXEC CICS HANDLE CONDITION
  3040*        PGMIDERR    (8300-SEND-TEXT)
  3041*    END-EXEC.
  3042*    MOVE '"$L                   ! + #00002576' TO DFHEIV0
  3043     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3044     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3045     MOVE X'2B20233030303032353736' TO DFHEIV0(25:11)
  3046     CALL 'kxdfhei1' USING DFHEIV0
  3047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3048
  3049
  3050     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  3051     MOVE ' '                    TO PI-ENTRY-CD-1.
  3052     MOVE XCTL-EL005             TO PGM-NAME.
  3053     MOVE PGM-NAME               TO LOGOFF-PGM.
  3054     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  3055     GO TO 9300-XCTL.
  3056
  3057 9900-ERROR-FORMAT.
  3058
  3059     IF NOT EMI-ERRORS-COMPLETE
  3060         MOVE LINK-EL001         TO PGM-NAME
  3061
  3062* EXEC CICS LINK
  3063*            PROGRAM    (PGM-NAME)
  3064*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3065*            LENGTH     (EMI-COMM-LENGTH)
  3066*        END-EXEC.
  3067*    MOVE '."C                   ''   #00002591' TO DFHEIV0
  3068     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3069     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3070     MOVE X'2020233030303032353931' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL856.cbl
  3071     CALL 'kxdfhei1' USING DFHEIV0,
  3072           PGM-NAME,
  3073           ERROR-MESSAGE-INTERFACE-BLOCK,
  3074           EMI-COMM-LENGTH,
  3075           DFHEIV99,
  3076           DFHEIV99,
  3077           DFHEIV99
  3078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3079
  3080
  3081 9900-EXIT.
  3082     EXIT.
  3083
  3084 9990-ABEND.
  3085     MOVE LINK-EL004             TO PGM-NAME.
  3086     MOVE DFHEIBLK               TO EMI-LINE1.
  3087
  3088* EXEC CICS LINK
  3089*        PROGRAM   (PGM-NAME)
  3090*        COMMAREA  (EMI-LINE1)
  3091*        LENGTH    (72)
  3092*    END-EXEC.
  3093     MOVE 72
  3094       TO DFHEIV11
  3095*    MOVE '."C                   ''   #00002603' TO DFHEIV0
  3096     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3097     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3098     MOVE X'2020233030303032363033' TO DFHEIV0(25:11)
  3099     CALL 'kxdfhei1' USING DFHEIV0,
  3100           PGM-NAME,
  3101           EMI-LINE1,
  3102           DFHEIV11,
  3103           DFHEIV99,
  3104           DFHEIV99,
  3105           DFHEIV99
  3106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3107
  3108
  3109     MOVE -1                     TO PFENTERL.
  3110
  3111     GO TO 8200-SEND-DATAONLY.
  3112
  3113
  3114* GOBACK.
  3115     MOVE '9%                    "   ' TO DFHEIV0
  3116     MOVE 'EL856' TO DFHEIV1
  3117     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3118     GOBACK.
  3119
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL856.cbl
  3121
  3122 9995-SECURITY-VIOLATION.
  3123*                            COPY ELCSCTP.
  3124******************************************************************
  3125*                                                                *
  3126*                            ELCSCTP                             *
  3127*                            VMOD=2.001                          *
  3128*                                                                *
  3129*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3130******************************************************************
  3131
  3132
  3133     MOVE EIBDATE          TO SM-JUL-DATE.
  3134     MOVE EIBTRMID         TO SM-TERMID.
  3135     MOVE THIS-PGM         TO SM-PGM.
  3136     MOVE EIBTIME          TO TIME-IN.
  3137     MOVE TIME-OUT         TO SM-TIME.
  3138     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3139
  3140
  3141* EXEC CICS LINK
  3142*         PROGRAM  ('EL003')
  3143*         COMMAREA (SECURITY-MESSAGE)
  3144*         LENGTH   (80)
  3145*    END-EXEC.
  3146     MOVE 'EL003' TO DFHEIV1
  3147     MOVE 80
  3148       TO DFHEIV11
  3149*    MOVE '."C                   ''   #00002635' TO DFHEIV0
  3150     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3151     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3152     MOVE X'2020233030303032363335' TO DFHEIV0(25:11)
  3153     CALL 'kxdfhei1' USING DFHEIV0,
  3154           DFHEIV1,
  3155           SECURITY-MESSAGE,
  3156           DFHEIV11,
  3157           DFHEIV99,
  3158           DFHEIV99,
  3159           DFHEIV99
  3160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3161
  3162
  3163******************************************************************
  3164
  3165
  3166 9995-EXIT.
  3167     EXIT.
  3168
  3169
  3170 9999-DFHBACK SECTION.
  3171     MOVE '9%                    "   ' TO DFHEIV0
  3172     MOVE 'EL856' TO DFHEIV1
  3173     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3174     GOBACK.
  3175 9999-DFHEXIT.
  3176     IF DFHEIGDJ EQUAL 0001
  3177         NEXT SENTENCE
  3178     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL856.cbl
  3179         GO TO 9600-PGMID-ERROR,
  3180               9990-ABEND
  3181         DEPENDING ON DFHEIGDI
  3182     ELSE IF DFHEIGDJ EQUAL 3
  3183         GO TO 2080-SUMMARY-NOTFND
  3184         DEPENDING ON DFHEIGDI
  3185     ELSE IF DFHEIGDJ EQUAL 4
  3186         GO TO 3080-REQUEST-NOTFND
  3187         DEPENDING ON DFHEIGDI
  3188     ELSE IF DFHEIGDJ EQUAL 5
  3189         GO TO 3060-END-OF-FILE
  3190         DEPENDING ON DFHEIGDI
  3191     ELSE IF DFHEIGDJ EQUAL 6
  3192         GO TO 3180-REQUEST-NOTFND
  3193         DEPENDING ON DFHEIGDI
  3194     ELSE IF DFHEIGDJ EQUAL 7
  3195         GO TO 3160-END-OF-FILE
  3196         DEPENDING ON DFHEIGDI
  3197     ELSE IF DFHEIGDJ EQUAL 8
  3198         GO TO 4180-SUMMARY-NOTFND
  3199         DEPENDING ON DFHEIGDI
  3200     ELSE IF DFHEIGDJ EQUAL 9
  3201         GO TO 4160-END-OF-FILE
  3202         DEPENDING ON DFHEIGDI
  3203     ELSE IF DFHEIGDJ EQUAL 10
  3204         GO TO 4280-SUMMARY-NOTFND
  3205         DEPENDING ON DFHEIGDI
  3206     ELSE IF DFHEIGDJ EQUAL 11
  3207         GO TO 8300-SEND-TEXT
  3208         DEPENDING ON DFHEIGDI.
  3209     MOVE '9%                    "   ' TO DFHEIV0
  3210     MOVE 'EL856' TO DFHEIV1
  3211     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3212     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4952     Code:        7131
