00001 ******************************************************************04/22/98
00002 *                                                                *ELC50PD
00003 *                            ELC50PD                             *   LV012
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
00005 *                            VMOD=2.188                          *   CL**7
00006 *                                                                *ELC50PD
122002******************************************************************
122002*                   C H A N G E   L O G
122002*
122002* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
122002*-----------------------------------------------------------------
122002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
122002* EFFECTIVE    NUMBER
122002*-----------------------------------------------------------------
122002* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING  
123102* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
082003* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
082003*                             2709 AND 2718
082203* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
100703* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
011904* 011904                   PEMA  ADD TOTAL FEE PROCESSING
033104* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
062904* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
062904*                                IS OPEN OR CNC DT < PD THRU
111504* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
121304* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
011305* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
061405* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
070705* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
071305* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
080805* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
083005* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
092205* 092205  CR2005050300006  PEMA  ADD SPP LEASES
093005* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
020906* 020906                   PEMA  EXPAND LOAN OFFICER
042106* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
050506* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
052306* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
081606* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
083106* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
101706* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
102706* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
030807* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
040407* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
061207* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
062707* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
062907* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
073107* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
122807* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
040708* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
050508* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
072308* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
090408* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
090408* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
102908* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST PMT
012909* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUMS
030309* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
030509* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
042709* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
050509* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
050509*                                UPDATE VIN ON CERT TRAILER
061009* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
072109* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISAB ONLY
072209* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
101509* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
011410* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
022210* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
022510* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONLY
040610* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
041310* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
042310* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
071910* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
080310* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
091610* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
111610* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
012711* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
020711* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
020711* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
031611* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
031611* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
031811* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
040811* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
041811* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
050311* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
071211* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
071311* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
072111* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
083111* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
092311* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
110811* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
112911* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
120511* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
030612* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
032912* 032912  CR2011110200001  PEMA  AHL CHANGES
040512* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
041012* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
042012* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
080712* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
091012* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
111212* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
112612* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
010713* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
011513* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
012213* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
022513* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
00007 ******************************************************************ELC50PD
00008 ************* PROCEDURE DIVISION FOR EL050 & EL517 ***************ELC50PD
00009 ******************************************************************ELC50PD
00010                                                                   ELC50PD
00011      INITIALIZE  WS-CRI-SSN-WORK-AREA.                            ELC50PD
00012                                                                   ELC50PD
00013      MOVE SPACES                 TO PB-FATAL-FLAG                 ELC50PD
00014                                     PB-FORCE-ER-CD                ELC50PD
00015                                     PB-WARN-ER-CD                 ELC50PD
00016                                     PB-OUT-BAL-CD.                ELC50PD
00017                                                                   ELC50PD
00018      MOVE SPACE                  TO WS-IG-OVRD-AH                 ELC50PD
00019                                     WS-IG-OVRD-LF                 ELC50PD
00020                                     WS-IG-OVRD-AM                 ELC50PD
00021                                     WS-IG-OVRD                    ELC50PD
00022                                     WS-IG-OVRD-AH-PL              ELC50PD
00023                                     WS-IG-OVRD-LF-PL              ELC50PD
00024                                     WS-IG-OVRD-AH-BEN             ELC50PD
00025                                     WS-IG-OVRD-LF-BEN.            ELC50PD
00026                                                                   ELC50PD
00027 ******************************************************************ELC50PD
00028 *************       INITIALIZE COMMON ERRORS       ***************ELC50PD
00029 ******************************************************************ELC50PD
00030                                                                   ELC50PD
00031      MOVE +0                     TO PB-NO-OF-ERRORS.              ELC50PD
00032      MOVE LOW-VALUES             TO PB-COMMON-ERRORS.             ELC50PD
00033                                                                   ELC50PD
00034 ******************************************************************ELC50PD
00035                                                                   ELC50PD
00036      MOVE EIBDATE                TO DC-JULIAN-DATE.               ELC50PD
00037      SET JULIAN-TO-BIN           TO TRUE.                         ELC50PD
00038 *    MOVE 5                      TO DC-OPTION-CODE.               ELC50PD
00039      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
00040      MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.            ELC50PD
00041                                                                   ELC50PD
00042      MOVE ZERO                   TO  SUB4.                        ELC50PD
00043                                                                   ELC50PD
00044  0040-INITIALIZE-GA-BILL-DT.                                      ELC50PD
00045                                                                   ELC50PD
00046      ADD +1                      TO  SUB4.                        ELC50PD
00047                                                                   ELC50PD
00048      IF  SUB4 GREATER THAN +5                                     ELC50PD
00049          GO TO 0050-CHECK-CNTL-FOUND.                             ELC50PD
00050                                                                   ELC50PD
00051      IF  PB-GA-BILL-DT (SUB4) = SPACES                            ELC50PD
00052          MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).        ELC50PD
00053                                                                   ELC50PD
00054      GO TO 0040-INITIALIZE-GA-BILL-DT.                            ELC50PD
00055                                                                   ELC50PD
00056  0050-CHECK-CNTL-FOUND.                                           ELC50PD
00057                                                                   ELC50PD
00058      IF WK-CNTL-RECORD-FOUND-SW = 'Y'                             ELC50PD
00059         MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC      ELC50PD
00060                                          WS-AH-REM-TERM-CALC      ELC50PD
00061                                          EC-CO-REM-TERM-CALC      ELC50PD
00062         MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD            ELC50PD
00063         MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP          ELC50PD
00064         MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM          ELC50PD
00065                                          WS-TOL-AH-CLAIM          ELC50PD
00066         MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM           ELC50PD
00067                                          WS-TOL-AH-PREM           ELC50PD
00068                                          EC-CO-TOL-PREM           ELC50PD
00069         MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND         ELC50PD
00070                                          WS-TOL-AH-REFUND         ELC50PD
00071                                          EC-CO-TOL-REFUND         ELC50PD
00072         MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT     ELC50PD
00073                                          WS-AH-REFUND-OVS-AMT     ELC50PD
00074                                          EC-CO-OVR-SHT-AMT        ELC50PD
00075         MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT       ELC50PD
00076                                          WS-TOL-AH-PREM-PCT       ELC50PD
00077                                          EC-CO-TOL-PREM-PCT       ELC50PD
00078         MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT     ELC50PD
00079                                          WS-TOL-AH-REFUND-PCT     ELC50PD
00080                                          EC-CO-TOL-REFUND-PCT     ELC50PD
00081         MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT     ELC50PD
00082                                          WS-AH-REFUND-OVS-PCT     ELC50PD
00083                                          EC-CO-OVR-SHT-PCT        ELC50PD
00084         MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW         ELC50PD
00085         MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW        ELC50PD
00086         MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS  ELC50PD
00087         MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM        ELC50PD
00088         MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM           ELC50PD
00089         MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM           ELC50PD
00090         MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE            ELC50PD
00091         MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR           ELC50PD
00092         MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG       ELC50PD
00093         MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG        ELC50PD
00094         MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION   ELC50PD
00095         MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END     ELC50PD
00096                                          EC-CO-MONTH-END-DT       ELC50PD
00097         MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT        ELC50PD
00098           GO TO 0100-READ-ACCT.                                   ELC50PD
00099                                                                   ELC50PD
00100      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
00101      MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
00102      MOVE '1'                    TO CNTL-REC-TYPE.                ELC50PD
00103      MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
00104                                                                   ELC50PD
00105      MOVE '1' TO RC-SW-1.                                         ELC50PD
00106      PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
00107      IF NOT CF-COMPANY-MASTER                                     ELC50PD
00108          MOVE ZEROS             TO WK-CO-TOL-PREM                 ELC50PD
00109                                    WK-CO-TOL-CLAIM                ELC50PD
00110                                    WK-CO-TOL-REFUND               ELC50PD
00111                                    WK-REFUND-OVS-AMT              ELC50PD
00112                                    WK-REFUND-OVS-PCT              ELC50PD
00113                                    WK-CO-TOL-PREM-PCT             ELC50PD
00114                                    WK-CO-TOL-REFUND-PCT           ELC50PD
00115                                    WK-DEFAULT-APR                 ELC50PD
00116                                    WK-CO-MAX-CAP                  ELC50PD
00117         MOVE SPACES             TO WK-CR-REM-TERM-CALC            ELC50PD
00118                                    WK-CR-R78-METHOD               ELC50PD
00119                                    WK-CO-REF-REJECT-SW            ELC50PD
00120                                    WK-CO-PREM-REJECT-SW           ELC50PD
00121                                    WK-REM-TRM-CALC-OPTION         ELC50PD
00122                                    WK-BIRTH-DATE-INPUT            ELC50PD
00123                                    WK-JOINT-AGE-INPUT             ELC50PD
00124         MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT              ELC50PD
00125         MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS        ELC50PD
00126         INITIALIZE    WK-CREDIT-EDIT-CONTROLS                     ELC50PD
00127         MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW        ELC50PD
00128           GO TO 0099-COMPANY-NOT-FOUND.                           ELC50PD
00129                                                                   ELC50PD
00130      IF CF-CO-TOL-PREM-PCT NOT NUMERIC                            ELC50PD
00131         MOVE +0                    TO CF-CO-TOL-PREM-PCT.         ELC50PD
00132      IF CF-CO-TOL-REFUND-PCT NOT NUMERIC                          ELC50PD
00133         MOVE +0                    TO CF-CO-TOL-REFUND-PCT.       ELC50PD
00134      IF CF-CO-TOL-CAP NOT NUMERIC                                 ELC50PD
00135         MOVE +0                    TO CF-CO-TOL-CAP.              ELC50PD
00136      IF CF-DEFAULT-APR NOT NUMERIC                                ELC50PD
00137         MOVE +0                    TO CF-DEFAULT-APR.             ELC50PD
00138                                                                   ELC50PD
00139      MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.        ELC50PD
00140      MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.           ELC50PD
00141      MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.              ELC50PD
00142      MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.            ELC50PD
00143      MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.             ELC50PD
00144      MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.           ELC50PD
00145      MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.       ELC50PD
00146      MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.         ELC50PD
00147      MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.        ELC50PD
00148      MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.       ELC50PD
00149      MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.    ELC50PD
00150      MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.             ELC50PD
00151                                                                   ELC50PD
00152      IF CF-CO-OVR-SHT-AMT NUMERIC AND                             ELC50PD
00153           CF-CO-OVR-SHT-AMT > +0                                  ELC50PD
00154         MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.            ELC50PD
00155                                                                   ELC50PD
00156      IF CF-CO-OVR-SHT-PCT NUMERIC AND                             ELC50PD
00157           CF-CO-OVR-SHT-PCT > +0                                  ELC50PD
00158         MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.            ELC50PD
00159                                                                   ELC50PD
00160      IF CF-VALID-REM-TRM-OPTION                                   ELC50PD
00161          MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION    ELC50PD
00162      ELSE                                                         ELC50PD
00163          MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.     ELC50PD
00164                                                                   ELC50PD
00165      MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.        ELC50PD
00166      MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.         ELC50PD
00167      MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.          ELC50PD
00168      MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.    ELC50PD
00169                                                                   ELC50PD
00170      GO TO 0050-CHECK-CNTL-FOUND.                                 ELC50PD
00171                                                                   ELC50PD
00172  0099-COMPANY-NOT-FOUND.                                          ELC50PD
00173                                                                   ELC50PD
00174      MOVE ER-2616                TO WS-ERROR.                     ELC50PD
00175      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
00176                                                                   ELC50PD
00177  0100-READ-ACCT.                                                  ELC50PD
00178                                                                   ELC50PD
00179      MOVE SPACES                 TO DATE-RANGE-SW.                ELC50PD
00180                                                                   ELC50PD
00181      IF WK-ACCT-ADDR = ZEROS                                      ELC50PD
00182         GO TO 0102-ACCT-GETMAIN.                                  ELC50PD
00183                                                                   ELC50PD
00184      MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.               ELC50PD
00185      SET ERACCT-FILE-ADDRESSED   TO TRUE.                         ELC50PD
00186      PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
00187                                                                   ELC50PD
00188      IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
00189         OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
00190         GO TO 0105-READ-ACCT
           END-IF
00191                                                                   ELC50PD
00192      IF PB-CARRIER NOT = SPACES                                   ELC50PD
00193         IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
00194            GO TO 0105-READ-ACCT.                                  ELC50PD
00195                                                                   ELC50PD
00196      IF PB-STATE NOT = SPACES                                     ELC50PD
00197         IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
00198            GO TO 0105-READ-ACCT.                                  ELC50PD
00199                                                                   ELC50PD
00200      IF PB-GROUPING NOT = SPACES                                  ELC50PD
00201         IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
00202            GO TO 0105-READ-ACCT.                                  ELC50PD
00203                                                                   ELC50PD
00204      MOVE 'X'                 TO DATE-RANGE-SW.                   ELC50PD
00205                                                                   ELC50PD
00206      IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
00207         MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
00208         GO TO 0105-READ-ACCT.                                     ELC50PD
00209                                                                   ELC50PD
00210      IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
00211         GO TO 0105-READ-ACCT.                                     ELC50PD
00212                                                                   ELC50PD
00213      GO TO 0180-ACCOUNT-FOUND.                                    ELC50PD
00214                                                                   ELC50PD
00215  0102-ACCT-GETMAIN.                                               ELC50PD
00216      PERFORM 8560-GETMAIN THRU 8560-EXIT.                         ELC50PD
00217      MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.                 ELC50PD
00218                                                                   ELC50PD
00219  0105-READ-ACCT.                                                  ELC50PD
00220      MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.                 ELC50PD
00221      MOVE PB-CARRIER             TO ACCT-CARRIER.                 ELC50PD
00222      MOVE PB-GROUPING            TO ACCT-GROUPING.                ELC50PD
00223      MOVE PB-STATE               TO ACCT-STATE.                   ELC50PD
00224      MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.                 ELC50PD
00225      MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.                  ELC50PD
00226                                                                   ELC50PD
00227      PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.            ELC50PD
00228                                                                   ELC50PD
00229      MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.         ELC50PD
00230                                                                   ELC50PD
00231  0110-FIND-ACCT-TOLERANCES-LOOP.                                  ELC50PD

00232      PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.             ELC50PD
00233                                                                   ELC50PD
00234      IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
00235         OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
00236         GO TO 0199-ACCT-NOT-FOUND
00237      END-IF
00238      IF PB-CARRIER NOT = SPACES                                   ELC50PD
00239         IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
00240            GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
00241                                                                   ELC50PD
00242      IF PB-STATE NOT = SPACES                                     ELC50PD
00243         IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
00244            GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
00245                                                                   ELC50PD
00246      IF PB-GROUPING NOT = SPACES                                  ELC50PD
00247         IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
00248            GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
00249                                                                   ELC50PD
00250      MOVE 'X'                    TO DATE-RANGE-SW.                ELC50PD
00251                                                                   ELC50PD
00252      IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
00253         MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
00254         GO TO 0199-ACCT-NOT-FOUND.                                ELC50PD
00255                                                                   ELC50PD
00256      IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
00257         GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.                     ELC50PD
00258                                                                   ELC50PD
00259  0180-ACCOUNT-FOUND.                                              ELC50PD

00260      MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
00261      MOVE AM-CARRIER             TO PB-SV-CARRIER.                ELC50PD
00262      MOVE AM-STATE               TO PB-SV-STATE.                  ELC50PD
00263      MOVE AM-GROUPING            TO PB-SV-GROUPING.               ELC50PD
00264                                                                   ELC50PD
00265      IF AM-CANCEL-FEE  NOT NUMERIC                                ELC50PD
00266         MOVE ZEROS TO AM-CANCEL-FEE.                              ELC50PD
00267                                                                   ELC50PD
00268      IF AM-MAX-MON-BEN NOT NUMERIC                                ELC50PD
00269         MOVE ZEROS TO AM-MAX-MON-BEN.                             ELC50PD
00270                                                                   ELC50PD
00271      IF AM-MAX-TOT-BEN NOT NUMERIC                                ELC50PD
00272         MOVE ZEROS TO AM-MAX-TOT-BEN.                             ELC50PD
00273                                                                   ELC50PD
100703     IF AM-CLP-TOL-PCT NOT NUMERIC
100703        MOVE +0                  TO AM-CLP-TOL-PCT
100703     END-IF
092705     IF AM-SPP-LEASE-COMM NOT NUMERIC
092705        MOVE +0                  TO AM-SPP-LEASE-COMM
092705     END-IF
00274      IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
00275         MOVE ER-2611             TO   WS-ERROR                    ELC50PD
00276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
00277                                                                   ELC50PD
00278      IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
00279         MOVE ER-2621             TO   WS-ERROR                    ELC50PD
00280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
00281                                                                   ELC50PD
00282      IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)                      ELC50PD
00283         AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)               ELC50PD
00284         AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)                    ELC50PD
00285         AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)                      ELC50PD
00286          MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.            ELC50PD
00287                                                                   ELC50PD
00288      MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.         ELC50PD
00289      MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.           ELC50PD
00290      MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.         ELC50PD
00291      MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.           ELC50PD
100703     IF AM-CLP-TOL-PCT NOT = ZEROS
100703        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
100703     END-IF
092705     IF AM-SPP-LEASE-COMM NOT = ZEROS
092705        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
092705     END-IF




      *    IF PB-COMPANY-ID = 'DCC'
      *       MOVE +0                  TO WS-ACCT-ADDL-CLP
062707*                                   WS-ADMIN-FEES
      *       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
      *          (SUB5 > +10)
052306*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
      *             AND (AM-A-COM (SUB5) NUMERIC)
      *             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
      *                + (AM-A-COM (SUB5) * 1000)
062707*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
062707*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
052306*                + (AM-A-COM (SUB5) * 1000)
052306*             END-IF
      *             IF AM-COM-TYP (SUB5) = 'N'
      *                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
      *                + (AM-A-COM (SUB5) * 1000)
      *             END-IF
      *          END-IF
      *       END-PERFORM
      *    END-IF

071211     IF (PB-COMPANY-ID = 'DCC')
              AND (PB-ISSUE)
071211        MOVE +0                  TO WS-ACCT-ADDL-CLP
071211        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
071211           (SUB5 > +10)
071211           MOVE +0 TO WS-WK-RATE
071211           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
071211              IF (AM-A-COM (SUB5) NUMERIC)
071211                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
071211                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
071211              ELSE
071211                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
071211                 IF PB-ISSUE
071211                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
071211                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
071211                 ELSE
071211                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
071211                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
071211                 END-IF
071211                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
071211                 MOVE ZEROS             TO WS-SUB1
071211                                           WS-COMMISSION
071211                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
                       MOVE '0530'               TO CTBL-SW
                       MOVE ' '                  TO WS-CTBL-READ-SW
071211                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
                       IF FIRST-TIME-THROUGH
                          MOVE 'AA'              TO CTBL-BEN-CODE
                          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
                       END-IF
071211                 IF CTBL-TABLE-FOUND                                
071211                    IF PB-ISSUE
071211                       COMPUTE WS-COMM-CK-AMT =
071211                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
071211                    ELSE
071211                       COMPUTE WS-COMM-CK-AMT =
071211                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
071211                    END-IF
071211                    PERFORM 8800-GET-COMP-RATE
071211                              THRU 8800-EXIT
071211                 END-IF
071211              END-IF
071211              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
071211                + (WS-WK-RATE * 1000)
071211           END-IF
071211        END-PERFORM
071211     END-IF

00293      IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
00294          MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.           ELC50PD
00295                                                                   ELC50PD
00296      IF PB-COMPANY-ID EQUAL 'NCL'                                 ELC50PD
00297          MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
           END-IF
00298                                                                   ELC50PD
00299      GO TO 0200-READ-CERT.                                        ELC50PD
00300                                                                   ELC50PD
00301  0199-ACCT-NOT-FOUND.                                             ELC50PD
00302                                                                   ELC50PD
00303      MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
00304                                                                   ELC50PD
00305      IF DATE-RANGE-SW NOT = SPACES                                ELC50PD
00306         MOVE ER-2601             TO WS-ERROR                      ELC50PD
00307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
00308      ELSE                                                         ELC50PD
00309         MOVE ER-2619             TO WS-ERROR                      ELC50PD
00310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
00311                                                                   ELC50PD
00312      GO TO 9990-RETURN.                                           ELC50PD
00313                                                                   ELC50PD
00314  0200-READ-CERT.                                                  ELC50PD
00315                                                                   ELC50PD
00316      MOVE PB-COMPANY-CD          TO CERT-COMP-CD.                 ELC50PD
00317      MOVE PB-SV-CARRIER          TO CERT-CARRIER.                 ELC50PD
00318      MOVE PB-SV-GROUPING         TO CERT-GROUPING.                ELC50PD
00319      MOVE PB-SV-STATE            TO CERT-STATE.                   ELC50PD
00320      MOVE PB-ACCOUNT             TO CERT-ACCOUNT.                 ELC50PD
00321      MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.                  ELC50PD
00322      MOVE PB-CERT-NO             TO CERT-CERT-NO.                 ELC50PD
00323                                                                   ELC50PD
00324      PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.                ELC50PD
00325                                                                   ELC50PD
00326      IF CERT-WAS-NOT-FOUND                                        ELC50PD
00327         GO TO 0299-CERT-NOT-FOUND.                                ELC50PD
00328                                                                   ELC50PD
00329      IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION            ELC50PD
00330         MOVE ER-2759             TO WS-ERROR                      ELC50PD
00331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
00332         GO TO 0298-UNLOCK-RETURN.                                 ELC50PD
00333                                                                   ELC50PD
00334      IF CERT-PURGED-OFFLINE AND PB-CANCELLATION                   ELC50PD
00335          MOVE ER-2758            TO WS-ERROR                      ELC50PD
00336          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
00337          GO TO 0298-UNLOCK-RETURN.                                ELC50PD
00338                                                                   ELC50PD
00339      IF PB-ISSUE                                                  ELC50PD
00340         IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')           ELC50PD
00341            IF CERT-WAS-CREATED-FOR-CLAIM                          ELC50PD
00342               NEXT SENTENCE                                       ELC50PD
00343             ELSE                                                  ELC50PD
00344               MOVE ER-2626       TO WS-ERROR                      ELC50PD
00345               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
00346               GO TO 0298-UNLOCK-RETURN.                           ELC50PD
00347                                                                   ELC50PD
00348      IF NOT PB-CANCELLATION                                       ELC50PD
00349         GO TO 0300-CONTINUE-EDIT.                                 ELC50PD
00350                                                                   ELC50PD
00351      MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.             ELC50PD
00352      MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.              ELC50PD
072209     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
00353      MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.           ELC50PD
00354      MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.           ELC50PD
00355      MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.            ELC50PD
00356                                                                   ELC50PD
00357      MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.               ELC50PD
00358      MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.         ELC50PD
00359      MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.        ELC50PD
00360      MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.        ELC50PD
00361      MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.    ELC50PD
00362      MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.    ELC50PD
00363      MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.           ELC50PD
00364      MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.           ELC50PD
00365      MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.       ELC50PD
00366                                                                   ELC50PD
00367      MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.               ELC50PD
00368      MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.         ELC50PD
00369      MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.        ELC50PD
00370      MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.        ELC50PD
00371      MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.           ELC50PD
00372      MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.           ELC50PD
00373      MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.       ELC50PD
00374                                                                   ELC50PD
00375      MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.            ELC50PD
00376      MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.               ELC50PD
00377                                                                   ELC50PD
00378      MOVE CM-CREDIT-INTERFACE-SW-1                                ELC50PD
00379                                   TO PB-CI-CREDIT-INTERFACE-SW-1. ELC50PD
00380      MOVE CM-CREDIT-INTERFACE-SW-2                                ELC50PD
00381                                   TO PB-CI-CREDIT-INTERFACE-SW-2. ELC50PD
00382                                                                   ELC50PD
00383      IF CM-O-B-COVERAGE                                           ELC50PD
00384          MOVE 'B'                 TO PB-CI-OB-FLAG.               ELC50PD
00385                                                                   ELC50PD
00386      IF CM-LIVES NOT NUMERIC                                      ELC50PD
00387          MOVE ZERO                TO CM-LIVES.                    ELC50PD
00388                                                                   ELC50PD
00389      IF CM-BILLED NOT NUMERIC                                     ELC50PD
00390          MOVE ZERO                TO CM-BILLED.                   ELC50PD
00391                                                                   ELC50PD
00392      IF CM-CREDIT-INTERFACE-SW-2 = SPACE                          ELC50PD
00393          MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS      ELC50PD
00394          MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS      ELC50PD
00395          MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT    ELC50PD
00396          MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT    ELC50PD
00397          MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT         ELC50PD
00398          MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.        ELC50PD
00399          MOVE CM-LIVES             TO PB-CI-LIVES                 ELC50PD
072209*The next line causes a problem with my change  I dont think it is needed
072209*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.     ELC50PD
00401                                                                   ELC50PD
00402      MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.      ELC50PD
00403      MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.      ELC50PD
00404      MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.      ELC50PD
00405      MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.      ELC50PD
00406      MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.         ELC50PD
00407      MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.         ELC50PD
00408                                                                   ELC50PD
00409      MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.             ELC50PD
00410      MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.             ELC50PD
00411      MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.     ELC50PD
00412      MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.      ELC50PD
00413                                                                   ELC50PD
00414      IF CM-LIFE-COMM-PCT NUMERIC                                  ELC50PD
00415          MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION         ELC50PD
00416      ELSE                                                         ELC50PD
00417          MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.        ELC50PD
00418                                                                   ELC50PD
00419      IF CM-AH-COMM-PCT NUMERIC                                    ELC50PD
00420          MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION           ELC50PD
00421      ELSE                                                         ELC50PD
00422          MOVE ZEROS              TO PB-CI-AH-COMMISSION.          ELC50PD
00423                                                                   ELC50PD
00424      MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.         ELC50PD
00425                                                                   ELC50PD
00426      IF CM-LOAN-APR       NOT NUMERIC                             ELC50PD
00427            MOVE ZERO               TO CM-LOAN-APR.                ELC50PD
00428                                                                   ELC50PD
00429      IF CM-PAY-FREQUENCY  NOT NUMERIC                             ELC50PD
00430            MOVE ZERO               TO CM-PAY-FREQUENCY.           ELC50PD
00431                                                                   ELC50PD
00432      IF CM-LOAN-TERM      NOT NUMERIC                             ELC50PD
00433            MOVE ZERO               TO CM-LOAN-TERM.               ELC50PD
00434                                                                   ELC50PD
00435      IF CM-LF-TERM-IN-DAYS   NOT NUMERIC                          ELC50PD
00436            MOVE ZERO               TO CM-LF-TERM-IN-DAYS.         ELC50PD
00437                                                                   ELC50PD
00438      IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC                        ELC50PD
00439            MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.      ELC50PD
00440                                                                   ELC50PD
00441      MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.        ELC50PD
00442      MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.             ELC50PD
00443      MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.            ELC50PD
00444      MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.         ELC50PD
00445      MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.       ELC50PD
00446      MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.         ELC50PD
00447      MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.         ELC50PD
00448      MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.      ELC50PD
00449      MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.             ELC50PD
00450      MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.          ELC50PD
00451      MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.         ELC50PD
00452      MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD           ELC50PD
00453                                                                   ELC50PD
00454      IF CM-STATE = CM-SSN-STATE                                   ELC50PD
00455          MOVE SPACES               TO PB-CI-SOC-SEC-NO.           ELC50PD
00456                                                                   ELC50PD
00457      IF CM-STATE NOT = CM-MEMB-STATE                              ELC50PD
00458          MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.            ELC50PD
00459                                                                   ELC50PD
00460      MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.         ELC50PD
00461                                                                   ELC50PD
100703     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
00463         MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
040504        IF CM-ADDL-CLP NOT NUMERIC
040504           MOVE +0               TO CM-ADDL-CLP
040504        END-IF
040504        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
071211        IF AM-DCC-PRODUCT-CODE = 'DDF'
071211           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
071211        END-IF
040504     END-IF

071211     IF PB-COMPANY-ID = 'DCC'
071211        MOVE +0                  TO WS-ADMIN-FEES
                                          WS-CSO-ADMIN-FEE
                                          WS-COMM-AND-MFEE
071211                                    WS-1ST-YR-ALLOW
071211        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
071211           (SUB5 > +10)
071211           MOVE +0 TO WS-WK-RATE
071211           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
071211              IF (AM-A-COM (SUB5) NUMERIC)
071211                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
071211                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
071211              ELSE
071211                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
071211                 IF PB-ISSUE
071211                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
071211                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
071211                 ELSE
071211                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
071211                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
071211                 END-IF
071211                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
071211                 MOVE ZEROS             TO WS-SUB1
071211                                           WS-COMMISSION
071211                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
                       MOVE '0530'               TO CTBL-SW
                       MOVE ' '                  TO WS-CTBL-READ-SW
071211                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
                       IF FIRST-TIME-THROUGH
                          MOVE 'AA'              TO CTBL-BEN-CODE
                          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
                       END-IF
071211                 IF CTBL-TABLE-FOUND                                
071211                    IF PB-ISSUE
071211                       COMPUTE WS-COMM-CK-AMT =
071211                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
071211                    ELSE
071211                       COMPUTE WS-COMM-CK-AMT =
071211                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
071211                    END-IF
071211                    PERFORM 8800-GET-COMP-RATE
071211                              THRU 8800-EXIT
071211                 END-IF
071211              END-IF
071211              IF AM-COM-TYP (SUB5) = 'I'
071211                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
071211                   + (WS-WK-RATE * 1000)
071211              END-IF
071211              IF AM-COM-TYP (SUB5) = 'N'
071211                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
071211                   + (WS-WK-RATE * 1000)
071211              END-IF
071211              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
071211                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
071211                   + (WS-WK-RATE * 1000)
071211              END-IF
071211              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
071211                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
071211                   + (WS-WK-RATE * 1000)
071211              END-IF
071211           END-IF
071211        END-PERFORM
071211     END-IF

00465      GO TO 0300-CONTINUE-EDIT.                                    ELC50PD
00466                                                                   ELC50PD
00467  0298-UNLOCK-RETURN.                                              ELC50PD
00468       PERFORM 9250-UNLOCK-RETURN                                  ELC50PD
00469       GO TO 9990-RETURN.                                          ELC50PD
00470                                                                   ELC50PD
00471  0299-CERT-NOT-FOUND.                                             ELC50PD
00472                                                                   ELC50PD
00473      MOVE '1'                     TO CERT-STATUS-SW.              ELC50PD
00474                                                                   ELC50PD
00475      IF PB-COMPANY-ID = 'UCL'                                     ELC50PD
00476          IF WS-ERROR = ER-2799                                    ELC50PD
00477              GO TO 3000-CONTINUE-EDIT.                            ELC50PD
00478                                                                   ELC50PD
00479      IF NOT PB-CANCELLATION                                       ELC50PD
00480          GO TO 0300-CONTINUE-EDIT.                                ELC50PD
00481                                                                   ELC50PD
00482      MOVE ER-2726                  TO  WS-ERROR.                  ELC50PD
00483      PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.                ELC50PD
00484      MOVE SPACES                 TO PB-CANCELED-CERT-DATA.        ELC50PD
00485      MOVE ZEROS                  TO PB-CI-INSURED-AGE             ELC50PD
00486                                     PB-CI-LF-TERM                 ELC50PD
00487                                     PB-C-LF-REM-TERM              ELC50PD
00488                                     PB-CI-AH-TERM                 ELC50PD
00489                                     PB-C-AH-REM-TERM              ELC50PD
00490                                     PB-CI-LF-BENEFIT-CD           ELC50PD
00491                                     PB-CI-LF-BENEFIT-AMT          ELC50PD
00492                                     PB-CI-LF-ALT-BENEFIT-AMT      ELC50PD
00493                                     PB-CI-LF-PREMIUM-AMT          ELC50PD
00494                                     PB-CI-LF-ALT-PREMIUM-AMT      ELC50PD
00495                                     PB-CI-AH-BENEFIT-CD           ELC50PD
00496                                     PB-CI-AH-BENEFIT-AMT          ELC50PD
00497                                     PB-CI-AH-PREMIUM-AMT          ELC50PD
00498                                     PB-CI-PAY-FREQUENCY           ELC50PD
00499                                     PB-CI-LOAN-APR                ELC50PD
00500                                     PB-CI-LOAN-TERM               ELC50PD
00501                                     PB-CI-LIFE-COMMISSION         ELC50PD
00502                                     PB-CI-AH-COMMISSION           ELC50PD
00503                                     PB-CI-CURR-SEQ                ELC50PD
00504                                     PB-CI-AH-CANCEL-AMT           ELC50PD
00505                                     PB-CI-LF-CANCEL-AMT           ELC50PD
00506                                     PB-CI-RATE-DEV-PCT-LF         ELC50PD
00507                                     PB-CI-RATE-DEV-PCT-AH         ELC50PD
00508                                     PB-CI-EXTENTION-DAYS          ELC50PD
00509                                     PB-CI-TERM-IN-DAYS            ELC50PD
00510                                     PB-CI-LIVES                   ELC50PD
00511                                     PB-CI-LF-CRIT-PER             ELC50PD
00512                                     PB-CI-AH-CRIT-PER
040504                                    PB-CI-ADDL-CLP
071211                                    PB-CI-DDF-IU-RATE-UP.
00513                                                                   ELC50PD
00514      MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT         ELC50PD
00515                                     PB-CI-AH-SETTLEMENT-DT        ELC50PD
00516                                     PB-CI-DEATH-DT                ELC50PD
00517                                     PB-CI-LF-PRIOR-CANCEL-DT      ELC50PD
00518                                     PB-CI-AH-PRIOR-CANCEL-DT      ELC50PD
00519                                     PB-CI-ENTRY-DT                ELC50PD
00520                                     PB-CI-LF-EXPIRE-DT            ELC50PD
00521                                     PB-CI-AH-EXPIRE-DT            ELC50PD
00522                                     PB-CI-LOAN-1ST-PMT-DT.        ELC50PD
00523                                                                   ELC50PD
00524      IF ACCOUNT-MAST-FOUND                                        ELC50PD
00525         MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT               ELC50PD
00526         MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.              ELC50PD
00527                                                                   ELC50PD
00528      GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
00529                                                                   ELC50PD
00530      EJECT                                                        ELC50PD
00531                                                                   ELC50PD
00532  0300-CONTINUE-EDIT.                                              ELC50PD
00533                                                                   ELC50PD
00534      IF PB-ISSUE                                                  ELC50PD
00535         IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
00536             PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.       ELC50PD
00537                                                                   ELC50PD
00538      IF PB-ISSUE                                                  ELC50PD
00539         IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
00540             PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.       ELC50PD
00541                                                                   ELC50PD
00542      IF PB-ISSUE                                                  ELC50PD
00543        IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR                     ELC50PD
00544           (AM-NO-AH-ONLY)                                         ELC50PD
00545            IF PB-I-AH-BENEFIT-CD NOT = ZEROS                      ELC50PD
00546                IF PB-I-LIFE-BENEFIT-CD = ZEROS                    ELC50PD
00547                    MOVE ER-2679 TO WS-ERROR                       ELC50PD
00548                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
00549                                                                   ELC50PD
00550      IF PB-ISSUE                                                  ELC50PD
00551         MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD            ELC50PD
00552         MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD            ELC50PD
00553         MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT              ELC50PD
00554      ELSE                                                         ELC50PD
00555         MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD            ELC50PD
00556         MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD            ELC50PD
00557         MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.             ELC50PD
00558                                                                   ELC50PD
00559      MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
00560                                     PLAN-MASTER-LIFE-SW           ELC50PD
00561                                     FORM-MASTER-SW                ELC50PD
00562                                     WS-APP-CERT-SW.               ELC50PD
00563                                                                   ELC50PD
00564      MOVE ZEROS                  TO WS-PL-TOL-LF-PREM             ELC50PD
00565                                     WS-PL-TOL-LF-REFUND           ELC50PD
00566                                     WS-PL-REF-OVS-AMT             ELC50PD
00567                                     WS-PL-TOL-LF-PREM-PCT         ELC50PD
00568                                     WS-PL-TOL-LF-REFUND-PCT       ELC50PD
00569                                     WS-PL-REF-OVS-PCT             ELC50PD
00570                                     WS-PL-TOL-LF-CLAIM.           ELC50PD
00571                                                                   ELC50PD
00572      IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
00573        IF PB-ISSUE                                                ELC50PD
00574          IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS          ELC50PD
00575              PERFORM  3350-GET-ERFORM   THRU  3350-EXIT           ELC50PD
00576              IF FORM-MASTER-FOUND                                 ELC50PD
00577                  MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.       ELC50PD
00578                                                                   ELC50PD
00579      IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
00580         GO TO 0310-FIND-AH-BENEFIT-RECORD.                        ELC50PD
00581                                                                   ELC50PD
00582 ********************** MON CODE **********************            ELC50PD
00583      IF PB-COMPANY-ID = 'MON'                                     ELC50PD
00584      IF PB-ISSUE                                                  ELC50PD
00585      IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26') ELC50PD
00586         AND (PB-I-LOAN-APR NOT NUMERIC OR                         ELC50PD
00587              PB-I-LOAN-APR = ZERO)                                ELC50PD
00588                MOVE 14.0         TO PB-I-LOAN-APR.                ELC50PD
00589 ******************************************************            ELC50PD
00590                                                                   ELC50PD
00591      IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
00592        IF PB-ISSUE                                                ELC50PD
00593            IF FORM-MASTER-FOUND                                   ELC50PD
00594              IF FO-DISMEMBERMENT-CD = 'Y'  AND                    ELC50PD
00595                 AM-DISMBR-COVERAGE                                ELC50PD
00596                  MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD         ELC50PD
00597                  IF WS-LF-INPUT-CD-1 NOT = 'B'                    ELC50PD
00598                    MOVE '8'            TO  WS-LF-INPUT-CD-1       ELC50PD
00599                    MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD       ELC50PD
00600                                            PB-I-LIFE-BENEFIT-CD.  ELC50PD
00601                                                                   ELC50PD
00602      MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
00603                                                                   ELC50PD
00604      IF WK-LIFE-BEN-ADDR NOT = ZEROS                              ELC50PD
00605          MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP                ELC50PD
00606          SET ELCNTL-FILE-ADDRESSED   TO TRUE                      ELC50PD
00607          PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
00608          PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT          ELC50PD
00609          IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
00610            AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
00611              GO TO 0301-LIFE-BENEFIT-SEARCH                       ELC50PD
00612          ELSE                                                     ELC50PD
00613              NEXT SENTENCE                                        ELC50PD
00614      ELSE                                                         ELC50PD
00615          PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
00616                                                                   ELC50PD
00617      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
00618      MOVE '4'                    TO CNTL-REC-TYPE.                ELC50PD
00619      MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
00620      MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
00621                                                                   ELC50PD
00622      MOVE '1' TO RC-SW-2.                                         ELC50PD
00623      PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
00624                                                                   ELC50PD
00625      IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
00626         (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
00627          GO TO 0305-BENEFIT-NOT-FOUND.                            ELC50PD
00628                                                                   ELC50PD
00629      MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.             ELC50PD
00630                                                                   ELC50PD
00631  0301-LIFE-BENEFIT-SEARCH.                                        ELC50PD
00632                                                                   ELC50PD
00633      PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
00634                                                                   ELC50PD
00635      IF NO-BENEFIT-FOUND                                          ELC50PD
00636         GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
00637                                                                   ELC50PD
00638      IF WS-BEN-CD = '99'                                          ELC50PD
00639         GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
00640                                                                   ELC50PD
00641      IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
00642          IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
00643              GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
00644                                                                   ELC50PD
00645      MOVE +1                     TO SUB5.                         ELC50PD
00646      MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
00647                                                                   ELC50PD
00648 * FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
00649 * BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
00650      IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
00651          MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
00652                                                                   ELC50PD
00653  0302-EDIT-ACCT-LF-BENEFITS.                                      ELC50PD
00654                                                                   ELC50PD
00655      IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1          ELC50PD
00656         IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)                 ELC50PD
00657            MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
00658                                  TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
00659            GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
00660                                                                   ELC50PD
00661      IF SUB5 LESS THAN +20                                        ELC50PD
00662         ADD +1                   TO SUB5                          ELC50PD
00663         GO TO 0302-EDIT-ACCT-LF-BENEFITS.                         ELC50PD
00664                                                                   ELC50PD
00665      MOVE +1                     TO SUB5.                         ELC50PD
00666                                                                   ELC50PD
00667      IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
00668         GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
00669                                                                   ELC50PD
00670  0303-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
00671                                                                   ELC50PD
00672      IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1      ELC50PD
00673         IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)             ELC50PD
00674            MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
00675                                  TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
00676            GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
00677                                                                   ELC50PD
00678      IF SUB5 LESS THAN +30                                        ELC50PD
00679         ADD +1                   TO SUB5                          ELC50PD
00680         GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
00681                                                                   ELC50PD
00682      MOVE +1                     TO SUB5.                         ELC50PD
00683                                                                   ELC50PD
00684  03XX-EDIT-FOR-NINETY-LF.                                         ELC50PD
00685                                                                   ELC50PD
00686 ***************************************************************   ELC50PD
00687 *                                                             *   ELC50PD
00688 *    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
00689 *                                                             *   ELC50PD
00690 *      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
00691 *      92 = ALL GROUP REDUCING BENEFITS                       *   ELC50PD
00692 *      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *   ELC50PD
00693 *      94 = ALL GROUP LEVEL BENEFITS                          *   ELC50PD
00694 *      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
00695 *           BENEFIT CONTROLS.                                 *   ELC50PD
00696 *      99 = ALL BENEFITS                                      *   ELC50PD
00697 *                                                             *   ELC50PD
00698 ***************************************************************   ELC50PD
00699                                                                   ELC50PD
00700      MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
00701                                  TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
00702                                                                   ELC50PD
00703      IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
00704        AND                                                        ELC50PD
00705         (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
00706         GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
00707                                                                   ELC50PD
00708      IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')                       ELC50PD
00709        AND                                                        ELC50PD
00710         (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
00711         IF CF-REDUCING (SUB3)                                     ELC50PD
00712            IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
00713               OR                                                  ELC50PD
00714            ((AM-IG = '1') AND                                     ELC50PD
00715            (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
00716               OR                                                  ELC50PD
00717            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
00718            (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
00719            (AM-IG NOT = '2'))                                     ELC50PD
00720               GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
00721                                                                   ELC50PD
00722      IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')                       ELC50PD
00723        AND                                                        ELC50PD
00724         (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
00725         IF CF-REDUCING (SUB3)                                     ELC50PD
00726            IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
00727               OR                                                  ELC50PD
00728            ((AM-IG = '2') AND                                     ELC50PD
00729            (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
00730               OR                                                  ELC50PD
00731            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
00732            (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
00733            (AM-IG NOT = '1'))                                     ELC50PD
00734               GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
00735                                                                   ELC50PD
00736      IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')                       ELC50PD
00737        AND                                                        ELC50PD
00738         (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
00739         IF CF-LEVEL    (SUB3)                                     ELC50PD
00740            IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
00741               OR                                                  ELC50PD
00742            ((AM-IG = '1') AND                                     ELC50PD
00743            (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
00744               OR                                                  ELC50PD
00745            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
00746            (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
00747             (AM-IG NOT = '2'))                                    ELC50PD
00748               GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
00749                                                                   ELC50PD
00750      IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')                       ELC50PD
00751        AND                                                        ELC50PD
00752         (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
00753         IF CF-LEVEL    (SUB3)                                     ELC50PD
00754            IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
00755               OR                                                  ELC50PD
00756            ((AM-IG = '2') AND                                     ELC50PD
00757            (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
00758               OR                                                  ELC50PD
00759            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
00760            (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
00761            (AM-IG NOT = '1'))                                     ELC50PD
00762               GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
00763                                                                   ELC50PD
00764      IF SUB5 LESS THAN +20                                        ELC50PD
00765         ADD +1                   TO SUB5                          ELC50PD
00766         GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
00767                                                                   ELC50PD
00768      MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
00769                                                                   ELC50PD
00770      IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
00771         GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.                       ELC50PD
00772                                                                   ELC50PD
00773      MOVE +1                     TO SUB5.                         ELC50PD
00774                                                                   ELC50PD
00775  03XX-EDIT-DMD-EXTRA-NINETY-LF.                                   ELC50PD
00776                                                                   ELC50PD
00777      MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
00778                                  TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
00779                                                                   ELC50PD
00780      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
00781        AND                                                        ELC50PD
00782         (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
00783         GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
00784                                                                   ELC50PD
00785      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')                   ELC50PD
00786        AND                                                        ELC50PD
00787         (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
00788         IF CF-REDUCING (SUB3)                                     ELC50PD
00789            IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
00790               OR                                                  ELC50PD
00791            ((AM-IG = '1') AND                                     ELC50PD
00792            (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
00793               OR                                                  ELC50PD
00794            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
00795            (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
00796            (AM-IG NOT = '2'))                                     ELC50PD
00797               GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
00798                                                                   ELC50PD
00799      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')                   ELC50PD
00800        AND                                                        ELC50PD
00801         (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
00802         IF CF-REDUCING (SUB3)                                     ELC50PD
00803            IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
00804               OR                                                  ELC50PD
00805            ((AM-IG = '2') AND                                     ELC50PD
00806            (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
00807               OR                                                  ELC50PD
00808            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
00809            (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
00810            (AM-IG NOT = '1'))                                     ELC50PD
00811               GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
00812                                                                   ELC50PD
00813      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')                   ELC50PD
00814        AND                                                        ELC50PD
00815         (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
00816         IF CF-LEVEL    (SUB3)                                     ELC50PD
00817            IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
00818               OR                                                  ELC50PD
00819            ((AM-IG = '1') AND                                     ELC50PD
00820            (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
00821               OR                                                  ELC50PD
00822            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
00823            (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
00824             (AM-IG NOT = '2'))                                    ELC50PD
00825               GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
00826                                                                   ELC50PD
00827      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')                   ELC50PD
00828        AND                                                        ELC50PD
00829         (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
00830         IF CF-LEVEL    (SUB3)                                     ELC50PD
00831            IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
00832               OR                                                  ELC50PD
00833            ((AM-IG = '2') AND                                     ELC50PD
00834            (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
00835               OR                                                  ELC50PD
00836            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
00837            (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
00838            (AM-IG NOT = '1'))                                     ELC50PD
00839               GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
00840                                                                   ELC50PD
00841      IF SUB5 LESS THAN +30                                        ELC50PD
00842         ADD +1                   TO SUB5                          ELC50PD
00843         GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.                      ELC50PD
00844                                                                   ELC50PD
00845      MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
00846                                                                   ELC50PD
00847  03XX-EDIT-FOR-NINETY-LF-CONT.                                    ELC50PD
00848                                                                   ELC50PD
00849      MOVE +99                    TO SUB5.                         ELC50PD
00850                                                                   ELC50PD
00851      IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
00852         IF PB-ISSUE                                               ELC50PD
00853            MOVE ER-1924          TO  WS-ERROR                     ELC50PD
00854            PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
00855                                                                   ELC50PD
00856      GO TO 0304-LIFE-BENEFIT-FOUND.                               ELC50PD
00857                                                                   ELC50PD
00858  03XX-GET-LIFE-ERPLAN.                                            ELC50PD
00859                                                                   ELC50PD
00860      IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
00861         GO TO 03XX-ERPLAN-LIFE-GETMAIN.                           ELC50PD
00862                                                                   ELC50PD
00863      MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
00864      SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
00865      PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
00866      MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
00867      MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
00868                                     PLAN-MASTER-LIFE-SW.          ELC50PD
00869      GO TO XXXX-CHECK-LF-PLAN-KEY.                                ELC50PD
00870                                                                   ELC50PD
00871  03XX-ERPLAN-LIFE-GETMAIN.                                        ELC50PD
00872                                                                   ELC50PD
00873      PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
00874      MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
00875                                                                   ELC50PD
00876  03XX-ERPLAN-LIFE-READ.                                           ELC50PD
00877                                                                   ELC50PD
00878      MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
00879      MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
00880      MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
00881      MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
00882      MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
00883      MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.            ELC50PD
00884      MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
00885      MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
00886                                  TO PLAN-REVISION-NO.             ELC50PD
00887                                                                   ELC50PD
00888      PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
00889      MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.          ELC50PD
00890                                                                   ELC50PD
00891      IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
00892        IF NOT LF-PLAN-MASTER-FOUND                                ELC50PD
00893          IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
00894             NOT PB-POLICY-IS-VOIDED                               ELC50PD
00895              MOVE  ER-1921         TO  WS-ERROR                   ELC50PD
00896              PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
00897              GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
00898                                                                   ELC50PD
00899      IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
00900         GO TO 0304-LIFE-BENEFIT-FOUND.                            ELC50PD
00901                                                                   ELC50PD
00902  XXXX-CHECK-LF-PLAN-KEY.                                          ELC50PD
00903                                                                   ELC50PD
00904      IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
00905         (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
00906         (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
00907         (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
00908         (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
00909         (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR        ELC50PD
00910         (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
00911         (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
00912         MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
00913           GO TO 03XX-ERPLAN-LIFE-READ.                            ELC50PD
00914                                                                   ELC50PD
00915      MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.          ELC50PD
00916                                                                   ELC50PD
00917      IF  PB-CANCELLATION                                          ELC50PD
00918          GO TO  0303-LF-ACCT-BEN-FOUND.                           ELC50PD
00919                                                                   ELC50PD
00920      IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
00921         IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND        ELC50PD
00922            (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)       ELC50PD
00923            IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO        ELC50PD
00924               MOVE ER-2644             TO WS-ERROR                ELC50PD
00925               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
00926            ELSE                                                   ELC50PD
00927               NEXT SENTENCE                                       ELC50PD
00928         ELSE                                                      ELC50PD
00929            IF PB-COMPANY-ID NOT = 'NCL'                           ELC50PD
00930               IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS          ELC50PD
00931                  MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.    ELC50PD
00932                                                                   ELC50PD
00933  0303-LF-ACCT-BEN-FOUND.                                          ELC50PD
00934                                                                   ELC50PD
00935      MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.             ELC50PD
00936                                                                   ELC50PD
00937      IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
00938         MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.         ELC50PD
00939                                                                   ELC50PD
00940      IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
00941         PL-DEV-PCT NOT = ZEROS                                    ELC50PD
00942         MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.           ELC50PD
00943                                                                   ELC50PD
00944      IF PL-TOL-PREM-AMT GREATER THAN +0                           ELC50PD
00945         MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.            ELC50PD
00946                                                                   ELC50PD
00947      IF PL-TOL-REF-AMT GREATER THAN +0                            ELC50PD
00948         MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.          ELC50PD
00949                                                                   ELC50PD
00950      IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
00951         MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.        ELC50PD
00952                                                                   ELC50PD
00953      IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
00954         MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.      ELC50PD
00955                                                                   ELC50PD
00956      IF PL-TOL-CLM-AMT GREATER THAN +0                            ELC50PD
00957         MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.           ELC50PD
00958                                                                   ELC50PD
00959      IF PL-OVER-SHORT-AMT NUMERIC  AND                            ELC50PD
00960                           PL-OVER-SHORT-AMT > +0                  ELC50PD
00961         MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.            ELC50PD
00962                                                                   ELC50PD
00963      IF PL-OVER-SHORT-PCT NUMERIC  AND                            ELC50PD
00964                           PL-OVER-SHORT-PCT > +0                  ELC50PD
00965         MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.            ELC50PD
00966                                                                   ELC50PD
00967      IF PL-SALES-TAX NUMERIC AND                                  ELC50PD
00968                           PL-SALES-TAX > +0                       ELC50PD
00969          MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.              ELC50PD
00970                                                                   ELC50PD
00971      IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
00972         MOVE PL-IG               TO WS-IG-OVRD-LF-PL              ELC50PD
00973                                     WS-IG-OVRD-AM.                ELC50PD
00974                                                                   ELC50PD
00975  0304-LIFE-BENEFIT-FOUND.                                         ELC50PD
00976                                                                   ELC50PD
00977      MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.     ELC50PD
00978                                                                   ELC50PD
00979      IF PB-ISSUE                                                  ELC50PD
00980         MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR             ELC50PD
00981      ELSE                                                         ELC50PD
00982         MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.           ELC50PD
00983                                                                   ELC50PD
00984      MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.     ELC50PD
00985      MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.   ELC50PD
00986      MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.   ELC50PD
00987      MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.       ELC50PD
00988      MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC      ELC50PD
00989                                          WS-LF-REFUND-CALC.       ELC50PD
00990                                                                   ELC50PD
00991      IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
00992         MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.    ELC50PD
00993                                                                   ELC50PD
00994      IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
00995         MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.  ELC50PD

100703     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
00996                                                                   ELC50PD
00997      MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.  ELC50PD
00998      MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.ELC50PD
00999      MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.     ELC50PD
01000      MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.  ELC50PD
01001      MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.    ELC50PD
01002      MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.  ELC50PD
01003                                                                   ELC50PD
01004      IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
01005         CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
01006          NEXT SENTENCE                                            ELC50PD
01007      ELSE                                                         ELC50PD
01008          IF SUB5 NOT GREATER THAN +20                             ELC50PD
01009             IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'              ELC50PD
01010                MOVE WS-SAVE-BENEFIT-REM-TERM                      ELC50PD
01011                                       TO WS-AM-LF-BENE-REM-TERM   ELC50PD
01012                                          EC-BR-LF-REM-TERM-CALC.  ELC50PD
01013                                                                   ELC50PD
01014      MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.        ELC50PD
01015      MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.           ELC50PD
01016                                                                   ELC50PD
01017      GO TO 0310-FIND-AH-BENEFIT-RECORD.                           ELC50PD
01018                                                                   ELC50PD
01019  0305-BENEFIT-NOT-FOUND.                                          ELC50PD
01020                                                                   ELC50PD
01021      MOVE '1'                    TO LF-BENEFIT-ERROR.             ELC50PD
01022      MOVE ER-2604                TO WS-ERROR.                     ELC50PD
01023      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
01024                                                                   ELC50PD
01025      EJECT                                                        ELC50PD
01026                                                                   ELC50PD
01027  0310-FIND-AH-BENEFIT-RECORD.                                     ELC50PD
01028                                                                   ELC50PD
01029      MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
01030                                     PLAN-MASTER-AH-SW.            ELC50PD
01031                                                                   ELC50PD
01032      MOVE ZEROS                  TO WS-PL-TOL-AH-PREM             ELC50PD
01033                                     WS-PL-TOL-AH-REFUND           ELC50PD
01034                                     WS-AH-PL-REF-OVS-AMT          ELC50PD
01035                                     WS-PL-TOL-AH-PREM-PCT         ELC50PD
01036                                     WS-PL-TOL-AH-REFUND-PCT       ELC50PD
01037                                     WS-AH-PL-REF-OVS-PCT          ELC50PD
01038                                     WS-PL-TOL-AH-CLAIM.           ELC50PD
           MOVE ' '                    TO WS-AH-DCC-TRUNC
01039                                                                   ELC50PD
01040                                                                   ELC50PD
           if pb-issue
01041         IF PB-I-AH-INPUT-CD EQUAL ZEROS
01042            MOVE SPACES              TO PB-I-AH-INPUT-CD
              end-if
01044         IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
01045            and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
01046            GO TO 0399-BENEFIT-NOT-FOUND
              end-if
           end-if
01047                                                                   ELC50PD
01048      IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
01049         GO TO 0400-FIND-CARRIER.                                  ELC50PD
01050                                                                   ELC50PD
01051      MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
01052                                                                   ELC50PD
01053      IF WK-AH-BEN-ADDR NOT = ZEROS                                ELC50PD
01054          MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP                ELC50PD
01055          SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
01056          PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
01057          IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
01058            AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
01059              GO TO 0311-AH-BENEFIT-SEARCH                         ELC50PD
01060          ELSE                                                     ELC50PD
01061              NEXT SENTENCE                                        ELC50PD
01062      ELSE                                                         ELC50PD
01063          PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
01064                                                                   ELC50PD
01065      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
01066      MOVE '5'                    TO CNTL-REC-TYPE.                ELC50PD
01067      MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
01068      MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
01069                                                                   ELC50PD
01070      MOVE '2' TO RC-SW-2.                                         ELC50PD
01071      PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
01072                                                                   ELC50PD
01073      IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
01074         (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
01075           GO TO 0399-BENEFIT-NOT-FOUND.                           ELC50PD
01076                                                                   ELC50PD
01077      MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.               ELC50PD
01078                                                                   ELC50PD
01079  0311-AH-BENEFIT-SEARCH.                                          ELC50PD
01080                                                                   ELC50PD
01081      PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
01082                                                                   ELC50PD
01083      IF NO-BENEFIT-FOUND                                          ELC50PD
01084          GO TO 0399-BENEFIT-NOT-FOUND.                            ELC50PD
01085                                                                   ELC50PD
01086      IF WS-BEN-CD = '99'                                          ELC50PD
01087         GO TO 0399-BENEFIT-NOT-FOUND.                             ELC50PD
01088                                                                   ELC50PD
01089      IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
01090          IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
01091              GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
01092                                                                   ELC50PD
01093      MOVE +1                     TO SUB5.                         ELC50PD
01094      MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
01095                                                                   ELC50PD
01096 * FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
01097 * BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
01098      IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
01099          MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
01100                                                                   ELC50PD
01101  0312-EDIT-ACCT-AH-BENEFITS.                                      ELC50PD
01102                                                                   ELC50PD
01103      IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1                ELC50PD
01104         IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)                     ELC50PD
01105            MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
01106                                  TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
01107            GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
01108                                                                   ELC50PD
01109      IF SUB5 LESS THAN +20                                        ELC50PD
01110         ADD +1                   TO SUB5                          ELC50PD
01111         GO TO 0312-EDIT-ACCT-AH-BENEFITS.                         ELC50PD
01112                                                                   ELC50PD
01113      MOVE +1                     TO SUB5.                         ELC50PD
01114                                                                   ELC50PD
01115      IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
01116         GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
01117                                                                   ELC50PD
01118  0313-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
01119                                                                   ELC50PD
01120      IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1            ELC50PD
01121         IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)                 ELC50PD
01122            MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
01123                                  TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
01124            GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
01125                                                                   ELC50PD
01126      IF SUB5 LESS THAN +30                                        ELC50PD
01127         ADD +1                   TO SUB5                          ELC50PD
01128         GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
01129                                                                   ELC50PD
01130      MOVE +1                     TO SUB5.                         ELC50PD
01131                                                                   ELC50PD
01132  03XX-EDIT-FOR-NINETY-AH.                                         ELC50PD
01133                                                                   ELC50PD
01134 ***************************************************************   ELC50PD
01135 *                                                             *   ELC50PD
01136 *    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
01137 *                                                             *   ELC50PD
01138 *      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
01139 *      92 = ALL GROUP REDUCING BENEFITS.                      *   ELC50PD
01140 *      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
01141 *           BENEFIT CONTROLS.                                 *   ELC50PD
01142 *      99 = ALL BENEFITS.                                     *   ELC50PD
01143 *                                                             *   ELC50PD
01144 ***************************************************************   ELC50PD
01145                                                                   ELC50PD
01146      MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
01147                                 TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
01148                                                                   ELC50PD
01149      IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
01150        AND                                                        ELC50PD
01151         AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
01152         GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
01153                                                                   ELC50PD
01154      IF AM-BENEFIT-CODE (SUB5) EQUAL '91'                         ELC50PD
01155        AND                                                        ELC50PD
01156         AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
01157            IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
01158               OR                                                  ELC50PD
01159            ((AM-IG = '1') AND                                     ELC50PD
01160            (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
01161               OR                                                  ELC50PD
01162            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
01163            (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
01164            (AM-IG NOT = '2'))                                     ELC50PD
01165               GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
01166                                                                   ELC50PD
01167      IF AM-BENEFIT-CODE (SUB5) EQUAL '92'                         ELC50PD
01168        AND                                                        ELC50PD
01169         AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
01170            IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
01171               OR                                                  ELC50PD
01172            ((AM-IG = '2') AND                                     ELC50PD
01173            (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
01174               OR                                                  ELC50PD
01175            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
01176            (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
01177            (AM-IG NOT = '1'))                                     ELC50PD
01178               GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
01179                                                                   ELC50PD
01180      IF SUB5 LESS THAN +20                                        ELC50PD
01181         ADD +1                   TO SUB5                          ELC50PD
01182         GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
01183                                                                   ELC50PD
01184      IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
01185         GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.                       ELC50PD
01186                                                                   ELC50PD
01187      MOVE +1                    TO SUB5.                          ELC50PD
01188                                                                   ELC50PD
01189  03XX-EDIT-DMD-EXTRA-NINETY-AH.                                   ELC50PD
01190                                                                   ELC50PD
01191      MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
01192                                 TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
01193                                                                   ELC50PD
01194      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
01195        AND                                                        ELC50PD
01196         AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
01197         GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
01198                                                                   ELC50PD
01199      IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'                     ELC50PD
01200        AND                                                        ELC50PD
01201         AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
01202            IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
01203               OR                                                  ELC50PD
01204            ((AM-IG = '1') AND                                     ELC50PD
01205            (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
01206               OR                                                  ELC50PD
01207            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
01208            (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
01209            (AM-IG NOT = '2'))                                     ELC50PD
01210               GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
01211                                                                   ELC50PD
01212      IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'                     ELC50PD
01213        AND                                                        ELC50PD
01214         AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
01215            IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
01216               OR                                                  ELC50PD
01217            ((AM-IG = '2') AND                                     ELC50PD
01218            (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
01219               OR                                                  ELC50PD
01220            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
01221            (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
01222            (AM-IG NOT = '1'))                                     ELC50PD
01223               GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
01224                                                                   ELC50PD
01225      IF SUB5 LESS THAN +30                                        ELC50PD
01226         ADD +1                   TO SUB5                          ELC50PD
01227         GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.                      ELC50PD
01228                                                                   ELC50PD
01229  03XX-EDIT-FOR-NINETY-AH-CONT.                                    ELC50PD
01230                                                                   ELC50PD
01231      MOVE +99                    TO SUB5.                         ELC50PD
01232                                                                   ELC50PD
01233      MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
01234                                                                   ELC50PD
01235      IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
01236         IF PB-ISSUE                                               ELC50PD
01237            MOVE ER-1925          TO  WS-ERROR                     ELC50PD
01238            PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
01239                                                                   ELC50PD
01240      GO TO 0314-A-H-BENEFIT-FOUND.                                ELC50PD
01241                                                                   ELC50PD
01242  03XX-GET-AH-ERPLAN.                                              ELC50PD
01243                                                                   ELC50PD
01244      IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
01245          GO TO 03XX-ERPLAN-AH-GETMAIN.                            ELC50PD
01246                                                                   ELC50PD
01247      MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
01248      SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
01249      PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
01250      MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
01251      MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
01252                                     PLAN-MASTER-AH-SW.            ELC50PD
01253 *****GO TO XXXX-CHECK-AH-PLAN-KEY.                                ELC50PD
01254      GO TO 03XX-ERPLAN-AH-READ.                                   ELC50PD
01255                                                                   ELC50PD
01256  03XX-ERPLAN-AH-GETMAIN.                                          ELC50PD
01257                                                                   ELC50PD
01258      PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
01259      MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
01260                                                                   ELC50PD
01261  03XX-ERPLAN-AH-READ.                                             ELC50PD
01262                                                                   ELC50PD
01263      MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
01264      MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
01265      MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
01266      MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
01267      MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
01268      MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.            ELC50PD
01269      MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
01270      MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
01271                                  TO PLAN-REVISION-NO.             ELC50PD
01272                                                                   ELC50PD
01273      PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
01274      MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.            ELC50PD
01275                                                                   ELC50PD
01276      IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
01277        IF NOT AH-PLAN-MASTER-FOUND                                ELC50PD
01278          IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
01279             NOT PB-POLICY-IS-VOIDED                               ELC50PD
01280              MOVE  ER-1922         TO  WS-ERROR                   ELC50PD
01281              PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
01282              GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
01283                                                                   ELC50PD
01284      IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
01285         GO TO 0314-A-H-BENEFIT-FOUND.                             ELC50PD
01286                                                                   ELC50PD
01287  XXXX-CHECK-AH-PLAN-KEY.                                          ELC50PD
01288                                                                   ELC50PD
01289      IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
01290         (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
01291         (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
01292         (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
01293         (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
01294         (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR          ELC50PD
01295         (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
01296         (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
01297         MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
01298           GO TO 03XX-ERPLAN-AH-READ.                              ELC50PD
01299                                                                   ELC50PD
01300      MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.            ELC50PD
01301                                                                   ELC50PD
01302      IF  PB-CANCELLATION                                          ELC50PD
01303          GO TO  0313-AH-ACCT-BEN-FOUND.                           ELC50PD
01304                                                                   ELC50PD
01305      IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
01306        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND         ELC50PD
01307           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)        ELC50PD
01308           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO         ELC50PD
01309              MOVE ER-2644             TO WS-ERROR                 ELC50PD
01310              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
01311           ELSE                                                    ELC50PD
01312              NEXT SENTENCE                                        ELC50PD
01313        ELSE                                                       ELC50PD
01314           IF PB-COMPANY-ID NOT = 'NCL'                            ELC50PD
01315              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS           ELC50PD
01316                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.     ELC50PD
01317                                                                   ELC50PD
01318  0313-AH-ACCT-BEN-FOUND.                                          ELC50PD
01319                                                                   ELC50PD
01320      MOVE PL-REVISION-NO         TO WS-AH-REVISION.               ELC50PD
01321                                                                   ELC50PD
01322      IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
01323         MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.         ELC50PD
01324                                                                   ELC50PD
01325      IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
01326         PL-DEV-PCT NOT = ZEROS                                    ELC50PD
01327         MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.           ELC50PD
01328                                                                   ELC50PD
01329      IF PL-TOL-PREM-AMT NOT EQUAL +0                              ELC50PD
01330         MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.            ELC50PD
01331                                                                   ELC50PD
01332      IF PL-TOL-REF-AMT NOT EQUAL +0                               ELC50PD
01333         MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.          ELC50PD
01334                                                                   ELC50PD
01335      IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
01336         MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.        ELC50PD
01337                                                                   ELC50PD
01338      IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
01339         MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.      ELC50PD
01340                                                                   ELC50PD
01341      IF PL-TOL-CLM-AMT NOT EQUAL +0                               ELC50PD
01342         MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.           ELC50PD
01343                                                                   ELC50PD
01344      IF PL-OVER-SHORT-AMT NUMERIC AND                             ELC50PD
01345                           PL-OVER-SHORT-AMT > +0                  ELC50PD
01346         MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.         ELC50PD
01347                                                                   ELC50PD
01348      IF PL-OVER-SHORT-PCT NUMERIC AND                             ELC50PD
01349                           PL-OVER-SHORT-PCT > +0                  ELC50PD
01350         MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.           ELC50PD
01351                                                                   ELC50PD
01352      IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
01353         MOVE PL-IG               TO WS-IG-OVRD-AH-PL              ELC50PD
01354         IF WS-IG-OVRD-AM EQUAL SPACES                             ELC50PD
01355             MOVE PL-IG           TO WS-IG-OVRD-AM.                ELC50PD
01356                                                                   ELC50PD
01357  0314-A-H-BENEFIT-FOUND.                                          ELC50PD
01358                                                                   ELC50PD
01359      MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.     ELC50PD
01360                                                                   ELC50PD
01361      IF PB-ISSUE                                                  ELC50PD
01362         MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR             ELC50PD
01363        ELSE                                                       ELC50PD
01364         MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.           ELC50PD
01365                                                                   ELC50PD
01366      MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.   ELC50PD
01367      MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.   ELC50PD
01368      MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.       ELC50PD
01369      MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC      ELC50PD
01370                                          WS-AH-REFUND-CALC.       ELC50PD
01371                                                                   ELC50PD
01372      IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
01373         MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.    ELC50PD
01374                                                                   ELC50PD
01375      IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
01376         MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.  ELC50PD

100703     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
01377                                                                   ELC50PD
01378      MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.  ELC50PD
01379      MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.ELC50PD
01380      MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.     ELC50PD
01381      MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.  ELC50PD
01382      MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.    ELC50PD
01383      MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.  ELC50PD
01384                                                                   ELC50PD
01385      IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
01386         CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
01387          NEXT SENTENCE                                            ELC50PD
01388      ELSE                                                         ELC50PD
01389          IF SUB5 NOT GREATER THAN +20                             ELC50PD
01390             IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'             ELC50PD
01391                 MOVE WS-SAVE-BENEFIT-REM-TERM                     ELC50PD
01392                                       TO WS-AM-AH-BENE-REM-TERM   ELC50PD
01393                                          EC-BR-AH-REM-TERM-CALC.  ELC50PD
01394                                                                   ELC50PD
01395      MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.        ELC50PD
01396      MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.           ELC50PD
01397                                                                   ELC50PD
01398      GO TO 0400-FIND-CARRIER.                                     ELC50PD
01399                                                                   ELC50PD
01400  0399-BENEFIT-NOT-FOUND.                                          ELC50PD
01401                                                                   ELC50PD
01402      MOVE '1'                    TO AH-BENEFIT-ERROR.             ELC50PD
01403      MOVE ER-2605                TO WS-ERROR.                     ELC50PD
01404      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
01405                                                                   ELC50PD
01406      EJECT                                                        ELC50PD
01407                                                                   ELC50PD
01408  0400-FIND-CARRIER.                                               ELC50PD
01409                                                                   ELC50PD
01410      MOVE PB-SV-CARRIER          TO WS-CARR.                      ELC50PD
01411                                                                   ELC50PD
01412      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
01413      MOVE ZEROS                  TO CNTL-SEQ-NO.                  ELC50PD
01414      MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  ELC50PD
01415      MOVE '6'                    TO CNTL-REC-TYPE.                ELC50PD
01416                                                                   ELC50PD
01417 *INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD                   ELC50PD
01418      MOVE SPACE                  TO WS-DMD-RATING-SW              ELC50PD
01419                                     EC-BR-DMD-RATING-SW.          ELC50PD
01420                                                                   ELC50PD
01421      MOVE '2'                    TO RC-SW-1.                      ELC50PD
01422      PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
01423                                                                   ELC50PD
01424      IF NOT CF-CARRIER-MASTER                                     ELC50PD
01425         GO TO 0400-CARRIER-NOT-FOUND.                             ELC50PD
01426                                                                   ELC50PD
01427  0400-BUILD-CARR-TOL.                                             ELC50PD
01428                                                                   ELC50PD
01429      IF CF-CR-TOL-PREM NUMERIC AND                                ELC50PD
01430         CF-CR-TOL-PREM GREATER THAN +0                            ELC50PD
01431         MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
01432                                     WS-TOL-AH-PREM.               ELC50PD
01433                                                                   ELC50PD
01434      IF CF-CR-TOL-REFUND NUMERIC AND                              ELC50PD
01435         CF-CR-TOL-REFUND GREATER THAN +0                          ELC50PD
01436         MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND              ELC50PD
01437                                     WS-TOL-AH-REFUND.             ELC50PD
01438                                                                   ELC50PD
01439      IF CF-CR-OVR-SHT-AMT NUMERIC AND                             ELC50PD
01440         CF-CR-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
01441         MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
01442                                     WS-AH-REFUND-OVS-AMT.         ELC50PD
01443                                                                   ELC50PD
01444      IF CF-CR-OVR-SHT-PCT NUMERIC AND                             ELC50PD
01445         CF-CR-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
01446         MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
01447                                     WS-AH-REFUND-OVS-PCT.         ELC50PD
01448                                                                   ELC50PD
01449      IF CF-CR-TOL-PREM-PCT NUMERIC AND                            ELC50PD
01450         CF-CR-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
01451         MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT            ELC50PD
01452                                     WS-TOL-AH-PREM-PCT.           ELC50PD
01453                                                                   ELC50PD
01454      IF CF-CR-TOL-REFUND-PCT NUMERIC AND                          ELC50PD
01455         CF-CR-TOL-REFUND-PCT GREATER THAN +0                      ELC50PD
01456         MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT         ELC50PD
01457                                      WS-TOL-AH-REFUND-PCT.        ELC50PD
01458                                                                   ELC50PD
01459      IF CF-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
01460          MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW              ELC50PD
01461                                     EC-BR-DMD-RATING-SW.          ELC50PD
01462                                                                   ELC50PD
           MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
100703     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
100703        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
100703     END-IF
092705     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
092705        MOVE +0                  TO CF-CARRIER-LEASE-COMM
092705     END-IF
100703     IF WS-TOL-CLP-PCT = ZEROS
100703        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
100703     END-IF
100703
092705     IF WS-SPP-LEASE-COMM = ZEROS
092705        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
092705     END-IF

01463      GO TO 0400-FIND-ERPDEF.
01464                                                                   ELC50PD
01465  0400-CARRIER-NOT-FOUND.                                          ELC50PD
01466                                                                   ELC50PD
01467      MOVE ER-2602                TO WS-ERROR.                     ELC50PD
01468      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
01469                                                                   ELC50PD
       0400-FIND-ERPDEF.

           IF PB-COMPANY-ID = 'DCC'
              AND AM-DCC-PRODUCT-CODE = 'DDF'
              CONTINUE
           ELSE
              GO TO 0400-FIND-ERCOMP
           END-IF

           MOVE ' '                    TO PDEF-MASTER-SW
           MOVE PB-COMPANY-CD          TO ERPDEF-KEY
           MOVE PB-STATE               TO ERPDEF-STATE
           MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
           MOVE 'A'                    TO ERPDEF-BEN-TYPE
           IF PB-ISSUE
              MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
           ELSE
              MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
           END-IF
           MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
           MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
           PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
           IF PDEF-MASTER-FOUND
              MOVE 'N'                 TO PDEF-MASTER-SW
              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
              IF PDEF-MASTER-FOUND
                 IF (ERPDEF-KEY-SAVE (1:16) =
                              PD-CONTROL-PRIMARY (1:16))
                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
                    CONTINUE
                 ELSE
                    PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
                    IF (ERPDEF-KEY-SAVE (1:16) =
                              PD-CONTROL-PRIMARY (1:16))
                       AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
                       CONTINUE
                    ELSE
                       MOVE 'N'        TO PDEF-MASTER-SW
                    END-IF
                 END-IF
              END-IF
              PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
           END-IF
           IF PDEF-MASTER-FOUND
              IF PD-TRUNCATED = 'Y'
                 MOVE 'T'              TO WS-AH-DCC-TRUNC
              END-IF
           END-IF

           .
100703 0400-FIND-ERCOMP.

080805     IF PB-COMPANY-ID = 'DCC'
080805        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
080805           (WS-SUB1 > +10)
052306           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
071211                 OR 'A' OR 'N'
080805              MOVE PB-COMPANY-CD TO COMP-COMP-CD
080805              MOVE PB-CARRIER    TO COMP-CARRIER
080805              MOVE PB-GROUPING   TO COMP-GROUPING
080805              MOVE LOW-VALUES    TO COMP-ACCOUNT
080805              MOVE AM-AGT (WS-SUB1)
                                       TO COMP-FIN-RESP
080805              MOVE 'G'           TO COMP-TYPE
080805              PERFORM 8582-READ-COMPENSATION-MASTER
080805                                 THRU 8582-EXIT
080805              IF COMP-MASTER-FOUND
080805                 IF CO-GA-INACTIVE
080805                    MOVE ER-2763 TO WS-ERROR
080805                    PERFORM 9900-ERROR-FORMAT
080805                                 THRU 9900-EXIT
080805                    MOVE +11     TO WS-SUB1
080805                 END-IF
042106                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
042106                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
042106                    MOVE ER-2788 TO WS-ERROR
042106                    PERFORM 9900-ERROR-FORMAT
042106                                 THRU 9900-EXIT
042106                    MOVE +11     TO WS-SUB1
042106                 END-IF
080805              END-IF
080805           END-IF
080805        END-PERFORM
080805     END-IF

071211     IF PB-COMPANY-ID = 'DCC'
071211        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
071211           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
071211                                    WS-CLP-STATE
071211        ELSE
071211           MOVE SPACES           TO PB-I-CLP-STATE
071211                                    WS-CLP-STATE
071211        END-IF
071211     END-IF
071211
071211     IF (PB-COMPANY-ID = 'DCC')
071211        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
071211        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
071211        CONTINUE
071211     ELSE
071211        GO TO 0400-FIND-STATE-RECORD
071211     END-IF

100703     MOVE SPACES                 TO WS-CLP-STATE
100703     MOVE +0                     TO WS-BANK-FEE
092205                                    WS-BANK-LFEE
100703                                    WS-BANK-NOCHRGB
100703     
100703     MOVE LOW-VALUES             TO COMP-FIN-RESP

100703     IF (PB-ISSUE)
100703        AND (PB-I-BANK-NUMBER NOT =
                  SPACES AND ZEROS AND LOW-VALUES)
100703        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
100703     ELSE
100703        IF (PB-CANCELLATION)
100703           AND (PB-CI-BANK-NUMBER NOT =
                      SPACES AND ZEROS AND LOW-VALUES)
100703           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
100703        END-IF
100703     END-IF

100703     IF COMP-FIN-RESP NOT = LOW-VALUES
100703        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
100703        MOVE PB-CARRIER          TO COMP-CARRIER
100703        MOVE PB-GROUPING         TO COMP-GROUPING
100703        MOVE LOW-VALUES          TO COMP-ACCOUNT
100703        MOVE 'B'                 TO COMP-TYPE
100703        PERFORM 8582-READ-COMPENSATION-MASTER
100703                                 THRU 8582-EXIT
100703        IF COMP-MASTER-FOUND
100703           IF CO-MAX-BANK-FEE NOT NUMERIC
100703              MOVE +0            TO CO-MAX-BANK-FEE
100703           END-IF
100703           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
100703              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
100703           END-IF
080805           IF CO-GA-INACTIVE
080805              MOVE ER-2763       TO WS-ERROR
080805              PERFORM 9900-ERROR-FORMAT
080805                                 THRU 9900-EXIT
080805           END-IF
042106           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
042106              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
042106              MOVE ER-2788 TO WS-ERROR
042106              PERFORM 9900-ERROR-FORMAT
042106                                 THRU 9900-EXIT
042106              MOVE +11     TO WS-SUB1
042106           END-IF
092205           IF WS-AH-BEN-CATEGORY = 'G'
100703              MOVE CO-MAX-BANK-FEE
092205                                 TO WS-BANK-FEE
092205                                    PB-I-BANK-FEE
092205           ELSE
092205              MOVE CO-MAX-BANK-FEE-LEASE
092205                                 TO WS-BANK-LFEE
092205                                    PB-I-BANK-FEE
092205           END-IF
                 IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
                    AND (WS-AH-REFUND-CALC = 'G'))
                              OR
                    ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
                    AND (WS-AH-REFUND-CALC NOT = 'G'))
                    CONTINUE
                 ELSE
                    MOVE ER-2789 TO WS-ERROR
                    PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 END-IF
100703           MOVE CO-CLP-STATE     TO WS-CLP-STATE
020305                                    PB-I-CLP-STATE
                 MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
                 MOVE CO-CARRIER       TO BXRF-CARRIER
                 MOVE CO-GROUPING      TO BXRF-GROUPING
                 MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
                 MOVE BXRF-MAX-REC-LENGTH
                                       TO BXRF-REC-LENGTH
                 PERFORM 8584-READ-BANK-CROSS-REF
                                       THRU 8584-EXIT
                 IF BXRF-MASTER-FOUND
                    MOVE ' '           TO BANK-ACCT-SW
                    MOVE BK-BANK-POINTER-CNT
                                       TO BK-BANK-POINTER-CNT
                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
                       (WS-SUB1 > BK-BANK-POINTER-CNT)
                       OR (BANK-ACCT-FOUND)
                       IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
                          AND (BK-AM-EXP-DT (WS-SUB1)
                                       > PB-CERT-EFF-DT)
                          AND (BK-AM-EFF-DT (WS-SUB1)
                                       NOT > PB-CERT-EFF-DT)
                          SET BANK-ACCT-FOUND TO TRUE
                       END-IF
                    END-PERFORM
                    IF NOT BANK-ACCT-FOUND
                       MOVE ZEROS      TO WS-BANK-FEE
092205                                    WS-BANK-LFEE
100703                 MOVE ER-2869    TO WS-ERROR
100703                 PERFORM 9900-ERROR-FORMAT
100703                                 THRU 9900-EXIT
111504              ELSE
030905                 PERFORM 5000-PROCESS-REPS
                                       THRU 5000-EXIT
111504                 IF AGENT-MASTER-FOUND
092205                    MOVE +0      TO WS-BANK-FEE
092205                                    WS-BANK-LFEE
      *                   MOVE AG-SPP-FEES (1)
      *                                TO PB-I-BANK-FEE
      *                                   WS-BANK-FEE
111504                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
111504                       (WS-SUB1 > +10)
111504                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
111504                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
111504                       END-IF
111504                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
111504                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
111504                       END-IF
111504                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
111504                          AG-SPP-FEES (WS-SUB1)
111504                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
111504                          AG-SPP-LFEES (WS-SUB1)
111504                    END-PERFORM
092205                    IF WS-AH-BEN-CATEGORY = 'G'
                             MOVE WS-BANK-FEE
                                       TO PB-I-BANK-FEE
                          ELSE
                             MOVE WS-BANK-LFEE
                                       TO PB-I-BANK-FEE
                          END-IF
111504                 END-IF
100703              END-IF
                 END-IF
              ELSE
020305           MOVE ER-2879          TO WS-ERROR
020305           PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
100703        END-IF
020305     ELSE
020305        MOVE ER-2879             TO WS-ERROR
020305        PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
100703     END-IF

092205     IF WS-AH-BEN-CATEGORY = 'G'
              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
              + WS-BANK-FEE
           ELSE
              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
              + WS-BANK-LFEE
           END-IF
           
           .
01470  0400-FIND-STATE-RECORD.                                          ELC50PD
01471                                                                   ELC50PD
01472      IF WK-STATE-ADDR NOT = ZEROS                                 ELC50PD
01473          MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP                ELC50PD
01474          SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
01475          PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
01476          PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT           CL**2
01477          IF PB-SV-STATE = CF-STATE-CODE                           ELC50PD
01478              GO TO 0405-CONTINUE-EDIT                             ELC50PD
01479          ELSE                                                     ELC50PD
01480              NEXT SENTENCE                                        ELC50PD
01481      ELSE                                                         ELC50PD
01482          PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
01483                                                                   ELC50PD
01484      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
01485      MOVE PB-SV-STATE            TO CNTL-ACCESS.                  ELC50PD
01486      MOVE '3'                    TO CNTL-REC-TYPE.                ELC50PD
01487      MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
01488                                                                   ELC50PD
01489      MOVE '3'                    TO RC-SW-2.                      ELC50PD
01490      PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
01491                                                                   ELC50PD
01492      IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                    ELC50PD
01493         CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR                     ELC50PD
01494         PB-SV-STATE   NOT = CF-STATE-CODE)                        ELC50PD
01495         MOVE ZEROS               TO WS-TOL-LF-CLAIM               ELC50PD
01496                                     WS-TOL-AH-CLAIM               ELC50PD
01497                                     WS-MINIMUM-REFUND             ELC50PD
01498                                     WS-TOL-LF-PREM                ELC50PD
01499                                     WS-TOL-AH-PREM                ELC50PD
01500                                     WS-TOL-LF-REFUND              ELC50PD
01501                                     WS-TOL-AH-REFUND              ELC50PD
01502                                     EC-ST-TOL-PREM-PCT            ELC50PD
01503                                     WS-TOL-LF-PREM-PCT            ELC50PD
01504                                     WS-TOL-AH-PREM-PCT            ELC50PD
01505                                     EC-ST-TOL-REFUND-PCT          ELC50PD
01506                                     WS-TOL-LF-REFUND-PCT          ELC50PD
01507                                     WS-TOL-AH-REFUND-PCT          ELC50PD
01508                                     EC-ST-TOL-PREM                ELC50PD
01509                                     EC-ST-TOL-REFUND              ELC50PD
01510                                     EC-ST-FST-PMT-DAYS-MAX        ELC50PD
01511                                     WS-FREE-LOOK-PERIOD           ELC50PD
PEMMOD                                    WS-ST-LF-PREM-TAX
PEMMOD                                    WS-ST-AH-PREM-TAX-I
PEMMOD                                    WS-ST-AH-PREM-TAX-G
100703                                    WS-BANK-FEE
092205                                    WS-BANK-LFEE
100703                                    WS-TOL-CLP-PCT
092705                                    WS-SPP-LEASE-COMM
01512         MOVE SPACES              TO WS-STATE-ABBREVIATION         ELC50PD
01513                                     EC-ST-FST-PMT-DAYS-CHG        ELC50PD
01514                                     WS-LF-REM-TERM-CALC           ELC50PD
01515                                     WS-LF-REFUND-CALC             ELC50PD
01516                                     EC-ST-LF-REM-TERM-CALC        ELC50PD
01517                                     EC-ST-LF-REFUND-CALC          ELC50PD
01518                                     WS-AH-REM-TERM-CALC           ELC50PD
01519                                     WS-AH-REFUND-CALC
100703                                    WS-LF-BEN-CATEGORY
100703                                    WS-AH-BEN-CATEGORY
100703                                    WS-CLP-STATE
042310                                    WS-ST-REFUND-CLAIM-FLAG
01520                                     EC-ST-AH-REM-TERM-CALC        ELC50PD
01521                                     EC-ST-AH-REFUND-CALC          ELC50PD
01522           GO TO 0499-STATE-NOT-FOUND.                             ELC50PD
01523                                                                   ELC50PD
01524      MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.                ELC50PD
01525                                                                   ELC50PD
01526  0405-CONTINUE-EDIT.                                              ELC50PD
082203
040512     if pb-company-id = 'AHL'
040512        continue
040512     else
030807        IF PB-CERT-PRIME NOT NUMERIC
030807           MOVE ER-2722          TO WS-ERROR
030807           PERFORM 9900-ERROR-FORMAT
030807                                 THRU 9900-EXIT
040512        end-if
030807     END-IF

030807*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
030807*       MOVE +0                  TO SUB3
030807*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
030807*       IF SUB3 > +0
030807*          MOVE ER-2722          TO WS-ERROR
030807*          PERFORM 9900-ERROR-FORMAT
030807*                                THRU 9900-EXIT
030807*       END-IF
030807*    END-IF
              

082203*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
082203*       IF PB-CERT-PRIME NOT NUMERIC
      *          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
      *          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
      *          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
      *          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
      *          
082203*          MOVE ER-2722          TO WS-ERROR
082203*          PERFORM 9900-ERROR-FORMAT
082203*                                THRU 9900-EXIT
082203*       END-IF
082203*    END-IF
082203
01527      MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.        ELC50PD
01528                                                                   ELC50PD
01529      IF CF-ST-TOL-CLAIM NOT = ZEROS                               ELC50PD
01530         MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM               ELC50PD
01531                                     WS-TOL-AH-CLAIM.              ELC50PD
01532                                                                   ELC50PD
01533      IF CF-ST-REFUND-MIN NOT NUMERIC                              ELC50PD
01534         MOVE ZEROS               TO CF-ST-REFUND-MIN.             ELC50PD
01535                                                                   ELC50PD
01536      IF CF-ST-REFUND-MIN NOT = ZEROS                              ELC50PD
01537         MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.            ELC50PD
01538                                                                   ELC50PD
01539      IF CF-ST-TOL-PREM  NOT = ZEROS                               ELC50PD
01540         MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
01541                                     WS-TOL-AH-PREM                ELC50PD
01542         MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.           ELC50PD
01543                                                                   ELC50PD
01544      IF CF-ST-TOL-REFUND NOT = ZEROS                              ELC50PD
01545         MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND              ELC50PD
01546                                     WS-TOL-AH-REFUND              ELC50PD
01547         MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.             ELC50PD
01548                                                                   ELC50PD
01549      IF CF-ST-OVR-SHT-AMT NUMERIC AND                             ELC50PD
01550         CF-ST-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
01551         MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
01552                                     WS-AH-REFUND-OVS-AMT          ELC50PD
01553                                     EC-ST-OVR-SHT-AMT.            ELC50PD
01554                                                                   ELC50PD
01555      IF CF-ST-TOL-PREM-PCT NUMERIC AND                            ELC50PD
01556         CF-ST-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
01557         MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT            ELC50PD
01558                                     WS-TOL-LF-PREM-PCT            ELC50PD
01559                                     WS-TOL-AH-PREM-PCT.           ELC50PD
01560                                                                   ELC50PD
01561      IF CF-ST-TOL-REF-PCT NUMERIC AND                             ELC50PD
01562         CF-ST-TOL-REF-PCT GREATER THAN +0                         ELC50PD
01563         MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT          ELC50PD
01564                                     WS-TOL-LF-REFUND-PCT          ELC50PD
01565                                     WS-TOL-AH-REFUND-PCT.         ELC50PD
01566                                                                   ELC50PD
01567      IF CF-ST-OVR-SHT-PCT NUMERIC AND                             ELC50PD
01568         CF-ST-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
01569         MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
01570                                     WS-AH-REFUND-OVS-PCT          ELC50PD
01571                                     EC-ST-OVR-SHT-PCT.            ELC50PD
01572                                                                   ELC50PD
01573      MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.               ELC50PD
01574      MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.             ELC50PD
01575                                                                   ELC50PD
01576      IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC                        ELC50PD
01577           MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.       ELC50PD
01578                                                                   ELC50PD
01579      MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.       ELC50PD
01580      MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.       ELC50PD

01582      MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.          ELC50PD
01583                                                                   ELC50PD
PEMMOD     IF CF-ST-LF-PREM-TAX NUMERIC
PEMMOD        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
PEMMOD     END-IF
PEMMOD     IF CF-ST-AH-PREM-TAX-I NUMERIC
PEMMOD        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
PEMMOD     END-IF
PEMMOD     IF CF-ST-AH-PREM-TAX-G NUMERIC
PEMMOD        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
PEMMOD     END-IF
PEMMOD
042310     IF CF-ST-REF-AH-DEATH-IND > SPACES
042310         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
042310     END-IF.
042310
01584      IF WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
01585         GO TO 0410-CHECK-AH.                                      ELC50PD
01586                                                                   ELC50PD
CIDMOD     IF CF-ST-RT-CALC NOT = SPACES
CIDMOD        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
CIDMOD                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
CIDMOD     END-IF
CIDMOD
PEMMOD     IF WS-LF-COVERAGE-TYPE = 'R'
PEMMOD        IF WS-LF-EARNINGS-CALC = '5'
PEMMOD           IF CF-ST-RF-LN-CALC > '0'
PEMMOD              MOVE CF-ST-RF-LN-CALC
PEMMOD                                 TO WS-LF-REFUND-CALC
PEMMOD                                    EC-ST-LF-REFUND-CALC          ELC50PD
PEMMOD           END-IF
PEMMOD        ELSE
PEMMOD           IF CF-ST-RF-LR-CALC > '0'
PEMMOD              MOVE CF-ST-RF-LR-CALC
PEMMOD                                 TO WS-LF-REFUND-CALC
PEMMOD                                    EC-ST-LF-REFUND-CALC          ELC50PD
PEMMOD           END-IF
PEMMOD        END-IF
PEMMOD     ELSE
PEMMOD        IF CF-ST-RF-LL-CALC > '0'
PEMMOD           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
PEMMOD                                    EC-ST-LF-REFUND-CALC          ELC50PD
PEMMOD        END-IF
PEMMOD     END-IF
PEMMOD
CIDMOD     IF CF-ST-RT-CALC NOT = SPACES
CIDMOD        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
CIDMOD                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
CIDMOD     END-IF
CIDMOD
01587      MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
01588      MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.               ELC50PD
01589                                                                   ELC50PD
01590      PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
01591                                                                   ELC50PD
01592      IF NO-BENEFIT-FOUND                                          ELC50PD
01593         GO TO 0410-CHECK-AH.                                      ELC50PD
01594                                                                   ELC50PD
01595      IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
CIDMOD        MOVE CF-ST-REM-TERM-CALC  (SUB3)
CIDMOD                                 TO EC-ST-LF-REM-TERM-CALC
CIDMOD                                    WS-LF-REM-TERM-CALC           ELC50PD
CIDMOD     END-IF
01597                                                                   ELC50PD
01598      IF CF-ST-REFUND-CALC (SUB3) > '0'                            ELC50PD
01599         MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
PEMMOD                                 TO WS-LF-REFUND-CALC             ELC50PD
PEMMOD                                    EC-ST-LF-REFUND-CALC          ELC50PD
PEMMOD     END-IF
PEMMOD*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.  ELC50PD
01603                                                                   ELC50PD
01604      .                                                            ELC50PD
01605  0410-CHECK-AH.                                                   ELC50PD
01606                                                                   ELC50PD
01607      IF WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
01608         GO TO 0500-SET-ACCOUNT.                                   ELC50PD
01609                                                                   ELC50PD
CIDMOD     IF CF-ST-RT-CALC NOT = SPACES
CIDMOD        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
CIDMOD                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
CIDMOD     END-IF
CIDMOD
PEMMOD     IF WS-AH-SPECIAL-CALC-CD = 'C'
PEMMOD        IF CF-ST-RF-CP-CALC > '0'
PEMMOD           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
PEMMOD                                    EC-ST-AH-REFUND-CALC
PEMMOD        END-IF
PEMMOD     ELSE
PEMMOD        IF CF-ST-RF-AH-CALC > '0'
PEMMOD           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
PEMMOD                                    EC-ST-AH-REFUND-CALC
PEMMOD        END-IF
PEMMOD     END-IF
01610      MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
01611      MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE                ELC50PD
01612                                                                   ELC50PD
01613      PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
01614                                                                   ELC50PD
01615      IF NO-BENEFIT-FOUND                                          ELC50PD
01616         GO TO 0500-SET-ACCOUNT.                                   ELC50PD
01617                                                                   ELC50PD
01618      IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
01619         MOVE CF-ST-REM-TERM-CALC (SUB3)                           ELC50PD
CIDMOD                                 TO WS-AH-REM-TERM-CALC           ELC50PD
CIDMOD                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
CIDMOD     END-IF
01620                                                                   ELC50PD
01621      IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'                   ELC50PD
01622         MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
                                       TO WS-AH-REFUND-CALC             ELC50PD
                                          EC-ST-AH-REFUND-CALC
           END-IF
01623                                                                   ELC50PD
PEMMOD*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.  ELC50PD
01626                                                                   ELC50PD
01627      GO TO 0500-SET-ACCOUNT.                                      ELC50PD
01628                                                                   ELC50PD
01629  0499-STATE-NOT-FOUND.                                            ELC50PD
01630                                                                   ELC50PD
01631      MOVE ER-2603                TO WS-ERROR.                     ELC50PD
01632      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
01633                                                                   ELC50PD
01634      EJECT                                                        ELC50PD
01635                                                                   ELC50PD
01636  0500-SET-ACCOUNT.                                                ELC50PD

100703*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE

100703     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
100703        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
100703        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
100703        MOVE WS-CLP-STATE        TO CNTL-ACCESS
100703        MOVE '3'                 TO CNTL-REC-TYPE
100703        MOVE +0                  TO CNTL-SEQ-NO
100703
100703        MOVE '3'                 TO RC-SW-2
100703        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
100703
100703        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
100703           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
100703           WS-CLP-STATE  NOT = CF-STATE-CODE)
100703           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
100703                                    WS-ST-AH-PREM-TAX-I
100703                                    WS-ST-AH-PREM-TAX-G
              ELSE
                 IF CF-ST-LF-PREM-TAX NUMERIC
                    MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
                 END-IF
                 IF CF-ST-AH-PREM-TAX-I NUMERIC
                    MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
                 END-IF
                 IF CF-ST-AH-PREM-TAX-G NUMERIC
                    MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
                 END-IF
100703        END-IF
100703        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
100703     END-IF

100703*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
      *  FOR DCC ONLY

071211     IF PB-COMPANY-ID = 'DCC'
071211
071211     MOVE ' '                    TO STAT-MASTER-SW
071211     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
071211     MOVE PB-CARRIER             TO ELSTAT-CARRIER
071211     MOVE PB-GROUPING            TO ELSTAT-GROUP
071211     MOVE PB-STATE               TO ELSTAT-STATE
071211     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
071211        MOVE WS-CLP-STATE        TO ELSTAT-STATE
071211     END-IF
071211
071211     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
071211     SET BIN-TO-GREG             TO TRUE
071211     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
071211     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
071211     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
071211
071211     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
071211     IF STAT-MASTER-FOUND
071211        MOVE 'N'                 TO STAT-MASTER-SW
071211        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
071211        IF STAT-MASTER-FOUND
071211           IF (ELSTAT-KEY-SAVE (1:12) =
071211                        SF-CONTROL-PRIMARY (1:12))
071211              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
071211                 MOVE 'F'        TO STAT-MASTER-SW
071211              ELSE
071211                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
071211                 IF (STAT-MASTER-FOUND)
071211                    AND (ELSTAT-KEY-SAVE (1:12) =
071211                        SF-CONTROL-PRIMARY (1:12))
071211                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
071211                    MOVE 'F'     TO STAT-MASTER-SW
071211                 END-IF
071211              END-IF
071211           END-IF
071211        END-IF
071211     END-IF
071211
071211     IF STAT-MASTER-SW = 'F'
071211        IF SF-ST-LF-PREM-TAX NUMERIC
071211           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
071211        END-IF
071211        IF SF-ST-AH-PREM-TAX-I NUMERIC
071211           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
071211        END-IF
071211        IF SF-ST-AH-PREM-TAX-G NUMERIC
071211           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
071211        END-IF
071211     END-IF
071211
071211     END-IF

           IF (PB-COMPANY-ID = 'DCC')
122807        AND (PB-ISSUE)
              AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
071211        AND (AM-DCC-PRODUCT-CODE = 'DDF')
071211        AND (AM-GPCD = 06)
              MOVE 'Y'                 TO WS-GOOD-HIN
              IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
                 MOVE PB-I-VIN         TO WS-WORK-VIN
                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
                    (V1 > 16)
                    IF WS-WORK-VIN (V1:1) NUMERIC
                       MOVE WS-WORK-VIN-N (V1)
                                       TO WS-ROW-B-VAL (V1)
                    ELSE
                       PERFORM VARYING V2 FROM +1 BY +1 UNTIL
                          (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
                          OR (V2 > 26)
                       END-PERFORM
                       IF V2 < 27
                          MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
                       ELSE
                          MOVE 'N'     TO WS-GOOD-HIN
                       END-IF
                    END-IF
                    COMPUTE WS-ROW-D-VAL (V1) =
                       WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
                    COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
                       WS-ROW-D-VAL (V1)
                 END-PERFORM
                 MOVE ZEROS            TO WS-VIN-REMAINDER
                 DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
                   REMAINDER WS-VIN-REMAINDER
                 IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
                    CONTINUE
                 ELSE
                    MOVE 'N'           TO WS-GOOD-HIN
                 END-IF
              ELSE
                 MOVE 'N'              TO WS-GOOD-HIN
              END-IF
              IF WS-GOOD-HIN NOT = 'Y'
                 MOVE ER-3826           TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
           END-IF

           IF (PB-COMPANY-ID = 'DCC')
122807        AND (PB-ISSUE)
              AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
              AND (AM-GPCD NOT = 06)
              IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
                MOVE PB-I-VIN          TO WS-WORK-VIN
                MOVE +8                TO V2
062907          MOVE ZEROS             TO WS-VIN-TOTAL
                PERFORM VARYING V1 FROM +1 BY +1 UNTIL
                 (V1 > 17)
                   IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
                      MOVE ER-3825     TO WS-ERROR
                      PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                   ELSE
                      IF V1 = 8
                         MOVE 10       TO V2
                      END-IF
                      IF V1 = 9
                         MOVE 0        TO V2
                      END-IF
                      IF V1 = 10
                         MOVE 9        TO V2
                      END-IF
                      IF WS-WORK-VIN (V1:1) NUMERIC
                         COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
                          + (WS-WORK-VIN-N (V1) * V2)
                      ELSE
                         MOVE WS-WORK-VIN (V1:1)
                                       TO WS-HEX-BYTE
                         COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
                         COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
                          + (WS-NUM (V3) * V2)
                      END-IF
                      COMPUTE V2 = V2 - 1
                   END-IF
                END-PERFORM
062907          MOVE ZEROS TO WS-VIN-REMAINDER
                DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
                   REMAINDER WS-VIN-REMAINDER
                IF ((WS-WORK-VIN (9:1) = 'X')
                   AND (WS-VIN-REMAINDER = 10))
                           OR
                   (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
                   CONTINUE
                ELSE
                   MOVE ER-3826        TO WS-ERROR
                   PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                END-IF
              ELSE
                MOVE ER-3826           TO WS-ERROR
                PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
           END-IF



01637 ******************************************************************ELC50PD
01638 ******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM       ELC50PD
01639 ******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND    ELC50PD
01640 ******* METHODS.                                                  ELC50PD
01641 ******************************************************************ELC50PD
01642      IF PB-COMPANY-ID EQUAL TO 'NCL'                              ELC50PD
01643         IF PB-CANCELLATION                                        ELC50PD
01644            IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)       ELC50PD
01645               OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))    ELC50PD
01646                 PERFORM 3350-GET-ERFORM THRU 3350-EXIT            ELC50PD
01647                 IF FORM-MASTER-FOUND                              ELC50PD
01648                     PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.   ELC50PD
01649 ******************************************************************ELC50PD
01650                                                                   ELC50PD
01651      MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.               ELC50PD
01652      MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.               ELC50PD
01653                                                                   ELC50PD
01654      MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.          ELC50PD
01655      MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.           ELC50PD
01656      MOVE AM-STATUS              TO WS-ACCT-STATUS.               ELC50PD
01657      MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.          ELC50PD
01658                                                                   ELC50PD
01659                                                                   ELC50PD
01660      MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.        ELC50PD
01661      MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.               ELC50PD
01662      MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.          ELC50PD
01663                                                                   ELC50PD
01664      IF AM-LF-OB-RATE NOT NUMERIC                                 ELC50PD
01665          MOVE ZERO               TO AM-LF-OB-RATE.                ELC50PD
01666                                                                   ELC50PD
01667      IF AM-LF-OB-RATE-JNT NOT NUMERIC                             ELC50PD
01668          MOVE ZERO               TO AM-LF-OB-RATE-JNT.            ELC50PD
01669                                                                   ELC50PD
01670      IF AM-AH-OB-RATE NOT NUMERIC                                 ELC50PD
01671          MOVE ZERO               TO AM-AH-OB-RATE.                ELC50PD
01672                                                                   ELC50PD
01673      IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
01674          MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT              ELC50PD
01675      ELSE                                                         ELC50PD
01676          MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.             ELC50PD
01677                                                                   ELC50PD
01678      MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.             ELC50PD
01679                                                                   ELC50PD
01680      IF WS-IG-OVRD-AM  EQUAL SPACE                                ELC50PD
01681          MOVE AM-IG              TO WS-IG-OVRD-AM.                ELC50PD
01682                                                                   ELC50PD
01683      IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE                          ELC50PD
01684          MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH              ELC50PD
01685                                        WS-IG-OVRD                 ELC50PD
01686      ELSE                                                         ELC50PD
01687          IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE                     ELC50PD
01688              MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH              ELC50PD
01689                                        WS-IG-OVRD                 ELC50PD
01690          ELSE                                                     ELC50PD
01691              MOVE AM-IG             TO WS-IG-OVRD-AH              ELC50PD
01692                                        WS-IG-OVRD.                ELC50PD
01693                                                                   ELC50PD
01694      IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE                          ELC50PD
01695          MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF              ELC50PD
01696                                        WS-IG-OVRD                 ELC50PD
01697      ELSE                                                         ELC50PD
01698          IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE                     ELC50PD
01699              MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF              ELC50PD
01700                                        WS-IG-OVRD                 ELC50PD
01701          ELSE                                                     ELC50PD
01702              MOVE AM-IG             TO WS-IG-OVRD-LF              ELC50PD
01703                                        WS-IG-OVRD.                ELC50PD
01704                                                                   ELC50PD
01705      INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.         ELC50PD
01706      INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.         ELC50PD
01707      INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.         ELC50PD
01708      INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.         ELC50PD
040708     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
01710                                                                   ELC50PD
01711      MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.               ELC50PD
01712      MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.               ELC50PD
01713      MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.           ELC50PD
01714      MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.         ELC50PD
01715                                                                   ELC50PD
01716      MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.           ELC50PD
01717      MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.         ELC50PD
01718      MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.             ELC50PD
01719      MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.           ELC50PD
01720      MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.          ELC50PD
01721      MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.                ELC50PD
01722      MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.                ELC50PD
01723                                                                   ELC50PD
01724      IF WS-ACCT-AH-DEV-PCT > +0                                   ELC50PD
01725         MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT       ELC50PD
01726      ELSE                                                         ELC50PD
01727         MOVE +0                     TO EC-AM-AH-DEV-PERCENT.      ELC50PD
01728                                                                   ELC50PD
01729      IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
01730         MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.      ELC50PD
01731      IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
01732         MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.      ELC50PD
01733                                                                   ELC50PD
01734         IF AM-EARN-METHOD-L = 'S'                                 ELC50PD
01735             MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
01736                                         WS-LF-REFUND-CALC.        ELC50PD
01737                                                                   ELC50PD
01738         IF AM-EARN-METHOD-R = 'S'                                 ELC50PD
01739             MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
01740                                         WS-LF-REFUND-CALC.        ELC50PD
01741                                                                   ELC50PD
01742      IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
01743          IF AM-EARN-METHOD-R = 'R'                                ELC50PD
01744             MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
01745                                     WS-LF-REFUND-CALC.            ELC50PD
01746      IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
01747          IF AM-EARN-METHOD-R = 'P'                                ELC50PD
01748             MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
01749                                     WS-LF-REFUND-CALC.            ELC50PD
01750      IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
01751          IF AM-EARN-METHOD-L = 'R'                                ELC50PD
01752             MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
01753                                     WS-LF-REFUND-CALC.            ELC50PD
01754      IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
01755          IF AM-EARN-METHOD-L = 'P'                                ELC50PD
01756             MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
01757                                     WS-LF-REFUND-CALC.            ELC50PD
01758      IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
01759          IF AM-EARN-METHOD-R = 'A'                                ELC50PD
01760             MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
01761                                     WS-LF-REFUND-CALC.            ELC50PD
01762      IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
01763          IF AM-EARN-METHOD-R = 'M'                                ELC50PD
01764             MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
01765                                     WS-LF-REFUND-CALC.            ELC50PD
01766      IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
01767          IF AM-EARN-METHOD-L = 'A'                                ELC50PD
01768             MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
01769                                     WS-LF-REFUND-CALC.            ELC50PD
01770      IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
01771          IF AM-EARN-METHOD-L = 'M'                                ELC50PD
01772             MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
01773                                     WS-LF-REFUND-CALC.            ELC50PD
01774                                                                   ELC50PD
01775      IF AM-EARN-METHOD-A = 'R'                                    ELC50PD
01776         MOVE '1'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
01777                                     WS-AH-REFUND-CALC.            ELC50PD
01778      IF AM-EARN-METHOD-A = 'P'                                    ELC50PD
01779         MOVE '2'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
01780                                     WS-AH-REFUND-CALC.            ELC50PD
01781      IF AM-EARN-METHOD-A = 'C'                                    ELC50PD
01782         MOVE '3'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
01783                                     WS-AH-REFUND-CALC.            ELC50PD
01784      IF AM-EARN-METHOD-A = 'A'                                    ELC50PD
01785         MOVE '6'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
01786                                     WS-AH-REFUND-CALC.            ELC50PD
01787      IF AM-EARN-METHOD-A = 'M'                                    ELC50PD
01788         MOVE '8'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
01789                                     WS-AH-REFUND-CALC.            ELC50PD
01790      IF AM-EARN-METHOD-A = 'N'                                    ELC50PD
01791         MOVE '5'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
01792                                     WS-AH-REFUND-CALC.            ELC50PD
01793      IF AM-EARN-METHOD-A = 'S'                                    ELC50PD
01794         MOVE '9'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
01795                                     WS-AH-REFUND-CALC.            ELC50PD
01796                                                                   ELC50PD
01797      IF AM-TOL-PREM NOT = ZEROS                                   ELC50PD
01798         MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM                ELC50PD
01799                                     WS-TOL-AH-PREM.               ELC50PD
01800                                                                   ELC50PD
01801      IF AM-OVR-SHT-AMT NUMERIC AND                                ELC50PD
01802                   AM-OVR-SHT-AMT > 0                              ELC50PD
01803         MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT          ELC50PD
01804                                     EC-AM-LF-OVR-SHT-AMT          ELC50PD
01805                                     WS-AH-REFUND-OVS-AMT          ELC50PD
01806                                     EC-AM-AH-OVR-SHT-AMT.         ELC50PD
01807                                                                   ELC50PD
01808      IF AM-OVR-SHT-PCT NUMERIC AND                                ELC50PD
01809                     AM-OVR-SHT-PCT > 0                            ELC50PD
01810         MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT          ELC50PD
01811                                     EC-AM-LF-OVR-SHT-PCT          ELC50PD
01812                                     WS-AH-REFUND-OVS-PCT          ELC50PD
01813                                     EC-AM-AH-OVR-SHT-PCT.         ELC50PD
01814                                                                   ELC50PD
01815      IF AM-TOL-REF-PCT NUMERIC AND                                ELC50PD
01816                   AM-TOL-REF-PCT > 0                              ELC50PD
01817         MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT          ELC50PD
01818                                     WS-TOL-AH-REFUND-PCT.         ELC50PD
01819                                                                   ELC50PD
01820      IF AM-TOL-REF  NOT = ZEROS  AND                              ELC50PD
01821                   AM-TOL-REF NUMERIC                              ELC50PD
01822         MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND              ELC50PD
01823                                     EC-AM-LF-TOL-REFUND           ELC50PD
01824                                     WS-TOL-AH-REFUND              ELC50PD
01825                                     EC-AM-AH-TOL-REFUND.          ELC50PD
01826                                                                   ELC50PD
01827      IF AM-TOL-CLM  NOT = ZEROS                                   ELC50PD
01828         MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM               ELC50PD
01829                                     WS-TOL-AH-CLAIM.              ELC50PD
01830                                                                   ELC50PD
100703     IF AM-CLP-TOL-PCT NOT NUMERIC
100703        MOVE +0                  TO AM-CLP-TOL-PCT
100703     END-IF
100703
092705     IF AM-SPP-LEASE-COMM NOT NUMERIC
092705        MOVE +0                  TO AM-SPP-LEASE-COMM
092705     END-IF

01831      IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0                        ELC50PD
01832         MOVE WS-PL-TOL-LF-PREM-PCT                                ELC50PD
01833                                  TO WS-TOL-LF-PREM-PCT.           ELC50PD
01834                                                                   ELC50PD
01835      IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0                        ELC50PD
01836         MOVE WS-PL-TOL-AH-PREM-PCT                                ELC50PD
01837                                  TO WS-TOL-AH-PREM-PCT.           ELC50PD
01838                                                                   ELC50PD
01839      IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0                      ELC50PD
01840         MOVE WS-PL-TOL-LF-REFUND-PCT                              ELC50PD
01841                                  TO WS-TOL-LF-REFUND-PCT.         ELC50PD
01842                                                                   ELC50PD
01843      IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0                      ELC50PD
01844         MOVE WS-PL-TOL-AH-REFUND-PCT                              ELC50PD
01845                                  TO WS-TOL-AH-REFUND-PCT.         ELC50PD
01846                                                                   ELC50PD
01847      IF WS-PL-REF-OVS-AMT > +0                                    ELC50PD
01848         MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.           ELC50PD
01849                                                                   ELC50PD
01850      IF WS-PL-REF-OVS-PCT > +0                                    ELC50PD
01851         MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT            ELC50PD
01852                                                                   ELC50PD
01853      IF WS-PL-TOL-LF-PREM NOT EQUAL +0                            ELC50PD
01854         MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.               ELC50PD
01855      IF WS-PL-TOL-AH-PREM NOT EQUAL +0                            ELC50PD
01856         MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.               ELC50PD
01857      IF WS-PL-TOL-LF-REFUND NOT EQUAL +0                          ELC50PD
01858         MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.             ELC50PD
01859      IF WS-PL-TOL-AH-REFUND NOT EQUAL +0                          ELC50PD
01860         MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.             ELC50PD
01861      IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0                           ELC50PD
01862         MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.              ELC50PD
01863      IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0                           ELC50PD
01864         MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.              ELC50PD
01865                                                                   ELC50PD
01866      IF WS-AH-PL-REF-OVS-AMT > +0                                 ELC50PD
01867         MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.        ELC50PD
01868                                                                   ELC50PD
01869      IF WS-AH-PL-REF-OVS-PCT > +0                                 ELC50PD
01870         MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.        ELC50PD
01871                                                                   ELC50PD
01872      MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.            ELC50PD
01873      MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.            ELC50PD
01874                                                                   ELC50PD
01875      IF PB-CANCELLATION                                           ELC50PD
01876         GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
01877                                                                   ELC50PD
01878      MOVE +1 TO SUB1.                                             ELC50PD
01879      MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.                ELC50PD
01880      MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.                ELC50PD
01881                                                                   ELC50PD
01882      IF CF-COMPANY-ID = 'DMD'                                     ELC50PD
01883        IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES                 ELC50PD
01884          MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD                 ELC50PD
01885         ELSE                                                      ELC50PD
01886          MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.                ELC50PD
01887                                                                   ELC50PD
01888   0525-FIND-ACCT-COMM.                                            ELC50PD
01889      IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'              ELC50PD
01890         NEXT SENTENCE                                             ELC50PD
01891       ELSE                                                        ELC50PD
01892          ADD +1 TO SUB1                                           ELC50PD
01893          IF SUB1 LESS +11                                         ELC50PD
01894             GO TO 0525-FIND-ACCT-COMM                             ELC50PD
01895           ELSE                                                    ELC50PD
01896              GO TO 0560-EDIT-CONTINUE.                            ELC50PD
01897                                                                   ELC50PD
01898      MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.              ELC50PD
01899      MOVE ZERO                   TO PB-I-AH-COMMISSION            ELC50PD
01900                                     PB-I-LIFE-COMMISSION.         ELC50PD
01901 ***  IF PB-COMPANY-ID = 'CRI'                                        CL**9
01902      IF PB-PREM-ACCTNG-ONLY                                          CL**9
01903          GO TO 0560-EDIT-CONTINUE.                                   CL**9
01904                                                                   ELC50PD
01905      MOVE '0530' TO CTBL-SW.                                      ELC50PD
01906      MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
01907                                                                   ELC50PD
01908                                                                   ELC50PD
01909  0530-GET-AH-COMP.                                                ELC50PD
01910      IF NO-AH-COVERAGE  OR                                        ELC50PD
01911         NO-AH-BENEFIT-MATCH                                       ELC50PD
01912            GO TO 0540-NEXT-READ-STEP.                             ELC50PD
01913                                                                   ELC50PD
01914      IF AM-A-COM (SUB1) NUMERIC                                   ELC50PD
PEMUNI        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
01915          MOVE AM-A-COM (SUB1)    TO WS-COMMISSION                 ELC50PD
01916          MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE                 ELC50PD
01917          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT      ELC50PD
01918          MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION            ELC50PD
01919      ELSE                                                         ELC50PD
01920           MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE                 ELC50PD
01921           MOVE PB-I-AH-TERM      TO WS-WORK-TERM                  ELC50PD
01922           MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE                 ELC50PD
01923           MOVE ZEROS             TO WS-SUB1                       ELC50PD
01924                                     WS-COMMISSION                 ELC50PD
01925           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT     ELC50PD
01926           MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE                    ELC50PD
01927           IF WS-COMMISSION > ZEROS                                ELC50PD
01928              MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION            ELC50PD
01929              GO TO 0540-NEXT-READ-STEP                            ELC50PD
01930           END-IF                                                  ELC50PD
01931           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT             ELC50PD
01932           IF CTBL-TABLE-FOUND                                     ELC50PD
01933              COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *       ELC50PD
01934                                         PB-I-AH-TERM              ELC50PD
01935              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT            ELC50PD
01936              MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION         ELC50PD
01937              GO TO 0540-NEXT-READ-STEP                            ELC50PD
01938           ELSE                                                    ELC50PD
01939              IF FIRST-TIME-THROUGH                                ELC50PD
01940                  GO TO 0530-GET-AH-COMP                           ELC50PD
01941              ELSE                                                 ELC50PD
01942                  MOVE ER-2609                TO WS-ERROR          ELC50PD
01943                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           CL**2
01944                                                                   ELC50PD
01945  0540-NEXT-READ-STEP.                                             ELC50PD
01946      MOVE '0540' TO CTBL-SW.                                      ELC50PD
01947      MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
01948                                                                   ELC50PD
01949  0540-GET-LF-COMP.                                                ELC50PD
01950      IF NO-LIFE-COVERAGE  OR                                      ELC50PD
01951         NO-LF-BENEFIT-MATCH                                       ELC50PD
01952            GO TO 0560-EDIT-CONTINUE.                              ELC50PD
01953                                                                   ELC50PD
01954      IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
01955         IF AM-J-COM (SUB1) NUMERIC                                ELC50PD
pemuni           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
01956            MOVE AM-J-COM (SUB1)      TO WS-COMMISSION             ELC50PD
01957            MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
01958            PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
01959            MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
01960         ELSE                                                      ELC50PD
01961            MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
01962            MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
01963            MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
01964            MOVE ZEROS                TO WS-SUB1                   ELC50PD
01965                                         WS-COMMISSION             ELC50PD
01966            PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
01967            IF WS-COMMISSION > ZEROS                               ELC50PD
01968               MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
01969               GO TO 0560-EDIT-CONTINUE                            ELC50PD
01970            END-IF                                                 ELC50PD
01971            MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
01972            PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
01973            IF CTBL-TABLE-FOUND                                    ELC50PD
01974               MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
01975               PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
01976               MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
01977               GO TO 0560-EDIT-CONTINUE                            ELC50PD
01978            ELSE                                                   ELC50PD
01979               IF FIRST-TIME-THROUGH                               ELC50PD
01980                   GO TO 0540-GET-LF-COMP                          ELC50PD
01981               ELSE                                                ELC50PD
01982                   MOVE ER-2609                TO WS-ERROR         ELC50PD
01983                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
01984                   GO TO 0560-EDIT-CONTINUE.                          CL**2
01985                                                                   ELC50PD
01986      IF WS-LF-JOINT-INDICATOR IS NOT = 'J'                        ELC50PD
01987         IF AM-L-COM (SUB1) NUMERIC                                ELC50PD
pemuni           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
01988            MOVE AM-L-COM (SUB1)      TO WS-COMMISSION             ELC50PD
01989            MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
01990            PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
01991            MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
01992         ELSE                                                      ELC50PD
01993            MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
01994            MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
01995            MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
01996            MOVE ZEROS                TO WS-SUB1                   ELC50PD
01997                                         WS-COMMISSION             ELC50PD
01998            PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
01999            IF WS-COMMISSION IS GREATER THAN ZEROS                 ELC50PD
02000               MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
02001               GO TO 0560-EDIT-CONTINUE                            ELC50PD
02002            END-IF                                                 ELC50PD
02003            MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
02004            PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
02005            IF CTBL-TABLE-FOUND                                    ELC50PD
02006               MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
02007               PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
02008               MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
02009               GO TO 0560-EDIT-CONTINUE                            ELC50PD
02010            ELSE                                                   ELC50PD
02011               IF FIRST-TIME-THROUGH                               ELC50PD
02012                   GO TO 0540-GET-LF-COMP                          ELC50PD
02013               ELSE                                                ELC50PD
02014                   MOVE ER-2609                TO WS-ERROR         ELC50PD
02015                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          CL**2
02016                                                                   ELC50PD
02017 *    GO TO 0560-EDIT-CONTINUE.                                    ELC50PD
02018                                                                   ELC50PD
02019  0560-EDIT-CONTINUE.                                              ELC50PD

011410     MOVE ZEROS                  TO WS-LF-PMF-COMM
011410                                    WS-AH-PMF-COMM
      *****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
      *****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES

           PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
              (SUB1 > +10)
011410        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
                 MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
                 MOVE '0530'           TO CTBL-SW
                 MOVE ' '              TO WS-CTBL-READ-SW
                 PERFORM 0561-CHECK-AH THRU 0561-EXIT
                 MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
                 MOVE '0540'           TO CTBL-SW
                 MOVE ' '              TO WS-CTBL-READ-SW
                 PERFORM 0563-CHECK-LF THRU 0563-EXIT
              END-IF
           END-PERFORM

           GO TO 0564-EDIT-CONTINUE

           .
       0561-CHECK-AH.

           IF (NO-AH-COVERAGE)
              OR (NO-AH-BENEFIT-MATCH)
              CONTINUE
           ELSE
              IF (AM-A-COM (SUB1) NUMERIC)
                 AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
011410           IF (AM-COM-TYP (SUB1) = 'A')
011410              AND (WS-AH-PMF-COMM = ZEROS)
011410              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
011410           END-IF
                 CONTINUE
              ELSE
                 MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
                 MOVE PB-I-AH-TERM     TO WS-WORK-TERM
                 MOVE PB-AH-OVERRIDE-L1
                                       TO CTBL-BEN-TYPE
                 MOVE ZEROS            TO WS-SUB1
                                          WS-COMMISSION
                 MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
                 PERFORM 8300-READ-CTBL-TABLE
                                       THRU 8300-EXIT
                 IF CTBL-TABLE-FOUND
011410              IF (AM-COM-TYP (SUB1) = 'A')
011410                 AND (WS-AH-PMF-COMM = ZEROS)
011410                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
011410                                        PB-I-AH-TERM
011410                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
011410                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
                    END-IF
                    CONTINUE
                 ELSE
                    IF FIRST-TIME-THROUGH
                       GO TO 0561-CHECK-AH
                    ELSE
                       MOVE ER-2609    TO WS-ERROR
                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                    END-IF
                 END-IF
              END-IF
           END-IF

           .
       0561-EXIT.
           EXIT.
           
       0563-CHECK-LF.
       
           IF (NO-LIFE-COVERAGE)
              OR (NO-LF-BENEFIT-MATCH)
              CONTINUE
           ELSE
              IF WS-LF-JOINT-INDICATOR = 'J'
                 IF AM-J-COM (SUB1) NUMERIC
                    AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
011410              IF (AM-COM-TYP (SUB1) = 'A')
011410                 AND (WS-LF-PMF-COMM = ZEROS)
011410                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
011410              END-IF
                    CONTINUE
                 ELSE
                    MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
                    MOVE PB-I-LF-TERM  TO WS-WORK-TERM
                    MOVE PB-LIFE-OVERRIDE-L1
                                       TO CTBL-BEN-TYPE
                    MOVE ZEROS         TO WS-SUB1
                                          WS-COMMISSION
                    MOVE AM-J-COMA (SUB1)
                                       TO CTBL-TABLE
                    PERFORM 8300-READ-CTBL-TABLE
                                       THRU 8300-EXIT
                    IF CTBL-TABLE-FOUND
011410                 IF (AM-COM-TYP (SUB1) = 'A')
011410                    AND (WS-LF-PMF-COMM = ZEROS)
011410                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
011410                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
011410                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
011410                 END-IF
                       CONTINUE
                    ELSE
                       IF FIRST-TIME-THROUGH
                          GO TO 0563-CHECK-LF
                       ELSE
                          MOVE ER-2609 TO WS-ERROR
                          PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
      *                   GO TO 0560-EDIT-CONTINUE
                       END-IF
                    END-IF
                 END-IF
              ELSE
                 IF AM-L-COM (SUB1) NUMERIC
                    AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
011410              IF (AM-COM-TYP (SUB1) = 'A')
011410                 AND (WS-LF-PMF-COMM = ZEROS)
011410                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
011410              END-IF
                    CONTINUE
                 ELSE
                    MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
                    MOVE PB-I-LF-TERM  TO WS-WORK-TERM
                    MOVE PB-LIFE-OVERRIDE-L1
                                       TO CTBL-BEN-TYPE
                    MOVE ZEROS         TO WS-SUB1
                                          WS-COMMISSION
                    MOVE AM-L-COMA (SUB1)
                                       TO CTBL-TABLE
                    PERFORM 8300-READ-CTBL-TABLE
                                       THRU 8300-EXIT
                    IF CTBL-TABLE-FOUND
                       CONTINUE
                    ELSE
                       IF FIRST-TIME-THROUGH
                          GO TO 0563-CHECK-LF
                       ELSE
                          MOVE ER-2609 TO WS-ERROR
                          PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                       END-IF
                    END-IF
                 END-IF
              END-IF
           END-IF
                        
           .
       0563-EXIT.
           EXIT.

       0564-EDIT-CONTINUE.
02020                                                                   ELC50PD
02021      IF  PB-COMPANY-ID EQUAL 'DMD'                                ELC50PD
02022          IF PB-I-NUM-BILLED EQUAL ZEROS                           ELC50PD
02023             MOVE ER-8148       TO WS-ERROR                        ELC50PD
02024             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
02025                                                                   ELC50PD
02026 *    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE                     ELC50PD
02027 *         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1                  ELC50PD
02028 *         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2                  ELC50PD
02029 *         SET ELAPSED-BETWEEN-BIN TO TRUE                         ELC50PD
02031 *         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
02032 *         IF NO-CONVERSION-ERROR                                  ELC50PD
02033 *             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12        ELC50PD
02034 *         ELSE                                                    ELC50PD
02035 *             IF PB-COMPANY-ID EQUAL 'HAN'                        ELC50PD
02036 *                 MOVE ZEROS     TO PB-I-AGE.                     ELC50PD

           IF PB-I-BIRTHDAY > LOW-VALUES
              MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
              MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
              SET ELAPSED-BETWEEN-BIN  TO TRUE
              PERFORM 8500-DATE-CONVERT
                                       THRU 8500-EXIT
              IF NO-CONVERSION-ERROR
                 COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
                 IF PB-I-AGE > ZEROS
                    IF WS-WORK-AGE NOT = PB-I-AGE
                       MOVE ER-9501    TO WS-ERROR
                       PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                    END-IF
                 ELSE
                    MOVE WS-WORK-AGE   TO PB-I-AGE
                 END-IF
              END-IF
           END-IF

011513     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
011513                                   WS-INS-AGE-SET
02038      IF PB-I-AGE = ZEROS                                          ELC50PD
02039         IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'                  ELC50PD
011513           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
011513                                   WS-INS-AGE-SET
02040            MOVE WS-DEFAULT-AGE  TO PB-I-AGE.                      ELC50PD
02041                                                                   ELC50PD
02042      MOVE PB-I-AGE              TO WS-EDIT-AGE                    ELC50PD
02043                                    WS-AH-EDIT-AGE.                ELC50PD
02044                                                                   ELC50PD
090908     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
              MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
              MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
              SET ELAPSED-BETWEEN-BIN  TO TRUE
              PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        
              IF NO-CONVERSION-ERROR                          
                 COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
                 IF PB-I-JOINT-AGE > 0
                    IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
                       MOVE ER-9503    TO WS-ERROR
                       PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                    END-IF
                 ELSE
                    MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
                 END-IF
              ELSE
                 MOVE ZEROS            TO PB-I-JOINT-AGE
              END-IF
           END-IF
            
02045      IF PB-I-JOINT-AGE NOT NUMERIC                                ELC50PD
02046         MOVE ZERO               TO PB-I-JOINT-AGE.                ELC50PD
02047                                                                   ELC50PD
011513     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
011513                                   WS-JNT-AGE-SET
030612     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
02049         IF (WS-LF-JOINT-INDICATOR = 'J')  OR                      ELC50PD
02050            (WS-AH-JOINT-INDICATOR = 'J')                          ELC50PD
02051            IF PB-I-JOINT-AGE = ZEROS                              ELC50PD
011513               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
011513                                          WS-JNT-AGE-SET
02052                MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
                 END-IF
              END-IF
           END-IF
02053                                                                   ELC50PD
           MOVE ' ' TO PB-I-LIFE-INDICATOR
02054      IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
02055         MOVE 'J'                TO PB-I-LIFE-INDICATOR            ELC50PD
02056         IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
02057             IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
02058                 MOVE ER-2686       TO WS-ERROR                    ELC50PD
02059                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
02060             ELSE                                                  ELC50PD
02061                 IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
02062                     MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE            ELC50PD
02063                     IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
02064                         MOVE ER-2685    TO WS-ERROR               ELC50PD
02065                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
02066                                                                   ELC50PD
02067      IF WS-AH-JOINT-INDICATOR = 'J'                               ELC50PD
02068         IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
02069             IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
02070                 MOVE ER-2686       TO WS-ERROR                    ELC50PD
02071                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
02072             ELSE                                                  ELC50PD
02073                 IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
02074                     MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE         ELC50PD
072109                                           WS-EDIT-AGE
02075                     IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
02076                         MOVE ER-2685    TO WS-ERROR               ELC50PD
02077                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
02078                                                                   ELC50PD
02079 ******************************************************************ELC50PD
02080 *    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS         ELC50PD
02081 ******************************************************************ELC50PD
02082                                                                   ELC50PD
02083      IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
02084         (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
02085         NEXT SENTENCE                                             ELC50PD
02086      ELSE                                                         ELC50PD
02087         IF PB-I-AGE LESS THAN WS-MIN-AGE  OR                      ELC50PD
02088           (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND               ELC50PD
02089            (WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
02090             WS-AH-JOINT-INDICATOR = 'J')  AND                     ELC50PD
02091            (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                      ELC50PD
02092             MOVE ER-2627             TO WS-ERROR                  ELC50PD
02093             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
02094                                                                   ELC50PD
02095      IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
02096         (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
02097          NEXT SENTENCE                                            ELC50PD
02098      ELSE                                                         ELC50PD
02099          IF WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
02100             WS-AH-JOINT-INDICATOR = 'J'                           ELC50PD
02101              IF PB-I-JOINT-INSURED = SPACES                       ELC50PD
02102                  IF PB-COMPANY-ID NOT = 'JAL'                     ELC50PD
02103                      MOVE ER-2696    TO WS-ERROR                  ELC50PD
02104                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    ELC50PD
02105                                                                   ELC50PD
02106      IF PB-COMPANY-ID NOT = 'BOA'                                 ELC50PD
02107         IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
02108            (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
02109            IF (PB-I-JOINT-AGE NOT = ZEROS OR                      ELC50PD
02110                PB-I-JOINT-INSURED NOT = SPACES)                   ELC50PD
02111                 MOVE ER-2691         TO WS-ERROR                  ELC50PD
02112                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
02113                                                                   ELC50PD
02114      IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
02115         IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
02116            (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
02117             IF PB-I-JOINT-AGE NOT = ZEROS                         ELC50PD
02118                 MOVE ER-2691         TO WS-ERROR                  ELC50PD
02119                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
02120                                                                   ELC50PD
02121      IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
02122         IF PB-I-SIG-SW = 'J'                                      ELC50PD
02123            IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND                ELC50PD
02124               WS-AH-JOINT-INDICATOR NOT = 'J'                     ELC50PD
02125               MOVE ER-2675       TO WS-ERROR                      ELC50PD
02126               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
02127                                                                   ELC50PD
02128      IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
02129         IF PB-I-SIG-SW = 'S'                                      ELC50PD
02130            IF WS-LF-JOINT-INDICATOR = 'J'  OR                     ELC50PD
02131               WS-AH-JOINT-INDICATOR = 'J'                         ELC50PD
02132               MOVE ER-2676       TO WS-ERROR                      ELC50PD
02133               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
02134                                                                   ELC50PD
02135      IF PB-COMPANY-ID = 'CVL'                                     ELC50PD
02136          IF (WS-AH-JOINT-INDICATOR = 'J') AND                     ELC50PD
02137             (WS-LF-JOINT-INDICATOR NOT = 'J')                     ELC50PD
02138               MOVE ER-2783           TO WS-ERROR                  ELC50PD
02139               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD

031611     IF (WS-LF-JOINT-INDICATOR = 'J')
031611        AND (WS-AH-JOINT-INDICATOR = 'J')
031611        AND (PB-I-LF-TERM > 120)
031611        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
031611        MOVE ER-2783             TO WS-ERROR
031611        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
031611     END-IF

02141      MOVE SPACE                  TO PB-I-INDV-GRP-CD.             ELC50PD
02142                                                                   ELC50PD
02143      IF PB-I-INDV-GRP-OVRD = 'I'                                  ELC50PD
02144         MOVE ER-2666             TO WS-ERROR                      ELC50PD
02145         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02146         MOVE 'I'                 TO PB-I-INDV-GRP-CD.             ELC50PD
02147                                                                   ELC50PD
02148      IF PB-I-INDV-GRP-OVRD = 'G'                                  ELC50PD
02149         MOVE ER-2666             TO WS-ERROR                      ELC50PD
02150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02151         MOVE 'G'                 TO PB-I-INDV-GRP-CD.             ELC50PD
02152                                                                   ELC50PD
02153      IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'                           ELC50PD
02154         NEXT SENTENCE                                             ELC50PD
02155      ELSE                                                         ELC50PD
02156         MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.             ELC50PD
02157                                                                   ELC50PD
02158      IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD                           ELC50PD
02159         IF WS-ERROR = ER-2666                                     ELC50PD
02160            MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)        ELC50PD
02161            SUBTRACT +1           FROM PB-NO-OF-ERRORS.            ELC50PD
123102
123102     IF PB-COMPANY-ID = 'CID'
123102        IF PB-STATE = 'UT' OR 'MO'
123102           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
123102                 OR '76' OR '77')
123102                      OR
123102               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
123102                   OR '41' OR '42' OR '63' OR '64' OR '65'
123102                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
123102                   OR '2K' OR '2L'))                
123102              AND PB-I-INDV-GRP-CD = 'I'
123102              MOVE ER-2721             TO WS-ERROR
123102              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
123102           END-IF
123102        END-IF
123102     END-IF
02162                                                                   ELC50PD
PEMMOD     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
PEMMOD     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
PEMMOD        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
PEMMOD     ELSE
PEMMOD        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
PEMMOD     END-IF
PEMMOD
100703*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
100703*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
02163      MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW            ELC50PD
02164                                     ACCOUNT-AH-CK-SW.             ELC50PD
02165                                                                   ELC50PD
02166      IF PB-REISSUED-CERT       OR                                 ELC50PD
02167         PB-REIN-ONLY-CERT      OR                                 ELC50PD
02168         PB-POLICY-IS-DECLINED  OR                                 ELC50PD
02169         PB-POLICY-IS-VOIDED                                       ELC50PD
093005*       OR PB-MONTHLY-CERT
02170          GO TO 3000-CONTINUE-EDIT.                                ELC50PD
02171                                                                   ELC50PD
030612     IF PB-COMPANY-ID = 'CID' OR 'AHL'
082003        IF WS-EDIT-AGE           > +65
082003           MOVE ER-2709          TO WS-ERROR
082003           PERFORM 9900-ERROR-FORMAT
082003                                 THRU 9900-EXIT
082003        ELSE
082003           IF WS-EDIT-AGE        > +55
082003              MOVE ER-2718       TO WS-ERROR
082003              PERFORM 9900-ERROR-FORMAT
082003                                 THRU 9900-EXIT
082003           END-IF
082003        END-IF

093005     IF PB-COMPANY-ID = 'DCC'
093005        IF WS-EDIT-AGE           > +65
093005           MOVE ER-2709          TO WS-ERROR
093005           PERFORM 9900-ERROR-FORMAT
093005                                 THRU 9900-EXIT
              END-IF
           END-IF
093005     .
082003
02172  0565-LIFE-PLAN-LIMIT-EDITS.                                      ELC50PD
02173                                                                   ELC50PD
02174      IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
072111        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
083111                                    EC-AM-LF-MAX-TOT-BEN
02175         GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
02176                                                                   ELC50PD
02177      MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
02178                                                                   ELC50PD
02179      IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
02180          IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
02181              GO TO 0580-AH-PLAN-LIMIT-EDITS.                      ELC50PD
02182                                                                   ELC50PD
02183      IF NO-LF-BENEFIT-MATCH          OR                           ELC50PD
02184         WS-LF-BENEFIT-CD = ZEROS     OR                           ELC50PD
02185         WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
02186         GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
02187                                                                   ELC50PD
02188      MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.           ELC50PD
02189      MOVE +1                     TO SUB2.                         ELC50PD
02190                                                                   ELC50PD
02191      IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
02192         IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
02193            MOVE +5   TO SUB2                                      ELC50PD
02194            IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
02195               (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
02196               (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
02197               MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW                    ELC50PD
02198               GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
02199                                                                   ELC50PD
02200      COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
02201                                                                   ELC50PD
02202      COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
02203                                + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
02204                                                                   ELC50PD
02205  0568-CHECK-LIFE-ATT-AGE.                                         ELC50PD
02206                                                                   ELC50PD

02207      IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
02208         PL-ATT-AGE > +0
02209         MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
           END-IF



02207 *    IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
02208 *       PL-ATT-AGE > +0
02209 *       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE          ELC50PD
      *       IF PB-I-BIRTHDAY > LOW-VALUES
      *          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
      *          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
      *          MOVE ZERO             TO DC-ELAPSED-DAYS
      *          SET BIN-PLUS-ELAPSED  TO TRUE
      *          PERFORM 8500-DATE-CONVERT
      *                                THRU 8500-EXIT
      *          IF NO-CONVERSION-ERROR
      *             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
      *             MOVE ER-2669       TO WS-ERROR
      *             PERFORM 9900-ERROR-FORMAT
      *                                THRU 9900-EXIT
      *          END-IF
      *       ELSE
02210 *          IF WS-ATT-AGE >= PL-ATT-AGE
02211 *             MOVE ER-2669       TO WS-ERROR                      ELC50PD
02212 *             PERFORM 9900-ERROR-FORMAT
      *                                THRU 9900-EXIT
      *          END-IF
      *       END-IF
      *    END-IF

           .
02214  0570-CHECK-LIFE-LIMITS.                                          ELC50PD
02215                                                                   ELC50PD
02216      IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
02217         IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
02218            IF SUB2 GREATER THAN +4                                ELC50PD
02219               MOVE ER-2637 TO WS-ERROR                            ELC50PD
02220               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
02221               GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
02222                                                                   ELC50PD
02223      IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
02224         IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
02225             SUB2 GREATER THAN +8                                  ELC50PD
02226              MOVE 'U'         TO PB-BATCH-ENTRY                   ELC50PD
02227              MOVE ER-2637     TO WS-ERROR                         ELC50PD
02228              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
02229              GO TO 0575-CHECK-NCL-SIG-SWITCH.                     ELC50PD
02230                                                                   ELC50PD
102706     IF SUB2 > +8
030612        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
                 AND (PB-I-SIG-SW = 'Y')
                 CONTINUE
              ELSE
                 MOVE ER-2637          TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
              GO TO 0580-AH-PLAN-LIMIT-EDITS
           END-IF

02236      MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.                ELC50PD
02237      MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.               ELC50PD
02238      MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.            ELC50PD
02239                                                                   ELC50PD
02240      IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)               ELC50PD
02241         ADD +1  TO SUB2                                           ELC50PD
02242         GO TO 0570-CHECK-LIFE-LIMITS.                             ELC50PD
02243                                                                   ELC50PD
02244      IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
02245          GO TO 0570-CHECK-NCL-LIFE-LIMITS.                        ELC50PD
02246                                                                   ELC50PD
102706     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
              OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
030612        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
                 AND (PB-I-SIG-SW = 'Y')
                 CONTINUE
              ELSE
                 MOVE ER-2637          TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
           END-IF

02252      GO TO 0580-AH-PLAN-LIMIT-EDITS.                              ELC50PD
02253                                                                   ELC50PD
02254                                                                   ELC50PD
02255  0570-CHECK-NCL-LIFE-LIMITS.                                      ELC50PD
02256                                                                   ELC50PD
02257      IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND      ELC50PD
02258         WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)      ELC50PD
02259          GO TO 0575-CHECK-NCL-SIG-SWITCH.                         ELC50PD
02260                                                                   ELC50PD
02261      IF APP-CERT-USED                                             ELC50PD
02262          IF SUB2  LESS THAN  +5                                   ELC50PD
02263              MOVE +5          TO SUB2                             ELC50PD
02264              GO TO 0570-CHECK-LIFE-LIMITS.                        ELC50PD
02265                                                                   ELC50PD
02266      MOVE ER-2637             TO WS-ERROR.                        ELC50PD
02267      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
02268                                                                   ELC50PD
02269      MOVE 'U'                 TO PB-BATCH-ENTRY.                  ELC50PD
02270                                                                   ELC50PD
02271  0575-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
02272                                                                   ELC50PD
02273      IF NOT APP-CERT-USED                                         ELC50PD
02274          GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
02275                                                                   ELC50PD
02276      IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
02277         PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
02278         PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
02279         PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
02280          GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
02281                                                                   ELC50PD
02282      IF SUB2 GREATER THAN +4                                      ELC50PD
02283          IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
02284             PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
02285             PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
02286             PL-LM-AGE (8) = ZEROS                                 ELC50PD
02287              MOVE  ER-1927        TO WS-ERROR                     ELC50PD
02288              PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
02289              GO TO 0580-AH-PLAN-LIMIT-EDITS                       ELC50PD
02290          ELSE                                                     ELC50PD
02291              IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
02292                  MOVE  ER-1920    TO WS-ERROR                     ELC50PD
02293                  PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
02294                                                                   ELC50PD
02295      IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
02296        IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
02297           NOT PB-I-POLICY-DECLINED                                ELC50PD
02298            MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
02299            MOVE  ER-1926          TO WS-ERROR                     ELC50PD
02300            PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
02301                                                                   ELC50PD
02302                                                                   ELC50PD
02303  0580-AH-PLAN-LIMIT-EDITS.                                        ELC50PD
02304                                                                   ELC50PD
030612     IF PB-COMPANY-ID = 'CID' OR 'AHL'
082003        IF PB-I-AH-BENEFIT-AMT > +1250
082003           MOVE ER-2702          TO WS-ERROR
082003           PERFORM 9900-ERROR-FORMAT
082003                                 THRU 9900-EXIT
082003        END-IF
082003     END-IF
08200 
093005     IF (PB-COMPANY-ID = 'DCC')
093005        AND (PB-MONTHLY-CERT)
091012        IF PB-I-AH-BENEFIT-AMT > +3000
093005           MOVE ER-2881          TO WS-ERROR
093005           PERFORM 9900-ERROR-FORMAT
093005                                 THRU 9900-EXIT
093005        END-IF
093005     END-IF

02305      IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
072111        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
02306         GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
02307                                                                   ELC50PD
02308      MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
02309                                                                   ELC50PD
02310      IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
02311          IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
02312              GO TO 3000-CONTINUE-EDIT.                            ELC50PD
02313                                                                   ELC50PD
02314      IF NO-AH-BENEFIT-MATCH          OR                           ELC50PD
02315         WS-AH-BENEFIT-CD = ZEROS     OR                           ELC50PD
02316         WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
02317         GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
02318                                                                   ELC50PD
02319      MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.             ELC50PD
02320      MOVE +1                     TO SUB2.                         ELC50PD
02321                                                                   ELC50PD
02322      IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
02323         IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
02324            MOVE +5 TO SUB2                                        ELC50PD
02325            IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
02326               (PL-LM-MOA (SUB2) EQUAL +0) AND                     ELC50PD
02327               (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
02328               (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
02329               MOVE 'NO ' TO ACCOUNT-AH-CK-SW                      ELC50PD
02330               GO TO 3000-CONTINUE-EDIT.                           ELC50PD
02331                                                                   ELC50PD
02332      COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
02333                                                                   ELC50PD
02334  0590-CHECK-AH-ATT-AGE.                                           ELC50PD
02335                                                                   ELC50PD
02336      IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
02337         PL-ATT-AGE GREATER THAN +0                                ELC50PD
02338         MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
           END-IF
02339 *       IF WS-ATT-AGE >= PL-ATT-AGE
02340 *          MOVE ER-3054          TO WS-ERROR                      ELC50PD
02341 *          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
           .
02343  0597-CHECK-AH-LIMITS.                                            ELC50PD
02344                                                                   ELC50PD
02345      IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
02346         IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
02347            IF SUB2 GREATER THAN +4                                ELC50PD
02348               MOVE ER-2638       TO WS-ERROR                      ELC50PD
02349               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
02350               GO TO 3000-CONTINUE-EDIT.                           ELC50PD
02351                                                                   ELC50PD
02352      IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
02353         IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
02354             SUB2 GREATER THAN +8                                  ELC50PD
02355              MOVE 'U'            TO PB-BATCH-ENTRY                ELC50PD
02356              MOVE ER-2638        TO WS-ERROR                      ELC50PD
02357              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
02358              GO TO 0599-CHECK-NCL-SIG-SWITCH.                     ELC50PD
02359                                                                   ELC50PD
02360      IF SUB2 > +8
030612        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
                 AND (PB-I-SIG-SW = 'Y')
                 CONTINUE
              ELSE
02361            MOVE ER-2638          TO WS-ERROR
02362            PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
02363         GO TO 3000-CONTINUE-EDIT
           END-IF
02364                                                                   ELC50PD
02365      IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
02366         IF WS-ERROR = ER-2638                                     ELC50PD
02367            MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.          ELC50PD
02368                                                                   ELC50PD
02369      MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.             ELC50PD
02370      MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.            ELC50PD
02371      MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.         ELC50PD
02372      MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.         ELC50PD
02373                                                                   ELC50PD
02374      IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)            ELC50PD
02375         ADD +1                   TO SUB2                          ELC50PD
02376         GO TO 0597-CHECK-AH-LIMITS.                               ELC50PD
02377                                                                   ELC50PD
02378      IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
02379          GO TO 0597-CHECK-NCL-AH-LIMITS.                          ELC50PD
02380                                                                   ELC50PD
02381      IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
02382         OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
02383         OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
                                       > PL-LM-AMT (SUB2))
030612        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
                 AND (PB-I-SIG-SW = 'Y')
                 CONTINUE
              ELSE
02385            MOVE ER-2638          TO WS-ERROR
02386            PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
           END-IF
02387                                                                   ELC50PD
02388      IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
02389          IF  WS-ERROR    EQUAL    ER-2638                         ELC50PD
02390              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2) ELC50PD
02391                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT   ELC50PD
02392                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)  ELC50PD
02393                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS              ELC50PD
02394                 MOVE  ER-1910    TO  WS-ERROR                     ELC50PD
02395                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
02396                                                                   ELC50PD
02397      IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
02398         IF WS-ERROR = ER-2638                                     ELC50PD
02399             MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)      ELC50PD
02400             SUBTRACT  +1   FROM  PB-NO-OF-ERRORS                  ELC50PD
02401             MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.          ELC50PD
02402                                                                   ELC50PD
02403      GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
02404                                                                   ELC50PD
02405  0597-CHECK-NCL-AH-LIMITS.                                        ELC50PD
02406                                                                   ELC50PD
02407      IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND     ELC50PD
02408         PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  ANDELC50PD
02409         ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                     ELC50PD
02410                             NOT GREATER THAN PL-LM-AMT (SUB2))    ELC50PD
02411          GO TO 0599-CHECK-NCL-SIG-SWITCH.                         ELC50PD
02412                                                                   ELC50PD
02413      IF APP-CERT-USED                                             ELC50PD
02414          IF SUB2  LESS THAN  +5                                   ELC50PD
02415              MOVE +5             TO SUB2                          ELC50PD
02416              GO TO 0597-CHECK-AH-LIMITS.                          ELC50PD
02417                                                                   ELC50PD
02418      MOVE ER-2638                TO WS-ERROR.                     ELC50PD
02419      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
02420                                                                   ELC50PD
02421      MOVE 'U'                    TO PB-BATCH-ENTRY.               ELC50PD
02422                                                                   ELC50PD
02423  0599-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
02424                                                                   ELC50PD
02425      IF NOT APP-CERT-USED                                         ELC50PD
02426          GO TO 3000-CONTINUE-EDIT.                                ELC50PD
02427                                                                   ELC50PD
02428      IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
02429         PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
02430         PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
02431         PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
02432          GO TO 3000-CONTINUE-EDIT.                                ELC50PD
02433                                                                   ELC50PD
02434      IF SUB2 GREATER THAN +4                                      ELC50PD
02435          IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
02436             PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
02437             PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
02438             PL-LM-AGE (8) = ZEROS                                 ELC50PD
02439              MOVE  ER-1927        TO WS-ERROR                     ELC50PD
02440              PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
02441              GO TO 3000-CONTINUE-EDIT                             ELC50PD
02442          ELSE                                                     ELC50PD
02443              IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
02444                  MOVE  ER-1920    TO WS-ERROR                     ELC50PD
02445                  PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
02446                                                                   ELC50PD
02447      IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
02448        IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
02449           NOT PB-I-POLICY-DECLINED                                ELC50PD
02450            MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
02451            MOVE  ER-1926          TO WS-ERROR                     ELC50PD
02452            PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
02453                                                                   ELC50PD
02454 ******************************************************************ELC50PD
02455      EJECT                                                        ELC50PD
02456                                                                   ELC50PD
02457  3000-CONTINUE-EDIT.                                              ELC50PD
02458                                                                   ELC50PD
02459      MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.            ELC50PD
02460      MOVE AM-CSR-CODE            TO PB-CSR-ID.                    ELC50PD
02461      MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.           ELC50PD
02462      MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.          ELC50PD
02463      MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.      ELC50PD
02464                                                                   ELC50PD
02465      IF BROWSE-STARTED                                            ELC50PD
02466         PERFORM 9990-RETURN THRU 9990-EXIT                        ELC50PD
02467         MOVE SPACES              TO WS-BROWSE-STARTED-SW.         ELC50PD
02468                                                                   ELC50PD
02469      IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT                  ELC50PD
02470         MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1                 ELC50PD
02471         MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2                 ELC50PD
02472         SET ELAPSED-BETWEEN-BIN  TO TRUE                          ELC50PD
02473 *       MOVE 1                   TO DC-OPTION-CODE                ELC50PD
02474         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
02475         IF DATE-CONVERSION-ERROR                                  ELC50PD
02476            MOVE ER-2622          TO WS-ERROR                      ELC50PD
02477            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
02478         ELSE                                                      ELC50PD
02479            IF DC-ELAPSED-MONTHS   GREATER THAN +2                 ELC50PD
02480               MOVE ER-2623       TO WS-ERROR                      ELC50PD
02481               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
02482            ELSE                                                   ELC50PD
02483               MOVE ER-2622       TO WS-ERROR                      ELC50PD
02484               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
02485                                                                   ELC50PD
02486      MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.                ELC50PD
02487      MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.                ELC50PD
02488      SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
02489 *    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
02490      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
02491      IF DATE-CONVERSION-ERROR                                     ELC50PD
02492         GO TO 3005-EDIT-CONTINUE                                  ELC50PD
02493      ELSE                                                         ELC50PD
02494         IF DC-ELAPSED-DAYS GREATER +180                           ELC50PD
02495            MOVE ER-2613          TO WS-ERROR                      ELC50PD
02496            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
02497         ELSE                                                      ELC50PD
02498            IF DC-ELAPSED-DAYS GREATER +90                         ELC50PD
02499               MOVE ER-2612       TO WS-ERROR                      ELC50PD
02500               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
02501            ELSE                                                   ELC50PD
02502              IF DC-ELAPSED-DAYS GREATER +60                       ELC50PD
02503                 MOVE ER-2614     TO WS-ERROR                      ELC50PD
02504                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
02505                                                                   ELC50PD
02506  3005-EDIT-CONTINUE.                                              ELC50PD
02507                                                                   ELC50PD
02508      IF PB-CANCELLATION                                           ELC50PD
02509          GO TO 3700-EDIT-CANCEL.                                     CL**2
02510                                                                   ELC50PD
02511      EJECT                                                        ELC50PD
02512 ******************************************************************ELC50PD
02513 *                  E D I T   I S S U E                           *ELC50PD
02514 ******************************************************************ELC50PD
02515                                                                   ELC50PD
02516  3020-EDIT-ISSUE.                                                 ELC50PD
02517                                                                   ELC50PD
02518       MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.           ELC50PD
02519       MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.      ELC50PD
02520       MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.        ELC50PD
02521       MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.        ELC50PD
02522       MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.                  ELC50PD
02523                                                                   ELC50PD
02524      IF PB-ISSUE-FORCE
073107        OR PB-ISSUE-DATE-FORCED
02525         OR PB-FORCE-OFF
073107        OR PB-OVERCHARGE-FORCE
02526         CONTINUE
02527      ELSE
02528         MOVE ER-2670             TO WS-ERROR
02529         PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
           END-IF

           .
02531  3022-SET-POLICY-STATUS.                                          ELC50PD
02532                                                                   ELC50PD
02533      MOVE '2'                    TO PB-I-ENTRY-STATUS.            ELC50PD
02534                                                                   ELC50PD
111610     IF (PB-REISSUED-CERT)
111610             OR
111610        ((PB-COMPANY-ID NOT = 'DCC')
111610         AND (PB-MONTHLY-CERT))
111610         MOVE '5'                TO PB-I-ENTRY-STATUS
111610         MOVE 'E'                TO PB-BATCH-ENTRY
111610     END-IF
111610
111610     IF PB-COMPANY-ID = 'DCC'
111610        IF PB-MONTHLY-CERT
111610           MOVE 'M'              TO PB-I-ENTRY-STATUS
111610        END-IF
111610     END-IF
02537      IF PB-POLICY-IS-DECLINED                                     ELC50PD
02538          MOVE 'D'                TO PB-I-ENTRY-STATUS.            ELC50PD
02539      IF PB-POLICY-IS-VOIDED                                       ELC50PD
02540          MOVE 'V'                TO PB-I-ENTRY-STATUS.            ELC50PD
02541      IF PB-NEEDS-UNDERWRITING                                     ELC50PD
02542          MOVE 'U'                TO PB-I-ENTRY-STATUS.            ELC50PD
02543      IF PB-REIN-ONLY-CERT                                         ELC50PD
02544          MOVE '9'                TO PB-I-ENTRY-STATUS.            ELC50PD
02545      IF PB-PREM-ACCTNG-ONLY                                       ELC50PD
02546          MOVE 'P'                TO PB-I-ENTRY-STATUS.            ELC50PD
02547                                                                   ELC50PD
02548      MOVE SPACE                  TO PB-I-OB-FLAG.                 ELC50PD
02549                                                                   ELC50PD
02550      IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE                 ELC50PD
02551          MOVE ER-2665            TO WS-ERROR                      ELC50PD
02552          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
02553          MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.            ELC50PD
02554                                                                   ELC50PD
02555      IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
02556         AND WS-AH-SPECIAL-CALC-CD = 'Z'                           ELC50PD
02557            MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
02558                                                                   ELC50PD
02559      IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
02560         AND WS-LF-SPECIAL-CALC-CD = 'Z'                           ELC50PD
02561            MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
02562                                                                   ELC50PD
02563      IF ACCOUNT-MAST-FOUND                                        ELC50PD
02564          MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF     ELC50PD
02565          MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH     ELC50PD
02566          MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF       ELC50PD
02567          MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH       ELC50PD
02568          MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE         ELC50PD
02569          MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
040504         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
040504     END-IF
02570                                                                   ELC50PD
02571      IF ACCOUNT-MAST-FOUND                                        ELC50PD
02572         AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)                ELC50PD
02573          MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.            ELC50PD
02574                                                                   ELC50PD
040708     IF (ACCOUNT-MAST-FOUND)
031811        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
02576         IF PB-REISSUED-CERT
02577            CONTINUE
02578         ELSE
02579            MOVE ER-2608          TO WS-ERROR
02580            PERFORM 9900-ERROR-FORMAT
040708                                 THRU 9900-EXIT
040708         END-IF
040708     END-IF
02581                                                                   ELC50PD
02582      IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
02583         MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER           ELC50PD
02584         MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.       ELC50PD
02585                                                                   ELC50PD
02586 **********   DMD CUSTOM CODE FOLLOWS  **********                  ELC50PD
02587  3024-EDIT-DMD-FIELDS.                                            ELC50PD
02588      IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
02589         GO TO 3025-EDIT-REINSURANCE.                              ELC50PD
02590                                                                   ELC50PD
02591 *** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE          ELC50PD
02592 *** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL      ELC50PD
02593 *** ERROR IF THEY ARE NOT EQUAL.                                  ELC50PD
02594                                                                   ELC50PD
02595      MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.              ELC50PD
02596      SET BIN-TO-GREG               TO TRUE.                       ELC50PD
02597      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
CIDMOD     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.              CL**3
02598 **   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.         CL**3
02599                                                                   ELC50PD
02600      MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.              ELC50PD
02601      SET BIN-TO-GREG               TO TRUE.                       ELC50PD
02602      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
CIDMOD     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.           CL**3
02603 **   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.           CL**3
02604                                                                   ELC50PD
02605      IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM               ELC50PD
02606         MOVE ER-8116               TO WS-ERROR                    ELC50PD
02607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
02608                                                                   ELC50PD
02609      MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.             ELC50PD
02610                                                                   ELC50PD
02611      MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER       ELC50PD
02612                                       WK-FULL-CERT-NO.            ELC50PD
02613      MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.             ELC50PD
02614                                                                   ELC50PD
02615      MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.             ELC50PD
02616                                                                   ELC50PD
02617      IF PB-VALID-LIFE                                             ELC50PD
02618         MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE               ELC50PD
02619      ELSE                                                         ELC50PD
02620         IF PB-VALID-AH                                            ELC50PD
02621           MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.              ELC50PD
02622                                                                   ELC50PD
02623                                                                   ELC50PD
02624      MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.         ELC50PD
02625      MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.              ELC50PD
02626      MOVE SPACES                   TO DCUA-CERT-NUMBER            ELC50PD
02627                                       DCUA-UNDRWRTR-CODE          ELC50PD
02628                                       DCUA-UNDRWRTR-GROUP-CODE    ELC50PD
02629                                       DCUA-RETURN-CODE.           ELC50PD
02630                                                                   ELC50PD
02631 ****************************************************************  ELC50PD
02632 *** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***  ELC50PD
02633 ***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***  ELC50PD
02634 ***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***  ELC50PD
02635 ***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***  ELC50PD
02636 ***   TO THIS RECORD.                                        ***  ELC50PD
02637 ****************************************************************  ELC50PD
02638      MOVE ' '                      TO WS-DLO-ERROR-SW.            ELC50PD
02639      PERFORM 7730-CALL-DL7 THRU 7730-EXIT.                        ELC50PD
02640      IF DCUA-SUCCESSFUL-PROCESS                                   ELC50PD
02641         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02642                                                                   ELC50PD
02643      IF DCUA-RETURN-CODE EQUAL '01'                               ELC50PD
02644         MOVE ER-8110               TO WS-ERROR                    ELC50PD
02645         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02647         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02648                                                                   ELC50PD
02649      IF DCUA-RETURN-CODE EQUAL '02'                               ELC50PD
02650         MOVE ER-8111               TO WS-ERROR                    ELC50PD
02651         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02653         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02654                                                                   ELC50PD
02655      IF DCUA-RETURN-CODE EQUAL '03'                               ELC50PD
02656         MOVE ER-8074               TO WS-ERROR                    ELC50PD
02657         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02658         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02659         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02660                                                                   ELC50PD
02661      IF DCUA-RETURN-CODE EQUAL '04'                               ELC50PD
02662         MOVE ER-8075               TO WS-ERROR                    ELC50PD
02663         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02665         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02666                                                                   ELC50PD
02667      IF DCUA-RETURN-CODE EQUAL '05'                               ELC50PD
02668         MOVE ER-8076               TO WS-ERROR                    ELC50PD
02669         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02670         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02671         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02672                                                                   ELC50PD
02673      IF DCUA-RETURN-CODE EQUAL '06'                               ELC50PD
02674         MOVE ER-8077               TO WS-ERROR                    ELC50PD
02675         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02676         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02677         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02678                                                                   ELC50PD
02679      IF DCUA-RETURN-CODE EQUAL '07'                               ELC50PD
02680         MOVE ER-8078               TO WS-ERROR                    ELC50PD
02681         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02682         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02683         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02684                                                                   ELC50PD
02685      IF DCUA-RETURN-CODE EQUAL 'E1'                               ELC50PD
02686         MOVE ER-8079               TO WS-ERROR                    ELC50PD
02687         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02689         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02690                                                                   ELC50PD
02691      IF DCUA-RETURN-CODE EQUAL 'E2'                               ELC50PD
02692         MOVE ER-8080               TO WS-ERROR                    ELC50PD
02693         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02694         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02695         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02696                                                                   ELC50PD
02697      IF DCUA-RETURN-CODE EQUAL 'E3'                               ELC50PD
02698         MOVE ER-8098               TO WS-ERROR                    ELC50PD
02699         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02700         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02701         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02702                                                                   ELC50PD
02703      IF DCUA-RETURN-CODE EQUAL 'C1'                               ELC50PD
02704         MOVE ER-8099               TO WS-ERROR                    ELC50PD
02705         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02707         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02708                                                                   ELC50PD
02709      IF DCUA-RETURN-CODE EQUAL 'U1'                               ELC50PD
02710         MOVE ER-8109               TO WS-ERROR                    ELC50PD
02711         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02712         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02713         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02714                                                                   ELC50PD
02715      IF DCUA-RETURN-CODE EQUAL 'N1'                               ELC50PD
02716         MOVE ER-8112               TO WS-ERROR                    ELC50PD
02717         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02718         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02719         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02720                                                                   ELC50PD
02721      IF DCUA-RETURN-CODE EQUAL 'N2'                               ELC50PD
02722         MOVE ER-8113               TO WS-ERROR                    ELC50PD
02723         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02724         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02725         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02726                                                                   ELC50PD
02727      IF DCUA-RETURN-CODE EQUAL 'N3'                               ELC50PD
02728         MOVE ER-8114               TO WS-ERROR                    ELC50PD
02729         MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
02730         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02731         GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
02732                                                                   ELC50PD
02733      MOVE 'Y'                      TO WS-DLO-ERROR-SW.            ELC50PD
02734      MOVE ER-8097                  TO WS-ERROR.                   ELC50PD
02735      PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.                  ELC50PD
02736      GO TO 3024-EDIT-DL7-CONT.                                    ELC50PD
02737                                                                   ELC50PD
02738  3024-EDIT-DL7-CONT.                                              ELC50PD
02739                                                                   ELC50PD
02740      MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.               ELC50PD
02741      MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.                ELC50PD
02742      IF DCUA-UNDRWRTR-CODE = PB-SV-STATE                          ELC50PD
02743         NEXT SENTENCE                                             ELC50PD
02744      ELSE                                                         ELC50PD
02745         MOVE ER-9263               TO WS-ERROR                    ELC50PD
02746         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
02747                                                                   ELC50PD
02748 ******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS      ELC50PD
02749 ******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...              ELC50PD
02750      IF DCUA-CERT-NUMBER = PB-CERT-NO                             ELC50PD
02751         NEXT SENTENCE                                             ELC50PD
02752      ELSE                                                         ELC50PD
02753         MOVE ER-8039               TO WS-ERROR                    ELC50PD
02754         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
02755                                                                   ELC50PD
02756      EJECT                                                        ELC50PD
02757 ****************************************************************  ELC50PD
02758 *** VALIDATE STATE  : DLO022                                 ***  ELC50PD
02759 ****************************************************************  ELC50PD
02760      MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.            ELC50PD
02761      MOVE SPACES                   TO DVSC-RETURN-CODE.           ELC50PD
02762                                                                   ELC50PD
02763      PERFORM 7770-CALL-DL22 THRU 7770-EXIT.                       ELC50PD
02764      IF DVSC-SUCCESSFUL-EDIT                                      ELC50PD
02765         GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
02766                                                                   ELC50PD
02767      IF DVSC-RETURN-CODE EQUAL '01'                               ELC50PD
02768         MOVE ER-8300               TO WS-ERROR                    ELC50PD
02769         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02770         GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
02771                                                                   ELC50PD
02772      IF DVSC-RETURN-CODE EQUAL '02'                               ELC50PD
02773         MOVE ER-8301               TO WS-ERROR                    ELC50PD
02774         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02775         GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
02776                                                                   ELC50PD
02777      IF DVSC-RETURN-CODE EQUAL '03'                               ELC50PD
02778         MOVE ER-8302               TO WS-ERROR                    ELC50PD
02779         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02780         GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
02781                                                                   ELC50PD
02782      IF DVSC-RETURN-CODE EQUAL 'N1'                               ELC50PD
02783         MOVE ER-8304               TO WS-ERROR                    ELC50PD
02784         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02785         GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
02786                                                                   ELC50PD
02787      MOVE ER-8303                  TO WS-ERROR                    ELC50PD
02788      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
02789                                                                   ELC50PD
02790  3024-EDIT-DL22-CONT.                                             ELC50PD
02791  EJECT                                                            ELC50PD
02792 ****************************************************************  ELC50PD
02793 *** VALIDATE LOAN OFFICER : DLO021                           ***  ELC50PD
02794 ****************************************************************  ELC50PD
02795                                                                   ELC50PD
02796      MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.         ELC50PD
02797      MOVE SPACES                    TO DVLO-RETURN-CODE.          ELC50PD
02798      PERFORM 7760-CALL-DL21 THRU 7760-EXIT.                       ELC50PD
02799      IF DVLO-SUCCESSFUL-EDIT                                      ELC50PD
02800         GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
02801                                                                   ELC50PD
02802      IF DVLO-RETURN-CODE EQUAL '01'                               ELC50PD
02803         MOVE ER-8081               TO WS-ERROR                    ELC50PD
02804         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02805         GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
02806                                                                   ELC50PD
02807      IF DVLO-RETURN-CODE EQUAL '02'                               ELC50PD
02808         MOVE ER-8082               TO WS-ERROR                    ELC50PD
02809         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02810         GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
02811                                                                   ELC50PD
02812      IF DVLO-RETURN-CODE EQUAL '03'                               ELC50PD
02813         MOVE ER-8083               TO WS-ERROR                    ELC50PD
02814         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02815         GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
02816                                                                   ELC50PD
02817      IF DVLO-RETURN-CODE EQUAL '04'                               ELC50PD
02818         MOVE ER-8084               TO WS-ERROR                    ELC50PD
02819         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02820         GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
02821                                                                   ELC50PD
02822      IF DVLO-RETURN-CODE EQUAL '05'                               ELC50PD
02823         MOVE ER-8085               TO WS-ERROR                    ELC50PD
02824         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02825         GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
02826                                                                   ELC50PD
02827      MOVE ER-7825                  TO WS-ERROR                    ELC50PD
02828      PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
02829      GO TO 3024-EDIT-DL21-CONT.                                   ELC50PD
02830                                                                   ELC50PD
02831  3024-EDIT-DL21-CONT.                                             ELC50PD
02832  EJECT                                                            ELC50PD
02833                                                                   ELC50PD
02834 ****************************************************************  ELC50PD
02835 *** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***  ELC50PD
02836 ****************************************************************  ELC50PD
02837                                                                   ELC50PD
02838      MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.                 ELC50PD
02839      MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.      ELC50PD
02840      MOVE SPACES                 TO DIPF-RETURN-CODE.             ELC50PD
02841      PERFORM 7710-CALL-DL2  THRU 7710-EXIT.                       ELC50PD
02842      IF DIPF-SUCCESSFUL-EDIT                                      ELC50PD
02843         GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
02844                                                                   ELC50PD
02845      IF DIPF-RETURN-CODE EQUAL '01'                               ELC50PD
02846         MOVE ER-8086               TO WS-ERROR                    ELC50PD
02847         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02848         GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
02849                                                                   ELC50PD
02850      IF DIPF-RETURN-CODE EQUAL '02'                               ELC50PD
02851         MOVE ER-8087               TO WS-ERROR                    ELC50PD
02852         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02853         GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
02854                                                                   ELC50PD
02855      IF DIPF-RETURN-CODE EQUAL '03'                               ELC50PD
02856         MOVE ER-8088               TO WS-ERROR                    ELC50PD
02857         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02858         GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
02859                                                                   ELC50PD
02860      MOVE ER-8095                  TO WS-ERROR                    ELC50PD
02861      PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
02862      GO TO 3024-EDIT-DL02-CONT.                                   ELC50PD
02863                                                                   ELC50PD
02864  3024-EDIT-DL02-CONT.                                             ELC50PD
02865  EJECT                                                            ELC50PD
02866                                                                   ELC50PD
02867 ****************************************************************  ELC50PD
02868 *** VALIDATE BANK ID : DLO003                                ***  ELC50PD
02869 ****************************************************************  ELC50PD
02870                                                                   ELC50PD
02871      MOVE WK-GREG-CENT           TO WCG-CENT.                     ELC50PD
02872      MOVE WK-GREG-YYMM           TO WCG-REST.                     ELC50PD
02873      IF WK-MEMBER-7-12 NOT = WK-CONV-GREG                         ELC50PD
02874         MOVE ER-8040               TO WS-ERROR                    ELC50PD
02875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
02876                                                                   ELC50PD
02877      MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.                  ELC50PD
02878      MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.                ELC50PD
02879      MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.           ELC50PD
02880      MOVE SPACES                 TO  DVBI-RETURN-CODE.            ELC50PD
02881      PERFORM 7720-CALL-DL3       THRU 7720-EXIT.                  ELC50PD
02882      IF DVBI-SUCCESSFUL-EDIT                                      ELC50PD
02883         GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
02884                                                                   ELC50PD
02885      IF DVBI-RETURN-CODE EQUAL '01'                               ELC50PD
02886         MOVE ER-8089               TO WS-ERROR                    ELC50PD
02887         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02888         GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
02889                                                                   ELC50PD
02890      IF DVBI-RETURN-CODE EQUAL '02'                               ELC50PD
02891         MOVE ER-8090               TO WS-ERROR                    ELC50PD
02892         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02893         GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
02894                                                                   ELC50PD
02895      IF DVBI-RETURN-CODE EQUAL '03'                               ELC50PD
02896         MOVE ER-8091               TO WS-ERROR                    ELC50PD
02897         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02898         GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
02899                                                                   ELC50PD
02900      IF DVBI-RETURN-CODE EQUAL '04'                               ELC50PD
02901         MOVE ER-8092               TO WS-ERROR                    ELC50PD
02902         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02903         GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
02904                                                                   ELC50PD
02905      IF DVBI-RETURN-CODE EQUAL '05'                               ELC50PD
02906         MOVE ER-8093               TO WS-ERROR                    ELC50PD
02907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02908         GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
02909                                                                   ELC50PD
02910      IF DVBI-RETURN-CODE EQUAL '06'                               ELC50PD
02911         MOVE ER-8094               TO WS-ERROR                    ELC50PD
02912         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02913         GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
02914                                                                   ELC50PD
02915      MOVE ER-8096                  TO WS-ERROR                    ELC50PD
02916      PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
02917      GO TO 3024-EDIT-DL03-CONT.                                   ELC50PD
02918                                                                   ELC50PD
02919  3024-EDIT-DL03-CONT.                                             ELC50PD
02920  EJECT                                                            ELC50PD
02921                                                                   ELC50PD
02922      IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR               ELC50PD
02923         NEXT SENTENCE                                             ELC50PD
02924      ELSE                                                         ELC50PD
02925         MOVE ER-8042               TO WS-ERROR                    ELC50PD
02926         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
02927                                                                   ELC50PD
02928      MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.     ELC50PD
02929      MOVE SPACES                 TO  DMPF-RETURN-CODE.            ELC50PD
02930      PERFORM 7700-CALL-DL1  THRU 7700-EXIT.                       ELC50PD
02931                                                                   ELC50PD
02932      IF DMPF-RETURN-CODE = '01'                                   ELC50PD
02933         MOVE ER-8067               TO WS-ERROR                    ELC50PD
02934         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02935         GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
02936                                                                   ELC50PD
02937      IF DMPF-RETURN-CODE = '02'                                   ELC50PD
02938         MOVE ER-8068               TO WS-ERROR                    ELC50PD
02939         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02940         GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
02941                                                                   ELC50PD
02942      IF DMPF-RETURN-CODE = '03'                                   ELC50PD
02943         MOVE ER-8069               TO WS-ERROR                    ELC50PD
02944         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02945         GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
02946                                                                   ELC50PD
02947      IF DMPF-RETURN-CODE = 'E1'                                   ELC50PD
02948         MOVE ER-8070               TO WS-ERROR                    ELC50PD
02949         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02950         GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
02951                                                                   ELC50PD
02952      IF DMPF-RETURN-CODE = 'N1'                                   ELC50PD
02953         MOVE ER-8071               TO WS-ERROR                    ELC50PD
02954         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
02955         GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
02956                                                                   ELC50PD
02957      IF DMPF-RETURN-CODE NOT = 'OK'                               ELC50PD
02958         MOVE ER-8072               TO WS-ERROR                    ELC50PD
02959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
02960                                                                   ELC50PD
02961  3024-EDIT-DL01-CONT.                                             ELC50PD
02962 ******************************************************************ELC50PD
02963 ***  VALIDATES RATE CODES : DLO017                             ***ELC50PD
02964 ******************************************************************ELC50PD
02965                                                                   ELC50PD
02966       MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.            ELC50PD
02967       MOVE SPACES                   TO DVRC-RETURN-CODE.          ELC50PD
02968       PERFORM 7750-CALL-DL17 THRU 7750-EXIT.                      ELC50PD
02969       IF DVRC-SUCCESSFUL-EDIT                                     ELC50PD
02970         MOVE 'Y'                   TO WK-VALID-RATE-CODE          ELC50PD
02971         GO TO 3024-CHECK-VALID-RATE.                              ELC50PD
02972                                                                   ELC50PD
02973       MOVE 'N'                     TO WK-VALID-RATE-CODE.         ELC50PD
02974                                                                   ELC50PD
02975       IF DVRC-RETURN-CODE EQUAL '01'                              ELC50PD
02976          MOVE ER-7817                   TO WS-ERROR               ELC50PD
02977          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
02978          GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
02979                                                                   ELC50PD
02980       IF DVRC-RETURN-CODE EQUAL '02'                              ELC50PD
02981          MOVE ER-7818                   TO WS-ERROR               ELC50PD
02982          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
02983          GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
02984                                                                   ELC50PD
02985       IF DVRC-RETURN-CODE EQUAL '03'                              ELC50PD
02986          MOVE ER-7819                   TO WS-ERROR               ELC50PD
02987          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
02988          GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
02989                                                                   ELC50PD
02990        MOVE ER-7820                     TO WS-ERROR.              ELC50PD
02991        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
02992        GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
02993                                                                   ELC50PD
02994 ******************************************************************ELC50PD
02995 ***  GET PREMIUM RATES : DLO011                                ***ELC50PD
02996 ******************************************************************ELC50PD
02997                                                                   ELC50PD
02998  3024-CHECK-VALID-RATE.                                           ELC50PD
02999                                                                   ELC50PD
03000      IF VALID-RATE-CODE                                           ELC50PD
03001         MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE              ELC50PD
03002         MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG         ELC50PD
03003         MOVE SPACES                TO DPRB-RETURN-CODE            ELC50PD
03004         PERFORM 7740-CALL-DL11 THRU 7740-EXIT                     ELC50PD
03005      ELSE                                                         ELC50PD
03006          GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
03007                                                                   ELC50PD
03008       IF DPRB-SUCCESSFUL-PROCESS                                  ELC50PD
03009          IF PB-VALID-LIFE                                         ELC50PD
03010              MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE           ELC50PD
03011              GO TO 3025-EDIT-REINSURANCE                          ELC50PD
03012          ELSE                                                     ELC50PD
03013              IF PB-VALID-AH                                       ELC50PD
03014                  MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE           ELC50PD
03015                  GO TO 3025-EDIT-REINSURANCE.                     ELC50PD
03016                                                                   ELC50PD
03017       IF DPRB-RETURN-CODE EQUAL '01'                              ELC50PD
03018          MOVE ER-7812                   TO WS-ERROR               ELC50PD
03019          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
03020          GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
03021                                                                   ELC50PD
03022       IF DPRB-RETURN-CODE EQUAL '02'                              ELC50PD
03023          MOVE ER-7813                   TO WS-ERROR               ELC50PD
03024          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
03025          GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
03026                                                                   ELC50PD
03027       IF DPRB-RETURN-CODE EQUAL '03'                              ELC50PD
03028          MOVE ER-7814                   TO WS-ERROR               ELC50PD
03029          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
03030          GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
03031                                                                   ELC50PD
03032       IF DPRB-RETURN-CODE EQUAL '04'                              ELC50PD
03033          IF NOT DPRB-1ST-TIME                                     ELC50PD
03034             MOVE ER-7815                   TO WS-ERROR            ELC50PD
03035             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
03036             GO TO 3025-EDIT-REINSURANCE                           ELC50PD
03037           ELSE                                                    ELC50PD
03038          IF PB-VALID-LIFE                                         ELC50PD
03039             MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
03040           ELSE                                                    ELC50PD
03041             MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
03042          END-IF                                                   ELC50PD
03043          MOVE SPACES                TO DOCC-RETURN-CODE           ELC50PD
03044          MOVE 'X'                   TO DPRB-1ST-TIME-SW           ELC50PD
03045          PERFORM 7755-CALL-DL19 THRU 7755-EXIT                    ELC50PD
03046          IF DOCC-RETURN-CODE = 'OK'                               ELC50PD
03047              MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4          ELC50PD
03048              GO TO 3024-CHECK-VALID-RATE                          ELC50PD
03049            ELSE                                                   ELC50PD
03050              MOVE ER-7823               TO WS-ERROR               ELC50PD
03051              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT            ELC50PD
03052              GO TO 3025-EDIT-REINSURANCE.                         ELC50PD
03053                                                                   ELC50PD
03054        MOVE ER-7816                     TO WS-ERROR.              ELC50PD
03055        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
03056        GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
03057                                                                   ELC50PD
03058 **********   DMD CUSTOM CODE ABOVE    **********                  ELC50PD
03059                                                                   ELC50PD
03060  3025-EDIT-REINSURANCE.                                           ELC50PD
03061      IF PB-I-SPECIAL-REIN-CODE = SPACE                            ELC50PD
03062          GO TO 3027-EDIT-CONTINUE.                                ELC50PD
03063                                                                   ELC50PD
03064      MOVE LOW-VALUES               TO ERREIN-KEY.                 ELC50PD
03065      MOVE PB-COMPANY-CD            TO REIN-COMP-CD.               ELC50PD
03066      MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1                 ELC50PD
03067                                       REIN-CODE-2                 ELC50PD
03068                                       REIN-CODE-3.                ELC50PD
03069      MOVE 'A'                      TO REIN-TYPE.                  ELC50PD
03070                                                                   ELC50PD
03071      MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.            ELC50PD
03072                                                                   ELC50PD
03073      MOVE '3026' TO REIN-SW.                                      ELC50PD
03074      MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
03075                                                                   ELC50PD
03076      PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
03077      IF REIN-TABLE-NOT-FOUND                                      ELC50PD
03078          GO TO 3026-NO-SPEC-TABLE.                                ELC50PD
03079                                                                   ELC50PD
03080      MOVE RE-TABLE              TO WK-REIN-TABLE.                 ELC50PD
03081      MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
03082                                    WS-NSP-ST-CD-LF.               ELC50PD
03083      MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
03084                                    WS-NSP-ST-CD-AH.               ELC50PD
03085                                                                   ELC50PD
03086      GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
03087                                                                   ELC50PD
03088  3026-NO-SPEC-TABLE.                                              ELC50PD
03089                                                                   ELC50PD
03090      MOVE ER-2664                TO WS-ERROR.                     ELC50PD
03091      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
03092      GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
03093                                                                   ELC50PD
03094  3027-EDIT-CONTINUE.                                              ELC50PD
03095                                                                   ELC50PD
03096      IF PB-I-REIN-TABLE = SPACES                                  ELC50PD
03097        GO TO 3040-EDIT-CONTINUE.                                  ELC50PD
03098                                                                   ELC50PD
03099      IF PB-I-REIN-TABLE = WK-REIN-TABLE                           ELC50PD
03100           MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF               ELC50PD
03101           MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH               ELC50PD
03102            GO TO 3040-EDIT-CONTINUE.                              ELC50PD
03103                                                                   ELC50PD
03104      MOVE LOW-VALUES            TO ERREIN-KEY.                    ELC50PD
03105      MOVE PB-COMPANY-CD         TO REIN-COMP-CD.                  ELC50PD
03106      MOVE 'A'                   TO REIN-TYPE.                     ELC50PD
03107      MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.                 ELC50PD
03108                                                                   ELC50PD
03109      MOVE '3028'                TO REIN-SW.                       ELC50PD
03110      MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
03111                                                                   ELC50PD
03112      PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
03113      IF REIN-TABLE-NOT-FOUND                                      ELC50PD
03114          GO TO 3028-NO-REIN-TABLE.                                ELC50PD
03115                                                                   ELC50PD
03116      MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.                 ELC50PD
03117      MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
03118                                    WS-NSP-ST-CD-LF.               ELC50PD
03119      MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
03120                                    WS-NSP-ST-CD-AH.               ELC50PD
03121                                                                   ELC50PD
03122      GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
03123                                                                   ELC50PD
03124  3028-NO-REIN-TABLE.                                              ELC50PD
03125                                                                   ELC50PD
03126      MOVE ER-2615                TO WS-ERROR.                     ELC50PD
03127      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
03128      GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
03129                                                                   ELC50PD
03130  3040-EDIT-CONTINUE.                                              ELC50PD
03131                                                                   ELC50PD
03132      IF PB-I-LF-PREM-CALC NOT NUMERIC                             ELC50PD
03133          MOVE ZEROS              TO PB-I-LF-PREM-CALC.            ELC50PD
03134                                                                   ELC50PD
03135      IF PB-I-AH-PREM-CALC NOT NUMERIC                             ELC50PD
03136          MOVE ZEROS              TO PB-I-AH-PREM-CALC.            ELC50PD
03137                                                                   ELC50PD
122002     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
122002        AND (NOT PB-MONTHLY-CERT)
03139         IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')     ELC50PD
03140             MOVE '001'           TO PB-I-LF-TERM                  ELC50PD
03141             MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
03142                                                                   ELC50PD
03143      IF (NOT PB-REISSUED-CERT)                                    ELC50PD
122002        AND (NOT PB-MONTHLY-CERT)
03144         IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')     ELC50PD
03145             MOVE '001'           TO PB-I-AH-TERM                  ELC50PD
03146             MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
03147                                                                   ELC50PD
03148  3040-EDIT-1ST-PMT-DT.                                            ELC50PD

           MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
03149      IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
03150          MOVE ZEROS TO PB-I-EXTENTION-DAYS.                       ELC50PD
03151                                                                   ELC50PD
03152 ******************************************************************ELC50PD
03153 *                                                                *ELC50PD
03154 *        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *ELC50PD
03155 *        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *ELC50PD
03156 *        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *ELC50PD
03157 *        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *ELC50PD
03158 *                                                                *ELC50PD
03159 ******************************************************************ELC50PD
03160                                                                   ELC50PD
03161      IF PB-EFF-DT-PROCESSING                                      ELC50PD
03162         MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
03163                                     PB-I-LF-EXPIRE-DT             ELC50PD
03164                                     PB-I-AH-EXPIRE-DT             ELC50PD
03165         MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
03166         MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1                 ELC50PD
03167         MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
03168         MOVE +1                  TO DC-ELAPSED-MONTHS             ELC50PD
03169         SET BIN-PLUS-ELAPSED     TO TRUE                          ELC50PD
03170 *       MOVE 6                   TO DC-OPTION-CODE                ELC50PD
03171         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
03172         IF NO-CONVERSION-ERROR                                    ELC50PD
03173            MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.              ELC50PD
03174                                                                   ELC50PD
03175 ******************************************************************ELC50PD
03176 *                                                                *ELC50PD
03177 *        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *ELC50PD
03178 *        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *ELC50PD
03179 *        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
03180 *        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *ELC50PD
03181 *                                                                *ELC50PD
03182 ******************************************************************ELC50PD
03183                                                                   ELC50PD
03184      IF PB-EXT-DAYS-PROCESSING                                    ELC50PD
03185           MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT          ELC50PD
03186                                          PB-I-LF-EXPIRE-DT        ELC50PD
03187                                          PB-I-AH-EXPIRE-DT        ELC50PD
03188           MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1            ELC50PD
03189           MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
03190           MOVE +1                     TO DC-ELAPSED-MONTHS        ELC50PD
03191           MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS          ELC50PD
03192           SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
03193 *         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
03194           PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
03195           IF NO-CONVERSION-ERROR                                  ELC50PD
03196              MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.         ELC50PD
03197                                                                   ELC50PD
03198 ******************************************************************ELC50PD
03199 *                                                                *ELC50PD
03200 *        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *ELC50PD
03201 *        BASED ON THE OLDEST EXPIRE DATE.                        *ELC50PD
03202 *        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
03203 *        (EXPIRE DATE - (TERM -1))  *  -1.                        ELC50PD
03204 *                                                                *ELC50PD
03205 ******************************************************************ELC50PD
03206                                                                   ELC50PD
03207      IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
03208         IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT       ELC50PD
03209            IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
03210               MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
03211               MOVE PB-I-AH-TERM      TO WS-TERM                   ELC50PD
03212            ELSE                                                   ELC50PD
03213               MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
03214               MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
03215         ELSE                                                      ELC50PD
03216            IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
03217               MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
03218               MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
03219            ELSE                                                   ELC50PD
03220               MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
03221               MOVE PB-I-AH-TERM      TO WS-TERM.                  ELC50PD
03222                                                                   ELC50PD
03223      IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
03224         MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
03225         MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
03226         MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1                 ELC50PD
03227         MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
03228                                     DC-ODD-DAYS-OVER              ELC50PD
03229           COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1          ELC50PD
03230           SET BIN-PLUS-ELAPSED    TO TRUE                         ELC50PD
03231 *         MOVE 6                  TO DC-OPTION-CODE               ELC50PD
03232           PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
03233           IF NO-CONVERSION-ERROR                                  ELC50PD
03234              MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.            ELC50PD
03235                                                                   ELC50PD
03236 ******************************************************************ELC50PD
03237 *                                                                *ELC50PD
03238 *            1ST PAYMENT DATE PROCESSING                         *ELC50PD
03239 *                                                                *ELC50PD
03240 ******************************************************************ELC50PD
03241                                                                   ELC50PD
03242      IF PB-1ST-PMT-DT-PROCESSING                                  ELC50PD
03243         MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT             ELC50PD
03244                                     PB-I-AH-EXPIRE-DT             ELC50PD
03245         MOVE ZEROS               TO PB-I-EXTENTION-DAYS.          ELC50PD
03246                                                                   ELC50PD
03247      IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT              ELC50PD
03248          NEXT SENTENCE                                            ELC50PD
03249      ELSE                                                         ELC50PD
03250          MOVE ER-2680                 TO WS-ERROR                 ELC50PD
03251          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
03252          GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
03253                                                                   ELC50PD
03254      MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
03255      MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.                ELC50PD
03256      SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
03257 *    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
03258      MOVE ZEROS                  TO DC-ELAPSED-MONTHS             ELC50PD
03259                                     DC-ELAPSED-DAYS               ELC50PD
03260                                     DC-ODD-DAYS-OVER.             ELC50PD
03261                                                                   ELC50PD
03262      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
03263                                                                   ELC50PD
03264      IF DATE-CONVERSION-ERROR                                     ELC50PD
03265         GO TO 3060-ORIG-TERM-CHECK.                               ELC50PD
03266                                                                   ELC50PD
071305     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT

030612     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
102908        AND (WS-LF-COVERAGE-TYPE = 'L')
102908        IF (DC-ELAPSED-MONTHS > 1)
102908                      OR
102908           ((DC-ELAPSED-MONTHS = 1)
102908           AND (DC-ODD-DAYS-OVER > 0))
102908           MOVE ER-2882          TO WS-ERROR
102908           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
102908        END-IF
102908     END-IF

           if dc-elapsed-months > 0
              compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
              + dc-odd-days-over
           end-if

091609     IF PB-EXT-DAYS-PROCESSING
091609        CONTINUE
091609     ELSE
091609        IF DC-ELAPSED-MONTHS = +0
091609           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
091609        ELSE
091609           IF (WS-LF-EARNINGS-CALC = '4')
091609              AND (DC-ELAPSED-MONTHS > ZERO)
091609              AND (DC-ELAPSED-DAYS > ZERO)
091609              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
091609           ELSE
091609              PERFORM 6400-COMPUTE-EXTENSION-DAYS
091609                                 THRU 6499-EXIT
091609              MOVE WS-ODD-DAYS-OVER
091609                                 TO PB-I-EXTENTION-DAYS
091609           END-IF
091609        END-IF
091609     END-IF

03276 ******************************************************************ELC50PD
03277 *                                                                *ELC50PD
03278 *            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *ELC50PD
03279 *            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *ELC50PD
03280 *            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *ELC50PD
03281 *            AND ANY ODD DAYS.                                   *ELC50PD
03282 *                                                                *ELC50PD
03283 ******************************************************************ELC50PD
03284                                                                   ELC50PD
03285      COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -                  ELC50PD
03286                               (EC-ST-FST-PMT-DAYS-MAX + 32)       ELC50PD
061009     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
03287         IF DC-ELAPSED-DAYS > ZEROS
03288            MOVE ER-2681          TO WS-ERROR
03289            PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
061009     END-IF
03290                                                                   ELC50PD
03291      IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
03292         IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX     ELC50PD
03293            MOVE ER-2681          TO WS-ERROR                      ELC50PD
03294            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
03295                                                                   ELC50PD
03296      IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
03297         (PB-I-LF-TERM NOT = ZERO) AND                             ELC50PD
03298          NOT NO-LIFE-COVERAGE                                     ELC50PD
03299           MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1                 ELC50PD
03300           COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1           ELC50PD
091609          IF WS-LF-EARNINGS-CALC = '4'
091609             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
091609             PB-I-PAY-FREQUENCY
091609          END-IF
03301           MOVE ZERO              TO DC-ELAPSED-DAYS               ELC50PD
03302                                     DC-ODD-DAYS-OVER              ELC50PD
03303           MOVE 1                 TO DC-END-OF-MONTH               ELC50PD
03304           SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
03305 *         MOVE 6                 TO DC-OPTION-CODE                ELC50PD
03306           PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
03307           IF NO-CONVERSION-ERROR                                  ELC50PD
03308              MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT        ELC50PD
03309              IF (WS-LF-EARNINGS-CALC = 'B') AND                   ELC50PD
03310                 (WS-LF-SPECIAL-CALC-CD = 'L')                     ELC50PD
03311                   MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1         ELC50PD
03312                   MOVE ZERO           TO DC-ELAPSED-DAYS          ELC50PD
03313                   MOVE +1             TO DC-ELAPSED-MONTHS        ELC50PD
03314                   SET BIN-PLUS-ELAPSED  TO TRUE                   ELC50PD
03315 *                 MOVE 6              TO DC-OPTION-CODE           ELC50PD
03316                   PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        ELC50PD
03317                   IF NO-CONVERSION-ERROR                          ELC50PD
03318                      MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.     ELC50PD
03319                                                                   ELC50PD
042709* okay, i had to move the new att age edit down here because the
      * expiration date could get recalculated and i need the exp date


042709     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
042709        AND (EC-AM-LF-MAX-ATT-AGE > +0)
042709        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
042709        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709           AND ZEROS
                 MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
                 MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
                 SET ELAPSED-BETWEEN-BIN TO TRUE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
042709                 MOVE ER-2669       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
042709           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
042709              MOVE ER-2669       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
020711           ELSE
020711              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
020711                 MOVE ER-1570    TO WS-ERROR
020711                 PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711              END-IF
042709           END-IF
042709        END-IF

042709        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709           AND ZEROS
                 MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
                 MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
                 SET ELAPSED-BETWEEN-BIN TO TRUE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
042709                 MOVE ER-2669       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
                   (PB-I-LF-TERM / 12)
042709           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
042709              MOVE ER-2669       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
020711           ELSE
020711              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
020711                 MOVE ER-1571    TO WS-ERROR
020711                 PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711              END-IF
042709           END-IF
042709        END-IF
              IF WS-ERROR = ER-2669
042709           PERFORM 9900-ERROR-FORMAT
042709                                 THRU 9900-EXIT
042709        END-IF

042709     END-IF

03320      IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
03321         (PB-I-AH-TERM NOT = ZERO) AND                             ELC50PD
03322          NOT NO-AH-COVERAGE                                       ELC50PD
050509          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
022510             AND (PB-COMPANY-ID = 'DCC')
050509             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
050509             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
050509          ELSE
110609             IF WS-LF-EARNINGS-CALC = '4'
012711                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
110609                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
110609                PB-I-PAY-FREQUENCY
110609             ELSE
050509                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
050509                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
110609             END-IF
050509          END-IF
03325           MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
03326                                          DC-ODD-DAYS-OVER         ELC50PD
03327           MOVE 1                      TO DC-END-OF-MONTH          ELC50PD
03328           SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
03329 *         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
03330           PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
03331           IF NO-CONVERSION-ERROR                                  ELC50PD
03332              MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.       ELC50PD

042709     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
042709        AND (EC-AM-AH-MAX-ATT-AGE > +0)
042709        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
042709        IF PB-I-BIRTHDAY > LOW-VALUES
                 MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
                 MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
                 SET ELAPSED-BETWEEN-BIN TO TRUE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
042709                 MOVE ER-3054       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
042709           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
042709              MOVE ER-3054       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709           END-IF
042709        END-IF

042709        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709           AND ZEROS
                 MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
                 MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
                 SET ELAPSED-BETWEEN-BIN TO TRUE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
042709                 MOVE ER-3054       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
                   (PB-I-AH-TERM / 12)
042709           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
042709              MOVE ER-3054       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709           END-IF
042709        END-IF
              IF WS-ERROR = ER-3054
042709           PERFORM 9900-ERROR-FORMAT
042709                                 THRU 9900-EXIT
042709        END-IF

042709     END-IF

03334      MOVE SPACE                       TO DC-END-OF-MONTH.         ELC50PD
03335                                                                   ELC50PD
03336      IF PB-COMPANY-ID = 'NCB'                                        CL**6
03337         GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
03338                                                                      CL**6
03339      IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
03340        AND                                                        ELC50PD
03341         PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
03342         NEXT SENTENCE                                             ELC50PD
03343      ELSE                                                            CL**6
03344         GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
03345                                                                      CL**6
03346      IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT             ELC50PD
03347         MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
03348         MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2                 ELC50PD
03349      ELSE                                                         ELC50PD
03350         MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
03351         MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.                ELC50PD
03352                                                                   ELC50PD
03353      SET ELAPSED-BETWEEN-BIN TO TRUE.                             ELC50PD
03354 *    MOVE '1'      TO DC-OPTION-CODE                              ELC50PD
03355      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                     ELC50PD
03356      IF (NO-CONVERSION-ERROR)
03357         AND (DC-ELAPSED-MONTHS > +1)
              AND (WS-AH-BEN-CATEGORY NOT = 'D')
03359         MOVE ER-2668   TO WS-ERROR                                ELC50PD
03360         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
03361                                                                   ELC50PD
03362  3040-EDIT-EXTENSION-DAYS.                                        ELC50PD
03363                                                                   ELC50PD
03364      IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
03365         AND (PB-COMPANY-ID NOT EQUAL 'CSL')                       ELC50PD
03366          GO TO 3050-EDIT-TERM-IN-DAYS                             ELC50PD
03367      ELSE                                                         ELC50PD
03368          MOVE ZEROS             TO PB-I-TERM-IN-DAYS.             ELC50PD
03369                                                                   ELC50PD
03370      IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
03371          MOVE ZEROS             TO PB-I-EXTENTION-DAYS            ELC50PD
03372      ELSE                                                         ELC50PD
03373         IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)         ELC50PD
061009           AND (WS-LF-EARNINGS-CALC NOT = '4')                    ELC50PD
03374            MOVE ER-2681         TO WS-ERROR                       ELC50PD
03375            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
03376                                                                   ELC50PD
03377      IF PB-I-EXTENTION-DAYS NOT = ZERO  OR                        ELC50PD
03378         (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND                      ELC50PD
03379         (PB-I-AH-EXPIRE-DT = LOW-VALUES)                          ELC50PD
03380          GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
03381                                                                   ELC50PD
03382      GO TO 3060-ORIG-TERM-CHECK.                                  ELC50PD
03383                                                                   ELC50PD
03384  3050-EDIT-TERM-IN-DAYS.                                          ELC50PD
03385                                                                   ELC50PD
03386      MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.          ELC50PD
03387                                                                   ELC50PD
03388      IF PB-I-TERM-IN-DAYS NOT NUMERIC                             ELC50PD
03389          MOVE ZEROS              TO PB-I-TERM-IN-DAYS             ELC50PD
03390      ELSE                                                         ELC50PD
03391          IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO               ELC50PD
03392             MOVE ER-2682         TO WS-ERROR                      ELC50PD
03393             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
03394                                                                   ELC50PD
03395      DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM        ELC50PD
03396                                        REMAINDER WS-WORK-TERM.    ELC50PD
03397      IF WS-WORK-TERM GREATER THAN ZERO                            ELC50PD
03398          ADD +1 TO PB-I-LF-TERM.                                  ELC50PD
03399                                                                   ELC50PD
03400      IF NOT NO-AH-COVERAGE                                        ELC50PD
03401          MOVE ER-2684            TO WS-ERROR                      ELC50PD
03402          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
03403                                                                   ELC50PD
03404                                                                   ELC50PD
03405  3060-ORIG-TERM-CHECK.                                            ELC50PD
03406                                                                   ELC50PD
03407 ******************************************************************ELC50PD
03408 *    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS                ELC50PD
03409 ******************************************************************ELC50PD
03410                                                                   ELC50PD
03411      IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
03412         NEXT SENTENCE                                             ELC50PD
03413      ELSE                                                         ELC50PD
03414         IF NOT NO-LIFE-COVERAGE                                   ELC50PD
03415            IF PB-I-LF-TERM NUMERIC                                ELC50PD
03416               AND (PB-I-LF-TERM GREATER THAN ZERO)                ELC50PD
03417               AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)     ELC50PD
03418               AND (PB-I-LF-TERM NOT GREATER THAN +360)            ELC50PD
03419                   NEXT SENTENCE                                   ELC50PD
03420            ELSE                                                   ELC50PD
03421               MOVE ER-2647       TO WS-ERROR                      ELC50PD
03422               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
03423                                                                   ELC50PD
03424      IF NOT NO-AH-COVERAGE                                        ELC50PD
03425          IF PB-I-AH-TERM NUMERIC                                  ELC50PD
03426             AND (PB-I-AH-TERM GREATER THAN ZERO)                  ELC50PD
03427             AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)       ELC50PD
03428             AND (PB-I-AH-TERM NOT GREATER THAN +360)              ELC50PD
03429              NEXT SENTENCE                                        ELC50PD
03430           ELSE                                                    ELC50PD
03431               MOVE ER-2658       TO WS-ERROR                      ELC50PD
03432               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
03433                                                                   ELC50PD
03434      IF PB-COMPANY-ID = 'NCB'                                        CL**6
03435         GO TO 3070-LOAN-TERM-CHECK.                                  CL**6
03436                                                                      CL**6
03437      IF POLICY-HAS-AH                                             ELC50PD
03438        AND                                                        ELC50PD
03439         POLICY-HAS-LIFE                                           ELC50PD
03440        AND                                                        ELC50PD
03441         PB-I-LF-TERM NUMERIC                                      ELC50PD
03442        AND                                                        ELC50PD
03443         PB-I-AH-TERM NUMERIC                                      ELC50PD
03444         NEXT SENTENCE                                             ELC50PD
03445      ELSE                                                         ELC50PD
03446         GO TO 3070-LOAN-TERM-CHECK.                               ELC50PD
03447                                                                   ELC50PD
03448      COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).   ELC50PD
03449      IF WS-TEX-FACT-2 LESS THAN +0                                ELC50PD
03450         MULTIPLY +1 BY WS-TEX-FACT-2.                             ELC50PD
03451                                                                   ELC50PD
03452      IF WS-TEX-FACT-2 GREATER THAN +1                             ELC50PD
03453         MOVE ER-2668             TO WS-ERROR                      ELC50PD
03454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
03455                                                                   ELC50PD
03456  3070-LOAN-TERM-CHECK.                                            ELC50PD
03457                                                                   ELC50PD
03458      IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
03459          OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
03460             GO TO 3125-EDIT-PMT-FREQ.                             ELC50PD

      *    IF PB-COMPANY-ID NOT = 'DCC'
03462 *       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
      *          AND 'V' AND 'W' AND 'X'
03464 *          GO TO 3125-EDIT-PMT-FREQ
      *       END-IF
      *    ELSE
      *       IF WS-AH-DCC-TRUNC = 'T'
      *          CONTINUE
      *       ELSE
      *          GO TO 3125-EDIT-PMT-FREQ
      *       END-IF
      *    END-IF



020711     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
                          OR
              ((PB-COMPANY-ID = 'DCC')
              AND (WS-AH-DCC-TRUNC = 'T'))
020711        CONTINUE
020711     ELSE
              GO TO 3125-EDIT-PMT-FREQ
           END-IF

03466      IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
03467          MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
03468                                                                   ELC50PD
03469      IF PB-I-LOAN-TERM GREATER THAN ZERO             AND          ELC50PD
03470         PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND          ELC50PD
012213*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND          ELC50PD
              PB-I-LOAN-TERM NOT GREATER THAN +360                      ELC50PD
03473          NEXT SENTENCE                                            ELC50PD
03474      ELSE                                                         ELC50PD
03475          MOVE ER-2648            TO WS-ERROR                      ELC50PD
03476          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
03477                                                                   ELC50PD
012213     if  PB-I-LOAN-TERM > WS-MAX-TERM
012213        MOVE ER-3058             TO WS-ERROR
012213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
012213     end-if
03477                                                                   ELC50PD
CIDMOD     IF WS-STATE-ABBREVIATION = 'NC'
CIDMOD        IF PB-I-LOAN-TERM > +59
CIDMOD           CONTINUE
CIDMOD        ELSE
022708           MOVE ER-2792          TO WS-ERROR
CIDMOD           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50
CIDMOD        END-IF
CIDMOD     END-IF
03478                                                                   ELC50PD
CIDMOD     .
03479  3125-EDIT-PMT-FREQ.                                              ELC50PD

03480      IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
03481          OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
03482             GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD

020711     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
                          OR
              ((PB-COMPANY-ID = 'DCC')
              AND (WS-AH-DCC-TRUNC = 'T'))
032912                    OR
032912         (PB-COMPANY-ID = 'AHL')
020711        CONTINUE
020711     ELSE
020711        IF (PB-I-LOAN-TERM > ZEROS)
020711           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
020711           MOVE ER-1575          TO WS-ERROR
020711           PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711        END-IF
           END-IF

03484      IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
03485          IF PB-I-PAY-FREQUENCY  NOT = ZEROS                       ELC50PD
03486             MOVE ER-2653         TO WS-ERROR                      ELC50PD
03487             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
03488             GO TO 3127-EDIT-LOAN-OFFICER                          ELC50PD
03489          ELSE                                                     ELC50PD
03490             GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
03491                                                                   ELC50PD
03492      IF PB-I-PAY-FREQUENCY = ZERO OR 1                            ELC50PD
03493          MOVE ER-2655            TO WS-ERROR                      ELC50PD
03494          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
03495          GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
03496                                                                   ELC50PD
03497      IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM              ELC50PD
03498          MOVE ER-2654            TO WS-ERROR                      ELC50PD
03499          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
03500          GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
03501                                                                   ELC50PD
03502      DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY                    ELC50PD
03503          GIVING WS-TEX-FACT-2                                     ELC50PD
03504              REMAINDER WS-TEX-FACT-3.                             ELC50PD
03505                                                                   ELC50PD
091609*    IF WS-TEX-FACT-3 NOT = ZERO                                  ELC50PD
091609*       MOVE ER-2654             TO WS-ERROR                      ELC50PD
091609*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
03509                                                                   ELC50PD
03510                                                                   ELC50PD
03511  3127-EDIT-LOAN-OFFICER.                                          ELC50PD
03512                                                                   ELC50PD
03513      IF WS-EDIT-LOAN-OFC-SW = 'Y'
03514         IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
03515            MOVE ER-2690          TO WS-ERROR
03516            PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
083106        ELSE
083106           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
083106           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
083106           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
083106           MOVE PB-SV-STATE      TO LOFC-STATE
083106           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
083106           MOVE PB-I-LOAN-OFFICER
083106                                 TO LOFC-CODE
083106           PERFORM 8586-READ-LOAN-OFFICER
083106                                 THRU 8586-EXIT
083106           IF (NOT LOFC-MASTER-FOUND)
083106              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
083106              MOVE ER-3006       TO WS-ERROR
083106              PERFORM 9900-ERROR-FORMAT
083106                                 THRU 9900-EXIT
083106           END-IF
083106        END-IF
083106     END-IF

           .
03518  3129-EDIT-APR.                                                   ELC50PD
03519                                                                   ELC50PD
03520      IF (WS-LF-BENEFIT-CD = ZERO)
03521         OR (NO-LF-BENEFIT-MATCH)
              IF PB-COMPANY-ID NOT = 'DCC'
03522            GO TO 3130-EDIT-AGE
042605*       ELSE
042605*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
042605*             GO TO 3130-EDIT-AGE
042605*          END-IF
042605        END-IF
           END-IF
03523                                                                   ELC50PD
03524      IF (WS-STATE-ABBREVIATION = 'OH')                            ELC50PD
CIDMOD         AND (PB-I-RATE-CLASS NOT = 'L ')
03525          AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
03526          AND (PB-CERT-EFF-DT GREATER WS-831031)                   ELC50PD
03527          GO TO 3129-APR-CONT.                                     ELC50PD
03528                                                                   ELC50PD
03529      IF (WS-STATE-ABBREVIATION = 'RI')                            ELC50PD
03530          AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
03531          AND (PB-CERT-EFF-DT GREATER WS-831231)                   ELC50PD
03532          GO TO 3129-APR-CONT.                                     ELC50PD
03533                                                                   ELC50PD
03534      IF (WS-STATE-ABBREVIATION = 'UT')                            ELC50PD
03535          AND (PB-I-LF-TERM GREATER THAN 62)                       ELC50PD
03536          AND (PB-CERT-EFF-DT GREATER WS-810831)                   ELC50PD
03537          AND (PB-CERT-EFF-DT LESS WS-830901)                      ELC50PD
03538          GO TO 3129-APR-CONT.                                     ELC50PD
03539                                                                   ELC50PD
03540      IF PB-COMPANY-ID = 'LAP'                                     ELC50PD
03541         IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'                 ELC50PD
03542            IF PB-I-LOAN-APR GREATER THAN ZEROS                    ELC50PD
03543               MOVE ER-2656         TO WS-ERROR                    ELC50PD
03544               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
03545               GO TO 3130-EDIT-AGE.                                ELC50PD
03546                                                                   ELC50PD
03547      IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
03548         (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
03549         (WS-LF-SPECIAL-CALC-CD NOT = 'G')
011305        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
112612        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
112612        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
03550          GO TO 3130-EDIT-AGE.                                     ELC50PD
03551                                                                   ELC50PD
03552  3129-APR-CONT.                                                   ELC50PD
03553      IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR                         ELC50PD
03554          (WS-LF-SPECIAL-CALC-CD = 'M'))                           ELC50PD
03555          GO TO 3130-EDIT-AGE.                                     ELC50PD
03556                                                                   ELC50PD
112612     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR 
112612         WS-AH-BENEFIT-CD (1:1) = 'S')
061207        AND (PB-COMPANY-ID = 'DCC')
061207        AND (PB-I-LOAN-APR = ZERO)
061207        MOVE ER-2657             TO WS-ERROR
061207        PERFORM 9900-ERROR-FORMAT
061207                                 THRU 9900-EXIT
061207        GO TO 3130-EDIT-AGE
061207     END-IF

pemtst     IF PB-I-LOAN-APR = ZERO
pemtst        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
pemtst     END-IF
03559                                                                   ELC50PD
03560      IF PB-I-LOAN-APR = ZERO                                      ELC50PD
03561         MOVE ER-2656             TO WS-ERROR                      ELC50PD
03562         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
03563         GO TO 3130-EDIT-AGE.                                      ELC50PD
03564                                                                   ELC50PD
011305*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
011305     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000            ELC50PD
03566         MOVE ER-2657             TO WS-ERROR                      ELC50PD
03567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
03568                                                                   ELC50PD
03569  3130-EDIT-AGE.                                                   ELC50PD
03570                                                                   ELC50PD
03571 ******************************************************************ELC50PD
03572 *    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *ELC50PD
03573 ******************************************************************ELC50PD
03574                                                                   ELC50PD
03575      IF NOT NO-LIFE-COVERAGE                                      ELC50PD
03576         IF WS-LF-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
03577            IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99     ELC50PD
03578                MOVE ER-2628             TO WS-ERROR               ELC50PD
03579                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
03580                                                                   ELC50PD
03581      IF NOT NO-AH-COVERAGE                                        ELC50PD
03582         IF WS-AH-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
03583            IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99  ELC50PD
03584                MOVE ER-2628         TO WS-ERROR                   ELC50PD
03585                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
03586                                                                   ELC50PD
03587  3133-SEX-CODE.                                                   ELC50PD
03588      IF PB-I-INSURED-SEX = SPACE OR ZERO                          ELC50PD
03589          IF WS-DEFAULT-SEX = 'M'                                  ELC50PD
03590              MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX              ELC50PD
03591           ELSE                                                    ELC50PD
03592              IF WS-DEFAULT-SEX = 'F'                              ELC50PD
03593              MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.             ELC50PD
03594                                                                   ELC50PD
03595      IF PB-I-INSURED-SEX = '1'                                    ELC50PD
03596          MOVE 'M' TO PB-I-INSURED-SEX.                            ELC50PD
03597                                                                   ELC50PD
03598      IF PB-I-INSURED-SEX = '2'                                    ELC50PD
03599          MOVE 'F' TO PB-I-INSURED-SEX.                            ELC50PD
03600                                                                   ELC50PD
03601  3134-SIG-SW-EDIT.                                                ELC50PD
03602      IF PB-I-SIG-SW = SPACE                                       ELC50PD
03603          MOVE 'N'                TO  PB-I-SIG-SW.                 ELC50PD
03604                                                                   ELC50PD
03605      IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
03606          IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '         ELC50PD
03607              NEXT SENTENCE                                        ELC50PD
03608          ELSE                                                     ELC50PD
03609              MOVE ER-1923        TO  WS-ERROR                     ELC50PD
03610              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
03611      ELSE                                                         ELC50PD
03612      IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
03613          IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '                ELC50PD
03614              NEXT SENTENCE                                        ELC50PD
03615          ELSE                                                     ELC50PD
03616              MOVE ER-2606        TO  WS-ERROR                     ELC50PD
03617              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
03618      ELSE                                                         ELC50PD
03619      IF PB-COMPANY-ID = 'TMS'                                     ELC50PD
03620          IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'                       ELC50PD
03621              NEXT SENTENCE                                        ELC50PD
03622          ELSE                                                     ELC50PD
03623              MOVE ER-2689        TO  WS-ERROR                     ELC50PD
03624              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
03625      ELSE                                                         ELC50PD
03626          IF PB-I-SIG-SW = 'Y' OR 'N'                              ELC50PD
03627              NEXT SENTENCE                                        ELC50PD
03628          ELSE                                                     ELC50PD
03629              MOVE ER-2651        TO  WS-ERROR                     ELC50PD
03630              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
03631                                                                   ELC50PD
03632      IF PB-COMPANY-ID = 'FLA'                                     ELC50PD
03633          IF (WS-EDIT-AGE GREATER 54  OR                           ELC50PD
03634              WS-AH-EDIT-AGE GREATER 54)  AND                      ELC50PD
03635             PB-I-SIG-SW = 'N'                                     ELC50PD
03636             MOVE ER-2651         TO  WS-ERROR                     ELC50PD
03637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
03638                                                                   ELC50PD
03639  3135-NAME-EDIT.                                                  ELC50PD
03640                                                                   ELC50PD
           IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
              AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
              PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
                 MOVE PB-I-JOINT-FIRST-NAME (2:9)
                                       TO PB-I-JOINT-FIRST-NAME
              END-PERFORM
           END-IF

           IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
              AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
              PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
                 MOVE PB-I-JOINT-LAST-NAME (2:14)
                                       TO PB-I-JOINT-LAST-NAME
              END-PERFORM
           END-IF

           IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
              AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
              PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
                 MOVE PB-I-INSURED-FIRST-NAME (2:9)
                                       TO PB-I-INSURED-FIRST-NAME
              END-PERFORM
           END-IF

           IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
              AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
              PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
                 MOVE PB-I-INSURED-LAST-NAME (2:14)
                                       TO PB-I-INSURED-LAST-NAME
              END-PERFORM
           END-IF

03641      IF PB-I-INSURED-LAST-NAME = SPACES                           ELC50PD
03642        AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
03643        AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
03644            MOVE ER-2660    TO WS-ERROR                            ELC50PD
03645            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
03646                                                                   ELC50PD
03647  3136-EDIT-SEX.                                                   ELC50PD
03648                                                                   ELC50PD
03649 ******************************************************************ELC50PD
03650 *    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *ELC50PD
03651 ******************************************************************ELC50PD
03652                                                                   ELC50PD
03653      IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
03654         (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
03655         NEXT SENTENCE                                             ELC50PD
03656      ELSE                                                         ELC50PD
03657         IF PB-I-INSURED-SEX = 'M' OR 'F'                          ELC50PD
03658            NEXT SENTENCE                                          ELC50PD
03659         ELSE                                                      ELC50PD
03660            MOVE ER-2629            TO WS-ERROR                    ELC50PD
03661            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
03662                                                                   ELC50PD
03663  3137-EDIT-EFF-DATE.                                              ELC50PD
03664                                                                   ELC50PD
03665      IF PB-REISSUED-CERT       OR                                 ELC50PD
03666         PB-POLICY-IS-DECLINED  OR                                 ELC50PD
03667         PB-POLICY-IS-VOIDED                                       ELC50PD
03668          GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
03669                                                                   ELC50PD
03670      MOVE SPACE                  TO WS-2671-SW                    ELC50PD
03671                                     WS-2672-SW.                   ELC50PD
03672                                                                   ELC50PD
03673      IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')             ELC50PD
03674          IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END      ELC50PD
03675              MOVE ER-2703        TO WS-ERROR                      ELC50PD
03676              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
03677              GO TO 3139-EDIT-COVERAGE-CODES.                      ELC50PD
03678                                                                   ELC50PD
03679      IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END         ELC50PD
03680          GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
03681                                                                   ELC50PD
03682      MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
03683      MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.                ELC50PD
03684 *    MOVE '1'                    TO DC-OPTION-CODE.               ELC50PD
03685      SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
03686      MOVE +0                     TO DC-ELAPSED-MONTHS             ELC50PD
03687                                     DC-ELAPSED-DAYS.              ELC50PD
03688      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
03689                                                                   ELC50PD
03690      IF DATE-CONVERSION-ERROR                                     ELC50PD
03691          GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
03692                                                                   ELC50PD
03693      IF DC-ELAPSED-DAYS GREATER +180                              ELC50PD
03694          MOVE ER-2672            TO WS-ERROR                      ELC50PD
03695          MOVE 'Y'                TO WS-2672-SW                    ELC50PD
03696          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
031611     END-IF
03702                                                                   ELC50PD
03703      IF WS-ERROR = ER-2671  AND                                   ELC50PD
03704         PB-COMPANY-ID  = 'LBL'                                    ELC50PD
03705         MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)          ELC50PD
03706         MOVE SPACE               TO WS-2671-SW                    ELC50PD
03707         SUBTRACT +1            FROM PB-NO-OF-ERRORS.              ELC50PD
03708                                                                   ELC50PD
03709      IF PB-ISSUE-DATE-FORCED  AND                                 ELC50PD
03710       ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))      ELC50PD
03711          SUBTRACT +1           FROM PB-NO-OF-ERRORS               ELC50PD
03712          MOVE ER-2673            TO WS-ERROR                      ELC50PD
03713          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
03714          MOVE SPACE              TO WS-2671-SW                    ELC50PD
03715                                     WS-2672-SW.                   ELC50PD
03716                                                                   ELC50PD
03717      IF DC-ELAPSED-MONTHS IS GREATER THAN +9                      ELC50PD
03718          IF PB-ISSUE-DATE-FORCED                                  ELC50PD
03719              MOVE ER-2600          TO  WS-ERROR                   ELC50PD
03720              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
03721          ELSE                                                     ELC50PD
03722              MOVE ER-2692          TO  WS-ERROR                   ELC50PD
03723              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
03724                                                                   ELC50PD
03725                                                                   ELC50PD
03726  3139-EDIT-COVERAGE-CODES.                                        ELC50PD
03727                                                                   ELC50PD
042012     if pb-company-id not = 'AHL'
071305        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
071305           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
071305           MOVE ER-2787          TO WS-ERROR
071305           PERFORM 9900-ERROR-FORMAT
071305                                 THRU 9900-EXIT
071305        END-IF
042012     end-if

PEMMOD     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
PEMMOD        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
PEMMOD                                 > 250000.00
PEMMOD           MOVE ER-2719          TO WS-ERROR
PEMMOD           PERFORM 9900-ERROR-FORMAT
PEMMOD                                 THRU 9900-EXIT
PEMMOD        END-IF
PEMMOD     END-IF
PEMMOD
03728      IF PB-POLICY-IS-DECLINED  OR                                 ELC50PD
03729         PB-POLICY-IS-VOIDED                                       ELC50PD
03730          GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
03731                                                                   ELC50PD
03732      IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND             ELC50PD
03733         (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)                  ELC50PD
03734          MOVE ER-2630                TO WS-ERROR                  ELC50PD
03735          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
03736                                                                   ELC50PD
03737      IF PB-I-LF-BENEFIT-CD = ZERO  AND                            ELC50PD
03738         PB-I-LF-BENEFIT-AMT = ZERO  AND                           ELC50PD
03739         PB-I-LF-PREMIUM-AMT = ZERO                                ELC50PD
03740          GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
03741                                                                   ELC50PD
03742      IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
03743         PB-I-LF-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
03744         PB-I-LF-PREMIUM-AMT NOT = ZERO                            ELC50PD
03745          GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
03746                                                                   ELC50PD
03747      IF (PB-I-LF-BENEFIT-CD = ZERO)
100703        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
03748         MOVE ER-2631             TO WS-ERROR
03749         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
           END-IF
03750                                                                   ELC50PD
03751                                                                   ELC50PD
03752 ******************************************************************ELC50PD
03753 *    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS        ELC50PD
03754 ******************************************************************ELC50PD
03755                                                                   ELC50PD
03756      IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
03757         NEXT SENTENCE                                             ELC50PD
03758      ELSE                                                         ELC50PD
03759         IF PB-I-LF-BENEFIT-AMT = ZERO                             ELC50PD
03760            MOVE ER-2632             TO WS-ERROR                   ELC50PD
03761            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
03762                                                                   ELC50PD
03763                                                                   ELC50PD
03764 ******************************************************************ELC50PD
03765 *    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
03766 ******************************************************************ELC50PD
03767                                                                   ELC50PD
03768      IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
100703        CONTINUE                                                  ELC50PD
03770      ELSE                                                         ELC50PD
03771         IF PB-I-LF-PREMIUM-AMT = ZERO                             ELC50PD
03772            IF (NOT PB-COMP-LF-PREM)
100703              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
03773               MOVE ER-2633       TO WS-ERROR
03774               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
           END-IF
           
03775      .                                                            ELC50PD
03776  3140-CHECK-AH-FOR-ZERO.                                          ELC50PD
03777                                                                   ELC50PD
03778      IF PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
03779         PB-I-AH-BENEFIT-AMT = ZERO  AND                           ELC50PD
03780         PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
03781          GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
03782                                                                   ELC50PD
03783      IF PB-COMPANY-ID = 'CSL'  AND                                ELC50PD
03784         PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
03785         PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
03786         PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
03787          GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
03788                                                                   ELC50PD
03789      IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
03790         PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
03791         PB-I-AH-PREMIUM-AMT NOT = ZERO                            ELC50PD
03792          GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
03793                                                                   ELC50PD
03794      IF PB-I-AH-BENEFIT-CD = ZERO                                 ELC50PD
03795          MOVE ER-2634            TO WS-ERROR                      ELC50PD
03796          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
03797                                                                   ELC50PD
03798 ******************************************************************ELC50PD
03799 *     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
03800 ******************************************************************ELC50PD
03801                                                                   ELC50PD
03802      IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
03803         NEXT SENTENCE                                             ELC50PD
03804      ELSE                                                         ELC50PD
03805         IF PB-I-AH-BENEFIT-AMT = ZERO                             ELC50PD
03806            MOVE ER-2635             TO WS-ERROR                   ELC50PD
03807            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
03808                                                                   ELC50PD
03809 ******************************************************************ELC50PD
03810 *    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
03811 ******************************************************************ELC50PD
03812                                                                   ELC50PD
03813      IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
03814         NEXT SENTENCE                                             ELC50PD
03815      ELSE                                                         ELC50PD
03816         IF PB-I-AH-PREMIUM-AMT = ZERO                             ELC50PD
03817             IF NOT PB-COMP-AH-PREM                                ELC50PD
03818                 MOVE ER-2636    TO WS-ERROR                       ELC50PD
03819                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
03820                                                                   ELC50PD
03821                                                                   ELC50PD
03822  3140-EDIT-MAX-AMT-SIZES.                                         ELC50PD
03823 * CUSTOM CODE FOR CLIENT    'DMD'                                 ELC50PD
03824      MOVE ZEROS                   TO WS-RES-STATE-TAX             ELC50PD
03825                                      WS-RES-MUNI-TAX              ELC50PD
03826                                      PB-I-STATE-TAX               ELC50PD
03827                                      PB-I-MUNI-TAX.               ELC50PD
03828                                                                   ELC50PD
03829      PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.         ELC50PD
03830                                                                   ELC50PD
03831      IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
03832         GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
03833                                                                   ELC50PD
03834      IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
03835         GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
03836                                                                   ELC50PD
03837      IF WS-LF-EARNINGS-CALC EQUAL '5'                             ELC50PD
03838         GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
03839                                                                   ELC50PD
03840      IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'     ELC50PD
03841                              OR 'RIC')                            ELC50PD
03842         GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
03843                                                                   ELC50PD
03844      IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'                        ELC50PD
03845         IF PB-I-LOAN-APR GREATER THAN ZEROS                       ELC50PD
03846             GO TO 3150-RATE-OUTSTAND-BAL                          ELC50PD
03847         ELSE                                                      ELC50PD
03848            IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'                ELC50PD
03849                GO TO 3150-RATE-OUTSTAND-BAL.                      ELC50PD
03850                                                                   ELC50PD
03851      IF NOT PB-NO-MONTHS-SKIPPED                                  ELC50PD
03852         GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
03853                                                                   ELC50PD
03854      IF PB-I-LF-TERM NOT = PB-I-AH-TERM                           ELC50PD
03855         GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
03856                                                                   ELC50PD
03857      IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)                          ELC50PD
03858         IF PB-I-AH-BENEFIT-AMT NOT = ZERO                         ELC50PD
03859            COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -   ELC50PD
03860              (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                 ELC50PD
03861            MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA            ELC50PD
03862            IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM        ELC50PD
03863               MOVE ER-2693     TO WS-ERROR                        ELC50PD
03864               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
03865               GO TO 3150-RATE-OUTSTAND-BAL                        ELC50PD
03866            ELSE                                                   ELC50PD
03867               GO TO 3150-RATE-OUTSTAND-BAL.                       ELC50PD
03868                                                                   ELC50PD
03869  3150-RATE-OUTSTAND-BAL.                                          ELC50PD
03870                                                                   ELC50PD
03871 * DMD RATING TEST                                                 ELC50PD
03872      IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
03873          MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
03874          MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
03875          MOVE ER-2687                 TO WS-ERROR                 ELC50PD
03876          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
03877          MOVE 'B'                     TO PB-I-OB-FLAG             ELC50PD
03878          GO TO 3260-EDIT-CONTINUE.                                ELC50PD
03879                                                                   ELC50PD
03880      IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
03881          IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
03882              IF  WS-LF-EARNINGS-CALC   EQUAL  '5'                 ELC50PD
03883                  MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
03884                  SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
03885                  MOVE  +0            TO  WS-ERROR.                ELC50PD
03886                                                                   ELC50PD
03887      IF  PB-COMPANY-ID   EQUAL    'CDL'                           ELC50PD
03888          IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
03889              IF WS-STATE-ABBREVIATION EQUAL 'NC'                  ELC50PD
03890                  MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
03891                  SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
03892                  MOVE  +0            TO  WS-ERROR.                ELC50PD
03893                                                                   ELC50PD
03894      IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
03895         IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
03896             IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
03897               IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)ELC50PD
03898                  MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT  ELC50PD
03899                  MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
03900                  SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
03901                  MOVE  ER-1910           TO  WS-ERROR             ELC50PD
03902                  PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
03903                                                                   ELC50PD
03904      IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
03905         IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
03906             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)  ELC50PD
03907                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT    ELC50PD
03908                MOVE  ER-1910           TO  WS-ERROR               ELC50PD
03909                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
03910                                                                   ELC50PD
03911      IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
03912         IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
03913             IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
03914                 IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)      ELC50PD
03915                  MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
03916                  SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
03917                  MOVE  +0       TO  WS-ERROR.                     ELC50PD
03918                                                                   ELC50PD
03919      IF WS-ERROR = ER-2693                                        ELC50PD
03920         IF PB-COMPANY-ID = 'JAL' AND                              ELC50PD
03921            PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'      ELC50PD
03922            MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
03923            SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
03924                                                                   ELC50PD
03925      IF WS-ERROR = ER-2693                                        ELC50PD
03926         IF PB-COMPANY-ID = 'NCL'  AND                             ELC50PD
03927            PB-I-AH-BENEFIT-CD = 'OA'                              ELC50PD
03928            MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
03929            SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
03930                                                                   ELC50PD
03931      IF WS-ERROR = ER-2693                                        ELC50PD
03932         IF PB-COMPANY-ID = 'CNL' AND                              ELC50PD
03933            PB-I-LF-BENEFIT-CD = '71' OR '72'                      ELC50PD
03934            MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
03935            SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
03936                                                                   ELC50PD
03937      IF WS-ERROR = ER-2693                                        ELC50PD
03938         IF PB-COMPANY-ID = 'HER'                                  ELC50PD
03939            IF WS-LEVEL                                            ELC50PD
03940               MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
03941               SUBTRACT +1    FROM PB-NO-OF-ERRORS.                ELC50PD
03942                                                                   ELC50PD
03943      IF ((LF-BENEFIT-FOUND) AND                                   ELC50PD
03944          (NOT NO-LIFE-COVERAGE)  AND                              ELC50PD
03945          (WS-LF-SPECIAL-CALC-CD = 'O'))                           ELC50PD
03946        OR   ((AH-BENEFIT-FOUND) AND                               ELC50PD
03947              (NOT NO-AH-COVERAGE)    AND                          ELC50PD
03948              (WS-AH-SPECIAL-CALC-CD = 'O'))                       ELC50PD
03949          NEXT SENTENCE                                            ELC50PD
03950      ELSE                                                         ELC50PD
03951          GO TO 3215-EDIT-RATES.                                   ELC50PD
03952                                                                   ELC50PD
03953      IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
03954         AND WS-LF-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
03955            MOVE ER-2674          TO WS-ERROR                      ELC50PD
03956            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
03957            GO TO 3215-EDIT-RATES.                                 ELC50PD
03958                                                                   ELC50PD
03959      IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
03960         AND WS-AH-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
03961            MOVE ER-2674          TO WS-ERROR                      ELC50PD
03962            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
03963            GO TO 3215-EDIT-RATES.                                 ELC50PD
03964                                                                   ELC50PD
03965      MOVE 'B'                    TO PB-I-OB-FLAG.                 ELC50PD
03966                                                                   ELC50PD
03967      IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
03968          NEXT SENTENCE                                            ELC50PD
03969      ELSE                                                         ELC50PD
03970          IF NOT NO-LIFE-COVERAGE                                  ELC50PD
03971              IF WS-ACCT-LF-OB-RT = ZERO                           ELC50PD
03972                 MOVE ER-2641    TO WS-ERROR                       ELC50PD
03973                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
03974                                                                   ELC50PD
03975      IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
03976        IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE               ELC50PD
03977          MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
03978          MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
03979          IF WS-ERROR = ER-2675                                    ELC50PD
03980             SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
03981             MOVE ER-2687              TO WS-ERROR                 ELC50PD
03982             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
03983          ELSE                                                     ELC50PD
03984             MOVE ER-2687              TO WS-ERROR                 ELC50PD
03985             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
03986                                                                   ELC50PD
03987                                                                   ELC50PD
03988      IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
03989          NEXT SENTENCE                                            ELC50PD
03990      ELSE                                                         ELC50PD
041012       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
041012            NEXT SENTENCE
041012       ELSE
03991          IF NOT NO-AH-COVERAGE                                    ELC50PD
03992              IF WS-ACCT-AH-OB-RT = ZERO                           ELC50PD
03993                 MOVE ER-2642    TO WS-ERROR                       ELC50PD
03994                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
03995                                                                   ELC50PD
03996      IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
03997        IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                 ELC50PD
03998          MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC        ELC50PD
03999          IF WS-ERROR = ER-2676                                    ELC50PD
04000             SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
04001             MOVE ER-2687              TO WS-ERROR                 ELC50PD
04002             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
04003          ELSE                                                     ELC50PD
04004             MOVE ER-2687              TO WS-ERROR                 ELC50PD
04005             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
04006                                                                   ELC50PD
04007      IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
04008          COMPUTE PB-I-LF-PREM-CALC ROUNDED =                      ELC50PD
04009             (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000       ELC50PD
04010      ELSE                                                         ELC50PD
04011          IF PB-I-LF-PREM-CALC = ZEROS                             ELC50PD
04012              COMPUTE PB-I-LF-PREM-CALC ROUNDED =                  ELC50PD
04013                 (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.  ELC50PD
04014                                                                   ELC50PD
04015      IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
04016          COMPUTE PB-I-AH-PREM-CALC ROUNDED =                      ELC50PD
04017             (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000       ELC50PD
04018      ELSE                                                         ELC50PD
04019          IF PB-I-AH-PREM-CALC = ZEROS                             ELC50PD
04020              COMPUTE PB-I-AH-PREM-CALC ROUNDED =                  ELC50PD
04021                 (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.  ELC50PD
04022                                                                   ELC50PD
04023      MOVE ZEROS TO PB-I-MORT-CODE.                                ELC50PD
04024                                                                   ELC50PD
04025      GO TO 3260-EDIT-CONTINUE.                                    ELC50PD
04026                                                                   ELC50PD
04027                                                                   ELC50PD
04028  3215-EDIT-RATES.                                                 ELC50PD
04029      IF ACCOUNT-MAST-FOUND                                        ELC50PD
04030          NEXT SENTENCE                                            ELC50PD
04031      ELSE                                                         ELC50PD
04032          GO TO 3999-END-EDIT.                                     ELC50PD
04033                                                                   ELC50PD
04034  3220-CHECK-LF-RATES.                                             ELC50PD
04035                                                                   ELC50PD
082205     IF PB-COMPANY-ID = 'DCC'
082205        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
082205        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
082205        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
082205           AND (NOT WS-LF-CASH))
082205                           OR
082205           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
082205           AND (NOT WS-AH-CASH)))
111105                       AND
111105           (PB-I-ENTRY-STATUS NOT = '5')
082205           MOVE 'M'              TO PB-BATCH-ENTRY
082205                                    PB-I-ENTRY-STATUS
082205        END-IF
082205     END-IF



04036      MOVE ZEROS                  TO PB-I-LF-PREM-CALC             ELC50PD
04037                                     PB-I-AH-PREM-CALC             ELC50PD
04038                                     PB-I-LF-ALT-PREM-CALC         ELC50PD
04039                                     PB-I-LF-ALT-RATE              ELC50PD
04040                                     PB-I-LF-REI-RATE              ELC50PD
04041                                     PB-I-LF-ALT-REI-RATE          ELC50PD
04042                                     PB-I-AH-REI-RATE
011904                                    PB-I-TOT-FEES-CALC.
04043                                                                   ELC50PD
04044      IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
04045         NEXT SENTENCE                                             ELC50PD
04046      ELSE                                                         ELC50PD
04047         MOVE ZEROS               TO PB-I-LF-RATE                  ELC50PD
04048                                     PB-I-AH-RATE.                 ELC50PD
04049                                                                   ELC50PD
           IF PB-I-TOT-FEES NOT NUMERIC
              MOVE ZEROS               TO PB-I-TOT-FEES
           END-IF
           
04050      IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
04051          MOVE ZERO               TO PB-I-LIVES.                   ELC50PD
04052                                                                   ELC50PD
04053      IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
04054          MOVE ZERO               TO PB-I-NUM-BILLED.              ELC50PD
04055                                                                   ELC50PD
PEMMOD     IF PB-I-LF-PREM-TAX NOT NUMERIC                              ELC50PD
PEMMOD        MOVE +0                  TO PB-I-LF-PREM-TAX              ELC50PD
PEMMOD     END-IF
PEMMOD                                                                  ELC50PD
PEMMOD     IF PB-I-AH-PREM-TAX NOT NUMERIC                              ELC50PD
PEMMOD        MOVE +0                  TO PB-I-AH-PREM-TAX              ELC50PD
PEMMOD     END-IF
PEMMOD                                                                  ELC50PD
04056      IF PB-I-PAY-FREQUENCY NOT NUMERIC OR                         ELC50PD
04057         PB-I-PAY-FREQUENCY = ZEROS                                ELC50PD
04058             MOVE 12 TO CP-PAY-FREQUENCY                           ELC50PD
04059      ELSE                                                         ELC50PD
04060             MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.          ELC50PD
04061                                                                   ELC50PD
04062      IF PB-I-STATE-TAX NOT NUMERIC                                ELC50PD
04063          MOVE ZEROS               TO PB-I-STATE-TAX.              ELC50PD
04064                                                                   ELC50PD
04065      IF PB-I-MUNI-TAX NOT NUMERIC                                 ELC50PD
04066          MOVE ZEROS               TO PB-I-MUNI-TAX.               ELC50PD
04067                                                                   ELC50PD
100703     MOVE SPACES                 TO CP-BEN-CATEGORY
04068      IF PB-COMPANY-ID  = 'CSL'  AND                               ELC50PD
04069         PB-I-LF-TERM NOT = ZERO                                   ELC50PD
04070         COMPUTE WS-PAYMENT-AMT =                                  ELC50PD
04071              PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM                   ELC50PD
04072         COMPUTE WS-CSL-AMT1 =                                     ELC50PD
04073              PB-I-LF-TERM * AM-MAX-MON-BEN                        ELC50PD
04074         COMPUTE WS-CSL-AMT2 =                                     ELC50PD
04075              WS-PAYMENT-AMT * PB-I-LF-TERM                        ELC50PD
04076         IF CP-PAY-FREQUENCY NOT = 12                              ELC50PD
04077            MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT          ELC50PD
04078            MOVE '8' TO WS-CSL-CALC-CD                             ELC50PD
04079         ELSE                                                      ELC50PD
04080            IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND      ELC50PD
04081               (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN    ELC50PD
04082                AM-MAX-TOT-BEN                                     ELC50PD
04083                MOVE '6' TO WS-CSL-CALC-CD                         ELC50PD
04084            ELSE                                                   ELC50PD
04085               IF (WS-CSL-AMT1  GREATER THAN                       ELC50PD
04086                  AM-MAX-TOT-BEN) AND                              ELC50PD
04087                  (WS-CSL-AMT2  GREATER THAN                       ELC50PD
04088                  AM-MAX-TOT-BEN)                                  ELC50PD
04089                  MOVE '7' TO WS-CSL-CALC-CD                       ELC50PD
04090               ELSE                                                ELC50PD
04091                  MOVE '5' TO WS-CSL-CALC-CD.                      ELC50PD
04092                                                                   ELC50PD
04093      IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND               ELC50PD
04094          NEXT SENTENCE                                            ELC50PD
04095      ELSE                                                         ELC50PD
04096          GO TO 3300-CHECK-AH-RATES.                               ELC50PD
04097                                                                   ELC50PD
04098 *****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****        ELC50PD
04099                                                                   ELC50PD
04100      IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
04101         IF (PB-I-LF-CRIT-PER    EQUAL +0)                         ELC50PD
04102               OR                                                  ELC50PD
04103            (PB-I-PAYMENT-AMOUNT EQUAL +0)                         ELC50PD
04104            MOVE ER-2618          TO WS-ERROR                      ELC50PD
04105            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
04106            GO TO 3300-CHECK-AH-RATES.                             ELC50PD
04107                                                                   ELC50PD
04108      IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
04109            COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL                   ELC50PD
04110                    PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.        ELC50PD
04111                                                                   ELC50PD
04112      IF WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
04113          MOVE ER-2687             TO WS-ERROR                     ELC50PD
04114          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
04115          MOVE 'Z000'              TO PB-I-MORT-CODE               ELC50PD
04116          MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC            ELC50PD
04117          GO TO 3300-CHECK-AH-RATES.                               ELC50PD
04118                                                                   ELC50PD
04119      IF WS-LF-SPECIAL-CALC-CD = 'Z'                               ELC50PD
04120         IF PB-I-LIVES = ZERO                                      ELC50PD
04121            MOVE ER-2688          TO WS-ERROR                      ELC50PD
04122            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
04123                                                                   ELC50PD
04124      MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
04125                                                                   ELC50PD
04126      MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
04127      MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
04128      MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
04129      MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
04130      MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
04131      MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
04132      MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
04133      MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
04134      MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
04135      MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
04136                                                                   ELC50PD
04137 ******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
04138      IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
04139          IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
04140             CP-EARN-AS-NET-PAY)                                   ELC50PD
04141              IF PB-CERT-EFF-DT GREATER  WS-931231                 ELC50PD
04142                  MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
04143 *******                                                           ELC50PD
04144                                                                   ELC50PD
04145      MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
04146      MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
04147      MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
04148      MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
04149      MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
04150      MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
04151                                     CP-RATING-BENEFIT-AMT.        ELC50PD
04152      IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
04153          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
04154                                          PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
04155      MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
04156      MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
04157      MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
04158      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
04159      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
04160      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
04161      MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
04162      MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
04163      MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
04164                                     CP-REMAINING-TERM             ELC50PD
04165                                     CP-LOAN-TERM.                 ELC50PD
04166                                                                   ELC50PD
04167      IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
04168          NEXT SENTENCE                                            ELC50PD
04169      ELSE                                                         ELC50PD
04170          IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
04171              COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
04172                                            PB-I-LF-PREMIUM-AMT.   ELC50PD
04173                                                                   ELC50PD
04174      IF PB-COMPANY-ID EQUAL 'CSL'                                 ELC50PD
04175         IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD) ELC50PD
04176            COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -    ELC50PD
04177                                          PB-I-LF-PREMIUM-AMT.     ELC50PD
04178                                                                   ELC50PD
04179      IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
04180          IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
04181             CP-EARN-AS-NET-PAY                                    ELC50PD
04182              COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
04183                  PB-I-LF-PREMIUM-AMT.                             ELC50PD
04184                                                                   ELC50PD
032912     IF (CP-TRUNCATED-LIFE)                                       ELC50PD
032912        or ((pb-company-id = 'AHL')
032912           and (pb-i-loan-term > pb-i-lf-term))
04186         MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
04187                                                                   ELC50PD
04188      IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
04189         MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
04190                                                                   ELC50PD
04191      IF CP-TERM-IS-DAYS                                           ELC50PD
04192          MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
04193      ELSE                                                         ELC50PD
04194          MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD

080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
071311        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
071311        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
              IF WS-LF-BEN-CATEGORY = 'D'
011410           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
011410           MOVE PB-I-LIFE-COMMISSION
011410                                 TO CP-DCC-ACT-COMM
                 MOVE WS-LF-BEN-CATEGORY
                                       TO CP-BEN-CATEGORY
              END-IF
071311        IF (CP-BENEFIT-CD (1:1) = 'P')
071311           AND (PB-I-LOAN-TERM NOT = ZEROS)
071311           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
022513           add pb-i-ah-premium-amt to cp-original-premium
071311        END-IF
080305     END-IF

04196      IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
04197          MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT       ELC50PD
04198          MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
04199          MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.        ELC50PD
04200                                                                   ELC50PD
04201      IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
04202         MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.           ELC50PD
04203                                                                   ELC50PD
04204      IF (CP-SPECIAL-CALC-CD = 'H')
011904        OR (PB-COMPANY-ID = 'DCC')
04205          MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
04206                                     TO CP-ALTERNATE-BENEFIT       ELC50PD
04207          MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
04208                                                                   ELC50PD
           IF (PB-COMPANY-ID = 'CID')
              AND (WS-LF-EARNINGS-CALC = 'B')
              AND (CP-STATE-STD-ABBRV = 'MN')
              MOVE PB-I-LF-ALT-BENEFIT-AMT
                                       TO CP-ALTERNATE-BENEFIT
              MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
           END-IF

041310     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
04209      MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
04210      PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
04211                                                                   ELC50PD
04212      IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
04213         MOVE ER-2641            TO WS-ERROR                       ELC50PD
04214         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
04215         GO TO 3300-CHECK-AH-RATES.                                ELC50PD
04216                                                                   ELC50PD
04217      IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
04218         IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
04219            IF NOT ACCOUNT-LIFE-CHECKED                            ELC50PD
04220               MOVE ER-2607      TO WS-ERROR                       ELC50PD
04221               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
04222                                                                   ELC50PD

04223 ******************************************************************ELC50PD
04224 *    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *ELC50PD
04225 *    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
04226 ******************************************************************ELC50PD
04227                                                                   ELC50PD
CIDMOD* CALC LIFE AGE AT EXPIRATION.                                    00031342
CIDMOD                                                                  00031343
CIDMOD     COMPUTE WS-AGE-AT-EXPIRE =                                   00031344
CIDMOD          ((PB-I-LF-TERM / 12) + PB-I-AGE).                       00031345
CIDMOD                                                                  00031346
PEMMOD*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
PEMMOD*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
PEMMOD*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
PEMMOD*        MOVE ER-2709        TO WS-ERROR                          00031349
PEMMOD*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
PEMMOD*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
CIDMOD                                                                  00031352
PEMMOD*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031347
PEMMOD*        MOVE 'X'            TO PB-FATAL-FLAG                     00031348
PEMMOD*        MOVE ER-2718        TO WS-ERROR                          00031349
PEMMOD*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
PEMMOD*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
CIDMOD                                                                  00031352
CIDMOD* CALC A & H AGE AT EXPIRATION.                                   00031353
CIDMOD                                                                  00031354
CIDMOD     COMPUTE WS-AGE-AT-EXPIRE =                                   00031355
CIDMOD          ((PB-I-AH-TERM / 12) + PB-I-AGE).                       00031356
CIDMOD                                                                  00031357
PEMMOD*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
PEMMOD*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
PEMMOD*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
PEMMOD*        MOVE ER-2709        TO WS-ERROR                          00031349
PEMMOD*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
PEMMOD*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
CIDMOD                                                                  00031352
PEMMOD*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031358
PEMMOD*        MOVE 'X'            TO PB-FATAL-FLAG                     00031359
PEMMOD*        MOVE ER-2718        TO WS-ERROR                          00031360
PEMMOD*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031361
PEMMOD*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031362
CIDMOD
04228      IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED              ELC50PD
04229         GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
04230                                                                   ELC50PD
04231      IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'                      ELC50PD
04232         GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
04233                                                                   ELC50PD
04234      IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
04235         GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
04236                                                                   ELC50PD
04237      IF CP-ERROR-AMT-OUTSIDE-LIMIT                                ELC50PD
04238          MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS             ELC50PD
04239          MOVE ER-2639        TO WS-ERROR                          ELC50PD
04240          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
04241                                                                   ELC50PD
03157                                                                   00031363
04242 ******************************************************************ELC50PD
04243 *    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
04244 ******************************************************************ELC50PD
04245                                                                   ELC50PD
CIDMOD PREMIUM-EDITING-IS-BYPASSED.

042709     IF (CP-R-MAX-ATT-AGE NUMERIC)
042709        AND (CP-R-MAX-ATT-AGE > +0)
042709        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
042709        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
                 MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
042709           MOVE '1'              TO DC-OPTION-CODE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
042709                 MOVE ER-2661       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
042709           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
042709              MOVE ER-2661       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
020711           ELSE
020711              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
020711                 MOVE ER-1570    TO WS-ERROR
020711                 PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711              END-IF
042709           END-IF
042709        END-IF

042709        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709           MOVE PB-I-JOINT-BIRTHDAY
                                       TO DC-BIN-DATE-1
                 MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
042709           MOVE '1'              TO DC-OPTION-CODE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
042709                 MOVE ER-2661       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
                 ELSE
                    DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
                   (PB-I-LF-TERM / 12)
042709           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
042709              MOVE ER-2661       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
020711           ELSE
020711              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
020711                 MOVE ER-1571    TO WS-ERROR
020711                 PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711              END-IF
042709           END-IF
042709        END-IF
              IF WS-ERROR = ER-2661
042709           PERFORM 9900-ERROR-FORMAT
042709                                 THRU 9900-EXIT
              END-IF
042709     END-IF

04246 *    IF CP-ERROR-ATT-OUTSIDE-LIMIT                                ELC50PD
04247 *       MOVE ER-2661             TO WS-ERROR                      ELC50PD
04248 *       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
04249                                                                   ELC50PD
04250      IF CP-ERROR-AGE-OUTSIDE-LIMIT                                ELC50PD
04251         MOVE ER-2662             TO WS-ERROR                      ELC50PD
04252         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
04253                                                                   ELC50PD
04254      IF CP-ERROR-TERM-OUTSIDE-LIMIT                               ELC50PD
04255         MOVE ER-2677             TO WS-ERROR                      ELC50PD
04256         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
04257                                                                   ELC50PD
04258      IF CP-ERROR-LOAN-TERM                                        ELC50PD
04259         MOVE ER-2648             TO WS-ERROR                      ELC50PD
04260         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
04261                                                                   ELC50PD
04262  3221-CHECK-ERROR-RATE-OPEN.                                      ELC50PD
04263                                                                   ELC50PD
04264      IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
04265          GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
04266                                                                   ELC50PD
04267      IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
04268         MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE                ELC50PD
           END-IF

           .
04271  3221-CONTINUE.                                                   ELC50PD
011904     MOVE ZEROS                  TO WS-DCC-LF-RATE
011904                                    WS-DCC-AH-RATE

011410     IF PB-COMPANY-ID = 'DCC'
011410        IF WS-LF-BEN-CATEGORY = 'D'
011410           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
011410              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
011410        END-IF
011410     END-IF

04272      MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.            ELC50PD

      *   X'A4FF' = 12/31/2009
           IF (PB-COMPANY-ID = 'CID')
              AND (WS-LF-EARNINGS-CALC = 'B')
              AND (CP-STATE-STD-ABBRV = 'MN')
              AND (PB-CERT-EFF-DT > X'A4FF')
              MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
           END-IF

04273      MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.           ELC50PD
04274                                                                   ELC50PD
04275      MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.                ELC50PD
011904     IF (PB-COMPANY-ID = 'DCC')
011904        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
011904        AND (PB-I-POLICY-IS-MONTHLY)
011904        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
011904        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
011904     END-IF
04276      MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.         ELC50PD
04277      MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.             ELC50PD
04278      MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.            ELC50PD
04279      MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD

121304     IF (PB-COMPANY-ID = 'DCC')
121304        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
121304        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
121304        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
121304        MOVE ER-2786             TO WS-ERROR
121304        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
121304     END-IF
04280                                                                   ELC50PD
04281      MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.               ELC50PD
04282                                                                   ELC50PD
04283 ******************************************************************ELC50PD
04284 *    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
04285 ******************************************************************ELC50PD
04286      IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
04287         GO TO 3225-CHECK-ALT-LIFE-RATE.                           ELC50PD
04288                                                                   ELC50PD
04289      IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
04290         GO TO 3225-CHECK-ALT-LIFE-RATE                            ELC50PD
04291      ELSE                                                         ELC50PD
04292        IF PB-I-LF-RATE = ZERO                                     ELC50PD
04293           MOVE ER-2641          TO WS-ERROR                       ELC50PD
04294           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
04295                                                                   ELC50PD
04296  3225-CHECK-ALT-LIFE-RATE.                                        ELC50PD
04297                                                                   ELC50PD
04298      IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
04299         (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
04300         (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
04301          GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.                     ELC50PD
04302                                                                   ELC50PD
04303      IF (WS-LF-EARNINGS-CALC NOT = 'B')
04304          IF (PB-I-LF-ALT-BENEFIT-AMT > +0
011904             AND PB-COMPANY-ID NOT = 'DCC')
                         OR

04305               (PB-I-LF-ALT-PREMIUM-AMT > +0
04306               AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
071211              AND PB-COMPANY-ID NOT = 'DCC')
04307              MOVE ER-2720        TO  WS-ERROR                     ELC50PD
04308              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
04309              GO TO 3225-RATING-CONT                               ELC50PD
04310          ELSE                                                     ELC50PD
04311              GO TO 3225-RATING-CONT.                              ELC50PD

030612     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
111610        AND (AM-GPCD = 01 OR 06 OR 15)
111610        MOVE ER-2798             TO WS-ERROR
111610        PERFORM 9900-ERROR-FORMAT
111610                                 THRU 9900-EXIT
111610*       GO TO 3225-RATING-CONT
111610     END-IF

           IF (PB-COMPANY-ID = 'CID')
              AND (WS-LF-EARNINGS-CALC = 'B')
              AND (CP-STATE-STD-ABBRV = 'MN')
              AND (PB-CERT-EFF-DT > X'A4FF')
              GO TO 3225-RATING-CONT
           END-IF

011904     IF PB-COMPANY-ID = 'DCC'
011904        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
011904           AND (PB-I-POLICY-IS-MONTHLY)
011904           GO TO 3225-RATING-CONT
011904        END-IF
011904     END-IF
011904
04313      IF PB-COMPANY-ID EQUAL 'WDS' AND                             ELC50PD
04314         (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND            ELC50PD
04315         CP-EARN-AS-REG-BALLOON                                    ELC50PD
04316         NEXT SENTENCE                                             ELC50PD
04317      ELSE                                                         ELC50PD
04318         MOVE '2'                 TO CP-EARNING-METHOD.            ELC50PD
04319                                                                   ELC50PD
04320  3225-SET-ALT-LIFE-RATE-LOOKUP.                                   ELC50PD
04321                                                                   ELC50PD
04322      MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
04323                                                                   ELC50PD
04324      IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
04325         (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
04326         (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
04327          NEXT SENTENCE                                            ELC50PD
04328      ELSE                                                         ELC50PD
04329          MOVE SPACE              TO CP-SPECIAL-CALC-CD.           ELC50PD
04330                                                                   ELC50PD
04331      MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
04332      MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
04333      MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
04334                                      CP-RATING-BENEFIT-AMT.       ELC50PD
04335      IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
04336          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
04337                                          PB-I-LF-ALT-BENEFIT-AMT. ELC50PD

080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
080305     END-IF

04338      MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
04339      MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
04340      MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
04341                                     CP-REMAINING-TERM             ELC50PD
04342                                     CP-LOAN-TERM.                 ELC50PD
04343      IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
04344         ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
04345                                     CP-REMAINING-TERM             ELC50PD
04346                                     CP-LOAN-TERM.                 ELC50PD
04347                                                                   ELC50PD
04348      MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
04349      PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
04350                                                                   ELC50PD
04351      IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
04352          MOVE ER-2641            TO WS-ERROR                      ELC50PD
04353          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
04354          GO TO 3300-CHECK-AH-RATES.                               ELC50PD
04355                                                                   ELC50PD
04356      MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.             ELC50PD
04357      MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.        ELC50PD
04358                                                                   ELC50PD
04359      IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN      ELC50PD
04360          MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
04361                                                                   ELC50PD
04362      COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
04363                                + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
04364                                                                   ELC50PD
04365      IF ACCOUNT-LIFE-CHECKED  OR                                  ELC50PD
04366         PB-POLICY-IS-VOIDED   OR                                  ELC50PD
04367         (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')                    ELC50PD
04368         GO TO 3225-CONTINUE.                                      ELC50PD
04369                                                                   ELC50PD
04370      IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
04371         GO TO 3225-CONTINUE.                                      ELC50PD
04372                                                                   ELC50PD
04373      IF WS-LF-BENEFIT-AMT  GREATER THAN                           ELC50PD
04374                              EC-RT-LF-MAX-TOT-BEN                 ELC50PD
04375         MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS               ELC50PD
04376         MOVE ER-2639       TO WS-ERROR                            ELC50PD
04377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
04378                                                                   ELC50PD
04379  3225-CONTINUE.                                                   ELC50PD
04380      IF PB-I-LF-ALT-RATE = ZERO                                   ELC50PD
04381          MOVE ER-2659            TO WS-ERROR                      ELC50PD
04382          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
04383                                                                   ELC50PD
04384      IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR                         ELC50PD
04385         PB-I-LF-ALT-PREMIUM-AMT = ZERO                            ELC50PD
04386         MOVE ER-2698             TO WS-ERROR                      ELC50PD
04387         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
04388                                                                   ELC50PD
04389  3225-RATING-CONT.                                                ELC50PD
04390                                                                   ELC50PD
04391      IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
04392          MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
04393          MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
111212         IF (PB-COMPANY-ID = 'DCC')
111212            AND (AM-DCC-PRODUCT-CODE = 'DDF')
111212            CONTINUE
111212         ELSE
04394             MOVE ER-2687         TO WS-ERROR
04395             PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
111212         END-IF
04396          GO TO 3290-EDIT-LF-REIN-RATE
111212     END-IF
04397                                                                   ELC50PD
04398 * DMD RATING TEST                                                 ELC50PD
04399      IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
04400          MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
04401          MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
04402          MOVE ER-2687                 TO WS-ERROR                 ELC50PD
04403          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
04404          GO TO 3290-EDIT-LF-REIN-RATE.                            ELC50PD
04405                                                                   ELC50PD
04406  3230-CLIENT-MORT-CD-SPECIALS.                                    ELC50PD
04407                                                                   ELC50PD
04408      MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.                   ELC50PD
04409      SET BIN-TO-GREG          TO TRUE.                            ELC50PD
04410 *    MOVE ' '                 TO DC-OPTION-CODE.                  ELC50PD
04411      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
04412      MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.                    ELC50PD
04413                                                                   ELC50PD
04414  C-POS-3230-MORT-CD.                                              ELC50PD
04415      IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
04416         PB-SV-CARRIER = '2'                                       ELC50PD
04417          NEXT SENTENCE                                            ELC50PD
04418      ELSE                                                         ELC50PD
04419          GO TO C-POS-3240-MORT-CD.                                ELC50PD
04420                                                                   ELC50PD
04421      IF PB-SV-GROUPING = '030'                                    ELC50PD
04422         AND PB-CERT-EFF-DT GREATER THAN WS-791231                 ELC50PD
04423          MOVE '2350' TO PB-I-MORT-CODE                            ELC50PD
04424       ELSE                                                        ELC50PD
04425          MOVE '3300' TO PB-I-MORT-CODE.                           ELC50PD
04426                                                                   ELC50PD
04427                                                                   ELC50PD
04428  C-POS-3240-MORT-CD.                                              ELC50PD
04429      IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
04430         PB-SV-CARRIER = '1'                                       ELC50PD
04431          NEXT SENTENCE                                            ELC50PD
04432      ELSE                                                         ELC50PD
CIDMOD         GO TO 3230-CONTINUE.                                     ELC50PD
04434                                                                   ELC50PD
04435      IF PB-SV-STATE = '45' OR '47'                                ELC50PD
04436         OR PB-CERT-EFF-DT LESS THAN WS-771001                     ELC50PD
04437          MOVE '5200' TO PB-I-MORT-CODE                            ELC50PD
04438      ELSE                                                         ELC50PD
04439          MOVE '8300' TO PB-I-MORT-CODE.                           ELC50PD
04440                                                                   ELC50PD
CIDMOD 3230-CONTINUE.                                                   ELC50PD
CIDMOD
CIDMOD     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'                       00033064
CIDMOD        GO TO 3240-CONTINUE                                       00033065
CIDMOD     END-IF
CIDMOD
CIDMOD     IF PB-CERT-EFF-DT > WS-971231
CIDMOD        GO TO 3240-CONTINUE                                       00033065
CIDMOD     END-IF
CIDMOD
CIDMOD     IF LF-BENEFIT-FOUND AND                                      00033066
CIDMOD        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'                     00033067
CIDMOD         MOVE 'F250'       TO PB-I-MORT-CODE                      00033068
CIDMOD     ELSE                                                         00033069
CIDMOD         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'                      00033070
CIDMOD             MOVE '7250'   TO PB-I-MORT-CODE                      00033071
CIDMOD         ELSE                                                     00033072
CIDMOD             MOVE '4251'   TO PB-I-MORT-CODE                      00033073
CIDMOD         END-IF
CIDMOD     END-IF
CIDMOD                                                                  00033074
CIDMOD     .
04441  3240-CONTINUE.                                                   ELC50PD
CIDMOD
04442      IF PB-COMPANY-ID NOT = 'GNL'                                 ELC50PD
04443          GO TO 3256-CONTINUE.                                     ELC50PD
04444                                                                   ELC50PD
04445      IF PB-CERT-EFF-DT  LESS THAN WS-820301                       ELC50PD
04446          MOVE 'A300' TO PB-I-MORT-CODE                            ELC50PD
04447      ELSE                                                         ELC50PD
04448          MOVE '8350' TO PB-I-MORT-CODE.                           ELC50PD
04449                                                                   ELC50PD
04450  3256-CONTINUE.                                                   ELC50PD
04451      IF PB-COMPANY-ID NOT = 'ABL'                                 ELC50PD
04452          GO TO 3260-EDIT-CONTINUE.                                ELC50PD
04453                                                                   ELC50PD
04454      IF PB-I-LF-TERM GREATER THAN 59                              ELC50PD
04455          MOVE 'F550' TO PB-I-MORT-CODE                            ELC50PD
04456      ELSE                                                         ELC50PD
04457          MOVE 'E550' TO PB-I-MORT-CODE.                           ELC50PD
04458                                                                   ELC50PD
04459  3260-EDIT-CONTINUE.                                              ELC50PD
04460      MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.                       ELC50PD
04461                                                                   ELC50PD
04462  3290-EDIT-LF-REIN-RATE.                                          ELC50PD
04463      IF LF-REIN-NSP-NOT-USED                                      ELC50PD
04464          GO TO 3290-RATING-CONT.                                  ELC50PD
04465                                                                   ELC50PD
PEMTST     IF PB-COMPANY-ID = 'DCC'
PEMTST        GO TO 3290-RATING-CONT.

04466      MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.         ELC50PD
04467      MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
04468      MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.               ELC50PD
04469      MOVE '3'                   TO CP-PROCESS-TYPE.               ELC50PD
04470      MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
04471                                                                   ELC50PD
04472 ******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
04473      IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
04474          IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
04475             CP-EARN-AS-NET-PAY)                                   ELC50PD
04476              MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1                 ELC50PD
04477 *            MOVE SPACE          TO DC-OPTION-CODE                ELC50PD
04478              SET BIN-TO-GREG     TO TRUE                          ELC50PD
04479              PERFORM 8500-DATE-CONVERT THRU 8500-EXIT             ELC50PD
04480 ***  Y2K PROJ 7744                                                   CL*11
04481              IF DC-GREG-DATE-CYMD GREATER 19931231                   CL*10
04482                  MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
04483 ***  Y2K PROJ 7744                                                   CL*11
04484 *******                                                           ELC50PD
04485                                                                   ELC50PD
04486      MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
04487      MOVE PB-SV-STATE           TO CP-STATE.                      ELC50PD
04488      MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.                 ELC50PD
04489      MOVE ZERO                  TO CP-DEVIATION-CODE              ELC50PD
04490                                    CP-RATE-DEV-PCT.               ELC50PD
04491      MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                 ELC50PD
04492      MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT            ELC50PD
04493                                    CP-RATING-BENEFIT-AMT.         ELC50PD
04494                                                                   ELC50PD
04495 ************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA     ELC50PD
04496      IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
04497          IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
04498             CP-EARN-AS-NET-PAY                                    ELC50PD
04499              COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
04500                  PB-I-LF-PREMIUM-AMT.                             ELC50PD
04501 ************                                                      ELC50PD
04502                                                                   ELC50PD
04503      IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
04504          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
04505                                          PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
04506      MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.           ELC50PD
04507      MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.                  ELC50PD
04508      MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.                ELC50PD
04509      MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.                 ELC50PD
04510      MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.                 ELC50PD
04511      MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.                   ELC50PD
04512      MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.            ELC50PD
04513      MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM               ELC50PD
04514                                    CP-REMAINING-TERM              ELC50PD
04515                                    CP-LOAN-TERM.                  ELC50PD
04516      IF CP-TRUNCATED-LIFE                                         ELC50PD
04517         MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.                  ELC50PD
04518                                                                   ELC50PD
04519      IF CP-TERM-IS-DAYS                                           ELC50PD
04520          MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS         ELC50PD
04521      ELSE                                                         ELC50PD
04522          MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
04523                                                                   ELC50PD

080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
080305     END-IF

04524      IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
04525           MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
04526                                                                   ELC50PD
04527      MOVE WS-NSP-ST-CD-LF    TO CP-STATE.                         ELC50PD
04528                                                                   ELC50PD
04529      MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
04530      PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
04531                                                                   ELC50PD
04532      IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
04533         IF PB-I-OB                                                ELC50PD
04534            MOVE ER-2625      TO WS-ERROR                          ELC50PD
04535            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
04536            GO TO 3299-EDIT-CONTINUE                               ELC50PD
04537         ELSE                                                      ELC50PD
04538            MOVE ER-2643      TO WS-ERROR                          ELC50PD
04539            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
04540            GO TO 3299-EDIT-CONTINUE.                              ELC50PD
04541                                                                   ELC50PD
04542      MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.                 ELC50PD
04543                                                                   ELC50PD
04544      MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.                ELC50PD
04545      MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.                  ELC50PD
04546                                                                   ELC50PD
04547      IF PB-I-LF-REI-RATE = ZERO                                   ELC50PD
04548          MOVE ER-2643        TO WS-ERROR                          ELC50PD
04549          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
04550                                                                   ELC50PD
04551  3290-CHECK-ALT-REIN-RATE.                                        ELC50PD
04552                                                                   ELC50PD
04553      IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
04554         GO TO 3290-RATING-CONT.                                   ELC50PD
04555                                                                   ELC50PD
04556      MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
04557      MOVE '2'                    TO CP-EARNING-METHOD.            ELC50PD
04558      MOVE SPACE                  TO CP-SPECIAL-CALC-CD.           ELC50PD
04559      MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
04560      MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
04561      MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
04562                                      CP-RATING-BENEFIT-AMT.       ELC50PD
04563      IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
04564          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
04565                                          PB-I-LF-ALT-BENEFIT-AMT. ELC50PD

080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
080305     END-IF

04566      MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
04567      MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
04568      MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
04569                                     CP-REMAINING-TERM             ELC50PD
04570                                     CP-LOAN-TERM.                 ELC50PD
04571      IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
04572         ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
04573                                     CP-REMAINING-TERM             ELC50PD
04574                                     CP-LOAN-TERM.                 ELC50PD
04575                                                                   ELC50PD
04576      MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
04577      PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
04578                                                                   ELC50PD
04579      MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.         ELC50PD
04580                                                                   ELC50PD
04581      IF PB-I-LF-ALT-REI-RATE = ZERO                               ELC50PD
04582          MOVE ER-2643            TO WS-ERROR                      ELC50PD
04583          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
04584                                                                   ELC50PD
04585  3290-RATING-CONT.                                                ELC50PD
04586                                                                   ELC50PD
04587      IF PB-I-OB                                                   ELC50PD
04588 *       GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
04589         GO TO 3300-CHECK-AH-RATES.                                ELC50PD
04590                                                                   ELC50PD
04591  3299-EDIT-CONTINUE.                                              ELC50PD
04592                                                                   ELC50PD
04593      IF  PB-I-MORT-CODE GREATER THAN SPACES                       ELC50PD
04594          NEXT SENTENCE                                            ELC50PD
04595      ELSE                                                         ELC50PD
04596          MOVE ER-2620           TO WS-ERROR                       ELC50PD
04597          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
04598                                                                   ELC50PD
04599  3300-CHECK-AH-RATES.                                             ELC50PD
04600      IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND                 ELC50PD
04601          NEXT SENTENCE                                            ELC50PD
04602      ELSE                                                         ELC50PD
04603          GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
04604                                                                   ELC50PD
04605      IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR                        ELC50PD
04606         ((CF-COMPANY-ID = 'DMD') AND                              ELC50PD
04607                 (NO-DMD-RATING))                                  ELC50PD
111212         IF (PB-COMPANY-ID = 'DCC')
111212            AND (AM-DCC-PRODUCT-CODE = 'DDF')
111212            CONTINUE
111212         ELSE
04608             MOVE ER-2687         TO WS-ERROR
04609             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
111212         END-IF
04610          MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
04611          GO TO 3335-EDIT-AH-REIN-NSP-RATE
111212     END-IF
04612                                                                   ELC50PD
04613      IF PB-I-OB                                                   ELC50PD
04614         GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
04615                                                                   ELC50PD
04616      IF WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
04617          MOVE ER-2687             TO WS-ERROR                     ELC50PD
04618          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
04619          MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC            ELC50PD
04620          GO TO 3999-END-EDIT.                                     ELC50PD
04621                                                                   ELC50PD
04622 *****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****        ELC50PD
04623                                                                   ELC50PD
04624      IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
04625         IF PB-I-AH-CRIT-PER = ZERO
071211           IF PB-COMPANY-ID = 'DCC'
071211              AND AM-DCC-PRODUCT-CODE = 'DDF'
071211              CONTINUE
071211           ELSE
04626               MOVE ER-2618       TO WS-ERROR
04627               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04628               GO TO 3999-END-EDIT
                 END-IF
              END-IF
           END-IF

04631      MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
04632      MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
04633      MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
04634      MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
04635      MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
04636      MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
04637      MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
04638      MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.            ELC50PD
04639      MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.              ELC50PD
04640 *    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
04641      MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
04642      MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
04643      MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
04644      MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
04645                                     CP-RATING-BENEFIT-AMT.        ELC50PD
091610     IF PB-COMPANY-ID = 'CID'
091610               OR
04646         CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
04647          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
04648                                          PB-I-AH-TERM.            ELC50PD
123102     IF PB-COMPANY-ID = 'DCC' OR 'CID'
071311        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
011904           AND (PB-I-POLICY-IS-MONTHLY)
123102           MOVE PB-I-LF-BENEFIT-AMT
123102                                 TO CP-NET-BENEFIT-AMT
                 move pb-i-ah-premium-amt to cp-original-premium
022513           add pb-i-lf-premium-amt to cp-original-premium
123102        END-IF
123102     END-IF

100703     MOVE SPACES                 TO CP-BEN-CATEGORY

           IF PB-COMPANY-ID = 'DCC'
              MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
              EVALUATE TRUE
                 WHEN (WS-AH-BEN-CATEGORY = 'G')
                    AND (AM-DCC-PRODUCT-CODE = 'DDF')
                    MOVE PB-I-LF-BENEFIT-AMT
                                       TO CP-RATING-BENEFIT-AMT
                    MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
                 WHEN WS-AH-BEN-CATEGORY = 'G'
                    MOVE PB-I-UNPAID-CASH-PRICE
                                       TO CP-RATING-BENEFIT-AMT
                 WHEN WS-AH-BEN-CATEGORY = 'D'
                    MOVE WS-AH-PMF-COMM
                                       TO CP-DCC-PMF-COMM
                    MOVE PB-I-AH-COMMISSION
                                       TO CP-DCC-ACT-COMM
              END-EVALUATE
           END-IF

04649      MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
04650      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
04651      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
04652      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
04653      MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
04654      MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.           ELC50PD
04655      MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
04656                                     CP-REMAINING-TERM             ELC50PD
04657                                     WS-WORK-TERM.                 ELC50PD
04658      MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.          ELC50PD
04659                                                                   ELC50PD
04660      MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
04661      SET BIN-TO-GREG             TO TRUE.                         ELC50PD
04662 *    MOVE ' '                    TO DC-OPTION-CODE.               ELC50PD
04663      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
04664      MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.                 ELC50PD
04665                                                                   ELC50PD
04666      MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.           ELC50PD
04667      IF NOT VALID-SKIP-CODE                                       ELC50PD
04668          MOVE ER-2683            TO WS-ERROR                      ELC50PD
04669          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
04670          GO TO 3320-RATE-CONTINUE.                                ELC50PD
04671                                                                   ELC50PD
04672      IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
04673          GO TO 3320-RATE-CONTINUE.                                ELC50PD
04674                                                                   ELC50PD
04675      MOVE SPACE TO NUMBER-OF-MONTHS.                              ELC50PD
04676                                                                   ELC50PD
04677      IF PB-I-SKIP-CODE = '7' OR '8' OR '9'                        ELC50PD
04678          MOVE 'S'                TO SK-MO (6).                    ELC50PD
04679      IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'          ELC50PD
04680          MOVE 'S'                TO SK-MO (7).                    ELC50PD
04681      IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'   ELC50PD
04682          MOVE 'S'                TO SK-MO (8).                    ELC50PD
04683      IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'                 ELC50PD
04684          MOVE 'S'                TO SK-MO (9).                    ELC50PD
04685      IF PB-I-SKIP-CODE = 'A'                                      ELC50PD
04686          MOVE 'S'                TO SK-MO (10).                   ELC50PD
04687                                                                   ELC50PD
04688      MOVE 1                      TO SUB2.                         ELC50PD
04689      MOVE PB-I-AH-TERM           TO SUB3.                         ELC50PD
04690      MOVE WS-MONTH               TO SUB1.                         ELC50PD
04691      PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.       ELC50PD
04692      GO TO 3320-RATE-CONTINUE.                                    ELC50PD
04693                                                                   ELC50PD
04694  3310-GET-SKIP-MO.                                                ELC50PD
04695      IF SUB1 = 13                                                 ELC50PD
04696          MOVE 1                  TO SUB1.                         ELC50PD
04697                                                                   ELC50PD
04698      IF SK-MO (SUB1) = 'S'                                        ELC50PD
04699          SUBTRACT 1 FROM WS-WORK-TERM.                            ELC50PD
04700                                                                   ELC50PD
04701      ADD 1 TO SUB2                                                ELC50PD
04702               SUB1.                                               ELC50PD
04703                                                                   ELC50PD
04704  3320-RATE-CONTINUE.                                              ELC50PD
04705                                                                   ELC50PD
04706      IF WS-WORK-TERM = ZERO                                       ELC50PD
04707          MOVE 1                  TO WS-WORK-TERM.                 ELC50PD
04708                                                                   ELC50PD
04709      MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM              ELC50PD
04710                                     CP-LOAN-TERM.                 ELC50PD
04711                                                                   ELC50PD
04712      IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
04713          NEXT SENTENCE                                            ELC50PD
04714      ELSE                                                         ELC50PD
04715          MOVE ZERO               TO PB-I-AH-RATE                  ELC50PD
04716                                     PB-I-AH-REI-RATE.             ELC50PD
04717                                                                   ELC50PD
04718                                                                   ELC50PD
04719      IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
04720         MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
04721                                                                   ELC50PD
04722      IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
04723          MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN              ELC50PD
04724          MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN              ELC50PD
04725          MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
04726          MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.               ELC50PD
04727                                                                   ELC50PD
           IF PB-COMPANY-ID = 'DCC'
              IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
                 COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
                    PB-I-RATE-DEV-PCT-LF
              END-IF
              MOVE PB-I-LF-ALT-BENEFIT-AMT
                                       TO CP-ALTERNATE-BENEFIT
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
071311        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
071311        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
           END-IF

           IF (PB-COMPANY-ID = 'CID')
              AND (WS-LF-EARNINGS-CALC = 'B')
              AND (CP-STATE-STD-ABBRV = 'MN')
              MOVE 'Y'                 TO CP-AH-BALLOON-SW
           ELSE
              MOVE ' '                 TO CP-AH-BALLOON-SW
           END-IF

011904     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
04728      MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
04729      PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
04730                                                                   ELC50PD
04731      IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
04732         IF PB-I-OB                                                ELC50PD
04733            MOVE ER-2624          TO WS-ERROR                      ELC50PD
04734            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
04735            GO TO 3340-CALCULATE-PREMIUM-AMT                       ELC50PD
04736         ELSE                                                      ELC50PD
041012          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
041012              NEXT SENTENCE
041012          ELSE
04737            MOVE ER-2642          TO WS-ERROR                      ELC50PD
04738            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
04739            GO TO 3340-CALCULATE-PREMIUM-AMT.                      ELC50PD
04740                                                                   ELC50PD
04741      IF PB-COMPANY-ID EQUAL 'CSL' AND                             ELC50PD
04742         CP-ERROR-DIV-BY-ZERO                                      ELC50PD
04743            MOVE ER-3782          TO WS-ERROR                      ELC50PD
04744            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
04745                                                                   ELC50PD
04746      IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
04747         IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
04748            IF NOT ACCOUNT-AH-CHECKED                              ELC50PD
04749               MOVE ER-2607          TO WS-ERROR                   ELC50PD
04750               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
04751                                                                   ELC50PD
04752      IF ACCOUNT-AH-CHECKED                                        ELC50PD
04753         NEXT SENTENCE                                             ELC50PD
04754      ELSE                                                         ELC50PD
04755        IF CP-ERROR-AMT-OUTSIDE-LIMIT                              ELC50PD
04756           MOVE ER-2640           TO WS-ERROR                      ELC50PD
04757           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
04758                                                                   ELC50PD
04759      IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
04760          IF WS-ERROR = ER-2640                                    ELC50PD
04761              MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD

042709     IF ACCOUNT-AH-CHECKED
042709        CONTINUE
042709     ELSE
042709        IF (CP-R-MAX-ATT-AGE NUMERIC)
042709           AND (CP-R-MAX-ATT-AGE > +0)
042709           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
042709           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
042709              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
                    MOVE PB-I-AH-EXPIRE-DT
                                       TO DC-BIN-DATE-2
042709              MOVE '1'           TO DC-OPTION-CODE
042709              PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709              IF NO-CONVERSION-ERROR
042709                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
042709                    MOVE ER-2661       TO WS-ERROR
042709*                   PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709                 END-IF
042709              END-IF
042709           ELSE
042709              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
042709              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
042709                 MOVE ER-2661    TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
020711              ELSE
020711                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
020711                    MOVE ER-1570 TO WS-ERROR
020711                    PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711                 END-IF
042709              END-IF
042709           END-IF

042709           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709              MOVE PB-I-JOINT-BIRTHDAY
                                          TO DC-BIN-DATE-1
                    MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
042709              MOVE '1'              TO DC-OPTION-CODE
042709              PERFORM 8500-DATE-CONVERT
042709                                    THRU 8500-EXIT
042709              IF NO-CONVERSION-ERROR
042709                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
042709                    MOVE ER-2661       TO WS-ERROR
042709*                   PERFORM 9900-ERROR-FORMAT
042709*                                   THRU 9900-EXIT
042709                 END-IF
042709              END-IF
042709           ELSE
042709              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
                      (PB-I-AH-TERM / 12)
042709              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
042709                 MOVE ER-2661       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                   THRU 9900-EXIT
020711              ELSE
020711                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
020711                    MOVE ER-1571 TO WS-ERROR
020711                    PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711                 END-IF
042709              END-IF
042709           END-IF
                 IF WS-ERROR = ER-2661
042709              PERFORM 9900-ERROR-FORMAT
042709                                    THRU 9900-EXIT
                 END-IF
              END-IF
042709     END-IF

042709*    IF ACCOUNT-AH-CHECKED                                        ELC50PD
042709*       NEXT SENTENCE                                             ELC50PD
042709*    ELSE                                                         ELC50PD
042709*       IF CP-ERROR-ATT-OUTSIDE-LIMIT                             ELC50PD
042709*          MOVE ER-2661          TO WS-ERROR                      ELC50PD
042709*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
04769                                                                   ELC50PD
04770      IF ACCOUNT-AH-CHECKED                                        ELC50PD
04771         NEXT SENTENCE                                             ELC50PD
04772      ELSE                                                         ELC50PD
04773         IF CP-ERROR-AGE-OUTSIDE-LIMIT                             ELC50PD
04774            MOVE ER-2663          TO WS-ERROR                      ELC50PD
04775            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
04776                                                                   ELC50PD
04777      IF ACCOUNT-AH-CHECKED OR                                     ELC50PD
04778         (WS-AH-SPECIAL-CALC-CD = 'Z') OR                          ELC50PD
04779          PB-POLICY-IS-VOIDED                                      ELC50PD
04780         NEXT SENTENCE                                             ELC50PD
04781      ELSE                                                         ELC50PD
04782         IF CP-ERROR-TOT-OUTSIDE-LIMIT                             ELC50PD
04783            MOVE ER-2667            TO WS-ERROR                    ELC50PD
04784            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
04785                                                                   ELC50PD
04786      IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
04787          IF WS-ERROR = ER-2667                                    ELC50PD
04788              MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
04789                                                                   ELC50PD
04790      IF ACCOUNT-AH-CHECKED                                        ELC50PD
04791         NEXT SENTENCE                                             ELC50PD
04792      ELSE                                                         ELC50PD
04793         IF CP-ERROR-TERM-OUTSIDE-LIMIT                            ELC50PD
04794            MOVE ER-2678            TO WS-ERROR                    ELC50PD
04795            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
04796                                                                   ELC50PD
04797      IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
04798          GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
04799                                                                   ELC50PD
04800  3321-CONTINUE.                                                   ELC50PD
04801      MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.                 ELC50PD
04802      MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.            ELC50PD

100703     IF (PB-COMPANY-ID = 'DCC')
100703        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
100703        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
100703                                    PB-I-LF-ALT-PREM-CALC
100703        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
092705        IF WS-AH-BEN-CATEGORY = 'G'
100703           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
040504           + PB-I-ADDL-CLP)
071211           * (1 + WS-TOL-CLP-PCT)
071211*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
092705        ELSE
092705           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
071211           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
071211*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
092705        END-IF
070705        MOVE WS-TOL-LF-HIGH-PREM-AMT
070705                                 TO PB-I-AH-PREM-CALC
100703        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
100703           MOVE ER-8152          TO WS-ERROR
100703           PERFORM 9900-ERROR-FORMAT
100703                                 THRU 9900-EXIT
100703        ELSE
100703           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
                       PB-I-ADDL-CLP)
100703              MOVE ER-8148       TO WS-ERROR
100703              PERFORM 9900-ERROR-FORMAT
100703                                 THRU 9900-EXIT
100703           END-IF
100703        END-IF
100703     END-IF
011904     IF (PB-COMPANY-ID = 'DCC')
011904        AND (PB-I-POLICY-IS-MONTHLY)
011904        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
011904        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
011904        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
                 MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
              END-IF
011904     END-IF

121304     IF (PB-COMPANY-ID = 'DCC')
121304        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
121304        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
121304        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
121304        MOVE ER-2786             TO WS-ERROR
121304        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
121304     END-IF

071211     MOVE +0                     TO PB-I-AH-CLP
011410     IF PB-COMPANY-ID = 'DCC'
011410        IF WS-AH-BEN-CATEGORY = 'D'
011410           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
011410              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
071211        ELSE
071211           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
071211              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
071211           END-IF
011410        END-IF
011410     END-IF

04803      MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.           ELC50PD
04804                                                                   ELC50PD
04805      IF PB-I-NO-OF-PAYMENTS NOT NUMERIC                           ELC50PD
04806          MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.          ELC50PD
04807                                                                   ELC50PD
04808      IF PB-I-PAYMENT-AMOUNT NOT NUMERIC                           ELC50PD
04809          MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.          ELC50PD
04810                                                                   ELC50PD
04811      IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
04812          IF PB-I-NO-OF-PAYMENTS = ZERO  OR                        ELC50PD
04813             PB-I-PAYMENT-AMOUNT = ZERO                            ELC50PD
04814              NEXT SENTENCE                                        ELC50PD
04815          ELSE                                                     ELC50PD
04816              COMPUTE PB-I-AH-PREM-CALC =                          ELC50PD
04817                  (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *    ELC50PD
04818                  (CP-PREMIUM-RATE / 100)                          ELC50PD
04819              IF PB-I-RATE-DEV-PCT-AH NOT = ZERO                   ELC50PD
04820                  COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *  ELC50PD
04821                                              PB-I-RATE-DEV-PCT-AH.ELC50PD
04822                                                                   ELC50PD
04823      IF PB-I-AH-RATE  = ZERO                                      ELC50PD
041012       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
041012           NEXT SENTENCE
041012       ELSE
04824          MOVE ER-2642            TO WS-ERROR                      ELC50PD
04825          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
04826                                                                   ELC50PD
04827      MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.                ELC50PD
04828      MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.         ELC50PD
04829      MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.             ELC50PD
04830      MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.            ELC50PD
04831      MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.         ELC50PD
04832      MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.         ELC50PD
04833                                                                   ELC50PD
071211     IF (PB-COMPANY-ID = 'DCC')
071211        AND (WS-AH-BEN-CATEGORY = 'G')
071211        AND (AM-DCC-PRODUCT-CODE = 'DDF')
071211        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
071211        IF CP-DEVIATION-CODE NOT = '000'
071211           MOVE '000'            TO CP-DEVIATION-CODE
071211           PERFORM 7000-GET-RATE THRU 7000-EXIT
071211           IF NO-CP-ERROR
071211              COMPUTE PB-I-DDF-IU-RATE-UP = 
071211              PB-I-AH-CLP - CP-CALC-PREMIUM
071211           ELSE
071211              MOVE ER-3057        TO WS-ERROR
071211              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
071211           END-IF
071211        END-IF
071211     END-IF

           .
04834  3335-EDIT-AH-REIN-NSP-RATE.                                      ELC50PD
04835      IF AH-REIN-NSP-NOT-USED                                      ELC50PD
04836          GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
04837                                                                   ELC50PD
PEMTST     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.                       ELC50PD
PEMTST     IF PB-COMPANY-ID = 'DCC'
PEMTST         GO TO 3340-CALCULATE-PREMIUM-AMT.

04838      MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
04839      MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
04840      MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
04841      MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
04842      MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
04843      MOVE ZERO                   TO CP-DEVIATION-CODE             ELC50PD
04844                                     CP-RATE-DEV-PCT.              ELC50PD
04845 *    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
04846      MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
04847      MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
04848      MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
04849      MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
04850                                     CP-RATING-BENEFIT-AMT.        ELC50PD
04851      IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
04852          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
04853                                          PB-I-AH-TERM.            ELC50PD
04854      MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
04855      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
04856      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
04857      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
04858      MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
04859      MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
04860                                     CP-REMAINING-TERM             ELC50PD
04861                                     WS-WORK-TERM.                 ELC50PD
04862      MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.           ELC50PD

080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
080305     END-IF

04864      IF  PB-COMPANY-ID = 'TIC'                                    ELC50PD
04865          IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'             ELC50PD
04866             MOVE ZERO TO CP-CLASS-CODE.                           ELC50PD
04867                                                                   ELC50PD
04868      IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
04869           MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
04870                                                                   ELC50PD
04871      MOVE ZERO               TO CP-DEVIATION-CODE.                ELC50PD
04872                                                                   ELC50PD
04873      MOVE WS-NSP-ST-CD-AH    TO CP-STATE.                         ELC50PD
04874                                                                   ELC50PD
04875      MOVE ZERO               TO PB-I-AH-REI-RATE.                 ELC50PD
04876                                                                   ELC50PD
04877      MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
04878      PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
04879                                                                   ELC50PD
04880      IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
04881          MOVE ER-2645        TO WS-ERROR                          ELC50PD
04882          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
04883          GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
04884                                                                   ELC50PD
04885      MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.                 ELC50PD
04886                                                                   ELC50PD
04887      MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.                ELC50PD
04888      MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.                  ELC50PD
04889                                                                   ELC50PD
04890      IF PB-I-AH-REI-RATE = ZERO                                   ELC50PD
04891          MOVE ER-2645        TO WS-ERROR                          ELC50PD
04892          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
04893                                                                   ELC50PD
04894                                                                   ELC50PD
04895  3340-CALCULATE-PREMIUM-AMT.                                      ELC50PD
04896                                                                   ELC50PD
04897      IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
04898          IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR                      ELC50PD
04899              WS-AH-SPECIAL-CALC-CD = 'O')                         ELC50PD
04900              GO TO 3999-END-EDIT.                                 ELC50PD
04901                                                                   ELC50PD
04902      IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR       ELC50PD
04903                         'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR       ELC50PD
040407                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'          ELC50PD
030612                         OR 'AHL'
04905          NEXT SENTENCE                                            ELC50PD
04906      ELSE                                                         ELC50PD
04907          IF WS-STATE-ABBREVIATION = 'CT'                          ELC50PD
04908              IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND ELC50PD
04909                 (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)       ELC50PD
04910                  COMPUTE PB-I-LF-PREM-CALC =                      ELC50PD
04911                                      PB-I-LF-PREM-CALC * .90      ELC50PD
04912                  COMPUTE PB-I-LF-ALT-PREM-CALC =                  ELC50PD
04913                                      PB-I-LF-ALT-PREM-CALC * .90  ELC50PD
04914                  COMPUTE PB-I-AH-PREM-CALC =                      ELC50PD
04915                                      PB-I-AH-PREM-CALC * .90.     ELC50PD
04916                                                                   ELC50PD
04917      IF PB-COMP-LF-PREM                                           ELC50PD
04918         MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT       ELC50PD
04919         MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.  ELC50PD
04920                                                                   ELC50PD
04921      IF PB-COMP-AH-PREM                                           ELC50PD
04922         MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.      ELC50PD
04923                                                                   ELC50PD
011904 3340-CHECK-DCC-TOT-FEES.

           IF (PB-COMPANY-ID = 'DCC')
              AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
              AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
              AND (PB-I-POLICY-IS-MONTHLY)
              CONTINUE
           ELSE
              GO TO 3340-EDIT-LF-AH-TOL
           END-IF

           MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
           MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE

           IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
              COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
                 PB-I-RATE-DEV-PCT-LF
           END-IF
           IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
              COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
                 PB-I-RATE-DEV-PCT-AH
           END-IF
           MOVE 'N'                    TO CP-BEN-CATEGORY
                  
04124      MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
04125                                                                   ELC50PD
04126      MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
04127      MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
04128      MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
04129      MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
04130      MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
04131      MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
04132      MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
04133      MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
04134      MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
04135      MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
04136                                                                   ELC50PD
04145      MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
04146      MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
04147      MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
04148      MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
04149      MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
04150      MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
04151                                     CP-RATING-BENEFIT-AMT.        ELC50PD
04152      IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
04153          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
04154                                          PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
04155      MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
04156      MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
04157      MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
04158      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
04159      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
04160      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
04161      MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
04162      MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
04163      MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
04164                                     CP-REMAINING-TERM             ELC50PD
04165                                     CP-LOAN-TERM.                 ELC50PD
04166                                                                   ELC50PD
04167      IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
04168          NEXT SENTENCE                                            ELC50PD
04169      ELSE                                                         ELC50PD
04170          IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
04171              COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
04172                                            PB-I-LF-PREMIUM-AMT.   ELC50PD
04184                                                                   ELC50PD
04185      IF CP-TRUNCATED-LIFE                                         ELC50PD
04186         MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
04187                                                                   ELC50PD
04191      IF CP-TERM-IS-DAYS                                           ELC50PD
04192          MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
04193      ELSE                                                         ELC50PD
04194          MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
04195                                                                   ELC50PD

080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
080305     END-IF

04204      IF CP-SPECIAL-CALC-CD = 'H'                                  ELC50PD
04205          MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
04206                                     TO CP-ALTERNATE-BENEFIT       ELC50PD
04207          MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD

           MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
           MOVE 'R'                    TO CP-RATE-FILE
           PERFORM 7000-GET-RATE       THRU 7000-EXIT

           IF NOT CP-ERROR-RATE-NOT-FOUND
              MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
              IF (CP-DCC-LF-RATE NOT = ZEROS)
                 AND (CP-BENEFIT-CD (1:1) = 'S')
                 MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
                                          PB-I-LF-PREMIUM-AMT
              END-IF
           ELSE
              MOVE +0                  TO PB-I-TOT-FEES-CALC
           END-IF

04925      .
04926  3340-EDIT-LF-AH-TOL.                                             ELC50PD
04927                                                                   ELC50PD
04928 ***    UNSIGN-WRK1    =    LIFE DIFFERENCE                        ELC50PD
04929 ***    UNSIGN-WRK2    =    AH   DIFFERENCE                        ELC50PD
04930 ***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE                   ELC50PD
04931 ***                                                               ELC50PD
04932      ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT            ELC50PD
04933          PB-I-AH-PREMIUM-AMT                                      ELC50PD
04934           GIVING WS-CALC-WORK.                                    ELC50PD
04935                                                                   ELC50PD
04936      IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM                     ELC50PD
04937         AND WS-CALC-WORK NOT = ZERO                               ELC50PD
04938          MOVE ER-2649            TO WS-ERROR                      ELC50PD
04939          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
04940                                                                   ELC50PD
04941      SUBTRACT PB-I-LF-PREM-CALC                                      CL**2
04942              FROM PB-I-LF-PREMIUM-AMT                             ELC50PD
04943                  GIVING WS-UNSIGN-WRK1.                              CL**2
04944                                                                      CL**2
04945      SUBTRACT PB-I-LF-ALT-PREM-CALC                                  CL**2
04946              FROM PB-I-LF-ALT-PREMIUM-AMT                         ELC50PD
04947                  GIVING WS-UNSIGN-WRK4.                              CL**2
04948                                                                      CL**2
04949      COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1                         CL**2
04950                                 + WS-UNSIGN-WRK4.                    CL**2
04951                                                                      CL**2
04952      SUBTRACT PB-I-AH-PREM-CALC                                      CL**2
04953              FROM PB-I-AH-PREMIUM-AMT                             ELC50PD
04954                  GIVING WS-UNSIGN-WRK2.                           ELC50PD
04955                                                                   ELC50PD
04956 ******************************************************************ELC50PD
04957 *    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *ELC50PD
04958 ******************************************************************ELC50PD
04959                                                                   ELC50PD
04960      IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
04961          MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
04962                                                                   ELC50PD
04963      IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
04964          MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
04965                                                                   ELC50PD
04966      ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2                               CL**2
04967              GIVING WS-UNSIGN-WRK3.                               ELC50PD
04968                                                                   ELC50PD
04969  3342-CONTINUE.                                                   ELC50PD
04970                                                                   ELC50PD
04971      IF (PB-I-LF-RATE = ZERO  AND                                 ELC50PD
04972          PB-I-AH-RATE = ZERO)                                     ELC50PD
04973          IF WS-LF-SPECIAL-CALC-CD = 'O' OR                        ELC50PD
04974             WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
04975               NEXT SENTENCE                                       ELC50PD
04976          ELSE                                                     ELC50PD
04977              GO TO 3345-EDIT-CONTINUE.                            ELC50PD
04978                                                                   ELC50PD
04979      IF  PB-RECORD-BILL   =  'B' OR  'L'                          ELC50PD
04980          NEXT SENTENCE                                            ELC50PD
04981      ELSE                                                         ELC50PD
04982      IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'                        ELC50PD
04983         IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM             ELC50PD
04984            IF (PB-REISSUED-CERT         OR                        ELC50PD
04985                PB-POLICY-IS-DECLINED    OR                        ELC50PD
04986                PB-POLICY-IS-VOIDED)                               ELC50PD
04987               NEXT SENTENCE                                       ELC50PD
04988            ELSE                                                   ELC50PD
04989               IF WS-PREM-REJECT-SW = SPACE                        ELC50PD
04990                  MOVE ER-2652    TO WS-ERROR                      ELC50PD
04991                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
04992                  GO TO 3344-CHECK-AH                              ELC50PD
04993               ELSE                                                ELC50PD
04994                  MOVE ER-2650    TO WS-ERROR                      ELC50PD
04995                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
04996                  GO TO 3344-CHECK-AH.                             ELC50PD
04997                                                                   ELC50PD
04998 ***                                                               ELC50PD
04999 ***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES                ELC50PD
05000 ***                                                               ELC50PD
05001                                                                   ELC50PD
05002      IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
05003          COMPUTE WS-TOL-LF-HIGH-PREM-PCT =                        ELC50PD
05004             (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
05005              (1 + WS-TOL-LF-PREM-PCT)                             ELC50PD
05006          COMPUTE WS-TOL-LF-LOW-PREM-PCT  =                        ELC50PD
05007             (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
05008              (1 - WS-TOL-LF-PREM-PCT)                             ELC50PD
05009      ELSE                                                         ELC50PD
05010          MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT      ELC50PD
05011          MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
05012                                                                   ELC50PD
05013 ***                                                               ELC50PD
05014 ***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES                 ELC50PD
05015 ***                                                               ELC50PD
05016                                                                   ELC50PD
05017      COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL                        ELC50PD
05018          PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +              ELC50PD
05019           WS-TOL-LF-PREM.                                         ELC50PD
05020                                                                   ELC50PD
05021      COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL                         ELC50PD
05022          (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -            ELC50PD
05023           WS-TOL-LF-PREM.                                         ELC50PD
05024                                                                   ELC50PD
05025      IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
05026         MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.       ELC50PD
05027                                                                   ELC50PD
05028      IF (PB-REISSUED-CERT        OR                               ELC50PD
05029          PB-POLICY-IS-DECLINED   OR                               ELC50PD
05030          PB-POLICY-IS-VOIDED)                                     ELC50PD
05031         NEXT SENTENCE                                             ELC50PD
05032      ELSE                                                         ELC50PD
05033      IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)         ELC50PD
05034            GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)                 ELC50PD
05035        OR                                                         ELC50PD
05036         ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)          ELC50PD
05037            LESS THAN WS-TOL-LF-LOW-PREM-AMT))                     ELC50PD
05038        AND
05039         (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)         ELC50PD
05040            GREATER WS-TOL-LF-HIGH-PREM-PCT)                       ELC50PD
05041          OR                                                       ELC50PD
05042           ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)        ELC50PD
05043            LESS WS-TOL-LF-LOW-PREM-PCT))                          ELC50PD
05044               IF WS-PREM-REJECT-SW IS EQUAL TO SPACE              ELC50PD
05045                   MOVE ER-2652   TO  WS-ERROR                     ELC50PD
05046                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
05047               ELSE                                                ELC50PD
05048                   MOVE ER-2650   TO  WS-ERROR                     ELC50PD
05049                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
05050                                                                   ELC50PD
05051 *    IF  WS-ERROR  =  ER-2650  OR  ER-2652                        ELC50PD
05052 *        IF  PB-RECORD-BILL   =  'B' OR  'L'                      ELC50PD
05053 *            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
05054 *            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
05055                                                                   ELC50PD
100703     IF WS-ERROR  =  ER-2650  OR  ER-2652
100703        IF (PB-RECORD-BILL   =  'B' OR  'L')
100703                      OR
100703           ((PB-COMPANY-ID = 'DCC')
100703           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
100703           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
100703           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
100703        END-IF
100703     END-IF
05055                                                                   ELC50PD
05056      IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
05057         IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
05058            IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
05059               IF (PB-REISSUED-CERT         OR                     ELC50PD
05060                   PB-POLICY-IS-DECLINED    OR                     ELC50PD
05061                   PB-POLICY-IS-VOIDED)                            ELC50PD
05062                  NEXT SENTENCE                                    ELC50PD
05063               ELSE                                                ELC50PD
05064                   MOVE ER-2646   TO  WS-ERROR                     ELC50PD
05065                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
05066                                                                   ELC50PD
05067  3344-CVL-TOLERANCE-CHECK.                                        ELC50PD
05068                                                                   ELC50PD
05069       IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'                    ELC50PD
05070           GO TO 3344-CHECK-AH.                                    ELC50PD
05071                                                                   ELC50PD
05072       IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS              ELC50PD
05073           GO TO 3344-CHECK-AH.                                    ELC50PD
05074                                                                   ELC50PD
05075       MOVE ZERO                  TO  WS-UNSIGN-WRK5               ELC50PD
05076                                      WS-UNSIGN-WRK6.              ELC50PD
05077                                                                   ELC50PD
05078       IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO               ELC50PD
05079           COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5                 ELC50PD
05080                                  + PB-I-LF-PREMIUM-AMT            ELC50PD
05081                                  - PB-I-LF-PREM-CALC.             ELC50PD
05082                                                                   ELC50PD
05083       IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO           ELC50PD
05084           COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6                 ELC50PD
05085                                  + PB-I-LF-ALT-PREMIUM-AMT        ELC50PD
05086                                  - PB-I-LF-ALT-PREM-CALC.         ELC50PD
05087                                                                   ELC50PD
05088       IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO                    ELC50PD
05089           IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
05090               IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
05091                  MOVE ER-2652    TO  WS-ERROR                     ELC50PD
05092                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
05093               ELSE                                                ELC50PD
05094                  MOVE ER-2650    TO  WS-ERROR                     ELC50PD
05095                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
05096                                                                   ELC50PD
05097       IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO                    ELC50PD
05098           IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
05099               IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
05100                  MOVE ER-2652    TO  WS-ERROR                     ELC50PD
05101                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
05102               ELSE                                                ELC50PD
05103                  MOVE ER-2650    TO  WS-ERROR                     ELC50PD
05104                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
05105                                                                   ELC50PD
05106  3344-CHECK-AH.                                                   ELC50PD
05107                                                                   ELC50PD
05108 ****************************************************************  ELC50PD
05109 ***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES                  ELC50PD
05110 ***                                                               ELC50PD
05111                                                                   ELC50PD
05112      IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
05113          COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *    ELC50PD
05114              (1 + WS-TOL-AH-PREM-PCT)                             ELC50PD
05115          COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *    ELC50PD
05116              (1 - WS-TOL-AH-PREM-PCT)                             ELC50PD
05117      ELSE                                                         ELC50PD
05118          MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT      ELC50PD
05119          MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
05120                                                                   ELC50PD
05121 ***                                                               ELC50PD
05122 ***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES                   ELC50PD
05123 ***                                                               ELC50PD
05124                                                                   ELC50PD
05125      COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL                        ELC50PD
05126          PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.                      ELC50PD
05127                                                                   ELC50PD
05128      COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL                         ELC50PD
05129          PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.                      ELC50PD
05130                                                                   ELC50PD
05131      IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
05132         MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.       ELC50PD
05133                                                                   ELC50PD
05134      IF (PB-REISSUED-CERT)
05135         OR (PB-POLICY-IS-DECLINED)
              OR (PB-POLICY-IS-VOIDED)
              OR (AM-DCC-PRODUCT-CODE = 'DDF')
              CONTINUE
05138      ELSE
05139         IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
05141             OR
05142            (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
05143            AND
05144            ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
05145            OR
05146            (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
05147            IF WS-PREM-REJECT-SW = SPACE              
05148               MOVE ER-3052       TO WS-ERROR
05149               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
05150            ELSE                     
05151               MOVE ER-3050       TO WS-ERROR
05152               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
           END-IF
05153                                                                   ELC50PD
05154      IF  WS-ERROR  =  ER-3050   OR   ER-3052                      ELC50PD
05155          IF  PB-RECORD-BILL   =  'B' OR 'A'                       ELC50PD
05156              MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
05157              SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
05158                                                                   ELC50PD
05159      IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
05160         IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
05161            IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
05162               IF (PB-REISSUED-CERT         OR                     ELC50PD
05163                   PB-POLICY-IS-DECLINED    OR                     ELC50PD
05164                   PB-POLICY-IS-VOIDED)                            ELC50PD
05165                  NEXT SENTENCE                                    ELC50PD
05166               ELSE                                                ELC50PD
05167                   MOVE ER-2646   TO  WS-ERROR                     ELC50PD
05168                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
05169                                                                   ELC50PD
05170      IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR              ELC50PD
05171         (WS-COMP-MAX-CAP EQUAL +0)                                ELC50PD
05172            GO TO 3345-EDIT-CONTINUE.                              ELC50PD
05173                                                                   ELC50PD
05174      IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)  ELC50PD
05175         GREATER THAN WS-COMP-MAX-CAP                              ELC50PD
05176            MOVE ER-2646          TO  WS-ERROR                     ELC50PD
05177            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
05178                                                                   ELC50PD
05179  3345-EDIT-CONTINUE.                                              ELC50PD
05180                                                                   ELC50PD
072308*    IF PB-COMPANY-ID    EQUAL    'NCL'                           ELC50PD
072308*       IF PB-ENTRY-BATCH   NUMERIC                               ELC50PD
072308*          IF PB-ISSUE                                            ELC50PD
072308*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO         ELC50PD
072308*          ELSE                                                   ELC50PD
072308*              IF PB-CANCELLATION                                 ELC50PD
072308*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.      ELC50PD
05188                                                                   ELC50PD
05189 *    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
05190 *        IF  PB-I-MICROFILM-NO     NUMERIC    AND                 ELC50PD
05191 *            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS                  ELC50PD
05192 *            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO     ELC50PD
05193 *        ELSE                                                     ELC50PD
05194 *            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
05195 *            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.         ELC50PD
05196                                                                   ELC50PD
05197      IF PB-I-POLICY-ACCEPTED                                      ELC50PD
05198         IF PB-POLICY-IS-DECLINED  OR                              ELC50PD
05199            PB-REISSUED-CERT  OR                                   ELC50PD
05200            PB-REIN-ONLY-CERT  OR                                  ELC50PD
05201            PB-POLICY-IS-VOIDED                                    ELC50PD
05202             MOVE  ER-1891         TO  WS-ERROR                    ELC50PD
05203             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
05204         ELSE                                                      ELC50PD
05205             MOVE SPACE            TO  PB-BATCH-ENTRY              ELC50PD
05206             MOVE '2'              TO  PB-I-ENTRY-STATUS.          ELC50PD
05207                                                                   ELC50PD
05208      IF PB-I-POLICY-DECLINED                                      ELC50PD
05209         IF PB-REISSUED-CERT  OR                                   ELC50PD
05210            PB-REIN-ONLY-CERT  OR                                  ELC50PD
05211            PB-POLICY-IS-VOIDED                                    ELC50PD
05212             MOVE  ER-1906         TO  WS-ERROR                    ELC50PD
05213             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
05214         ELSE                                                      ELC50PD
05215             MOVE  'D'             TO  PB-BATCH-ENTRY              ELC50PD
05216                                       PB-I-ENTRY-STATUS.          ELC50PD
05217                                                                   ELC50PD
05218      IF PB-I-NEEDS-UNDERWRITING                                   ELC50PD
05219         IF PB-POLICY-IS-DECLINED OR                               ELC50PD
05220            PB-REISSUED-CERT  OR                                   ELC50PD
05221            PB-REIN-ONLY-CERT  OR                                  ELC50PD
05222            PB-POLICY-IS-VOIDED                                    ELC50PD
05223             MOVE  ER-1907         TO  WS-ERROR                    ELC50PD
05224             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
05225         ELSE                                                      ELC50PD
05226             MOVE 'U'              TO  PB-BATCH-ENTRY              ELC50PD
05227                                       PB-I-ENTRY-STATUS.          ELC50PD
05228                                                                   ELC50PD
05229      IF PB-NEEDS-UNDERWRITING                                     ELC50PD
05230         MOVE  ER-1901             TO  WS-ERROR                    ELC50PD
05231         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD

082205     IF PB-COMPANY-ID = 'DCC'
082205        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
082205        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
082205        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
082205           AND (NOT WS-LF-CASH))
082205                           OR
082205           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
082205           AND (NOT WS-AH-CASH)))
111105                       AND
111105           (PB-I-ENTRY-STATUS NOT = '5')
082205           MOVE 'M'              TO PB-BATCH-ENTRY
082205                                    PB-I-ENTRY-STATUS
082205        END-IF
082205     END-IF

05233      IF  PB-COMPANY-ID NOT = 'NCL'                                ELC50PD
05234          GO TO 3999-END-EDIT.                                     ELC50PD
05235                                                                   ELC50PD
05236      IF PB-REISSUED-CERT  OR                                      ELC50PD
05237         PB-POLICY-IS-DECLINED  OR                                 ELC50PD
05238         PB-POLICY-IS-VOIDED  OR                                   ELC50PD
05239         PB-I-OB                                                   ELC50PD
05240          GO TO 3999-END-EDIT.                                     ELC50PD
05241                                                                   ELC50PD
05242      IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS                   ELC50PD
05243          MOVE  ER-2644            TO  WS-ERROR                    ELC50PD
05244          PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
05245          GO TO 3999-END-EDIT.                                     ELC50PD
05246                                                                   ELC50PD
05247      MOVE 'N'                     TO  FORM-MASTER-SW.             ELC50PD
05248      PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.                   ELC50PD
05249                                                                   ELC50PD
05250      IF NOT FORM-MASTER-FOUND                                     ELC50PD
05251          GO TO 3999-END-EDIT.                                     ELC50PD
05252                                                                   ELC50PD
05253      MOVE 'N'                     TO  FORM-MASTER-LIFE-SW         ELC50PD
05254                                       FORM-MASTER-AH-SW.          ELC50PD
05255                                                                   ELC50PD
05256      IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES            ELC50PD
05257          MOVE  +1                 TO SUB6                         ELC50PD
05258          PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.      ELC50PD
05259                                                                   ELC50PD
05260      IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES               ELC50PD
05261          MOVE  +1                 TO SUB6                         ELC50PD
05262          PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.      ELC50PD
05263                                                                   ELC50PD
05264      IF LF-FORM-MASTER-FOUND  OR                                  ELC50PD
05265         AH-FORM-MASTER-FOUND                                      ELC50PD
05266          GO TO 3360-CHECK-FORM-LIMITS                             ELC50PD
05267      ELSE                                                         ELC50PD
05268          GO TO 3999-END-EDIT.                                     ELC50PD
05269                                                                   ELC50PD
05270 ******************************************************************ELC50PD
05271 *                  3350-GET-ERFORM                               *ELC50PD
05272 *    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *ELC50PD
05273 *    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *ELC50PD
05274 ******************************************************************ELC50PD
05275                                                                   ELC50PD
05276  3350-GET-ERFORM.                                                 ELC50PD
05277                                                                   ELC50PD
05278      IF  WK-FORM-ADDR      EQUAL    ZEROS                         ELC50PD
05279          GO TO  3350-ERFORM-GETMAIN.                              ELC50PD
05280                                                                   ELC50PD
05281      MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.             ELC50PD
05282      SET ERFORM-FILE-ADDRESSED    TO  TRUE.                       ELC50PD
05283      PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
05284      MOVE 'Y'                     TO FORM-MASTER-SW.              ELC50PD
05285                                                                   ELC50PD
05286      IF PB-CANCELLATION                                           ELC50PD
05287          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
05288             PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
05289             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID               ELC50PD
05290               GO TO 3350-EXIT                                     ELC50PD
05291          ELSE                                                     ELC50PD
05292              NEXT SENTENCE                                        ELC50PD
05293      ELSE                                                         ELC50PD
05294          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
05295             PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
05296             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID               ELC50PD
05297               GO TO 3350-EXIT.                                    ELC50PD
05298                                                                   ELC50PD
05299  3350-ERFORM-GETMAIN.                                             ELC50PD
05300                                                                   ELC50PD
05301      PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.           ELC50PD
05302      MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.               ELC50PD
05303                                                                   ELC50PD
05304  3350-ERFORM-READ.                                                ELC50PD
05305                                                                   ELC50PD
05306      MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.            ELC50PD
05307      MOVE  PB-SV-STATE            TO  FORM-STATE.                 ELC50PD
05308      IF PB-CANCELLATION                                           ELC50PD
05309          MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID            ELC50PD
05310      ELSE                                                         ELC50PD
05311          MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.           ELC50PD
05312      MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.           ELC50PD
05313                                                                   ELC50PD
05314      PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.             ELC50PD
05315                                                                   ELC50PD
05316      IF FORM-MASTER-FOUND                                         ELC50PD
05317        IF PB-CANCELLATION                                         ELC50PD
05318           IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
05319              PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
05320              CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID              ELC50PD
05321               GO  TO 3350-EXIT                                    ELC50PD
05322           ELSE                                                    ELC50PD
05323               NEXT SENTENCE                                       ELC50PD
05324        ELSE                                                       ELC50PD
05325           IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
05326              PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
05327              PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID              ELC50PD
05328               GO  TO 3350-EXIT.                                   ELC50PD
05329                                                                   ELC50PD
05330      MOVE  'N'                    TO  FORM-MASTER-SW.             ELC50PD
05331      MOVE  ER-1895                TO  WS-ERROR.                   ELC50PD
05332      PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.                 ELC50PD
05333                                                                   ELC50PD
05334  3350-EXIT.                                                       ELC50PD
05335       EXIT.                                                       ELC50PD
05336                                                                   ELC50PD
05337 ******************************************************************ELC50PD
05338 *                  3355-EDIT-FORM-LF-BENEFITS                    *ELC50PD
05339 *   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *ELC50PD
05340 *   VALID FOR THE POLICY FORM USED.                              *ELC50PD
05341 ******************************************************************ELC50PD
05342                                                                   ELC50PD
05343  3355-EDIT-FORM-LF-BENEFITS.                                      ELC50PD
05344                                                                   ELC50PD
05345      IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND          ELC50PD
05346         PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)                 ELC50PD
05347          MOVE  'Y'                TO  FORM-MASTER-LIFE-SW         ELC50PD
05348          GO TO   3355-EXIT.                                       ELC50PD
05349                                                                   ELC50PD
05350      IF  SUB6    LESS THAN   +40                                  ELC50PD
05351          ADD  +1      TO  SUB6                                    ELC50PD
05352          GO TO  3355-EDIT-FORM-LF-BENEFITS.                       ELC50PD
05353                                                                   ELC50PD
05354      MOVE  ER-1896         TO  WS-ERROR.                          ELC50PD
05355      PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
05356                                                                   ELC50PD
05357  3355-EXIT.                                                       ELC50PD
05358       EXIT.                                                       ELC50PD
05359                                                                   ELC50PD
05360 ******************************************************************ELC50PD
05361 *                  3356-EDIT-FORM-AH-BENEFITS                    *ELC50PD
05362 *   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *ELC50PD
05363 *   VALID FOR THE POLICY FORM USED.                              *ELC50PD
05364 ******************************************************************ELC50PD
05365                                                                   ELC50PD
05366  3356-EDIT-FORM-AH-BENEFITS.                                      ELC50PD
05367                                                                   ELC50PD
05368      IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND            ELC50PD
05369         PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)                   ELC50PD
05370          MOVE  'Y'                TO  FORM-MASTER-AH-SW           ELC50PD
05371          GO TO  3356-EXIT.                                        ELC50PD
05372                                                                   ELC50PD
05373       IF  SUB6    LESS THAN     +40                               ELC50PD
05374           ADD  +1      TO  SUB6                                   ELC50PD
05375           GO TO  3356-EDIT-FORM-AH-BENEFITS.                      ELC50PD
05376                                                                   ELC50PD
05377      MOVE  ER-1897         TO  WS-ERROR.                          ELC50PD
05378      PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
05379                                                                   ELC50PD
05380  3356-EXIT.                                                       ELC50PD
05381       EXIT.                                                       ELC50PD
05382                                                                   ELC50PD
05383 ******************************************************************ELC50PD
05384 *                  3357-BENEFIT-SEARCH                           *ELC50PD
05385 *   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *ELC50PD
05386 *   CANCELLATIONS ONLY.                                          *ELC50PD
05387 ******************************************************************ELC50PD
05388  3357-BENEFIT-SEARCH.                                             ELC50PD
05389      IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
05390          MOVE +1                          TO SUB6                 ELC50PD
05391          PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.         ELC50PD
05392                                                                   ELC50PD
05393      IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
05394          MOVE +1                          TO SUB6                 ELC50PD
05395          PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.         ELC50PD
05396                                                                   ELC50PD
05397  3357-EXIT.                                                       ELC50PD
05398      EXIT.                                                        ELC50PD
05399                                                                   ELC50PD
05400 ******************************************************************ELC50PD
05401 *                  3358-BENEFIT-LIFE-SEARCH                      *ELC50PD
05402 *   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *ELC50PD
05403 *   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
05404 *   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
05405 ******************************************************************ELC50PD
05406  3358-BENEFIT-LIFE-SEARCH.                                        ELC50PD
05407      IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)      ELC50PD
05408        IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)         ELC50PD
05409          IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
05410            OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
05411               IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
05412                      IS GREATER THAN SPACES                       ELC50PD
05413                  MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
05414                                           WS-LF-REFUND-CALC       ELC50PD
05415                  GO TO 3358-EXIT.                                 ELC50PD
05416                                                                   ELC50PD
05417      IF SUB6 LESS THAN +40                                        ELC50PD
05418          ADD +1                 TO SUB6                           ELC50PD
05419          GO TO 3358-BENEFIT-LIFE-SEARCH.                          ELC50PD
05420                                                                   ELC50PD
05421  3358-EXIT.                                                       ELC50PD
05422      EXIT.                                                        ELC50PD
05423 ******************************************************************ELC50PD
05424 *                  3359-BENEFIT-AH-SEARCH                        *ELC50PD
05425 *   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *ELC50PD
05426 *   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
05427 *   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
05428 ******************************************************************ELC50PD
05429  3359-BENEFIT-AH-SEARCH.                                          ELC50PD
05430      IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)       ELC50PD
05431        IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)        ELC50PD
05432          IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
05433            OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
05434               IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
05435                       IS GREATER THAN SPACES                      ELC50PD
05436                  MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
05437                                           WS-AH-REFUND-CALC       ELC50PD
05438                  GO TO 3359-EXIT.                                 ELC50PD
05439                                                                   ELC50PD
05440      IF SUB6 LESS THAN +40                                        ELC50PD
05441          ADD +1                 TO SUB6                           ELC50PD
05442          GO TO 3359-BENEFIT-AH-SEARCH.                            ELC50PD
05443                                                                   ELC50PD
05444  3359-EXIT.                                                       ELC50PD
05445      EXIT.                                                        ELC50PD
05446                                                                   ELC50PD
05447 ******************************************************************ELC50PD
05448 *                  3360-CHECK-FORM-LIMITS                        *ELC50PD
05449 *   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
05450 *   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
05451 ******************************************************************ELC50PD
05452                                                                   ELC50PD
05453  3360-CHECK-FORM-LIMITS.                                          ELC50PD
05454                                                                   ELC50PD
05455      IF FO-IND-GRP-CD = 'I'  OR  'G'                              ELC50PD
05456          MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.             ELC50PD
05457                                                                   ELC50PD
05458      IF NOT LF-FORM-MASTER-FOUND                                  ELC50PD
05459          GO TO 3360-CHECK-FORM-AH-LIMITS.                         ELC50PD
05460                                                                   ELC50PD
05461  3360-CHECK-FORM-LF-MIN-ISS-AGE.                                  ELC50PD
05462                                                                   ELC50PD
05463      IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR              ELC50PD
05464        (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND       ELC50PD
05465         WS-LF-JOINT-INDICATOR = 'J'  AND                          ELC50PD
05466         (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
05467          IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
05468             MOVE  ER-1911          TO  WS-ERROR                   ELC50PD
05469             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
05470          ELSE                                                     ELC50PD
05471             MOVE  ER-1892          TO  WS-ERROR                   ELC50PD
05472             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
05473                                                                   ELC50PD
05474  3360-CHECK-FORM-LF-ATT-AGE.                                      ELC50PD
05475                                                                   ELC50PD
05476      COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
05477                                                                   ELC50PD
05478      IF  FO-MAX-ATT-AGE     NUMERIC  AND                          ELC50PD
05479          FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
05480          IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE          ELC50PD
05481             IF PB-COMPANY-ID = 'NCL'                              ELC50PD
05482                 MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
05483                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
05484             ELSE                                                  ELC50PD
05485                 MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
05486                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
05487                                                                   ELC50PD
05488  3360-CHECK-FORM-LF-MAX-ISS-AGE.                                  ELC50PD
05489                                                                   ELC50PD
05490      IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND                      ELC50PD
05491          FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS               ELC50PD
05492          IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE       ELC50PD
05493             IF PB-COMPANY-ID = 'NCL'                              ELC50PD
05494                 MOVE  ER-1914      TO  WS-ERROR                   ELC50PD
05495                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT      ELC50PD
05496             ELSE                                                  ELC50PD
05497                 MOVE  ER-1899      TO  WS-ERROR                   ELC50PD
05498                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.     ELC50PD
05499                                                                   ELC50PD
05500  3360-CHECK-FORM-LF-TERM-BAMT.                                    ELC50PD
05501                                                                   ELC50PD
05502      IF  FO-LF-MAX-TERM   NUMERIC   AND                           ELC50PD
05503          FO-LF-MAX-TERM   GREATER THAN   ZEROS                    ELC50PD
05504          IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM          ELC50PD
05505            IF  PB-COMPANY-ID = 'NCL'                              ELC50PD
05506                MOVE  ER-1916       TO  WS-ERROR                   ELC50PD
05507                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
05508            ELSE                                                   ELC50PD
05509                MOVE  ER-1902       TO  WS-ERROR                   ELC50PD
05510                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
05511                                                                   ELC50PD
05512      COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +        ELC50PD
05513                                     PB-I-LF-ALT-BENEFIT-AMT.      ELC50PD
05514                                                                   ELC50PD
05515      IF  FO-MAX-LF-AMT   NUMERIC   AND                            ELC50PD
05516          FO-MAX-LF-AMT   GREATER THAN   ZEROS                     ELC50PD
05517          IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT      ELC50PD
05518              IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
05519                  MOVE  ER-1918     TO  WS-ERROR                   ELC50PD
05520                  PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
05521              ELSE                                                 ELC50PD
05522                  MOVE  ER-1904     TO  WS-ERROR                   ELC50PD
05523                  PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
05524                                                                   ELC50PD
05525 ******************************************************************ELC50PD
05526 *                  3360-CHECK-FORM-AH-LIMITS                     *ELC50PD
05527 *   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
05528 *   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
05529 ******************************************************************ELC50PD
05530                                                                   ELC50PD
05531  3360-CHECK-FORM-AH-LIMITS.                                       ELC50PD
05532                                                                   ELC50PD
05533      IF NOT AH-FORM-MASTER-FOUND                                  ELC50PD
05534          GO TO 3999-END-EDIT.                                     ELC50PD
05535                                                                   ELC50PD
05536  3360-CHECK-FORM-AH-MIN-ISS-AGE.                                  ELC50PD
05537                                                                   ELC50PD
05538      IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR              ELC50PD
05539        (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND       ELC50PD
05540         WS-AH-JOINT-INDICATOR = 'J'  AND                          ELC50PD
05541         (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
05542          IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
05543             MOVE  ER-1912          TO  WS-ERROR                   ELC50PD
05544             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
05545          ELSE                                                     ELC50PD
05546             MOVE  ER-1893          TO  WS-ERROR                   ELC50PD
05547             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
05548                                                                   ELC50PD
05549  3360-CHECK-FORM-AH-ATT-AGE.                                      ELC50PD
05550                                                                   ELC50PD
05551      COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
05552                                                                   ELC50PD
05553      IF  FO-MAX-ATT-AGE     NUMERIC     AND                       ELC50PD
05554          FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
05555          IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE            ELC50PD
05556             IF PB-COMPANY-ID = 'NCL'                              ELC50PD
05557                 MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
05558                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
05559             ELSE                                                  ELC50PD
05560                 MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
05561                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
05562                                                                   ELC50PD
05563  3360-CHECK-FORM-AH-MAX-ISS-AGE.                                  ELC50PD
05564                                                                   ELC50PD
05565      IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND                     ELC50PD
05566          FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0                  ELC50PD
05567          IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE    ELC50PD
05568             IF PB-COMPANY-ID = 'NCL'                              ELC50PD
05569                 MOVE  ER-1915      TO  WS-ERROR                   ELC50PD
05570                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
05571             ELSE                                                  ELC50PD
05572                 MOVE  ER-1900      TO  WS-ERROR                   ELC50PD
05573                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
05574                                                                   ELC50PD
05575  3360-CHECK-FORM-AH-TERM-BAMT.                                    ELC50PD
05576                                                                   ELC50PD
05577      IF  FO-AH-MAX-TERM    NUMERIC   AND                          ELC50PD
05578          FO-AH-MAX-TERM    GREATER THAN  +0                       ELC50PD
05579          IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM      ELC50PD
05580              IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
05581                  MOVE  ER-1917     TO  WS-ERROR                   ELC50PD
05582                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT     ELC50PD
05583              ELSE                                                 ELC50PD
05584                   MOVE  ER-1903    TO  WS-ERROR                   ELC50PD
05585                   PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.   ELC50PD
05586                                                                   ELC50PD
05587      IF  FO-MAX-AH-AMT    NUMERIC   AND                           ELC50PD
05588          FO-MAX-AH-AMT    GREATER THAN  +0                        ELC50PD
05589          IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT   ELC50PD
05590              IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
05591                  MOVE  ER-1919     TO  WS-ERROR                   ELC50PD
05592                  PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
05593              ELSE                                                 ELC50PD
05594                  MOVE  ER-1905     TO  WS-ERROR                   ELC50PD
05595                  PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
05596                                                                   ELC50PD
05597      GO TO 3999-END-EDIT.                                         ELC50PD
05598                                                                   ELC50PD
05599 ******************************************************************ELC50PD
05600      EJECT                                                        ELC50PD
05601 ******************************************************************ELC50PD
05602 *                  E D I T   C A N C E L                         *ELC50PD
05603 ******************************************************************ELC50PD
05604                                                                   ELC50PD
05605  3700-EDIT-CANCEL.                                                ELC50PD
05606      IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
05607          MOVE ZEROS                   TO WS-RES-STATE-TAX         ELC50PD
05608                                          WS-RES-MUNI-TAX          ELC50PD
05609                                          PB-CI-STATE-TAX          ELC50PD
05610                                          PB-CI-MUNI-TAX           ELC50PD
05611          PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.     ELC50PD
05612                                                                   ELC50PD
05613 *    IF PB-COMPANY-ID  EQUAL  'NCL'                               ELC50PD
05614 *       IF PB-ENTRY-BATCH  NUMERIC                                ELC50PD
05615 *          IF PB-CANCELLATION                                     ELC50PD
05616 *             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO      ELC50PD
05617 *          ELSE                                                   ELC50PD
05618 *             IF PB-ISSUE                                         ELC50PD
05619 *                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.     ELC50PD
05620                                                                   ELC50PD
072308     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
072308        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
072308     END-IF

05621 *    IF PB-C-MICROFILM-NO  NOT NUMERIC                            ELC50PD
05622 *        MOVE ZEROS              TO  PB-C-MICROFILM-NO.           ELC50PD
05623                                                                   ELC50PD
05624      IF CM-ENTRY-STATUS = 'V'                                     ELC50PD
05625         MOVE ER-2780             TO WS-ERROR                      ELC50PD
05626         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
05627         GO TO 3999-END-EDIT.                                      ELC50PD
05628                                                                   ELC50PD
05629      IF CM-ENTRY-STATUS = 'D'                                     ELC50PD
05630         MOVE ER-2781             TO WS-ERROR                      ELC50PD
05631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
05632         GO TO 3999-END-EDIT.                                      ELC50PD
05633                                                                   ELC50PD
05634      IF CM-ENTRY-STATUS = 'U'                                     ELC50PD
05635         MOVE ER-2782             TO WS-ERROR                      ELC50PD
05636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
05637                                                                   ELC50PD
05638 ***************************************************************   ELC50PD
05639 *                                                             *   ELC50PD
05640 *   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *   ELC50PD
05641 *   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *   ELC50PD
05642 *   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *   ELC50PD
05643 *   OF ANOTHER COVERAGE.                                      *   ELC50PD
05644 *                                                             *   ELC50PD
05645 ***************************************************************   ELC50PD
05646                                                                   ELC50PD
05647      MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
05648                                     PB-C-AH-CANCEL-VOID-SW.       ELC50PD
05649                                                                   ELC50PD
05650      IF PB-C-LF-CANCEL-AMT = ZERO                                 ELC50PD
05651         NEXT SENTENCE                                             ELC50PD
05652      ELSE                                                         ELC50PD
05653         IF (PB-C-LF-CANCEL-AMT NEGATIVE)                          ELC50PD
05654            AND                                                    ELC50PD
05655            ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)    ELC50PD
05656                MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
05657                MOVE ER-2745           TO WS-ERROR                 ELC50PD
05658                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
05659                                                                   ELC50PD
05660      IF PB-C-AH-CANCEL-AMT = ZERO                                 ELC50PD
05661         NEXT SENTENCE                                             ELC50PD
05662      ELSE                                                         ELC50PD
05663         IF (PB-C-AH-CANCEL-AMT NEGATIVE)                          ELC50PD
05664            AND                                                    ELC50PD
05665            (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)      ELC50PD
05666                MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW        ELC50PD
05667                MOVE ER-2745           TO WS-ERROR                 ELC50PD
05668                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
05669                                                                   ELC50PD
05670      IF WS-LF-EARNINGS-CALC = '4'                                 ELC50PD
05671         MOVE '4'                   TO WS-LF-REFUND-CALC.          ELC50PD
05672                                                                   ELC50PD
05673      MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.          ELC50PD
05674      MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.     ELC50PD
05675      MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.     ELC50PD
05676      MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.     ELC50PD
05677      MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.          ELC50PD
05678      MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.          ELC50PD
05679                                                                   ELC50PD
05680      MOVE ZERO                     TO PB-C-LF-REF-CALC            ELC50PD
05681                                       PB-C-AH-REF-CALC.           ELC50PD
05682      MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.                 ELC50PD
05683                                                                   ELC50PD
05684 ******************************************************************ELC50PD
05685 *        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *ELC50PD
05686 *             TO VALIDATE COVERAGE.                              *ELC50PD
05687 ******************************************************************ELC50PD
05688                                                                   ELC50PD
05689      IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND                        ELC50PD
05690         PB-C-LF-CANCEL-AMT = ZEROS                                ELC50PD
05691           MOVE 'N'                 TO WS-LF-CANCEL-SW             ELC50PD
05692       ELSE                                                        ELC50PD
05693           MOVE 'Y'                 TO WS-LF-CANCEL-SW.            ELC50PD
05694                                                                   ELC50PD
05695      IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND                        ELC50PD
05696         PB-C-AH-CANCEL-AMT = ZEROS                                ELC50PD
05697           MOVE 'N'                 TO WS-AH-CANCEL-SW             ELC50PD
05698       ELSE                                                        ELC50PD
05699           MOVE 'Y'                 TO WS-AH-CANCEL-SW.            ELC50PD
05700                                                                   ELC50PD
05701      EVALUATE TRUE                                                ELC50PD
05702          WHEN PB-CANCEL-FORCE             OR                      ELC50PD
05703               PB-CANCEL-DATE-FORCED       OR                      ELC50PD
05704               PB-FORCE-OFF                                        ELC50PD
05705                   IF PB-COMPANY-ID = 'ACE'                        ELC50PD
05706                      MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE     ELC50PD
05707                   END-IF                                          ELC50PD
05708          WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR                   ELC50PD
05709                PB-ALL-CANCEL-FORCED-NO-FEE)  AND                  ELC50PD
05710               (PB-COMPANY-ID = 'ACE' )                            ELC50PD
05711                   MOVE ZEROES TO PB-CI-CANCEL-FEE                 ELC50PD
05712          WHEN OTHER                                               ELC50PD
05713               IF PB-COMPANY-ID = 'ACE'                            ELC50PD
05714                  MOVE ER-2794              TO WS-ERROR            ELC50PD
05715               ELSE                                                ELC50PD
05716                  MOVE ER-2749              TO WS-ERROR            ELC50PD
05717               END-IF                                              ELC50PD
05718               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
05719      END-EVALUATE.                                                ELC50PD
05720                                                                   ELC50PD
05721                                                                   ELC50PD
05722 *    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
05723 *        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS              ELC50PD
05724 *            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
05725 *            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT          ELC50PD
05726 *        ELSE                                                     ELC50PD
05727 *            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.    ELC50PD
05728                                                                   ELC50PD
PEMMOD     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
PEMMOD     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
PEMMOD        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
PEMMOD     ELSE
PEMMOD        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
PEMMOD     END-IF
PEMMOD     .
05729  3705-EDIT-CANCEL-DT.                                             ELC50PD
05730                                                                   ELC50PD
05731      IF LF-COVERAGE-CANCELLED                                     ELC50PD
05732         AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
05733          MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
05734          MOVE WS-CURRENT-MONTH-END                                ELC50PD
05735                                  TO DC-BIN-DATE-2                 ELC50PD
05736          SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
05737 *        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
05738          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
05739          IF DATE-CONVERSION-ERROR                                 ELC50PD
05740             NEXT SENTENCE                                         ELC50PD
05741           ELSE                                                    ELC50PD
05742              IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
05743                 IF PB-CANCEL-DATE-FORCED  OR                      ELC50PD
05744                    PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
05745                       MOVE ER-2751  TO WS-ERROR                   ELC50PD
05746                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
05747                  ELSE                                             ELC50PD
05748                    MOVE ER-2752  TO WS-ERROR                      ELC50PD
05749                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
05750                                                                   ELC50PD
05751      IF AH-COVERAGE-CANCELLED                                     ELC50PD
05752         AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
05753          MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
05754          MOVE WS-CURRENT-MONTH-END                                ELC50PD
05755                                  TO DC-BIN-DATE-2                 ELC50PD
05756          SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
05757 *        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
05758          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
05759          IF DATE-CONVERSION-ERROR                                 ELC50PD
05760             NEXT SENTENCE                                         ELC50PD
05761           ELSE                                                    ELC50PD
05762              IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
05763                 IF PB-CANCEL-DATE-FORCED OR                       ELC50PD
05764                    PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
05765                       MOVE ER-2751  TO WS-ERROR                   ELC50PD
05766                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
05767                  ELSE                                             ELC50PD
05768                    MOVE ER-2752  TO WS-ERROR                      ELC50PD
05769                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
05770                                                                   ELC50PD
05771      IF WS-ERROR = ER-2752                                        ELC50PD
05772         AND (PB-COMPANY-ID = 'ABL'                                ELC50PD
05773          OR  PB-COMPANY-ID = 'FGL'                                ELC50PD
05774          OR  PB-COMPANY-ID = 'IST'                                ELC50PD
05775          OR  PB-COMPANY-ID = 'JHL'                                ELC50PD
05776          OR  PB-COMPANY-ID = 'LAP'                                ELC50PD
05777          OR  PB-COMPANY-ID = 'LBL'                                ELC50PD
05778          OR  PB-COMPANY-ID = 'NCB'                                ELC50PD
05779          OR  PB-COMPANY-ID = 'NLI'                                ELC50PD
05780          OR  PB-COMPANY-ID = 'OFI'                                ELC50PD
05781          OR  PB-COMPANY-ID = 'PLI'                                ELC50PD
05782          OR  PB-COMPANY-ID = 'TAO'                                ELC50PD
05783          OR  PB-COMPANY-ID = 'TIC'                                ELC50PD
05784          OR  PB-COMPANY-ID = 'HER'                                ELC50PD
05785          OR  WS-LF-SPECIAL-CALC-CD = 'Z'                          ELC50PD
05786          OR  WS-AH-SPECIAL-CALC-CD = 'Z')                         ELC50PD
05787             SUBTRACT +1          FROM PB-NO-OF-ERRORS             ELC50PD
05788             MOVE ER-2762     TO WS-ERROR                          ELC50PD
05789             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
05790                                                                   ELC50PD
05791      IF LF-COVERAGE-CANCELLED                                     ELC50PD
05792         AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
05793         IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
05794              MOVE ER-2733         TO WS-ERROR                     ELC50PD
05795              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
05796                                                                   ELC50PD
05797      IF AH-COVERAGE-CANCELLED                                     ELC50PD
05798         AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
05799         IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
05800               MOVE ER-2733        TO WS-ERROR                     ELC50PD
05801               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
05802                                                                   ELC50PD
05803      IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND                ELC50PD
05804         (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)                     ELC50PD
05805         IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND            ELC50PD
05806            (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)                 ELC50PD
05807             IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT         ELC50PD
05808               IF PB-COMPANY-ID NOT = 'LAP'                        ELC50PD
05809                MOVE ER-2704            TO WS-ERROR                ELC50PD
05810                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.        ELC50PD
05811                                                                   ELC50PD
05812      IF CERT-WAS-NOT-FOUND                                        ELC50PD
05813          GO TO 3999-END-EDIT.                                     ELC50PD
05814                                                                   ELC50PD
05815      IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
05816         IF LF-COVERAGE-CANCELLED                                  ELC50PD
05817            AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                   ELC50PD
05818             MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
05819             MOVE PB-C-LF-CANCEL-DT                                ELC50PD
05820                                  TO DC-BIN-DATE-2                 ELC50PD
05821             SET ELAPSED-BETWEEN-BIN TO TRUE                       ELC50PD
05822 *           MOVE 1               TO DC-OPTION-CODE                ELC50PD
05823             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
05824             IF DATE-CONVERSION-ERROR                              ELC50PD
05825                NEXT SENTENCE                                      ELC50PD
05826              ELSE                                                 ELC50PD
05827                 IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
05828                    MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.      ELC50PD
05829                                                                   ELC50PD
05830      IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
05831         IF AH-COVERAGE-CANCELLED                                  ELC50PD
05832            AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                   ELC50PD
05833             MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
05834             MOVE PB-C-AH-CANCEL-DT                                ELC50PD
05835                                  TO DC-BIN-DATE-2                 ELC50PD
05836             MOVE +0              TO DC-ELAPSED-DAYS               ELC50PD
05837                                     DC-ELAPSED-MONTHS             ELC50PD
05838             SET ELAPSED-BETWEEN-BIN  TO TRUE                      ELC50PD
05839 *           MOVE 1               TO DC-OPTION-CODE                ELC50PD
05840             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
05841             IF DATE-CONVERSION-ERROR                              ELC50PD
05842                NEXT SENTENCE                                      ELC50PD
05843              ELSE                                                 ELC50PD
05844                 IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
05845                    MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.      ELC50PD
05846                                                                   ELC50PD
05847      MOVE +0                     TO DC-ELAPSED-DAYS               ELC50PD
05848                                     DC-ELAPSED-MONTHS.            ELC50PD
05849                                                                   ELC50PD
05850      IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR                         ELC50PD
05851         (WS-AH-SPECIAL-CALC-CD = 'Z')                             ELC50PD
05852           MOVE 'Z'                TO PB-CI-OB-FLAG                ELC50PD
05853           MOVE ER-2767            TO WS-ERROR                     ELC50PD
05854           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
05855           MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC             ELC50PD
05856           MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC             ELC50PD
05857           GO TO 3775-OVER-REF-CHK                                 ELC50PD
05858         ELSE                                                      ELC50PD
05859           MOVE ZEROS              TO PB-CI-LIVES                  ELC50PD
05860                                      PB-C-LIVES                   ELC50PD
05861           IF PB-CI-OB-FLAG NOT = 'B'                              ELC50PD
05862              MOVE SPACE           TO PB-CI-OB-FLAG.               ELC50PD
05863                                                                   ELC50PD
05864      IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
05865          MOVE ZEROS              TO PB-CI-EXTENTION-DAYS          ELC50PD
05866      ELSE                                                         ELC50PD
05867          MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.           ELC50PD
05868                                                                   ELC50PD
05869      IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)         ELC50PD
05870         AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')     ELC50PD
05871             MOVE ER-2760         TO WS-ERROR                      ELC50PD
05872             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
05873                                                                   ELC50PD
05874      IF LF-COVERAGE-CANCELLED                                     ELC50PD
05875         AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
05876          IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
05877             AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
05878                MOVE ER-2774       TO WS-ERROR                     ELC50PD
05879                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
05880                                                                   ELC50PD
05881      IF AH-COVERAGE-CANCELLED                                     ELC50PD
05882         AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
05883          IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
05884             AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
05885                MOVE ER-2775       TO WS-ERROR                     ELC50PD
05886                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
05887                                                                   ELC50PD
05888      IF LF-COVERAGE-CANCELLED                                     ELC50PD
05889         AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
05890          IF PB-C-LF-CANCEL-DT = LOW-VALUES                        ELC50PD
05891             MOVE ER-2776         TO WS-ERROR                      ELC50PD
05892             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
05893                                                                   ELC50PD
05894      IF AH-COVERAGE-CANCELLED                                     ELC50PD
05895         AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
05896          IF PB-C-AH-CANCEL-DT = LOW-VALUES                        ELC50PD
05897             MOVE ER-2777         TO WS-ERROR                      ELC50PD
05898             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
05899                                                                   ELC50PD
05900      IF LF-COVERAGE-CANCELLED                                     ELC50PD
05901         AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
05902          MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
05903          MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
05904          MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
05905 *        MOVE 6                    TO DC-OPTION-CODE              ELC50PD
05906          SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
05907          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
05908          IF DATE-CONVERSION-ERROR                                 ELC50PD
05909             NEXT SENTENCE                                         ELC50PD
05910           ELSE                                                    ELC50PD
05911             IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
05912               IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
05913                              OR  'FIA'                            ELC50PD
05914                  MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT       ELC50PD
05915                ELSE                                               ELC50PD
05916                 MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW      ELC50PD
05917                 MOVE ER-2731       TO WS-ERROR                    ELC50PD
05918                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
05919                                                                   ELC50PD
05920  3705-EDIT-AH-CANCEL-DT.                                          ELC50PD
05921                                                                   ELC50PD
05922      IF AH-COVERAGE-CANCELLED                                     ELC50PD
05923         AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
05924          MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
05925          MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
05926          MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
05927 *        MOVE 6                    TO DC-OPTION-CODE              ELC50PD
05928          SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
05929          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
05930          IF DATE-CONVERSION-ERROR                                 ELC50PD
05931             NEXT SENTENCE                                         ELC50PD
05932           ELSE                                                    ELC50PD
05933             IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
05934               IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
05935                               OR 'FIA'                            ELC50PD
05936                 MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT        ELC50PD
05937               ELSE                                                ELC50PD
05938                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW       ELC50PD
05939                MOVE ER-2771       TO WS-ERROR                     ELC50PD
05940                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
05941                                                                   ELC50PD
05942  3705-EDIT-CONTINUED.                                             ELC50PD
05943                                                                   ELC50PD
041811*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
041811*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
041811*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT  ELC50PD
041811*            MOVE ER-2727         TO WS-ERROR                     ELC50PD
041811*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
041811*                                                                 ELC50PD
041811*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
041811*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
041811*        IF PB-COMPANY-ID = 'ACE'                                 ELC50PD
041811*           MOVE ER-2727        TO WS-ERROR                       ELC50PD
041811*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
041811*        ELSE                                                     ELC50PD
041811*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DTELC50PD
041811*              MOVE ER-2727     TO WS-ERROR                       ELC50PD
041811*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
05959                                                                   ELC50PD
05960      IF PB-COMPANY-ID = 'ACE'                                     ELC50PD
05961        IF AH-COVERAGE-CANCELLED                                   ELC50PD
05962          IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                 ELC50PD
05963            IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT   ELC50PD
05964               MOVE ER-2732      TO WS-ERROR                       ELC50PD
05965               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
05966                                                                   ELC50PD
05967      IF PB-COMPANY-ID      EQUAL   'HER'                          ELC50PD
05968         IF WS-ERROR        EQUAL   ER-2727                        ELC50PD
05969             SUBTRACT  +1           FROM  PB-NO-OF-ERRORS          ELC50PD
05970             MOVE  ER-2725          TO  WS-ERROR                   ELC50PD
05971             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
05972                                                                   ELC50PD
05973      IF PB-C-CLAIM-CREATED-CANCEL                                 ELC50PD
05974             MOVE ER-2748         TO WS-ERROR                      ELC50PD
05975             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
05976                                                                   ELC50PD
05977      IF PB-C-LAST-NAME NOT = SPACES                               ELC50PD
05978          IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME                  ELC50PD
05979             MOVE ER-2747         TO WS-ERROR                      ELC50PD
05980             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
05981                                                                   ELC50PD
05982  3710-EDIT-LUMP-SUM-PRIOR.                                        ELC50PD
05983                                                                   ELC50PD
05984      IF AH-COVERAGE-CANCELLED                                     ELC50PD
05985          IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
05986              IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT    ELC50PD
05987                 MOVE ER-2735    TO WS-ERROR                       ELC50PD
05988                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
05989                                                                   ELC50PD
05990      IF LF-COVERAGE-CANCELLED                                     ELC50PD
05991          IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
05992              IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT    ELC50PD
05993                 MOVE ER-2735    TO WS-ERROR                       ELC50PD
05994                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
05995                                                                   ELC50PD
05996  3710-EDIT-PRIOR-DEATH.                                           ELC50PD
05997                                                                   ELC50PD
040811*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
040811*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
040811*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
040811*           (NOT PB-CI-OB)                                        ELC50PD
040811*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT           ELC50PD
040811*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT    ELC50PD
040811*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
040811*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
040811*                                                                 ELC50PD
040811*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
040811*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
040811*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
040811*           (NOT PB-CI-OB)                                        ELC50PD
040811*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT           ELC50PD
040811*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT    ELC50PD
040811*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
040811*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
06015                                                                   ELC50PD
06016      IF PB-CI-DEATH-DT NOT = LOW-VALUES                           ELC50PD
06017          IF (PB-C-LF-CANCEL-AMT = ZERO) AND                       ELC50PD
06018             (NOT PB-COMP-LF-CANCEL)                               ELC50PD
06019              NEXT SENTENCE                                        ELC50PD
06020          ELSE                                                     ELC50PD
06021            IF PB-C-LF-CANCEL-VOIDED                               ELC50PD
06022               NEXT SENTENCE                                       ELC50PD
06023            ELSE                                                   ELC50PD
06024               MOVE ER-2753      TO WS-ERROR                       ELC50PD
06025               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
06026                                                                   ELC50PD
06027      IF CANCEL-FUTURE-DT                                          ELC50PD
06028          GO TO 3999-END-EDIT.                                     ELC50PD
06029                                                                   ELC50PD
06030  3715-GET-REMAIN-TERM-LF.                                         ELC50PD
06031                                                                   ELC50PD
06032      IF NO-LF-BENEFIT-MATCH  OR                                   ELC50PD
06033         WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
06034         GO TO 3730-GET-AH-REMAIN-TERM.                            ELC50PD
06035                                                                   ELC50PD
06036      MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
06037      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
06038      MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
06039      MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
06040      MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
06041      MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
06042      MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
06043      MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
06044      MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
06045      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
06046      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
06047      MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD

083005     IF (PB-COMPANY-ID = 'CID')
083005        AND (CP-STATE-STD-ABBRV = 'WI')
083005        MOVE '7'                 TO CP-REM-TERM-METHOD
083005        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
083005     ELSE
06048         MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
06049         MOVE WS-REM-TRM-CALC-OPTION
083005                                 TO CP-REM-TRM-CALC-OPTION
083005     END-IF

      **  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
           IF (PB-COMPANY-ID = 'CID')
              AND (CP-STATE-STD-ABBRV = 'MO')
              AND (PB-CERT-EFF-DT >= X'9B41')
              AND (PB-CERT-EFF-DT <= X'A2FB')
              MOVE '7'                 TO CP-REM-TERM-METHOD
              MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
           END-IF

06050      MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM              ELC50PD
06051                                     CP-LOAN-TERM.                 ELC50PD
06052      IF CP-TRUNCATED-LIFE                                         ELC50PD
06053         MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.                 ELC50PD
06054                                                                   ELC50PD
06055      IF CP-TERM-IS-DAYS                                           ELC50PD
06056          MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS        ELC50PD
06057      ELSE                                                         ELC50PD
06058          MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
06059                                                                   ELC50PD
06060      MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.                ELC50PD
06061                                                                   ELC50PD
06062      PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
06063                                                                   ELC50PD
06064      IF LF-COVERAGE-CANCELLED                                     ELC50PD
06065         AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
06066         NEXT SENTENCE                                             ELC50PD
06067       ELSE                                                        ELC50PD
06068           GO TO 3730-GET-AH-REMAIN-TERM.                          ELC50PD
06069                                                                   ELC50PD
06070  3720-GET-LF-REFUND.                                              ELC50PD
06071                                                                   ELC50PD
06072      IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
06073         PB-C-AH-CANCEL-VOIDED                                     ELC50PD
06074         GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
06075                                                                   ELC50PD
06076      IF PB-COMPANY-ID EQUAL 'BOA'                                 ELC50PD
06077          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
06078          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
06079          GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
06080                                                                   ELC50PD
06081      IF (WS-LF-SPECIAL-CALC-CD = 'M') OR                          ELC50PD
06082         (WS-AH-SPECIAL-CALC-CD = 'M')                             ELC50PD
06083          MOVE ER-2767            TO WS-ERROR                      ELC50PD
06084          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
06085          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
06086          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
06087          GO TO 3780-UPDATE-CANCEL-CERT.                           ELC50PD
06088                                                                   ELC50PD
           MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
06090                                                                      CL**2
06091      MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
06092      MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.          ELC50PD
06093      MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
06094      MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
040610     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
083111     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN

071211     IF (PB-COMPANY-ID = 'DCC')
071211        AND (AM-DCC-PRODUCT-CODE = 'DDF')

              IF PDEF-MASTER-FOUND
                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
                    (V1 > +8)
                    OR (PD-PROD-CODE (V1) = 'L')
                 END-PERFORM
                 IF V1 < +9
                    MOVE PD-MAX-AMT (V1)
                                 TO CP-R-MAX-TOT-BEN
                                    EC-AM-LF-MAX-TOT-BEN
                 END-IF
              ELSE

071211        MOVE ' '                 TO PDEF-MASTER-SW
071211        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
071211        MOVE PB-STATE            TO ERPDEF-STATE
071211        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
071211        MOVE 'A'                 TO ERPDEF-BEN-TYPE
071211        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
071211        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
071211        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
071211        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
071211        IF PDEF-MASTER-FOUND
071211           MOVE 'N'              TO PDEF-MASTER-SW
071211           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
071211           IF PDEF-MASTER-FOUND
071211              IF (ERPDEF-KEY-SAVE (1:16) =
071211                           PD-CONTROL-PRIMARY (1:16))
071211                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
071211                 CONTINUE
071211              ELSE
071211                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
071211                 IF (ERPDEF-KEY-SAVE (1:16) =
071211                           PD-CONTROL-PRIMARY (1:16))
071211                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
071211                    CONTINUE
071211                 ELSE
071211                    MOVE 'N'     TO PDEF-MASTER-SW
071211                 END-IF
071211              END-IF
071211              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
071211
071211              IF PDEF-MASTER-FOUND
071211                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
071211                    (V1 > +8)
071211                    OR (PD-PROD-CODE (V1) = 'L')
071211                 END-PERFORM
071211                 IF V1 < +9
071211                    MOVE PD-MAX-AMT (V1)
071211                                 TO CP-R-MAX-TOT-BEN
071211                                    EC-AM-LF-MAX-TOT-BEN
071211                 END-IF
071211              END-IF
071211           END-IF
071211           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
071211        END-IF
              END-IF
071211     END-IF

06096      PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.               ELC50PD
06097                                                                   ELC50PD
06098      MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.         ELC50PD
06099                                                                   ELC50PD
06100      MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM                CL**2
06101                                     PB-C-LF-REM-TERM.                CL**2
06102                                                                      CL**2
06103      MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
06104      MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
06105                                                                   ELC50PD
06106      IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
06107         IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
06108            MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK       ELC50PD
06109            COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT   ELC50PD
06110                     + PB-CI-LF-ALT-PREMIUM-AMT)                   ELC50PD
06111                     - CM-LF-ITD-DEATH-AMT                         ELC50PD
06112            IF PB-C-LF-REF-CALC LESS THAN +0                       ELC50PD
06113               MOVE +0            TO PB-C-LF-REF-CALC              ELC50PD
06114               GO TO 3730-GET-AH-REMAIN-TERM                       ELC50PD
06115            ELSE                                                   ELC50PD
06116               GO TO 3730-GET-AH-REMAIN-TERM.                      ELC50PD
06117                                                                   ELC50PD
06118      IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
06119                             OR '4' OR '5' OR '6' OR '8'           ELC50PD
033104                            OR '9' OR 'G'
06121         MOVE PB-C-LF-REFUND-OVERRIDE                              ELC50PD
06122                                  TO CP-EARNING-METHOD.            ELC50PD
06123                                                                   ELC50PD
010713     if pb-company-id = 'AHL'
010713        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
010713        if cp-class-code = spaces
010713           move zeros            to cp-class-code
010713        end-if
010713     ELSE
010713        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
010713     END-IF

070713*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
06125      MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
06126      MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
06127                                     CP-RATING-BENEFIT-AMT.        ELC50PD
06128      IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
06129          COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
06130                                          PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
06131      MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
06132      MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
06133      MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
06134      MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.            ELC50PD
06135      MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.              ELC50PD
06136      MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
071211     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
           IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
               MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
                                                                        ELC50PD
CIDMOD****   N O T E   ****
CIDMOD*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
CIDMOD*      THE OH HARD CODING IN ELCRFNDP
CIDMOD
CIDMOD     IF PB-COMPANY-ID = 'CID'
CIDMOD        IF CP-STATE-STD-ABBRV = 'OH'
CIDMOD           MOVE WS-LF-EARNINGS-CALC
CIDMOD                                 TO CP-EARNING-METHOD
CIDMOD        END-IF
CIDMOD     END-IF
CIDMOD
CIDMOD****   N O T E   ****
CIDMOD
           IF CP-EARN-AS-NET-PAY                                        ELC50PD
               IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
                  IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
                      MOVE WS-DEFAULT-APR                               ELC50PD
                                       TO  CP-LOAN-APR                  ELC50PD
                      MOVE ER-3780     TO  WS-ERROR                     ELC50PD
                      PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
                  ELSE                                                  ELC50PD
                      MOVE ER-3781     TO  WS-ERROR                     ELC50PD
                      PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD

           MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC

06152      PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
06153                                                                   ELC50PD
06154      IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
06155          MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.           ELC50PD
06156                                                                   ELC50PD
06157      IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
06158         CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
06159         MOVE ER-2740             TO WS-ERROR                      ELC50PD
06160         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
06161                                                                   ELC50PD
06162      IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
06163         MOVE ER-2617             TO WS-ERROR                      ELC50PD
06164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
06165                                                                   ELC50PD
           IF PB-COMPANY-ID = 'DCC'
              AND PB-CI-ENTRY-STATUS = 'M'
              MOVE +0                  TO PB-C-LF-REF-CALC
           ELSE
06166         MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
           END-IF
06167                                                                   ELC50PD
06168      IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
06169          GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
06170                                                                   ELC50PD
06171 *    IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
06172 *       ADD +1                   TO PB-C-LF-REM-TERM              ELC50PD
06173 *                                   CP-REMAINING-TERM             ELC50PD
06174 *                                   CP-ORIGINAL-TERM.             ELC50PD
06175                                                                   ELC50PD
06176      MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
06177      MOVE '2'                    TO CP-EARNING-METHOD             ELC50PD
06178                                     CP-RATING-METHOD.             ELC50PD

           IF PB-COMPANY-ID = 'CID'
              IF (CP-STATE-STD-ABBRV = 'MN')
                 AND (PB-CERT-EFF-DT > X'A4FF')
                 AND (WS-LF-EARNINGS-CALC = 'B')
                 MOVE '5'              TO CP-EARNING-METHOD
                 MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
              END-IF
           END-IF

06179      MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT       ELC50PD
06180                                         CP-REMAINING-BENEFIT      ELC50PD
06181                                         CP-RATING-BENEFIT-AMT.    ELC50PD
06182      IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
06183          COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
06184                                          PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
06185      MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.      ELC50PD
06186      MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
06187                                                                   ELC50PD
06188      PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
06189                                                                   ELC50PD
06190      IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
06191         CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
06192         MOVE ER-2740             TO WS-ERROR                      ELC50PD
06193         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
06194                                                                   ELC50PD
06195      IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
06196         MOVE ER-2617             TO WS-ERROR                      ELC50PD
06197         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
06198                                                                   ELC50PD
06199      ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.             ELC50PD
06200                                                                   ELC50PD
06201 ******************************************************************ELC50PD
06202                                                                   ELC50PD
06203      EJECT                                                        ELC50PD
06204  3730-GET-AH-REMAIN-TERM.                                         ELC50PD
06205      IF NO-AH-BENEFIT-MATCH  OR                                   ELC50PD
06206         WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
06207          GO TO 3770-CHECK-REFUNDS.                                ELC50PD
06208                                                                   ELC50PD
06209      IF PB-CI-AH-LUMP-SUM-DISAB                                   ELC50PD
06210          IF  PB-C-AH-CANCEL-AMT = ZERO                            ELC50PD
06211             IF NOT PB-COMP-AH-CANCEL                              ELC50PD
06212              GO TO 3770-CHECK-REFUNDS.                            ELC50PD
06213                                                                   ELC50PD
06214      MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
06215      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
06216      MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
06217      MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
06218      MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
06219      MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
06220      MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
06221      MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
06222      MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
06223      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
06224      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
06225      MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD

083005     IF (PB-COMPANY-ID = 'CID')
083005        AND (CP-STATE-STD-ABBRV = 'WI')
083005        MOVE '7'                 TO CP-REM-TERM-METHOD
083005        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
083005     ELSE
06226         MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
06227         MOVE WS-REM-TRM-CALC-OPTION
083005                                 TO CP-REM-TRM-CALC-OPTION
083005     END-IF

           IF (PB-COMPANY-ID = 'CID')
              AND (CP-STATE-STD-ABBRV = 'MO')
              AND (PB-CERT-EFF-DT >= X'9B41')
              AND (PB-CERT-EFF-DT <= X'A2FB')
              MOVE '7'                 TO CP-REM-TERM-METHOD
              MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
           END-IF

06228      MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM              ELC50PD
06229                                     CP-LOAN-TERM.                 ELC50PD
06230      IF NOT CP-TERM-IS-DAYS                                       ELC50PD
06231          MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
06232                                                                   ELC50PD
06233      MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.                 ELC50PD
06234                                                                   ELC50PD
06235      PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
06236                                                                   ELC50PD
06237      IF AH-COVERAGE-CANCELLED                                     ELC50PD
06238         AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
06239         NEXT SENTENCE                                             ELC50PD
06240       ELSE                                                        ELC50PD
06241          GO TO 3770-CHECK-REFUNDS.                                ELC50PD
06242                                                                   ELC50PD
06243  3740-GET-AH-REFUND.                                              ELC50PD
06244                                                                   ELC50PD
06245      IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
06246         PB-C-AH-CANCEL-VOIDED                                     ELC50PD
06247         GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
06248                                                                   ELC50PD
06249      IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
06250          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
06251          GO TO 3770-CHECK-REFUNDS.                                ELC50PD
06252                                                                   ELC50PD
06253      MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1                 ELC50PD
06254 *    MOVE ' '                    TO DC-OPTION-CODE                ELC50PD
06255      SET BIN-TO-GREG             TO TRUE                          ELC50PD
06256      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
06257      MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM             ELC50PD
06258                                     PB-C-AH-REM-TERM.             ELC50PD
06259      MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
06260      MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
06261                                                                   ELC50PD
06262      IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
06263         IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
06264            MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK       ELC50PD
06265            COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT   ELC50PD
06266                     - CM-AH-ITD-AH-PMT)                           ELC50PD
06267            IF PB-C-AH-REF-CALC LESS THAN +0                       ELC50PD
06268               MOVE +0            TO PB-C-AH-REF-CALC              ELC50PD
06269               GO TO 3770-CHECK-REFUNDS                            ELC50PD
06270            ELSE                                                   ELC50PD
06271               GO TO 3770-CHECK-REFUNDS.                           ELC50PD
06272                                                                   ELC50PD
033104     IF PB-COMPANY-ID = 'DCC'
033104        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
071211            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
033104           MOVE 'S'              TO CP-EARNING-METHOD
033104        END-IF
033104     END-IF

06273      IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
06274                             OR '4' OR '5' OR '6' OR '8'           ELC50PD
033104                            OR '9' OR 'G' OR 'S'
06276         MOVE PB-C-AH-REFUND-OVERRIDE                              ELC50PD
06277                                  TO CP-EARNING-METHOD.            ELC50PD
06278                                                                   ELC50PD
010713     if pb-company-id = 'AHL'
010713        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
010713        if cp-class-code = spaces
010713           move zeros            to cp-class-code
010713        end-if
010713     ELSE
010713        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
010713     END-IF
010713*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
06280      MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
06281      MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
06282                                     CP-RATING-BENEFIT-AMT.        ELC50PD
06283      IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
06284          COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *   ELC50PD
06285                                          PB-CI-AH-TERM.           ELC50PD
06286      MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
06287      MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
06288      MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
06289      MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.            ELC50PD
06290      MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.              ELC50PD
06291      MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
06292                                                                   ELC50PD
06293      IF CP-STATE-STD-ABBRV = 'OH'                                 ELC50PD
CIDMOD        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'     ELC50PD
030612                                AND 'CID' AND 'DCC' AND 'AHL')
06295            IF (CP-ORIGINAL-TERM GREATER 60) AND                   ELC50PD
06296               (DC-GREG-DATE-CYMD GREATER 19831101) AND               CL**4
06297               (PB-CI-LF-BENEFIT-CD NOT = ZERO)                    ELC50PD
CIDMOD              MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
CIDMOD           END-IF
CIDMOD        END-IF
CIDMOD        IF PB-COMPANY-ID = 'CID'
CIDMOD           IF NO-LIFE-COVERAGE
CIDMOD              IF CP-CRITICAL-PERIOD
CIDMOD                 MOVE '2'       TO CP-EARNING-METHOD
CIDMOD              ELSE
CIDMOD                 MOVE '6'       TO CP-EARNING-METHOD
CIDMOD              END-IF
CIDMOD           ELSE
CIDMOD              IF WS-LF-COVERAGE-TYPE = 'L'
CIDMOD                 MOVE '2'       TO CP-EARNING-METHOD
CIDMOD              ELSE
CIDMOD                 IF (PB-CI-LF-TERM > +60) OR                      ELC50PD
CIDMOD                    (WS-LF-EARNINGS-CALC = '5')
CIDMOD                    IF CP-CRITICAL-PERIOD
CIDMOD                       MOVE '2'  TO CP-EARNING-METHOD
CIDMOD                    ELSE
CIDMOD                       MOVE '6'  TO CP-EARNING-METHOD
CIDMOD                    END-IF
CIDMOD                 ELSE
CIDMOD                    MOVE '1'     TO CP-EARNING-METHOD
CIDMOD                 END-IF
CIDMOD              END-IF
CIDMOD           END-IF
CIDMOD        END-IF
CIDMOD     END-IF
06299                                                                   ELC50PD
PEMMOD*    IF CP-STATE-STD-ABBRV = 'VA'                                 ELC50PD
PEMMOD*       IF DC-GREG-DATE-CYMD GREATER 19921231                        CL**4
PEMMOD*          IF CP-ORIGINAL-TERM GREATER 61                         ELC50PD
PEMMOD*             MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
PEMMOD*          ELSE                                                   ELC50PD
PEMMOD*             MOVE '1' TO CP-EARNING-METHOD.                      ELC50PD
06306                                                                   ELC50PD
           IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
               MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
                                                                        ELC50PD
           IF CP-EARN-AS-NET-PAY                                        ELC50PD
               IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
                  IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
                      MOVE WS-DEFAULT-APR                               ELC50PD
                                       TO  CP-LOAN-APR                  ELC50PD
                      MOVE ER-3780     TO  WS-ERROR                     ELC50PD
                      PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
                  ELSE                                                  ELC50PD
                      MOVE ER-3781     TO  WS-ERROR                     ELC50PD
                      PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD

071211     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON


071211     IF PB-COMPANY-ID = 'DCC'
071211        AND CP-CANCEL-REASON = 'R'
071211        MOVE 'G'                 TO CP-DDF-SPEC-CALC
071211        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
071211     END-IF

071211     IF PB-COMPANY-ID = 'DCC'
071211        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
071211        AND (CP-EARNING-METHOD = 'D')
071211        AND (CP-CANCEL-REASON NOT = 'R')
              CONTINUE
           ELSE
              GO TO 3750-CONTINUE
           END-IF

           MOVE ' '                    TO DD-IU-SW
           IF NOT PDEF-MASTER-FOUND
071211        MOVE ' '                 TO PDEF-MASTER-SW
071211        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
071211        MOVE PB-STATE            TO ERPDEF-STATE
071211        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
071211        MOVE 'A'                 TO ERPDEF-BEN-TYPE
071211        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
071211        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
071211        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
071211        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
071211        IF PDEF-MASTER-FOUND
071211           MOVE 'N'              TO PDEF-MASTER-SW
071211           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
071211           IF PDEF-MASTER-FOUND
071211              IF (ERPDEF-KEY-SAVE (1:16) =
071211                           PD-CONTROL-PRIMARY (1:16))
071211                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
071211                 CONTINUE
071211              ELSE
071211                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
071211                 IF (ERPDEF-KEY-SAVE (1:16) =
071211                           PD-CONTROL-PRIMARY (1:16))
071211                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
071211                    CONTINUE
071211                 ELSE
071211                    MOVE ER-2740 TO WS-ERROR
071211                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
071211                    GO TO 3770-CHECK-REFUNDS
071211                 END-IF
071211              END-IF
                 END-IF
071211           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
              END-IF
071211     END-IF

           IF PDEF-MASTER-FOUND
071211        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
071211           (V1 > +8)
071211           OR (PD-PROD-CODE (V1) = 'I')
071211        END-PERFORM
071211        IF V1 < +9
071211           SET DD-IU-PRESENT        TO TRUE
071211        END-IF
              IF WS-AH-DCC-TRUNC = 'T'
                 MOVE PB-CI-LOAN-TERM     TO WS-TERM
              ELSE
                 MOVE CP-ORIGINAL-TERM    TO WS-TERM
              END-IF
071211        EVALUATE TRUE
071211           WHEN WS-TERM > +168
071211              MOVE 15               TO V1
071211           WHEN WS-TERM > +156
071211              MOVE 14               TO V1
071211           WHEN WS-TERM > +144
071211              MOVE 13               TO V1
071211           WHEN WS-TERM > +132
071211              MOVE 12               TO V1
071211           WHEN WS-TERM > +120
071211              MOVE 11               TO V1
071211           WHEN WS-TERM > +108
071211              MOVE 10               TO V1
071211           WHEN WS-TERM > +96
071211              MOVE 9                TO V1
071211           WHEN WS-TERM > +84
071211              MOVE 8                TO V1
071211           WHEN WS-TERM > +72
071211              MOVE 7                TO V1
071211           WHEN WS-TERM > +60
071211              MOVE 6                TO V1
071211           WHEN WS-TERM > +48
071211              MOVE 5                TO V1
071211           WHEN WS-TERM > +36
071211              MOVE 4                TO V1
071211           WHEN WS-TERM > +24
071211              MOVE 3                TO V1
071211           WHEN WS-TERM > +12
071211              MOVE 2                TO V1
071211           WHEN OTHER
071211              MOVE 1                TO V1
071211        END-EVALUATE
071211        
071211        EVALUATE TRUE
071211*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
071211*             < +13)
071211*             AND (DD-IU-PRESENT)
071211*             MOVE 2                TO V2
071211*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
071211*             MOVE 1                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
071211              MOVE 2                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
071211              MOVE 3                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
071211              MOVE 4                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
071211              MOVE 5                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
071211              MOVE 6                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
071211              MOVE 7                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
071211              MOVE 8                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
071211              MOVE 9                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
071211              MOVE 10               TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
071211              MOVE 11               TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
071211              MOVE 12               TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
071211              MOVE 13               TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
071211              MOVE 14               TO V2
071211           WHEN OTHER
071211              MOVE 15               TO V2
071211        END-EVALUATE
071211
071211        MOVE PD-UEP-FACTOR (V1 V2 + 1)
071211                                 TO CP-DDF-LO-FACT
071211        MOVE PD-UEP-FACTOR (V1 V2)
071211                                 TO CP-DDF-HI-FACT
071211
              MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
              MOVE CM-AH-CLP     TO CP-DDF-CLP

              COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
                 (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
              MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
              MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE

071211        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
071211           + PD-1ST-YR-ADMIN-ALLOW
071211
071211        MOVE 'G'                 TO CP-DDF-SPEC-CALC
PEMTST*       IF PI-CLP-YN = 'Y'
PEMTST*          MOVE 'C'              TO CP-DDF-SPEC-CALC
PEMTST*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
PEMTST*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
PEMTST*       END-IF
071211        
071211        IF DD-IU-PRESENT
071211           MOVE 'I'              TO CP-EARNING-METHOD
071211        END-IF
071211        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
                                           CP-CLP-RATE-UP
071211        IF CP-IU-RATE-UP NOT = ZEROS
071211           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
071211              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
071211           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
071211              / (1 - WS-WORK-FACT)
071211        END-IF
071211     END-IF

           .
       3750-CONTINUE.

06321      PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
06322                                                                   ELC50PD
06323      IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
06324          MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.           ELC50PD
06325                                                                   ELC50PD
06326      IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
06327         CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
06328         MOVE ER-2740             TO WS-ERROR                      ELC50PD
06329         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
06330                                                                   ELC50PD
06331      IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
06332         MOVE ER-2617             TO WS-ERROR                      ELC50PD
06333         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD

           IF PB-COMPANY-ID = 'DCC'
              AND PB-CI-ENTRY-STATUS = 'M'
              MOVE +0                  TO PB-C-AH-REF-CALC
           ELSE
              MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
           END-IF

071211     IF PB-COMPANY-ID = 'DCC'
071211        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
071211        AND (CP-EARNING-METHOD = 'D' OR 'I')
071211        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
071211        MOVE 'C'                 TO CP-DDF-SPEC-CALC
071211        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
071211        MOVE ZEROS               TO CP-1ST-YR-ALLOW
071211        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
071211        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
071211        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
071211     END-IF

06337      GO TO 3770-CHECK-REFUNDS.                                    ELC50PD
06338      EJECT                                                        ELC50PD
06339                                                                   ELC50PD
06340  3770-CHECK-REFUNDS.                                              ELC50PD
06341                                                                   ELC50PD
06342      IF PB-CI-LF-CANCEL-AMT NOT = ZERO                            ELC50PD
06343         IF PB-C-LF-CANCEL-VOID-SW = SPACE                         ELC50PD
06344            MOVE ER-2766          TO WS-ERROR                      ELC50PD
06345            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
06346            SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC     ELC50PD
06347            IF PB-C-LF-REF-CALC LESS THAN ZERO                     ELC50PD
06348               MOVE ZEROS         TO PB-C-LF-REF-CALC.             ELC50PD
06349                                                                   ELC50PD
06350      IF PB-CI-AH-CANCEL-AMT NOT = ZERO                            ELC50PD
06351         IF PB-C-AH-CANCEL-VOID-SW = SPACE                         ELC50PD
06352            MOVE ER-2766          TO WS-ERROR                      ELC50PD
06353            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
06354            SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC     ELC50PD
06355            IF PB-C-AH-REF-CALC LESS THAN ZERO                     ELC50PD
06356               MOVE ZEROS         TO PB-C-AH-REF-CALC.             ELC50PD
06357                                                                   ELC50PD
06358      IF PB-COMP-LF-CANCEL                                         ELC50PD
06359         MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT            ELC50PD
06360         IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
06361            IF PB-C-LF-CANCEL-AMT LESS THAN +1.00                  ELC50PD
06362               MOVE +0            TO  PB-C-LF-CANCEL-AMT.          ELC50PD
06363                                                                   ELC50PD
06364      IF PB-COMP-AH-CANCEL                                         ELC50PD
06365         MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT            ELC50PD
06366         IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
06367            IF PB-C-AH-CANCEL-AMT LESS THAN +1.00                  ELC50PD
06368               MOVE +0            TO  PB-C-AH-CANCEL-AMT.          ELC50PD
06369                                                                   ELC50PD
06370      SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT               CL**2
06371              GIVING WS-UNSIGN-WRK1                                ELC50PD
06372      SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT               CL**2
06373              GIVING WS-UNSIGN-WRK2.                               ELC50PD
06374                                                                   ELC50PD
06375      IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
06376          MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
06377                                                                   ELC50PD
06378      IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
06379          MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
06380                                                                   ELC50PD
06381      ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.        CL**2
06382                                                                   ELC50PD
06383  EJECT                                                            ELC50PD
06384                                                                   ELC50PD
06385  3772-CONTINUE.                                                   ELC50PD
06386                                                                   ELC50PD
06387 **********************************                                ELC50PD
06388 *** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE  ELC50PD
06389 *** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE     ELC50PD
06390 *** DOUBLES THE TOLERANCE AMOUNT.                                 ELC50PD
06391 ***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL. ELC50PD
06392 **********************************                                ELC50PD
06393      IF PB-COMPANY-ID = 'MON'                                     ELC50PD
06394      IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND              ELC50PD
06395          IF WS-REF-REJECT-SW = SPACE                              ELC50PD
06396              MOVE ER-2754        TO WS-ERROR                      ELC50PD
06397              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
06398            ELSE                                                   ELC50PD
06399              MOVE ER-2736        TO WS-ERROR                      ELC50PD
06400              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
06401 **********************************                                ELC50PD
06402                                                                   ELC50PD
06403  3773-CONTINUE.                                                   ELC50PD
06404                                                                   ELC50PD
06405      IF PB-C-LF-CANCEL-AMT GREATER THAN +0                        ELC50PD
06406         IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
06407            MOVE ER-2723          TO WS-ERROR                      ELC50PD
06408            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
06409                                                                   ELC50PD
06410      IF PB-C-AH-CANCEL-AMT GREATER THAN +0                        ELC50PD
06411         IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
06412            MOVE ER-2724          TO WS-ERROR                      ELC50PD
06413            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
06414                                                                   ELC50PD
06415      IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
06416          COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *     ELC50PD
06417              (1 + WS-LF-REFUND-OVS-PCT)                           ELC50PD
06418      ELSE                                                         ELC50PD
06419          MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.     ELC50PD
06420                                                                   ELC50PD
06421      IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS                ELC50PD
06422          COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *     ELC50PD
06423              (1 - WS-TOL-LF-REFUND-PCT)                           ELC50PD
06424      ELSE                                                         ELC50PD
06425          MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
06426                                                                   ELC50PD
           IF (PB-COMPANY-ID = 'DCC')
              AND (PB-CI-ENTRY-STATUS = 'M')
              AND (PB-C-LF-CANCEL-AMT > +0)
              MOVE ER-3843             TO WS-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
           END-IF
06427      EVALUATE TRUE                                                ELC50PD
06428         WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
06429            CONTINUE                                               ELC50PD
06430         WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
06431                  AND PB-C-LF-REF-CALC > +0                        ELC50PD
06432            CONTINUE                                               ELC50PD
06433         WHEN WS-LF-REFUND-OVS-AMT = 0                             ELC50PD
06434                  AND WS-TOL-LF-REFUND = 0                         ELC50PD
06435            CONTINUE                                               ELC50PD
06436         WHEN OTHER                                                ELC50PD
06437            IF WS-TOL-LF-REFUND  = +0                              ELC50PD
06438               MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND           ELC50PD
06439            END-IF                                                 ELC50PD
06440            IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
06441                 (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <          ELC50PD
06442                           (PB-C-LF-CANCEL-AMT))                   ELC50PD
06443               CONTINUE                                            ELC50PD
06444            ELSE                                                   ELC50PD
06445               IF WS-LF-REFUND-OVS-AMT = +0                        ELC50PD
06446                  MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT    ELC50PD
06447               END-IF                                              ELC50PD
06448               IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
06449                   (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >     ELC50PD
06450                                        PB-C-LF-CANCEL-AMT)        ELC50PD
06451                  CONTINUE                                         ELC50PD
06452               ELSE                                                ELC50PD
06453                  IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
06454                    MOVE ER-2754   TO  WS-ERROR                    ELC50PD
06455                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
06456                  ELSE                                             ELC50PD
06457                     MOVE ER-2736   TO  WS-ERROR                   ELC50PD
06458                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
06459                  END-IF                                           ELC50PD
06460               END-IF                                              ELC50PD
06461            END-IF                                                 ELC50PD
06462      END-EVALUATE.                                                ELC50PD
06463                                                                   ELC50PD
06464      EVALUATE TRUE                                                ELC50PD
06465         WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
06466            CONTINUE                                               ELC50PD
06467         WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
06468                  AND PB-C-LF-REF-CALC > +0                        ELC50PD
06469            CONTINUE                                               ELC50PD
06470         WHEN OTHER                                                ELC50PD
06471            IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
06472                (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))     ELC50PD
06473               CONTINUE                                            ELC50PD
06474            ELSE                                                   ELC50PD
06475               IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
06476                (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))    ELC50PD
06477                 CONTINUE                                          ELC50PD
06478               ELSE                                                ELC50PD
06479                  IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
06480                      MOVE ER-2754   TO  WS-ERROR                  ELC50PD
06481                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
06482                  ELSE                                             ELC50PD
06483                      MOVE ER-2736   TO  WS-ERROR                  ELC50PD
06484                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
06485                  END-IF                                           ELC50PD
06486               END-IF                                              ELC50PD
06487            END-IF                                                 ELC50PD
06488      END-EVALUATE.                                                ELC50PD
06489                                                                   ELC50PD
06490      IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
06491          COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *     ELC50PD
06492              (1 + WS-AH-REFUND-OVS-PCT)                           ELC50PD
06493      ELSE                                                         ELC50PD
06494          MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.     ELC50PD
06495                                                                   ELC50PD
06496      IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS                   ELC50PD
06497          COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *     ELC50PD
06498              (1 - WS-TOL-AH-REFUND-PCT)                           ELC50PD
06499      ELSE                                                         ELC50PD
06500          MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
06501                                                                   ELC50PD
           IF (PB-COMPANY-ID = 'DCC')
              AND (PB-CI-ENTRY-STATUS = 'M')
              AND (PB-C-AH-CANCEL-AMT > +0)
              MOVE ER-3843             TO WS-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
           END-IF
06502      EVALUATE TRUE                                                ELC50PD
06503         WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
06504            CONTINUE                                               ELC50PD
CIDMOD*       WHEN PB-C-AH-REF-CALC = +0 AND                            ELC50PD
CIDMOD*                  PB-C-AH-CANCEL-AMT > +0                        ELC50PD
CIDMOD        WHEN PB-C-AH-CANCEL-AMT = +0 AND                          ELC50PD
CIDMOD                   PB-C-AH-REF-CALC > +0                          ELC50PD
06507            CONTINUE                                               ELC50PD
06508         WHEN WS-AH-REFUND-OVS-AMT = +0                            ELC50PD
06509                 AND WS-TOL-AH-REFUND = +0                         ELC50PD
06510            CONTINUE                                               ELC50PD
06511         WHEN OTHER                                                ELC50PD
06512            IF WS-TOL-AH-REFUND = +0                               ELC50PD
06513               MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND           ELC50PD
06514            END-IF                                                 ELC50PD
06515            IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND        ELC50PD
06516                (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <            ELC50PD
06517                                          PB-C-AH-CANCEL-AMT)      ELC50PD
06518               CONTINUE                                            ELC50PD
06519            ELSE                                                   ELC50PD
06520               IF WS-AH-REFUND-OVS-AMT = +0                        ELC50PD
06521                  MOVE +9999999.99 TO                              ELC50PD
06522                          WS-AH-REFUND-OVS-AMT                     ELC50PD
06523               END-IF                                              ELC50PD
06524               IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
06525                   (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >     ELC50PD
06526                                          PB-C-AH-CANCEL-AMT)      ELC50PD
06527                  CONTINUE                                         ELC50PD
06528               ELSE                                                ELC50PD
06529                  IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
06530                     MOVE ER-2754   TO  WS-ERROR                   ELC50PD
06531                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
06532                  ELSE                                             ELC50PD
06533                     MOVE ER-2736   TO  WS-ERROR                   ELC50PD
06534                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
06535                  END-IF                                           ELC50PD
06536               END-IF                                              ELC50PD
06537            END-IF                                                 ELC50PD
06538      END-EVALUATE.                                                ELC50PD
06539                                                                   ELC50PD
06540      EVALUATE TRUE                                                ELC50PD
06541         WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
06542            CONTINUE                                               ELC50PD
CIDMOD*       WHEN PB-C-AH-REF-CALC > +0 AND                            ELC50PD
CIDMOD*                  PB-C-AH-CANCEL-AMT = +0                        ELC50PD
CIDMOD        WHEN PB-C-AH-CANCEL-AMT > +0 AND                          ELC50PD
CIDMOD                   PB-C-AH-REF-CALC = +0                          ELC50PD
06545            CONTINUE                                               ELC50PD
06546         WHEN OTHER                                                ELC50PD
06547            IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND       ELC50PD
06548                (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))     ELC50PD
06549               CONTINUE                                            ELC50PD
06550            ELSE                                                   ELC50PD
06551               IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
06552                 (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))   ELC50PD
06553                  CONTINUE                                         ELC50PD
06554               ELSE                                                ELC50PD
06555                  IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
06556                      MOVE ER-2754   TO  WS-ERROR                  ELC50PD
06557                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
06558                  ELSE                                             ELC50PD
06559                      MOVE ER-2736   TO  WS-ERROR                  ELC50PD
06560                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
06561                  END-IF                                           ELC50PD
06562               END-IF                                              ELC50PD
06563            END-IF                                                 ELC50PD
06564      END-EVALUATE.                                                ELC50PD
06565                                                                   ELC50PD
06566      IF (PB-C-LF-CANCEL-AMT = ZERO)
06567         AND (PB-C-AH-CANCEL-AMT = ZERO)
06568         IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
06569            AND  PB-C-LF-REF-CALC < +1.00
06570            AND  PB-C-AH-REF-CALC < +1.00
06571            CONTINUE
06572         ELSE
                 IF (PB-COMPANY-ID = 'DCC')
                    AND (PB-CI-ENTRY-STATUS = 'M')
                    CONTINUE
                 ELSE
06573               MOVE ER-2741       TO WS-ERROR
06574               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
           END-IF
06575                                                                   ELC50PD
06576      IF (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
06577         AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
06578         AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED                      ELC50PD
06579         AND PB-C-LF-REF-CALC NOT = ZERO)                          ELC50PD
06580         OR                                                        ELC50PD
06581         (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
06582         AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
06583         AND PB-C-LF-CANCEL-DT = LOW-VALUES)                       ELC50PD
06584              IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
06585                 AND PB-C-LF-REF-CALC LESS THAN +1.00              ELC50PD
06586                 NEXT SENTENCE                                     ELC50PD
06587              ELSE                                                 ELC50PD
06588                 MOVE ER-2739        TO WS-ERROR                   ELC50PD
06589                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
06590                                                                   ELC50PD
06591      IF (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
06592         AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
06593         AND NOT PB-CI-AH-LUMP-SUM-DISAB                           ELC50PD
06594         AND PB-C-AH-REF-CALC NOT = ZERO)                          ELC50PD
06595         OR                                                        ELC50PD
06596         (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
06597         AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
06598         AND PB-C-AH-CANCEL-DT = LOW-VALUES)                       ELC50PD
06599              IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
06600                 AND PB-C-AH-REF-CALC LESS THAN +1.00              ELC50PD
06601                 NEXT SENTENCE                                     ELC50PD
06602              ELSE                                                 ELC50PD
06603                 MOVE ER-2738        TO WS-ERROR                   ELC50PD
06604                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
06605                                                                   ELC50PD
06606  3775-OVER-REF-CHK.                                               ELC50PD
06607                                                                   ELC50PD
06608      IF PB-CI-ENTRY-STATUS = '5'                                  ELC50PD
06609         GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
06610                                                                   ELC50PD
06611      COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +              ELC50PD
06612                               PB-CI-LF-ALT-PREMIUM-AMT.           ELC50PD
06613                                                                   ELC50PD
06614      IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
06615         COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
06616                                  PB-C-LF-REF-CALC                 ELC50PD
06617       ELSE                                                        ELC50PD
06618         COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
06619                                  PB-C-LF-CANCEL-AMT.              ELC50PD
06620                                                                   ELC50PD
06621      IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
06622         MOVE ER-2755             TO WS-ERROR                      ELC50PD
06623         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
06624                                                                   ELC50PD
06625      MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.               ELC50PD
06626                                                                   ELC50PD
06627      IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
06628         COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
06629                                  PB-C-AH-REF-CALC                 ELC50PD
06630       ELSE                                                        ELC50PD
06631         COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
06632                                  PB-C-AH-CANCEL-AMT.              ELC50PD
06633                                                                   ELC50PD
06634      IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
06635         MOVE ER-2778             TO WS-ERROR                      ELC50PD
06636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
06637                                                                   ELC50PD
06638      IF PB-CI-OB-FLAG NOT = 'Z'                                   ELC50PD
06639         NEXT SENTENCE                                             ELC50PD
06640        ELSE                                                       ELC50PD
06641          IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                  ELC50PD
06642             MOVE ER-2757           TO WS-ERROR                    ELC50PD
06643             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
06644                                                                   ELC50PD
06645  3780-UPDATE-CANCEL-CERT.                                         ELC50PD
06646                                                                   ELC50PD
06647      IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'                         ELC50PD
06648         MOVE ER-2728              TO WS-ERROR                     ELC50PD
06649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
06650                                                                   ELC50PD
06651      IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'                         ELC50PD
06652          MOVE ER-2729              TO WS-ERROR                    ELC50PD
06653          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
06654                                                                   ELC50PD
06655      IF PB-CI-LF-BENEFIT-CD = ZERO                                ELC50PD
06656          GO TO 3780-UPDATE-CONT-1.                                ELC50PD
06657                                                                   ELC50PD
06658      IF PB-C-LF-CANCEL-DT = LOW-VALUE                             ELC50PD
06659          GO TO 3780-UPDATE-CONT-1.                                ELC50PD
06660                                                                   ELC50PD
06661      IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
06662        AND                                                        ELC50PD
06663         (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
06664        AND                                                        ELC50PD
06665         (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
06666        AND                                                        ELC50PD
06667         ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)       ELC50PD
06668             NEXT SENTENCE                                         ELC50PD
06669        ELSE                                                       ELC50PD
06670         IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
06671           AND                                                     ELC50PD
06672 ***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
06673 ***       AND                                                     ELC50PD
06674            (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)     ELC50PD
06675             IF PB-C-LF-CANCEL-VOID-SW = SPACE                     ELC50PD
06676                MOVE ER-2730      TO WS-ERROR                      ELC50PD
06677                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
06678                GO TO 3999-END-EDIT                                ELC50PD
06679             ELSE                                                  ELC50PD
06680                GO TO 3999-END-EDIT                                ELC50PD
06681         ELSE                                                      ELC50PD
06682             IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT       ELC50PD
06683                MOVE ER-2765           TO WS-ERROR                 ELC50PD
06684                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
072308               GO TO 3785-CHECK-NH.
06685 *              GO TO 3999-END-EDIT.                               ELC50PD
06686                                                                   ELC50PD
06687  3780-UPDATE-CONT-1.                                              ELC50PD
050311     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
06688                                                                   ELC50PD
06689      IF PB-CI-AH-BENEFIT-CD = ZERO                                ELC50PD
06690          GO TO 3780-UPDATE-CONT-2.                                ELC50PD
06691                                                                   ELC50PD
06692      IF PB-C-AH-CANCEL-DT = LOW-VALUE                             ELC50PD
06693          GO TO 3780-UPDATE-CONT-2.                                ELC50PD
050311
050311     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
06694                                                                   ELC50PD
06695      IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
06696        AND                                                        ELC50PD
06697         (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
06698        AND                                                        ELC50PD
06699         (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
06700        AND                                                        ELC50PD
06701         ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)       ELC50PD
06702             NEXT SENTENCE                                         ELC50PD
06703        ELSE                                                       ELC50PD
06704         IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
06705           AND                                                     ELC50PD
06706 ***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
06707 ***       AND                                                     ELC50PD
06708            (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)     ELC50PD
050311           IF WS-AH-CLAIM-RESCINDED <> 'Y'
06709             IF PB-C-AH-CANCEL-VOID-SW = SPACE                     ELC50PD
06710                MOVE ER-2773      TO WS-ERROR                      ELC50PD
06711                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
06712                GO TO 3999-END-EDIT                                ELC50PD
06713             ELSE                                                  ELC50PD
06714                GO TO 3999-END-EDIT                                ELC50PD
050311            END-IF
050311           ELSE
050311             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
050311                MOVE ER-2890 TO WS-ERROR
050311                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
050311                GO TO 3999-END-EDIT
050311             ELSE
050311                GO TO 3785-CHECK-NH
050311             END-IF
050311           END-IF
06715           ELSE                                                    ELC50PD
06716             IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT       ELC50PD
050311              IF WS-AH-CLAIM-RESCINDED = 'Y'
050311                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
050311                   MOVE ER-2890 TO WS-ERROR
050311                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
050311                   GO TO 3999-END-EDIT
050311                ELSE
050311                   MOVE ER-2765 TO WS-ERROR
050311                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
050311                   GO TO 3785-CHECK-NH
050311                END-IF
050311              ELSE
06717                MOVE ER-2765      TO WS-ERROR                      ELC50PD
06718                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
072308               GO TO 3785-CHECK-NH.
06719 *              GO TO 3999-END-EDIT.                               ELC50PD
06720                                                                   ELC50PD
06721  3780-UPDATE-CONT-2.                                              ELC50PD
06722                                                                   ELC50PD
06723      IF PB-C-LF-CANCEL-AMT NOT = ZERO                             ELC50PD
06724         AND WS-LF-BENEFIT-CD = ZERO                               ELC50PD
06725            MOVE ER-2743           TO WS-ERROR                     ELC50PD
06726            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
06727                                                                   ELC50PD
06728      IF PB-C-AH-CANCEL-AMT NOT = ZERO                             ELC50PD
06729         AND WS-AH-BENEFIT-CD = ZERO                               ELC50PD
06730            MOVE ER-2744           TO WS-ERROR                     ELC50PD
06731            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
06732                                                                   ELC50PD
06733      IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR                         ELC50PD
06734         (PB-C-AH-CANCEL-AMT NEGATIVE))                            ELC50PD
06735         AND                                                       ELC50PD
06736         ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR                 ELC50PD
06737          (PB-CI-AH-POLICY-STATUS = '6' OR '7'))                   ELC50PD
06738            MOVE ER-2746           TO WS-ERROR                     ELC50PD
06739            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
06740                                                                   ELC50PD
06741      IF (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
06742        AND                                                        ELC50PD
06743         (PB-C-LF-CANCEL-VOID-SW NOT = '1')                        ELC50PD
06744              MOVE ER-2737        TO WS-ERROR                      ELC50PD
06745              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
06746                                                                   ELC50PD
06747      IF (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
06748        AND                                                        ELC50PD
06749         (PB-C-AH-CANCEL-VOID-SW NOT = '1')                        ELC50PD
06750              MOVE ER-2737        TO WS-ERROR                      ELC50PD
06751              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
06752                                                                   ELC50PD
06753      IF  CM-CLAIM-ATTACHED-COUNT GREATER +0                       ELC50PD
06754          IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
030612             OR 'CID' OR 'DCC' OR 'AHL'
06755              PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT      ELC50PD
06756          ELSE                                                     ELC50PD
06757              IF PB-COMPANY-ID = 'FIA' OR 'MTL'                       CL**2
06758                  MOVE ER-2768    TO WS-ERROR                      ELC50PD
06759                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
06760              ELSE                                                 ELC50PD
06761                  MOVE ER-2756    TO WS-ERROR                      ELC50PD
06762                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
06763                                                                   ELC50PD
06764      IF CERT-PEND-ISSUE-RETURNED                                  ELC50PD
06765         MOVE ER-2772             TO WS-ERROR                      ELC50PD
06766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD

072308 3785-CHECK-NH.

072308     IF PB-STATE NOT = 'NH'
072308        GO TO 3999-END-EDIT
072308     END-IF
072308     
072308     MOVE ER-2796                TO WS-ERROR
072308     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT

072308     IF (PB-C-REF-INTERFACE-SW = 'Y')
072308        OR (CM-NH-INTERFACE-SW = 'Y')
072308        MOVE ER-2793             TO WS-ERROR
072308        PERFORM 9900-ERROR-FORMAT
072308                                 THRU 9900-EXIT
072308     END-IF

072308     MOVE +0                     TO WS-PAYMENT-AMT
072308     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
072308        GO TO 3999-END-EDIT
072308     END-IF

072308     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
072308        GO TO 3999-END-EDIT
072308     END-IF

072308     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
072308     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2

072308     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
072308        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
072308     END-IF
072308     MOVE '1'                    TO DC-OPTION-CODE
072308     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
072308     IF NO-CONVERSION-ERROR
072308        IF DC-ELAPSED-DAYS < +16
072308           GO TO 3999-END-EDIT
072308        END-IF
072308     END-IF

072308     MOVE +0                     TO DC-ELAPSED-DAYS
072308     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
072308     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
072308     MOVE '1'                    TO DC-OPTION-CODE
072308     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
072308     IF NO-CONVERSION-ERROR
072308        IF DC-ELAPSED-DAYS > +30
072308           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
072308        ELSE
072308           GO TO 3999-END-EDIT
072308        END-IF
072308     ELSE
072308        GO TO 3999-END-EDIT
072308     END-IF

072308     COMPUTE WS-PAYMENT-AMT ROUNDED =
072308        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
072308           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))

072308     IF WS-PAYMENT-AMT < 600.00
072308        GO TO 3999-END-EDIT
072308     END-IF

072308     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
072308                                                                  ELC50PD
072308     IF (ERMAIL-FOUND = ' ')
072308         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
072308         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
072308        GO TO 3999-END-EDIT
072308     END-IF

072308     MOVE ER-2795                TO WS-ERROR
072308     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
06767                                                                   ELC50PD
06768      GO TO 3999-END-EDIT.                                         ELC50PD
06769 ******************************************************************ELC50PD
06770      EJECT                                                        ELC50PD
06771  3990-FILES-NOT-OPEN.                                             ELC50PD
06772                                                                   ELC50PD
06773      MOVE ER-2617                TO WS-ERROR.                     ELC50PD
06774      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
06775      GO TO 9990-RETURN.                                           ELC50PD
06776                                                                   ELC50PD
06777  3999-END-EDIT.                                                   ELC50PD

06778                                                                   ELC50PD
06779      MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.                   ELC50PD
06780                                                                   ELC50PD
06781      IF PB-CANCELLATION AND CERT-WAS-FOUND                        ELC50PD
06782          PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT        ELC50PD
06783          IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
06784              PERFORM 9250-UNLOCK-RETURN                           ELC50PD
06785              GO TO 9990-RETURN                                    ELC50PD
06786           ELSE                                                    ELC50PD
06787              PERFORM 7800-REWRITE-CERT THRU 7800-EXIT             ELC50PD
06788              GO TO 9990-RETURN.                                   ELC50PD
06789                                                                   ELC50PD
06790      IF PB-CANCELLATION                                           ELC50PD
06791           GO TO 9990-RETURN.                                      ELC50PD
06792                                                                   ELC50PD
06793      IF CERT-WAS-NOT-FOUND                                        ELC50PD
06794         MOVE SPACES              TO CERTIFICATE-MASTER.           ELC50PD
06795                                                                   ELC50PD
06796      PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.                 ELC50PD
06797                                                                   ELC50PD
06798      IF CERT-WAS-FOUND                                            ELC50PD
06799          IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
06800              PERFORM 9250-UNLOCK-RETURN                           ELC50PD
06801           ELSE                                                    ELC50PD
06802             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT              ELC50PD
06803       ELSE                                                        ELC50PD
06804          PERFORM 8000-WRITE-CERT THRU 8000-EXIT.                  ELC50PD
050509
050509     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
050509        IF PB-COMPANY-ID = 'DCC' AND
050509           (PB-CARRIER = '2' OR '4' OR '6')
050509              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
050509        END-IF
050509     END-IF.
011513
011513     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
011513         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
011513     END-IF.
06805                                                                   ELC50PD
           MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
           IF ((PB-COMPANY-ID = 'DCC')
              AND (WS-NO-SECURE-PAY))
                        OR
              (WS-LF-SPECIAL-CALC-CD = 'O'
              OR WS-AH-SPECIAL-CALC-CD = 'O')
              SET SKIP-ADDR-EDIT       TO TRUE
           END-IF

080310     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
              AND (NOT SKIP-ADDR-EDIT)
080310        MOVE ER-2963             TO WS-ERROR
080310        PERFORM 9900-ERROR-FORMAT
080310                                 THRU 9900-EXIT
080310        GO TO 9990-RETURN
080310     END-IF

06809      PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.                     ELC50PD

           IF ERPNDM-FOUND NOT = 'X'
              IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
                 OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
                 OR (PM-ZIP         = SPACES OR LOW-VALUES))
                 AND (NOT SKIP-ADDR-EDIT)
                 MOVE ER-2694          TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
080310        MOVE ' '                 TO STATE-RECORD-ERROR
080310        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
080310        MOVE PM-STATE            TO CNTL-ACCESS
080310        MOVE '3'                 TO CNTL-REC-TYPE
080310        MOVE +0                  TO CNTL-SEQ-NO
080310        MOVE '0'                 TO RC-SW-2
080310        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
080310        IF (NO-STATE-RECORD)
080310           OR (CF-RECORD-TYPE NOT = '3')
080310           OR (PM-STATE NOT = CF-STATE-CODE)
                 IF (PM-STATE = SPACES)
                    AND (SKIP-ADDR-EDIT)
                    CONTINUE
                 ELSE
080310              MOVE ER-2963       TO WS-ERROR
080310              PERFORM 9900-ERROR-FORMAT
080310                                 THRU 9900-EXIT
                 END-IF
080310        END-IF
              IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
                 MOVE ER-2883          TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
080310        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
080310           MOVE ' '                 TO STATE-RECORD-ERROR
080310           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
080310           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
080310           MOVE '3'                 TO CNTL-REC-TYPE
080310           MOVE +0                  TO CNTL-SEQ-NO
080310           MOVE '0'                 TO RC-SW-2
080310           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
080310           IF NO-STATE-RECORD
080310              OR (CF-RECORD-TYPE NOT = '3')
080310              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
080310              MOVE ER-2964          TO WS-ERROR
080310              PERFORM 9900-ERROR-FORMAT
080310                                    THRU 9900-EXIT
080310           END-IF
080310        END-IF
           ELSE
              IF NOT SKIP-ADDR-EDIT
                 MOVE ER-2393          TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
           END-IF
06810                                                                   ELC50PD
06811      PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
06812                                                                   ELC50PD
06813      IF (ERMAIL-FOUND = ' ' AND                                   ELC50PD
06814         ERPNDM-FOUND = ' ')                                       ELC50PD
06815         IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND             ELC50PD
06816            MA-PROFILE-INFO = PM-PROFILE-INFO AND
                 MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
06817           OR                                                      ELC50PD
06818            (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)       ELC50PD
06819           OR                                                      ELC50PD
06820            (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND               ELC50PD
06821            MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)ELC50PD
06822            GO TO 3999-UNLOCK-ERMAIL.                              ELC50PD
06823                                                                   ELC50PD

06824      IF ERPNDM-FOUND = 'X'                                        ELC50PD
06825         GO TO 3999-UNLOCK-ERMAIL.                                 ELC50PD
06826                                                                   ELC50PD
080310     IF PM-INSURED-LAST-NAME      = SPACES
080310        AND PM-INSURED-FIRST-NAME = SPACES
080310        AND PM-ADDRESS-LINE-1     = SPACES
080310        AND PM-ADDRESS-LINE-2     = SPACES
080310        AND PM-CITY-STATE         = SPACES
080310        AND PM-CRED-BENE-NAME     = SPACES
080310        AND PM-CRED-BENE-ADDR     = SPACES
080310        AND PM-CRED-BENE-CTYST    = SPACES
080310        GO TO 3999-UNLOCK-ERMAIL
080310     END-IF
06833                                                                   ELC50PD
06834      MOVE SPACES                 TO MAILING-DATA.                 ELC50PD
06835                                                                   ELC50PD
06836      MOVE 'MA'                   TO MA-RECORD-ID.                 ELC50PD
06837      MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.           ELC50PD
06838      MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.            ELC50PD
06839      MOVE PB-SV-CARRIER          TO MA-CARRIER.                   ELC50PD
06840      MOVE PB-SV-GROUPING         TO MA-GROUPING.                  ELC50PD
06841      MOVE PB-SV-STATE            TO MA-STATE.                     ELC50PD
06842      MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
           MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
06843                                                                   ELC50PD
06844      MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT              ELC50PD
06845      MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY              ELC50PD
06846                                                                   ELC50PD
06847      IF ERMAIL-FOUND = ' '                                        ELC50PD
06848         PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT                ELC50PD
06849      ELSE                                                         ELC50PD
06850         MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT              ELC50PD
06851         MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY            ELC50PD
06852         PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.                 ELC50PD
06853                                                                   ELC50PD

06854      GO TO 9990-RETURN.                                           ELC50PD
06855                                                                   ELC50PD
06856  3999-UNLOCK-ERMAIL.                                              ELC50PD
06857      IF ERMAIL-FOUND = ' '                                        ELC50PD
06858         PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.                ELC50PD
06859                                                                   ELC50PD
06860      GO TO 9990-RETURN.                                           ELC50PD
06861 ******************************************************************ELC50PD
06862                                                                   ELC50PD
06863      EJECT                                                        ELC50PD
06864  4000-UPDATE-CANCELLED-CERT.                                      ELC50PD
06865      IF CERT-WAS-NOT-FOUND                                        ELC50PD
06866         GO TO 4299-EXIT.                                          ELC50PD
06867                                                                   ELC50PD
06868 *    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.         ELC50PD

           IF PB-C-NH-INT-ON-REFS > ZEROS
              MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
           END-IF
           IF PB-C-REF-INTERFACE-SW = 'Y'
              MOVE PB-C-REF-INTERFACE-SW
                                       TO CM-NH-INTERFACE-SW
           END-IF

081606     IF PB-C-POST-CARD-IND = 'Y'
081606        MOVE +8                  TO SUB
081606        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
081606        IF ERMAIL-FOUND = ' '
081606           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
081606              (SUB > +7)
081606              OR (MA-MAIL-STATUS (SUB) = '1')
081606           END-PERFORM
081606        END-IF
081606        IF (SUB > +7)
081606           OR (ERMAIL-FOUND = 'X')
081606           MOVE ER-3789          TO WS-ERROR
081606           PERFORM 9900-ERROR-FORMAT
081606                                 THRU 9900-EXIT
081606        END-IF
081606     ELSE
081606        MOVE 'N'                 TO PB-C-POST-CARD-IND
081606     END-IF

081606     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
06869                                                                   ELC50PD
06870      IF PB-CI-OB-FLAG = 'Z'                                       ELC50PD
06871         GO TO 4150-SUMMARY-CERT-CANCEL.                           ELC50PD
06872                                                                   ELC50PD
06873      IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
06874          PERFORM 4200-REVERSE-LF-CANCEL.                          ELC50PD
06875      IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
06876          PERFORM 4200-REVERSE-AH-CANCEL.                          ELC50PD
06877                                                                   ELC50PD
06878  4100-APPLY-LF-CANCEL.                                            ELC50PD
06879                                                                   ELC50PD
06880      MOVE +0                     TO WS-SUB.                       ELC50PD
06881                                                                   ELC50PD
06882  4100-CHECK-LF-ERRORS.                                            ELC50PD
06883                                                                   ELC50PD
06884      ADD +1                       TO WS-SUB.                      ELC50PD
06885                                                                   ELC50PD
06886      IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
06887         IF LF-COVERAGE-CANCELLED                                  ELC50PD
06888            GO TO 4100-LF-CANCEL-CONT                              ELC50PD
06889         ELSE                                                      ELC50PD
06890            GO TO 4100-UPDATE-LF-COVERAGE.                         ELC50PD
06891                                                                   ELC50PD
06892      IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
06893                                    ER-2729 OR                     ELC50PD
06894                                    ER-2730 OR                     ELC50PD
06895                                    ER-2731 OR                     ELC50PD
06896                                    ER-2732 OR                     ELC50PD
06897                                    ER-2737 OR                     ELC50PD
06898                                    ER-2740 OR                     ELC50PD
06899                                    ER-2743 OR                     ELC50PD
06900                                    ER-2749 OR                     ELC50PD
06901                                    ER-2750 OR                     ELC50PD
06902                                    ER-2755 OR                     ELC50PD
06903                                    ER-2757 OR                     ELC50PD
06904                                    ER-2760 OR                     ELC50PD
06905                                    ER-2772 OR                     ELC50PD
06906                                    ER-2774 OR                     ELC50PD
06907                                    ER-2776 OR                     ELC50PD
06908                                    ER-2794                        ELC50PD
06909         GO TO 4100-UPDATE-LF-COVERAGE.                            ELC50PD
06910                                                                   ELC50PD
06911      GO TO 4100-CHECK-LF-ERRORS.                                  ELC50PD
06912                                                                   ELC50PD
06913  4100-UPDATE-LF-COVERAGE.                                         ELC50PD
06914                                                                   ELC50PD
06915      MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT     ELC50PD
06916      MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT          ELC50PD
042011     IF NOT CM-LF-DEATH-CLAIM-APPLIED
042011        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
042011     END-IF
06918      MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
06919                                       TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
06920      IF CM-LF-CANCEL-DT = LOW-VALUE                               ELC50PD
06921          MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.    ELC50PD
06922                                                                   ELC50PD
06923      IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
06924          MOVE SPACES                  TO CM-LF-EXIT-BATCH         ELC50PD
06925                                          CM-LF-STATUS-AT-CANCEL.  ELC50PD
06926                                                                   ELC50PD
06927      GO TO 4100-APPLY-AH-CANCEL.                                  ELC50PD
06928                                                                   ELC50PD
06929  4100-LF-CANCEL-CONT.                                             ELC50PD
06930      IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
06931          GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
06932                                                                   ELC50PD
06933      IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
06934          GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
06935                                                                   ELC50PD
06936      IF PB-C-LF-CANCEL-AMT GREATER ZERO                           ELC50PD
06937         IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                   ELC50PD
06938            MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT        ELC50PD
06939         ELSE                                                      ELC50PD
06940            MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.       ELC50PD
06941                                                                   ELC50PD
06942      MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.            ELC50PD
06943      MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.       ELC50PD
06944                                                                   ELC50PD
06945      IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
06946          MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.           ELC50PD
06947                                                                   ELC50PD
06948      IF (CM-LF-STATUS-AT-CANCEL = SPACE)
042011        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
06949          MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL      ELC50PD
06950          MOVE '8'                  TO CM-LF-CURRENT-STATUS.       ELC50PD
06951                                                                   ELC50PD
06952      IF PB-RECORD-RETURNED                                        ELC50PD
06953         MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
06954       ELSE                                                        ELC50PD
06955         MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
06956                                                                   ELC50PD
06957  4100-APPLY-AH-CANCEL.                                            ELC50PD
06958                                                                   ELC50PD
06959      MOVE +0                      TO WS-SUB.                      ELC50PD
06960                                                                   ELC50PD
06961  4100-CHECK-AH-ERRORS.                                            ELC50PD
06962                                                                   ELC50PD
06963      ADD +1                       TO WS-SUB.                      ELC50PD
06964                                                                   ELC50PD
06965      IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
06966         IF AH-COVERAGE-CANCELLED                                  ELC50PD
06967            GO TO 4100-AH-CANCEL-CONT                              ELC50PD
06968         ELSE                                                      ELC50PD
06969            GO TO 4100-UPDATE-AH-COVERAGE.                         ELC50PD
06970                                                                   ELC50PD
06971      IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
06972                                    ER-2729 OR                     ELC50PD
06973                                    ER-2732 OR                     ELC50PD
06974                                    ER-2737 OR                     ELC50PD
06975                                    ER-2740 OR                     ELC50PD
06976                                    ER-2744 OR                     ELC50PD
06977                                    ER-2749 OR                     ELC50PD
06978                                    ER-2750 OR                     ELC50PD
06979                                    ER-2755 OR                     ELC50PD
06980                                    ER-2757 OR                     ELC50PD
06981                                    ER-2760 OR                     ELC50PD
06982                                    ER-2771 OR                     ELC50PD
06983                                    ER-2772 OR                     ELC50PD
06984                                    ER-2773 OR                     ELC50PD
06985                                    ER-2775 OR                     ELC50PD
06986                                    ER-2777 OR                     ELC50PD
06987                                    ER-2794                        ELC50PD
06988         GO TO 4100-UPDATE-AH-COVERAGE.                            ELC50PD
06989                                                                   ELC50PD
06990      GO TO 4100-CHECK-AH-ERRORS.                                  ELC50PD
06991                                                                   ELC50PD
06992  4100-UPDATE-AH-COVERAGE.                                         ELC50PD
06993                                                                   ELC50PD
06994      MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT     ELC50PD
06995      MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT          ELC50PD
06996      MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS     ELC50PD
06997      MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
06998                                       TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
06999      IF CM-AH-CANCEL-DT = LOW-VALUE                               ELC50PD
07000          MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.    ELC50PD
07001                                                                   ELC50PD
07002      IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
07003          MOVE SPACES                  TO CM-AH-EXIT-BATCH         ELC50PD
07004                                          CM-AH-STATUS-AT-CANCEL.  ELC50PD
07005                                                                   ELC50PD
07006      IF LF-COVERAGE-CANCELLED                                     ELC50PD
07007          IF PB-RECORD-RETURNED                                    ELC50PD
07008               MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2 ELC50PD
07009           ELSE                                                    ELC50PD
07010               MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
07011                                                                   ELC50PD
07012      GO TO 4299-EXIT.                                             ELC50PD
07013                                                                   ELC50PD
07014  4100-AH-CANCEL-CONT.                                             ELC50PD
07015      IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
07016          GO TO 4299-EXIT.                                         ELC50PD
07017                                                                   ELC50PD
07018      IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
07019          GO TO 4299-EXIT.                                         ELC50PD
07020                                                                   ELC50PD
07021      IF PB-C-AH-CANCEL-AMT GREATER ZERO                           ELC50PD
07022         IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                     ELC50PD
07023            MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT      ELC50PD
07024         ELSE                                                      ELC50PD
07025            MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.     ELC50PD
07026                                                                   ELC50PD
07027      MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.              ELC50PD
07028      MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.         ELC50PD
07029                                                                   ELC50PD
07030      IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
07031          MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.             ELC50PD
07032                                                                   ELC50PD
07033      IF CM-AH-STATUS-AT-CANCEL = SPACE                            ELC50PD
07034          MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL      ELC50PD
07035          MOVE '8'                TO CM-AH-CURRENT-STATUS.         ELC50PD
07036                                                                   ELC50PD
07037      IF PB-RECORD-RETURNED                                        ELC50PD
07038         MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2      ELC50PD
07039       ELSE                                                        ELC50PD
07040         MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
07041                                                                   ELC50PD
07042      GO TO 4299-EXIT.                                             ELC50PD
07043                                                                   ELC50PD
07044  4150-SUMMARY-CERT-CANCEL.                                        ELC50PD
07045      MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
07046                                                                   ELC50PD
07047      IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
07048         COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
07049                       PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC      ELC50PD
07050      ELSE                                                         ELC50PD
07051         COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
07052                        PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.  ELC50PD
07053                                                                   ELC50PD
07054      IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
07055         COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
07056                        PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC     ELC50PD
07057      ELSE                                                         ELC50PD
07058         COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
07059                        PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.  ELC50PD
07060                                                                   ELC50PD
07061      IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                      ELC50PD
07062         NEXT SENTENCE                                             ELC50PD
07063      ELSE                                                         ELC50PD
07064         COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.              ELC50PD
07065                                                                   ELC50PD
07066      GO TO 4299-EXIT.                                             ELC50PD
07067                                                                   ELC50PD
07068  4200-REVERSE-LF-CANCEL.                                          ELC50PD
07069      MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.            ELC50PD
07070                                                                   ELC50PD
07071      IF CM-LF-CANCEL-APPLIED                                      ELC50PD
07072         MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT        ELC50PD
07073         MOVE SPACES                TO CM-LF-EXIT-BATCH            ELC50PD
07074         MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.      ELC50PD
07075                                                                   ELC50PD
07076      MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.     ELC50PD
07077                                                                   ELC50PD
07078      IF PB-RECORD-RETURNED                                        ELC50PD
07079         MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
07080        ELSE                                                       ELC50PD
07081         MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
07082                                                                   ELC50PD
07083  4200-REVERSE-LF-EXIT.                                            ELC50PD
07084        EXIT.                                                      ELC50PD
07085                                                                   ELC50PD
07086  4200-REVERSE-AH-CANCEL.                                          ELC50PD
07087      MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.            ELC50PD
07088                                                                   ELC50PD
07089      IF CM-AH-CANCEL-APPLIED                                      ELC50PD
07090         MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT        ELC50PD
07091         MOVE SPACES                TO CM-AH-EXIT-BATCH            ELC50PD
07092         MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.      ELC50PD
07093                                                                   ELC50PD
07094      MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.     ELC50PD
07095                                                                   ELC50PD
07096      IF PB-RECORD-RETURNED                                        ELC50PD
07097         MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
07098        ELSE                                                       ELC50PD
07099         MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
07100                                                                   ELC50PD
07101  4200-REVERSE-AH-EXIT.                                            ELC50PD
07102        EXIT.                                                      ELC50PD
07103                                                                   ELC50PD
07104  4299-EXIT.                                                       ELC50PD
07105        EXIT.                                                      ELC50PD
07106        EJECT                                                      ELC50PD
07107                                                                   ELC50PD
07108  4500-UPDATE-NEW-CERT.                                            ELC50PD
07109      IF CERT-WAS-FOUND                                            ELC50PD
07110          NEXT SENTENCE                                            ELC50PD
07111        ELSE                                                       ELC50PD
07112          GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
07113                                                                   ELC50PD
07114      IF  CLASIC-CREATED-CERT                                      ELC50PD
07115          GO TO 4999-EXIT.                                         ELC50PD
07116                                                                   ELC50PD
07117      IF  CERT-WAS-CREATED-FOR-CLAIM                               ELC50PD
07118          GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
07119                                                                   ELC50PD
07120      IF CERT-ADDED-BATCH                                          ELC50PD
07121         IF CM-RECORD-ID = 'CM'                                    ELC50PD
07122             GO TO 4999-EXIT.                                      ELC50PD
07123                                                                   ELC50PD
07124  4520-BUILD-NEW-KEY.                                              ELC50PD
07125 * BUILD CONTROL PRIMARY                                           ELC50PD
07126                                                                   ELC50PD
07127      MOVE PB-COMPANY-CD             TO CM-COMPANY-CD              ELC50PD
07128                                        CM-COMPANY-CD-A1           ELC50PD
07129                                        CM-COMPANY-CD-A2           ELC50PD
07130                                        CM-COMPANY-CD-A4           ELC50PD
07131                                        CM-COMPANY-CD-A5.          ELC50PD
07132                                                                   ELC50PD
07133      MOVE PB-SV-CARRIER             TO CM-CARRIER.                ELC50PD
07134      MOVE PB-SV-GROUPING            TO CM-GROUPING.               ELC50PD
07135      MOVE PB-SV-STATE               TO CM-STATE.                  ELC50PD
07136      MOVE PB-ACCOUNT                TO CM-ACCOUNT.                ELC50PD
07137      MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.             ELC50PD
07138      MOVE PB-CERT-SFX               TO CM-CERT-SFX.               ELC50PD
07139      MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.            ELC50PD
07140                                                                   ELC50PD
07141      MOVE CM-CERT-NO                TO CM-CERT-NO-A4.             ELC50PD
07142                                                                   ELC50PD
07143      MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.      ELC50PD
07144      MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.      ELC50PD
07145      MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.     ELC50PD
07146      MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.    ELC50PD
07147                                                                   ELC50PD
07148      IF PB-I-SOC-SEC-NO EQUAL '000000000  '                       ELC50PD
07149         MOVE ZEROS                   TO PB-I-SOC-SEC-NO.          ELC50PD
07150                                                                   ELC50PD
07151      IF PB-I-SOC-SEC-NO   = SPACES OR ZERO                        ELC50PD
07152          MOVE PB-SV-STATE            TO CM-SSN-STATE              ELC50PD
07153          MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT            ELC50PD
07154          MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2      ELC50PD
07155          MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2    ELC50PD
07156      ELSE                                                         ELC50PD
07157          MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.            ELC50PD
07158                                                                   ELC50PD
07159      IF PB-COMPANY-ID   EQUAL  'CRI'                              ELC50PD
07160          MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME         ELC50PD
07161          MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD            ELC50PD
07162          MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME          ELC50PD
07163          MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL            ELC50PD
07164          MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.           ELC50PD
07165                                                                   ELC50PD
07166      IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND                  ELC50PD
07167         (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
07168          MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.   ELC50PD
07169                                                                   ELC50PD
07170      IF PB-COMPANY-ID  = 'LBL'                                    ELC50PD
07171         IF PB-I-JOINT-COVERAGE                                    ELC50PD
07172             MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO           ELC50PD
07173                                            PB-I-MEMBER-NO         ELC50PD
07174             GO TO 4550-CONT-CERT-PROCESS.                         ELC50PD
07175                                                                   ELC50PD
07176      IF PB-COMPANY-ID  = 'MON' OR 'PEM'                           ELC50PD
07177         NEXT SENTENCE                                             ELC50PD
07178      ELSE                                                         ELC50PD
07179         GO TO 4540-BUILD-MEMBER-NO.                               ELC50PD
07180                                                                   ELC50PD
07181 ******************************************************************ELC50PD
07182 *                                                                *ELC50PD
07183 *    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *ELC50PD
07184 *    FOR 'MON'.                                                  *ELC50PD
07185 *                                                                *ELC50PD
07186 ******************************************************************ELC50PD
07187                                                                   ELC50PD
07188      MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.                 ELC50PD
07189      MOVE SPACES                 TO WS-WORK-MEMB-NAME.            ELC50PD
07190      MOVE +1                     TO WS-SUB1                       ELC50PD
07191                                     WS-SUB2.                      ELC50PD
07192                                                                   ELC50PD
07193  4530-EDIT-MEMB-NAME.                                             ELC50PD
07194                                                                   ELC50PD
07195      IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO       ELC50PD
07196         MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)  ELC50PD
07197         ADD +1                       TO WS-SUB2.                  ELC50PD
07198                                                                   ELC50PD
07199      IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7            ELC50PD
07200         ADD +1                       TO WS-SUB1                   ELC50PD
07201         GO TO 4530-EDIT-MEMB-NAME.                                ELC50PD
07202                                                                   ELC50PD
07203      MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.          ELC50PD
07204      MOVE PB-SV-STATE                TO CM-MEMB-STATE.            ELC50PD
07205      MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.            ELC50PD
07206 *    MOVE SPACE                      TO DC-OPTION-CODE.           ELC50PD
07207      SET  BIN-TO-GREG                TO TRUE.                     ELC50PD
07208      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
07209      MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.              ELC50PD
07210                                                                   ELC50PD
07211      GO TO 4550-CONT-CERT-PROCESS.                                ELC50PD
07212                                                                   ELC50PD
07213 ******************************************************************ELC50PD
07214 *    END FOR 'MON' CODE FOR MEMBER NO.                           *ELC50PD
07215 ******************************************************************ELC50PD
07216                                                                   ELC50PD
07217  4540-BUILD-MEMBER-NO.                                            ELC50PD
07218                                                                   ELC50PD
07219      IF PB-I-MEMBER-NO  = SPACES OR ZERO                          ELC50PD
07220          MOVE PB-SV-STATE            TO CM-MEMB-STATE             ELC50PD
07221          MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT           ELC50PD
07222          MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5      ELC50PD
07223          MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5    ELC50PD
07224      ELSE                                                         ELC50PD
07225          MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.             ELC50PD
07226                                                                   ELC50PD
07227      IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND                    ELC50PD
07228         (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
07229          MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.   ELC50PD
07230                                                                   ELC50PD
07231  4550-CONT-CERT-PROCESS.                                          ELC50PD
07232                                                                   ELC50PD
07233 *    IF PB-I-MICROFILM-NO  NOT NUMERIC                            ELC50PD
07234 *        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO          ELC50PD
07235 *    ELSE                                                         ELC50PD
07236 *        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.         ELC50PD
07237                                                                   ELC50PD
07238      IF CERT-WAS-CREATED-FOR-CLAIM                                ELC50PD
07239         MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
07240         MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.   ELC50PD
07241                                                                   ELC50PD
07242      IF CERT-AND-CLAIM-ONLINE                                     ELC50PD
07243         MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
07244         MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.  ELC50PD
07245                                                                   ELC50PD
07246      MOVE 'CM'                     TO CM-RECORD-ID.               ELC50PD
07247      MOVE LOW-VALUES               TO CM-STATUS-DATA.             ELC50PD
07248                                                                   ELC50PD
07249      IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE             ELC50PD
07250         MOVE '1'                     TO CM-CLAIM-INTERFACE-SW     ELC50PD
07251         MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT   ELC50PD
07252      ELSE                                                         ELC50PD
07253         MOVE SPACE                TO CM-CLAIM-INTERFACE-SW        ELC50PD
07254         MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.     ELC50PD
07255                                                                   ELC50PD
07256      MOVE ZERO                     TO CM-LOAN-BALANCE.            ELC50PD
07257      MOVE '1'                      TO CM-PREMIUM-TYPE.            ELC50PD
07258      MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.       ELC50PD
07259      MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.       ELC50PD
07260      MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.      ELC50PD
07261      MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.             ELC50PD
07262      MOVE ZEROS                    TO CM-LF-REMAINING-AMT         ELC50PD
07263                                       CM-LF-ITD-CANCEL-AMT        ELC50PD
07264                                       CM-LF-ITD-DEATH-AMT         ELC50PD
07265                                       CM-AH-ITD-AH-PMT            ELC50PD
07266                                       CM-AH-ITD-LUMP-PMT          ELC50PD
07267                                       CM-AH-ITD-CANCEL-AMT        ELC50PD
07268                                       CM-LF-NSP-PREMIUM-AMT       ELC50PD
07269                                       CM-AH-NSP-PREMIUM-AMT.      ELC50PD
020906*                                     CM-CLAIM-DEDUCT-WITHHELD    ELC50PD
020906*                                     CM-CANCEL-DEDUCT-WITHHELD.  ELC50PD
07272      MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.                ELC50PD
07273      MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.           ELC50PD
07274      MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.              ELC50PD
07275      MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.                ELC50PD
07276      MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.             ELC50PD
07277      MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.             ELC50PD
07278      MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.              ELC50PD
07279      MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.              ELC50PD
07280      MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.           ELC50PD
07281      MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.             ELC50PD
07282      MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.               ELC50PD
07283      MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.         ELC50PD
07284                                                                   ELC50PD
07285      IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
07286          MOVE ZERO                 TO PB-I-LIVES.                 ELC50PD
07287                                                                   ELC50PD
07288      IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
07289          MOVE ZERO                 TO PB-I-NUM-BILLED.            ELC50PD
07290                                                                   ELC50PD
07291      MOVE PB-I-LIVES               TO CM-LIVES.                   ELC50PD
07292      MOVE PB-I-NUM-BILLED          TO CM-BILLED.                  ELC50PD
07293                                                                   ELC50PD
07294      IF PB-COMPANY-ID EQUAL  'DMD'                                ELC50PD
07295          MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE       ELC50PD
07296          MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.           ELC50PD
07297                                                                   ELC50PD
07298      MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.           ELC50PD
07299      MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.            ELC50PD
07300      MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.      ELC50PD
07301      MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.          ELC50PD
07302      MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.      ELC50PD
011410     MOVE PB-I-LF-CLP              TO CM-LF-CLP
07303                                                                   ELC50PD
07304      IF PB-I-LF-POLICY-FEE NUMERIC                                ELC50PD
07305         MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE            ELC50PD
07306      ELSE                                                         ELC50PD
07307         MOVE +0                    TO CM-LF-POLICY-FEE.           ELC50PD
07308                                                                   ELC50PD
07309      IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
07310         MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT           ELC50PD
07311         MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT       ELC50PD
07312      ELSE                                                         ELC50PD
07313         MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.          ELC50PD
07314                                                                   ELC50PD
07315      MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.        ELC50PD
07316      MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.    ELC50PD
07317      MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.        ELC50PD
07318      MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.      ELC50PD
07319      MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.       ELC50PD
07320      MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.           ELC50PD
07321      MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.            ELC50PD
07322      MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.          ELC50PD
011410     MOVE PB-I-AH-CLP              TO CM-AH-CLP
07323                                                                   ELC50PD
07324      IF PB-I-AH-POLICY-FEE NUMERIC                                ELC50PD
07325         MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE            ELC50PD
07326      ELSE                                                         ELC50PD
07327         MOVE +0                    TO CM-AH-POLICY-FEE.           ELC50PD
07328                                                                   ELC50PD
07329      IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
07330         MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT           ELC50PD
07331      ELSE                                                         ELC50PD
07332         MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.          ELC50PD
07333                                                                   ELC50PD
07334      MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.      ELC50PD
07335      MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.       ELC50PD
07336                                                                   ELC50PD
07337      MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT          ELC50PD
07338                                       CM-LF-DEATH-EXIT-DT         ELC50PD
07339                                       CM-AH-SETTLEMENT-EXIT-DT.   ELC50PD
07340                                                                   ELC50PD
07341 *    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR                ELC50PD
07342 *                       'TIH' OR 'OFL' OR 'FLA' OR                ELC50PD
07343 *                       'TII' OR 'TMS' OR 'CRI' OR                ELC50PD
07344 *                       'NCL'                                     ELC50PD
102706     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
07346                                                                   ELC50PD
07347      IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND                 ELC50PD
07348          IF WS-LF-SPECIAL-CALC-CD = 'O'                           ELC50PD
07349             MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
07350                                                                   ELC50PD
07351      IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND                   ELC50PD
07352          IF WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
07353             MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
07354                                                                   ELC50PD
07355      IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
07356          MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS         ELC50PD
07357      ELSE                                                         ELC50PD
07358          MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS         ELC50PD
07359          MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.     ELC50PD
07360                                                                   ELC50PD
07361      MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.           ELC50PD
07362      MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.           ELC50PD
07363      MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.         ELC50PD
07364      MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.            ELC50PD
07365      MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.            ELC50PD
07366      MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.             ELC50PD
07367      MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.      ELC50PD
07368      MOVE SPACE                     TO CM-PAYMENT-MODE.           ELC50PD
07369                                                                   ELC50PD
07370      IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
07371          MOVE SPACE                 TO CM-SKIP-CODE               ELC50PD
07372      ELSE                                                         ELC50PD
07373          MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.              ELC50PD
07374                                                                   ELC50PD
07375      MOVE '2'                       TO CM-LF-CURRENT-STATUS.      ELC50PD
07376      MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH      ELC50PD
07377                                        CM-LF-STATUS-AT-CANCEL.    ELC50PD
07378                                                                   ELC50PD
07379      MOVE '2'                       TO CM-AH-CURRENT-STATUS.      ELC50PD
07380      MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT ELC50PD
07381                                        CM-AH-STATUS-AT-CANCEL.    ELC50PD
07382                                                                   ELC50PD
07383      MOVE '1'                       TO CM-ENTRY-STATUS.           ELC50PD
07384                                                                   ELC50PD
07385      IF PB-REISSUED-CERT                                          ELC50PD
07386         MOVE '5'                    TO CM-ENTRY-STATUS.           ELC50PD
07387                                                                   ELC50PD
122002     IF PB-MONTHLY-CERT                                           ELC50PD
122002        MOVE 'M'                    TO CM-ENTRY-STATUS.           ELC50PD
122002                                                                  ELC50PD
040504     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
061405     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
07388      IF PB-POLICY-IS-DECLINED                                     ELC50PD
07389         MOVE 'D'                    TO CM-ENTRY-STATUS.           ELC50PD
07390                                                                   ELC50PD
07391      IF PB-POLICY-IS-VOIDED                                       ELC50PD
07392         MOVE 'V'                    TO CM-ENTRY-STATUS.           ELC50PD
07393                                                                   ELC50PD
07394      IF PB-NEEDS-UNDERWRITING                                     ELC50PD
07395         MOVE 'U'                    TO CM-ENTRY-STATUS.           ELC50PD
07396                                                                   ELC50PD
07397      IF PB-REIN-ONLY-CERT                                         ELC50PD
07398         MOVE '9'                    TO CM-ENTRY-STATUS.           ELC50PD
07399                                                                   ELC50PD
07400      IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'                  ELC50PD
07401          MOVE 'Y'                   TO CM-UNDERWRITING-CODE       ELC50PD
07402      ELSE                                                         ELC50PD
07403          MOVE SPACE                 TO CM-UNDERWRITING-CODE.      ELC50PD
07404                                                                   ELC50PD
07405      IF PB-RECORD-RETURNED                                        ELC50PD
07406         MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1   ELC50PD
07407       ELSE                                                        ELC50PD
07408         MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.  ELC50PD
07409                                                                   ELC50PD
07410      IF PB-I-MAIL-ADDRS-PRESENT                                   ELC50PD
07411         MOVE '1'                    TO CM-INSURED-ADDRESS-SW.     ELC50PD
07412                                                                   ELC50PD
07413      MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END          ELC50PD
07414                                        CM-ENTRY-DT.               ELC50PD
07415                                                                   ELC50PD
07416  4999-EXIT.                                                       ELC50PD
07417      EXIT.                                                        ELC50PD
07418      EJECT                                                        ELC50PD
07419                                                                   ELC50PD
       5000-PROCESS-REPS.
       
           MOVE ' '                    TO AGTC-MASTER-SW
           MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
           MOVE CO-TYPE                TO AGTC-TYPE
           MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
           PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT

           IF (AGTC-MASTER-SW NOT = 'N')
              AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
              AND (PB-CERT-EFF-DT = AG-EXP-DT)
              PERFORM 8583-READ-ERAGTC-NEXT
                                       THRU 8583-EXIT
           END-IF
              
           IF AGTC-MASTER-SW = 'N'
              CONTINUE
           ELSE
              IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
                 IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
                    AND (PB-CERT-EFF-DT < AG-EXP-DT)
                    MOVE 'Y'           TO AGTC-MASTER-SW
                 END-IF
              END-IF
           END-IF

           .
       5000-EXIT.
           EXIT.
           

07420  6370-EDIT-INPUT-LF-CODE.                                         ELC50PD
07421      IF WK-LIFE-EDIT-ADDR NOT = ZEROS                             ELC50PD
07422         MOVE +1                  TO SUB                           ELC50PD
07423         MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP                ELC50PD
07424         SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
07425         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
07426         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
07427         GO TO 6370-SEARCH-LOOP.                                   ELC50PD
07428                                                                   ELC50PD
07429      PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
07430                                                                   ELC50PD
07431      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
07432      MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
07433 *    MOVE 'L'                    TO CNTL-REC-TYPE.                ELC50PD
07434      MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.                ELC50PD
07435      MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
07436      MOVE '4' TO RC-SW-2.                                         ELC50PD
07437      PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
07438                                                                   ELC50PD
07439      IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
07440         CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
07441         GO TO 6370-NO-LF-FOUND.                                   ELC50PD
07442                                                                   ELC50PD
07443      MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.            ELC50PD
07444      MOVE +1                     TO SUB.                          ELC50PD
07445                                                                   ELC50PD
07446  6370-SEARCH-LOOP.                                                ELC50PD
07447      IF CF-LIFE-CODE-OUT (SUB) = ZEROS                            ELC50PD
07448          GO TO 6370-NO-LF-FOUND.                                  ELC50PD
07449                                                                   ELC50PD
07450      IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)                  ELC50PD
07451          MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD        ELC50PD
07452          GO TO 6370-HER-NET-PAY-CHECK.                            ELC50PD
07453                                                                   ELC50PD
07454      ADD 1   TO SUB.                                              ELC50PD
CIDMOD*    IF SUB GREATER 120                                           ELC50PD
CIDMOD     IF SUB GREATER 200                                           ELC50PD
07456          GO TO 6370-NO-LF-FOUND.                                  ELC50PD
07457                                                                   ELC50PD
07458      GO TO 6370-SEARCH-LOOP.                                      ELC50PD
07459                                                                   ELC50PD
07460  6370-NO-LF-FOUND.                                                ELC50PD
07461                                                                   ELC50PD
07462      MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.           ELC50PD
07463                                                                   ELC50PD
07464  6370-HER-NET-PAY-CHECK.                                          ELC50PD
07465                                                                   ELC50PD
CIDMOD     IF PB-COMPANY-ID = 'CID'
CIDMOD        IF PB-SV-STATE = 'CA' OR 'MN'
CIDMOD           IF PB-I-LF-BENEFIT-CD = '02'
CIDMOD              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
CIDMOD           ELSE
CIDMOD              IF PB-I-LF-BENEFIT-CD = '04'
CIDMOD                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
CIDMOD              END-IF
CIDMOD           END-IF
CIDMOD        END-IF
CIDMOD     END-IF
CIDMOD
07466      IF PB-COMPANY-ID NOT = 'HER'                                 ELC50PD
07467          GO TO 6370-EXIT.                                         ELC50PD
07468                                                                   ELC50PD
07469      IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'                  ELC50PD
07470          GO TO 6370-EXIT.                                         ELC50PD
07471                                                                   ELC50PD
07472      IF PB-I-LF-TERM NOT NUMERIC                                  ELC50PD
07473          MOVE ZEROS              TO PB-I-LF-TERM.                 ELC50PD
07474                                                                   ELC50PD
07475      IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
07476          MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
07477                                                                   ELC50PD
07478      IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM                  ELC50PD
07479          GO TO 6370-EXIT.                                         ELC50PD
07480                                                                   ELC50PD
07481      IF PB-I-LF-BENEFIT-CD = '33'                                 ELC50PD
07482          MOVE '31'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
07483                                                                   ELC50PD
07484      IF PB-I-LF-BENEFIT-CD = '34'                                 ELC50PD
07485          MOVE '32'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
07486                                                                   ELC50PD
07487  6370-EXIT.                                                       ELC50PD
07488      EXIT.                                                        ELC50PD
07489      EJECT                                                        ELC50PD
07490                                                                   ELC50PD
07491  6380-EDIT-INPUT-AH-CODE.                                         ELC50PD
07492      IF WK-AH-EDIT-ADDR NOT = ZEROS                               ELC50PD
07493         MOVE +1                  TO SUB                           ELC50PD
07494         MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP                ELC50PD
07495         SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
07496         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
07497         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
07498         GO TO 6380-SEARCH-LOOP.                                   ELC50PD
07499                                                                   ELC50PD
07500      PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
07501                                                                   ELC50PD
07502      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
07503      MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
07504      MOVE 'A'                    TO CNTL-REC-TYPE.                ELC50PD
07505 *    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.                ELC50PD
07506      MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
07507      MOVE '5' TO RC-SW-2.                                         ELC50PD
07508      PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
07509                                                                   ELC50PD
07510      IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
07511         CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
07512         GO TO 6380-NO-AH-FOUND.                                   ELC50PD
07513                                                                   ELC50PD
07514      MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.              ELC50PD
07515      MOVE +1 TO SUB.                                              ELC50PD
07516                                                                   ELC50PD
07517  6380-SEARCH-LOOP.                                                ELC50PD
07518      IF CF-AH-CODE-OUT (SUB) = ZEROS                              ELC50PD
07519          GO TO 6380-NO-AH-FOUND.                                  ELC50PD
07520                                                                   ELC50PD
07521      IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)                    ELC50PD
07522          MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD          ELC50PD
07523          GO TO 6380-CSO-AH-ONLY-CHECKS.                           ELC50PD
07524                                                                   ELC50PD
07525      ADD 1   TO SUB.                                              ELC50PD
100703     IF SUB GREATER THAN 96                                       ELC50PD
CIDMOD*    IF SUB GREATER THAN 300                                      ELC50PD
07527          GO TO 6380-NO-AH-FOUND.                                  ELC50PD
07528                                                                   ELC50PD
07529      GO TO 6380-SEARCH-LOOP.                                      ELC50PD
07530                                                                   ELC50PD
07531  6380-NO-AH-FOUND.                                                ELC50PD
07532                                                                   ELC50PD
07533      MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.               ELC50PD
07534                                                                   ELC50PD
07535      IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE                        ELC50PD
07536          MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD            ELC50PD
07537      ELSE                                                         ELC50PD
07538          MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.           ELC50PD
07539                                                                   ELC50PD
07540  6380-CSO-AH-ONLY-CHECKS.                                         ELC50PD
07541                                                                   ELC50PD
CIDMOD     IF PB-COMPANY-ID = 'CSO' OR 'CID'                            ELC50PD
CIDMOD        NEXT SENTENCE                                             ELC50PD
CIDMOD      ELSE                                                        ELC50PD
07543         GO TO 6380-EXIT.                                          ELC50PD
07544                                                                   ELC50PD
07545      IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS                 ELC50PD
07546          GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.                      ELC50PD
07547                                                                   ELC50PD
CIDMOD                                                                  00041198
CIDMOD     GO TO 6380-EXIT                                              00041198
CIDMOD     .
CIDMOD 6380-CSO-LIFE-WITH-AH-CHECKS.                                    00041202
CIDMOD                                                                  00041203
CIDMOD                                                                  ELC50PD
CIDMOD     .                                                            ELC50PD
07570  6380-EXIT.                                                       ELC50PD
07571      EXIT.                                                        ELC50PD
07572                                                                   ELC50PD
07573      EJECT                                                        ELC50PD
07574                                                                   ELC50PD
07575  6400-COMPUTE-EXTENSION-DAYS.                                     ELC50PD
07576                                                                   ELC50PD
07577 ******************************************************************ELC50PD
07578 *                                                                *ELC50PD
07579 *                   COMPUTE EXTENSION DAYS                       *ELC50PD
07580 *                                                                *ELC50PD
07581 *    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *ELC50PD
07582 *    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *ELC50PD
07583 *    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *ELC50PD
07584 *    THE EXTENSION DAYS.                                         *ELC50PD
07585 *                                                                *ELC50PD
07586 ******************************************************************ELC50PD
07587                                                                   ELC50PD
07588      MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.            ELC50PD
07589      MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.            ELC50PD
07590                                                                   ELC50PD
07591 ******************************************************************ELC50PD
07592 *    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *ELC50PD
07593 *       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*ELC50PD
07594 ******************************************************************ELC50PD
07595                                                                   ELC50PD
07596      IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELC50PD
07597         COMPUTE WS-ODD-DAYS-OVER =                                ELC50PD
07598                ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER  ELC50PD
07599      ELSE                                                         ELC50PD
07600         MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.             ELC50PD
07601                                                                   ELC50PD
07602      IF WS-ODD-DAYS-OVER = ZEROS                                  ELC50PD
07603            GO TO 6499-EXIT                                        ELC50PD
07604      ELSE                                                         ELC50PD
07605         IF WS-WDF-DAY GREATER THAN WS-WDT-DAY                     ELC50PD
07606            IF WS-WDF-MONTH = 02                                   ELC50PD
07607               PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT         ELC50PD
07608               ADD 2       TO  WS-ODD-DAYS-OVER                    ELC50PD
07609               GO TO 6499-EXIT                                     ELC50PD
07610            ELSE                                                   ELC50PD
07611               IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31    ELC50PD
07612                  SUBTRACT 1 FROM WS-ODD-DAYS-OVER                 ELC50PD
07613                  GO TO 6499-EXIT                                  ELC50PD
07614                ELSE                                               ELC50PD
07615                  GO TO 6499-EXIT                                  ELC50PD
07616         ELSE                                                      ELC50PD
07617            GO TO 6499-EXIT.                                       ELC50PD
07618                                                                   ELC50PD
07619  6412-CHECK-TO-DAY.                                               ELC50PD
07620                                                                   ELC50PD
07621         IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0         ELC50PD
07622            IF WS-WDT-DAY = 28                                     ELC50PD
07623               ADD 2              TO WS-ODD-DAYS-OVER              ELC50PD
07624            ELSE                                                   ELC50PD
07625               IF WS-WDT-DAY = 29                                  ELC50PD
07626                  ADD 1           TO WS-ODD-DAYS-OVER              ELC50PD
07627               ELSE                                                ELC50PD
07628                  NEXT SENTENCE                                    ELC50PD
07629         ELSE                                                      ELC50PD
07630            IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0        ELC50PD
07631               SUBTRACT 1         FROM WS-ODD-DAYS-OVER.           ELC50PD
07632                                                                   ELC50PD
07633      GO TO 6499-EXIT.                                             ELC50PD
07634                                                                   ELC50PD
07635                                                                   ELC50PD
07636  6415-CHECK-LEAP-YEAR.                                            ELC50PD
07637                                                                   ELC50PD
07638      IF DC-DAYS-IN-MONTH = 29                                     ELC50PD
07639         SUBTRACT 1 FROM WS-ODD-DAYS-OVER.                         ELC50PD
07640                                                                   ELC50PD
07641  6415-EXIT.                                                       ELC50PD
07642      EXIT.                                                        ELC50PD
07643                                                                   ELC50PD
07644  6499-EXIT.                                                       ELC50PD
07645       EXIT.                                                       ELC50PD
07646                                                                   ELC50PD
07647  6500-END.                                                        ELC50PD
CIDVAO     EXIT.
CIDVAO
07648                                                                   ELC50PD
07649 ******************************************************************ELC50PD
07650 ************* PROCEDURE DIVISION FOR EL050 ***********************ELC50PD
07651 ********************** ELC50PD END *******************************ELC50PD
07652                                                                   ELC50PD
