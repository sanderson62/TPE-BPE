CIDMOD* 11-16-98: JJPA -  ADDED CODE TO FIX Y2K ERROR -
CIDMOD* 11-16-98: JJPA -  MOVE CCYY TO DC-EDITB-CENT/-YEAR
00001 ******************************************************************05/26/98
00002 *                                                                *ELCDATP2
00002 *                                                                *ELCDATP2
00003 *                            ELCDATP2.                           *   LV078
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
00005 *                            VMOD=2.005                          *ELCDATP2
00006 *                                                                *ELCDATP2
00007 *                       DATE CONVERSION ROUTINE                  *ELCDATP2
00008 *                                                                *ELCDATP2
00009 ******************************************************************ELCDATP2
00010                                                                   ELCDATP2
00011      IF BIN-PLUS-ELAPSED  OR                                      ELCDATP2
00012         BIN-PLUS-ELAPSED-3                                           CL**9
00013          COMPUTE WS-BINARY-DATE-2 = (((YEAR1 * 12) +              ELCDATP2
00014                                     (MONTH1 - 1)) * 32) + DAY1    ELCDATP2
00015          MOVE WS-BINARY-DATE-2   TO  BIN-DATE                     ELCDATP2
00016          MOVE BIN-DATE-WORK      TO  DC-BIN-DATE-2                ELCDATP2
00017          MOVE BIN-DATE-3-WORK    TO  DC-BIN-DATE-EXPAND-2         ELCDATP2
00018      ELSE                                                         ELCDATP2
00019          COMPUTE WS-BINARY-DATE-1 = (((YEAR1 * 12) +              ELCDATP2
00020                                     (MONTH1 - 1)) * 32) + DAY1    ELCDATP2
00021          MOVE WS-BINARY-DATE-1   TO  BIN-DATE                     ELCDATP2
00022          MOVE BIN-DATE-WORK      TO  DC-BIN-DATE-1                ELCDATP2
00023          MOVE BIN-DATE-3-WORK    TO  DC-BIN-DATE-EXPAND-1.           CL**9
00024                                                                   ELCDATP2
00025      SET MTHX TO MONTH1.                                          ELCDATP2
00026                                                                   ELCDATP2
CIDMOD*    MOVE GREG-ALPHA-MASK        TO  DC-GREG-DATE-1-ALPHA.        ELCDATP2
00028                                                                   ELCDATP2
00029      MOVE '/'                    TO  SLASH1-1  SLASH1-2           ELCDATP2
00030                                      SLASH2-1  SLASH2-2           ELCDATP2
00031                                      SLASHA-1  SLASHA-2           ELCDATP2
00032                                      SLASHB-1  SLASHB-2.          ELCDATP2
00033                                                                   ELCDATP2
00034      EVALUATE TRUE                                                   CL*73
00035         WHEN ADJUST-DOWN-100-YRS                                     CL*73
00036            IF CURRENT-CENTURY-1-N = 19                               CL*73
00037               MOVE 19               TO DC-ALPHA-CEN-N                CL*78
00038            ELSE                                                      CL*73
00039               MOVE PREVIOUS-CENTURY TO DC-ALPHA-CEN-N                CL*73
00040            END-IF                                                    CL*73
00041         WHEN ADJUST-UP-100-YRS                                       CL*73
00042            MOVE NEXT-CENTURY TO DC-ALPHA-CEN-N                       CL*73
00043         WHEN DC-ALPHA-CEN-N > 0                                      CL*73
00044            CONTINUE                                                  CL*73
00045         WHEN OTHER                                                   CL*73
00046            MOVE 3 TO FIND-CENTURY-FLAG                               CL*73
00047            PERFORM 0800-FIND-CENTURY                                 CL*73
00048      END-EVALUATE.                                                   CL*73
00049                                                                   ELCDATP2
00050      MOVE MONTH1                TO DC-EDIT1-MONTH                    CL**9
00051                                    DC-YMD-MONTH                      CL**9
00052                                    DC-MDY-MONTH                      CL**9
00053                                    DC-CYMD-MONTH                     CL**9
00054                                    DC-MDCY-MONTH                     CL**9
00055                                    DC-EDITA-MONTH                    CL**9
00056                                    DC-EDITB-MONTH.                   CL**9
00057                                                                   ELCDATP2
00058      MOVE NAME-OF-MONTH (MTHX)  TO DC-ALPHA-MONTH.                   CL**9
00059                                                                   ELCDATP2
00060      MOVE DAYS-IN-MONTH (MTHX)  TO DC-DAYS-IN-MONTH.                 CL**9
00061                                                                   ELCDATP2
00062      MOVE DAY1                  TO DC-EDIT1-DAY                      CL**9
00063                                    DC-YMD-DAY                        CL**9
00064                                    DC-MDY-DAY                        CL**9
00065                                    DC-CYMD-DAY                       CL**9
00066                                    DC-MDCY-DAY                       CL**9
00067                                    DC-ALPHA-DAY                      CL**9
00068                                    DC-EDITA-DAY                      CL**9
00069                                    DC-EDITB-DAY.                     CL**9
00070                                                                   ELCDATP2
00071      MOVE YEAR1                 TO DC-EDIT1-YEAR                     CL**9
00072                                    DC-YMD-YEAR                       CL**9
00073                                    DC-MDY-YEAR                       CL**9
00074                                    DC-CYMD-YEAR                      CL**9
00075                                    DC-MDCY-YEAR                      CL**9
00076                                    DC-ALPHA-YEAR                     CL**9
CIDMOD                                   DC-EDITA-YEAR                     CL**9
CIDMOD                                   DC-EDITB-YEAR.                    CL**9
00078                                                                   ELCDATP2
00079      MOVE DC-ALPHA-CEN-N        TO DC-EDITA-CENT                     CL**9
CIDMOD                                   DC-EDITB-CENT                     CL**9
00080                                    DC-CYMD-CEN                       CL**9
00081                                    DC-MDCY-CEN.                      CL**9
00082                                                                   ELCDATP2
00083      IF JULIAN-TO-BIN                                             ELCDATP2
00084          MOVE WORK-JULIAN-1     TO WORK-JULIAN                       CL**9
00085          PERFORM 0250-CALCULATE-DAY-OF-WEEK                       ELCDATP2
00086          MOVE DAY-OF-WEEK-X     TO DC-DAY-OF-WEEK                    CL**9
00087          GO TO 0200-EXIT.                                         ELCDATP2
00088                                                                   ELCDATP2
00089      MOVE YEAR1                 TO JULIAN-YEAR1.                     CL**9
00090                                                                   ELCDATP2
00091      IF A-LEAP-YEAR                                               ELCDATP2
00092          MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY1                  ELCDATP2
00093        ELSE                                                       ELCDATP2
00094          MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY1.                 ELCDATP2
00095                                                                   ELCDATP2
00096      ADD DAY1 TO JULIAN-DAY1.                                     ELCDATP2
00097                                                                   ELCDATP2
00098      MOVE JULIAN-YEAR1           TO DC-JULIAN-YEAR                   CL**9
00099                                     DC-JULIAN-1-YR.                  CL**9
00100      MOVE JULIAN-DAY1            TO DC-JULIAN-DAYS                   CL**9
00101                                     DC-JULIAN-DA-1.                  CL**9
00102      MOVE DC-ALPHA-CEN-N         TO DC-JULIAN-1-CC.                  CL**9
00103                                                                   ELCDATP2
00104                                                                   ELCDATP2
00105      MOVE WORK-JULIAN-1          TO WORK-JULIAN.                     CL**9
00106      PERFORM 0250-CALCULATE-DAY-OF-WEEK.                          ELCDATP2
00107      MOVE DAY-OF-WEEK-X          TO DC-DAY-OF-WEEK.                  CL**9
00108                                                                   ELCDATP2
00109      IF ELAPSED-BETWEEN-BIN OR                                       CL**9
00110         ELAPSED-BETWEEN-BIN-3                                        CL**9
00111          MOVE YEAR2              TO YR-2                             CL**9
00112          MOVE MONTH2             TO DC-EDIT2-MONTH                   CL**9
00113          MOVE DAY2               TO DC-EDIT2-DAY                     CL**9
00114          MOVE YEAR2-YR           TO DC-EDIT2-YEAR                    CL**9
00115                                     DC-EDITB-YEAR                    CL**9
00116          MOVE YEAR2-CEN-CD       TO SEARCH-CENTURY-CD-N              CL**9
00117          MOVE 1                  TO FIND-CENTURY-FLAG                CL**9
00118          PERFORM 0800-FIND-CENTURY                                ELCDATP2
00119          IF NO-CONVERSION-ERROR                                   ELCDATP2
00120             MOVE FOUND-CENTURY-N TO DC-EDITB-CENT                 ELCDATP2
00121          ELSE                                                     ELCDATP2
00122             GO TO 0200-EXIT                                       ELCDATP2
00123          END-IF                                                   ELCDATP2
00124          PERFORM 0600-ELAPSED-TIME-CALCULATIONS.                  ELCDATP2
00125                                                                   ELCDATP2
00126      IF ELAPSED-BETWEEN-BIN   OR                                     CL**9
00127         ELAPSED-BETWEEN-BIN-3 OR                                     CL**9
00128         BIN-PLUS-ELAPSED      OR                                     CL**9
00129         BIN-PLUS-ELAPSED-3                                           CL**9
00130          MOVE WORK-JULIAN-2      TO WORK-JULIAN                      CL**9
00131          PERFORM 0250-CALCULATE-DAY-OF-WEEK                       ELCDATP2
00132          MOVE DAY-OF-WEEK-X      TO DC-DAY-OF-WEEK2                  CL**9
00133        ELSE                                                       ELCDATP2
00134          MOVE ZERO               TO DC-DAY-OF-WEEK2.                 CL**9
00135                                                                   ELCDATP2
00136  0200-EXIT.                                                       ELCDATP2
00137      EXIT.                                                        ELCDATP2
00138                                                                   ELCDATP2
00139      EJECT                                                        ELCDATP2
00140  0250-CALCULATE-DAY-OF-WEEK SECTION.                              ELCDATP2
00141                                                                   ELCDATP2
00142      COMPUTE WS-DAY-OF-CENTURY =                                  ELCDATP2
00143              (JULIAN-YEAR * +365.25) + JULIAN-DAY.                ELCDATP2
00144                                                                   ELCDATP2
00145      DIVIDE WS-DAY-OF-CENTURY BY +7 GIVING DIVIDE-RESULT          ELCDATP2
00146              REMAINDER DAY-OF-WEEK-X.                             ELCDATP2
00147                                                                   ELCDATP2
00148      MOVE JULIAN-YEAR        TO  CHECK-YEAR.                      ELCDATP2
00149                                                                   ELCDATP2
00150      PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
00151                                                                   ELCDATP2
00152      IF NOT A-LEAP-YEAR                                           ELCDATP2
00153          ADD +1  TO  DAY-OF-WEEK-X                                ELCDATP2
00154        ELSE                                                       ELCDATP2
00155          IF DAY-OF-WEEK-X NOT > ZERO                                 CL**9
00156              MOVE +7  TO  DAY-OF-WEEK-X.                          ELCDATP2
00157                                                                   ELCDATP2
00158  0250-EXIT.                                                       ELCDATP2
00159      EXIT.                                                        ELCDATP2
00160                                                                   ELCDATP2
00161      EJECT                                                        ELCDATP2
00162  0300-REFORMAT-BINARY-DAYS SECTION.                               ELCDATP2
00163                                                                   ELCDATP2
00164      MOVE '00/00/00'             TO  DC-GREG-DATE-1-EDIT          ELCDATP2
00165                                      DC-GREG-DATE-2-EDIT.         ELCDATP2
00166      MOVE '00/00/0000'           TO  DC-GREG-DATE-A-EDIT          ELCDATP2
00167                                      DC-GREG-DATE-B-EDIT.         ELCDATP2
00168                                                                   ELCDATP2
00169      MOVE ZERO                   TO  DC-GREG-DATE-1-YMD           ELCDATP2
00170                                      DC-GREG-DATE-1-MDY           ELCDATP2
00171                                      DC-GREG-DATE-CYMD               CL**5
00172                                      DC-GREG-DATE-MDCY               CL**5
00173                                      DC-JULIAN-DATE               ELCDATP2
00174                                      DC-ELAPSED-MONTHS            ELCDATP2
00175                                      DC-ODD-DAYS-OVER             ELCDATP2
00176                                      DC-ELAPSED-DAYS              ELCDATP2
00177                                      DC-DAY-OF-WEEK               ELCDATP2
00178                                      DC-DAY-OF-WEEK2.             ELCDATP2
00179                                                                   ELCDATP2
00180      IF (ELAPSED-BETWEEN-BIN AND                                     CL**9
00181          WS-BINARY-DATE-1 > WS-BINARY-DATE-2)                        CL**9
00182                     OR                                               CL**9
00183         (ELAPSED-BETWEEN-BIN-3 AND                                   CL**9
00184          WS-BINARY-DATE-1 > WS-BINARY-DATE-2)                        CL**9
00185            MOVE '4'               TO DC-ERROR-CODE                   CL**9
00186            GO TO 0300-EXIT.                                          CL**9
00187                                                                   ELCDATP2
00188      IF WS-BINARY-DATE-1 = ZERO                                   ELCDATP2
00189          MOVE '1'                TO DC-ERROR-CODE                 ELCDATP2
00190          MOVE ZERO               TO DC-GREG-DATE-1-EDIT              CL**9
00191          GO TO 0300-EXIT.                                         ELCDATP2
00192                                                                   ELCDATP2
00193      DIVIDE WS-BINARY-DATE-1 BY +384 GIVING YEAR1                 ELCDATP2
00194                REMAINDER DAYS-REMAINING.                          ELCDATP2
00195                                                                   ELCDATP2
00196      DIVIDE DAYS-REMAINING BY +32 GIVING MONTH1                   ELCDATP2
00197                REMAINDER DAY1.                                    ELCDATP2
00198                                                                   ELCDATP2
00199 ***  Y2K, PROJ 7744                                                  CL*28
00200      IF DAY1 = ZEROS                                                 CL*28
00201          MOVE '3'                TO DC-ERROR-CODE                    CL*30
00202          GO TO 0300-EXIT                                             CL*28
00203      END-IF                                                          CL*28
00204 ***  Y2K, PROJ 7744                                                  CL*28
00205                                                                      CL*28
00206      ADD +1 TO MONTH1.                                            ELCDATP2
00207                                                                   ELCDATP2
00208      MOVE YEAR1              TO CHECK-YEAR.                          CL**9
00209      PERFORM 0900-CHECK-FOR-LEAP-YEAR.                               CL**9
00210                                                                   ELCDATP2
00211      IF ELAPSED-BETWEEN-BIN OR                                       CL**9
00212         ELAPSED-BETWEEN-BIN-3                                        CL**9
00213         CONTINUE                                                  ELCDATP2
00214      ELSE                                                         ELCDATP2
00215         GO TO 0300-EXIT.                                             CL**9
00216                                                                   ELCDATP2
00217      IF WS-BINARY-DATE-2 = ZERO                                   ELCDATP2
00218          MOVE '1'               TO DC-ERROR-CODE                     CL**9
00219          GO TO 0300-EXIT.                                         ELCDATP2
00220                                                                   ELCDATP2
00221      DIVIDE WS-BINARY-DATE-2 BY +384 GIVING YEAR2                 ELCDATP2
00222                                  REMAINDER DAYS-REMAINING.        ELCDATP2
00223                                                                   ELCDATP2
00224      DIVIDE DAYS-REMAINING BY +32 GIVING MONTH2                   ELCDATP2
00225                                  REMAINDER DAY2.                  ELCDATP2
00226                                                                   ELCDATP2
00227      ADD +1 TO MONTH2.                                            ELCDATP2
00228                                                                   ELCDATP2
00229  0300-EXIT.                                                       ELCDATP2
00230      EXIT.                                                        ELCDATP2
00231                                                                      CL**9
00232      EJECT                                                        ELCDATP2
00233  0400-REFORMAT-GREGORIAN-DATE SECTION.                            ELCDATP2
00234                                                                   ELCDATP2
00235      MOVE LOW-VALUES             TO  DC-BIN-DATE-1                ELCDATP2
00236                                      DC-BIN-DATE-2.               ELCDATP2
00237                                                                   ELCDATP2
00238      EVALUATE TRUE                                                ELCDATP2
00239         WHEN EDIT-GREG-TO-BIN OR                                     CL**9
00240              EDIT-GREG-TO-BIN-3                                      CL**9
00241            IF (DC-EDIT1-MONTH NOT NUMERIC) OR                     ELCDATP2
00242               (DC-EDIT1-DAY   NOT NUMERIC) OR                     ELCDATP2
00243               (DC-EDIT1-YEAR  NOT NUMERIC)                        ELCDATP2
00244              MOVE '2'            TO DC-ERROR-CODE                    CL**9
00245              GO TO 0400-EXIT                                      ELCDATP2
00246            END-IF                                                 ELCDATP2
00247            MOVE DC-EDIT1-MONTH   TO MONTH1                           CL**9
00248            MOVE DC-EDIT1-DAY     TO DAY1                             CL**9
00249            MOVE DC-EDIT1-YEAR    TO YEAR1                            CL**9
00250         WHEN YMD-GREG-TO-BIN OR                                      CL**9
00251              YMD-GREG-TO-BIN-3                                       CL**9
00252            IF DC-GREG-DATE-1-YMD NOT NUMERIC                      ELCDATP2
00253               MOVE '2'           TO DC-ERROR-CODE                    CL**9
00254               GO TO 0400-EXIT                                     ELCDATP2
00255            END-IF                                                 ELCDATP2
00256            MOVE DC-YMD-YEAR      TO YEAR1                            CL**9
00257            MOVE DC-YMD-MONTH     TO MONTH1                           CL**9
00258            MOVE DC-YMD-DAY       TO DAY1                             CL**9
00259            MOVE 0                TO DC-ALPHA-CEN-N                   CL**9
00260         WHEN MDY-GREG-TO-BIN OR                                      CL**9
00261              MDY-GREG-TO-BIN-3                                       CL**9
00262            IF DC-GREG-DATE-1-MDY NOT NUMERIC                      ELCDATP2
00263               MOVE '2'           TO DC-ERROR-CODE                    CL**9
00264               GO TO 0400-EXIT                                     ELCDATP2
00265            END-IF                                                 ELCDATP2
00266            MOVE DC-MDY-MONTH     TO MONTH1                           CL**9
00267            MOVE DC-MDY-DAY       TO DAY1                             CL**9
00268            MOVE DC-MDY-YEAR      TO YEAR1                            CL**9
00269            MOVE 0                TO DC-ALPHA-CEN-N                   CL**9
00270         WHEN MDCY-GREG-TO-BIN OR                                     CL**9
00271              MDCY-GREG-TO-BIN-3                                      CL**9
00272            IF DC-GREG-DATE-MDCY NOT NUMERIC                       ELCDATP2
00273               MOVE '2'           TO DC-ERROR-CODE                    CL**9
00274               GO TO 0400-EXIT                                     ELCDATP2
00275            END-IF                                                 ELCDATP2
00276            MOVE DC-MDCY-MONTH    TO MONTH1                           CL**9
00277            MOVE DC-MDCY-DAY      TO DAY1                             CL**9
00278            MOVE DC-MDCY-YEAR     TO YEAR1                            CL**9
00279            MOVE DC-MDCY-CEN      TO DC-ALPHA-CEN-N                   CL**9
00280         WHEN CYMD-GREG-TO-BIN OR                                     CL**9
00281              CYMD-GREG-TO-BIN-3                                      CL**9
00282            IF DC-GREG-DATE-CYMD NOT NUMERIC                       ELCDATP2
00283               MOVE '2'           TO DC-ERROR-CODE                    CL**9
00284               GO TO 0400-EXIT                                     ELCDATP2
00285            END-IF                                                 ELCDATP2
00286            MOVE DC-CYMD-CEN      TO DC-ALPHA-CEN-N                   CL**9
00287            MOVE DC-CYMD-YEAR     TO YEAR1                            CL**9
00288            MOVE DC-CYMD-MONTH    TO MONTH1                           CL**9
00289            MOVE DC-CYMD-DAY      TO DAY1                             CL**9
00290      END-EVALUATE                                                 ELCDATP2
00291                                                                   ELCDATP2
00292      EVALUATE TRUE                                                   CL*16
00293         WHEN MONTH1 NOT NUMERIC OR                                   CL*16
00294              DAY1   NOT NUMERIC OR                                   CL*16
00295              YEAR1  NOT NUMERIC                                      CL*16
00296               MOVE '3'           TO DC-ERROR-CODE                    CL*16
00297               GO TO 0400-EXIT                                        CL*16
00298         WHEN MONTH1 = ZERO  AND                                      CL*16
00299              DAY1   = ZERO  AND                                      CL*16
00300              YEAR1  = ZERO                                           CL*16
00301               MOVE '1'           TO DC-ERROR-CODE                    CL*16
00302               GO TO 0400-EXIT                                        CL*16
00303         WHEN MONTH1 < 1 OR > 12                                      CL*16
00304               MOVE '3'           TO DC-ERROR-CODE                    CL*16
00305               GO TO 0400-EXIT                                        CL*16
00306         WHEN DAY1 < 1 OR > 31                                        CL*16
00307               MOVE '3'           TO DC-ERROR-CODE                    CL*16
00308               GO TO 0400-EXIT                                        CL*16
00309      END-EVALUATE                                                    CL*16
00310                                                                      CL*10
00311      EVALUATE TRUE                                                ELCDATP2
00312         WHEN ADJUST-DOWN-100-YRS                                     CL*74
00313            IF CURRENT-CENTURY-1-N = 19                               CL*74
00314               CONTINUE                                               CL*74
00315            ELSE                                                      CL*74
00316               MOVE '2'              TO FIND-CENTURY-FLAG             CL*74
00317               MOVE PREVIOUS-CENTURY TO SEARCH-CENTURY-N              CL*74
00318               PERFORM 0800-FIND-CENTURY                              CL*75
00319               IF NO-CONVERSION-ERROR                                 CL*74
00320                  COMPUTE YEAR1 = YEAR1 +                             CL*74
00321                                     (FOUND-CENTURY-CD-N * 100)       CL*74
00322               ELSE                                                   CL*74
00323                  GO TO 0400-EXIT                                     CL*74
00324               END-IF                                                 CL*74
00325            END-IF                                                    CL*74
00326         WHEN ADJUST-UP-100-YRS                                       CL*74
00327            MOVE '2'              TO FIND-CENTURY-FLAG                CL*74
00328            MOVE NEXT-CENTURY TO SEARCH-CENTURY-N                     CL*77
00329            PERFORM 0800-FIND-CENTURY                                 CL*75
00330            IF NO-CONVERSION-ERROR                                    CL*74
00331               COMPUTE YEAR1 = YEAR1 +                                CL*74
00332                                  (FOUND-CENTURY-CD-N * 100)          CL*74
00333            ELSE                                                      CL*74
00334               GO TO 0400-EXIT                                        CL*74
00335            END-IF                                                    CL*74
00336         WHEN DC-ALPHA-CEN-N > 0                                   ELCDATP2
00337            MOVE '2'              TO FIND-CENTURY-FLAG                CL**9
00338            MOVE DC-ALPHA-CEN-N   TO SEARCH-CENTURY-N                 CL**9
00339            PERFORM 0800-FIND-CENTURY                              ELCDATP2
00340            IF NO-CONVERSION-ERROR                                 ELCDATP2
00341               COMPUTE YEAR1 = YEAR1 + (FOUND-CENTURY-CD-N * 100)  ELCDATP2
00342            ELSE                                                   ELCDATP2
00343               GO TO 0400-EXIT                                     ELCDATP2
00344            END-IF                                                 ELCDATP2
CIDMOD        WHEN YEAR1 < W-FLOAT-YEAR                                    CL*70
00346            COMPUTE YEAR1 = YEAR1 + CENTURY-MARK                   ELCDATP2
00347      END-EVALUATE.                                                ELCDATP2
00348                                                                      CL**9
00349      MOVE YEAR1                  TO CHECK-YEAR.                      CL**9
00350      PERFORM 0900-CHECK-FOR-LEAP-YEAR THRU 0900-EXIT.             ELCDATP2
00351                                                                   ELCDATP2
00352      IF DAY1 > DAYS-IN-MONTH (MONTH1)                                CL**9
00353          MOVE '3'                TO DC-ERROR-CODE                    CL**9
00354          GO TO 0400-EXIT.                                         ELCDATP2
00355                                                                   ELCDATP2
00356  0400-EXIT.                                                       ELCDATP2
00357      EXIT.                                                        ELCDATP2
00358                                                                   ELCDATP2
00359      EJECT                                                        ELCDATP2
00360  0500-REFORMAT-JULIAN-DATE SECTION.                               ELCDATP2
00361                                                                   ELCDATP2
00362      MOVE '00/00/00'             TO  DC-GREG-DATE-1-EDIT          ELCDATP2
00363                                      DC-GREG-DATE-2-EDIT.         ELCDATP2
00364                                                                   ELCDATP2
CIDMOD*    MOVE GREG-ALPHA-MASK        TO  DC-GREG-DATE-1-ALPHA.        ELCDATP2
00366                                                                   ELCDATP2
00367      MOVE ZERO                   TO  DC-GREG-DATE-1-YMD           ELCDATP2
00368                                      DC-GREG-DATE-1-MDY           ELCDATP2
00369                                      DC-GREG-DATE-CYMD            ELCDATP2
00370                                      DC-GREG-DATE-MDCY            ELCDATP2
00371                                      DC-ELAPSED-MONTHS            ELCDATP2
00372                                      DC-ODD-DAYS-OVER             ELCDATP2
00373                                      DC-ALPHA-CEN-N                  CL*61
00374                                      DC-ELAPSED-DAYS.             ELCDATP2
00375                                                                   ELCDATP2
00376      MOVE LOW-VALUES             TO  DC-BIN-DATE-1                ELCDATP2
00377                                      DC-BIN-DATE-2.               ELCDATP2
00378                                                                   ELCDATP2
00379      IF DC-JULIAN-DATE = ZERO                                     ELCDATP2
00380          MOVE '1'             TO DC-ERROR-CODE                       CL**9
00381          GO TO 0500-EXIT.                                         ELCDATP2
00382                                                                   ELCDATP2
00383      IF DC-JULIAN-DAYS = ZERO                                     ELCDATP2
00384          MOVE '3'             TO DC-ERROR-CODE                       CL**9
00385          GO TO 0500-EXIT.                                         ELCDATP2
00386                                                                   ELCDATP2
00387      IF JULIAN-EXPANDED-TO-BIN OR                                 ELCDATP2
00388         JULIAN-EXPANDED-TO-BIN-3                                     CL**9
00389           MOVE DC-JULIAN-1-CC   TO DC-ALPHA-CEN-N.                   CL*54
00390                                                                   ELCDATP2
00391      EVALUATE TRUE                                                ELCDATP2
00392         WHEN ADJUST-DOWN-100-YRS                                     CL*74
00393            IF CURRENT-CENTURY-1-N = 19                               CL*74
00394               CONTINUE                                               CL*74
00395            ELSE                                                      CL*74
00396               MOVE '2'              TO FIND-CENTURY-FLAG             CL*74
00397               MOVE PREVIOUS-CENTURY TO SEARCH-CENTURY-N              CL*74
00398               PERFORM 0800-FIND-CENTURY                              CL*75
00399               IF NO-CONVERSION-ERROR                                 CL*74
00400                  COMPUTE JULIAN-YEAR1 = JULIAN-YEAR1 +               CL*74
00401                                     (FOUND-CENTURY-CD-N * 100)       CL*74
00402               ELSE                                                   CL*74
00403                  GO TO 0500-EXIT                                     CL*74
00404               END-IF                                                 CL*74
00405            END-IF                                                    CL*74
00406         WHEN ADJUST-UP-100-YRS                                       CL*74
00407            MOVE '2'              TO FIND-CENTURY-FLAG                CL*74
00408            MOVE NEXT-CENTURY     TO SEARCH-CENTURY-N                 CL*76
00409            PERFORM 0800-FIND-CENTURY                                 CL*75
00410            IF NO-CONVERSION-ERROR                                    CL*74
00411               COMPUTE JULIAN-YEAR1 = JULIAN-YEAR1 +                  CL*74
00412                                  (FOUND-CENTURY-CD-N * 100)          CL*74
00413            ELSE                                                      CL*74
00414               GO TO 0500-EXIT                                        CL*74
00415            END-IF                                                    CL*74
00416         WHEN DC-ALPHA-CEN-N > 0                                   ELCDATP2
00417            MOVE DC-ALPHA-CEN-N        TO SEARCH-CENTURY-N            CL**9
00418            MOVE 2                     TO FIND-CENTURY-FLAG           CL**9
00419            PERFORM 0800-FIND-CENTURY                              ELCDATP2
00420            IF NO-CONVERSION-ERROR                                 ELCDATP2
00421               COMPUTE JULIAN-YEAR1 =                              ELCDATP2
00422                       JULIAN-YEAR1 + (FOUND-CENTURY-CD-N * 100)      CL**9
00423            ELSE                                                   ELCDATP2
00424               GO TO 0500-EXIT                                     ELCDATP2
00425            END-IF                                                 ELCDATP2
00426          WHEN JULIAN-YEAR1 NOT > W-FLOAT-YEAR                        CL*71
00427                  COMPUTE JULIAN-YEAR1 =                           ELCDATP2
00428                             JULIAN-YEAR1 + 100                    ELCDATP2
00429      END-EVALUATE.                                                ELCDATP2
00430                                                                   ELCDATP2
00431      MOVE JULIAN-YEAR1           TO YEAR1                            CL**9
00432                                     CHECK-YEAR.                      CL**9
00433                                                                   ELCDATP2
00434      PERFORM 0900-CHECK-FOR-LEAP-YEAR THRU 0900-EXIT.             ELCDATP2
00435                                                                   ELCDATP2
00436      IF (A-LEAP-YEAR AND JULIAN-DAY1 > LEAP-YR-DAYS (13))            CL**9
00437                        OR                                            CL**9
00438         (NOT A-LEAP-YEAR AND DC-JULIAN-DAYS > REGULAR-DAYS (13))     CL**9
00439            MOVE '3'              TO DC-ERROR-CODE                    CL**9
00440            GO TO 0500-EXIT.                                       ELCDATP2
00441                                                                   ELCDATP2
00442      SET MTHX TO +1.                                              ELCDATP2
00443                                                                   ELCDATP2
00444      IF A-LEAP-YEAR                                               ELCDATP2
00445          PERFORM 0550-JULIAN-LEAP-YEAR                            ELCDATP2
00446      ELSE                                                            CL*18
00447          PERFORM 0575-JULIAN-REGULAR-YEAR                            CL*19
00448      END-IF                                                          CL*19
00449      .                                                               CL*18
00450  0500-EXIT.                                                       ELCDATP2
00451      EXIT.                                                        ELCDATP2
00452 /                                                                    CL*10
00453                                                                   ELCDATP2
00454  0550-JULIAN-LEAP-YEAR SECTION.                                      CL*10
00455                                                                      CL*10
00456      IF JULIAN-DAY1 NOT > LEAP-YR-DAYS (MTHX)                        CL*10
00457          SET MTHX DOWN BY +1                                         CL*10
00458          SET MONTH1 TO MTHX                                          CL*10
00459          SUBTRACT LEAP-YR-DAYS (MTHX) FROM JULIAN-DAY1               CL*10
00460                                       GIVING DAY1                    CL*10
00461          MOVE JULIAN-YEAR1       TO  YEAR1                           CL*10
00462        ELSE                                                          CL*10
00463          SET MTHX UP BY +1                                           CL*10
00464          GO TO 0550-JULIAN-LEAP-YEAR.                                CL*10
00465                                                                      CL*10
00466  0550-EXIT.                                                          CL*10
00467      EXIT.                                                           CL*10
00468                                                                      CL*10
00469                                                                   ELCDATP2
00470  0575-JULIAN-REGULAR-YEAR SECTION.                                ELCDATP2
00471                                                                   ELCDATP2
00472      IF JULIAN-DAY1 NOT > REGULAR-DAYS (MTHX)                        CL**9
00473          SET MTHX DOWN BY +1                                      ELCDATP2
00474          SET MONTH1 TO MTHX                                       ELCDATP2
00475          SUBTRACT REGULAR-DAYS (MTHX) FROM JULIAN-DAY1               CL**9
00476                                       GIVING DAY1                    CL**9
00477          MOVE JULIAN-YEAR1       TO  YEAR1                        ELCDATP2
00478        ELSE                                                       ELCDATP2
00479          SET MTHX UP BY +1                                        ELCDATP2
00480          GO TO 0575-JULIAN-REGULAR-YEAR.                          ELCDATP2
00481                                                                   ELCDATP2
00482  0575-EXIT.                                                       ELCDATP2
00483      EXIT.                                                        ELCDATP2
00484                                                                   ELCDATP2
00485      EJECT                                                        ELCDATP2
00486  0600-ELAPSED-TIME-CALCULATIONS SECTION.                          ELCDATP2
00487                                                                   ELCDATP2
00488      MOVE YEAR2                 TO JULIAN-YEAR2                      CL**9
00489                                    CHECK-YEAR.                       CL**9
00490      PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
00491                                                                   ELCDATP2
00492      SET MTHX TO MONTH2.                                          ELCDATP2
00493                                                                   ELCDATP2
00494      IF A-LEAP-YEAR                                               ELCDATP2
00495          MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY2                  ELCDATP2
00496        ELSE                                                       ELCDATP2
00497          MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY2.                 ELCDATP2
00498                                                                   ELCDATP2
00499      ADD DAY2 TO JULIAN-DAY2.                                     ELCDATP2
00500                                                                   ELCDATP2
00501      MOVE ZERO                   TO WS-ELAPSED-DAYS.              ELCDATP2
00502      MOVE YEAR1                  TO CHECK-YEAR.                   ELCDATP2
00503                                                                   ELCDATP2
00504  0600-LOOP.                                                       ELCDATP2
00505      IF CHECK-YEAR = JULIAN-YEAR2                                 ELCDATP2
00506          GO TO 0600-COMPUTE.                                      ELCDATP2
00507                                                                   ELCDATP2
00508      PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
00509                                                                   ELCDATP2
00510      IF A-LEAP-YEAR                                               ELCDATP2
00511          ADD +366 TO WS-ELAPSED-DAYS                              ELCDATP2
00512        ELSE                                                       ELCDATP2
00513          ADD +365 TO WS-ELAPSED-DAYS.                             ELCDATP2
00514                                                                   ELCDATP2
00515      ADD +1  TO  CHECK-YEAR.                                      ELCDATP2
00516                                                                   ELCDATP2
00517      GO TO 0600-LOOP.                                             ELCDATP2
00518                                                                   ELCDATP2
00519  0600-COMPUTE.                                                    ELCDATP2
00520      ADD JULIAN-DAY2        TO WS-ELAPSED-DAYS.                      CL**9
00521                                                                      CL**9
00522      SUBTRACT JULIAN-DAY1 FROM WS-ELAPSED-DAYS.                   ELCDATP2
00523                                                                   ELCDATP2
00524      COMPUTE WS-ELAPSED-MONTHS =                                  ELCDATP2
00525          ((YEAR2 - YEAR1) * 12) + (MONTH2 - MONTH1)               ELCDATP2
00526                                                                   ELCDATP2
00527      IF DAY2 = DAY1                                               ELCDATP2
00528          MOVE ZERO               TO  DC-ODD-DAYS-OVER             ELCDATP2
00529        ELSE                                                       ELCDATP2
00530      IF DAY1 NOT < DAYS-IN-MONTH (MONTH1)                            CL**9
00531          MOVE DAY2               TO  DC-ODD-DAYS-OVER             ELCDATP2
00532          SUBTRACT +1 FROM WS-ELAPSED-MONTHS                       ELCDATP2
00533        ELSE                                                       ELCDATP2
00534      IF DAY2 > DAY1                                                  CL**9
00535          SUBTRACT DAY1 FROM DAY2 GIVING DC-ODD-DAYS-OVER          ELCDATP2
00536        ELSE                                                       ELCDATP2
00537          COMPUTE DC-ODD-DAYS-OVER =                               ELCDATP2
00538               (DAYS-IN-MONTH (MONTH1) - DAY1) + DAY2              ELCDATP2
00539          SUBTRACT +1 FROM WS-ELAPSED-MONTHS.                      ELCDATP2
00540                                                                   ELCDATP2
00541      MOVE YEAR2                  TO CHECK-YEAR.                   ELCDATP2
00542      PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
00543                                                                   ELCDATP2
00544      IF DC-ODD-DAYS-OVER NOT < DAYS-IN-MONTH (MONTH2) AND            CL**9
00545         DAY2 = DAYS-IN-MONTH (MONTH2)                             ELCDATP2
00546          MOVE ZERO               TO  DC-ODD-DAYS-OVER             ELCDATP2
00547          ADD +1 TO WS-ELAPSED-MONTHS.                             ELCDATP2
00548                                                                   ELCDATP2
00549  0600-MOVE.                                                       ELCDATP2
00550      MOVE WS-ELAPSED-MONTHS      TO  DC-ELAPSED-MONTHS.           ELCDATP2
00551      MOVE WS-ELAPSED-DAYS        TO  DC-ELAPSED-DAYS.             ELCDATP2
00552                                                                   ELCDATP2
00553  0600-EXIT.                                                       ELCDATP2
00554      EXIT.                                                        ELCDATP2
00555                                                                   ELCDATP2
00556      EJECT                                                        ELCDATP2
00557  0700-CALCULATE-END-DATE SECTION.                                 ELCDATP2
00558                                                                   ELCDATP2
00559      IF NOT CALCULATE-END-OF-MONTH                                ELCDATP2
00560          GO TO 0700-CONTINUE.                                     ELCDATP2
00561                                                                   ELCDATP2
00562      IF WS-ELAPSED-MONTHS = ZERO  OR                              ELCDATP2
00563         WS-ELAPSED-DAYS NOT = ZERO                                ELCDATP2
00564          MOVE '2'                TO  DC-END-OF-MONTH              ELCDATP2
00565          GO TO 0700-CONTINUE.                                     ELCDATP2
00566                                                                   ELCDATP2
00567      DIVIDE WS-BINARY-DATE-1 BY +384 GIVING YEAR1                 ELCDATP2
00568              REMAINDER DAYS-REMAINING.                            ELCDATP2
00569                                                                   ELCDATP2
00570      DIVIDE DAYS-REMAINING BY +32 GIVING MONTH1                   ELCDATP2
00571              REMAINDER DAY1.                                      ELCDATP2
00572                                                                   ELCDATP2
00573      ADD +1  TO  MONTH1.                                          ELCDATP2
00574                                                                   ELCDATP2
00575      SET MTHX TO MONTH1.                                          ELCDATP2
00576                                                                   ELCDATP2
00577      MOVE YEAR1                 TO CHECK-YEAR.                    ELCDATP2
00578      PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
00579                                                                   ELCDATP2
00580      IF DAY1 < DAYS-IN-MONTH (MTHX)                                  CL**9
00581          MOVE '3'            TO  DC-END-OF-MONTH.                 ELCDATP2
00582                                                                   ELCDATP2
00583  0700-CONTINUE.                                                   ELCDATP2
00584      COMPUTE WS-BINARY-DATE-2 = WS-BINARY-DATE-1 +                ELCDATP2
00585              (WS-ELAPSED-MONTHS * 32).                            ELCDATP2
00586                                                                   ELCDATP2
00587      IF WS-BINARY-DATE-2 NOT > ZERO                                  CL**9
00588          MOVE '5'                TO  DC-ERROR-CODE                ELCDATP2
00589          GO TO 0700-EXIT.                                         ELCDATP2
00590                                                                   ELCDATP2
00591      DIVIDE WS-BINARY-DATE-2 BY +384 GIVING YEAR2                 ELCDATP2
00592              REMAINDER DAYS-REMAINING.                            ELCDATP2
00593                                                                   ELCDATP2
00594      DIVIDE DAYS-REMAINING BY +32 GIVING MONTH2                   ELCDATP2
00595              REMAINDER DAY2.                                      ELCDATP2
00596                                                                   ELCDATP2
00597      ADD +1 TO MONTH2.                                            ELCDATP2
00598                                                                   ELCDATP2
00599      SET MTHX TO MONTH2.                                          ELCDATP2
00600                                                                   ELCDATP2
00601      MOVE YEAR2 TO YEAR1                                          ELCDATP2
00602                    CHECK-YEAR                                     ELCDATP2
00603                    JULIAN-YEAR2.                                  ELCDATP2
00604                                                                   ELCDATP2
00605      PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
00606                                                                   ELCDATP2
00607      IF A-LEAP-YEAR                                               ELCDATP2
00608          MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY2                  ELCDATP2
00609        ELSE                                                       ELCDATP2
00610          MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY2.                 ELCDATP2
00611                                                                   ELCDATP2
00612      IF DAY2 NOT < DAYS-IN-MONTH (MTHX)                              CL**9
00613          MOVE DAYS-IN-MONTH (MTHX) TO DAY2.                       ELCDATP2
00614                                                                   ELCDATP2
00615      ADD DAY2 TO JULIAN-DAY2.                                     ELCDATP2
00616                                                                   ELCDATP2
00617  0700-ADD-DAYS.                                                   ELCDATP2
00618      IF WS-ELAPSED-DAYS = ZERO                                    ELCDATP2
00619          GO TO 0700-CONVERT-NEW-DATE.                             ELCDATP2
00620                                                                   ELCDATP2
00621      MOVE WS-ELAPSED-DAYS TO DAYS-ELAPSED.                        ELCDATP2
00622                                                                   ELCDATP2
00623      IF WS-ELAPSED-DAYS < ZERO                                       CL**9
00624          MULTIPLY -1  BY  WS-ELAPSED-DAYS                         ELCDATP2
00625          GO TO 0700-SUBTRACT-DAYS.                                ELCDATP2
00626                                                                   ELCDATP2
00627      EJECT                                                        ELCDATP2
00628  0700-ADD-DAYS-LOOP.                                              ELCDATP2
00629      IF A-LEAP-YEAR                                               ELCDATP2
00630          MOVE 366 TO DAYS-NEEDED                                  ELCDATP2
00631        ELSE                                                       ELCDATP2
00632          MOVE 365 TO DAYS-NEEDED.                                 ELCDATP2
00633                                                                   ELCDATP2
00634      SUBTRACT JULIAN-DAY2 FROM DAYS-NEEDED.                       ELCDATP2
00635                                                                   ELCDATP2
00636      IF DAYS-ELAPSED NOT > DAYS-NEEDED                               CL**9
00637          GO TO 0700-ADD-REMAINING-DAYS.                           ELCDATP2
00638                                                                   ELCDATP2
00639      IF DAYS-ELAPSED > ZERO                                          CL**9
00640          SUBTRACT +1  FROM DAYS-ELAPSED.                          ELCDATP2
00641                                                                   ELCDATP2
00642      SUBTRACT DAYS-NEEDED FROM DAYS-ELAPSED.                      ELCDATP2
00643                                                                   ELCDATP2
00644      ADD +1 TO JULIAN-YEAR2.                                      ELCDATP2
00645                                                                   ELCDATP2
00646      MOVE +1                     TO JULIAN-DAY2.                     CL**9
00647                                                                   ELCDATP2
00648      MOVE JULIAN-YEAR2           TO CHECK-YEAR.                      CL**9
00649                                                                      CL**9
00650      PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
00651                                                                   ELCDATP2
00652      GO TO 0700-ADD-DAYS-LOOP.                                    ELCDATP2
00653                                                                   ELCDATP2
00654  0700-ADD-REMAINING-DAYS.                                         ELCDATP2
00655      ADD DAYS-ELAPSED TO JULIAN-DAY2.                             ELCDATP2
00656                                                                   ELCDATP2
00657      GO TO 0700-CALCULATE-JULIAN-DATE.                            ELCDATP2
00658                                                                   ELCDATP2
00659      EJECT                                                        ELCDATP2
00660  0700-SUBTRACT-DAYS.                                              ELCDATP2
00661      IF WS-ELAPSED-DAYS < JULIAN-DAY2                                CL**9
00662          SUBTRACT WS-ELAPSED-DAYS FROM JULIAN-DAY2                ELCDATP2
00663          GO TO 0700-CALCULATE-JULIAN-DATE.                        ELCDATP2
00664                                                                   ELCDATP2
00665      SUBTRACT JULIAN-DAY2 FROM WS-ELAPSED-DAYS.                   ELCDATP2
00666                                                                   ELCDATP2
00667      SUBTRACT +1  FROM JULIAN-YEAR2.                              ELCDATP2
00668                                                                   ELCDATP2
00669      MOVE JULIAN-YEAR2           TO  CHECK-YEAR.                  ELCDATP2
00670      PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
00671                                                                   ELCDATP2
00672      IF A-LEAP-YEAR                                               ELCDATP2
00673          MOVE +366               TO  JULIAN-DAY2                  ELCDATP2
00674        ELSE                                                       ELCDATP2
00675          MOVE +365               TO  JULIAN-DAY2.                 ELCDATP2
00676                                                                   ELCDATP2
00677      GO TO 0700-SUBTRACT-DAYS.                                    ELCDATP2
00678                                                                   ELCDATP2
00679      EJECT                                                        ELCDATP2
00680  0700-CALCULATE-JULIAN-DATE.                                      ELCDATP2
00681      MOVE WORK-JULIAN-2          TO  WORK-JULIAN-1.               ELCDATP2
00682      SET MTHX TO +1.                                              ELCDATP2
00683                                                                   ELCDATP2
00684      IF A-LEAP-YEAR                                               ELCDATP2
00685          PERFORM 0550-JULIAN-LEAP-YEAR                            ELCDATP2
00686        ELSE                                                       ELCDATP2
00687          PERFORM 0575-JULIAN-REGULAR-YEAR.                        ELCDATP2
00688                                                                   ELCDATP2
00689      MOVE WORK-DATE-1 TO WORK-DATE-2.                             ELCDATP2
00690                                                                   ELCDATP2
00691  0700-CONVERT-NEW-DATE.                                           ELCDATP2
00692      IF CALCULATE-END-OF-MONTH                                    ELCDATP2
00693          SET MTHX TO MONTH2                                       ELCDATP2
00694          IF DAY2 < DAYS-IN-MONTH (MTHX)                              CL**9
00695              MOVE DAYS-IN-MONTH (MTHX) TO  DAY2.                  ELCDATP2
00696                                                                   ELCDATP2
00697      MOVE WORK-DATE-2 TO WORK-DATE-1.                             ELCDATP2
00698                                                                   ELCDATP2
00699  0700-EXIT.                                                       ELCDATP2
00700      EXIT.                                                        ELCDATP2
00701                                                                   ELCDATP2
pemuni*0800-FIND-CENTURY.                                               ELCDATP2
pemuni 0800-FIND-CENTURY section.                                       ELCDATP2

00703                                                                   ELCDATP2
00704      SET CNTRY-NDX TO +1.                                         ELCDATP2
00705      EVALUATE FIND-CENTURY-FLAG                                   ELCDATP2
00706         WHEN 1                                                    ELCDATP2
00707            SEARCH  CENTURY-TBL                                    ELCDATP2
00708              AT END                                               ELCDATP2
00709                MOVE 'A' TO DC-ERROR-CODE                          ELCDATP2
00710            WHEN CENTURY-CODE(CNTRY-NDX) = SEARCH-CENTURY-CD-N     ELCDATP2
00711               MOVE CENTURY(CNTRY-NDX) TO FOUND-CENTURY-N          ELCDATP2
00712            END-SEARCH                                             ELCDATP2
00713         WHEN 2                                                    ELCDATP2
00714            SEARCH  CENTURY-TBL                                    ELCDATP2
00715               AT END                                              ELCDATP2
00716                  MOVE 'A' TO DC-ERROR-CODE                        ELCDATP2
00717            WHEN CENTURY(CNTRY-NDX) = SEARCH-CENTURY-N             ELCDATP2
00718               MOVE CENTURY-CODE(CNTRY-NDX) TO FOUND-CENTURY-CD-N  ELCDATP2
00719            END-SEARCH                                             ELCDATP2
00720         WHEN 3                                                    ELCDATP2
00721 ***  Y2K                                                             CL*35
00722 *          IF YEAR1 <= CENTURY-MARK                                  CL*50
00723            EVALUATE YEAR1 < CENTURY-MARK                             CL*55
00724                     ALSO W-FLOAT-YEAR-YY > 34                        CL*57
00725                 WHEN TRUE ALSO TRUE                                  CL*55
00726                     MOVE PREVIOUS-CENTURY TO                         CL*65
00727                                    DC-ALPHA-CEN-N                    CL*64
00728                 WHEN TRUE ALSO FALSE                                 CL*55
00729                  IF W-FLOAT-YEAR-YY < 30                             CL*51
00730                     MOVE CURRENT-CENTURY-1-N TO                      CL*59
00731                                    DC-ALPHA-CEN-N                    CL*59
00732                  ELSE                                                CL*51
00733                     MOVE NEXT-CENTURY TO DC-ALPHA-CEN-N              CL*51
00734                  END-IF                                              CL*51
00735                 WHEN FALSE ALSO FALSE                                CL*55
00736                  IF YEAR1 > BREAK-PERIOD                             CL*67
00737                     MOVE NEXT-CENTURY TO DC-ALPHA-CEN-N              CL*59
00738                  ELSE                                                CL*55
00739                     MOVE PREVIOUS-CENTURY TO DC-ALPHA-CEN-N          CL*59
00740                  END-IF                                              CL*55
00741                 WHEN  OTHER                                          CL*43
00742                  IF YEAR1 > BREAK-PERIOD                             CL*67
00743                     MOVE PREVIOUS-CENTURY TO DC-ALPHA-CEN-N          CL*68
00744                  ELSE                                                CL*62
00745                     MOVE CURRENT-CENTURY-1-N                         CL*68
00746                                          TO DC-ALPHA-CEN-N           CL*68
00747                  END-IF                                              CL*62
00748            END-EVALUATE                                              CL*57
00749      END-EVALUATE.                                                ELCDATP2
00750 ***  Y2K                                                             CL*35
pemuni                                                                  ELCDATP2
pemuni 0800-EXIT.                                                       ELCDATP2
pemuni     EXIT.                                                        ELCDATP2
00751                                                                   ELCDATP2
00752  0900-CHECK-FOR-LEAP-YEAR SECTION.                                ELCDATP2
00753                                                                   ELCDATP2
00754      MOVE CHECK-YEAR TO CHECK-CCYY.                               ELCDATP2
00755                                                                   ELCDATP2
00756 ***  Y2K, PROJ 7744                                                  CL*26
00757      IF CHECK-CCYY-YY > 00                                        ELCDATP2
00758          COMPUTE DIVIDE-LEAP-YEAR = CHECK-CCYY / 4                   CL*26
00759      ELSE                                                         ELCDATP2
00760          MOVE CHECK-CCYY-CC      TO SEARCH-CENTURY-CD-N              CL*26
00761          MOVE 1                  TO FIND-CENTURY-FLAG                CL*26
00762          PERFORM 0800-FIND-CENTURY                                   CL*26
00763          IF NO-CONVERSION-ERROR                                      CL*26
00764              MOVE FOUND-CENTURY-N TO CHECK-CCYY-CC                   CL*27
00765              COMPUTE DIVIDE-LEAP-YEAR = CHECK-CCYY / 400             CL*27
00766          END-IF                                                      CL*26
00767      END-IF                                                          CL*25
00768 ***  Y2K, PROJ 7744                                                  CL*26
00769                                                                   ELCDATP2
00770      IF A-LEAP-YEAR                                               ELCDATP2
00771          MOVE +29                TO  DAYS-IN-MONTH (2)            ELCDATP2
00772      ELSE                                                            CL*26
00773          MOVE +28                TO  DAYS-IN-MONTH (2).           ELCDATP2
00774                                                                   ELCDATP2
00775  0900-EXIT.                                                       ELCDATP2
00776      EXIT.                                                        ELCDATP2
