00001 ******************************************************************04/09/98
00002 *                                                                *ECSRIRT2
00003 *                            ECSRIRT2                            *   LV006
00004 *                            VMOD=2.016                          *ECSRIRT2
00005 *                                                                *ECSRIRT2
00006 ******************************************************************ECSRIRT2
00007  REINSURE-CALC.                                                   ECSRIRT2
00008      MOVE RE-REI-COMP-NO (SUB1)  TO  REIN-COMP (SUB1).            ECSRIRT2
00009      MOVE REIN-WORK-FLDS (SUB1)  TO  RWF-FIELDS.                  ECSRIRT2
00010      MOVE RE-COMP-INFO (SUB1)    TO  WT-COMP-INFO.                ECSRIRT2
00011      MOVE WT-REMAINING           TO  RWF-REM-SW                   ECSRIRT2
00012                                      REIN-REM-SW (SUB1).          ECSRIRT2
00013                                                                   ECSRIRT2
00014      IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRT2
00015          MOVE RS-R-LB            TO  RS-LIFE-BEN                  ECSRIRT2
00016          MOVE RS-R-LP            TO  RS-LIFE-PREM                 ECSRIRT2
00017          MOVE RS-R-AB            TO  RS-AH-BEN                    ECSRIRT2
00018          MOVE RS-R-AP            TO  RS-AH-PREM                   ECSRIRT2
00019          MOVE RS-R-LPC           TO  RS-LP-CALC                   ECSRIRT2
00020          MOVE RS-R-APC           TO  RS-AP-CALC                   ECSRIRT2
00021      ELSE                                                         ECSRIRT2
00022          MOVE CR-LFAMT           TO  RS-LIFE-BEN                  ECSRIRT2
00023          MOVE CR-LFPRM           TO  RS-LIFE-PREM                 ECSRIRT2
00024          MOVE CR-AHAMT           TO  RS-AH-BEN                    ECSRIRT2
00025          MOVE CR-AHPRM           TO  RS-AH-PREM                   ECSRIRT2
00026          MOVE CR-LFPRM-CALC      TO  RS-LP-CALC                   ECSRIRT2
00027                                      REIN-CALCED-LIFE             ECSRIRT2
00028          MOVE CR-AHPRM-CALC      TO  RS-AP-CALC                   ECSRIRT2
00029                                      REIN-CALCED-AH.              ECSRIRT2
00030                                                                   ECSRIRT2
00031      IF SUB1 = RE-100-COMP                                        ECSRIRT2
00032          GO TO REINSURE-CALC-REMAINDER.                           ECSRIRT2
00033                                                                   ECSRIRT2
00034      IF CR-DT LESS WT-LO-DATE                                     ECSRIRT2
00035          GO TO REINSURE-CALC-X.                                   ECSRIRT2
00036                                                                   ECSRIRT2
00037      IF CR-DT NOT LESS WT-HI-DATE                                 ECSRIRT2
00038          GO TO REINSURE-CALC-X.                                   ECSRIRT2
00039                                                                   ECSRIRT2
00040      PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRT2
00041      PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRT2
00042      IF WT-INTERACTIVE = 'E'                                      ECSRIRT2
00043          PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRT2
00044                                                                   ECSRIRT2
00045      IF WT-INTERACTIVE = 'X'                                      ECSRIRT2
00046        IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRT2
00047         OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRT2
00048         OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRT2
00049            NEXT SENTENCE                                          ECSRIRT2
00050        ELSE                                                       ECSRIRT2
00051            MOVE 'Y'              TO  REIN-LF-FLG (SUB1)           ECSRIRT2
00052                                      REIN-AH-FLG (SUB1).          ECSRIRT2
00053                                                                   ECSRIRT2
00054      IF WT-INTERACTIVE = 'Y'                                      ECSRIRT2
00055          IF REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'Y' ECSRIRT2
00056              MOVE 'X'            TO  REIN-AH-FLG (SUB1).          ECSRIRT2
00057                                                                   ECSRIRT2
00058      IF WT-INTERACTIVE = 'Y'                                      ECSRIRT2
00059          IF REIN-AH-FLG (SUB1) = 'X' AND REIN-LF-FLG (SUB1) = 'Y' ECSRIRT2
00060              MOVE 'X'            TO  REIN-LF-FLG (SUB1).          ECSRIRT2
00061                                                                   ECSRIRT2
00062      IF WT-INTERACTIVE = 'Z'                                      ECSRIRT2
00063          IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRT2
00064              IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRT2
00065                  MOVE 'X'        TO  REIN-AH-FLG (SUB1)           ECSRIRT2
00066              ELSE                                                 ECSRIRT2
00067                  NEXT SENTENCE                                    ECSRIRT2
00068          ELSE                                                     ECSRIRT2
00069              MOVE 'Y'            TO  REIN-LF-FLG (SUB1)           ECSRIRT2
00070                                      REIN-AH-FLG (SUB1).          ECSRIRT2
00071                                                                   ECSRIRT2
00072      IF WT-INTERACTIVE = 'W'                                      ECSRIRT2
00073          IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRT2
00074              IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRT2
00075                  MOVE 'X'        TO  REIN-LF-FLG (SUB1)           ECSRIRT2
00076              ELSE                                                 ECSRIRT2
00077                  NEXT SENTENCE                                    ECSRIRT2
00078          ELSE                                                     ECSRIRT2
00079              MOVE 'Y'            TO  REIN-LF-FLG (SUB1)           ECSRIRT2
00080                                      REIN-AH-FLG (SUB1).          ECSRIRT2
00081                                                                   ECSRIRT2
00082      IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRT2
00083          PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRT2
00084                                                                   ECSRIRT2
00085      IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRT2
00086          PERFORM REIN-CALC-A THRU REIN-CALC-LIFE-X                   CL**6
00087          MOVE 'X'                TO  REIN-LF-FLG (SUB1).          ECSRIRT2
00088                                                                   ECSRIRT2
00089      IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRT2
00090          PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRT2
00091                                                                   ECSRIRT2
00092      IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRT2
00093          PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRT2
00094          MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRT2
00095                                                                   ECSRIRT2
00096      IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRT2
00097          MOVE SPACE              TO  REIN-LF-FLG (SUB1).          ECSRIRT2
00098                                                                   ECSRIRT2
00099      IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRT2
00100          MOVE SPACE              TO  REIN-AH-FLG (SUB1).          ECSRIRT2
00101                                                                   ECSRIRT2
00102      GO TO REINSURE-CALC-X.                                       ECSRIRT2
00103                                                                   ECSRIRT2
00104  REINSURE-CK-LIFE.                                                ECSRIRT2
00105      IF CR-LFTYP = ZERO                                           ECSRIRT2
00106          GO TO REINSURE-CK-LIFE-X.                                ECSRIRT2
00107                                                                   ECSRIRT2
00108      IF WT-LF-PCT = ZERO                                          ECSRIRT2
00109          GO TO REINSURE-CK-LIFE-X.                                ECSRIRT2
00110                                                                   ECSRIRT2
00111      IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRT2
00112          IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRT2
00113              GO TO REINSURE-CK-LIFE-X.                            ECSRIRT2
00114                                                                   ECSRIRT2
00115      IF WT-LF-BEN-CODE = '2'                                      ECSRIRT2
00116          IF CLAS-I-BAL (CLAS-INDEXL) NOT = '2'                    ECSRIRT2
00117             GO TO REINSURE-CK-LIFE-X                              ECSRIRT2
00118          ELSE                                                     ECSRIRT2
00119              NEXT SENTENCE                                        ECSRIRT2
00120      ELSE                                                         ECSRIRT2
00121          IF CLAS-I-BAL (CLAS-INDEXL) = '2'                        ECSRIRT2
00122             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00123                                                                   ECSRIRT2
00124      IF WT-LF-BEN-CODE = '4'                                      ECSRIRT2
00125          IF CLAS-I-BAL (CLAS-INDEXL) NOT = '4'                    ECSRIRT2
00126             GO TO REINSURE-CK-LIFE-X                              ECSRIRT2
00127          ELSE                                                     ECSRIRT2
00128              NEXT SENTENCE                                        ECSRIRT2
00129      ELSE                                                         ECSRIRT2
00130          IF CLAS-I-BAL (CLAS-INDEXL) = '4'                        ECSRIRT2
00131             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00132                                                                   ECSRIRT2
00133      IF WT-LF-BEN-CODE = 'A'                                      ECSRIRT2
00134      AND                                                          ECSRIRT2
00135         CLAS-I-BAL (CLAS-INDEXL) = 'B'                            ECSRIRT2
00136             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00137                                                                   ECSRIRT2
00138      IF WT-LF-BEN-CODE = 'B'                                      ECSRIRT2
00139      AND                                                          ECSRIRT2
00140         CLAS-I-BAL (CLAS-INDEXL) NOT = 'B'                        ECSRIRT2
00141             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00142                                                                   ECSRIRT2
00143      IF WT-LF-BEN-CODE = 'C'                                      ECSRIRT2
00144      AND                                                          ECSRIRT2
00145         CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'                   ECSRIRT2
00146             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00147                                                                   ECSRIRT2
00148      IF WT-LF-BEN-CODE = 'D'                                      ECSRIRT2
00149      AND                                                          ECSRIRT2
00150         CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L' AND 'P'              ECSRIRT2
00151             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00152                                                                   ECSRIRT2
00153      IF WT-LF-BEN-CODE = 'E'                                      ECSRIRT2
00154      AND                                                          ECSRIRT2
00155         CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                          ECSRIRT2
00156             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00157                                                                   ECSRIRT2
00158      IF WT-LF-BEN-CODE = 'F'                                      ECSRIRT2
00159      AND                                                          ECSRIRT2
00160         CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'R'                      ECSRIRT2
00161             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00162                                                                   ECSRIRT2
00163      IF WT-LF-BEN-CODE = 'G'                                      ECSRIRT2
00164      AND                                                          ECSRIRT2
00165         CR-IND-GRP NOT = '2'                                      ECSRIRT2
00166             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00167                                                                   ECSRIRT2
00168      IF WT-LF-BEN-CODE = 'H'                                      ECSRIRT2
00169          IF (CR-IND-GRP = '1')  OR                                ECSRIRT2
00170             (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRT2
00171             (CR-AHTYP NOT = ZERO)                                 ECSRIRT2
00172                 GO TO REINSURE-CK-LIFE-X.                         ECSRIRT2
00173                                                                   ECSRIRT2
00174      IF WT-LF-BEN-CODE = 'I'                                      ECSRIRT2
00175      AND                                                          ECSRIRT2
00176         CR-IND-GRP NOT = '1'                                      ECSRIRT2
00177             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00178                                                                   ECSRIRT2
00179      IF WT-LF-BEN-CODE = 'J'                                      ECSRIRT2
00180      AND                                                          ECSRIRT2
00181         CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                      ECSRIRT2
00182             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00183                                                                   ECSRIRT2
00184      IF WT-LF-BEN-CODE = 'K'                                      ECSRIRT2
00185         IF (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'R')                 ECSRIRT2
00186           OR                                                      ECSRIRT2
00187             ((CLAS-I-RL-AH (CLAS-INDEXL) = 'R')                   ECSRIRT2
00188              AND                                                  ECSRIRT2
00189              (CLAS-I-BAL (CLAS-INDEXL) = 'B'))                    ECSRIRT2
00190                 GO TO REINSURE-CK-LIFE-X.                         ECSRIRT2
00191                                                                   ECSRIRT2
00192      IF WT-LF-BEN-CODE = 'L'                                      ECSRIRT2
00193          IF CR-IND-GRP = '1'  OR                                  ECSRIRT2
00194             CLAS-I-BAL (CLAS-INDEXL) = 'B'                        ECSRIRT2
00195                 GO TO REINSURE-CK-LIFE-X.                         ECSRIRT2
00196                                                                   ECSRIRT2
00197      IF WT-LF-BEN-CODE = 'M'                                      ECSRIRT2
00198          IF CR-IND-GRP = '1'  OR                                  ECSRIRT2
00199             CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRT2
00200                 GO TO REINSURE-CK-LIFE-X.                         ECSRIRT2
00201                                                                   ECSRIRT2
00202      IF WT-LF-BEN-CODE = 'N'                                      ECSRIRT2
00203          IF CR-IND-GRP = '1'  OR                                  ECSRIRT2
00204             (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRT2
00205             CLAS-I-BAL (CLAS-INDEXL) = 'B'                        ECSRIRT2
00206                 GO TO REINSURE-CK-LIFE-X.                         ECSRIRT2
00207                                                                   ECSRIRT2
00208      IF WT-LF-BEN-CODE = 'P'                                      ECSRIRT2
00209          IF CR-IND-GRP = '1'  OR                                  ECSRIRT2
00210             CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRT2
00211             CLAS-I-BAL (CLAS-INDEXL) = 'B'                        ECSRIRT2
00212                 GO TO REINSURE-CK-LIFE-X.                         ECSRIRT2
00213                                                                   ECSRIRT2
00214      IF WT-LF-BEN-CODE = 'R'                                      ECSRIRT2
00215          IF (CR-IND-GRP = '1')  OR                                ECSRIRT2
00216             (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRT2
00217                 GO TO REINSURE-CK-LIFE-X.                         ECSRIRT2
00218                                                                   ECSRIRT2
00219      IF WT-LF-BEN-CODE = 'S'                                      ECSRIRT2
00220      AND                                                          ECSRIRT2
00221         CLAS-I-JOINT (CLAS-INDEXL) = 'J'                          ECSRIRT2
00222             GO TO REINSURE-CK-LIFE-X.                             ECSRIRT2
00223                                                                   ECSRIRT2
00224      IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRT2
00225         MOVE 'Y'                 TO  REIN-LF-FLG (SUB1).          ECSRIRT2
00226                                                                   ECSRIRT2
00227      IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRT2
00228          GO TO REINSURE-CK-LIFE-X.                                ECSRIRT2
00229                                                                   ECSRIRT2
00230      IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRT2
00231          GO TO REINSURE-CK-LIFE-X.                                ECSRIRT2
00232                                                                   ECSRIRT2
00233      IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRT2
00234          GO TO REINSURE-CK-LIFE-X.                                ECSRIRT2
00235                                                                   ECSRIRT2
00236      IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRT2
00237          GO TO REINSURE-CK-LIFE-X.                                ECSRIRT2
00238                                                                   ECSRIRT2
00239      MOVE 'Y'                    TO  REIN-LF-FLG (SUB1).          ECSRIRT2
00240                                                                   ECSRIRT2
00241      IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRT2
00242          GO TO REINSURE-CK-LIFE-X.                                   CL**4
00243                                                                   ECSRIRT2
00244      IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRT2
00245          GO TO REINSURE-CK-LIFE-X.                                   CL**4
00246                                                                   ECSRIRT2
00247      MOVE 'X'                    TO  REIN-LF-FLG (SUB1).          ECSRIRT2
00248                                                                   ECSRIRT2
00249  REINSURE-CK-LIFE-X.                                              ECSRIRT2
00250      EXIT.                                                        ECSRIRT2
00251                                                                   ECSRIRT2
00252  REINSURE-CK-AH.                                                  ECSRIRT2
00253      IF CR-AHTYP = ZERO                                           ECSRIRT2
00254          GO TO REINSURE-CK-AH-X.                                  ECSRIRT2
00255                                                                   ECSRIRT2
00256      IF WT-AH-PCT = ZERO                                          ECSRIRT2
00257          GO TO REINSURE-CK-AH-X.                                  ECSRIRT2
00258                                                                   ECSRIRT2
00259      IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRT2
00260          IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRT2
00261              GO TO REINSURE-CK-AH-X.                              ECSRIRT2
00262                                                                   ECSRIRT2
00263      IF WT-AH-BEN-CODE = '3'                                      ECSRIRT2
00264          IF CLAS-I-BAL (CLAS-INDEXA) NOT = '3'                    ECSRIRT2
00265             GO TO REINSURE-CK-AH-X                                ECSRIRT2
00266          ELSE                                                     ECSRIRT2
00267              NEXT SENTENCE                                        ECSRIRT2
00268      ELSE                                                         ECSRIRT2
00269          IF CLAS-I-BAL (CLAS-INDEXA) = '3'                        ECSRIRT2
00270             GO TO REINSURE-CK-AH-X.                               ECSRIRT2
00271                                                                   ECSRIRT2
00272      IF WT-AH-BEN-CODE = 'S'                                      ECSRIRT2
00273      AND                                                          ECSRIRT2
00274         CLAS-I-JOINT (CLAS-INDEXA) = 'J'                          ECSRIRT2
00275             GO TO REINSURE-CK-AH-X.                               ECSRIRT2
00276                                                                   ECSRIRT2
00277      IF WT-AH-BEN-CODE = 'J'                                      ECSRIRT2
00278      AND                                                          ECSRIRT2
00279         CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                      ECSRIRT2
00280             GO TO REINSURE-CK-AH-X.                               ECSRIRT2
00281                                                                   ECSRIRT2
00282      IF WT-AH-BEN-CODE = 'A'                                      ECSRIRT2
00283      AND                                                          ECSRIRT2
00284         CLAS-I-BAL (CLAS-INDEXA) = 'B'                            ECSRIRT2
00285             GO TO REINSURE-CK-AH-X.                               ECSRIRT2
00286                                                                   ECSRIRT2
00287      IF WT-AH-BEN-CODE = 'B'                                      ECSRIRT2
00288      AND                                                          ECSRIRT2
00289         CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'                        ECSRIRT2
00290             GO TO REINSURE-CK-AH-X.                               ECSRIRT2
00291                                                                   ECSRIRT2
00292      IF WT-AH-BEN-CODE = 'G'                                      ECSRIRT2
00293      AND                                                          ECSRIRT2
00294         CR-IND-GRP NOT = '2'                                      ECSRIRT2
00295             GO TO REINSURE-CK-AH-X.                               ECSRIRT2
00296                                                                   ECSRIRT2
00297      IF WT-AH-BEN-CODE = 'I'                                      ECSRIRT2
00298      AND                                                          ECSRIRT2
00299         CR-IND-GRP NOT = '1'                                      ECSRIRT2
00300             GO TO REINSURE-CK-AH-X.                               ECSRIRT2
00301                                                                   ECSRIRT2
00302      IF WT-AH-BEN-CODE = 'L'                                      ECSRIRT2
00303          IF CR-IND-GRP = '1'  OR                                  ECSRIRT2
00304             CLAS-I-BAL (CLAS-INDEXA) = 'B'                        ECSRIRT2
00305                 GO TO REINSURE-CK-AH-X.                           ECSRIRT2
00306                                                                   ECSRIRT2
00307      IF WT-AH-BEN-CODE = '7'                                      ECSRIRT2
00308      AND                                                          ECSRIRT2
00309         CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')        ECSRIRT2
00310             GO TO REINSURE-CK-AH-X.                               ECSRIRT2
00311                                                                   ECSRIRT2
00312      IF WT-AH-BEN-CODE = '8'                                      ECSRIRT2
00313      AND                                                          ECSRIRT2
00314         CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                      ECSRIRT2
00315             GO TO REINSURE-CK-AH-X.                               ECSRIRT2
00316                                                                   ECSRIRT2
00317      IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRT2
00318         MOVE 'Y'                 TO  REIN-AH-FLG (SUB1).          ECSRIRT2
00319                                                                   ECSRIRT2
00320      IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRT2
00321          GO TO REINSURE-CK-AH-X.                                  ECSRIRT2
00322                                                                   ECSRIRT2
00323      IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRT2
00324          GO TO REINSURE-CK-AH-X.                                  ECSRIRT2
00325                                                                   ECSRIRT2
00326      IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRT2
00327          GO TO REINSURE-CK-AH-X.                                  ECSRIRT2
00328                                                                   ECSRIRT2
00329      IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRT2
00330          GO TO REINSURE-CK-AH-X.                                  ECSRIRT2
00331                                                                   ECSRIRT2
00332      MOVE 'Y'                    TO  REIN-AH-FLG (SUB1).          ECSRIRT2
00333                                                                   ECSRIRT2
00334      IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRT2
00335          AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRT2
00336              MOVE +9999999.99    TO  WT-AHBEN-LIM-LO              ECSRIRT2
00337              MOVE +9999999.99    TO  WT-AHBEN-LIM-HI.             ECSRIRT2
00338                                                                   ECSRIRT2
00339      IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRT2
00340          AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRT2
00341              MOVE +9999999.99    TO  WT-AHMOA-LIM-LO              ECSRIRT2
00342              MOVE +9999999.99    TO  WT-AHMOA-LIM-HI.             ECSRIRT2
00343                                                                   ECSRIRT2
00344      COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRT2
00345      COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRT2
00346                                                                   ECSRIRT2
00347      IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRT2
00348          MOVE WT-AHBEN-LIM-LO    TO  RW-AHLIM-LO.                 ECSRIRT2
00349                                                                   ECSRIRT2
00350      IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRT2
00351          MOVE WT-AHBEN-LIM-HI    TO  RW-AHLIM-HI.                 ECSRIRT2
00352                                                                   ECSRIRT2
00353      COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRT2
00354      MOVE RW-AHLIM-LO            TO  RWF-AH-LIMIT.                ECSRIRT2
00355                                                                   ECSRIRT2
00356      IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRT2
00357          GO TO REINSURE-CK-AH-X.                                  ECSRIRT2
00358                                                                   ECSRIRT2
00359      IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRT2
00360          GO TO REINSURE-CK-AH-X.                                  ECSRIRT2
00361                                                                   ECSRIRT2
00362      MOVE 'X'                    TO  REIN-AH-FLG (SUB1).          ECSRIRT2
00363                                                                   ECSRIRT2
00364  REINSURE-CK-AH-X.                                                ECSRIRT2
00365      EXIT.                                                        ECSRIRT2
00366                                                                   ECSRIRT2
00367  REIN-CHECK-INTERACT-E.                                           ECSRIRT2
00368                                                                   ECSRIRT2
00369      IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRT2
00370         RS-AH-BEN = ZERO                                          ECSRIRT2
00371          GO TO REIN-INTERACT-CHECK-X.                             ECSRIRT2
00372                                                                   ECSRIRT2
00373      IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRT2
00374         REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRT2
00375          GO TO REIN-INTERACT-CHECK-X.                             ECSRIRT2
00376                                                                   ECSRIRT2
00377      MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRT2
00378                                     REIN-AH-FLG (SUB1).           ECSRIRT2
00379                                                                   ECSRIRT2
00380      IF WT-AHBEN-LO = ZERO                                        ECSRIRT2
00381          AND WT-AHBEN-HI = ZERO                                   ECSRIRT2
00382              MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRT2
00383                                      WT-AHBEN-HI.                 ECSRIRT2
00384      IF WT-AHMOA-LO = ZERO                                        ECSRIRT2
00385          AND WT-AHMOA-HI = ZERO                                   ECSRIRT2
00386              MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRT2
00387                                      WT-AHMOA-HI.                 ECSRIRT2
00388                                                                   ECSRIRT2
00389      COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRT2
00390      COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRT2
00391                                                                   ECSRIRT2
00392      IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRT2
00393          MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRT2
00394                                                                   ECSRIRT2
00395      IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRT2
00396          MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRT2
00397                                                                   ECSRIRT2
00398      COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRT2
00399                                                                   ECSRIRT2
00400      IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRT2
00401          MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRT2
00402                                                                   ECSRIRT2
00403      IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRT2
00404          COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRT2
00405                                        / RW-AHWRK                 ECSRIRT2
00406        ELSE                                                       ECSRIRT2
00407          MOVE ZERO               TO RATE-WORK-A.                  ECSRIRT2
00408                                                                   ECSRIRT2
00409      IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRT2
00410          COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRT2
00411                                        / RS-LIFE-BEN              ECSRIRT2
00412        ELSE                                                       ECSRIRT2
00413          MOVE ZERO               TO RATE-WORK-L.                  ECSRIRT2
00414                                                                   ECSRIRT2
00415      IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRT2
00416         (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRT2
00417           MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRT2
00418           COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRT2
00419                                       / CR-AH-TERM.               ECSRIRT2
00420                                                                   ECSRIRT2
00421      IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRT2
00422         (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRT2
00423           MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRT2
00424           IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRT2
00425                COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRT2
00426             ELSE                                                  ECSRIRT2
00427                 MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRT2
00428                                                                   ECSRIRT2
00429      IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRT2
00430         (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRT2
00431         IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRT2
00432           MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRT2
00433           COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRT2
00434                                       / CR-AH-TERM                ECSRIRT2
00435         ELSE                                                      ECSRIRT2
00436           MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRT2
00437           IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRT2
00438                COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRT2
00439             ELSE                                                  ECSRIRT2
00440                 MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRT2
00441                                                                   ECSRIRT2
00442  REIN-INTERACT-CHECK-X.                                           ECSRIRT2
00443      EXIT.                                                        ECSRIRT2
00444                                                                   ECSRIRT2
00445                                                                   ECSRIRT2
00446  REIN-CALC-LIFE.                                                  ECSRIRT2
00447                                                                   ECSRIRT2
00448      IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRT2
00449          MOVE RS-LIFE-BEN        TO  RWF-LFAMT                    ECSRIRT2
00450      ELSE                                                         ECSRIRT2
00451          MOVE WT-LF-HI           TO  RWF-LFAMT.                   ECSRIRT2
00452                                                                   ECSRIRT2
00453      IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRT2
00454          MOVE +0                 TO  REIN-WRK-2                   ECSRIRT2
00455          MOVE +0                 TO  RWF-LFAMT                    ECSRIRT2
00456      ELSE                                                         ECSRIRT2
00457          COMPUTE REIN-WRK-2 = RWF-LFAMT - WT-LF-LO                ECSRIRT2
00458          IF WT-REMAINING NOT = 'L'                                ECSRIRT2
00459             IF RS-LIFE-BEN LESS THAN ZERO                         ECSRIRT2
00460                COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRT2
00461             ELSE                                                  ECSRIRT2
00462                COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRT2
00463                                           (RWF-LFAMT - WT-LF-LO). ECSRIRT2
00464                                                                   ECSRIRT2
00465  REIN-CALC-A.                                                     ECSRIRT2
00466      MOVE +0                     TO  RW-LFPRM  RW-LFPRMC.         ECSRIRT2
00467                                                                   ECSRIRT2
00468      IF WT-REMAINING = 'L'                                        ECSRIRT2
00469          COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRT2
00470          GO TO REIN-CALC-LIFE-X.                                  ECSRIRT2
00471                                                                   ECSRIRT2
00472      IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRT2
00473          COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRT2
00474                    RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRT2
00475          COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRT2
00476                    RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRT2
00477      ELSE                                                         ECSRIRT2
00478          IF WT-LF-LIM-LO = ZERO                                   ECSRIRT2
00479              COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRT2
00480              COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRT2
00481                                                                   ECSRIRT2
00482      IF ((WT-LF-QC = '1' OR '3')  OR                                 CL**4
00483          (WT-LF-QC = '2' AND                                         CL**4
00484           PGM-SUB = +50  AND                                         CL**4
00485           DTE-CLIENT = 'LAP'))                                       CL**4
00486          MOVE RW-LFPRM           TO  RWF-LFPRM                    ECSRIRT2
00487      ELSE                                                         ECSRIRT2
00488          MOVE RW-LFPRMC          TO  RWF-LFPRM.                   ECSRIRT2
00489                                                                   ECSRIRT2
00490      IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRT2
00491          COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRT2
00492          COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRT2
00493          COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRT2
00494                                                                   ECSRIRT2
00495  REIN-CALC-LIFE-X.                                                ECSRIRT2
00496      EXIT.                                                        ECSRIRT2
00497                                                                   ECSRIRT2
00498  REIN-CALC-AH.                                                    ECSRIRT2
00499                                                                   ECSRIRT2
00500      IF WT-AHBEN-LO = ZERO                                        ECSRIRT2
00501          AND WT-AHBEN-HI = ZERO                                   ECSRIRT2
00502              MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRT2
00503                                      WT-AHBEN-HI.                 ECSRIRT2
00504      IF WT-AHMOA-LO = ZERO                                        ECSRIRT2
00505          AND WT-AHMOA-HI = ZERO                                   ECSRIRT2
00506              MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRT2
00507                                      WT-AHMOA-HI.                 ECSRIRT2
00508                                                                   ECSRIRT2
00509      COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRT2
00510      COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRT2
00511                                                                   ECSRIRT2
00512      IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRT2
00513          MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRT2
00514                                                                   ECSRIRT2
00515      IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRT2
00516          MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRT2
00517                                                                   ECSRIRT2
00518      IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRT2
00519          MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRT2
00520                                                                   ECSRIRT2
00521      IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRT2
00522          MOVE +0                 TO  RWF-AHAMT                    ECSRIRT2
00523      ELSE                                                         ECSRIRT2
00524          IF WT-REMAINING = 'L'                                    ECSRIRT2
00525              COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRT2
00526          ELSE                                                     ECSRIRT2
00527              COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRT2
00528              ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRT2
00529                                                                   ECSRIRT2
00530  REIN-AH-SKIP-LIMIT.                                              ECSRIRT2
00531      IF WT-REMAINING = 'L'                                        ECSRIRT2
00532          COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRT2
00533          GO TO REIN-CALC-AH-X.                                    ECSRIRT2
00534                                                                   ECSRIRT2
00535      IF RS-AH-BEN NOT = ZERO                                      ECSRIRT2
00536          COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRT2
00537                    RWF-AHAMT) / RS-AH-BEN                         ECSRIRT2
00538          COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRT2
00539                    RWF-AHAMT) / RS-AH-BEN                         ECSRIRT2
00540      ELSE                                                         ECSRIRT2
00541          IF RW-AHLIM-LO = ZERO                                    ECSRIRT2
00542              COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRT2
00543              COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRT2
00544                                                                   ECSRIRT2
00545      IF ((WT-AH-QC = '1' OR '3')  OR                                 CL**4
00546          (WT-AH-QC = '2' AND                                         CL**6
00547           PGM-SUB = +50  AND                                         CL**6
00548           DTE-CLIENT = 'LAP'))                                       CL**6
00549          MOVE RW-AHPRM           TO  RWF-AHPRM                    ECSRIRT2
00550      ELSE                                                         ECSRIRT2
00551          MOVE RW-AHPRMC          TO  RWF-AHPRM.                   ECSRIRT2
00552                                                                   ECSRIRT2
00553      IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRT2
00554          IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRT2
00555             AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRT2
00556                 MOVE 'Y'         TO  RWF-REM-AH-100.              ECSRIRT2
00557                                                                   ECSRIRT2
00558      IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRT2
00559          COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRT2
00560          COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRT2
00561          COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRT2
00562                                                                   ECSRIRT2
00563  REIN-CALC-AH-X.                                                  ECSRIRT2
00564      EXIT.                                                        ECSRIRT2
00565                                                                   ECSRIRT2
00566  REINSURE-CALC-REMAINDER.                                         ECSRIRT2
00567                                                                      CL**6
00568      COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                    CL**6
00569      COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                    CL**6
00570      MOVE CR-AHAMT               TO  RWF-AHAMT.                   ECSRIRT2
00571      MOVE CR-AHPRM               TO  RWF-AHPRM.                   ECSRIRT2
00572                                                                   ECSRIRT2
00573      PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRT2
00574          VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRT2
00575                                                                   ECSRIRT2
00576      IF RWF-LFAMT NOT = ZEROS                                     ECSRIRT2
00577      OR                                                           ECSRIRT2
00578        RWF-LFPRM NOT = ZEROS                                      ECSRIRT2
00579            MOVE 'X'              TO  REIN-LF-FLG (SUB1).          ECSRIRT2
00580                                                                   ECSRIRT2
00581      IF RWF-AHAMT NOT = ZEROS                                     ECSRIRT2
00582      OR                                                           ECSRIRT2
00583        RWF-AHPRM NOT = ZEROS                                      ECSRIRT2
00584            MOVE 'X'              TO  REIN-AH-FLG (SUB1).          ECSRIRT2
00585                                                                   ECSRIRT2
00586  REINSURE-CALC-X.                                                 ECSRIRT2
00587      IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRT2
00588          MOVE 'X'                TO  REIN-BUS-FLAG.               ECSRIRT2
00589                                                                   ECSRIRT2
00590      MOVE RWF-FIELDS             TO  REIN-WORK-FLDS (SUB1).       ECSRIRT2
00591                                                                   ECSRIRT2
00592  REINSURE-SUBTRACT.                                               ECSRIRT2
00593      SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRT2
00594      SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRT2
00595      SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRT2
00596      SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRT2
00597                                                                   ECSRIRT2
00598  REINSURE-SUBTRACT-X.                                             ECSRIRT2
00599      EXIT.                                                        ECSRIRT2
00600                                                                   ECSRIRT2
00601                                                                   ECSRIRT2
00602  CLEAR-REIN-HOLD.                                                 ECSRIRT2
00603      MOVE SPACES                 TO  REIN-COMP (1).               ECSRIRT2
00604      MOVE SPACES                 TO  REIN-LF-AH-FLGS (1).         ECSRIRT2
00605      MOVE SPACES                 TO  REIN-REM-SW (1).             ECSRIRT2
00606      MOVE SPACES                 TO  REIN-REM-AH-100 (1).         ECSRIRT2
00607                                                                   ECSRIRT2
00608      MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRT2
00609          REIN-AHPRM (1)     REIN-LFRFND (1)     REIN-AHRFND (1)   ECSRIRT2
00610          REIN-LFCLM (1)     REIN-AHCLM (1)      REIN-LFCLML (1)   ECSRIRT2
00611          REIN-AHCLML (1)    REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)ECSRIRT2
00612          REIN-DIS-FUTRSV (1)   REIN-DTH-IBNR (1)                  ECSRIRT2
00613          REIN-DTH-PAYCUR (1)   REIN-DTH-FUTRSV (1)                ECSRIRT2
00614          REIN-DIS-IBNRL (1)    REIN-DIS-PAYCURL (1)               ECSRIRT2
00615          REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRT2
00616          REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRT2
00617          REIN-AH-LIMIT (1).                                       ECSRIRT2
00618                                                                   ECSRIRT2
00619      PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRT2
00620          UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRT2
00621                                                                   ECSRIRT2
00622      GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRT2
00623                                                                   ECSRIRT2
00624  CLEAR-REIN-HOLD-ALL.                                             ECSRIRT2
00625      MOVE REIN-LEVELS (1)        TO  REIN-LEVELS (SUB1).          ECSRIRT2
00626                                                                   ECSRIRT2
00627  CLEAR-REIN-HOLD-X.                                               ECSRIRT2
00628      EXIT.                                                        ECSRIRT2
00629                                                                   ECSRIRT2
00630 ******************************************************************   CL**5
